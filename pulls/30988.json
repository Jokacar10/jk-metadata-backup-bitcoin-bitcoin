{
  "type": "pull",
  "pull": {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/30988",
    "id": 2095252001,
    "node_id": "PR_kwDOABII58584wIh",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/30988",
    "diff_url": "https://github.com/bitcoin/bitcoin/pull/30988.diff",
    "patch_url": "https://github.com/bitcoin/bitcoin/pull/30988.patch",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/30988",
    "commits_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/30988/commits",
    "review_comments_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/30988/comments",
    "review_comment_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments%7B/number%7D",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/30988/comments",
    "statuses_url": "https://api.github.com/repos/bitcoin/bitcoin/statuses/7866c736c87a908cef75dc6901c9c0594c65b0eb",
    "number": 30988,
    "state": "open",
    "locked": false,
    "maintainer_can_modify": true,
    "title": "Split CConnman",
    "user": {
      "login": "vasild",
      "id": 266751,
      "node_id": "MDQ6VXNlcjI2Njc1MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vasild",
      "html_url": "https://github.com/vasild",
      "followers_url": "https://api.github.com/users/vasild/followers",
      "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
      "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
      "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
      "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
      "organizations_url": "https://api.github.com/users/vasild/orgs",
      "repos_url": "https://api.github.com/users/vasild/repos",
      "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
      "received_events_url": "https://api.github.com/users/vasild/received_events",
      "type": "User",
      "site_admin": false,
      "patch_url": null
    },
    "body": "Currently `CConnman` is a mixture of:\r\n* low level socket handling, e.g. send, recv, poll, bind, listen, connect, and\r\n* higher level logic that is specific to the Bitcoin P2P protocol, e.g. V1/V2 transport, choosing which address to connect to, if we manage to connect mark the address good in `AddrMan`, maintaining the number of inbound and outbound connections, banning of peers, interacting with `PeerManager`.\r\n\r\n---\r\n\r\nThis PR splits the socket handling into a new class which makes the code more modular and reusable. Having more modular and reusable code is a good thing on its own, even if the code is not reused. Stratum V2 and libevent-less RPC/HTTP server could benefit from this, but it makes sense on its own, even without those projects.\r\n\r\n---\r\n\r\nThe socket operations are driven by the new class `SockMan` which informs the higher level via provided methods when e.g. new data arrives on the socket or a new connection is accepted. For this, `SockMan` provides some non-virtual methods to start it rolling and then it calls pure virtual methods which are implemented by the higher level (e.g. `CConnman`) on certain events, for example \"got this new data on this node's socket\".\r\n\r\nThe public interface of `SockMan` is:\r\n\r\n```cpp\r\n/**\r\n * A socket manager class which handles socket operations.\r\n * To use this class, inherit from it and implement the pure virtual methods.\r\n * Handled operations:\r\n * - binding and listening on sockets\r\n * - starting of necessary threads to process socket operations\r\n * - accepting incoming connections\r\n * - making outbound connections\r\n * - closing connections\r\n * - waiting for IO readiness on sockets and doing send/recv accordingly\r\n */\r\nclass SockMan\r\n{\r\npublic:\r\n\r\n    //\r\n    // Non-virtual functions, to be reused by children classes.\r\n    //\r\n\r\n    /**\r\n     * Bind to a new address:port, start listening and add the listen socket to `m_listen`.\r\n     * Should be called before `StartSocketsThreads()`.\r\n     * @param[in] to Where to bind.\r\n     * @param[out] errmsg Error string if an error occurs.\r\n     * @retval true Success.\r\n     * @retval false Failure, `strError` will be set.\r\n     */\r\n    bool BindAndStartListening(const CService& to, bilingual_str& errmsg);\r\n\r\n    /**\r\n     * Start the necessary threads for sockets IO.\r\n     */\r\n    void StartSocketsThreads(const Options& options);\r\n\r\n    /**\r\n     * Join (wait for) the threads started by `StartSocketsThreads()` to exit.\r\n     */\r\n    void JoinSocketsThreads();\r\n\r\n    /**\r\n     * Make an outbound connection, save the socket internally and return a newly generated node id.\r\n     * @param[in] to The address to connect to, either as CService or a host as string and port as\r\n     * an integer, if the later is used, then `proxy` must be valid.\r\n     * @param[in] is_important If true, then log failures with higher severity.\r\n     * @param[in] proxy Proxy to connect through if `proxy.IsValid()` is true.\r\n     * @param[out] proxy_failed If `proxy` is valid and the connection failed because of the\r\n     * proxy, then it will be set to true.\r\n     * @param[out] me If the connection was successful then this is set to the address on the\r\n     * local side of the socket.\r\n     * @return Newly generated node id, or std::nullopt if the operation fails.\r\n     */\r\n    std::optional<NodeId> ConnectAndMakeNodeId(const std::variant<CService, StringHostIntPort>& to,\r\n                                               bool is_important,\r\n                                               const Proxy& proxy,\r\n                                               bool& proxy_failed,\r\n                                               CService& me);\r\n\r\n    /**\r\n     * Disconnect a given peer by closing its socket and release resources occupied by it.\r\n     * @return Whether the peer existed and its socket was closed by this call.\r\n     */\r\n    bool CloseConnection(NodeId node_id);\r\n\r\n    /**\r\n     * Try to send some data to the given node.\r\n     * @param[in] node_id Identifier of the node to send to.\r\n     * @param[in] data The data to send, it might happen that only a prefix of this is sent.\r\n     * @param[in] will_send_more Used as an optimization if the caller knows that they will\r\n     * be sending more data soon after this call.\r\n     * @param[out] errmsg If <0 is returned then this will contain a human readable message\r\n     * explaining the error.\r\n     * @retval >=0 The number of bytes actually sent.\r\n     * @retval <0 A permanent error has occurred.\r\n     */\r\n    ssize_t SendBytes(NodeId node_id,\r\n                      Span<const unsigned char> data,\r\n                      bool will_send_more,\r\n                      std::string& errmsg) const;\r\n\r\n    /**\r\n     * Close all sockets.\r\n     */\r\n    void CloseSockets();\r\n\r\n    //\r\n    // Pure virtual functions must be implemented by children classes.\r\n    //\r\n\r\n    /**\r\n     * Be notified when a new connection has been accepted.\r\n     * @param[in] node_id Id of the newly accepted connection.\r\n     * @param[in] me The address and port at our side of the connection.\r\n     * @param[in] them The address and port at the peer's side of the connection.\r\n     * @retval true The new connection was accepted at the higher level.\r\n     * @retval false The connection was refused at the higher level, so the\r\n     * associated socket and node_id should be discarded by `SockMan`.\r\n     */\r\n    virtual bool EventNewConnectionAccepted(NodeId node_id,\r\n                                            const CService& me,\r\n                                            const CService& them) = 0;\r\n\r\n    /**\r\n     * Called when the socket is ready to send data and `ShouldTryToSend()` has\r\n     * returned true. This is where the higher level code serializes its messages\r\n     * and calls `SockMan::SendBytes()`.\r\n     * @param[in] node_id Id of the node whose socket is ready to send.\r\n     * @param[out] cancel_recv Should always be set upon return and if it is true,\r\n     * then the next attempt to receive data from that node will be omitted.\r\n     */\r\n    virtual void EventReadyToSend(NodeId node_id, bool& cancel_recv) = 0;\r\n\r\n    /**\r\n     * Called when new data has been received.\r\n     * @param[in] node_id Node for which the data arrived.\r\n     * @param[in] data Data buffer.\r\n     * @param[in] n Number of bytes in `data`.\r\n     */\r\n    virtual void EventGotData(NodeId node_id, const uint8_t* data, size_t n) = 0;\r\n\r\n    /**\r\n     * Called when the remote peer has sent an EOF on the socket. This is a graceful\r\n     * close of their writing side, we can still send and they will receive, if it\r\n     * makes sense at the application level.\r\n     * @param[in] node_id Node whose socket got EOF.\r\n     */\r\n    virtual void EventGotEOF(NodeId node_id) = 0;\r\n\r\n    /**\r\n     * Called when we get an irrecoverable error trying to read from a socket.\r\n     * @param[in] node_id Node whose socket got an error.\r\n     * @param[in] errmsg Message describing the error.\r\n     */\r\n    virtual void EventGotPermanentReadError(NodeId node_id, const std::string& errmsg) = 0;\r\n\r\n    //\r\n    // Non-pure virtual functions can be overridden by children classes or left\r\n    // alone to use the default implementation from SockMan.\r\n    //\r\n\r\n    /**\r\n     * SockMan would only call EventReadyToSend() if this returns true.\r\n     * Can be used to temporary pause sends for a node.\r\n     * The implementation in SockMan always returns true.\r\n     * @param[in] node_id Node for which to confirm or cancel a call to EventReadyToSend().\r\n     */\r\n    virtual bool ShouldTryToSend(NodeId node_id) const;\r\n\r\n    /**\r\n     * SockMan would only call Recv() on a node's socket if this returns true.\r\n     * Can be used to temporary pause receives for a node.\r\n     * The implementation in SockMan always returns true.\r\n     * @param[in] node_id Node for which to confirm or cancel a receive.\r\n     */\r\n    virtual bool ShouldTryToRecv(NodeId node_id) const;\r\n\r\n    /**\r\n     * SockMan has completed the current send+recv iteration for a node.\r\n     * It will do another send+recv for this node after processing all other nodes.\r\n     * Can be used to execute periodic tasks for a given node.\r\n     * The implementation in SockMan does nothing.\r\n     * @param[in] node_id Node for which send+recv has been done.\r\n     */\r\n    virtual void EventIOLoopCompletedForNode(NodeId node_id);\r\n\r\n    /**\r\n     * SockMan has completed send+recv for all nodes.\r\n     * Can be used to execute periodic tasks for all nodes.\r\n     * The implementation in SockMan does nothing.\r\n     */\r\n    virtual void EventIOLoopCompletedForAllPeers();\r\n\r\n    /**\r\n     * Be notified of a change in the state of listening for incoming I2P connections.\r\n     * The default behavior, implemented by `SockMan`, is to ignore this event.\r\n     * @param[in] addr Our listening address.\r\n     * @param[in] success If true then the listen succeeded and we are now\r\n     * listening for incoming I2P connections at `addr`. If false then the\r\n     * call failed and now we are not listening (even if this was invoked\r\n     * before with `true`).\r\n     */\r\n    virtual void EventI2PListen(const CService& addr, bool success);\r\n};\r\n```\r\n\r\nResolves: https://github.com/bitcoin/bitcoin/issues/30694\r\n\r\n---\r\n\r\nReview hint: this PR moves some code around, so reviewers may find this helpful: `git show --color-moved --color-moved-ws=allow-indentation-change`.",
    "labels": [],
    "created_at": "2024-09-27T07:57:10Z",
    "updated_at": "2025-01-31T13:26:57Z",
    "mergeable": true,
    "mergeable_state": "blocked",
    "merge_commit_sha": "0135763fc1ec3f2a8a58c96f93baa01204c253b4",
    "assignees": [],
    "requested_reviewers": [
      {
        "login": "tdb3",
        "id": 106488469,
        "node_id": "U_kgDOBljilQ",
        "avatar_url": "https://avatars.githubusercontent.com/u/106488469?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/tdb3",
        "html_url": "https://github.com/tdb3",
        "followers_url": "https://api.github.com/users/tdb3/followers",
        "following_url": "https://api.github.com/users/tdb3/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/tdb3/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/tdb3/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/tdb3/subscriptions",
        "organizations_url": "https://api.github.com/users/tdb3/orgs",
        "repos_url": "https://api.github.com/users/tdb3/repos",
        "events_url": "https://api.github.com/users/tdb3/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/tdb3/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      }
    ],
    "requested_teams": [],
    "rebaseable": true,
    "head": {
      "label": "vasild:sockman",
      "ref": "sockman",
      "sha": "7866c736c87a908cef75dc6901c9c0594c65b0eb",
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "repo": {
        "id": 120608826,
        "node_id": "MDEwOlJlcG9zaXRvcnkxMjA2MDg4MjY=",
        "name": "bitcoin",
        "full_name": "vasild/bitcoin",
        "owner": {
          "login": "vasild",
          "id": 266751,
          "node_id": "MDQ6VXNlcjI2Njc1MQ==",
          "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
          "gravatar_id": "",
          "url": "https://api.github.com/users/vasild",
          "html_url": "https://github.com/vasild",
          "followers_url": "https://api.github.com/users/vasild/followers",
          "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
          "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
          "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
          "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
          "organizations_url": "https://api.github.com/users/vasild/orgs",
          "repos_url": "https://api.github.com/users/vasild/repos",
          "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
          "received_events_url": "https://api.github.com/users/vasild/received_events",
          "type": "User",
          "site_admin": false,
          "patch_url": null
        },
        "private": false,
        "html_url": "https://github.com/vasild/bitcoin",
        "description": "Bitcoin Core integration/staging tree",
        "fork": true,
        "url": "https://api.github.com/repos/vasild/bitcoin",
        "archive_url": "https://api.github.com/repos/vasild/bitcoin/%7Barchive_format%7D%7B/ref%7D",
        "assignees_url": "https://api.github.com/repos/vasild/bitcoin/assignees%7B/user%7D",
        "blobs_url": "https://api.github.com/repos/vasild/bitcoin/git/blobs%7B/sha%7D",
        "branches_url": "https://api.github.com/repos/vasild/bitcoin/branches%7B/branch%7D",
        "collaborators_url": "https://api.github.com/repos/vasild/bitcoin/collaborators%7B/collaborator%7D",
        "comments_url": "https://api.github.com/repos/vasild/bitcoin/comments%7B/number%7D",
        "commits_url": "https://api.github.com/repos/vasild/bitcoin/commits%7B/sha%7D",
        "compare_url": "https://api.github.com/repos/vasild/bitcoin/compare/%7Bbase%7D...%7Bhead%7D",
        "contents_url": "https://api.github.com/repos/vasild/bitcoin/contents/%7B+path%7D",
        "contributors_url": "https://api.github.com/repos/vasild/bitcoin/contributors",
        "deployments_url": "https://api.github.com/repos/vasild/bitcoin/deployments",
        "downloads_url": "https://api.github.com/repos/vasild/bitcoin/downloads",
        "events_url": "https://api.github.com/repos/vasild/bitcoin/events",
        "forks_url": "https://api.github.com/repos/vasild/bitcoin/forks",
        "git_commits_url": "https://api.github.com/repos/vasild/bitcoin/git/commits%7B/sha%7D",
        "git_refs_url": "https://api.github.com/repos/vasild/bitcoin/git/refs%7B/sha%7D",
        "git_tags_url": "https://api.github.com/repos/vasild/bitcoin/git/tags%7B/sha%7D",
        "git_url": "git://github.com/vasild/bitcoin.git",
        "issue_comment_url": "https://api.github.com/repos/vasild/bitcoin/issues/comments%7B/number%7D",
        "issue_events_url": "https://api.github.com/repos/vasild/bitcoin/issues/events%7B/number%7D",
        "issues_url": "https://api.github.com/repos/vasild/bitcoin/issues%7B/number%7D",
        "keys_url": "https://api.github.com/repos/vasild/bitcoin/keys%7B/key_id%7D",
        "labels_url": "https://api.github.com/repos/vasild/bitcoin/labels%7B/name%7D",
        "languages_url": "https://api.github.com/repos/vasild/bitcoin/languages",
        "merges_url": "https://api.github.com/repos/vasild/bitcoin/merges",
        "milestones_url": "https://api.github.com/repos/vasild/bitcoin/milestones%7B/number%7D",
        "notifications_url": "https://api.github.com/repos/vasild/bitcoin/notifications%7B?since,all,participating}",
        "pulls_url": "https://api.github.com/repos/vasild/bitcoin/pulls%7B/number%7D",
        "releases_url": "https://api.github.com/repos/vasild/bitcoin/releases%7B/id%7D",
        "ssh_url": "git@github.com:vasild/bitcoin.git",
        "stargazers_url": "https://api.github.com/repos/vasild/bitcoin/stargazers",
        "statuses_url": "https://api.github.com/repos/vasild/bitcoin/statuses/%7Bsha%7D",
        "subscribers_url": "https://api.github.com/repos/vasild/bitcoin/subscribers",
        "subscription_url": "https://api.github.com/repos/vasild/bitcoin/subscription",
        "tags_url": "https://api.github.com/repos/vasild/bitcoin/tags",
        "teams_url": "https://api.github.com/repos/vasild/bitcoin/teams",
        "trees_url": "https://api.github.com/repos/vasild/bitcoin/git/trees%7B/sha%7D",
        "clone_url": "https://github.com/vasild/bitcoin.git",
        "hooks_url": "https://api.github.com/repos/vasild/bitcoin/hooks",
        "svn_url": "https://github.com/vasild/bitcoin",
        "homepage": "https://bitcoin.org/en/download",
        "language": "C++",
        "forks_count": 1,
        "stargazers_count": 6,
        "watchers_count": 6,
        "size": 250592,
        "default_branch": "master",
        "open_issues_count": 2,
        "is_template": false,
        "topics": [],
        "has_issues": false,
        "has_projects": true,
        "has_wiki": true,
        "has_pages": false,
        "has_downloads": false,
        "archived": false,
        "disabled": false,
        "visibility": "public",
        "pushed_at": "2025-01-30T14:01:54Z",
        "created_at": "2018-02-07T11:52:47Z",
        "updated_at": "2025-01-30T13:38:33Z",
        "allow_forking": true,
        "license": {
          "key": "mit",
          "name": "MIT License",
          "node_id": "MDc6TGljZW5zZTEz",
          "spdx_id": "MIT",
          "url": "https://api.github.com/licenses/mit",
          "html_url": null,
          "description": null,
          "implementation": null,
          "permissions": null,
          "conditions": null,
          "limitations": null,
          "body": null,
          "featured": null
        }
      }
    },
    "base": {
      "label": "bitcoin:master",
      "ref": "master",
      "sha": "809d7e763cc9bdfff3288860a1c530460c76ffff",
      "user": {
        "login": "bitcoin",
        "id": 528860,
        "node_id": "MDEyOk9yZ2FuaXphdGlvbjUyODg2MA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/528860?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/bitcoin",
        "html_url": "https://github.com/bitcoin",
        "followers_url": "https://api.github.com/users/bitcoin/followers",
        "following_url": "https://api.github.com/users/bitcoin/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/bitcoin/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/bitcoin/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/bitcoin/subscriptions",
        "organizations_url": "https://api.github.com/users/bitcoin/orgs",
        "repos_url": "https://api.github.com/users/bitcoin/repos",
        "events_url": "https://api.github.com/users/bitcoin/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/bitcoin/received_events",
        "type": "Organization",
        "site_admin": false,
        "patch_url": null
      },
      "repo": {
        "id": 1181927,
        "node_id": "MDEwOlJlcG9zaXRvcnkxMTgxOTI3",
        "name": "bitcoin",
        "full_name": "bitcoin/bitcoin",
        "owner": {
          "login": "bitcoin",
          "id": 528860,
          "node_id": "MDEyOk9yZ2FuaXphdGlvbjUyODg2MA==",
          "avatar_url": "https://avatars.githubusercontent.com/u/528860?v=4",
          "gravatar_id": "",
          "url": "https://api.github.com/users/bitcoin",
          "html_url": "https://github.com/bitcoin",
          "followers_url": "https://api.github.com/users/bitcoin/followers",
          "following_url": "https://api.github.com/users/bitcoin/following%7B/other_user%7D",
          "gists_url": "https://api.github.com/users/bitcoin/gists%7B/gist_id%7D",
          "starred_url": "https://api.github.com/users/bitcoin/starred%7B/owner%7D%7B/repo%7D",
          "subscriptions_url": "https://api.github.com/users/bitcoin/subscriptions",
          "organizations_url": "https://api.github.com/users/bitcoin/orgs",
          "repos_url": "https://api.github.com/users/bitcoin/repos",
          "events_url": "https://api.github.com/users/bitcoin/events%7B/privacy%7D",
          "received_events_url": "https://api.github.com/users/bitcoin/received_events",
          "type": "Organization",
          "site_admin": false,
          "patch_url": null
        },
        "private": false,
        "html_url": "https://github.com/bitcoin/bitcoin",
        "description": "Bitcoin Core integration/staging tree",
        "fork": false,
        "url": "https://api.github.com/repos/bitcoin/bitcoin",
        "archive_url": "https://api.github.com/repos/bitcoin/bitcoin/%7Barchive_format%7D%7B/ref%7D",
        "assignees_url": "https://api.github.com/repos/bitcoin/bitcoin/assignees%7B/user%7D",
        "blobs_url": "https://api.github.com/repos/bitcoin/bitcoin/git/blobs%7B/sha%7D",
        "branches_url": "https://api.github.com/repos/bitcoin/bitcoin/branches%7B/branch%7D",
        "collaborators_url": "https://api.github.com/repos/bitcoin/bitcoin/collaborators%7B/collaborator%7D",
        "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/comments%7B/number%7D",
        "commits_url": "https://api.github.com/repos/bitcoin/bitcoin/commits%7B/sha%7D",
        "compare_url": "https://api.github.com/repos/bitcoin/bitcoin/compare/%7Bbase%7D...%7Bhead%7D",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/%7B+path%7D",
        "contributors_url": "https://api.github.com/repos/bitcoin/bitcoin/contributors",
        "deployments_url": "https://api.github.com/repos/bitcoin/bitcoin/deployments",
        "downloads_url": "https://api.github.com/repos/bitcoin/bitcoin/downloads",
        "events_url": "https://api.github.com/repos/bitcoin/bitcoin/events",
        "forks_url": "https://api.github.com/repos/bitcoin/bitcoin/forks",
        "git_commits_url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits%7B/sha%7D",
        "git_refs_url": "https://api.github.com/repos/bitcoin/bitcoin/git/refs%7B/sha%7D",
        "git_tags_url": "https://api.github.com/repos/bitcoin/bitcoin/git/tags%7B/sha%7D",
        "git_url": "git://github.com/bitcoin/bitcoin.git",
        "issue_comment_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments%7B/number%7D",
        "issue_events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events%7B/number%7D",
        "issues_url": "https://api.github.com/repos/bitcoin/bitcoin/issues%7B/number%7D",
        "keys_url": "https://api.github.com/repos/bitcoin/bitcoin/keys%7B/key_id%7D",
        "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/labels%7B/name%7D",
        "languages_url": "https://api.github.com/repos/bitcoin/bitcoin/languages",
        "merges_url": "https://api.github.com/repos/bitcoin/bitcoin/merges",
        "milestones_url": "https://api.github.com/repos/bitcoin/bitcoin/milestones%7B/number%7D",
        "notifications_url": "https://api.github.com/repos/bitcoin/bitcoin/notifications%7B?since,all,participating}",
        "pulls_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls%7B/number%7D",
        "releases_url": "https://api.github.com/repos/bitcoin/bitcoin/releases%7B/id%7D",
        "ssh_url": "git@github.com:bitcoin/bitcoin.git",
        "stargazers_url": "https://api.github.com/repos/bitcoin/bitcoin/stargazers",
        "statuses_url": "https://api.github.com/repos/bitcoin/bitcoin/statuses/%7Bsha%7D",
        "subscribers_url": "https://api.github.com/repos/bitcoin/bitcoin/subscribers",
        "subscription_url": "https://api.github.com/repos/bitcoin/bitcoin/subscription",
        "tags_url": "https://api.github.com/repos/bitcoin/bitcoin/tags",
        "teams_url": "https://api.github.com/repos/bitcoin/bitcoin/teams",
        "trees_url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees%7B/sha%7D",
        "clone_url": "https://github.com/bitcoin/bitcoin.git",
        "hooks_url": "https://api.github.com/repos/bitcoin/bitcoin/hooks",
        "svn_url": "https://github.com/bitcoin/bitcoin",
        "homepage": "https://bitcoincore.org/en/download",
        "language": "C++",
        "forks_count": 36646,
        "stargazers_count": 81755,
        "watchers_count": 81755,
        "size": 274889,
        "default_branch": "master",
        "open_issues_count": 696,
        "is_template": false,
        "topics": [
          "bitcoin",
          "c-plus-plus",
          "cryptocurrency",
          "cryptography",
          "p2p"
        ],
        "has_issues": true,
        "has_projects": true,
        "has_wiki": false,
        "has_pages": false,
        "has_downloads": false,
        "archived": false,
        "disabled": false,
        "visibility": "public",
        "pushed_at": "2025-01-31T00:34:15Z",
        "created_at": "2010-12-19T15:16:43Z",
        "updated_at": "2025-01-31T13:37:41Z",
        "allow_forking": true,
        "license": {
          "key": "mit",
          "name": "MIT License",
          "node_id": "MDc6TGljZW5zZTEz",
          "spdx_id": "MIT",
          "url": "https://api.github.com/licenses/mit",
          "html_url": null,
          "description": null,
          "implementation": null,
          "permissions": null,
          "conditions": null,
          "limitations": null,
          "body": null,
          "featured": null
        }
      }
    },
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/30988"
      }
    },
    "author_association": "CONTRIBUTOR",
    "draft": false,
    "additions": 1373,
    "deletions": 729,
    "changed_files": 19,
    "commits": 18,
    "review_comments": 90,
    "comments": 23
  },
  "events": [
    {
      "event": "commented",
      "id": 2378648531,
      "node_id": "IC_kwDOABII586Nx0vT",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2378648531",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-09-27T07:57:13Z",
      "updated_at": "2025-01-31T01:41:30Z",
      "author_association": "CONTRIBUTOR",
      "body": "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--006a51241073e994b41acfe9ec718e94-->\n### Code Coverage & Benchmarks\nFor details see: https://corecheck.dev/bitcoin/bitcoin/pulls/30988.\n<!--021abf342d371248e50ceaed478a90ca-->\n### Reviews\nSee [the guideline](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#code-review) for information on the review process.\n| Type | Reviewers |\n| ---- | --------- |\n| Concept ACK | [tdb3](https://github.com/bitcoin/bitcoin/pull/30988#pullrequestreview-2336026243), [Sjors](https://github.com/bitcoin/bitcoin/pull/30988#pullrequestreview-2552832660) |\n| Stale ACK | [pinheadmz](https://github.com/bitcoin/bitcoin/pull/30988#pullrequestreview-2373476515) |\n\nIf your review is incorrectly listed, please react with 👎 to this comment and the bot will ignore it on the next update.\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* [#31676](https://github.com/bitcoin/bitcoin/pull/31676) (fuzz: add targets for PCP and NAT-PMP port mapping requests by darosior)\n* [#31519](https://github.com/bitcoin/bitcoin/pull/31519) (refactor: Use std::span over Span by maflcko)\n* [#31022](https://github.com/bitcoin/bitcoin/pull/31022) (test: Add mockable steady clock, tests for PCP and NATPMP implementations by laanwj)\n* [#31014](https://github.com/bitcoin/bitcoin/pull/31014) (net: Use GetAdaptersAddresses to get local addresses on Windows by laanwj)\n* [#30951](https://github.com/bitcoin/bitcoin/pull/30951) (net: option to disallow v1 connection on ipv4 and ipv6 peers by stratospher)\n* [#30381](https://github.com/bitcoin/bitcoin/pull/30381) ([WIP] net: return result from addnode RPC by willcl-ark)\n* [#29641](https://github.com/bitcoin/bitcoin/pull/29641) (scripted-diff: Use LogInfo over LogPrintf [WIP, NOMERGE, DRAFT] by maflcko)\n* [#29418](https://github.com/bitcoin/bitcoin/pull/29418) (rpc: provide per message stats for global traffic via new RPC 'getnetmsgstats' by vasild)\n* [#28584](https://github.com/bitcoin/bitcoin/pull/28584) (Fuzz: extend CConnman tests by vasild)\n* [#28463](https://github.com/bitcoin/bitcoin/pull/28463) (p2p: Increase inbound capacity for block-relay only connections by mzumsande)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.\n",
      "user": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30988#issuecomment-2378648531",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/30988"
    },
    {
      "event": "labeled",
      "id": 14428004914,
      "node_id": "LE_lADOABII586YIJemzwAAAANb-eIy",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/14428004914",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-09-27T09:09:45Z",
      "label": {
        "name": "CI failed",
        "color": "cccccc"
      }
    },
    {
      "event": "commented",
      "id": 2379079961,
      "node_id": "IC_kwDOABII586NzeEZ",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2379079961",
      "actor": {
        "login": "Sjors",
        "id": 10217,
        "node_id": "MDQ6VXNlcjEwMjE3",
        "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Sjors",
        "html_url": "https://github.com/Sjors",
        "followers_url": "https://api.github.com/users/Sjors/followers",
        "following_url": "https://api.github.com/users/Sjors/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Sjors/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Sjors/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
        "organizations_url": "https://api.github.com/users/Sjors/orgs",
        "repos_url": "https://api.github.com/users/Sjors/repos",
        "events_url": "https://api.github.com/users/Sjors/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Sjors/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-09-27T11:41:28Z",
      "updated_at": "2024-09-27T11:41:48Z",
      "author_association": "MEMBER",
      "body": "Nice! I'll try to use this for `Sv2Connman` in https://github.com/Sjors/bitcoin/pull/50 and will let you know if anything is missing.\r\n\r\nCan you put `sockman.h` in `libbitcoin_common` instead of `libbitcoin_node`? For the Template Provider I'm trying to prevent a circular dependency on the node. This should do the trick: https://github.com/bitcoin/bitcoin/commit/4dd51b2924860bf10466da080ea4ff7bed1a3e3f",
      "user": {
        "login": "Sjors",
        "id": 10217,
        "node_id": "MDQ6VXNlcjEwMjE3",
        "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Sjors",
        "html_url": "https://github.com/Sjors",
        "followers_url": "https://api.github.com/users/Sjors/followers",
        "following_url": "https://api.github.com/users/Sjors/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Sjors/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Sjors/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
        "organizations_url": "https://api.github.com/users/Sjors/orgs",
        "repos_url": "https://api.github.com/users/Sjors/repos",
        "events_url": "https://api.github.com/users/Sjors/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Sjors/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30988#issuecomment-2379079961",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/30988"
    },
    {
      "event": "reviewed",
      "id": 2333138089,
      "node_id": "PRR_kwDOABII586LENyp",
      "url": null,
      "actor": null,
      "commit_id": "03f6cc2b4a76cafd278b9ab92bd915d3946212a9",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "user": {
        "login": "maflcko",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/maflcko",
        "html_url": "https://github.com/maflcko",
        "followers_url": "https://api.github.com/users/maflcko/followers",
        "following_url": "https://api.github.com/users/maflcko/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/maflcko/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/maflcko/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/maflcko/subscriptions",
        "organizations_url": "https://api.github.com/users/maflcko/orgs",
        "repos_url": "https://api.github.com/users/maflcko/repos",
        "events_url": "https://api.github.com/users/maflcko/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/maflcko/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30988#pullrequestreview-2333138089",
      "submitted_at": "2024-09-27T11:51:51Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/30988"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 14432633095,
      "node_id": "HRFPE_lADOABII586YIJemzwAAAANcQIEH",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/14432633095",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": "70c2f13f83a5cc740330d0b4af9cbd74515be6b2",
      "commit_url": "https://api.github.com/repos/vasild/bitcoin/commits/70c2f13f83a5cc740330d0b4af9cbd74515be6b2",
      "created_at": "2024-09-27T15:05:31Z"
    },
    {
      "event": "commented",
      "id": 2379495804,
      "node_id": "IC_kwDOABII586N1Dl8",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2379495804",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-09-27T15:07:28Z",
      "updated_at": "2024-09-27T15:07:28Z",
      "author_association": "CONTRIBUTOR",
      "body": "`03f6cc2b4a...70c2f13f83`: fix CI failure, and address suggestions\r\n\r\n> Can you put sockman.h in libbitcoin_common\r\n\r\nDone.",
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30988#issuecomment-2379495804",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/30988"
    },
    {
      "event": "unlabeled",
      "id": 14433585567,
      "node_id": "UNLE_lADOABII586YIJemzwAAAANcTwmf",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/14433585567",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-09-27T16:23:34Z",
      "label": {
        "name": "CI failed",
        "color": "cccccc"
      }
    },
    {
      "event": "commented",
      "id": 2379691000,
      "node_id": "IC_kwDOABII586N1zP4",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2379691000",
      "actor": {
        "login": "Sjors",
        "id": 10217,
        "node_id": "MDQ6VXNlcjEwMjE3",
        "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Sjors",
        "html_url": "https://github.com/Sjors",
        "followers_url": "https://api.github.com/users/Sjors/followers",
        "following_url": "https://api.github.com/users/Sjors/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Sjors/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Sjors/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
        "organizations_url": "https://api.github.com/users/Sjors/orgs",
        "repos_url": "https://api.github.com/users/Sjors/repos",
        "events_url": "https://api.github.com/users/Sjors/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Sjors/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-09-27T16:51:49Z",
      "updated_at": "2024-09-27T16:52:05Z",
      "author_association": "MEMBER",
      "body": "Here's an initial sketch of making `Sv2Connman` a subclass of `SockMan`. The test gets through the handshake but fails later on, so I'll need to study it a bit more closely.\r\n\r\nhttps://github.com/Sjors/bitcoin/pull/64",
      "user": {
        "login": "Sjors",
        "id": 10217,
        "node_id": "MDQ6VXNlcjEwMjE3",
        "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Sjors",
        "html_url": "https://github.com/Sjors",
        "followers_url": "https://api.github.com/users/Sjors/followers",
        "following_url": "https://api.github.com/users/Sjors/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Sjors/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Sjors/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
        "organizations_url": "https://api.github.com/users/Sjors/orgs",
        "repos_url": "https://api.github.com/users/Sjors/repos",
        "events_url": "https://api.github.com/users/Sjors/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Sjors/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30988#issuecomment-2379691000",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/30988"
    },
    {
      "event": "labeled",
      "id": 14443182181,
      "node_id": "LE_lADOABII586YIJemzwAAAANc4Xhl",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/14443182181",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-09-29T01:02:15Z",
      "label": {
        "name": "CI failed",
        "color": "cccccc"
      }
    },
    {
      "event": "unlabeled",
      "id": 14445040755,
      "node_id": "UNLE_lADOABII586YIJemzwAAAANc_dRz",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/14445040755",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-09-29T11:27:54Z",
      "label": {
        "name": "CI failed",
        "color": "cccccc"
      }
    },
    {
      "event": "reviewed",
      "id": 2336026243,
      "node_id": "PRR_kwDOABII586LPO6D",
      "url": null,
      "actor": null,
      "commit_id": "70c2f13f83a5cc740330d0b4af9cbd74515be6b2",
      "commit_url": null,
      "created_at": null,
      "author_association": "CONTRIBUTOR",
      "body": "Concept ACK",
      "user": {
        "login": "tdb3",
        "id": 106488469,
        "node_id": "U_kgDOBljilQ",
        "avatar_url": "https://avatars.githubusercontent.com/u/106488469?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/tdb3",
        "html_url": "https://github.com/tdb3",
        "followers_url": "https://api.github.com/users/tdb3/followers",
        "following_url": "https://api.github.com/users/tdb3/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/tdb3/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/tdb3/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/tdb3/subscriptions",
        "organizations_url": "https://api.github.com/users/tdb3/orgs",
        "repos_url": "https://api.github.com/users/tdb3/repos",
        "events_url": "https://api.github.com/users/tdb3/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/tdb3/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30988#pullrequestreview-2336026243",
      "submitted_at": "2024-09-29T22:05:50Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/30988"
    },
    {
      "event": "commented",
      "id": 2383223911,
      "node_id": "IC_kwDOABII586ODRxn",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2383223911",
      "actor": {
        "login": "pinheadmz",
        "id": 2084648,
        "node_id": "MDQ6VXNlcjIwODQ2NDg=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2084648?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/pinheadmz",
        "html_url": "https://github.com/pinheadmz",
        "followers_url": "https://api.github.com/users/pinheadmz/followers",
        "following_url": "https://api.github.com/users/pinheadmz/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/pinheadmz/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/pinheadmz/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/pinheadmz/subscriptions",
        "organizations_url": "https://api.github.com/users/pinheadmz/orgs",
        "repos_url": "https://api.github.com/users/pinheadmz/repos",
        "events_url": "https://api.github.com/users/pinheadmz/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/pinheadmz/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-09-30T13:38:34Z",
      "updated_at": "2024-09-30T13:38:34Z",
      "author_association": "MEMBER",
      "body": "Concept ACK\r\n\r\nThis looks great and the API in the header looks easy, thanks.\r\n\r\nI'm in the process of cleaning up my HTTP branch for a pull request and then I can start reviewing this and rebasing on top. \r\n\r\nOne element of libevent I'm not immediately seeing here is timed events. Really the only thing HTTP needs it for is `walletpassphrase` which calls `RPCRunLater()` which interacts with `HTTPRPCTimerInterface()`. I don't think Conman has a specific mechanism for this because timed things are attached directly to nodes like `m_last_getheaders_timestamp` etc. The current `HTTPRPCTimerInterface` uses libevent `event_new()`  and `evtimer_add()`, I accomplish this with a map of timestamps and callback functions in my event loop: https://github.com/pinheadmz/bitcoin/commit/42b7240378ffc4890ab4ba1453623e5986ea2a71",
      "user": {
        "login": "pinheadmz",
        "id": 2084648,
        "node_id": "MDQ6VXNlcjIwODQ2NDg=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2084648?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/pinheadmz",
        "html_url": "https://github.com/pinheadmz",
        "followers_url": "https://api.github.com/users/pinheadmz/followers",
        "following_url": "https://api.github.com/users/pinheadmz/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/pinheadmz/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/pinheadmz/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/pinheadmz/subscriptions",
        "organizations_url": "https://api.github.com/users/pinheadmz/orgs",
        "repos_url": "https://api.github.com/users/pinheadmz/repos",
        "events_url": "https://api.github.com/users/pinheadmz/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/pinheadmz/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30988#issuecomment-2383223911",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/30988"
    },
    {
      "event": "commented",
      "id": 2383313791,
      "node_id": "IC_kwDOABII586ODnt_",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2383313791",
      "actor": {
        "login": "maflcko",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/maflcko",
        "html_url": "https://github.com/maflcko",
        "followers_url": "https://api.github.com/users/maflcko/followers",
        "following_url": "https://api.github.com/users/maflcko/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/maflcko/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/maflcko/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/maflcko/subscriptions",
        "organizations_url": "https://api.github.com/users/maflcko/orgs",
        "repos_url": "https://api.github.com/users/maflcko/repos",
        "events_url": "https://api.github.com/users/maflcko/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/maflcko/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-09-30T14:07:19Z",
      "updated_at": "2024-09-30T14:07:19Z",
      "author_association": "MEMBER",
      "body": "> I accomplish this with a map of timestamps and callback functions in my event loop\r\n\r\nI wonder why the existing scheduler can't be used for re-locking the wallet? I know there is https://github.com/bitcoin/bitcoin/issues/18488 and https://github.com/bitcoin/bitcoin/issues/14289, but the thread is already filled with random stuff such as `BerkeleyDatabase::PeriodicFlush()`, and relocking the wallet seems(?) fast (I haven't benchmarked), so should be fine to put in there as well, at least from that perspective?",
      "user": {
        "login": "maflcko",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/maflcko",
        "html_url": "https://github.com/maflcko",
        "followers_url": "https://api.github.com/users/maflcko/followers",
        "following_url": "https://api.github.com/users/maflcko/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/maflcko/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/maflcko/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/maflcko/subscriptions",
        "organizations_url": "https://api.github.com/users/maflcko/orgs",
        "repos_url": "https://api.github.com/users/maflcko/repos",
        "events_url": "https://api.github.com/users/maflcko/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/maflcko/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30988#issuecomment-2383313791",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/30988"
    },
    {
      "event": "commented",
      "id": 2391022009,
      "node_id": "IC_kwDOABII586OhBm5",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2391022009",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-10-03T10:07:55Z",
      "updated_at": "2024-10-03T10:16:06Z",
      "author_association": "CONTRIBUTOR",
      "body": "@pinheadmz, I think that the functionality of \"execute this code after some time\", is not much related to the sockets handling and better be implemented at some higher level, not inside `SockMan`. Maybe the scheduler, like @maflcko suggested, or in the `EventIOLoopCompletedForAllPeers()` method which will be called periodically by `SockMan`:\r\n\r\n```cpp\r\n    /**\r\n     * SockMan has completed send+recv for all nodes.\r\n     * Can be used to execute periodic tasks for all nodes.\r\n     * The implementation in SockMan does nothing.\r\n     */\r\n    virtual void EventIOLoopCompletedForAllPeers();\r\n```\r\n\r\nEdit: I guess `TriggerEvents()` from https://github.com/pinheadmz/bitcoin/commit/42b7240378ffc4890ab4ba1453623e5986ea2a71 can be called from `EventIOLoopCompletedForAllPeers()` or from the scheduler.",
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30988#issuecomment-2391022009",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/30988"
    },
    {
      "event": "mentioned",
      "id": 14501959506,
      "node_id": "MEE_lADOABII586YIJemzwAAAANgYldS",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/14501959506",
      "actor": {
        "login": "pinheadmz",
        "id": 2084648,
        "node_id": "MDQ6VXNlcjIwODQ2NDg=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2084648?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/pinheadmz",
        "html_url": "https://github.com/pinheadmz",
        "followers_url": "https://api.github.com/users/pinheadmz/followers",
        "following_url": "https://api.github.com/users/pinheadmz/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/pinheadmz/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/pinheadmz/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/pinheadmz/subscriptions",
        "organizations_url": "https://api.github.com/users/pinheadmz/orgs",
        "repos_url": "https://api.github.com/users/pinheadmz/repos",
        "events_url": "https://api.github.com/users/pinheadmz/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/pinheadmz/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-10-03T10:07:57Z"
    },
    {
      "event": "subscribed",
      "id": 14501959523,
      "node_id": "SE_lADOABII586YIJemzwAAAANgYldj",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/14501959523",
      "actor": {
        "login": "pinheadmz",
        "id": 2084648,
        "node_id": "MDQ6VXNlcjIwODQ2NDg=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2084648?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/pinheadmz",
        "html_url": "https://github.com/pinheadmz",
        "followers_url": "https://api.github.com/users/pinheadmz/followers",
        "following_url": "https://api.github.com/users/pinheadmz/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/pinheadmz/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/pinheadmz/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/pinheadmz/subscriptions",
        "organizations_url": "https://api.github.com/users/pinheadmz/orgs",
        "repos_url": "https://api.github.com/users/pinheadmz/repos",
        "events_url": "https://api.github.com/users/pinheadmz/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/pinheadmz/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-10-03T10:07:57Z"
    },
    {
      "event": "mentioned",
      "id": 14501959538,
      "node_id": "MEE_lADOABII586YIJemzwAAAANgYldy",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/14501959538",
      "actor": {
        "login": "maflcko",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/maflcko",
        "html_url": "https://github.com/maflcko",
        "followers_url": "https://api.github.com/users/maflcko/followers",
        "following_url": "https://api.github.com/users/maflcko/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/maflcko/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/maflcko/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/maflcko/subscriptions",
        "organizations_url": "https://api.github.com/users/maflcko/orgs",
        "repos_url": "https://api.github.com/users/maflcko/repos",
        "events_url": "https://api.github.com/users/maflcko/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/maflcko/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-10-03T10:07:57Z"
    },
    {
      "event": "subscribed",
      "id": 14501959552,
      "node_id": "SE_lADOABII586YIJemzwAAAANgYleA",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/14501959552",
      "actor": {
        "login": "maflcko",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/maflcko",
        "html_url": "https://github.com/maflcko",
        "followers_url": "https://api.github.com/users/maflcko/followers",
        "following_url": "https://api.github.com/users/maflcko/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/maflcko/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/maflcko/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/maflcko/subscriptions",
        "organizations_url": "https://api.github.com/users/maflcko/orgs",
        "repos_url": "https://api.github.com/users/maflcko/repos",
        "events_url": "https://api.github.com/users/maflcko/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/maflcko/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-10-03T10:07:57Z"
    },
    {
      "event": "commented",
      "id": 2393768768,
      "node_id": "IC_kwDOABII586OrgNA",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2393768768",
      "actor": {
        "login": "Sjors",
        "id": 10217,
        "node_id": "MDQ6VXNlcjEwMjE3",
        "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Sjors",
        "html_url": "https://github.com/Sjors",
        "followers_url": "https://api.github.com/users/Sjors/followers",
        "following_url": "https://api.github.com/users/Sjors/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Sjors/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Sjors/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
        "organizations_url": "https://api.github.com/users/Sjors/orgs",
        "repos_url": "https://api.github.com/users/Sjors/repos",
        "events_url": "https://api.github.com/users/Sjors/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Sjors/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-10-04T13:54:41Z",
      "updated_at": "2024-10-04T13:56:44Z",
      "author_association": "MEMBER",
      "body": "@vasild if you rebase past #31011, tidy might point out that `sockman.cpp.o depends on i2p.cpp`. So you probably need to either move `i2p.cpp` to common as well, or remove the dependency.",
      "user": {
        "login": "Sjors",
        "id": 10217,
        "node_id": "MDQ6VXNlcjEwMjE3",
        "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Sjors",
        "html_url": "https://github.com/Sjors",
        "followers_url": "https://api.github.com/users/Sjors/followers",
        "following_url": "https://api.github.com/users/Sjors/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Sjors/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Sjors/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
        "organizations_url": "https://api.github.com/users/Sjors/orgs",
        "repos_url": "https://api.github.com/users/Sjors/repos",
        "events_url": "https://api.github.com/users/Sjors/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Sjors/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30988#issuecomment-2393768768",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/30988"
    },
    {
      "event": "mentioned",
      "id": 14519676585,
      "node_id": "MEE_lADOABII586YIJemzwAAAANhcK6p",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/14519676585",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-10-04T13:54:43Z"
    },
    {
      "event": "subscribed",
      "id": 14519676599,
      "node_id": "SE_lADOABII586YIJemzwAAAANhcK63",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/14519676599",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-10-04T13:54:43Z"
    },
    {
      "event": "reviewed",
      "id": 2349481835,
      "node_id": "PRR_kwDOABII586MCj9r",
      "url": null,
      "actor": null,
      "commit_id": "70c2f13f83a5cc740330d0b4af9cbd74515be6b2",
      "commit_url": null,
      "created_at": null,
      "author_association": "NONE",
      "body": "",
      "user": {
        "login": "Jacksonearl2468",
        "id": 180059160,
        "node_id": "U_kgDOCrt8GA",
        "avatar_url": "https://avatars.githubusercontent.com/u/180059160?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Jacksonearl2468",
        "html_url": "https://github.com/Jacksonearl2468",
        "followers_url": "https://api.github.com/users/Jacksonearl2468/followers",
        "following_url": "https://api.github.com/users/Jacksonearl2468/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Jacksonearl2468/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Jacksonearl2468/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Jacksonearl2468/subscriptions",
        "organizations_url": "https://api.github.com/users/Jacksonearl2468/orgs",
        "repos_url": "https://api.github.com/users/Jacksonearl2468/repos",
        "events_url": "https://api.github.com/users/Jacksonearl2468/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Jacksonearl2468/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30988#pullrequestreview-2349481835",
      "submitted_at": "2024-10-05T04:02:01Z",
      "state": "APPROVED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/30988"
    },
    {
      "event": "labeled",
      "id": 14537194486,
      "node_id": "LE_lADOABII586YIJemzwAAAANie_v2",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/14537194486",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-10-07T09:27:40Z",
      "label": {
        "name": "CI failed",
        "color": "cccccc"
      }
    },
    {
      "event": "reviewed",
      "id": 2372105727,
      "node_id": "PRR_kwDOABII586NY3X_",
      "url": null,
      "actor": null,
      "commit_id": "70c2f13f83a5cc740330d0b4af9cbd74515be6b2",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "user": {
        "login": "Sjors",
        "id": 10217,
        "node_id": "MDQ6VXNlcjEwMjE3",
        "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Sjors",
        "html_url": "https://github.com/Sjors",
        "followers_url": "https://api.github.com/users/Sjors/followers",
        "following_url": "https://api.github.com/users/Sjors/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Sjors/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Sjors/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
        "organizations_url": "https://api.github.com/users/Sjors/orgs",
        "repos_url": "https://api.github.com/users/Sjors/repos",
        "events_url": "https://api.github.com/users/Sjors/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Sjors/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30988#pullrequestreview-2372105727",
      "submitted_at": "2024-10-16T11:15:53Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/30988"
    },
    {
      "event": "reviewed",
      "id": 2373476515,
      "node_id": "PRR_kwDOABII586NeGCj",
      "url": null,
      "actor": null,
      "commit_id": "70c2f13f83a5cc740330d0b4af9cbd74515be6b2",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "body": "ACK 70c2f13f83a5cc740330d0b4af9cbd74515be6b2\r\n\r\nBuilt and ran tests on macos/arm as well as debian/x86.\r\n\r\nSynced to signet with this build on a debian server, then synced from that node locally using the macos build.\r\n\r\nI left a lot of comments below but most are for myself to track during rebases, indicate to the maintainers the depth that I'm actually reviewing, and also some notes for myself -- I'll be rebaing my non-libevent http server on this banch and consuming the new SockMan.\r\n\r\nI have a working branch with my own sock handler for http, so I was able to compare that work to the code in this PR to follow along.\r\n\r\nThere are two areas I am not entirely clear on that I will review more closely in the coming weeks which is I2P stuff, and reviewing all the mutex stuff.\r\n\r\n\r\n<details><summary>Show Signature</summary>\r\n\r\n```\r\n-----BEGIN PGP SIGNED MESSAGE-----\r\nHash: SHA256\r\n\r\nACK 70c2f13f83a5cc740330d0b4af9cbd74515be6b2\r\n-----BEGIN PGP SIGNATURE-----\r\n\r\niQIzBAEBCAAdFiEE5hdzzW4BBA4vG9eM5+KYS2KJyToFAmcSeTIACgkQ5+KYS2KJ\r\nyTp/1A//ZzhksZzWlBbV6rcfIXnUVQS0SIgmY7sZCN8AN0RoiN4ECALWyrXz9Rdg\r\nfONCWiQSTyxE5u2TnFo7os+o0Z+3ybxApufAx/OzqHaJwR8d5wnZPHU/uFTPYm/z\r\nqArPT3SHQgKb1sftt8S5ve7j37RW7IbshiJ+6bq8+DNMY1Ep1DX4BBzZgwbzx2ek\r\nqMcRFQkOkTbJg3/yOT1Vz361qCPLmbKjvbRyjYgYYG7oxtdwb5r/ezeagSCWKDJo\r\nYx/DJ2cwZ3uMWDvfnhNJOeql4MhOLZcU5hKyGGTRT3B5ER7ELNye5+Sz+pv0cJuP\r\nR+zfoxAfYV3opqB/ewTD1sM+gtFZFUiLNHigPgKFmK5GerLguXUqY+vgQ/4VIEpg\r\nXD2tHOCwwDULsekVLZ+hXJPSTBDmZAlHmJvcCBQgzLkjCMvrlmxJR8KpKg3lDgKM\r\nGwFcYoIWubyFKgRCAQL6vc1qFnGc7PJ1TWJLoKxpjXeyE6igHquSK0KE3flhCJ97\r\nCpWhZflrHwcaomSf9bDYsSaNvMN2MiFUzC4lbmLRWTzeOCS9oMFRMcIayQ+psUqC\r\n0gmbZzi+Qcf32gCNYvhxYwKqTeAlKih9x+vurTuK8831AZoUYwusetGaTsklwvOn\r\nbDpgEGoqFPdPIB8yHAiFBwQPcGmn7tVmTbVhck59B3HvdS/wOr4=\r\n=rnjt\r\n-----END PGP SIGNATURE-----\r\n```\r\n\r\npinheadmz's public key is [on keybase](https://keybase.io/pinheadmz/pgp_keys.asc?fingerprint=e61773cd6e01040e2f1bd78ce7e2984b6289c93a)\r\n</details>\r\n",
      "user": {
        "login": "pinheadmz",
        "id": 2084648,
        "node_id": "MDQ6VXNlcjIwODQ2NDg=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2084648?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/pinheadmz",
        "html_url": "https://github.com/pinheadmz",
        "followers_url": "https://api.github.com/users/pinheadmz/followers",
        "following_url": "https://api.github.com/users/pinheadmz/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/pinheadmz/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/pinheadmz/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/pinheadmz/subscriptions",
        "organizations_url": "https://api.github.com/users/pinheadmz/orgs",
        "repos_url": "https://api.github.com/users/pinheadmz/repos",
        "events_url": "https://api.github.com/users/pinheadmz/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/pinheadmz/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30988#pullrequestreview-2373476515",
      "submitted_at": "2024-10-18T15:14:27Z",
      "state": "APPROVED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/30988"
    },
    {
      "event": "review_requested",
      "id": 14722788692,
      "node_id": "RRE_lADOABII586YIJemzwAAAANti-1U",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/14722788692",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-10-18T15:14:31Z",
      "requested_reviewer": {
        "login": "tdb3",
        "id": 106488469,
        "node_id": "U_kgDOBljilQ",
        "avatar_url": "https://avatars.githubusercontent.com/u/106488469?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/tdb3",
        "html_url": "https://github.com/tdb3",
        "followers_url": "https://api.github.com/users/tdb3/followers",
        "following_url": "https://api.github.com/users/tdb3/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/tdb3/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/tdb3/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/tdb3/subscriptions",
        "organizations_url": "https://api.github.com/users/tdb3/orgs",
        "repos_url": "https://api.github.com/users/tdb3/repos",
        "events_url": "https://api.github.com/users/tdb3/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/tdb3/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "review_requester": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      }
    },
    {
      "event": "subscribed",
      "id": 14728527368,
      "node_id": "SE_lADOABII586YIJemzwAAAANt434I",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/14728527368",
      "actor": {
        "login": "0xB10C",
        "id": 19157360,
        "node_id": "MDQ6VXNlcjE5MTU3MzYw",
        "avatar_url": "https://avatars.githubusercontent.com/u/19157360?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/0xB10C",
        "html_url": "https://github.com/0xB10C",
        "followers_url": "https://api.github.com/users/0xB10C/followers",
        "following_url": "https://api.github.com/users/0xB10C/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/0xB10C/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/0xB10C/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/0xB10C/subscriptions",
        "organizations_url": "https://api.github.com/users/0xB10C/orgs",
        "repos_url": "https://api.github.com/users/0xB10C/repos",
        "events_url": "https://api.github.com/users/0xB10C/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/0xB10C/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-10-19T00:27:08Z"
    },
    {
      "event": "commented",
      "id": 2426964142,
      "node_id": "IC_kwDOABII586QqIiu",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2426964142",
      "actor": {
        "login": "Sjors",
        "id": 10217,
        "node_id": "MDQ6VXNlcjEwMjE3",
        "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Sjors",
        "html_url": "https://github.com/Sjors",
        "followers_url": "https://api.github.com/users/Sjors/followers",
        "following_url": "https://api.github.com/users/Sjors/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Sjors/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Sjors/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
        "organizations_url": "https://api.github.com/users/Sjors/orgs",
        "repos_url": "https://api.github.com/users/Sjors/repos",
        "events_url": "https://api.github.com/users/Sjors/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Sjors/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-10-21T15:09:15Z",
      "updated_at": "2024-10-21T15:09:15Z",
      "author_association": "MEMBER",
      "body": "cc @theuni any takes?",
      "user": {
        "login": "Sjors",
        "id": 10217,
        "node_id": "MDQ6VXNlcjEwMjE3",
        "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Sjors",
        "html_url": "https://github.com/Sjors",
        "followers_url": "https://api.github.com/users/Sjors/followers",
        "following_url": "https://api.github.com/users/Sjors/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Sjors/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Sjors/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
        "organizations_url": "https://api.github.com/users/Sjors/orgs",
        "repos_url": "https://api.github.com/users/Sjors/repos",
        "events_url": "https://api.github.com/users/Sjors/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Sjors/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30988#issuecomment-2426964142",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/30988"
    },
    {
      "event": "mentioned",
      "id": 14766693192,
      "node_id": "MEE_lADOABII586YIJemzwAAAANwKdtI",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/14766693192",
      "actor": {
        "login": "theuni",
        "id": 417043,
        "node_id": "MDQ6VXNlcjQxNzA0Mw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/417043?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theuni",
        "html_url": "https://github.com/theuni",
        "followers_url": "https://api.github.com/users/theuni/followers",
        "following_url": "https://api.github.com/users/theuni/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theuni/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theuni/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theuni/subscriptions",
        "organizations_url": "https://api.github.com/users/theuni/orgs",
        "repos_url": "https://api.github.com/users/theuni/repos",
        "events_url": "https://api.github.com/users/theuni/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theuni/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-10-21T15:09:17Z"
    },
    {
      "event": "subscribed",
      "id": 14766693210,
      "node_id": "SE_lADOABII586YIJemzwAAAANwKdta",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/14766693210",
      "actor": {
        "login": "theuni",
        "id": 417043,
        "node_id": "MDQ6VXNlcjQxNzA0Mw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/417043?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theuni",
        "html_url": "https://github.com/theuni",
        "followers_url": "https://api.github.com/users/theuni/followers",
        "following_url": "https://api.github.com/users/theuni/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theuni/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theuni/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theuni/subscriptions",
        "organizations_url": "https://api.github.com/users/theuni/orgs",
        "repos_url": "https://api.github.com/users/theuni/repos",
        "events_url": "https://api.github.com/users/theuni/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theuni/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-10-21T15:09:17Z"
    },
    {
      "event": "labeled",
      "id": 14967071246,
      "node_id": "LE_lADOABII586YIJemzwAAAAN8G2IO",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/14967071246",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-10-28T17:52:52Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "commented",
      "id": 2476925664,
      "node_id": "IC_kwDOABII586TouLg",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2476925664",
      "actor": {
        "login": "Sjors",
        "id": 10217,
        "node_id": "MDQ6VXNlcjEwMjE3",
        "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Sjors",
        "html_url": "https://github.com/Sjors",
        "followers_url": "https://api.github.com/users/Sjors/followers",
        "following_url": "https://api.github.com/users/Sjors/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Sjors/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Sjors/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
        "organizations_url": "https://api.github.com/users/Sjors/orgs",
        "repos_url": "https://api.github.com/users/Sjors/repos",
        "events_url": "https://api.github.com/users/Sjors/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Sjors/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-11-14T16:47:02Z",
      "updated_at": "2024-11-14T16:50:12Z",
      "author_association": "MEMBER",
      "body": "This needs a rebase. Otherwise it's non-trivial for me to keep https://github.com/Sjors/bitcoin/pull/67 rebased.\r\n\r\nConflicts:\r\n* https://github.com/bitcoin/bitcoin/pull/30937",
      "user": {
        "login": "Sjors",
        "id": 10217,
        "node_id": "MDQ6VXNlcjEwMjE3",
        "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Sjors",
        "html_url": "https://github.com/Sjors",
        "followers_url": "https://api.github.com/users/Sjors/followers",
        "following_url": "https://api.github.com/users/Sjors/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Sjors/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Sjors/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
        "organizations_url": "https://api.github.com/users/Sjors/orgs",
        "repos_url": "https://api.github.com/users/Sjors/repos",
        "events_url": "https://api.github.com/users/Sjors/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Sjors/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30988#issuecomment-2476925664",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/30988"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 15301694425,
      "node_id": "HRFPE_lADOABII586YIJemzwAAAAOQDVPZ",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/15301694425",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": "c4f51c7f61e6c4e291025e450f6dd97c2b939b56",
      "commit_url": "https://api.github.com/repos/vasild/bitcoin/commits/c4f51c7f61e6c4e291025e450f6dd97c2b939b56",
      "created_at": "2024-11-14T16:55:15Z"
    },
    {
      "event": "commented",
      "id": 2476951015,
      "node_id": "IC_kwDOABII586To0Xn",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2476951015",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-11-14T16:58:07Z",
      "updated_at": "2024-11-14T16:58:07Z",
      "author_association": "CONTRIBUTOR",
      "body": "`70c2f13f83...c4f51c7f61`: rebase due to conflicts, next I will look at @pinheadmz feedback above and implement changes from coredev discussions:\r\n\r\n* Store the node id -> CNode map in SockMan (then the SockMan class becomes templated)\r\n* SockMan <-> Connman calls based on CNode, not node id\r\n* Make the virtual methods in SockMan private, since they are called only from SockMan\r\n",
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30988#issuecomment-2476951015",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/30988"
    },
    {
      "event": "mentioned",
      "id": 15301729382,
      "node_id": "MEE_lADOABII586YIJemzwAAAAOQDdxm",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/15301729382",
      "actor": {
        "login": "pinheadmz",
        "id": 2084648,
        "node_id": "MDQ6VXNlcjIwODQ2NDg=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2084648?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/pinheadmz",
        "html_url": "https://github.com/pinheadmz",
        "followers_url": "https://api.github.com/users/pinheadmz/followers",
        "following_url": "https://api.github.com/users/pinheadmz/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/pinheadmz/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/pinheadmz/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/pinheadmz/subscriptions",
        "organizations_url": "https://api.github.com/users/pinheadmz/orgs",
        "repos_url": "https://api.github.com/users/pinheadmz/repos",
        "events_url": "https://api.github.com/users/pinheadmz/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/pinheadmz/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-11-14T16:58:09Z"
    },
    {
      "event": "subscribed",
      "id": 15301729394,
      "node_id": "SE_lADOABII586YIJemzwAAAAOQDdxy",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/15301729394",
      "actor": {
        "login": "pinheadmz",
        "id": 2084648,
        "node_id": "MDQ6VXNlcjIwODQ2NDg=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2084648?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/pinheadmz",
        "html_url": "https://github.com/pinheadmz",
        "followers_url": "https://api.github.com/users/pinheadmz/followers",
        "following_url": "https://api.github.com/users/pinheadmz/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/pinheadmz/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/pinheadmz/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/pinheadmz/subscriptions",
        "organizations_url": "https://api.github.com/users/pinheadmz/orgs",
        "repos_url": "https://api.github.com/users/pinheadmz/repos",
        "events_url": "https://api.github.com/users/pinheadmz/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/pinheadmz/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-11-14T16:58:09Z"
    },
    {
      "event": "unlabeled",
      "id": 15302192423,
      "node_id": "UNLE_lADOABII586YIJemzwAAAAOQFO0n",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/15302192423",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-11-14T17:33:38Z",
      "label": {
        "name": "CI failed",
        "color": "cccccc"
      }
    },
    {
      "event": "unlabeled",
      "id": 15303158917,
      "node_id": "UNLE_lADOABII586YIJemzwAAAAOQI6yF",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/15303158917",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-11-14T18:59:43Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "head_ref_force_pushed",
      "id": 15349386514,
      "node_id": "HRFPE_lADOABII586YIJemzwAAAAOS5Q0S",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/15349386514",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": "2b0103705fefddff6b880b9eb72fb590740a7300",
      "commit_url": "https://api.github.com/repos/vasild/bitcoin/commits/2b0103705fefddff6b880b9eb72fb590740a7300",
      "created_at": "2024-11-19T13:15:12Z"
    },
    {
      "event": "commented",
      "id": 2485715952,
      "node_id": "IC_kwDOABII586UKQPw",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2485715952",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-11-19T13:28:24Z",
      "updated_at": "2024-11-19T13:28:24Z",
      "author_association": "CONTRIBUTOR",
      "body": "`c4f51c7f61...2b0103705f`: rebase and make the virtual methods of `SockMan` private since they are only used by `SockMan`.\r\n\r\nAbout storing the `CNode` in `SockMan` (which would be templated like `SockMan<CNode>`) and making the communication between `SockMan` and the higher class (e.g. `CConnman`) based on `CNode` instead of node id: this is an excellent idea that will make the code more straight-forward and the higher classes simpler. However it would make this PR larger. I will leave it off for now. There is some specific `CNode` ref-counting in `CConnman` and the code around deleting a node is a bit complicated, so it would require further non-trivial changes to move that to `SockMan`.\r\n\r\nI think in general, in the long term, independently of this PR, it would be good to get rid of the manual `CNode` ref-counting and tap `std::shared_ptr` to do that for us. In other words, to revive https://github.com/bitcoin/bitcoin/pull/28222.",
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30988#issuecomment-2485715952",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/30988"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 15510275499,
      "node_id": "HRFPE_lADOABII586YIJemzwAAAAOcfAWr",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/15510275499",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": "645f625e29b36321bcba8db5758b0428b8ebd80f",
      "commit_url": "https://api.github.com/repos/vasild/bitcoin/commits/645f625e29b36321bcba8db5758b0428b8ebd80f",
      "created_at": "2024-12-03T13:59:28Z"
    },
    {
      "event": "commented",
      "id": 2514637932,
      "node_id": "IC_kwDOABII586V4lRs",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2514637932",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-12-03T13:59:38Z",
      "updated_at": "2024-12-03T13:59:38Z",
      "author_association": "CONTRIBUTOR",
      "body": "`2b0103705f...645f625e29`: rebase and address suggestions",
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30988#issuecomment-2514637932",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/30988"
    },
    {
      "event": "labeled",
      "id": 15560141466,
      "node_id": "LE_lADOABII586YIJemzwAAAAOfdOqa",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/15560141466",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-12-06T13:05:12Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "reviewed",
      "id": 2493471520,
      "node_id": "PRR_kwDOABII586Un1sg",
      "url": null,
      "actor": null,
      "commit_id": "645f625e29b36321bcba8db5758b0428b8ebd80f",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "user": {
        "login": "pinheadmz",
        "id": 2084648,
        "node_id": "MDQ6VXNlcjIwODQ2NDg=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2084648?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/pinheadmz",
        "html_url": "https://github.com/pinheadmz",
        "followers_url": "https://api.github.com/users/pinheadmz/followers",
        "following_url": "https://api.github.com/users/pinheadmz/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/pinheadmz/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/pinheadmz/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/pinheadmz/subscriptions",
        "organizations_url": "https://api.github.com/users/pinheadmz/orgs",
        "repos_url": "https://api.github.com/users/pinheadmz/repos",
        "events_url": "https://api.github.com/users/pinheadmz/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/pinheadmz/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30988#pullrequestreview-2493471520",
      "submitted_at": "2024-12-10T20:12:05Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/30988"
    },
    {
      "event": "commented",
      "id": 2552624259,
      "node_id": "IC_kwDOABII586YJfSD",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2552624259",
      "actor": {
        "login": "Sjors",
        "id": 10217,
        "node_id": "MDQ6VXNlcjEwMjE3",
        "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Sjors",
        "html_url": "https://github.com/Sjors",
        "followers_url": "https://api.github.com/users/Sjors/followers",
        "following_url": "https://api.github.com/users/Sjors/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Sjors/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Sjors/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
        "organizations_url": "https://api.github.com/users/Sjors/orgs",
        "repos_url": "https://api.github.com/users/Sjors/repos",
        "events_url": "https://api.github.com/users/Sjors/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Sjors/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-12-19T02:07:54Z",
      "updated_at": "2024-12-19T02:57:51Z",
      "author_association": "MEMBER",
      "body": "Looks like the merge conflict is with #31072 as well as #31223.",
      "user": {
        "login": "Sjors",
        "id": 10217,
        "node_id": "MDQ6VXNlcjEwMjE3",
        "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Sjors",
        "html_url": "https://github.com/Sjors",
        "followers_url": "https://api.github.com/users/Sjors/followers",
        "following_url": "https://api.github.com/users/Sjors/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Sjors/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Sjors/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
        "organizations_url": "https://api.github.com/users/Sjors/orgs",
        "repos_url": "https://api.github.com/users/Sjors/repos",
        "events_url": "https://api.github.com/users/Sjors/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Sjors/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30988#issuecomment-2552624259",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/30988"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 15712190038,
      "node_id": "HRFPE_lADOABII586YIJemzwAAAAOohP5W",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/15712190038",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": "b8b042626ea65c2c2b355a6de69cb7c98bd04de3",
      "commit_url": "https://api.github.com/repos/vasild/bitcoin/commits/b8b042626ea65c2c2b355a6de69cb7c98bd04de3",
      "created_at": "2024-12-19T05:48:11Z"
    },
    {
      "event": "commented",
      "id": 2552841151,
      "node_id": "IC_kwDOABII586YKUO_",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2552841151",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-12-19T05:48:57Z",
      "updated_at": "2024-12-19T05:48:57Z",
      "author_association": "CONTRIBUTOR",
      "body": "`645f625e29...b8b042626e`: rebase due to conflicts and use `std::span` instead of `Span` in new code: https://github.com/bitcoin/bitcoin/pull/30988#discussion_r1878764170",
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30988#issuecomment-2552841151",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/30988"
    },
    {
      "event": "unlabeled",
      "id": 15712672155,
      "node_id": "UNLE_lADOABII586YIJemzwAAAAOojFmb",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/15712672155",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-12-19T06:54:27Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "labeled",
      "id": 15773413276,
      "node_id": "LE_lADOABII586YIJemzwAAAAOsKy-c",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/15773413276",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-12-27T15:06:51Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "head_ref_force_pushed",
      "id": 15906018639,
      "node_id": "HRFPE_lADOABII586YIJemzwAAAAO0EpVP",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/15906018639",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": "f71f1a346c71909750e5e7d11305dd0a1c24373c",
      "commit_url": "https://api.github.com/repos/vasild/bitcoin/commits/f71f1a346c71909750e5e7d11305dd0a1c24373c",
      "created_at": "2025-01-13T14:31:15Z"
    },
    {
      "event": "commented",
      "id": 2587261731,
      "node_id": "IC_kwDOABII586aNnsj",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2587261731",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-01-13T14:31:34Z",
      "updated_at": "2025-01-13T14:31:34Z",
      "author_association": "CONTRIBUTOR",
      "body": "`b8b042626e...f71f1a346c`: rebase due to conflicts",
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30988#issuecomment-2587261731",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/30988"
    },
    {
      "event": "unlabeled",
      "id": 15906562198,
      "node_id": "UNLE_lADOABII586YIJemzwAAAAO0GuCW",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/15906562198",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-01-13T14:58:27Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "commented",
      "id": 2590020502,
      "node_id": "IC_kwDOABII586aYJOW",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2590020502",
      "actor": {
        "login": "Sjors",
        "id": 10217,
        "node_id": "MDQ6VXNlcjEwMjE3",
        "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Sjors",
        "html_url": "https://github.com/Sjors",
        "followers_url": "https://api.github.com/users/Sjors/followers",
        "following_url": "https://api.github.com/users/Sjors/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Sjors/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Sjors/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
        "organizations_url": "https://api.github.com/users/Sjors/orgs",
        "repos_url": "https://api.github.com/users/Sjors/repos",
        "events_url": "https://api.github.com/users/Sjors/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Sjors/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-01-14T14:09:51Z",
      "updated_at": "2025-01-14T14:09:51Z",
      "author_association": "MEMBER",
      "body": "I found myself confused by e8b589ef45d5c94c47209fb952e8b05d631a9c47 dropping `AddSocketPermissionFlags`. Can you move that to a separate (earlier?) commit?",
      "user": {
        "login": "Sjors",
        "id": 10217,
        "node_id": "MDQ6VXNlcjEwMjE3",
        "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Sjors",
        "html_url": "https://github.com/Sjors",
        "followers_url": "https://api.github.com/users/Sjors/followers",
        "following_url": "https://api.github.com/users/Sjors/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Sjors/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Sjors/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
        "organizations_url": "https://api.github.com/users/Sjors/orgs",
        "repos_url": "https://api.github.com/users/Sjors/repos",
        "events_url": "https://api.github.com/users/Sjors/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Sjors/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30988#issuecomment-2590020502",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/30988"
    },
    {
      "event": "reviewed",
      "id": 2550005361,
      "node_id": "PRR_kwDOABII586X_f5x",
      "url": null,
      "actor": null,
      "commit_id": "f71f1a346c71909750e5e7d11305dd0a1c24373c",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "user": {
        "login": "Sjors",
        "id": 10217,
        "node_id": "MDQ6VXNlcjEwMjE3",
        "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Sjors",
        "html_url": "https://github.com/Sjors",
        "followers_url": "https://api.github.com/users/Sjors/followers",
        "following_url": "https://api.github.com/users/Sjors/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Sjors/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Sjors/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
        "organizations_url": "https://api.github.com/users/Sjors/orgs",
        "repos_url": "https://api.github.com/users/Sjors/repos",
        "events_url": "https://api.github.com/users/Sjors/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Sjors/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30988#pullrequestreview-2550005361",
      "submitted_at": "2025-01-14T15:31:47Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/30988"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 15926435616,
      "node_id": "HRFPE_lADOABII586YIJemzwAAAAO1Sh8g",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/15926435616",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": "d83ff66fd74654e67b56d11a7d8e92d38a4bd17a",
      "commit_url": "https://api.github.com/repos/vasild/bitcoin/commits/d83ff66fd74654e67b56d11a7d8e92d38a4bd17a",
      "created_at": "2025-01-14T16:39:29Z"
    },
    {
      "event": "commented",
      "id": 2590500946,
      "node_id": "IC_kwDOABII586aZ-hS",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2590500946",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-01-14T16:40:02Z",
      "updated_at": "2025-01-14T16:40:02Z",
      "author_association": "CONTRIBUTOR",
      "body": "`f71f1a346c...d83ff66fd7`:\r\n\r\n> ... dropping `AddSocketPermissionFlags`. Can you move that to a separate (earlier?) commit?\r\n\r\nDone.",
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30988#issuecomment-2590500946",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/30988"
    },
    {
      "event": "labeled",
      "id": 15927367862,
      "node_id": "LE_lADOABII586YIJemzwAAAAO1WFi2",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/15927367862",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-01-14T17:33:05Z",
      "label": {
        "name": "CI failed",
        "color": "cccccc"
      }
    },
    {
      "event": "head_ref_force_pushed",
      "id": 15927448074,
      "node_id": "HRFPE_lADOABII586YIJemzwAAAAO1WZIK",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/15927448074",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": "bcf1254e91782a33b5a1db542f3758831e0bfe2e",
      "commit_url": "https://api.github.com/repos/vasild/bitcoin/commits/bcf1254e91782a33b5a1db542f3758831e0bfe2e",
      "created_at": "2025-01-14T17:37:26Z"
    },
    {
      "event": "commented",
      "id": 2590687348,
      "node_id": "IC_kwDOABII586aasB0",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2590687348",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-01-14T17:41:46Z",
      "updated_at": "2025-01-14T17:41:46Z",
      "author_association": "CONTRIBUTOR",
      "body": "`d83ff66fd7...bcf1254e91`: adjust test after change of the log message in the previous push",
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30988#issuecomment-2590687348",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/30988"
    },
    {
      "event": "unlabeled",
      "id": 15928937968,
      "node_id": "UNLE_lADOABII586YIJemzwAAAAO1cE3w",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/15928937968",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-01-14T19:02:37Z",
      "label": {
        "name": "CI failed",
        "color": "cccccc"
      }
    },
    {
      "event": "reviewed",
      "id": 2552280742,
      "node_id": "PRR_kwDOABII586YILam",
      "url": null,
      "actor": null,
      "commit_id": "bcf1254e91782a33b5a1db542f3758831e0bfe2e",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "body": "> > ... dropping `AddSocketPermissionFlags`. Can you move that to a separate (earlier?) commit?\r\n> \r\n> Done.\r\n\r\nThanks. Don't forget to drop \"Also, separate the listening socket from the permissions\" from the commit description of e5d36eea015efc31aa38d540af4cf39c9e2e46b0.\r\n\r\nAlong similar lines, though less important, you could also have a separate commit that drops `ListenSocket` and introduces `m_listen` as a member of `CConnman`, before moving it to `Sockman`.\r\n\r\n(it makes `git show --color-moved=dimmed-zebra` more grey, less red and green when you introduce `SockMan`)",
      "user": {
        "login": "Sjors",
        "id": 10217,
        "node_id": "MDQ6VXNlcjEwMjE3",
        "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Sjors",
        "html_url": "https://github.com/Sjors",
        "followers_url": "https://api.github.com/users/Sjors/followers",
        "following_url": "https://api.github.com/users/Sjors/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Sjors/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Sjors/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
        "organizations_url": "https://api.github.com/users/Sjors/orgs",
        "repos_url": "https://api.github.com/users/Sjors/repos",
        "events_url": "https://api.github.com/users/Sjors/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Sjors/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30988#pullrequestreview-2552280742",
      "submitted_at": "2025-01-15T11:28:21Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/30988"
    },
    {
      "event": "reviewed",
      "id": 2552366143,
      "node_id": "PRR_kwDOABII586YIgQ_",
      "url": null,
      "actor": null,
      "commit_id": "bcf1254e91782a33b5a1db542f3758831e0bfe2e",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "body": "Reviewed up to 1b05e1d4ba55a42ba74026b68fa4e616b973e06d.",
      "user": {
        "login": "Sjors",
        "id": 10217,
        "node_id": "MDQ6VXNlcjEwMjE3",
        "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Sjors",
        "html_url": "https://github.com/Sjors",
        "followers_url": "https://api.github.com/users/Sjors/followers",
        "following_url": "https://api.github.com/users/Sjors/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Sjors/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Sjors/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
        "organizations_url": "https://api.github.com/users/Sjors/orgs",
        "repos_url": "https://api.github.com/users/Sjors/repos",
        "events_url": "https://api.github.com/users/Sjors/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Sjors/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30988#pullrequestreview-2552366143",
      "submitted_at": "2025-01-15T12:37:21Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/30988"
    },
    {
      "event": "reviewed",
      "id": 2552728389,
      "node_id": "PRR_kwDOABII586YJ4tF",
      "url": null,
      "actor": null,
      "commit_id": "bcf1254e91782a33b5a1db542f3758831e0bfe2e",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "user": {
        "login": "Sjors",
        "id": 10217,
        "node_id": "MDQ6VXNlcjEwMjE3",
        "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Sjors",
        "html_url": "https://github.com/Sjors",
        "followers_url": "https://api.github.com/users/Sjors/followers",
        "following_url": "https://api.github.com/users/Sjors/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Sjors/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Sjors/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
        "organizations_url": "https://api.github.com/users/Sjors/orgs",
        "repos_url": "https://api.github.com/users/Sjors/repos",
        "events_url": "https://api.github.com/users/Sjors/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Sjors/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30988#pullrequestreview-2552728389",
      "submitted_at": "2025-01-15T13:32:28Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/30988"
    },
    {
      "event": "reviewed",
      "id": 2552832660,
      "node_id": "PRR_kwDOABII586YKSKU",
      "url": null,
      "actor": null,
      "commit_id": "bcf1254e91782a33b5a1db542f3758831e0bfe2e",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "body": "Concept ACK",
      "user": {
        "login": "Sjors",
        "id": 10217,
        "node_id": "MDQ6VXNlcjEwMjE3",
        "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Sjors",
        "html_url": "https://github.com/Sjors",
        "followers_url": "https://api.github.com/users/Sjors/followers",
        "following_url": "https://api.github.com/users/Sjors/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Sjors/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Sjors/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
        "organizations_url": "https://api.github.com/users/Sjors/orgs",
        "repos_url": "https://api.github.com/users/Sjors/repos",
        "events_url": "https://api.github.com/users/Sjors/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Sjors/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30988#pullrequestreview-2552832660",
      "submitted_at": "2025-01-15T14:25:01Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/30988"
    },
    {
      "event": "reviewed",
      "id": 2559620130,
      "node_id": "PRR_kwDOABII586YkLQi",
      "url": null,
      "actor": null,
      "commit_id": "bcf1254e91782a33b5a1db542f3758831e0bfe2e",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "user": {
        "login": "pinheadmz",
        "id": 2084648,
        "node_id": "MDQ6VXNlcjIwODQ2NDg=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2084648?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/pinheadmz",
        "html_url": "https://github.com/pinheadmz",
        "followers_url": "https://api.github.com/users/pinheadmz/followers",
        "following_url": "https://api.github.com/users/pinheadmz/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/pinheadmz/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/pinheadmz/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/pinheadmz/subscriptions",
        "organizations_url": "https://api.github.com/users/pinheadmz/orgs",
        "repos_url": "https://api.github.com/users/pinheadmz/repos",
        "events_url": "https://api.github.com/users/pinheadmz/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/pinheadmz/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30988#pullrequestreview-2559620130",
      "submitted_at": "2025-01-17T17:48:05Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/30988"
    },
    {
      "event": "reviewed",
      "id": 2570362263,
      "node_id": "PRR_kwDOABII586ZNJ2X",
      "url": null,
      "actor": null,
      "commit_id": "bcf1254e91782a33b5a1db542f3758831e0bfe2e",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "user": {
        "login": "pinheadmz",
        "id": 2084648,
        "node_id": "MDQ6VXNlcjIwODQ2NDg=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2084648?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/pinheadmz",
        "html_url": "https://github.com/pinheadmz",
        "followers_url": "https://api.github.com/users/pinheadmz/followers",
        "following_url": "https://api.github.com/users/pinheadmz/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/pinheadmz/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/pinheadmz/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/pinheadmz/subscriptions",
        "organizations_url": "https://api.github.com/users/pinheadmz/orgs",
        "repos_url": "https://api.github.com/users/pinheadmz/repos",
        "events_url": "https://api.github.com/users/pinheadmz/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/pinheadmz/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30988#pullrequestreview-2570362263",
      "submitted_at": "2025-01-23T16:18:36Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/30988"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 16096912166,
      "node_id": "HRFPE_lADOABII586YIJemzwAAAAO_c2Mm",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/16096912166",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": "266ac3267390270e6794d478aa1fbe40e88ffb0f",
      "commit_url": "https://api.github.com/repos/vasild/bitcoin/commits/266ac3267390270e6794d478aa1fbe40e88ffb0f",
      "created_at": "2025-01-28T17:18:56Z"
    },
    {
      "event": "commented",
      "id": 2619619537,
      "node_id": "IC_kwDOABII586cJDjR",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2619619537",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-01-28T17:20:15Z",
      "updated_at": "2025-01-28T17:20:15Z",
      "author_association": "CONTRIBUTOR",
      "body": "`bcf1254e91...266ac32673`: address suggestions\r\n\r\n> Don't forget to drop \"Also, separate ...\r\n\r\nDone.\r\n\r\n> Along similar lines, though less important, you could also have a separate commit that drops `ListenSocket` ...\r\n\r\nDone.\r\n\r\nThanks!",
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30988#issuecomment-2619619537",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/30988"
    },
    {
      "event": "commented",
      "id": 2619994736,
      "node_id": "IC_kwDOABII586cKfJw",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2619994736",
      "actor": {
        "login": "pinheadmz",
        "id": 2084648,
        "node_id": "MDQ6VXNlcjIwODQ2NDg=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2084648?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/pinheadmz",
        "html_url": "https://github.com/pinheadmz",
        "followers_url": "https://api.github.com/users/pinheadmz/followers",
        "following_url": "https://api.github.com/users/pinheadmz/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/pinheadmz/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/pinheadmz/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/pinheadmz/subscriptions",
        "organizations_url": "https://api.github.com/users/pinheadmz/orgs",
        "repos_url": "https://api.github.com/users/pinheadmz/repos",
        "events_url": "https://api.github.com/users/pinheadmz/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/pinheadmz/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-01-28T20:29:53Z",
      "updated_at": "2025-01-28T20:29:53Z",
      "author_association": "MEMBER",
      "body": "Something else I see using Sockman is in the `mempool_limit` functional test, we call `getrawtransaction` and expect around 540,000 bytes back. The call to `send()` returns the total amount of bytes immediately, but it requires 60-70 TCP packets to actually transmit the response. I think what I'm seeing in wireshark is that this transmission is incomplete when I close the HTTP connection with `CloseConnection()` which closes the underlying socket. The client waits 120 seconds for the rest of its data which never arrives before timing out. I'm not sure if there's a flag in one of the syscalls or another way to check the kernel's socket buffer before closing?\r\n",
      "user": {
        "login": "pinheadmz",
        "id": 2084648,
        "node_id": "MDQ6VXNlcjIwODQ2NDg=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2084648?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/pinheadmz",
        "html_url": "https://github.com/pinheadmz",
        "followers_url": "https://api.github.com/users/pinheadmz/followers",
        "following_url": "https://api.github.com/users/pinheadmz/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/pinheadmz/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/pinheadmz/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/pinheadmz/subscriptions",
        "organizations_url": "https://api.github.com/users/pinheadmz/orgs",
        "repos_url": "https://api.github.com/users/pinheadmz/repos",
        "events_url": "https://api.github.com/users/pinheadmz/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/pinheadmz/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30988#issuecomment-2619994736",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/30988"
    },
    {
      "event": "commented",
      "id": 2622122439,
      "node_id": "IC_kwDOABII586cSmnH",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2622122439",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-01-29T16:27:14Z",
      "updated_at": "2025-01-29T16:27:14Z",
      "author_association": "CONTRIBUTOR",
      "body": "> Something else I see using Sockman is in the `mempool_limit` functional test, we call `getrawtransaction` and expect around 540,000 bytes back. The call to `send()` returns the total amount of bytes immediately ...\r\n\r\nHmm, what I observed is that the send call sends less bytes than requested.\r\n\r\n_(Lets move the discussion away from the main thread of this PR into the below link)_\r\n\r\nSome a more elaborate explanation plus patch that fixes the problem in https://github.com/pinheadmz/bitcoin/commit/df1965a4e97ce7f3df067df9b3dcc2bbd8e6e15b#r151906181",
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30988#issuecomment-2622122439",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/30988"
    },
    {
      "event": "labeled",
      "id": 16115116713,
      "node_id": "LE_lADOABII586YIJemzwAAAAPAiSqp",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/16115116713",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-01-29T22:00:56Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDY0NWY4MzM1NGMwMzA0ZmQzMzlhNDVkOTQzOTA4NGE0NGI3Y2E0MTU",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/645f83354c0304fd339a45d9439084a44b7ca415",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/645f83354c0304fd339a45d9439084a44b7ca415",
      "tree": {
        "sha": "2a0299959e865d482e5ff3f0d0f2b3be5faeddde",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/2a0299959e865d482e5ff3f0d0f2b3be5faeddde"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree 2a0299959e865d482e5ff3f0d0f2b3be5faeddde\nparent 809d7e763cc9bdfff3288860a1c530460c76ffff\nauthor Vasil Dimov <vd@FreeBSD.org> 1724411497 +0200\ncommitter Vasil Dimov <vd@FreeBSD.org> 1738244455 +0100\n\nnet: reduce CAddress usage to CService or CNetAddr\n\n* `CConnman::CalculateKeyedNetGroup()` needs `CNetAddr`, not `CAddress`,\n  thus change its argument.\n\n* Both callers of `CConnman::CreateNodeFromAcceptedSocket()` create a\n  dummy `CAddress` from `CService`, so use `CService` instead.\n\n* `GetBindAddress()` only needs to return `CAddress`.\n\n* `CNode::addrBind` does not need to be `CAddress`.\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQQzBAABCAAdFiEE5k2NRWFNsHVF2czBVN8G9ktVy78FAmebgWgACgkQVN8G9ktV\ny79m+x/+IGweNAze/MXpp2H4CgGqs4CBi04L5XBkE7NRag2HFo+F0y42osy4K8wG\nqFcZHjXk7XQrd3cF6aVIFATVLLGZGuKaUjf9DiVb0EsgdrGQ+yLHdzpw9V9e+AC2\naVy1iPVvJM+N7bTrt/LMqcpdAGm/7S6THZFUBlUQ8sGLGkHZy6SzbQCqJ4U7hCRH\n/j+K8GmoH7n10X+F2c4qvL82j/nizn3ZkyfRcijqB48EnhBgbL3nj59OtDCz5DFe\nqw++iNANFC9ksTD0ugt5nSKfwgxtvebNNdNeCCxetVWDHQ4jXM52bFrgYtlohKZj\nLOe9oskjfMuntU3m+FZPcFwdyr8iuYEKJNm0BFty4x9REFj/PnZ05jBBoVerxkku\nfsfezANdekPLl/tSVT8mY+GHwlhr3T1P/gXWFPoUF0Al51jwMs2/zjwiGuEZB/ak\noYnk5YAzFXLeneVCWBN23IMEvWDc++vsA2uZ2QQG6n/won1LHPacjiD8b6eObdWY\nxDV1X+asCvYc7PWoXAdrp3GZ4zMCsQSnUNiNTSB4l+S7w2GGGwfrNTe/LlOKRU0L\ndxTQaWz1LBR/x1D0q0piwhuxYsxtb9geRzSxtTXMGopSd5ImdngAvgL0yGpx/VhF\nf+TbKKiUlubpN/DiZR0lhtVMJTB5eTTIyEH7x4FxGH0mK7Q4NFHkPav45RlsYRrX\nUSRcUUZo/ySM8zVYQYf/Ac5p5VXVzfeg+MEaADsftyGxEJZ+mpZFlDsWL1MbUudQ\n39FJdh9ueLQdc1lafbpbH0w/wo6cXepO3Em2G7DBxAYdqWLO34SEI0TUKviDT3eR\ne8KhtzsLYnOvO9jp1rea5XjT7OHJvwPka6Uv4jDzKp3p/9qElNUHCQzSJVNgb8yv\nsKhIonNb2HaWXQeZAiKvNotrD2J7GVeKqD6xm0DRs3ZJ2UvNnho1wdHsUvp7vagL\n3Z4tmkzpADV9yDNIdPflQ3FemNOEahCpOYcwK7H9kzpgumRoL07Ndf+ecPP0lg5e\nrymaigWt0T6f/NuJA6r5mkgsiJWIrr3w9zzIORyLWRkZRhoT/KLKqInQ2E7mWHrC\nDdqPY0U960V/vikw9yl0WJUqUJ4Y4PJLsQib2qyP4aRrccapQ1W++NfSx/1zRo67\nTgrgFgmkz6IBT4rrqg46QLd0cayUlWViY/YOX1YjK+JmA6pKubR1BeiExDM2oLik\nh+lT6nejlWIqrSO3I/g7r9ESDGXmE5uUZC2FZGql9be1PIlsvDb3o8di16GfGMXs\nZ+r9FGlmMoDfIkleBcy9PNqmSrdd7yU98ENzfSgH0dmAzCFG3ILbEmrjCxP4gyQx\nlUBqrutUAKS+N0Ri16hW+GEYKcFiuQ==\n=wwOR\n-----END PGP SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/809d7e763cc9bdfff3288860a1c530460c76ffff",
          "sha": "809d7e763cc9bdfff3288860a1c530460c76ffff",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/809d7e763cc9bdfff3288860a1c530460c76ffff"
        }
      ],
      "message": "net: reduce CAddress usage to CService or CNetAddr\n\n* `CConnman::CalculateKeyedNetGroup()` needs `CNetAddr`, not `CAddress`,\n  thus change its argument.\n\n* Both callers of `CConnman::CreateNodeFromAcceptedSocket()` create a\n  dummy `CAddress` from `CService`, so use `CService` instead.\n\n* `GetBindAddress()` only needs to return `CAddress`.\n\n* `CNode::addrBind` does not need to be `CAddress`.",
      "committer": {
        "name": "Vasil Dimov",
        "email": "vd@FreeBSD.org",
        "date": "2025-01-30T13:40:55Z"
      },
      "author": {
        "name": "Vasil Dimov",
        "email": "vd@FreeBSD.org",
        "date": "2024-08-23T11:11:37Z"
      },
      "sha": "645f83354c0304fd339a45d9439084a44b7ca415"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDlkNjZmOWQyNDI0ZmU2ZDhjZjBmNGFkY2ZmZDAxMzk0MDhlY2Q1NGM",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/9d66f9d2424fe6d8cf0f4adcffd0139408ecd54c",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/9d66f9d2424fe6d8cf0f4adcffd0139408ecd54c",
      "tree": {
        "sha": "622603d3228d66282e843636e43cdd22a08600cd",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/622603d3228d66282e843636e43cdd22a08600cd"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree 622603d3228d66282e843636e43cdd22a08600cd\nparent 645f83354c0304fd339a45d9439084a44b7ca415\nauthor Vasil Dimov <vd@FreeBSD.org> 1736871862 +0100\ncommitter Vasil Dimov <vd@FreeBSD.org> 1738244459 +0100\n\nnet: separate the listening socket from the permissions\n\nThey were coupled in `struct ListenSocket`, but the socket belongs to\nthe lower level transport protocol, whereas the permissions are specific\nto the higher Bitcoin P2P protocol.\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQQzBAABCAAdFiEE5k2NRWFNsHVF2czBVN8G9ktVy78FAmebgWwACgkQVN8G9ktV\ny78DxR//fDEy2zCuCA3lC8/2UXyxSIBSF14XdV7ufrFZPAoKxQ+vA0NNIWnbNmsf\nnS76yXpX+1fawEMZ4GbVQDxBNJYUo9D3xKHs7+EdHclzYiafhhmblsva9heHM+mc\nnqvWlsacBbcxRCaYyWqmH3GCAyzTZLn378zaGufynN2oCOsNjHpMpe0B/V45WmA1\nS5hyNEC9WS65d7eA2xHJkQgGGxQUqCnHU1W6NwO4dxI6Iub+jk3tC90GdEXBIn+8\njcoma4hRhdtckwcKyfym5zzbAd3pVLDUQU3KjKuUz3nh9HmDJu3NskqgIloD/ZVW\nEwuxWQoKWhPeOei48gOdhQdH5/1gclETLkxk25Bk2SQfyR7YtLtE5c6fXTUlZouJ\nDVGidDDIoQ/1TMnLeCMzCoZS+jpb7IXwwBG/XqmFJyhTjxDxYt+1t+2ig56LsSJ1\n+mFGNBcn++YoRmOqxEwq6ZjpYba+JPqwAUxsETZjF7FgMR46aM8Dkz5wz9P1h9Y7\nBhctBkjXJwCu0+jqJ8wHgaRGnObCC026nWzv6yJlh6/F9YA3dhjFFrxTK2SRtyo1\nIeoRQF8+ilSnen07Ik7dp75rIFIWleHw12ngV5xu2lC1xWr+I6pD3b5a/bzTkb0z\nmkT6aZIi/+m90hui8tPPg2H/oy+FzE7BY6y54qVE41KwvycrOhZWhLXGaZUtGZBH\nev//tCLyNeEE/qAPoB/wuQa5PRA7nPj4I0PkYlaCPR4E2w4zK6dWj8aHMV9A5sKg\nZV2YMVYm4GecInQlGxWu/Sy19ttFm/8NpOjf1bft5U+djv8txqhteHVKVHbSMH6k\nN1PTbrRZ7Y4Uw+Kb2+xGswnfZAB9kcSclT2mIjGDvX30EwXrymlJiSLjKyN1MtZS\nAvTtZjf2KeNiEP3XkGasYbYskINSdtfd/3LhcnJZVNJZQ+20ZLZCTwXXAkp2YpXP\nX2OF4TrL+TDe/lpscU8PBaApRSMxO7M8S58+6Bu/map8XNa3egFzBBUHB9D8JU37\nbCOPZVK/jN1vSl25GtHLiYmleOBdqK50TOK/EuRUfB2AXBKLVLmtu/9jSsX7xxUT\nDBi3ovC20VlGJyIqlYTB5D2aXDN496XB82Tsxvm/anxaD4yIJNCAnjaV0263rwH6\nx0aBUqVZYs36LLA0hFGs+YYUAmZgwLipJYYXThB4WNsNxfx1z/j4VC8ABQ+EGihI\n6cjMN+Hn9IdAPNVUS9zqbBDvsUpjQEh9fuKjZi20XUyLtN+ATe4HnaQ+HtFSE6rP\nwbVNAG0Vx3HPC801mRl84cjkIWvid11BZTry742X8+FL1vHVa/40ZMK4glFSN6IY\nNej/HtG0Rh5fR+10Ii9qnMB6GafreQ==\n=Iql5\n-----END PGP SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/645f83354c0304fd339a45d9439084a44b7ca415",
          "sha": "645f83354c0304fd339a45d9439084a44b7ca415",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/645f83354c0304fd339a45d9439084a44b7ca415"
        }
      ],
      "message": "net: separate the listening socket from the permissions\n\nThey were coupled in `struct ListenSocket`, but the socket belongs to\nthe lower level transport protocol, whereas the permissions are specific\nto the higher Bitcoin P2P protocol.",
      "committer": {
        "name": "Vasil Dimov",
        "email": "vd@FreeBSD.org",
        "date": "2025-01-30T13:40:59Z"
      },
      "author": {
        "name": "Vasil Dimov",
        "email": "vd@FreeBSD.org",
        "date": "2025-01-14T16:24:22Z"
      },
      "sha": "9d66f9d2424fe6d8cf0f4adcffd0139408ecd54c"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDczYzA4ZDY0ZjE2NmVhOGI5NWMyMzdmNDQ2MDBjZGRiZmE4NDA2YmU",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/73c08d64f166ea8b95c237f44600cddbfa8406be",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/73c08d64f166ea8b95c237f44600cddbfa8406be",
      "tree": {
        "sha": "7907ed9c7f079981a5f1b834df324145ae0cdb90",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/7907ed9c7f079981a5f1b834df324145ae0cdb90"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree 7907ed9c7f079981a5f1b834df324145ae0cdb90\nparent 9d66f9d2424fe6d8cf0f4adcffd0139408ecd54c\nauthor Vasil Dimov <vd@FreeBSD.org> 1738071384 +0100\ncommitter Vasil Dimov <vd@FreeBSD.org> 1738244460 +0100\n\nnet: drop CConnman::ListenSocket\n\nNow that `CConnman::ListenSocket` is a `struct` that contains only one\nmember variable of type `std::shared_ptr<Sock>`, drop `ListenSocket` and\nuse `shared_ptr` directly.\n\nReplace the vector of `ListenSocket` with a vector of `shared_ptr`.\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQQzBAABCAAdFiEE5k2NRWFNsHVF2czBVN8G9ktVy78FAmebgWwACgkQVN8G9ktV\ny78e6R/+O6l0PDJ8+aaLIVq0gqZEoDpUmgt0VorEv+S4BVEg1iHPfY57AZZh6822\nk13sdLanxpjcr0wcswqM8AyFPwV/jWJuUy4kvzN8pmGdSDVK0iVZcR1XO1v09vO2\n5e7pkPJwsHpf6lRtJTxztk6As0B6H+8w2xJmDFA9zzHcEnxqCYdMSZbddDiqBtGD\n/bMZi5I+Df/65e1VF953tSso5nGhZtvKbxbkApq5BWXEnTpJR1TixQGPYi4stfkj\n7Y2AjH5CdUWwcX3TIMzNNlT64l92AXEk/Sudli3+//3pU9xoqWrCJx1J0LIbW27k\ndNWp6h9UhTTRTUp43sOWnhze1jDMbz84qOkNNHivaa+5Jp0U1N2XuiihAL+dSz+M\nAtb4X2BGnxMLrGSVRDSaX/rX6mjMDzcFjhq7DVdlHixQEpk1lqFsM8NavR3HON8F\n8SV6Fyh0pZQRNhZb9zHfmdVQg8nrB0nRMIzGQXpIUA7F6m37+rVzzDDHcGs5yUvP\nMrYsluyaTOhlaqM8GsebVjZtYr5DaIclneEAzCCOISqaI+X9Wq+y5Do3Cwxzvupd\nbAkXC2OhdGDwvDv280lMqmh/AcnADsyymDegQxsTdfBR9qCfoZpUbxZUfQkznQ82\n3lfSHSy7NBalUdXaTStkVw3fwR48n1wcyROL3unpIQXNVjM02YNMWaaLmHldpPWd\n2BMHYoBepmb+4TtZlHCl93mh/KzQMxfcsQe+BdRBm0Lkb7eu6l2zPx3RIRtTDFI0\nrUHFVchdVKDMWuyvO3A28jynWlz8IxkgjZ2IfC8BhJtzBMDw54K2men4nNWNs9fg\nWl4OWfAdJCW3LfqAk9YNIalXHHdZ9NoC2LnIyq31gz8w+4c0CWfKC6DSOdWhJ2Xg\nFyCPeIh1NSp7xlO0H9V6+rJjOk1werZU/OLMfhbMaP3Hbtt83I0t1cfSZMP/H9ai\nxsAe2bwbVIGwNMTDVwOu0SSf+VA1Q7hoWyBmBq6jthHHwlR8SxYNBmPz4WnyJ6mj\ns8OGaY+o0rknnC/tk6EHkTcP1CFnsG2D9gFglG/Gg0sYaEtL4ZKM+oKULGniEUvS\nJEI6Po1dYgpdfgkzLvWM8Gy7fxg/l9oSZiAZl1ytitRU2ibkcu9et0Wgcco0/GyY\nMWOYwfZsf3LrBJQ98kMAXepJwirIUkU69ODE8LhOkurEOh6/QAwRZ7PZodsK71VI\nxJVSB/4jIE3pSogX9B5hx3C3p2y6wzk8jLoaZtIpouZwMSK2mghhHfOLr2QTwqNj\nVgtl/2UaEsqW0HcAJG8IMbNgAIw4PdD8UQBDdbGSsG3uD5YgXGx/ZCkzMvi9nxAA\nq3m9gWFPF0g/PtvkoMtogqjKfQlt3Q==\n=YqiF\n-----END PGP SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/9d66f9d2424fe6d8cf0f4adcffd0139408ecd54c",
          "sha": "9d66f9d2424fe6d8cf0f4adcffd0139408ecd54c",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/9d66f9d2424fe6d8cf0f4adcffd0139408ecd54c"
        }
      ],
      "message": "net: drop CConnman::ListenSocket\n\nNow that `CConnman::ListenSocket` is a `struct` that contains only one\nmember variable of type `std::shared_ptr<Sock>`, drop `ListenSocket` and\nuse `shared_ptr` directly.\n\nReplace the vector of `ListenSocket` with a vector of `shared_ptr`.",
      "committer": {
        "name": "Vasil Dimov",
        "email": "vd@FreeBSD.org",
        "date": "2025-01-30T13:41:00Z"
      },
      "author": {
        "name": "Vasil Dimov",
        "email": "vd@FreeBSD.org",
        "date": "2025-01-28T13:36:24Z"
      },
      "sha": "73c08d64f166ea8b95c237f44600cddbfa8406be"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDk3ODdkYzkzMzVlYWVjM2Y3ZGViMjY3ODUyNzA1ZTBjNTc3MWVmNGY",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/9787dc9335eaec3f7deb267852705e0c5771ef4f",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/9787dc9335eaec3f7deb267852705e0c5771ef4f",
      "tree": {
        "sha": "1e3e438346552c3a3488cf78cf5f930decc79310",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/1e3e438346552c3a3488cf78cf5f930decc79310"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree 1e3e438346552c3a3488cf78cf5f930decc79310\nparent 73c08d64f166ea8b95c237f44600cddbfa8406be\nauthor Vasil Dimov <vd@FreeBSD.org> 1724420200 +0200\ncommitter Vasil Dimov <vd@FreeBSD.org> 1738244460 +0100\n\nnet: split CConnman::BindListenPort() off CConnman\n\nIntroduce a new low-level socket managing class `SockMan`\nand move the `CConnman::BindListenPort()` method to it.\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQQzBAABCAAdFiEE5k2NRWFNsHVF2czBVN8G9ktVy78FAmebgW0ACgkQVN8G9ktV\ny78MBx//ayXk2uR7uZMCrSAbPgw4zOHAhsTxZ+qDGng0dpKM7YHT/eFa/DGqYfvV\n4D2XRaoMk5N3W9yXiFF04VICl1lnoDB8hgxcDb9Bv13TRCBjTk/vUFGyBWaHQJiP\nXE8987ecA0znyGmPOd1yNsb7/N6JuXD/a7Z5mD1+4H4c3uzRLL9dGV6YaHTL6KL+\nkgayl8SnYGoeljofBBU5MXfnsVjoPqOdZtfiFZ1vNJghKCdfFRgX+vrXCWEyl3/y\nB0jOF+I0lT7xHpauUO6IxoDgCFO0gKZvL4AWYTvMPtY+rNsWXhmRinlpkD0bCkSd\nuq9s4pYOH5fVE/r97g5vl/hk+V0++mIXQuYWk8NRFsCn6J2iQYrDc3FBcq4LMnSu\nP8fdg2ysl3asSQiDgJPX9Z7ClbrQqeSjwW0YPn0d42XAp8D72g6jERtr/nF/HHia\nDc7H9xkWgALBORBnmeIb5j6A7+1eARuscpG7GG+3WIEE/0V7XRZgmQs5LLJ65IVd\ntp02ytrSEZKsU45Wym9JLB2e0z/wRikaWD+wLd6ro+KNDOMxVgS9w7azejXaxnIc\n/JvymApqLLBr2/ArOPHoyBHth1sQBm2rMvfgjsNzA3336FIRgqNFcXHu5fe2blRw\nhqdsKl4QaNOxIw5tBkSkGV3elIRxOHS0PnBFC1O3fAW8iCttmyqW36vvmIjq9E1a\nS5acGUxsf2KVlAITC5husZhmUDiFTw74clUJYmj89QIAVuqtMyKDzp7JYWWMCSa8\nAveCnDZ89SnSZPjGKo51KZbCMVQYM4zzaEDI+Vytlxmh2OOGCEV/usoijiy36/RK\n0w4/qbwdnJLC63NA339UuhDnfSqWl2sRFNqk7lUIICfUyed4t5BWX3IfyMY5tYEb\na+QnImodzihTtfAro3wOwXNjhxz4f3e4js6ZxYXdJhib73d/Wv6mzGHVoVlR78xs\nr+c0cz/omemUZoihxtT3EdyInjYtDW/c6k7rG64pSU0OsxUlqHN81LNKn5vxOMOX\nnJiiuBau2MosAeHtJWMVc9iqXS+2Be5Adzww1oJd2eWjBIs6vdF1FKoGv0X6Ot38\nQMjCIt1kUquDOhnscIDHF5K/gDBi0gPp35IDhHcTJ+86HS7mV/uHRevqsBEuxmJw\nWqvyDaaDBxOcf4H59ZXBMKRcaELjDrSgD8LSRs0pKcupxqWgsQNNWgLojia8YcJw\nwRBmwAf1IOUIUDP4bpmc+YCYhR9tGkl+2Mf3/i8bhsvqYasCdCV8ardN0j0W5SkW\nCFp2y7+JR6FjcS8j56kknFmExOJ8Q5Z/NlZssSz4fOceDABQHCyIED9fJtrHz/dQ\nb/81ReKVByYrbtYNE5yKWhbQIe0cZw==\n=NrE9\n-----END PGP SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/73c08d64f166ea8b95c237f44600cddbfa8406be",
          "sha": "73c08d64f166ea8b95c237f44600cddbfa8406be",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/73c08d64f166ea8b95c237f44600cddbfa8406be"
        }
      ],
      "message": "net: split CConnman::BindListenPort() off CConnman\n\nIntroduce a new low-level socket managing class `SockMan`\nand move the `CConnman::BindListenPort()` method to it.",
      "committer": {
        "name": "Vasil Dimov",
        "email": "vd@FreeBSD.org",
        "date": "2025-01-30T13:41:00Z"
      },
      "author": {
        "name": "Vasil Dimov",
        "email": "vd@FreeBSD.org",
        "date": "2024-08-23T13:36:40Z"
      },
      "sha": "9787dc9335eaec3f7deb267852705e0c5771ef4f"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDBlYTZkODBkMGRiN2UyYjU3MzM0ZmI2NjI0NzczMmY0NDM4Y2U4YzI",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/0ea6d80d0db7e2b57334fb66247732f4438ce8c2",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/0ea6d80d0db7e2b57334fb66247732f4438ce8c2",
      "tree": {
        "sha": "76f98c680d947bca2407df4eca0e5856051f9582",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/76f98c680d947bca2407df4eca0e5856051f9582"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree 76f98c680d947bca2407df4eca0e5856051f9582\nparent 9787dc9335eaec3f7deb267852705e0c5771ef4f\nauthor Vasil Dimov <vd@FreeBSD.org> 1726578346 +0200\ncommitter Vasil Dimov <vd@FreeBSD.org> 1738244461 +0100\n\nstyle: modernize the style of SockMan::BindListenPort()\n\nIt was copied verbatim from `CConnman::BindListenPort()` in the previous\ncommit. Modernize its variables and style and log the error messages\nfrom the caller.\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQQzBAABCAAdFiEE5k2NRWFNsHVF2czBVN8G9ktVy78FAmebgW4ACgkQVN8G9ktV\ny7/wah/9EWmvm+k3/p6pK6jiLTQxyaYLRxpBoqLWBi3K1Tw3TDkEHGWGz5g0ckxG\nBWihFDm00T4XWm68DfRWlclE1XxCEjwz07VDVcgnOZrulaWWVL0HPZwosn2CTF0B\n89JnLzKLMG4q33Mvb3m9LiOjOi9y0y4nZYDpWCaJc3sLUgKXSxUV8ZEnkuAMS6+C\ndLutjJO9z4f7Ip2SbDwnSHh9kytVUAvotAod2CZus/RSauQJu+BnbA8ooFyyLEiT\nvNyQ9RGYAa1vuhYcyJuYbkAh78xW2v6AT7K3Y30IIPtSdRHuI5eJa0bov8S19ThD\nuVjdlMHoCmZ9EgYuGNddaioi6jAispEaxYUf02uW9QXh2sZ0dWjQP6L1z2tnAO4z\nIDzRBcUW2WodmIbC0fMcDP3A8StEsctwtzS5v4+/QLMIeCsblDAW8u7J0Rcu5AcG\nUI9b0ASrDMDp3AqDUe371njBaQm0tvF1BPRxqmuWG45cxOJXoMcmqJYXr7jiHxwC\nEKly8N4cvXLzFHdJZpS9CH9O8mMKnVCEywbDJyhIsvWo7C4yBSRWoSNtwdhRnoGv\nFCpFZwrdmJ1l5kolBwJsqgAQPV8U5kpHTHWwFVXl+CHsh0yO8ei/Dho8eL5iTxeL\n8uhvVHu66wlZX1ZH451HkpV/1oFm4luWLR9YW0Cva/d/nYjbDAGjxEbre93vpkB6\nSOp5P7ebLs9bgjemw+BTjbGEK9UdjsItMM/dPWsCp49bnf0wHQaQu4IpH5Wlbg0X\n4EP8kkas5l16OsoSnnPFZ+ZXh+pyTu0sYvTRp62QJdaM2anYJk/hoRIgcJS8X773\nYmGFUMXp7n3BJkL9NFqMelhVs6F9OjBBalSZilPOq48Dk80P+F8bbe9AHvOL5wPL\nxknrt41wTOEd3WGIR497TGDRJW7Nhpu/9Ig8EDYkWp5FDC5wI3aSC2mX0HPQPCWO\nYV67Jtbs/HfZO5lEnEr8kou1D3HMbeJ1NPqn9lWa2NzDD6EREq2JiqzJoElSzLJZ\n40smYAJXdE5HxGdi4EiVzK1Wxi6T9JbZMkPzEJdvwLnbCzWejIZTwFn8R9LLpGoQ\nkQS9u0TSAnGEANELSUFMFfZIgMskdWTsJ1mRM/eO8sWgaUFwa0txDWT+6yrFv2W4\nQ6DhugJGDq9Si6Ypp3O5YUe6iL95anI1xAqSa05Q7r1ObIdsb3O6lNa+6Sy96W0A\nEYnbOXeokpmxphFlnzJmJc0q9Xm5XqPYBcKZB2RWVSlvcfRl+vsVCkwI7Je8e0I5\nN09C3ZJP9dmY5s2Rdv610SvrNWIugdL+LpQKZql1R0F/etTiDPTUMGlhCVmEDMEr\ntygP0BkVsCGAGTFf9J9mY/evv61FEQ==\n=YTFu\n-----END PGP SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/9787dc9335eaec3f7deb267852705e0c5771ef4f",
          "sha": "9787dc9335eaec3f7deb267852705e0c5771ef4f",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/9787dc9335eaec3f7deb267852705e0c5771ef4f"
        }
      ],
      "message": "style: modernize the style of SockMan::BindListenPort()\n\nIt was copied verbatim from `CConnman::BindListenPort()` in the previous\ncommit. Modernize its variables and style and log the error messages\nfrom the caller.",
      "committer": {
        "name": "Vasil Dimov",
        "email": "vd@FreeBSD.org",
        "date": "2025-01-30T13:41:01Z"
      },
      "author": {
        "name": "Vasil Dimov",
        "email": "vd@FreeBSD.org",
        "date": "2024-09-17T13:05:46Z"
      },
      "sha": "0ea6d80d0db7e2b57334fb66247732f4438ce8c2"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKGI2MjVmMTU0Y2NhMjRlOGRlODRmMGI5NmFmNzAwNmYzM2RiOTdlNzU",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/b625f154cca24e8de84f0b96af7006f33db97e75",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/b625f154cca24e8de84f0b96af7006f33db97e75",
      "tree": {
        "sha": "1d0e04602c9f4fd99b4cbd0270d0251138081b5b",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/1d0e04602c9f4fd99b4cbd0270d0251138081b5b"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree 1d0e04602c9f4fd99b4cbd0270d0251138081b5b\nparent 0ea6d80d0db7e2b57334fb66247732f4438ce8c2\nauthor Vasil Dimov <vd@FreeBSD.org> 1724670893 +0200\ncommitter Vasil Dimov <vd@FreeBSD.org> 1738244462 +0100\n\nnet: split CConnman::AcceptConnection() off CConnman\n\nMove the `CConnman::AcceptConnection()` method to `SockMan` and split\nparts of it:\n* the flip-to-CJDNS part: to just after the `AcceptConnection()` call\n* the permissions part: at the start of `CreateNodeFromAcceptedSocket()`\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQQzBAABCAAdFiEE5k2NRWFNsHVF2czBVN8G9ktVy78FAmebgW4ACgkQVN8G9ktV\ny7/icCAAkjAFfClN/sM1FSlFyqgbY9wiWTxTDueSX59ElsSdCztiZfLHpYdP5Yrz\nQqscneOMhpo75fT5c7pAQp3eZwhoeYsw2BfwK5lHMfUJvLBgX+FA/NyVMFpMFJnx\ntutkr4lwFg9dBbZXKnj19JfLlTKmaAgEG95ZmuoHuXRthGpY3vQ3QjnNjJijIOXY\nVf/52/JUQL5MZgjjuWnDrYelfcRZqtWpYcZ3CfdcAx/R/Jynq4DiEl3mo6qVXMZF\nZGNOacpSJVyG0Peqfa9QKLPo6LviFQVgP8I9aInPMfyJ68xKiBdmuzHpgKDKy2v5\nb6AugP7ZPfMRAlPyfFaxFIvXhtkj5r6DJO00UKkI/4rtEF6Yxe8RlD6PMT1Au9Hm\nxypNMDSFsx6CLZ1xZefIcMjYwluBzYExpRytRIq5SWTpzvc0BQseSrTvsnwOwhs9\nmy4BTPqk1g48dTj+dQeHY7vnnTOqxSa3gAc8/KpD7YlEJLzFrwFyxBugNX0PexUr\nkayM99W3LPVFOt8e1vMo0d1j60XipVr9iYMF9Ue4IYcDrE/6Oskl9jsqW1gELspN\nUxJcL2Ob2DHREP4pEN3w43rr3DSbIAsmEeVA4fGM5ces7Vf6njqVV/6UkKUuain2\n9Ie2zP6T+NQFXcrgfiavOxBbLzwsGvLrZ5I3a6gUOJ4zr+tUTHvqb4ujCDoPvGpg\n8k2cezhMjxKMvuJVOb0QSL9hCqdHpb71scnqsMRMSFetsGoDDaC+BqwH/GnasHm4\nubtEhHa5G2xT3+xmUZcsF8h5dxhJvWFSUb7oK5WniB6dfW+AJxF2dC37iJY3h3M5\nsF+bIkElqYSjmVWVTnuCRSuJEagTJJL7GMv2WtE7VQq9hl8mYLtTP2YMFEUHWW6e\ndg7Iw6knrLCQmFmzJ4MZbBNNoJ+obSicGEm2FICKVfDFJS8VN5wOtTqW580WEU4o\ncbRCKa5coc0gLK/Fr0/1WAn8SnZ/S8MlsTVnDzOO/0Nu4wnOYEdeZERkMy2rm2N1\nBOP+f8H/FFXDXBK8KiK805yx+pjltKufasrDvgtEMivDre9Uv7ofkO/4mkf1izrB\nG+MGQl3h+8E7/n6YxehfmML0khYrIOa8SyMBZUYSjt/qKd/l2gItuzHOFh8OReRK\nF2cmqvmzslz5ySbu+r648cDHczSz1s+jzR0cJfyULIavJtlYWU7BJyIvJyMKdBH1\nktJIBTUWQBOKRHL6nsXTDxA18uXHAXt6fKx9RzDccCA4O69F4mhirhoUk1bxutWX\nWHxvoyEFw05thIVRYyf1YvcxFt77ht1QwqPK3yNyCiaNSIXai5Z3+BNdjh2JtJ7k\nEENclrwWOl+usTrpR04QVVojuFlpVA==\n=Uapo\n-----END PGP SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/0ea6d80d0db7e2b57334fb66247732f4438ce8c2",
          "sha": "0ea6d80d0db7e2b57334fb66247732f4438ce8c2",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/0ea6d80d0db7e2b57334fb66247732f4438ce8c2"
        }
      ],
      "message": "net: split CConnman::AcceptConnection() off CConnman\n\nMove the `CConnman::AcceptConnection()` method to `SockMan` and split\nparts of it:\n* the flip-to-CJDNS part: to just after the `AcceptConnection()` call\n* the permissions part: at the start of `CreateNodeFromAcceptedSocket()`",
      "committer": {
        "name": "Vasil Dimov",
        "email": "vd@FreeBSD.org",
        "date": "2025-01-30T13:41:02Z"
      },
      "author": {
        "name": "Vasil Dimov",
        "email": "vd@FreeBSD.org",
        "date": "2024-08-26T11:14:53Z"
      },
      "sha": "b625f154cca24e8de84f0b96af7006f33db97e75"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDE3OGE4Y2RmNWE0OTE1OTQzYzE1OTcxMDBlMjVhOGI4MDRjYTQxZTA",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/178a8cdf5a4915943c1597100e25a8b804ca41e0",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/178a8cdf5a4915943c1597100e25a8b804ca41e0",
      "tree": {
        "sha": "65e9591efdb16193dce24ee63bcb9a93b4f5f2fc",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/65e9591efdb16193dce24ee63bcb9a93b4f5f2fc"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree 65e9591efdb16193dce24ee63bcb9a93b4f5f2fc\nparent b625f154cca24e8de84f0b96af7006f33db97e75\nauthor Vasil Dimov <vd@FreeBSD.org> 1726586947 +0200\ncommitter Vasil Dimov <vd@FreeBSD.org> 1738244462 +0100\n\nstyle: modernize the style of SockMan::AcceptConnection()\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQQzBAABCAAdFiEE5k2NRWFNsHVF2czBVN8G9ktVy78FAmebgW8ACgkQVN8G9ktV\ny79E9iAAoqym10qzcaUqaz5LvlgLnSSj1BxGxr/GVuJIu8CuY5P3NT752JNWNaBa\ncfBYvCIc2+LlznVZkUaxGmRGh6QlJtYWgao6TEAun7VXwbfaSz/1r8bawPD17/N1\nMYG843EIvqb8U/rq7TlsP/WWffv+9qsSPZwh8/k70Q3+W0SmuCJ5mRRe35hMRwvx\nxWizrRFyTqvqCZ2umxqaKOHQU8PIu6Rq9FT9FMbpwF58tnnfgiIwmdyK/ixstTud\nepC+ocYYO0IaDnVBZxjXf7/BLYALbfo6VfWvvQQELRpfidealFA7FQo3UzdfTXER\nw3lozTK6ArAtcqaAbX1rPUlVGdbIMVqsPaLPUBwvgXgnt5cWwJpExuhsWYTlh9KT\nnG0/eCHKy9h8bGIa5fpFLwkGSRatHlnB4rTeIdY3sHYl56K1LpWLIkK9ylVC6UYu\nsBGwYa32Yx2EnekKKhVZ18CMZr4A5QBnwc+5qJlVTqcju27vuAyxAz0rPkKfzkTf\nXsv7LLe5yFRB88Nh7c7cRUap8DZHkdFXMvOS2Q1NorKIvZkk4f1VecXaQkp9WF6y\nF86gnI/fGr7L9YxxbWMfDrdpYl4sf1aKnx2cYlpMbc7TzakE2PFfTG+OeIhotZm1\ngk9dDv8mL4A0xE9nHpfT5YzDfc/BUBbiMXogRhXHTySC2TIdXGwEyKI7kwS8PhV8\n/y2DAv8lkRIW1rnB3nbChmpLBrHiCki8mhDsqfEMCdSmhGW0RdCYrPRo00xGn8fL\nt+dsy5vVsT0K1XlhFOIwuhukJ+Q1r1fJLvAOZxRGwWs+GUUHOKD4GCNKDdFyODP2\n/BnNUgQOGbZF6n++nEiM1g41cRfExrfgD6PWswwbV4+1mwHWbREd+mIXo6N15mta\nnG6YUJfvRVqpX0eWGLZKJ4gW/455YUlsdWh2ZuohUY1VW6OxxshmwaXzKJYn5000\n9XxSVnTvN1em4HJjluE+U8UifydR6L+NozCaywE0wv9f4AOPjLo0l4L5u+YG74ND\nH6xjYIKQJHDTtpX/sNvm9c69mJHlIJSLyixDGP26SWrKhyudwKN1ZU+Mn/x3Boct\nsHkcIrGtog2wYxa6sBcwN/xz1e2+gOqy1xh0xyZIV19quEbA0DxrPOnhqB+ljY3V\nHVOoYgb9uyDn48Ru5MbBIzri3w0j4ZZoOQEB02tZOkKW7MqBKmJn6qkIR2DLIf55\ngforfNWVbAhDUlCeMCkJvpjzAQ1oi3jFQBSs4PkhZ3+Nq3KugXR1YSNhZXL6t18O\nQa9dN7vnOZJhAxDFIT+Z1ZTc/qvSWqTI9u0TCgtjAZT5xiYsDXJdK8ojG6E+2Gva\nh1TSpiYoqtJT+RkOvdjBTHXo76ZBuQ==\n=WDuh\n-----END PGP SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/b625f154cca24e8de84f0b96af7006f33db97e75",
          "sha": "b625f154cca24e8de84f0b96af7006f33db97e75",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/b625f154cca24e8de84f0b96af7006f33db97e75"
        }
      ],
      "message": "style: modernize the style of SockMan::AcceptConnection()",
      "committer": {
        "name": "Vasil Dimov",
        "email": "vd@FreeBSD.org",
        "date": "2025-01-30T13:41:02Z"
      },
      "author": {
        "name": "Vasil Dimov",
        "email": "vd@FreeBSD.org",
        "date": "2024-09-17T15:29:07Z"
      },
      "sha": "178a8cdf5a4915943c1597100e25a8b804ca41e0"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKGY5YTAxN2JmNDkwYTVkZWFmYjViMzgxNjc2MzM4ZGMwMTM4MjhkNTM",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/f9a017bf490a5deafb5b381676338dc013828d53",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/f9a017bf490a5deafb5b381676338dc013828d53",
      "tree": {
        "sha": "ed246b968059ac27aab941d77ee2e29da613817d",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/ed246b968059ac27aab941d77ee2e29da613817d"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree ed246b968059ac27aab941d77ee2e29da613817d\nparent 178a8cdf5a4915943c1597100e25a8b804ca41e0\nauthor Vasil Dimov <vd@FreeBSD.org> 1724750724 +0200\ncommitter Vasil Dimov <vd@FreeBSD.org> 1738244463 +0100\n\nnet: move the generation of ids for new nodes from CConnman to SockMan\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQQzBAABCAAdFiEE5k2NRWFNsHVF2czBVN8G9ktVy78FAmebgW8ACgkQVN8G9ktV\ny78P9x/9GrKSU5ZxTmXLhNb6Ba4jShAng/UONr83n+0bZy84MLelNWBMW67c/oiR\n5cpfmthDyqLIFslA1nnCa2Z2ZxUriDFhbW6tAPOLLjT9CCJUpjAIKEr3UDM+KVWZ\n96QRFHksBjABj5tMIZw6lt/e6zKD4DrkwDeylO5itZzwcM8NC9LQxihtBLjxxX6A\nSiklUZmH9cGbctYBiSoaB22sOUhOZHBr/lt5ntvKRk/WJ96a/kDz3751abVq8c5O\nybX9m3zpt5XGL52so9AHcMyHcqObCxZfWKwj5ClGh2a6UijjycuVReU4POufVDa+\nBg30Nu74x/IvC/VTGGmERge6ws++ZZ2bU0EpRLXJvGRo9iG2hCsQauL4JHGV29TJ\nvDToFv7wJceSAoqdt1ZuIElXd3gGTXOxOjoe+YAD0dr/+SGfR9a05MYWdhn9W34r\np9Gj9oSD0KJVVoVWGBsJiTPVf065fVtO5MOBSkkeOP6sqZqO+8kk1j3hJYTf1DMG\neGYfiH2mDsop5MAfzy/GUeNllfA5sZF4LR0uYGY78TAWtGtemMjsLim7c56Teaos\nHubkDCO8tryaviQf/A7C9Y8ZMQaADK7VsiRRPtbIgV4QVEpwt0nyRpTT73nU9HmU\nDB+PCkzvs1z3aIsIEUb3AZdIWJHDFJweo5ZK4rn6if0HTosZToi0LGmniGPN9i6z\nze3i4GiZNd/xHCjqVtPBsPZnST/QorvW7oAzxnyk7zAjhwCjH7bTpMoo9olYs2fU\n0BQXtGNVWcx/HHfFqI72soXXPAD9kVVEa9s0/if+AoYexs/YNmSIZljY8GfhqnRe\nQZk+SrrB+DzNUHHlAJaB2coLhRYqnsUy7BocerofeXnej9O/S9tPFWuHpMu7eeAz\nNw/MvxawN24ns+XfpGBepkYlxQPs3k97/+vVBI5Rl2BHw8boqI+++ONB+/iV9A/i\nL1XqrL+DD9HgcMf5aU9+Ny8ZoZtM6pxgcEXfn7L297Lu2mBETy71oVulZGEaxs5B\nl8rBIHI8IWScLl/UCCZ86XH2cFLpgVWiTWrWqho03ncopqpmDQ8RNklqWIzhrXgy\np7uFA2LlnIW1NjDpHmKhvpqnrlPJ72dIMURlRIAGfqqUB13XsF6mGa2ObzLQ4g3z\nIGoAsWyX3QZnfp+qBqV/p4Px1zzEVe3V3CI55zCU26wHN1xdMfTRu9TammKgMAFj\nD/jIqbG/regTG81MaErg6oA3YENB/oYMZ8vOQypr2M/mSs0TwzZo4oWRldjx907I\nLNZkyTxV3Cy2q7sBSxcBbrj3BaPk9ec02KPDb2JrObDmVwWmPFeO9rfLdao5mCcP\nA8u3+KfhLV8zC/qvzWt7Lfna1SxNUw==\n=jTuL\n-----END PGP SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/178a8cdf5a4915943c1597100e25a8b804ca41e0",
          "sha": "178a8cdf5a4915943c1597100e25a8b804ca41e0",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/178a8cdf5a4915943c1597100e25a8b804ca41e0"
        }
      ],
      "message": "net: move the generation of ids for new nodes from CConnman to SockMan",
      "committer": {
        "name": "Vasil Dimov",
        "email": "vd@FreeBSD.org",
        "date": "2025-01-30T13:41:03Z"
      },
      "author": {
        "name": "Vasil Dimov",
        "email": "vd@FreeBSD.org",
        "date": "2024-08-27T09:25:24Z"
      },
      "sha": "f9a017bf490a5deafb5b381676338dc013828d53"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDM0NzcwNDZmNzdhNGRmNTlkZDkzNmIwMWRlODZjODMxOTk0Y2Q1MGQ",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/3477046f77a4df59dd936b01de86c831994cd50d",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/3477046f77a4df59dd936b01de86c831994cd50d",
      "tree": {
        "sha": "b4b66b775aa9a4298616ac997397fb878cd188e8",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/b4b66b775aa9a4298616ac997397fb878cd188e8"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree b4b66b775aa9a4298616ac997397fb878cd188e8\nparent f9a017bf490a5deafb5b381676338dc013828d53\nauthor Vasil Dimov <vd@FreeBSD.org> 1724767895 +0200\ncommitter Vasil Dimov <vd@FreeBSD.org> 1738244463 +0100\n\nnet: move CConnman-specific parts away from ThreadI2PAcceptIncoming()\n\nCConnman-specific or in other words, Bitcoin P2P specific. Now\nthe `ThreadI2PAcceptIncoming()` method is protocol agnostic and\ncan be moved to `SockMan`.\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQQzBAABCAAdFiEE5k2NRWFNsHVF2czBVN8G9ktVy78FAmebgXAACgkQVN8G9ktV\ny79M2yAAg2+R5dGZAi/V2o9IjWSbqrD4PpRHfhxDFKxeoq07ffjxh6Wv4EOSySZ5\nRUqGA+5//g4jrBHnZyMi641kQ9xHWq8chRwpkG2Zce1mjrkSAgvjeiDDpgDyQUlx\n21c/i06A2q8uRqKDx5Yalqayr8isECctw8sTqFnQImwqltdPcti1NFQTq734FJmE\nJ8j5qpnCbjMx6cfgh6sGmiWn3sodK8zmCac8XcQPKC4Q650QvLq6pXTNzP1+1zI6\nxdMxmG/x4WbUZJ0qw80zwvdPEzVD483GOuvC7ICDEZBRYRF4kTQgKNb21NkPnxgI\nchXQlCvfZ9uKmIEQsaS4e53ECVbYx+FxGNWytz7zQDXj2VWCPChSVqSKJMRMLmTj\nSAhle6U6p7Ve4dhti5PDjw08gXwqLcTynZvsZlmWFaq98cn8OdjR996eQnvj91YY\nYT+i7n+xJ9Ll/2Xo4amOP5IOhxJ9yESIOyePp8GYL639FtYz/ESGbWk5MP0SwnGQ\n5awh/4CST3VKvMsbdlTU1XgvxGnRXTb7P/wW/flYAHqTmH8pagaQIjjsWhd4Cf32\n17z/b20RBXwX+4AIgvWm97YlTzYtaUST1J3LrKhO1l2Lq6Hpgk0BAdovNupuNLE6\nIbhTZtrecPEUVoKf+uYMbWDKd02V/5VTw22aQrB7yroZ51hg8Wc3LbGsER9eQfeV\nJm9bV6bzehZh1I48GaAMjB0bfTm2VnCt0+ck5Yiajzh8ZosQUw2hMk7mn0cMAppI\nScGolbrQY0E3CbSfzfn9XEMo2CYcaF55+Br7fc7IAICXP3kU5ABec2PXUmcnAvWE\nZx+Xn8WzC9U64RL5hRX1bEL1mStVc4XZHNPgLPNlYiSMmpl6VcnXDJfBKKIztqYc\nf1yrIu52G9Q+VprOyKgKjJX8Uslm8yvLfLn7Yxm1A47CUzfki6joXbVJq9L/cBgj\nceD1EccQiipXDd9HVb3pPaChpk+bQkSezIBwMhwNUVtrjXiOkgIvHWsUWOwoZQMA\nAZzC0vFJXlvbKimFdfv1AVy+UbNyunoMn2Q2JJX2Xn3TtAWrnO9OeDHgZ/Ihy+w9\n78GNX3AUd5EsSceXacI6/hJca4reX1OFTjmxh8JiHGqAN9lHsiaiJfBIBJwPRaC6\n86807fxJwUqlecI8OGNhE0ORHanm4t1fW11LBR8YzOcClYiiL9LADHKNaJv4V99r\ncZqRJ8FY3m1CLrdBCOdLtX9iEbJlXmlks9+gtGEJ73wkfeWKNm7kzMFnZIsn5/L8\nOWKibb6X2pZ8MXC6y30/tOyX2HKYIksOZtrvuvikyjYSclgjUreqA53ZrAw6l4wY\n4Vp1lnmJNkf69ut9cXCvryWMx7Syfw==\n=IQsy\n-----END PGP SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/f9a017bf490a5deafb5b381676338dc013828d53",
          "sha": "f9a017bf490a5deafb5b381676338dc013828d53",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/f9a017bf490a5deafb5b381676338dc013828d53"
        }
      ],
      "message": "net: move CConnman-specific parts away from ThreadI2PAcceptIncoming()\n\nCConnman-specific or in other words, Bitcoin P2P specific. Now\nthe `ThreadI2PAcceptIncoming()` method is protocol agnostic and\ncan be moved to `SockMan`.",
      "committer": {
        "name": "Vasil Dimov",
        "email": "vd@FreeBSD.org",
        "date": "2025-01-30T13:41:03Z"
      },
      "author": {
        "name": "Vasil Dimov",
        "email": "vd@FreeBSD.org",
        "date": "2024-08-27T14:11:35Z"
      },
      "sha": "3477046f77a4df59dd936b01de86c831994cd50d"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDYxMDJhNDEzOTI5MzVlZjNlNDBjYTM3ZmFmNmM2MDY3ZTZjZDc1NTA",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/6102a41392935ef3e40ca37faf6c6067e6cd7550",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/6102a41392935ef3e40ca37faf6c6067e6cd7550",
      "tree": {
        "sha": "772498cf8a64bdad3e60533f662742999ed68198",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/772498cf8a64bdad3e60533f662742999ed68198"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree 772498cf8a64bdad3e60533f662742999ed68198\nparent 3477046f77a4df59dd936b01de86c831994cd50d\nauthor Vasil Dimov <vd@FreeBSD.org> 1724768611 +0200\ncommitter Vasil Dimov <vd@FreeBSD.org> 1738244464 +0100\n\nnet: move I2P-accept-incoming code from CConnman to SockMan\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQQzBAABCAAdFiEE5k2NRWFNsHVF2czBVN8G9ktVy78FAmebgXEACgkQVN8G9ktV\ny7+a+R/+MjcPfFnEcYJix3W3Hw6Y5kb65VPOj7uFRP1f4AEJJLcdPjQl0s5dUk6O\nE3BoRP6id/B/BJ8yWURGBhsARxv77i0bKXW45c7dbpSin8nbQrGvEF4XAySy2cd1\n/1gQ0kaveQm1/FkSOJrF4vn0K03pvW10pTYYpejq7y3HkBIBUhVSqCv9A1AlyaqV\nK4KLeqxhyQmLlOQzKW1Fnk/Kzj9nxksR/7dYO/5kVopy+TawXNvsRIDthSqSSKgi\nOlz1ZQGQvNf0Yy20S/HXZcyWCXp00tCBbPhAG/eUhO9MeBFCGWS1+QazFCbbpP6v\n1XFA2jcNgzyAmOgxtL9/ali0SmFDXGwIBTV77ryOgRYuuRqU+KwppdxSVkWmOLvb\n3L+L26vPhkaVfwgj/6g2OXbwPdOXesMnw3kRdGdZHX4cOeEv9jDIIdvEcSYqccCS\nA7ifqWBG4Y+9jw9dOqKQyvGC/5yWof5baqLCu/PX+QWlnSpL6QhnHP1wqGWMBQR6\naOtdxZJ7SlMaMEEiwnV7lGO1c6V/l+hKZQDyVKUZUpHRNIrZF9bsVjSOF9bIGBfn\nbnrXVRzkrzoIqj0Z9Yrzvj2cDbedsVjv+ZDoTCt5yAOpOKKMx6SUZoesVkBLJW/x\nZYmI/HyQc4+LofOZRjMNV/9O/FzMB2dHk2tZmb8kSI0iO0MZHzSYC9PN25GQ/wo3\ntnQhdp/K5A9nKAzVoZnFpkHbNIR3tz9bzPd0J3K+FuSYbC1zfZz/RzYOUbw8RnNc\na546cD1MuyZdcgYt68M6ALc9tmAFfuhQu+6unidTlugc2WthrwZGR12DgRjF+NCx\nZKf3H+mcvef8zJqh2XwvATPagsRBAFcaK4GSYqvY80aU0CGc6y/SSa06RPveJv+W\n3AmIaZKCWB9lU+XYxNDqmhbWxwi5cESRSkbPEApWVAxgKIY7oQ4d7GM7t9N4VNS8\nw5Ux8AXzS+Ro+gMpx/EtrNg/45sfQ0R/a7+mfwuxY6cXowmcAbQGaeCav5SoKhpR\niy0xz2lK+6B/uGNnK6VdiXQjEIIXV6JfvsI7axY+vxGruG8+3LnFJCrZVwwG5H5K\nf4gTSL/8CJKSBFSmHMw0H2L6jmr7Nbat1EvgUag0MenxToKcDXNNqaXkNJO3lY5J\ny6dRS2akoyDOywBPc0wKyl4pI/L32WYKJg8VPmrasDZu6kWm5SVrAJFnhPvSAoxP\n8ql02FnejOT+VgiGIQehqDQIFX/C6s92nsZZolNYFP2VvtBumhg3rwYeoHpoYCzq\nA19c86muwdrVPupzAr88Xx1icEYi8GCfejKk8h0oK5e5ARqJjYk4+jZLeXIMCPy1\nQorBL08MhiC9PzWkxGHvIgOrVGRrHg==\n=yT8X\n-----END PGP SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/3477046f77a4df59dd936b01de86c831994cd50d",
          "sha": "3477046f77a4df59dd936b01de86c831994cd50d",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/3477046f77a4df59dd936b01de86c831994cd50d"
        }
      ],
      "message": "net: move I2P-accept-incoming code from CConnman to SockMan",
      "committer": {
        "name": "Vasil Dimov",
        "email": "vd@FreeBSD.org",
        "date": "2025-01-30T13:41:04Z"
      },
      "author": {
        "name": "Vasil Dimov",
        "email": "vd@FreeBSD.org",
        "date": "2024-08-27T14:23:31Z"
      },
      "sha": "6102a41392935ef3e40ca37faf6c6067e6cd7550"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDhlOThiNDcwN2M2ZmQ4NTllYTliZDYyYjQ4OWIwNzA3NDMzZTIwMzE",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/8e98b4707c6fd859ea9bd62b489b0707433e2031",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/8e98b4707c6fd859ea9bd62b489b0707433e2031",
      "tree": {
        "sha": "6d2f3d9628b63137063af11f091d50ae911a3974",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/6d2f3d9628b63137063af11f091d50ae911a3974"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree 6d2f3d9628b63137063af11f091d50ae911a3974\nparent 6102a41392935ef3e40ca37faf6c6067e6cd7550\nauthor Vasil Dimov <vd@FreeBSD.org> 1726831648 +0200\ncommitter Vasil Dimov <vd@FreeBSD.org> 1738244937 +0100\n\nnet: index nodes in CConnman by id\n\nChange `CConnman::m_nodes` from `std::vector<CNode*>` to\n`std::unordered_map<NodeId, CNode*>` because interaction\nbetween `CConnman` and `SockMan` is going to be based on\n`NodeId` and finding a node by its id would better be fast.\n\nAs a nice side effect the existent search-by-id operations in\n`CConnman::AttemptToEvictConnection()`,\n`CConnman::DisconnectNode()` and\n`CConnman::ForNode()` now become `O(1)` (were `O(number of nodes)`),\nas well as the erase in `CConnman::DisconnectNodes()`.\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQQzBAABCAAdFiEE5k2NRWFNsHVF2czBVN8G9ktVy78FAmebg0sACgkQVN8G9ktV\ny7+u3x//UFxJq65z/db1eI7/L/SpLEIbazT2FMf0xSLwq1VNIAgkMf6YlbDhWZ2A\nvkmXrfMmCouTBSbt0OJVkV0girA2gbI1C7PJUqgoJ/gKN7tdwwJucyTvagirlx5W\nwHJn8bo7wtdWXHw+0/uR0O47jABOsWhQY/aMnUAXZH+np/tUoe1TUs4B5j3DdDc+\n45Ws0ywAJkxPNTJ41XpHENnsmH+noh/f/CniUwPHJb8I2/MdZJ/MiB0HVV5fhfxb\n6UA5D5PQBZ+6vfwrTcNgUG0Q9RbSZv13BLtK+N0W/EpoZuFP2PkZlSGVkGzJWIik\nTfUMz0AzQ4DsR7if6NLN7/xKF8HJN9SQLZmopr8RnN02mxCyfe5BMmrBYgeUREz/\nNCe1c4hlxDkfWi1vvv7UP2Zlq4mM0CD8eDPhNQqI5J8NR0hEjtgCQOFCCTwKE9Nq\nuHDUPFk21862LlFDqZ82SlEbLWHDj5ptkCxgS1w6NbYZOe2u/5Vfh6jIhrDBhGSc\n6fCOIzYOuB9USoZHWV7IDmf+4KtMNk+NOU0dD4HDKoFAyPH52xkMQgPvNbN99Lyq\nx59W1XMEYL5LF+Sg+c6uAxhWoyLzVTkAK6/CMfnzOqiupY7jx64ZOWuX1MDVq16X\nART4ZLY+xY6MDpsN3Ay2eK1jUITq5aG1p8KMNC/oZlYEvhBolBDoAuy54PwffRlj\nG6+rJbS3Jfe27FeSmxAVL+bp97LsA7fRFgRI/uCCY2exapm0okBaq+B4rRBfqtdo\nWSrAomVoiWVuizab4WnMQOHKT8MSCRT/uA+V9Q2GblAX46i2BD4yVk2Rg1Cq/Myh\nqWG1s0ivxJ6ghtYW/PHM6fv8SDwMh/VFZz+Z2i3ljGtQQBWlRuVwYvsNwuQRux1j\ndjVegcMGeHd4n6uI8f+SF0aZMihcUfqtvSVNry/Qnn8jidReN8QZLJ4YrAw3y8ph\nFyykUodenS/G/95DaJnY7h2KMOQfI/EbGrHuGHwZK2pqiBtdtLZzWPK0hIitUUeG\nejrT1Gu9gUQ+hHmfa4a9y60AjlqAZQqd8+wzlmZoSIkiBpa0tNWw116Ry4njdaY2\ne6sUTTVqPVG2i/aVQO083CL5R9HOKt06uUnqE7aKzq9QyMIwZLnGsK/TcgGK3NBH\nfsqmH+Bc2AsYCKPSNhxVz2Jxiy3tc1GjosTnLbbLpVO5FegdZj9/f8gR/64pVrIi\n5UOHByecT9wRb32XhUARZLKyLdFXYhaFbSiHr2uqvv7Vbmv0T4od4FszC6+4J1W6\nA0NETjwQrr7BCTaHQf5eEtMEHdc1r0TyG+3TeJyDI9KGktHIo/7+eSmNKB//gwYm\nMKzCB2LD/OYqOrCJWEEeNNnBZS7egg==\n=OheC\n-----END PGP SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/6102a41392935ef3e40ca37faf6c6067e6cd7550",
          "sha": "6102a41392935ef3e40ca37faf6c6067e6cd7550",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/6102a41392935ef3e40ca37faf6c6067e6cd7550"
        }
      ],
      "message": "net: index nodes in CConnman by id\n\nChange `CConnman::m_nodes` from `std::vector<CNode*>` to\n`std::unordered_map<NodeId, CNode*>` because interaction\nbetween `CConnman` and `SockMan` is going to be based on\n`NodeId` and finding a node by its id would better be fast.\n\nAs a nice side effect the existent search-by-id operations in\n`CConnman::AttemptToEvictConnection()`,\n`CConnman::DisconnectNode()` and\n`CConnman::ForNode()` now become `O(1)` (were `O(number of nodes)`),\nas well as the erase in `CConnman::DisconnectNodes()`.",
      "committer": {
        "name": "Vasil Dimov",
        "email": "vd@FreeBSD.org",
        "date": "2025-01-30T13:48:57Z"
      },
      "author": {
        "name": "Vasil Dimov",
        "email": "vd@FreeBSD.org",
        "date": "2024-09-20T11:27:28Z"
      },
      "sha": "8e98b4707c6fd859ea9bd62b489b0707433e2031"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKGQxYTQyMDRjMTYzNWUxMjkwNjRjMGJjNTMzNDkwYTg5NmRiZTE2YzM",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/d1a4204c1635e129064c0bc533490a896dbe16c3",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/d1a4204c1635e129064c0bc533490a896dbe16c3",
      "tree": {
        "sha": "2877fe67f337555f131ecd61db065f691d17e609",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/2877fe67f337555f131ecd61db065f691d17e609"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree 2877fe67f337555f131ecd61db065f691d17e609\nparent 8e98b4707c6fd859ea9bd62b489b0707433e2031\nauthor Vasil Dimov <vd@FreeBSD.org> 1726905934 +0200\ncommitter Vasil Dimov <vd@FreeBSD.org> 1738244939 +0100\n\nnet: isolate P2P specifics from GenerateWaitSockets()\n\nMove the parts of `CConnman::GenerateWaitSockets()` that are specific to\nthe Bitcoin-P2P protocol to dedicated methods:\n`ShouldTryToSend()` and `ShouldTryToRecv()`.\n\nThis brings us one step closer to moving `GenerateWaitSockets()` to the\nprotocol agnostic `SockMan` (which would call `ShouldTry...()` from\n`CConnman`).\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQQzBAABCAAdFiEE5k2NRWFNsHVF2czBVN8G9ktVy78FAmebg0sACgkQVN8G9ktV\ny79rrx//ZvSxCFiqXs4ilsh+4exc8R/OzbQkHG9BSlT5CAoXHDVqYnhJMr0H1HOb\nY6wM4U47P7WEf6ol/fVA6wxjnF4nui2XWUNySDqiAg9M+hFxmTY/9PoOeJD+oKU/\nHGEuDNAtO4U+qjDKdSLvj0FdwBYk2SMyBqceCsCAodar5aIc2yzypsMRdhAAA3IB\n+XzkAS4h67+l0YKPRkIgyn+vRAwypVFxfii+U3If04EG02UNMr9oNfXx6fdJ2eWA\nmDKRt2P5rEq69dIv1DzBUzR7gnGpLk9rYrjrdwSV5Jc/DV0mAv6pTdRDvtfmL6xf\n0PHk9uJcSCmQQEO9e41UXojIIroVY9Fomnm0A81WHhODcfwc8bP437Xo8o14sbIs\nyIEJQ7omFHu5IKHn9BDdzjvGs2YPqrxmYOw0JcSlPFFXN33j1RdHhN93ejFH6+GV\nvUADosDGcs/FwisqW+TqeI3oe67y8bzn/XCkSqZO/nkOqIbg359lV/30Tg+HPuTb\nP4PquXfuzhtXi+JhxstvxJvTQhKOzeEQ9UjdydJBuiE9/iJVC83J8RGozDvBZlSq\nBHSwKWuf4hanuwToKDnraiJZ4Ws/JIgQyE7drrICvozi/ncv1Cl7XTVbYyQU4Sx2\n3riMt7WE2d8VKhv+5Mua+wJ16vZ7w3SJQzs1HHirm60rNrdqXjofOmuJ5R5kIrCi\nHnHdly89PYDshy9eyA8KtiRGF2S+HtShMyDr+nN4qKfzcrcXe0+zRZc+6l2FxbWf\nO94RS4HzAP8SlkYhnbS1zesbr/Lvn6/gI3pPXVw56ppOwnP43F04+Cp8BEIgXL4d\nznNgmFKoKpVkljGc2JRsQmlsxVd2TlE2j5B3CFBsi3NTiNQr54rVIE7HDxhaIzmL\ngBunX6B6gwT1GyvijOjTfB2c3gpq5VKrICCkNl6+CHycGHoOP42XplOJXv8Bp06y\nBcS6JA57I0lxWrzbT6xKb5onrEQoQRhExKq3dkD8RoV6D1N0b2VuiDOdAylIlygY\npW1iB2EffnXXtikza8qAP6qbDIKUXAh8x5HraomKPkl5ehvzTPC5ITwN/8RsDrX5\nEwxKL+ZRXj2aIOci9I8F/EcBql761cszaOwux2Z248e2vTHedXgb4a01SCASLJRh\nugCZabeqHGDIoz8O55FQKcyOpiJHfxGux6Qa7BiB7x8Ld+zw5XoAdvYzpw/SMLIK\nEpJ84XWdySB5aEo/enjKDExC5TyOISfYEGIxmdNXnfIxAiQTtxhDWte32IZJ2Zry\nzdRmWlmIgEpB4KcXCFm4pHxTEftBbCq15D/3Qo10MC9D/MRCvDf5cYoIMexrX4dv\ntV6BDwqZW64N3qZ2WY5SOYE/6HjCTw==\n=PbLN\n-----END PGP SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/8e98b4707c6fd859ea9bd62b489b0707433e2031",
          "sha": "8e98b4707c6fd859ea9bd62b489b0707433e2031",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/8e98b4707c6fd859ea9bd62b489b0707433e2031"
        }
      ],
      "message": "net: isolate P2P specifics from GenerateWaitSockets()\n\nMove the parts of `CConnman::GenerateWaitSockets()` that are specific to\nthe Bitcoin-P2P protocol to dedicated methods:\n`ShouldTryToSend()` and `ShouldTryToRecv()`.\n\nThis brings us one step closer to moving `GenerateWaitSockets()` to the\nprotocol agnostic `SockMan` (which would call `ShouldTry...()` from\n`CConnman`).",
      "committer": {
        "name": "Vasil Dimov",
        "email": "vd@FreeBSD.org",
        "date": "2025-01-30T13:48:59Z"
      },
      "author": {
        "name": "Vasil Dimov",
        "email": "vd@FreeBSD.org",
        "date": "2024-09-21T08:05:34Z"
      },
      "sha": "d1a4204c1635e129064c0bc533490a896dbe16c3"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDI0OGVjMmQyNjg3ZmFlNDdiNjM2ODhlMDBiOWVmMThkNGMwYzk2NzY",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/248ec2d2687fae47b63688e00b9ef18d4c0c9676",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/248ec2d2687fae47b63688e00b9ef18d4c0c9676",
      "tree": {
        "sha": "d4727f099a4bd03dc71f00eb46f5b44fe7e5d1b4",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/d4727f099a4bd03dc71f00eb46f5b44fe7e5d1b4"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree d4727f099a4bd03dc71f00eb46f5b44fe7e5d1b4\nparent d1a4204c1635e129064c0bc533490a896dbe16c3\nauthor Vasil Dimov <vd@FreeBSD.org> 1726907513 +0200\ncommitter Vasil Dimov <vd@FreeBSD.org> 1738244939 +0100\n\nnet: isolate P2P specifics from SocketHandlerConnected() and ThreadSocketHandler()\n\nMove some parts of `CConnman::SocketHandlerConnected()` and\n`CConnman::ThreadSocketHandler()` that are specific to the Bitcoin-P2P\nprotocol to dedicated methods:\n`EventIOLoopCompletedForNode()` and `EventIOLoopCompletedForAllPeers()`.\n\nThis brings us one step closer to moving `SocketHandlerConnected()` and\n`ThreadSocketHandler()` to the protocol agnostic `SockMan` (which would\ncall `EventIOLoopCompleted...()` from `CConnman`).\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQQzBAABCAAdFiEE5k2NRWFNsHVF2czBVN8G9ktVy78FAmebg0wACgkQVN8G9ktV\ny7+tzB/9HZIvvvSBn+2hdEPBeZ9hoFMvTJpMT+YZsPdn1AxR6Ci6M/A4kn7l8pds\nmaOaVk06JKiC+NKoEe8komAjqyr3VByFcE0JLrfv5Y3JDG/INyB1nz52NWj1v/Cg\nc6by9UiBoTxnm1YcQ7jBzvsFzYSRJM7u9uykFWW+dTEEi6JFNXhUD3tt1aEp+umr\nO4/rRDGkpUOU5qhoaQ1kxw2JKn8BPnPFRnrT3d/UFzoisDU1rsugHX1pzrqgIdet\nV3wURaWyzQ7DsJ7rHga3jWf2pPBugC6VN61o6TVLg5fMM2JLxkQwv2Ta4WrJA0j4\ngTNg3sLNeAKeTVL16hywd1J/n+t77PdrtcMG9tnk9HO8N/Tksf5Pvo/yZr2vD167\nuLFh08EF9jsgYHljniF6kY0gyatsofIMdEVkudd3Mhn39SOxlMYINxMFPbg2AzCw\nBOARsQin7eGjEVhDs6QlFgg7qjdUNii05vCMqT/PNfYzmbP1ValzHaE1cHFTf6Q3\nSelFwZbkvf64e9nCkalJL9iPKsgZxnskLOLGUBUUdvitSWo9RZe5U3YcuCg2nwgU\nSG+hf+ErBF8CxgUUDQooSIx4DjROJriHyCMpRR9FBSTAY59mMl3HvW9bD4L7wCqB\nu8N+oyXKhM8VryY4Z58/EVaNfBokEBXnl2ToeFZz7rjMlspqIvN4rnvOPmcBeo1H\nO/RHTXcIaKRmEwZio1xOajROQKHjOXwu1bEmC4ROPAtlfMYMCJT8H369+mvy0BGv\n6OKPUr7xRCZ9LfQuc5gaUYsGr3yNDYxLZJLa4j+SCgAjdPGqaEutW7b/Vm6+XZQA\n4syS0104aq2EC+YpIjEF97lQJsdu2VHizVUZuX2unjPId4w2bhTuNbgHKtec1Fjd\nnV1FHFCjW9CMfkCGU6t8S7IiSv4gskBcickFV9JIwlZskDANrGkpw7AG6mjwO06h\nZ8cPUTeN7i9UYAMUxlACdIuxRkfZ8isd79hJ1fJPchj4V7nZnylrKXWrp9Pr1SdG\nRkPNrf95wWb+YK6NOe6tkLexvrXFFW0BlbLs7Y1Hw/7ov8FtShNLzLyQZYpNXuUF\nWl2yp3Yj2NSg/LFWR8ROLT4fwHEdWBIlwhRaiYMsRIPwPzkC21YK1zTN8TQhzBwj\nW8Hvl2JqeSLL2U0ZEXD8RVdbuRXOJtSdGt+G0pTHI77+p9/Uien8UxOmPDFpnqmT\n6IronAeTzDCZkHMxA/HjfUio/qBU+xUFaYThJVExtlHQu46JWP8AD/jSz5kqJ1MI\n3HirIYle5PgP52HUqnuyO925fkp/qASwRIuS+jTCUzEa/ZZus+HyIJrAv8/w7Ycw\nT467HwBfpbOx3op+nTBiTcFXf/tdIg==\n=Lk7/\n-----END PGP SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/d1a4204c1635e129064c0bc533490a896dbe16c3",
          "sha": "d1a4204c1635e129064c0bc533490a896dbe16c3",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/d1a4204c1635e129064c0bc533490a896dbe16c3"
        }
      ],
      "message": "net: isolate P2P specifics from SocketHandlerConnected() and ThreadSocketHandler()\n\nMove some parts of `CConnman::SocketHandlerConnected()` and\n`CConnman::ThreadSocketHandler()` that are specific to the Bitcoin-P2P\nprotocol to dedicated methods:\n`EventIOLoopCompletedForNode()` and `EventIOLoopCompletedForAllPeers()`.\n\nThis brings us one step closer to moving `SocketHandlerConnected()` and\n`ThreadSocketHandler()` to the protocol agnostic `SockMan` (which would\ncall `EventIOLoopCompleted...()` from `CConnman`).",
      "committer": {
        "name": "Vasil Dimov",
        "email": "vd@FreeBSD.org",
        "date": "2025-01-30T13:48:59Z"
      },
      "author": {
        "name": "Vasil Dimov",
        "email": "vd@FreeBSD.org",
        "date": "2024-09-21T08:31:53Z"
      },
      "sha": "248ec2d2687fae47b63688e00b9ef18d4c0c9676"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDBhNWQ2NjdjNzhhNDc3MGU1MjYwZDA4YzU1ZTgzNmE2ZmM5MGRiZTk",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/0a5d667c78a4770e5260d08c55e836a6fc90dbe9",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/0a5d667c78a4770e5260d08c55e836a6fc90dbe9",
      "tree": {
        "sha": "6ec6ec6b0f2c9b56fcc091f196bfbabe605f1aa5",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/6ec6ec6b0f2c9b56fcc091f196bfbabe605f1aa5"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree 6ec6ec6b0f2c9b56fcc091f196bfbabe605f1aa5\nparent 248ec2d2687fae47b63688e00b9ef18d4c0c9676\nauthor Vasil Dimov <vd@FreeBSD.org> 1726999902 +0200\ncommitter Vasil Dimov <vd@FreeBSD.org> 1738244940 +0100\n\nnet: isolate all remaining P2P specifics from SocketHandlerConnected()\n\nIntroduce 4 new methods for the interaction between `CConnman` and\n`SockMan`:\n\n* `EventReadyToSend()`:\n  called when there is readiness to send and do the actual sending of data.\n\n* `EventGotData()`, `EventGotEOF()`, `EventGotPermanentReadError()`:\n  called when the corresponing recv events occur.\n\nThese methods contain logic that is specific to the Bitcoin-P2P protocol\nand move it away from `CConnman::SocketHandlerConnected()` which will\nbecome a protocol agnostic method of `SockMan`.\n\nAlso, move the counting of sent bytes to `CConnman::SocketSendData()` -\nboth callers of that method called `RecordBytesSent()` just after the\ncall, so move it from the callers to inside\n`CConnman::SocketSendData()`.\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQQzBAABCAAdFiEE5k2NRWFNsHVF2czBVN8G9ktVy78FAmebg0wACgkQVN8G9ktV\ny7/7Mx//TzkwzFHX6QoB5AegICjN2AfV0cgBTwy7Lva2aU1NePA7vjZz3FO9ZwGJ\nOBLjoOznUG/SrhqZ9icPPPKLiSGzhxuAtjdN08RR4lDjKrdjbVQqLYAm9h6nHPbp\nV1dOdwY1S3D2WFM/NY6jS07h1n4mUbi8NTKKwhvLx/NnMJMymB+qnCIKUjOTCzRD\n+pRHr4rWxQH9VZJXR19Q3/gTpmCfJw8l9pJjXoovmmzGrINgi0R/1YvIuQKsK3KO\n5yfIsdIznCBl1UOW68CZ0DrW5UAeNf3/Ihk+/+bosZJtGdk+0gIJguVwOt4EU0Gd\ncDZpH4XMa5Goro9Zi/P7SZIF6nIuPKN0rBIUKw+VJUpKah+Nj3CWpsQwzyfyKu/b\nSL7HOLIS3tmQBQTjk3cnRrs/02W1wYUtuqxeHgUV2yvkFCtXROeNms+63dTdp+qu\n6ezaVlRnkv53WaQzfPedoRhCNqv+jida4s550pUyEAQmrzHlgMs7dOLOKj1L3oKb\n7xt2M4hVjpuj4flqkRoHRWixxAUSzygcdMRYZC5xyKNOWKVhbv04ZSiWYBlxIJyB\nrCRf2uZfzM3wSvj/AIsSeeXnw1sNm7KFnNlTUMdBaS4I1tqJUH0FxwAquwxjJ2uv\nnfHtuQjRGhWCmEiuVg9dCDDDTcPrJGNkC0M7SmXr1H2JF6n3Cga5f5jpTh69q2pN\njjEJ5pP+dggEEzCvRJTalbRC8lN7XNXOYSKRbiNYemR1GlcMuEdDpU/IE7GdJhUT\nwiFYS237g5z2FEIpuh1Cmwyj7kvc6Bm6RAnSkYAgIm2ncLV/YqM4tXcV8zW5Ppxg\nRJ/fcZZC30razrMxttiAcFMyYQoYCv9V86B048waUsTlhz43ZA7eKqdUeT+lsgo7\nx+mfOjJnqu5PrlGywbrrzSq89/SKokQom7tqPHzpK7ax/R6Thl2w2su7XDv+r822\n7kqzx+ZcjCwJ2pcVbLRnenQi6wz5qtFTkYPh8e4B2fNkwRCBNsxYBPetHeT/31dg\n8uO2G74mQd7iy8cgd5JsgqZcOkmE8uPhx9Z93RCcQmfxLbSrWu64ryFZUKgJYChU\nWDlx7lLO9oQuHu2jVPT9wpw9U2td/bZoZmBxuwx1hLRALTJrRU3ivL5zeLi8slkq\n/kPWdQsK1O8nE3HK9PsyoZFpk7QrmzCeo+1fTeoeZRFXRtr+Pj95SMIxjblmhmQA\nvlov3TocDLjNNxV+tnBH9X1FJvr3qUgmA+4ZguCIwHKm6tFF5vFftXcc2zHigpdE\n4QWovecqZnFtAkJZkqondJYmRjx1Flhb19aLNtDBxBGenVSBJE8gdss3Qlcf2OLf\nLE+iqr2Jc1Wkg+d6b+7tO3sT9zvEJw==\n=djMd\n-----END PGP SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/248ec2d2687fae47b63688e00b9ef18d4c0c9676",
          "sha": "248ec2d2687fae47b63688e00b9ef18d4c0c9676",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/248ec2d2687fae47b63688e00b9ef18d4c0c9676"
        }
      ],
      "message": "net: isolate all remaining P2P specifics from SocketHandlerConnected()\n\nIntroduce 4 new methods for the interaction between `CConnman` and\n`SockMan`:\n\n* `EventReadyToSend()`:\n  called when there is readiness to send and do the actual sending of data.\n\n* `EventGotData()`, `EventGotEOF()`, `EventGotPermanentReadError()`:\n  called when the corresponing recv events occur.\n\nThese methods contain logic that is specific to the Bitcoin-P2P protocol\nand move it away from `CConnman::SocketHandlerConnected()` which will\nbecome a protocol agnostic method of `SockMan`.\n\nAlso, move the counting of sent bytes to `CConnman::SocketSendData()` -\nboth callers of that method called `RecordBytesSent()` just after the\ncall, so move it from the callers to inside\n`CConnman::SocketSendData()`.",
      "committer": {
        "name": "Vasil Dimov",
        "email": "vd@FreeBSD.org",
        "date": "2025-01-30T13:49:00Z"
      },
      "author": {
        "name": "Vasil Dimov",
        "email": "vd@FreeBSD.org",
        "date": "2024-09-22T10:11:42Z"
      },
      "sha": "0a5d667c78a4770e5260d08c55e836a6fc90dbe9"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDkxZDk3YTE5OGZiNTdkNDc4NzBjZTA5NDQ1NGMzNzc2YmM3MzdiYTA",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/91d97a198fb57d47870ce094454c3776bc737ba0",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/91d97a198fb57d47870ce094454c3776bc737ba0",
      "tree": {
        "sha": "cd5d7b85e8a1931fe03fc310a12cc48d744a0f67",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/cd5d7b85e8a1931fe03fc310a12cc48d744a0f67"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree cd5d7b85e8a1931fe03fc310a12cc48d744a0f67\nparent 0a5d667c78a4770e5260d08c55e836a6fc90dbe9\nauthor Vasil Dimov <vd@FreeBSD.org> 1727088625 +0200\ncommitter Vasil Dimov <vd@FreeBSD.org> 1738244940 +0100\n\nnet: split CConnman::ConnectNode()\n\nMove the protocol agnostic parts of `CConnman::ConnectNode()` into\n`SockMan::ConnectAndMakeNodeId()` and leave the Bitcoin-P2P specific\nstuff in `CConnman::ConnectNode()`.\n\nMove the protocol agnostic `CConnman::m_unused_i2p_sessions`, its mutex\nand `MAX_UNUSED_I2P_SESSIONS_SIZE` to `SockMan`.\n\nMove `GetBindAddress()` from `net.cpp` to `sockman.cpp`.\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQQzBAABCAAdFiEE5k2NRWFNsHVF2czBVN8G9ktVy78FAmebg00ACgkQVN8G9ktV\ny7+a0yAAl0BFcb+HJKY0+Cw9VAFnvxPWfxGb34JEEECiJQz3Wkx19KsESNtg8XxG\nRBnQk+iQwXBMXSzZgMTQ06acYmk0sX1nmakjgKMFRKJl9tj4FNtDHCGvSbBud9RD\nmzmdlSnc0QHUXRqOMHLHwqJSvmEgqXLw/IoVOXaHb5aNRy8ejAL8KUbC2Q6fmVKe\npM/j04u5oefKkaU4eR6XnNA/Ew+bMFVsbZ7U1FJpOvZ6YDI968AFFOqcKm+F676T\n2SECTJigFsi6t4UeZoAeObHtHo8MmybWftUH0iQonzrq3uTWU/whhxQOMrzCwRdD\nPDwcqoi2VJJ50qXHizmIcp4UlO6VXN40hzEfv5FsXaR5W4h1F3hvunGdwqSdT/Bh\n69ZEnPIplEm/4WVJ+JjScXeHCIWobD+kTaPsnw5+07q+NUsCdQF1rr3ufyAWPC+s\n4oeah5BVZ+VfKfLyf/P5ZhwcWIEsYx9dyHJL30z8wEOFrsgk0j8WxxIG4ZCg2Ff1\nDTV6yd3lRaxLDwViBBewR9lEvAsZq7yAmhAIypkTggip1+yRHOI4hEjHzd2EPTuC\nYTnSpEOv+xzBtnxG5KlaQZJ6VipC6zWErlT263jP8bF0nEap6iSm1uuKeOy6Z8sZ\nH4W3mHoeHuSBk1KD2xFNaGPyQW+RKvcg7NckJUNXH/PpWb6u2CYBCyGCxOMXmrcx\nX0AzFoyqQ3fUDs9figMv7M8UnzHikpYdIM0jFd2Bh8W7/Bo6HMiMA09PU5C83L9j\n5C19dQcwz/7eX+ZMG4nuI9Cvh18N1yG6CrN7xCwifNah6+nXyBtkzNK+Gbn4I491\ndYEshemDRReirTqB7c9YzEX6va/vE00oaihkk1MvckXAE4ebjK8Fju4SJCksfoUd\ntx5yeJc535Ff1U09RBRKKVZ/J2ihbKkzQtR1Wqr6OHxJdXpgkbt75SxEwIJxlQps\nUZzspfweuNpIOjBLZiFb9Cfxvi9YO8amqT+5nBag4vTa4jrvE9oFzLpcckYKcI1s\nNWE/ccKXNn9ZDug0tFfyG02vLOEIZLaasOUqkWd6PdXwtbVMaMpw5zBTUGLywZMn\nEAIVDYhrpMqy5JlrTT7Ztg/GzU6wFTF00hwvNN4hBEaRucwUedtqj+2lrEqAzBit\nUWBMuw4uavptsiyVi+LOQD6luhnxJtVbxT/S+/Q+3CUfecKMIic0QNZQH12maPFm\n4V9fZ/jfopCr6e8DnTEmZqH5zSMZ+la0YZZYgeOoocCdoCS5bjkJgQOio4IHfuAf\n1MqxFzEP90VoXoomLn2fjt+9naIhFYv32rttt8pSMHEnAcC56pC3gA/zN76GZv99\n65rD5o29zlCyoPirtNZTOwse+oMQFg==\n=H1aC\n-----END PGP SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/0a5d667c78a4770e5260d08c55e836a6fc90dbe9",
          "sha": "0a5d667c78a4770e5260d08c55e836a6fc90dbe9",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/0a5d667c78a4770e5260d08c55e836a6fc90dbe9"
        }
      ],
      "message": "net: split CConnman::ConnectNode()\n\nMove the protocol agnostic parts of `CConnman::ConnectNode()` into\n`SockMan::ConnectAndMakeNodeId()` and leave the Bitcoin-P2P specific\nstuff in `CConnman::ConnectNode()`.\n\nMove the protocol agnostic `CConnman::m_unused_i2p_sessions`, its mutex\nand `MAX_UNUSED_I2P_SESSIONS_SIZE` to `SockMan`.\n\nMove `GetBindAddress()` from `net.cpp` to `sockman.cpp`.",
      "committer": {
        "name": "Vasil Dimov",
        "email": "vd@FreeBSD.org",
        "date": "2025-01-30T13:49:00Z"
      },
      "author": {
        "name": "Vasil Dimov",
        "email": "vd@FreeBSD.org",
        "date": "2024-09-23T10:50:25Z"
      },
      "sha": "91d97a198fb57d47870ce094454c3776bc737ba0"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDBiZTY4ODM2MDMxODUxMWVjZWJjZmM5Y2JhYmFjZmE2OTYwZmE1ZWY",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/0be688360318511ecebcfc9cbabacfa6960fa5ef",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/0be688360318511ecebcfc9cbabacfa6960fa5ef",
      "tree": {
        "sha": "4998fc7d8f0c5c9c03da28cf07154ef29dd3e949",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/4998fc7d8f0c5c9c03da28cf07154ef29dd3e949"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree 4998fc7d8f0c5c9c03da28cf07154ef29dd3e949\nparent 91d97a198fb57d47870ce094454c3776bc737ba0\nauthor Vasil Dimov <vd@FreeBSD.org> 1727163707 +0200\ncommitter Vasil Dimov <vd@FreeBSD.org> 1738244941 +0100\n\nnet: tweak EventNewConnectionAccepted()\n\nMove `MaybeFlipIPv6toCJDNS()`, which is Bitcoin P2P specific from the\ncallers of `CConnman::EventNewConnectionAccepted()` to inside that\nmethod.\n\nMove the IsSelectable check, the `TCP_NODELAY` option set and the\ngeneration of new node id out of `CConnman::EventNewConnectionAccepted()`\nbecause those are protocol agnostic. Move those to a new method\n`SockMan::NewSockAccepted()` which is called instead of\n`CConnman::EventNewConnectionAccepted()`.\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQQzBAABCAAdFiEE5k2NRWFNsHVF2czBVN8G9ktVy78FAmebg04ACgkQVN8G9ktV\ny7+aBB//Rb8HkiNH/Y8/rrq69LtvOBzVNxDn4IB54s7BIN4fXE7olIIgE7afYMWo\nhPiRa44zDPgn0TM4jGp9IWh+33J30EQdGOUMzL5D/jaHDpM513N6kFoTMgxNmIci\n1rJap9kkIZQP0Bb0krxiWhGmiVlaGga0UiYr9q+DCSRpQBMkYURMlwJbqQr+sJWV\nU1c09R+a+Wynf02ncjuvTLvTuUPfYwX1Zj9q65NGg4xUIFW5XHNyMRBs3NWOG7Uo\nQmlUvmkY5hYpi5PXfB/a92g169RJN2ooAozPRNNFtxgrQ3vIyvZfbBKhUp4YyYZv\n9a38L7t4p7HfibA64b2U2pjPq4f14oWe2f9HtlblpJOqwf3+/ZsUSZFq3FfDHiEf\nFIhl5Qjyvg2IudxY31P0Hf9Lg3v6AepSmEib9WiCkse7K35MAP2z+FuCao++OYx3\nyPALIWDqFPKoXqgmMj90EtG0W2Uea5BdYj3ewqKOhLvhvbZucBE7oshKzVd//xse\nmE2XkXeN5rnjy3XfCYTMs3zbRFCvr1NBzB7wQMHym+FkK6TlZaXF2/85rjM6vMwq\nbaMRRqQg9ENHhe9nFuQ4lopwpFisJIQYzRAJWSHm49UsmNZY++mMJZY7An8DCFa2\nmk4f3qJ5xPfsij5jcFOTqq9npt8P71fksHnXWvhx4MLE1RsujRBODXM4ZADXbzWq\n3aJEFR9Oe4NozanBIuE70/WN86//+LAx15KaV3K7PnJLtKYKg+NGJ8AcSgsvoZox\nfDIXfIh5472jz+b8jfVOOrq193EC26zT1bjgFBFQpiSbjPtrE5JevpRCxAV7jUOg\nCYNZMUxV22iQbyYQVkSBXHzeract1tgbQLQKVjdbS2lLRIdQsWGCWVbcAeV264U2\n1/jomIhcTxJJ3XFh/aXqwFov3m+Zqz9UuRfloOLzlkpVK8R3bfsU3x0nyv17jDpi\nyyuJoweO6T/tW3hYkvVu/FwHXHSHzQIOApZK3pvtyNqlPO2MGUgQPqPF7JxRENMf\nG2w45Kp1pVGYhwdduIGD02TB9srPwB/8HtYfXW0T3bp7ujt+sIfx7zvu72BYR3kG\n6AugFzwv0+qqgrv4ss6jUehq7RXi9DyE7WyiRHxnCeWntCm54ssS4hErtkmuMV9B\n4KCy4wR7LCO3QRpoMqZgGvNecSOWaGK11Jn/lSEmtpAKrh6k7KQfbzQJu0gijvBN\naAfSdMVQloTQxAoLb6WHq0rlNbOqz7k1scrwYMuxNuQwhLlpgE+lYnQlDOA7M5ex\n7w047mLztM4y0377+EwZBN5z5XJWwewwr5RtKhLwYfrOxIJwXRKSAFDvAF7m1Isx\nS4OXvuNLf8R8t+j8WBI0pGplVx+Akw==\n=lAlt\n-----END PGP SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/91d97a198fb57d47870ce094454c3776bc737ba0",
          "sha": "91d97a198fb57d47870ce094454c3776bc737ba0",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/91d97a198fb57d47870ce094454c3776bc737ba0"
        }
      ],
      "message": "net: tweak EventNewConnectionAccepted()\n\nMove `MaybeFlipIPv6toCJDNS()`, which is Bitcoin P2P specific from the\ncallers of `CConnman::EventNewConnectionAccepted()` to inside that\nmethod.\n\nMove the IsSelectable check, the `TCP_NODELAY` option set and the\ngeneration of new node id out of `CConnman::EventNewConnectionAccepted()`\nbecause those are protocol agnostic. Move those to a new method\n`SockMan::NewSockAccepted()` which is called instead of\n`CConnman::EventNewConnectionAccepted()`.",
      "committer": {
        "name": "Vasil Dimov",
        "email": "vd@FreeBSD.org",
        "date": "2025-01-30T13:49:01Z"
      },
      "author": {
        "name": "Vasil Dimov",
        "email": "vd@FreeBSD.org",
        "date": "2024-09-24T07:41:47Z"
      },
      "sha": "0be688360318511ecebcfc9cbabacfa6960fa5ef"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKGY3ZGQ0MzczYjA2ZGFmMzQwMzNmYTg0ZmE5OTQwOGEzOTM4ZTRhZDQ",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/f7dd4373b06daf34033fa84fa99408a3938e4ad4",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/f7dd4373b06daf34033fa84fa99408a3938e4ad4",
      "tree": {
        "sha": "4b40bed3a08279cd31c729fe427d43500a9201f0",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/4b40bed3a08279cd31c729fe427d43500a9201f0"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree 4b40bed3a08279cd31c729fe427d43500a9201f0\nparent 0be688360318511ecebcfc9cbabacfa6960fa5ef\nauthor Vasil Dimov <vd@FreeBSD.org> 1727082212 +0200\ncommitter Vasil Dimov <vd@FreeBSD.org> 1738245526 +0100\n\nnet: move sockets from CNode to SockMan\n\nMove `CNode::m_sock` and `CNode::m_i2p_sam_session` to `SockMan::m_connected`.\nAlso move all the code that handles sockets to `SockMan`.\n\n`CNode::CloseSocketDisconnect()` becomes\n`CConnman::MarkAsDisconnectAndCloseConnection()`.\n\n`CConnman::SocketSendData()` is renamed to\n`CConnman::SendMessagesAsBytes()` and its sockets-touching bits are moved to\n`SockMan::SendBytes()`.\n\n`CConnman::GenerateWaitSockets()` goes to\n`SockMan::GenerateWaitSockets()`.\n\n`CConnman::ThreadSocketHandler()` and\n`CConnman::SocketHandler()` are combined into\n`SockMan::ThreadSocketHandler()`.\n\n`CConnman::SocketHandlerConnected()` goes to\n`SockMan::SocketHandlerConnected()`.\n\n`CConnman::SocketHandlerListening()` goes to\n`SockMan::SocketHandlerListening()`.\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQQzBAABCAAdFiEE5k2NRWFNsHVF2czBVN8G9ktVy78FAmebhZgACgkQVN8G9ktV\ny7+6JyAAgke2g2sfcrQr+gsrUaD1mu+KrbGvvSRWg6mUt97jwAJXQlTWrh1w6xc8\nPS3mGSDOY5jWxK/BWAIbT/OLDuyzI3S20MU/cFczXjyRqYChnWN7MYHqNsnFHVSd\njYW5/nWT/TeSpZHDLEl25tzUg5V9K+LvrJbwI2SbtU3p9bYZV8/X8GyO4K7RGgKS\nAQ0BJ/qdVw1Ww61QW1/QekURzYivIVWL/Lvu/Nwcd/G/CpmqHJumZ+EYyeZdXQhb\nPuX1ob5SLc8amL7r9SXijRcYtYJotTltBgABIpX9SZipi/WSLATV0vVv1pbhEQ0l\nc/KbcBKoXf5NNkfl9FmQfox+4WWBOwxN4B8xWQnZ5CJBm2tYmr8ALBa/+AI4M3S9\nPxErTSrMbOsX7bKlxgvgDu5XZTlh5wyyuAZFRE/NDa8zZXgVwDPgp4tth6Yav52k\n11n1C6BMsgIHflfE12NxzCoDVQufA0Oz8aIQcx6WwSzvFy1guMVUxZ0UKogUq6NB\nrVYIidtudxdGPbReC+IWKEc0eCzTzeGw+ZNT14NP29Cjs2xCGJhGfBgr2umkFlac\ngcCtpZdmGaQYpL7ukUxtgbHYoSyyUL17ol8rDr1RNtDZJZeMfXicEIzhpnVeOyPS\nfg18vMOySKIg+xH9SgJLddI8mSZu6+ihwu0G+XefQru0jIKK0vHU7oKW4F2o5Uuc\n6WW3nJxLM325foVwIycI5WHUZv57FyNsdLieo0+9SdpJELvR1zVi7FeHAMODXJuq\nCzdqW8xw4jhNLYtYuUhzDn5mH1tS0Bhj1yYROY0HHtUhmYJU1+jjSbod+p9kGLXa\nYfDe3EeimJ77SFwFr/CjzYORJI10yDYsNjJYxGdR0GYJQqLLJJKmzVwInpuChh2u\neM26Fnz5t4wbYkTcTcLqmWEtsJ8DjxMrNTwKn86nsUO9dYuRre5eZwJbNMfp0fxR\nUMveJBUE7GZGgn9hnCdy2WHuuOjZ64GXmZu7KUbP88EGdCRoruUrL0qvKVL4Nd9I\nX9HWcHc3uQXQg8v5BWCHqTzE+Lr6Ovx1ofKQ5NpWjySdOBCL4ZuaiVIdbWQoQIQQ\nkx3qrifjqjuIpqWJXkSn/odruDLOL0rnj5WopJfT9LpkTFue3YJRZ8uQbUpE0KEb\nONUa6wH0qRPCfeUwqCRsgAXLGBQX9ZjtV91R9w4BrLpV++M+x3bU4xofN3wgkyTn\nydD+lCVfhjTvV/kXywvr6ct6CkqBBfoEnw/do76GHSlFuC24WTYQHQI5ZOIYn5Di\n4CAVgBLZKnAyTrKV7MItK79JAkBYZ5UjFS1SwEfchwxYX7hLUxkCzaDXnxv8o2ig\ntzJ7SZ3rUnDTaMccpgkloP9cQkuZuw==\n=slbY\n-----END PGP SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/0be688360318511ecebcfc9cbabacfa6960fa5ef",
          "sha": "0be688360318511ecebcfc9cbabacfa6960fa5ef",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/0be688360318511ecebcfc9cbabacfa6960fa5ef"
        }
      ],
      "message": "net: move sockets from CNode to SockMan\n\nMove `CNode::m_sock` and `CNode::m_i2p_sam_session` to `SockMan::m_connected`.\nAlso move all the code that handles sockets to `SockMan`.\n\n`CNode::CloseSocketDisconnect()` becomes\n`CConnman::MarkAsDisconnectAndCloseConnection()`.\n\n`CConnman::SocketSendData()` is renamed to\n`CConnman::SendMessagesAsBytes()` and its sockets-touching bits are moved to\n`SockMan::SendBytes()`.\n\n`CConnman::GenerateWaitSockets()` goes to\n`SockMan::GenerateWaitSockets()`.\n\n`CConnman::ThreadSocketHandler()` and\n`CConnman::SocketHandler()` are combined into\n`SockMan::ThreadSocketHandler()`.\n\n`CConnman::SocketHandlerConnected()` goes to\n`SockMan::SocketHandlerConnected()`.\n\n`CConnman::SocketHandlerListening()` goes to\n`SockMan::SocketHandlerListening()`.",
      "committer": {
        "name": "Vasil Dimov",
        "email": "vd@FreeBSD.org",
        "date": "2025-01-30T13:58:46Z"
      },
      "author": {
        "name": "Vasil Dimov",
        "email": "vd@FreeBSD.org",
        "date": "2024-09-23T09:03:32Z"
      },
      "sha": "f7dd4373b06daf34033fa84fa99408a3938e4ad4"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDc4NjZjNzM2Yzg3YTkwOGNlZjc1ZGM2OTAxYzljMDU5NGM2NWIwZWI",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/7866c736c87a908cef75dc6901c9c0594c65b0eb",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/7866c736c87a908cef75dc6901c9c0594c65b0eb",
      "tree": {
        "sha": "fce115d771f36152d2142a8cbf7b521507a9b3b5",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/fce115d771f36152d2142a8cbf7b521507a9b3b5"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree fce115d771f36152d2142a8cbf7b521507a9b3b5\nparent f7dd4373b06daf34033fa84fa99408a3938e4ad4\nauthor Vasil Dimov <vd@FreeBSD.org> 1727082359 +0200\ncommitter Vasil Dimov <vd@FreeBSD.org> 1738245528 +0100\n\nnet: move-only: improve encapsulation of SockMan\n\n`SockMan` members\n\n`AcceptConnection()`\n`NewSockAccepted()`\n`GetNewNodeId()`\n`m_i2p_sam_session`\n`m_listen private`\n\nare now used only by `SockMan`, thus make them private.\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQQzBAABCAAdFiEE5k2NRWFNsHVF2czBVN8G9ktVy78FAmebhZgACgkQVN8G9ktV\ny7/fbR/+P6Dt1Dc+Bx1jhZmuHpC+XWLP42xelAFn1jywvKEgUj2KoLabSdbKgG92\nC/mQjQB8H9MfKHWk3Y2yUocH60huFhRhn82k7GFpurwQnFCods0gmj4P3mLkO7at\na0Nhd9mJpk5SmddU/86x7+eBNaNfx2WS+gh3VwZ+7hunDg4oTfuya6eh2VrtjgyB\ntabOjhh0UkhUNwet7M4ukRMf0BvX0oUddflKjmP5gtXPI+rjl2Yn1Cee9+3za8Zq\nFz4u3+78jeGeNs2PRLYGnsuXvI5OWFGb65r6E/ZwkM2ZOzJiUE9Z9MLBhBVIAH9I\nr4FH5YX3EEoEkxrx9ve5TTa4SLyBq/fr0N8zqCXCDB1yLDs77BkKzSPlAPmLeD5k\nOTm2+001IK0icyincHqqScyUH0OshDug6G80uPJqdJfi1vwvr3H5s/sDz1v5Lq6X\ndq2/F2Ws9aCb7/jHAhBcEdAUXltwVXT0CMH1RuHSnrqJI3ubPNtYTg27vPP7VoMl\nCuUtwI/yVP7uqiIAB2oL5n6mG8y503X4+Dz94gLzhXIwYNfmX/GF3kgvClLfDpXs\nK9KTyQpHRpuEw2I2ZQyog8SZZ0xsfUj1/+JFxsN9oHgz3p+wMGffq5SvK5YerJJN\ne3be5RfhUKVVauUctqrT8R0onJYyZ7FiVfM+CpVmrwe5QqMvm1j4nWZ5YIdHMtkB\nuJyUrurwDogoNwoSkLMXZVHiKfyQBQMTKsA/I/nf8CUTN8FxaF6eII5RyK+3v38M\nmljwQg/WYNqe4NtFUvA2YqON0H+G/euO9CQBtNs08Cpa1G8TUbz1QjTtjbGToyQD\n1rZK+M/GVstsGRrJ4CZuLc/ufqmhxjEuIA3fCt+cxcysnfjQfcGwcp6d0ko8HM4H\nw3VPIxnsRvUHFI7R30CuELjguK9A1IYz9Jw9LgXm0K3bbcqRIVMr/pCymmbMtvgQ\nKbftYFHsMTUb2SYDOCTvjC9cBXpXN0AjzQEDYRVDMjayyr+0FJobT9q8fV8rz8yV\ntZ60F5mRtTbP7a60FuYxFk7IAbJAna2e+ArJ3kp6N9ALkgX4kOcwIUVeFh6DjApi\n8wjRajFLB1i9aT86kFyJp4AGwASs8g/NFQsekaQX/ZBcsZZQu03sEl/CVprVZYNX\nEy6r2HEgOSZuqVAHhxu6YOYBw/jHxP1UeAv/WiFPgGtVdzmpl3ZGOzLYwVCSg5L+\nj0+4o3cM3KejdVaupDcV06Fk4EzV5vgGJ2NMquIiqJI2sUGePXdRmeLzZ39NDTII\nHy30/W60JisEqQPNF8/M1G1gEBm8mOpSccSM4vavdUoKns1vHyh6cXrUBcrrDHGa\nJqCLXDm+DTyf7QANZDi5TH4TV3indQ==\n=FFRC\n-----END PGP SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/f7dd4373b06daf34033fa84fa99408a3938e4ad4",
          "sha": "f7dd4373b06daf34033fa84fa99408a3938e4ad4",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/f7dd4373b06daf34033fa84fa99408a3938e4ad4"
        }
      ],
      "message": "net: move-only: improve encapsulation of SockMan\n\n`SockMan` members\n\n`AcceptConnection()`\n`NewSockAccepted()`\n`GetNewNodeId()`\n`m_i2p_sam_session`\n`m_listen private`\n\nare now used only by `SockMan`, thus make them private.",
      "committer": {
        "name": "Vasil Dimov",
        "email": "vd@FreeBSD.org",
        "date": "2025-01-30T13:58:48Z"
      },
      "author": {
        "name": "Vasil Dimov",
        "email": "vd@FreeBSD.org",
        "date": "2024-09-23T09:05:59Z"
      },
      "sha": "7866c736c87a908cef75dc6901c9c0594c65b0eb"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 16124841862,
      "node_id": "HRFPE_lADOABII586YIJemzwAAAAPBHY-G",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/16124841862",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": "7866c736c87a908cef75dc6901c9c0594c65b0eb",
      "commit_url": "https://api.github.com/repos/vasild/bitcoin/commits/7866c736c87a908cef75dc6901c9c0594c65b0eb",
      "created_at": "2025-01-30T14:01:58Z"
    },
    {
      "event": "commented",
      "id": 2624601401,
      "node_id": "IC_kwDOABII586ccD05",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2624601401",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-01-30T14:02:16Z",
      "updated_at": "2025-01-30T14:02:16Z",
      "author_association": "CONTRIBUTOR",
      "body": "`266ac32673...7866c736c8`: rebase due to conflicts",
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30988#issuecomment-2624601401",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/30988"
    },
    {
      "event": "unlabeled",
      "id": 16125628183,
      "node_id": "UNLE_lADOABII586YIJemzwAAAAPBKY8X",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/16125628183",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-01-30T15:03:32Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "reviewed",
      "id": 2584231283,
      "node_id": "PRR_kwDOABII586aCD1z",
      "url": null,
      "actor": null,
      "commit_id": "248ec2d2687fae47b63688e00b9ef18d4c0c9676",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "user": {
        "login": "Sjors",
        "id": 10217,
        "node_id": "MDQ6VXNlcjEwMjE3",
        "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Sjors",
        "html_url": "https://github.com/Sjors",
        "followers_url": "https://api.github.com/users/Sjors/followers",
        "following_url": "https://api.github.com/users/Sjors/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Sjors/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Sjors/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
        "organizations_url": "https://api.github.com/users/Sjors/orgs",
        "repos_url": "https://api.github.com/users/Sjors/repos",
        "events_url": "https://api.github.com/users/Sjors/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Sjors/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30988#pullrequestreview-2584231283",
      "submitted_at": "2025-01-30T15:25:18Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/30988"
    },
    {
      "event": "unsubscribed",
      "id": 16129570956,
      "node_id": "UE_lADOABII586YIJemzwAAAAPBZbiM",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/16129570956",
      "actor": {
        "login": "PRADACANDI18",
        "id": 91190628,
        "node_id": "MDQ6VXNlcjkxMTkwNjI4",
        "avatar_url": "https://avatars.githubusercontent.com/u/91190628?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/PRADACANDI18",
        "html_url": "https://github.com/PRADACANDI18",
        "followers_url": "https://api.github.com/users/PRADACANDI18/followers",
        "following_url": "https://api.github.com/users/PRADACANDI18/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/PRADACANDI18/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/PRADACANDI18/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/PRADACANDI18/subscriptions",
        "organizations_url": "https://api.github.com/users/PRADACANDI18/orgs",
        "repos_url": "https://api.github.com/users/PRADACANDI18/repos",
        "events_url": "https://api.github.com/users/PRADACANDI18/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/PRADACANDI18/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-01-30T20:14:23Z"
    }
  ],
  "comments": [
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1778257807",
      "pull_request_review_id": 2333138089,
      "id": 1778257807,
      "node_id": "PRRC_kwDOABII585p_g-P",
      "diff_hunk": "@@ -203,6 +203,15 @@ static RPCHelpMan getpeerinfo()\n     std::vector<CNodeStats> vstats;\n     connman.GetNodeStats(vstats);\n \n+    // An undocumented side effect of how CConnman previously stored nodes was\n+    // that they were returned ordered by id. At least some functional tests\n+    // rely on that, so keep it that way. An alternative is to remove this sort\n+    // and fix the tests and take the risk of breaking other users of the\n+    // \"getpeerinfo\" RPC.",
      "path": "src/rpc/net.cpp",
      "position": null,
      "original_position": 8,
      "commit_id": "7866c736c87a908cef75dc6901c9c0594c65b0eb",
      "original_commit_id": "03f6cc2b4a76cafd278b9ab92bd915d3946212a9",
      "in_reply_to_id": null,
      "user": {
        "login": "maflcko",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/maflcko",
        "html_url": "https://github.com/maflcko",
        "followers_url": "https://api.github.com/users/maflcko/followers",
        "following_url": "https://api.github.com/users/maflcko/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/maflcko/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/maflcko/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/maflcko/subscriptions",
        "organizations_url": "https://api.github.com/users/maflcko/orgs",
        "repos_url": "https://api.github.com/users/maflcko/repos",
        "events_url": "https://api.github.com/users/maflcko/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/maflcko/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "nit: Arrays are ordered data structures and I don't think it is user-friendly to shuffle them by ID. I think this comment can just be removed.",
      "created_at": "2024-09-27T08:41:33Z",
      "updated_at": "2024-09-27T11:52:22Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30988#discussion_r1778257807",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1778257807"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/30988"
        }
      },
      "start_line": null,
      "original_start_line": 206,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 210,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1778767304",
      "pull_request_review_id": 2333986678,
      "id": 1778767304,
      "node_id": "PRRC_kwDOABII585qBdXI",
      "diff_hunk": "@@ -203,6 +203,15 @@ static RPCHelpMan getpeerinfo()\n     std::vector<CNodeStats> vstats;\n     connman.GetNodeStats(vstats);\n \n+    // An undocumented side effect of how CConnman previously stored nodes was\n+    // that they were returned ordered by id. At least some functional tests\n+    // rely on that, so keep it that way. An alternative is to remove this sort\n+    // and fix the tests and take the risk of breaking other users of the\n+    // \"getpeerinfo\" RPC.",
      "path": "src/rpc/net.cpp",
      "position": null,
      "original_position": 8,
      "commit_id": "7866c736c87a908cef75dc6901c9c0594c65b0eb",
      "original_commit_id": "03f6cc2b4a76cafd278b9ab92bd915d3946212a9",
      "in_reply_to_id": 1778257807,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "Removed, thanks!",
      "created_at": "2024-09-27T15:05:41Z",
      "updated_at": "2024-09-27T15:05:41Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30988#discussion_r1778767304",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1778767304"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/30988"
        }
      },
      "start_line": null,
      "original_start_line": 206,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 210,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1802901394",
      "pull_request_review_id": 2372105727,
      "id": 1802901394,
      "node_id": "PRRC_kwDOABII585rdheS",
      "diff_hunk": "@@ -0,0 +1,528 @@\n+// Copyright (c) 2024-present The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or https://opensource.org/license/mit/.\n+\n+#include <config/bitcoin-config.h> // IWYU pragma: keep",
      "path": "src/common/sockman.cpp",
      "position": null,
      "original_position": 5,
      "commit_id": "7866c736c87a908cef75dc6901c9c0594c65b0eb",
      "original_commit_id": "70c2f13f83a5cc740330d0b4af9cbd74515be6b2",
      "in_reply_to_id": null,
      "user": {
        "login": "Sjors",
        "id": 10217,
        "node_id": "MDQ6VXNlcjEwMjE3",
        "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Sjors",
        "html_url": "https://github.com/Sjors",
        "followers_url": "https://api.github.com/users/Sjors/followers",
        "following_url": "https://api.github.com/users/Sjors/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Sjors/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Sjors/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
        "organizations_url": "https://api.github.com/users/Sjors/orgs",
        "repos_url": "https://api.github.com/users/Sjors/repos",
        "events_url": "https://api.github.com/users/Sjors/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Sjors/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "Silent merge conflict with #30937",
      "created_at": "2024-10-16T11:15:53Z",
      "updated_at": "2024-10-16T11:15:53Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30988#discussion_r1802901394",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1802901394"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/30988"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 5,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1803679987",
      "pull_request_review_id": 2373476515,
      "id": 1803679987,
      "node_id": "PRRC_kwDOABII585rgfjz",
      "diff_hunk": "@@ -1796,10 +1796,10 @@ void CConnman::CreateNodeFromAcceptedSocket(std::unique_ptr<Sock>&& sock,\n \n     CNode* pnode = new CNode(id,\n                              std::move(sock),\n-                             addr,\n+                             CAddress{addr, NODE_NONE},\n                              CalculateKeyedNetGroup(addr),\n                              nonce,\n-                             addr_bind,\n+                             CAddress{addr_bind, NODE_NONE},",
      "path": "src/net.cpp",
      "position": null,
      "original_position": 45,
      "commit_id": "7866c736c87a908cef75dc6901c9c0594c65b0eb",
      "original_commit_id": "1bfc1ca9b6b68c6356ffc23ecf01e417152ade95",
      "in_reply_to_id": null,
      "user": {
        "login": "pinheadmz",
        "id": 2084648,
        "node_id": "MDQ6VXNlcjIwODQ2NDg=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2084648?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/pinheadmz",
        "html_url": "https://github.com/pinheadmz",
        "followers_url": "https://api.github.com/users/pinheadmz/followers",
        "following_url": "https://api.github.com/users/pinheadmz/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/pinheadmz/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/pinheadmz/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/pinheadmz/subscriptions",
        "organizations_url": "https://api.github.com/users/pinheadmz/orgs",
        "repos_url": "https://api.github.com/users/pinheadmz/repos",
        "events_url": "https://api.github.com/users/pinheadmz/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/pinheadmz/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "1bfc1ca9b6b68c6356ffc23ecf01e417152ade95\r\n\r\nWhy do CNode .addr and .addrBind still need to be CAddress? maybe it makes some sense for .addr if that's where we also store the service flags for easier gossiping, but why would the local bind address need anything besides an IP and port?",
      "created_at": "2024-10-16T19:27:15Z",
      "updated_at": "2024-10-18T15:14:27Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30988#discussion_r1803679987",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1803679987"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/30988"
        }
      },
      "start_line": null,
      "original_start_line": 1799,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 1715,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1803692315",
      "pull_request_review_id": 2373476515,
      "id": 1803692315,
      "node_id": "PRRC_kwDOABII585rgikb",
      "diff_hunk": "@@ -0,0 +1,85 @@\n+// Copyright (c) 2024-present The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or https://opensource.org/license/mit/.\n+\n+#include <config/bitcoin-config.h> // IWYU pragma: keep\n+\n+#include <common/sockman.h>\n+#include <logging.h>\n+#include <netbase.h>\n+#include <util/sock.h>\n+\n+bool SockMan::BindListenPort(const CService& addrBind, bilingual_str& strError)\n+{\n+    int nOne = 1;\n+\n+    // Create socket for listening for incoming connections\n+    struct sockaddr_storage sockaddr;\n+    socklen_t len = sizeof(sockaddr);\n+    if (!addrBind.GetSockAddr((struct sockaddr*)&sockaddr, &len))\n+    {\n+        strError = strprintf(Untranslated(\"Bind address family for %s not supported\"), addrBind.ToStringAddrPort());\n+        LogPrintLevel(BCLog::NET, BCLog::Level::Error, \"%s\\n\", strError.original);\n+        return false;\n+    }\n+\n+    std::unique_ptr<Sock> sock = CreateSock(addrBind.GetSAFamily(), SOCK_STREAM, IPPROTO_TCP);\n+    if (!sock) {\n+        strError = strprintf(Untranslated(\"Couldn't open socket for incoming connections (socket returned error %s)\"), NetworkErrorString(WSAGetLastError()));\n+        LogPrintLevel(BCLog::NET, BCLog::Level::Error, \"%s\\n\", strError.original);\n+        return false;\n+    }\n+\n+    // Allow binding if the port is still in TIME_WAIT state after\n+    // the program was closed and restarted.\n+    if (sock->SetSockOpt(SOL_SOCKET, SO_REUSEADDR, (sockopt_arg_type)&nOne, sizeof(int)) == SOCKET_ERROR) {\n+        strError = strprintf(Untranslated(\"Error setting SO_REUSEADDR on socket: %s, continuing anyway\"), NetworkErrorString(WSAGetLastError()));\n+        LogPrintf(\"%s\\n\", strError.original);\n+    }\n+\n+    // some systems don't have IPV6_V6ONLY but are always v6only; others do have the option\n+    // and enable it by default or not. Try to enable it, if possible.\n+    if (addrBind.IsIPv6()) {\n+#ifdef IPV6_V6ONLY\n+        if (sock->SetSockOpt(IPPROTO_IPV6, IPV6_V6ONLY, (sockopt_arg_type)&nOne, sizeof(int)) == SOCKET_ERROR) {\n+            strError = strprintf(Untranslated(\"Error setting IPV6_V6ONLY on socket: %s, continuing anyway\"), NetworkErrorString(WSAGetLastError()));\n+            LogPrintf(\"%s\\n\", strError.original);\n+        }\n+#endif\n+#ifdef WIN32\n+        int nProtLevel = PROTECTION_LEVEL_UNRESTRICTED;\n+        if (sock->SetSockOpt(IPPROTO_IPV6, IPV6_PROTECTION_LEVEL, (const char*)&nProtLevel, sizeof(int)) == SOCKET_ERROR) {\n+            strError = strprintf(Untranslated(\"Error setting IPV6_PROTECTION_LEVEL on socket: %s, continuing anyway\"), NetworkErrorString(WSAGetLastError()));\n+            LogPrintf(\"%s\\n\", strError.original);\n+        }\n+#endif\n+    }\n+",
      "path": "src/common/sockman.cpp",
      "position": 88,
      "original_position": 57,
      "commit_id": "7866c736c87a908cef75dc6901c9c0594c65b0eb",
      "original_commit_id": "41c87ddb3d7a18d2c0fa7eccfbde57e9d6e898c2",
      "in_reply_to_id": null,
      "user": {
        "login": "pinheadmz",
        "id": 2084648,
        "node_id": "MDQ6VXNlcjIwODQ2NDg=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2084648?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/pinheadmz",
        "html_url": "https://github.com/pinheadmz",
        "followers_url": "https://api.github.com/users/pinheadmz/followers",
        "following_url": "https://api.github.com/users/pinheadmz/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/pinheadmz/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/pinheadmz/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/pinheadmz/subscriptions",
        "organizations_url": "https://api.github.com/users/pinheadmz/orgs",
        "repos_url": "https://api.github.com/users/pinheadmz/repos",
        "events_url": "https://api.github.com/users/pinheadmz/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/pinheadmz/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "41c87ddb3d7a18d2c0fa7eccfbde57e9d6e898c2\r\n\r\nMaybe these are expected to be set by callers in future commits, so I'm just leaving myself a note to look for `SO_KEEPALIVE` and `TCP_NODELAY`",
      "created_at": "2024-10-16T19:38:45Z",
      "updated_at": "2024-10-18T15:14:27Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30988#discussion_r1803692315",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1803692315"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/30988"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 88,
      "original_line": 88,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1804940161",
      "pull_request_review_id": 2373476515,
      "id": 1804940161,
      "node_id": "PRRC_kwDOABII585rlTOB",
      "diff_hunk": "@@ -9,9 +9,12 @@\n #include <util/sock.h>\n #include <util/translation.h>\n \n+#include <atomic>\n #include <memory>\n #include <vector>\n \n+typedef int64_t NodeId;",
      "path": "src/common/sockman.h",
      "position": 23,
      "original_position": 8,
      "commit_id": "7866c736c87a908cef75dc6901c9c0594c65b0eb",
      "original_commit_id": "5d4920f630417ceeee1c79304faac6803795cd64",
      "in_reply_to_id": null,
      "user": {
        "login": "pinheadmz",
        "id": 2084648,
        "node_id": "MDQ6VXNlcjIwODQ2NDg=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2084648?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/pinheadmz",
        "html_url": "https://github.com/pinheadmz",
        "followers_url": "https://api.github.com/users/pinheadmz/followers",
        "following_url": "https://api.github.com/users/pinheadmz/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/pinheadmz/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/pinheadmz/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/pinheadmz/subscriptions",
        "organizations_url": "https://api.github.com/users/pinheadmz/orgs",
        "repos_url": "https://api.github.com/users/pinheadmz/repos",
        "events_url": "https://api.github.com/users/pinheadmz/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/pinheadmz/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "5d4920f630417ceeee1c79304faac6803795cd64\r\n\r\nI don't really have any better suggestion for this but the term \"node\" is now a higher-level ConnMan context, for HTTP and StratumV2 I'd probably refer to them as \"client\".",
      "created_at": "2024-10-17T14:53:34Z",
      "updated_at": "2024-10-18T15:14:27Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30988#discussion_r1804940161",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1804940161"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/30988"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 23,
      "original_line": 23,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1804970448",
      "pull_request_review_id": 2373476515,
      "id": 1804970448,
      "node_id": "PRRC_kwDOABII585rlanQ",
      "diff_hunk": "@@ -124,3 +143,39 @@ void SockMan::CloseSockets()\n }\n \n void SockMan::EventI2PListen(const CService&, bool) {}\n+\n+void SockMan::ThreadI2PAccept()\n+{\n+    static constexpr auto err_wait_begin = 1s;\n+    static constexpr auto err_wait_cap = 5min;\n+    auto err_wait = err_wait_begin;\n+\n+    i2p::Connection conn;\n+\n+    auto SleepOnFailure = [&]() {\n+        interruptNet.sleep_for(err_wait);\n+        if (err_wait < err_wait_cap) {\n+            err_wait += 1s;\n+        }\n+    };\n+\n+    while (!interruptNet) {\n+\n+        if (!m_i2p_sam_session->Listen(conn)) {\n+            EventI2PListen(conn.me, /*success=*/false);",
      "path": "src/common/sockman.cpp",
      "position": 309,
      "original_position": 56,
      "commit_id": "7866c736c87a908cef75dc6901c9c0594c65b0eb",
      "original_commit_id": "b94f9d338fd0d3b47a4ea6165ce9cde48f3b19bc",
      "in_reply_to_id": null,
      "user": {
        "login": "pinheadmz",
        "id": 2084648,
        "node_id": "MDQ6VXNlcjIwODQ2NDg=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2084648?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/pinheadmz",
        "html_url": "https://github.com/pinheadmz",
        "followers_url": "https://api.github.com/users/pinheadmz/followers",
        "following_url": "https://api.github.com/users/pinheadmz/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/pinheadmz/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/pinheadmz/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/pinheadmz/subscriptions",
        "organizations_url": "https://api.github.com/users/pinheadmz/orgs",
        "repos_url": "https://api.github.com/users/pinheadmz/repos",
        "events_url": "https://api.github.com/users/pinheadmz/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/pinheadmz/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "b94f9d338fd0d3b47a4ea6165ce9cde48f3b19bc\r\n\r\nReminding myself to check for a test that covers a child class with i2p true but no Event listener",
      "created_at": "2024-10-17T15:11:34Z",
      "updated_at": "2024-10-18T15:14:27Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30988#discussion_r1804970448",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1804970448"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/30988"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 309,
      "original_line": 309,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1804983489",
      "pull_request_review_id": 2373476515,
      "id": 1804983489,
      "node_id": "PRRC_kwDOABII585rldzB",
      "diff_hunk": "@@ -0,0 +1,85 @@\n+// Copyright (c) 2024-present The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or https://opensource.org/license/mit/.\n+\n+#include <config/bitcoin-config.h> // IWYU pragma: keep\n+\n+#include <common/sockman.h>\n+#include <logging.h>\n+#include <netbase.h>\n+#include <util/sock.h>\n+\n+bool SockMan::BindListenPort(const CService& addrBind, bilingual_str& strError)\n+{\n+    int nOne = 1;\n+\n+    // Create socket for listening for incoming connections\n+    struct sockaddr_storage sockaddr;\n+    socklen_t len = sizeof(sockaddr);\n+    if (!addrBind.GetSockAddr((struct sockaddr*)&sockaddr, &len))\n+    {\n+        strError = strprintf(Untranslated(\"Bind address family for %s not supported\"), addrBind.ToStringAddrPort());\n+        LogPrintLevel(BCLog::NET, BCLog::Level::Error, \"%s\\n\", strError.original);\n+        return false;\n+    }\n+\n+    std::unique_ptr<Sock> sock = CreateSock(addrBind.GetSAFamily(), SOCK_STREAM, IPPROTO_TCP);\n+    if (!sock) {\n+        strError = strprintf(Untranslated(\"Couldn't open socket for incoming connections (socket returned error %s)\"), NetworkErrorString(WSAGetLastError()));\n+        LogPrintLevel(BCLog::NET, BCLog::Level::Error, \"%s\\n\", strError.original);\n+        return false;\n+    }\n+\n+    // Allow binding if the port is still in TIME_WAIT state after\n+    // the program was closed and restarted.\n+    if (sock->SetSockOpt(SOL_SOCKET, SO_REUSEADDR, (sockopt_arg_type)&nOne, sizeof(int)) == SOCKET_ERROR) {\n+        strError = strprintf(Untranslated(\"Error setting SO_REUSEADDR on socket: %s, continuing anyway\"), NetworkErrorString(WSAGetLastError()));\n+        LogPrintf(\"%s\\n\", strError.original);\n+    }\n+\n+    // some systems don't have IPV6_V6ONLY but are always v6only; others do have the option\n+    // and enable it by default or not. Try to enable it, if possible.\n+    if (addrBind.IsIPv6()) {\n+#ifdef IPV6_V6ONLY\n+        if (sock->SetSockOpt(IPPROTO_IPV6, IPV6_V6ONLY, (sockopt_arg_type)&nOne, sizeof(int)) == SOCKET_ERROR) {\n+            strError = strprintf(Untranslated(\"Error setting IPV6_V6ONLY on socket: %s, continuing anyway\"), NetworkErrorString(WSAGetLastError()));\n+            LogPrintf(\"%s\\n\", strError.original);\n+        }\n+#endif\n+#ifdef WIN32\n+        int nProtLevel = PROTECTION_LEVEL_UNRESTRICTED;\n+        if (sock->SetSockOpt(IPPROTO_IPV6, IPV6_PROTECTION_LEVEL, (const char*)&nProtLevel, sizeof(int)) == SOCKET_ERROR) {\n+            strError = strprintf(Untranslated(\"Error setting IPV6_PROTECTION_LEVEL on socket: %s, continuing anyway\"), NetworkErrorString(WSAGetLastError()));\n+            LogPrintf(\"%s\\n\", strError.original);\n+        }\n+#endif\n+    }\n+",
      "path": "src/common/sockman.cpp",
      "position": 88,
      "original_position": 57,
      "commit_id": "7866c736c87a908cef75dc6901c9c0594c65b0eb",
      "original_commit_id": "41c87ddb3d7a18d2c0fa7eccfbde57e9d6e898c2",
      "in_reply_to_id": 1803692315,
      "user": {
        "login": "pinheadmz",
        "id": 2084648,
        "node_id": "MDQ6VXNlcjIwODQ2NDg=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2084648?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/pinheadmz",
        "html_url": "https://github.com/pinheadmz",
        "followers_url": "https://api.github.com/users/pinheadmz/followers",
        "following_url": "https://api.github.com/users/pinheadmz/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/pinheadmz/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/pinheadmz/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/pinheadmz/subscriptions",
        "organizations_url": "https://api.github.com/users/pinheadmz/orgs",
        "repos_url": "https://api.github.com/users/pinheadmz/repos",
        "events_url": "https://api.github.com/users/pinheadmz/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/pinheadmz/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "Ok I see NODELAY set  by ConnMan in EventNewConnectionAccepted in b94f9d338fd0d3b47a4ea6165ce9cde48f3b19bc\r\n\r\nI'm guessing we dont use KEEPALIVE for bitcoin p2p because we have out own ping/pong protocol",
      "created_at": "2024-10-17T15:19:48Z",
      "updated_at": "2024-10-18T15:14:27Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30988#discussion_r1804983489",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1804983489"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/30988"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 88,
      "original_line": 88,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1804998403",
      "pull_request_review_id": 2373476515,
      "id": 1804998403,
      "node_id": "PRRC_kwDOABII585rlhcD",
      "diff_hunk": "@@ -63,6 +96,16 @@ class SockMan\n     // Pure virtual functions must be implemented by children classes.\n     //\n \n+    /**\n+     * Be notified when a new connection has been accepted.\n+     * @param[in] sock Connected socket to communicate with the peer.\n+     * @param[in] me The address and port at our side of the connection.\n+     * @param[in] them The address and port at the peer's side of the connection.\n+     */\n+    virtual void EventNewConnectionAccepted(std::unique_ptr<Sock>&& sock,",
      "path": "src/common/sockman.h",
      "position": null,
      "original_position": 77,
      "commit_id": "7866c736c87a908cef75dc6901c9c0594c65b0eb",
      "original_commit_id": "b94f9d338fd0d3b47a4ea6165ce9cde48f3b19bc",
      "in_reply_to_id": null,
      "user": {
        "login": "pinheadmz",
        "id": 2084648,
        "node_id": "MDQ6VXNlcjIwODQ2NDg=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2084648?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/pinheadmz",
        "html_url": "https://github.com/pinheadmz",
        "followers_url": "https://api.github.com/users/pinheadmz/followers",
        "following_url": "https://api.github.com/users/pinheadmz/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/pinheadmz/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/pinheadmz/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/pinheadmz/subscriptions",
        "organizations_url": "https://api.github.com/users/pinheadmz/orgs",
        "repos_url": "https://api.github.com/users/pinheadmz/repos",
        "events_url": "https://api.github.com/users/pinheadmz/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/pinheadmz/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "b94f9d338fd0d3b47a4ea6165ce9cde48f3b19bc\r\n\r\nSeems weird to me to move the unique pointer to a connected socket out of sockman, implying that sockman itself doesn't own the connections. Peeking ahead at future commits though I think this gets resolved.",
      "created_at": "2024-10-17T15:29:01Z",
      "updated_at": "2024-10-18T15:14:27Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30988#discussion_r1804998403",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1804998403"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/30988"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 105,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1805112369",
      "pull_request_review_id": 2373476515,
      "id": 1805112369,
      "node_id": "PRRC_kwDOABII585rl9Qx",
      "diff_hunk": "@@ -1410,7 +1411,7 @@ class CConnman : private SockMan\n     std::vector<AddedNodeParams> m_added_node_params GUARDED_BY(m_added_nodes_mutex);\n \n     mutable Mutex m_added_nodes_mutex;\n-    std::vector<CNode*> m_nodes GUARDED_BY(m_nodes_mutex);\n+    std::unordered_map<NodeId, CNode*> m_nodes GUARDED_BY(m_nodes_mutex);",
      "path": "src/net.h",
      "position": 325,
      "original_position": 31,
      "commit_id": "7866c736c87a908cef75dc6901c9c0594c65b0eb",
      "original_commit_id": "b96beb27d2b3d06a45644c537c114a08f0ccd285",
      "in_reply_to_id": null,
      "user": {
        "login": "pinheadmz",
        "id": 2084648,
        "node_id": "MDQ6VXNlcjIwODQ2NDg=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2084648?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/pinheadmz",
        "html_url": "https://github.com/pinheadmz",
        "followers_url": "https://api.github.com/users/pinheadmz/followers",
        "following_url": "https://api.github.com/users/pinheadmz/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/pinheadmz/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/pinheadmz/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/pinheadmz/subscriptions",
        "organizations_url": "https://api.github.com/users/pinheadmz/orgs",
        "repos_url": "https://api.github.com/users/pinheadmz/repos",
        "events_url": "https://api.github.com/users/pinheadmz/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/pinheadmz/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "b96beb27d2b3d06a45644c537c114a08f0ccd285\r\n\r\nLove this, great optimization and makes a lot of sense.",
      "created_at": "2024-10-17T16:52:54Z",
      "updated_at": "2024-10-18T15:14:27Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30988#discussion_r1805112369",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1805112369"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/30988"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 1413,
      "original_line": 1413,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1805115729",
      "pull_request_review_id": 2373476515,
      "id": 1805115729,
      "node_id": "PRRC_kwDOABII585rl-FR",
      "diff_hunk": "@@ -45,12 +45,13 @@ FUZZ_TARGET(connman, .init = initialize_connman)\n     connman.Init(options);\n \n     CNetAddr random_netaddr;\n-    CNode random_node = ConsumeNode(fuzzed_data_provider);\n+    NodeId node_id{0};\n+    CNode random_node = ConsumeNode(fuzzed_data_provider, node_id++);",
      "path": "src/test/fuzz/connman.cpp",
      "position": null,
      "original_position": 6,
      "commit_id": "7866c736c87a908cef75dc6901c9c0594c65b0eb",
      "original_commit_id": "b96beb27d2b3d06a45644c537c114a08f0ccd285",
      "in_reply_to_id": null,
      "user": {
        "login": "pinheadmz",
        "id": 2084648,
        "node_id": "MDQ6VXNlcjIwODQ2NDg=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2084648?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/pinheadmz",
        "html_url": "https://github.com/pinheadmz",
        "followers_url": "https://api.github.com/users/pinheadmz/followers",
        "following_url": "https://api.github.com/users/pinheadmz/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/pinheadmz/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/pinheadmz/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/pinheadmz/subscriptions",
        "organizations_url": "https://api.github.com/users/pinheadmz/orgs",
        "repos_url": "https://api.github.com/users/pinheadmz/repos",
        "events_url": "https://api.github.com/users/pinheadmz/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/pinheadmz/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "b96beb27d2b3d06a45644c537c114a08f0ccd285\r\n\r\nWhy not use `GetNewNodeId()` here? (and below) Don't you have a Connman with its own `m_next_node_id`?",
      "created_at": "2024-10-17T16:55:41Z",
      "updated_at": "2024-10-18T15:14:27Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30988#discussion_r1805115729",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1805115729"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/30988"
        }
      },
      "start_line": null,
      "original_start_line": 48,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 49,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1805124507",
      "pull_request_review_id": 2373476515,
      "id": 1805124507,
      "node_id": "PRRC_kwDOABII585rmAOb",
      "diff_hunk": "@@ -111,6 +111,22 @@ class SockMan\n     // alone to use the default implementation from SockMan.\n     //\n \n+    /**\n+     * SockMan would only call EventReadyToSend() if this returns true.\n+     * Can be used to temporary pause sends for a node.\n+     * The implementation in SockMan always returns true.\n+     * @param[in] node_id Node for which to confirm or cancel a call to EventReadyToSend().\n+     */\n+    virtual bool ShouldTryToSend(NodeId node_id) const;\n+\n+    /**\n+     * SockMan would only call Recv() on a node's socket if this returns true.\n+     * Can be used to temporary pause receives for a node.",
      "path": "src/common/sockman.h",
      "position": null,
      "original_position": 14,
      "commit_id": "7866c736c87a908cef75dc6901c9c0594c65b0eb",
      "original_commit_id": "bb5b91d430026c4826a2107c8c1a311518cc97ce",
      "in_reply_to_id": null,
      "user": {
        "login": "pinheadmz",
        "id": 2084648,
        "node_id": "MDQ6VXNlcjIwODQ2NDg=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2084648?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/pinheadmz",
        "html_url": "https://github.com/pinheadmz",
        "followers_url": "https://api.github.com/users/pinheadmz/followers",
        "following_url": "https://api.github.com/users/pinheadmz/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/pinheadmz/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/pinheadmz/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/pinheadmz/subscriptions",
        "organizations_url": "https://api.github.com/users/pinheadmz/orgs",
        "repos_url": "https://api.github.com/users/pinheadmz/repos",
        "events_url": "https://api.github.com/users/pinheadmz/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/pinheadmz/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "bb5b91d430026c4826a2107c8c1a311518cc97ce\r\n\r\nnit s/temporary/temporarily\r\n\r\nand above",
      "created_at": "2024-10-17T17:03:08Z",
      "updated_at": "2024-10-18T15:14:27Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30988#discussion_r1805124507",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1805124507"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/30988"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 228,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1805134391",
      "pull_request_review_id": 2373476515,
      "id": 1805134391,
      "node_id": "PRRC_kwDOABII585rmCo3",
      "diff_hunk": "@@ -127,6 +127,22 @@ class SockMan\n      */\n     virtual bool ShouldTryToRecv(NodeId node_id) const;\n \n+    /**\n+     * SockMan has completed the current send+recv iteration for a node.\n+     * It will do another send+recv for this node after processing all other nodes.\n+     * Can be used to execute periodic tasks for a given node.\n+     * The implementation in SockMan does nothing.\n+     * @param[in] node_id Node for which send+recv has been done.\n+     */\n+    virtual void EventIOLoopCompletedForNode(NodeId node_id);\n+\n+    /**\n+     * SockMan has completed send+recv for all nodes.\n+     * Can be used to execute periodic tasks for all nodes.\n+     * The implementation in SockMan does nothing.\n+     */\n+    virtual void EventIOLoopCompletedForAllPeers();",
      "path": "src/common/sockman.h",
      "position": 257,
      "original_position": 18,
      "commit_id": "7866c736c87a908cef75dc6901c9c0594c65b0eb",
      "original_commit_id": "50cb52470ea6cc4de5a5e5260b8f308353942ec0",
      "in_reply_to_id": null,
      "user": {
        "login": "pinheadmz",
        "id": 2084648,
        "node_id": "MDQ6VXNlcjIwODQ2NDg=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2084648?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/pinheadmz",
        "html_url": "https://github.com/pinheadmz",
        "followers_url": "https://api.github.com/users/pinheadmz/followers",
        "following_url": "https://api.github.com/users/pinheadmz/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/pinheadmz/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/pinheadmz/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/pinheadmz/subscriptions",
        "organizations_url": "https://api.github.com/users/pinheadmz/orgs",
        "repos_url": "https://api.github.com/users/pinheadmz/repos",
        "events_url": "https://api.github.com/users/pinheadmz/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/pinheadmz/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "50cb52470ea6cc4de5a5e5260b8f308353942ec0\r\n\r\nThis is great, can be used for timed actions (like locking the wallet) we used to depend on libevent for",
      "created_at": "2024-10-17T17:12:00Z",
      "updated_at": "2024-10-18T15:14:27Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30988#discussion_r1805134391",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1805134391"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/30988"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 257,
      "original_line": 257,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1805142536",
      "pull_request_review_id": 2373476515,
      "id": 1805142536,
      "node_id": "PRRC_kwDOABII585rmEoI",
      "diff_hunk": "@@ -2013,6 +2013,29 @@ bool CConnman::ShouldTryToRecv(NodeId node_id) const\n     return !node->fPauseRecv;\n }\n \n+void CConnman::EventIOLoopCompletedForNode(NodeId node_id)\n+{\n+    AssertLockNotHeld(m_nodes_mutex);\n+\n+    CNode* node{GetNodeById(node_id)};\n+    if (node == nullptr) {\n+        return;\n+    }\n+\n+    if (InactivityCheck(*node)) {\n+        node->fDisconnect = true;\n+    }\n+}\n+\n+void CConnman::EventIOLoopCompletedForAllPeers()\n+{\n+    AssertLockNotHeld(m_nodes_mutex);\n+    AssertLockNotHeld(m_reconnections_mutex);\n+\n+    DisconnectNodes();",
      "path": "src/net.cpp",
      "position": null,
      "original_position": 23,
      "commit_id": "7866c736c87a908cef75dc6901c9c0594c65b0eb",
      "original_commit_id": "50cb52470ea6cc4de5a5e5260b8f308353942ec0",
      "in_reply_to_id": null,
      "user": {
        "login": "pinheadmz",
        "id": 2084648,
        "node_id": "MDQ6VXNlcjIwODQ2NDg=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2084648?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/pinheadmz",
        "html_url": "https://github.com/pinheadmz",
        "followers_url": "https://api.github.com/users/pinheadmz/followers",
        "following_url": "https://api.github.com/users/pinheadmz/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/pinheadmz/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/pinheadmz/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/pinheadmz/subscriptions",
        "organizations_url": "https://api.github.com/users/pinheadmz/orgs",
        "repos_url": "https://api.github.com/users/pinheadmz/repos",
        "events_url": "https://api.github.com/users/pinheadmz/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/pinheadmz/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "50cb52470ea6cc4de5a5e5260b8f308353942ec0\r\n\r\nInteresting that the parent class handles accepting connections but the child is expected to handle disconnections, and inside the utility event loop function. Of course only the derived class would know when disconnection is appropriate, I wonder if anything it makes sense just to add a comment in `sockman.h` that `EventIOLoopCompletedForAllPeers()` is expected to handle that, erasing items from `m_nodes`",
      "created_at": "2024-10-17T17:19:06Z",
      "updated_at": "2024-10-18T15:14:27Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30988#discussion_r1805142536",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1805142536"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/30988"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 2035,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1805157675",
      "pull_request_review_id": 2373476515,
      "id": 1805157675,
      "node_id": "PRRC_kwDOABII585rmIUr",
      "diff_hunk": "@@ -10,6 +10,19 @@\n #include <util/sock.h>\n #include <util/thread.h>\n \n+CService GetBindAddress(const Sock& sock)\n+{\n+    CService addr_bind;\n+    struct sockaddr_storage sockaddr_bind;\n+    socklen_t sockaddr_bind_len = sizeof(sockaddr_bind);\n+    if (!sock.GetSockName((struct sockaddr*)&sockaddr_bind, &sockaddr_bind_len)) {",
      "path": "src/common/sockman.cpp",
      "position": 24,
      "original_position": 9,
      "commit_id": "7866c736c87a908cef75dc6901c9c0594c65b0eb",
      "original_commit_id": "3bb0145514978092ae966e30693cf619e4034837",
      "in_reply_to_id": null,
      "user": {
        "login": "pinheadmz",
        "id": 2084648,
        "node_id": "MDQ6VXNlcjIwODQ2NDg=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2084648?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/pinheadmz",
        "html_url": "https://github.com/pinheadmz",
        "followers_url": "https://api.github.com/users/pinheadmz/followers",
        "following_url": "https://api.github.com/users/pinheadmz/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/pinheadmz/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/pinheadmz/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/pinheadmz/subscriptions",
        "organizations_url": "https://api.github.com/users/pinheadmz/orgs",
        "repos_url": "https://api.github.com/users/pinheadmz/repos",
        "events_url": "https://api.github.com/users/pinheadmz/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/pinheadmz/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "3bb0145514978092ae966e30693cf619e4034837\r\n\r\nthe `else {error}` looked backwards to me here at first, might be more clear to use `== 0` instead of `!` but i dunno what the official style is for this.",
      "created_at": "2024-10-17T17:32:07Z",
      "updated_at": "2024-10-18T15:14:27Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30988#discussion_r1805157675",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1805157675"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/30988"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 24,
      "original_line": 24,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1805160999",
      "pull_request_review_id": 2373476515,
      "id": 1805160999,
      "node_id": "PRRC_kwDOABII585rmJIn",
      "diff_hunk": "@@ -10,6 +10,19 @@\n #include <util/sock.h>\n #include <util/thread.h>\n \n+CService GetBindAddress(const Sock& sock)",
      "path": "src/common/sockman.cpp",
      "position": null,
      "original_position": 4,
      "commit_id": "7866c736c87a908cef75dc6901c9c0594c65b0eb",
      "original_commit_id": "3bb0145514978092ae966e30693cf619e4034837",
      "in_reply_to_id": null,
      "user": {
        "login": "pinheadmz",
        "id": 2084648,
        "node_id": "MDQ6VXNlcjIwODQ2NDg=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2084648?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/pinheadmz",
        "html_url": "https://github.com/pinheadmz",
        "followers_url": "https://api.github.com/users/pinheadmz/followers",
        "following_url": "https://api.github.com/users/pinheadmz/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/pinheadmz/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/pinheadmz/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/pinheadmz/subscriptions",
        "organizations_url": "https://api.github.com/users/pinheadmz/orgs",
        "repos_url": "https://api.github.com/users/pinheadmz/repos",
        "events_url": "https://api.github.com/users/pinheadmz/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/pinheadmz/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "3bb0145514978092ae966e30693cf619e4034837\r\n\r\nWould this make more sense as a direct method of `Sock` ? Especially now that it returns the simpler `CService` instead of `CAddress`",
      "created_at": "2024-10-17T17:35:04Z",
      "updated_at": "2024-10-18T15:14:27Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30988#discussion_r1805160999",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1805160999"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/30988"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 13,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1805171602",
      "pull_request_review_id": 2373476515,
      "id": 1805171602,
      "node_id": "PRRC_kwDOABII585rmLuS",
      "diff_hunk": "@@ -74,6 +79,37 @@ class SockMan\n      */\n     void JoinSocketsThreads();\n \n+    /**\n+     * A more readable std::tuple<std::string, uint16_t> for host and port.\n+     */\n+    struct StringHostIntPort {\n+        const std::string& host;\n+        uint16_t port;\n+    };\n+\n+    /**\n+     * Make an outbound connection, save the socket internally and return a newly generated node id.\n+     * @param[in] to The address to connect to, either as CService or a host as string and port as\n+     * an integer, if the later is used, then `proxy` must be valid.\n+     * @param[in] is_important If true, then log failures with higher severity.\n+     * @param[in] proxy Proxy to connect through if `proxy.IsValid()` is true.\n+     * @param[out] proxy_failed If `proxy` is valid and the connection failed because of the\n+     * proxy, then it will be set to true.\n+     * @param[out] me If the connection was successful then this is set to the address on the\n+     * local side of the socket.\n+     * @param[out] sock Connected socket, if the operation is successful.\n+     * @param[out] i2p_transient_session I2P session, if the operation is successful.\n+     * @return Newly generated node id, or std::nullopt if the operation fails.\n+     */\n+    std::optional<NodeId> ConnectAndMakeNodeId(const std::variant<CService, StringHostIntPort>& to,",
      "path": "src/common/sockman.h",
      "position": 110,
      "original_position": 50,
      "commit_id": "7866c736c87a908cef75dc6901c9c0594c65b0eb",
      "original_commit_id": "3bb0145514978092ae966e30693cf619e4034837",
      "in_reply_to_id": null,
      "user": {
        "login": "pinheadmz",
        "id": 2084648,
        "node_id": "MDQ6VXNlcjIwODQ2NDg=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2084648?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/pinheadmz",
        "html_url": "https://github.com/pinheadmz",
        "followers_url": "https://api.github.com/users/pinheadmz/followers",
        "following_url": "https://api.github.com/users/pinheadmz/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/pinheadmz/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/pinheadmz/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/pinheadmz/subscriptions",
        "organizations_url": "https://api.github.com/users/pinheadmz/orgs",
        "repos_url": "https://api.github.com/users/pinheadmz/repos",
        "events_url": "https://api.github.com/users/pinheadmz/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/pinheadmz/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "3bb0145514978092ae966e30693cf619e4034837\r\n\r\nThis is great. Won't be needed immediately for HTTP or StratumV2 but means we can more easily remove libevent from `bitcoin-cli` !",
      "created_at": "2024-10-17T17:44:51Z",
      "updated_at": "2024-10-18T15:14:27Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30988#discussion_r1805171602",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1805171602"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/30988"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 110,
      "original_line": 110,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1805205812",
      "pull_request_review_id": 2373476515,
      "id": 1805205812,
      "node_id": "PRRC_kwDOABII585rmUE0",
      "diff_hunk": "@@ -0,0 +1,85 @@\n+// Copyright (c) 2024-present The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or https://opensource.org/license/mit/.\n+\n+#include <config/bitcoin-config.h> // IWYU pragma: keep\n+\n+#include <common/sockman.h>\n+#include <logging.h>\n+#include <netbase.h>\n+#include <util/sock.h>\n+\n+bool SockMan::BindListenPort(const CService& addrBind, bilingual_str& strError)\n+{\n+    int nOne = 1;\n+\n+    // Create socket for listening for incoming connections\n+    struct sockaddr_storage sockaddr;\n+    socklen_t len = sizeof(sockaddr);\n+    if (!addrBind.GetSockAddr((struct sockaddr*)&sockaddr, &len))\n+    {\n+        strError = strprintf(Untranslated(\"Bind address family for %s not supported\"), addrBind.ToStringAddrPort());\n+        LogPrintLevel(BCLog::NET, BCLog::Level::Error, \"%s\\n\", strError.original);\n+        return false;\n+    }\n+\n+    std::unique_ptr<Sock> sock = CreateSock(addrBind.GetSAFamily(), SOCK_STREAM, IPPROTO_TCP);\n+    if (!sock) {\n+        strError = strprintf(Untranslated(\"Couldn't open socket for incoming connections (socket returned error %s)\"), NetworkErrorString(WSAGetLastError()));\n+        LogPrintLevel(BCLog::NET, BCLog::Level::Error, \"%s\\n\", strError.original);\n+        return false;\n+    }\n+\n+    // Allow binding if the port is still in TIME_WAIT state after\n+    // the program was closed and restarted.\n+    if (sock->SetSockOpt(SOL_SOCKET, SO_REUSEADDR, (sockopt_arg_type)&nOne, sizeof(int)) == SOCKET_ERROR) {\n+        strError = strprintf(Untranslated(\"Error setting SO_REUSEADDR on socket: %s, continuing anyway\"), NetworkErrorString(WSAGetLastError()));\n+        LogPrintf(\"%s\\n\", strError.original);\n+    }\n+\n+    // some systems don't have IPV6_V6ONLY but are always v6only; others do have the option\n+    // and enable it by default or not. Try to enable it, if possible.\n+    if (addrBind.IsIPv6()) {\n+#ifdef IPV6_V6ONLY\n+        if (sock->SetSockOpt(IPPROTO_IPV6, IPV6_V6ONLY, (sockopt_arg_type)&nOne, sizeof(int)) == SOCKET_ERROR) {\n+            strError = strprintf(Untranslated(\"Error setting IPV6_V6ONLY on socket: %s, continuing anyway\"), NetworkErrorString(WSAGetLastError()));\n+            LogPrintf(\"%s\\n\", strError.original);\n+        }\n+#endif\n+#ifdef WIN32\n+        int nProtLevel = PROTECTION_LEVEL_UNRESTRICTED;\n+        if (sock->SetSockOpt(IPPROTO_IPV6, IPV6_PROTECTION_LEVEL, (const char*)&nProtLevel, sizeof(int)) == SOCKET_ERROR) {\n+            strError = strprintf(Untranslated(\"Error setting IPV6_PROTECTION_LEVEL on socket: %s, continuing anyway\"), NetworkErrorString(WSAGetLastError()));\n+            LogPrintf(\"%s\\n\", strError.original);\n+        }\n+#endif\n+    }\n+",
      "path": "src/common/sockman.cpp",
      "position": 88,
      "original_position": 57,
      "commit_id": "7866c736c87a908cef75dc6901c9c0594c65b0eb",
      "original_commit_id": "41c87ddb3d7a18d2c0fa7eccfbde57e9d6e898c2",
      "in_reply_to_id": 1803692315,
      "user": {
        "login": "pinheadmz",
        "id": 2084648,
        "node_id": "MDQ6VXNlcjIwODQ2NDg=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2084648?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/pinheadmz",
        "html_url": "https://github.com/pinheadmz",
        "followers_url": "https://api.github.com/users/pinheadmz/followers",
        "following_url": "https://api.github.com/users/pinheadmz/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/pinheadmz/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/pinheadmz/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/pinheadmz/subscriptions",
        "organizations_url": "https://api.github.com/users/pinheadmz/orgs",
        "repos_url": "https://api.github.com/users/pinheadmz/repos",
        "events_url": "https://api.github.com/users/pinheadmz/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/pinheadmz/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "Moved to `NewSockAccepted()` in 9d1b352a4d050ec88b59cdf59209c0f086fea4e6",
      "created_at": "2024-10-17T18:04:36Z",
      "updated_at": "2024-10-18T15:14:27Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30988#discussion_r1805205812",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1805205812"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/30988"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 88,
      "original_line": 88,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1805233524",
      "pull_request_review_id": 2373476515,
      "id": 1805233524,
      "node_id": "PRRC_kwDOABII585rma10",
      "diff_hunk": "@@ -63,6 +96,16 @@ class SockMan\n     // Pure virtual functions must be implemented by children classes.\n     //\n \n+    /**\n+     * Be notified when a new connection has been accepted.\n+     * @param[in] sock Connected socket to communicate with the peer.\n+     * @param[in] me The address and port at our side of the connection.\n+     * @param[in] them The address and port at the peer's side of the connection.\n+     */\n+    virtual void EventNewConnectionAccepted(std::unique_ptr<Sock>&& sock,",
      "path": "src/common/sockman.h",
      "position": null,
      "original_position": 77,
      "commit_id": "7866c736c87a908cef75dc6901c9c0594c65b0eb",
      "original_commit_id": "b94f9d338fd0d3b47a4ea6165ce9cde48f3b19bc",
      "in_reply_to_id": 1804998403,
      "user": {
        "login": "pinheadmz",
        "id": 2084648,
        "node_id": "MDQ6VXNlcjIwODQ2NDg=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2084648?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/pinheadmz",
        "html_url": "https://github.com/pinheadmz",
        "followers_url": "https://api.github.com/users/pinheadmz/followers",
        "following_url": "https://api.github.com/users/pinheadmz/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/pinheadmz/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/pinheadmz/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/pinheadmz/subscriptions",
        "organizations_url": "https://api.github.com/users/pinheadmz/orgs",
        "repos_url": "https://api.github.com/users/pinheadmz/repos",
        "events_url": "https://api.github.com/users/pinheadmz/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/pinheadmz/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "resolved in b94f9d338fd0d3b47a4ea6165ce9cde48f3b19bc",
      "created_at": "2024-10-17T18:22:07Z",
      "updated_at": "2024-10-18T15:14:27Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30988#discussion_r1805233524",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1805233524"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/30988"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 105,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1806645938",
      "pull_request_review_id": 2373476515,
      "id": 1806645938,
      "node_id": "PRRC_kwDOABII585rrzqy",
      "diff_hunk": "@@ -262,8 +335,16 @@ void SockMan::EventIOLoopCompletedForAllPeers() {}\n \n void SockMan::EventI2PListen(const CService&, bool) {}\n \n+void SockMan::TestOnlyAddExistentNode(NodeId node_id, std::unique_ptr<Sock>&& sock)\n+{\n+    LOCK(m_connected_mutex);\n+    m_connected.emplace(node_id, std::make_shared<NodeSockets>(std::move(sock)));",
      "path": "src/common/sockman.cpp",
      "position": null,
      "original_position": 149,
      "commit_id": "7866c736c87a908cef75dc6901c9c0594c65b0eb",
      "original_commit_id": "c133a634d10e172652ebbf05ca114037c8e551b9",
      "in_reply_to_id": null,
      "user": {
        "login": "pinheadmz",
        "id": 2084648,
        "node_id": "MDQ6VXNlcjIwODQ2NDg=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2084648?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/pinheadmz",
        "html_url": "https://github.com/pinheadmz",
        "followers_url": "https://api.github.com/users/pinheadmz/followers",
        "following_url": "https://api.github.com/users/pinheadmz/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/pinheadmz/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/pinheadmz/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/pinheadmz/subscriptions",
        "organizations_url": "https://api.github.com/users/pinheadmz/orgs",
        "repos_url": "https://api.github.com/users/pinheadmz/repos",
        "events_url": "https://api.github.com/users/pinheadmz/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/pinheadmz/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "c133a634d10e172652ebbf05ca114037c8e551b9\r\n\r\nI know this is for testing only, but what happens if there is a NodeId collision (An existing node is inserted with a duplicate ID, replacing a connected node in sockman)?",
      "created_at": "2024-10-18T14:57:30Z",
      "updated_at": "2024-10-18T15:14:27Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30988#discussion_r1806645938",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1806645938"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/30988"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 282,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1806666862",
      "pull_request_review_id": 2373476515,
      "id": 1806666862,
      "node_id": "PRRC_kwDOABII585rr4xu",
      "diff_hunk": "@@ -297,3 +378,151 @@ void SockMan::ThreadI2PAccept()\n         err_wait = err_wait_begin;\n     }\n }\n+\n+void SockMan::ThreadSocketHandler()\n+{\n+    AssertLockNotHeld(m_connected_mutex);\n+\n+    while (!interruptNet) {\n+        EventIOLoopCompletedForAllPeers();\n+\n+        // Check for the readiness of the already connected sockets and the\n+        // listening sockets in one call (\"readiness\" as in poll(2) or\n+        // select(2)). If none are ready, wait for a short while and return\n+        // empty sets.\n+        auto io_readiness{GenerateWaitSockets()};\n+        if (io_readiness.events_per_sock.empty() ||\n+            !io_readiness.events_per_sock.begin()->first->WaitMany(SELECT_TIMEOUT,",
      "path": "src/common/sockman.cpp",
      "position": null,
      "original_position": 177,
      "commit_id": "7866c736c87a908cef75dc6901c9c0594c65b0eb",
      "original_commit_id": "c133a634d10e172652ebbf05ca114037c8e551b9",
      "in_reply_to_id": null,
      "user": {
        "login": "pinheadmz",
        "id": 2084648,
        "node_id": "MDQ6VXNlcjIwODQ2NDg=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2084648?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/pinheadmz",
        "html_url": "https://github.com/pinheadmz",
        "followers_url": "https://api.github.com/users/pinheadmz/followers",
        "following_url": "https://api.github.com/users/pinheadmz/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/pinheadmz/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/pinheadmz/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/pinheadmz/subscriptions",
        "organizations_url": "https://api.github.com/users/pinheadmz/orgs",
        "repos_url": "https://api.github.com/users/pinheadmz/repos",
        "events_url": "https://api.github.com/users/pinheadmz/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/pinheadmz/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "c133a634d10e172652ebbf05ca114037c8e551b9\r\n\r\nYou might want to add another comment here - when I was trying to handle socks myself I found this a bit weird and wrote:\r\n\r\n```\r\n    // WaitMany() mine as well be a static function, the context\r\n    // of the first Sock in the vector is not relevant.\r\n```",
      "created_at": "2024-10-18T15:13:32Z",
      "updated_at": "2024-10-18T15:14:27Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30988#discussion_r1806666862",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1806666862"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/30988"
        }
      },
      "start_line": null,
      "original_start_line": 394,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 341,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1867660305",
      "pull_request_review_id": 2475577960,
      "id": 1867660305,
      "node_id": "PRRC_kwDOABII585vUjwR",
      "diff_hunk": "@@ -1796,10 +1796,10 @@ void CConnman::CreateNodeFromAcceptedSocket(std::unique_ptr<Sock>&& sock,\n \n     CNode* pnode = new CNode(id,\n                              std::move(sock),\n-                             addr,\n+                             CAddress{addr, NODE_NONE},\n                              CalculateKeyedNetGroup(addr),\n                              nonce,\n-                             addr_bind,\n+                             CAddress{addr_bind, NODE_NONE},",
      "path": "src/net.cpp",
      "position": null,
      "original_position": 45,
      "commit_id": "7866c736c87a908cef75dc6901c9c0594c65b0eb",
      "original_commit_id": "1bfc1ca9b6b68c6356ffc23ecf01e417152ade95",
      "in_reply_to_id": 1803679987,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "`CNode::addr` needs to be `CAddress` because at least `PeerManagerImpl::PushNodeVersion()` is using `addr.nServices`.\r\n\r\n`CNode::addrBind` indeed does not need to be `CAddress`. I changed it to `CService`.",
      "created_at": "2024-12-03T12:43:35Z",
      "updated_at": "2024-12-03T12:43:35Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30988#discussion_r1867660305",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1867660305"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/30988"
        }
      },
      "start_line": null,
      "original_start_line": 1799,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 1715,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1867664745",
      "pull_request_review_id": 2475584933,
      "id": 1867664745,
      "node_id": "PRRC_kwDOABII585vUk1p",
      "diff_hunk": "@@ -9,9 +9,12 @@\n #include <util/sock.h>\n #include <util/translation.h>\n \n+#include <atomic>\n #include <memory>\n #include <vector>\n \n+typedef int64_t NodeId;",
      "path": "src/common/sockman.h",
      "position": 23,
      "original_position": 8,
      "commit_id": "7866c736c87a908cef75dc6901c9c0594c65b0eb",
      "original_commit_id": "5d4920f630417ceeee1c79304faac6803795cd64",
      "in_reply_to_id": 1804940161,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "\"Peer\" is a good description for this, but that is already used in `net_processing`.",
      "created_at": "2024-12-03T12:46:38Z",
      "updated_at": "2024-12-03T12:46:39Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30988#discussion_r1867664745",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1867664745"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/30988"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 23,
      "original_line": 23,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1867697664",
      "pull_request_review_id": 2475640361,
      "id": 1867697664,
      "node_id": "PRRC_kwDOABII585vUs4A",
      "diff_hunk": "@@ -45,12 +45,13 @@ FUZZ_TARGET(connman, .init = initialize_connman)\n     connman.Init(options);\n \n     CNetAddr random_netaddr;\n-    CNode random_node = ConsumeNode(fuzzed_data_provider);\n+    NodeId node_id{0};\n+    CNode random_node = ConsumeNode(fuzzed_data_provider, node_id++);",
      "path": "src/test/fuzz/connman.cpp",
      "position": null,
      "original_position": 6,
      "commit_id": "7866c736c87a908cef75dc6901c9c0594c65b0eb",
      "original_commit_id": "b96beb27d2b3d06a45644c537c114a08f0ccd285",
      "in_reply_to_id": 1805115729,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "`GetNewNodeId()` is private. Not worth weakening the encapsulation for this test.",
      "created_at": "2024-12-03T13:10:42Z",
      "updated_at": "2024-12-03T13:10:43Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30988#discussion_r1867697664",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1867697664"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/30988"
        }
      },
      "start_line": null,
      "original_start_line": 48,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 49,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1867701118",
      "pull_request_review_id": 2475646217,
      "id": 1867701118,
      "node_id": "PRRC_kwDOABII585vUtt-",
      "diff_hunk": "@@ -111,6 +111,22 @@ class SockMan\n     // alone to use the default implementation from SockMan.\n     //\n \n+    /**\n+     * SockMan would only call EventReadyToSend() if this returns true.\n+     * Can be used to temporary pause sends for a node.\n+     * The implementation in SockMan always returns true.\n+     * @param[in] node_id Node for which to confirm or cancel a call to EventReadyToSend().\n+     */\n+    virtual bool ShouldTryToSend(NodeId node_id) const;\n+\n+    /**\n+     * SockMan would only call Recv() on a node's socket if this returns true.\n+     * Can be used to temporary pause receives for a node.",
      "path": "src/common/sockman.h",
      "position": null,
      "original_position": 14,
      "commit_id": "7866c736c87a908cef75dc6901c9c0594c65b0eb",
      "original_commit_id": "bb5b91d430026c4826a2107c8c1a311518cc97ce",
      "in_reply_to_id": 1805124507,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "Done",
      "created_at": "2024-12-03T13:13:11Z",
      "updated_at": "2024-12-03T13:13:11Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30988#discussion_r1867701118",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1867701118"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/30988"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 228,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1867731551",
      "pull_request_review_id": 2475696688,
      "id": 1867731551,
      "node_id": "PRRC_kwDOABII585vU1Jf",
      "diff_hunk": "@@ -2013,6 +2013,29 @@ bool CConnman::ShouldTryToRecv(NodeId node_id) const\n     return !node->fPauseRecv;\n }\n \n+void CConnman::EventIOLoopCompletedForNode(NodeId node_id)\n+{\n+    AssertLockNotHeld(m_nodes_mutex);\n+\n+    CNode* node{GetNodeById(node_id)};\n+    if (node == nullptr) {\n+        return;\n+    }\n+\n+    if (InactivityCheck(*node)) {\n+        node->fDisconnect = true;\n+    }\n+}\n+\n+void CConnman::EventIOLoopCompletedForAllPeers()\n+{\n+    AssertLockNotHeld(m_nodes_mutex);\n+    AssertLockNotHeld(m_reconnections_mutex);\n+\n+    DisconnectNodes();",
      "path": "src/net.cpp",
      "position": null,
      "original_position": 23,
      "commit_id": "7866c736c87a908cef75dc6901c9c0594c65b0eb",
      "original_commit_id": "50cb52470ea6cc4de5a5e5260b8f308353942ec0",
      "in_reply_to_id": 1805142536,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "Good observation. I guess this is the nature of things: accepting new connections is driven (initiated) by low level socket event when a new connection arrives, while disconnecting can be low level driven or high level driven - e.g. misbehaving peer at the application layer.\r\n\r\nI extended the comment of `EventIOLoopCompletedForAllPeers()` a little bit:\r\n\r\n```diff\r\n    -+     * Can be used to execute periodic tasks for all nodes.                   \r\n    ++     * Can be used to execute periodic tasks for all nodes, like disconnecting\r\n    ++     * nodes due to higher level logic.           \r\n```",
      "created_at": "2024-12-03T13:34:07Z",
      "updated_at": "2024-12-03T13:34:07Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30988#discussion_r1867731551",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1867731551"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/30988"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 2035,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1867742015",
      "pull_request_review_id": 2475714232,
      "id": 1867742015,
      "node_id": "PRRC_kwDOABII585vU3s_",
      "diff_hunk": "@@ -10,6 +10,19 @@\n #include <util/sock.h>\n #include <util/thread.h>\n \n+CService GetBindAddress(const Sock& sock)\n+{\n+    CService addr_bind;\n+    struct sockaddr_storage sockaddr_bind;\n+    socklen_t sockaddr_bind_len = sizeof(sockaddr_bind);\n+    if (!sock.GetSockName((struct sockaddr*)&sockaddr_bind, &sockaddr_bind_len)) {",
      "path": "src/common/sockman.cpp",
      "position": 24,
      "original_position": 9,
      "commit_id": "7866c736c87a908cef75dc6901c9c0594c65b0eb",
      "original_commit_id": "3bb0145514978092ae966e30693cf619e4034837",
      "in_reply_to_id": 1805157675,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "I don't think we have an official recommendation. My personal preference is to not treat integers as booleans: use `if (x == 0)` instead of `if (!x)` when `x` is an integer. But I am leaving this as it is because it is like that in `master` and this PR only moves it from `net.cpp` to `sockman.cpp` verbatim. I hope it is easier to reviewers to just check that a blob of code is moved without having to validate its correctness since that same code is already in `master`. This helps with such moves:\r\n\r\n`~/.gitconfig`:\r\n```\r\n[diff]  \r\n        colorMoved = dimmed-zebra\r\n        colorMovedWS = allow-indentation-change\r\n```",
      "created_at": "2024-12-03T13:41:11Z",
      "updated_at": "2024-12-03T13:41:11Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30988#discussion_r1867742015",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1867742015"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/30988"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 24,
      "original_line": 24,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1867749410",
      "pull_request_review_id": 2475726387,
      "id": 1867749410,
      "node_id": "PRRC_kwDOABII585vU5gi",
      "diff_hunk": "@@ -10,6 +10,19 @@\n #include <util/sock.h>\n #include <util/thread.h>\n \n+CService GetBindAddress(const Sock& sock)",
      "path": "src/common/sockman.cpp",
      "position": null,
      "original_position": 4,
      "commit_id": "7866c736c87a908cef75dc6901c9c0594c65b0eb",
      "original_commit_id": "3bb0145514978092ae966e30693cf619e4034837",
      "in_reply_to_id": 1805160999,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "Maybe yes, but `sock.{h,cpp}` does not currently include `netaddress.h` and I guess including it may cause circular dependency. It would also increase the scope of this PR. I am leaving it as it is.",
      "created_at": "2024-12-03T13:46:07Z",
      "updated_at": "2024-12-03T13:46:07Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30988#discussion_r1867749410",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1867749410"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/30988"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 13,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1867761722",
      "pull_request_review_id": 2475746404,
      "id": 1867761722,
      "node_id": "PRRC_kwDOABII585vU8g6",
      "diff_hunk": "@@ -262,8 +335,16 @@ void SockMan::EventIOLoopCompletedForAllPeers() {}\n \n void SockMan::EventI2PListen(const CService&, bool) {}\n \n+void SockMan::TestOnlyAddExistentNode(NodeId node_id, std::unique_ptr<Sock>&& sock)\n+{\n+    LOCK(m_connected_mutex);\n+    m_connected.emplace(node_id, std::make_shared<NodeSockets>(std::move(sock)));",
      "path": "src/common/sockman.cpp",
      "position": null,
      "original_position": 149,
      "commit_id": "7866c736c87a908cef75dc6901c9c0594c65b0eb",
      "original_commit_id": "c133a634d10e172652ebbf05ca114037c8e551b9",
      "in_reply_to_id": 1806645938,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "It would be a mess. I added an assert to make it clear that a test which inserts duplicate ids is broken.",
      "created_at": "2024-12-03T13:53:20Z",
      "updated_at": "2024-12-03T13:53:21Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30988#discussion_r1867761722",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1867761722"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/30988"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 282,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1867768931",
      "pull_request_review_id": 2475757783,
      "id": 1867768931,
      "node_id": "PRRC_kwDOABII585vU-Rj",
      "diff_hunk": "@@ -297,3 +378,151 @@ void SockMan::ThreadI2PAccept()\n         err_wait = err_wait_begin;\n     }\n }\n+\n+void SockMan::ThreadSocketHandler()\n+{\n+    AssertLockNotHeld(m_connected_mutex);\n+\n+    while (!interruptNet) {\n+        EventIOLoopCompletedForAllPeers();\n+\n+        // Check for the readiness of the already connected sockets and the\n+        // listening sockets in one call (\"readiness\" as in poll(2) or\n+        // select(2)). If none are ready, wait for a short while and return\n+        // empty sets.\n+        auto io_readiness{GenerateWaitSockets()};\n+        if (io_readiness.events_per_sock.empty() ||\n+            !io_readiness.events_per_sock.begin()->first->WaitMany(SELECT_TIMEOUT,",
      "path": "src/common/sockman.cpp",
      "position": null,
      "original_position": 177,
      "commit_id": "7866c736c87a908cef75dc6901c9c0594c65b0eb",
      "original_commit_id": "c133a634d10e172652ebbf05ca114037c8e551b9",
      "in_reply_to_id": 1806666862,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "Done",
      "created_at": "2024-12-03T13:57:46Z",
      "updated_at": "2024-12-03T13:57:46Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30988#discussion_r1867768931",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1867768931"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/30988"
        }
      },
      "start_line": null,
      "original_start_line": 394,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 341,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1878764170",
      "pull_request_review_id": 2493471520,
      "id": 1878764170,
      "node_id": "PRRC_kwDOABII585v-6qK",
      "diff_hunk": "@@ -0,0 +1,427 @@\n+// Copyright (c) 2024-present The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or https://opensource.org/license/mit/.\n+\n+#ifndef BITCOIN_COMMON_SOCKMAN_H\n+#define BITCOIN_COMMON_SOCKMAN_H\n+\n+#include <i2p.h>\n+#include <netaddress.h>\n+#include <netbase.h>\n+#include <util/fs.h>\n+#include <util/sock.h>\n+#include <util/translation.h>\n+\n+#include <atomic>\n+#include <memory>\n+#include <queue>\n+#include <thread>\n+#include <variant>\n+#include <vector>\n+\n+typedef int64_t NodeId;\n+\n+/**\n+ * A socket manager class which handles socket operations.\n+ * To use this class, inherit from it and implement the pure virtual methods.\n+ * Handled operations:\n+ * - binding and listening on sockets\n+ * - starting of necessary threads to process socket operations\n+ * - accepting incoming connections\n+ * - making outbound connections\n+ * - closing connections\n+ * - waiting for IO readiness on sockets and doing send/recv accordingly\n+ */\n+class SockMan\n+{\n+public:\n+\n+    virtual ~SockMan() = default;\n+\n+    //\n+    // Non-virtual functions, to be reused by children classes.\n+    //\n+\n+    /**\n+     * Bind to a new address:port, start listening and add the listen socket to `m_listen`.\n+     * Should be called before `StartSocketsThreads()`.\n+     * @param[in] to Where to bind.\n+     * @param[out] errmsg Error string if an error occurs.\n+     * @retval true Success.\n+     * @retval false Failure, `strError` will be set.\n+     */\n+    bool BindAndStartListening(const CService& to, bilingual_str& errmsg);\n+\n+    /**\n+     * Options to influence `StartSocketsThreads()`.\n+     */\n+    struct Options {\n+        struct I2P {\n+            explicit I2P(const fs::path& file, const Proxy& proxy) : private_key_file{file}, sam_proxy{proxy} {}\n+\n+            const fs::path private_key_file;\n+            const Proxy sam_proxy;\n+        };\n+\n+        /**\n+         * I2P options. If set then a thread will be started that will accept incoming I2P connections.\n+         */\n+        std::optional<I2P> i2p;\n+    };\n+\n+    /**\n+     * Start the necessary threads for sockets IO.\n+     */\n+    void StartSocketsThreads(const Options& options);\n+\n+    /**\n+     * Join (wait for) the threads started by `StartSocketsThreads()` to exit.\n+     */\n+    void JoinSocketsThreads();\n+\n+    /**\n+     * A more readable std::tuple<std::string, uint16_t> for host and port.\n+     */\n+    struct StringHostIntPort {\n+        const std::string& host;\n+        uint16_t port;\n+    };\n+\n+    /**\n+     * Make an outbound connection, save the socket internally and return a newly generated node id.\n+     * @param[in] to The address to connect to, either as CService or a host as string and port as\n+     * an integer, if the later is used, then `proxy` must be valid.\n+     * @param[in] is_important If true, then log failures with higher severity.\n+     * @param[in] proxy Proxy to connect through if `proxy.IsValid()` is true.\n+     * @param[out] proxy_failed If `proxy` is valid and the connection failed because of the\n+     * proxy, then it will be set to true.\n+     * @param[out] me If the connection was successful then this is set to the address on the\n+     * local side of the socket.\n+     * @return Newly generated node id, or std::nullopt if the operation fails.\n+     */\n+    std::optional<NodeId> ConnectAndMakeNodeId(const std::variant<CService, StringHostIntPort>& to,\n+                                               bool is_important,\n+                                               const Proxy& proxy,\n+                                               bool& proxy_failed,\n+                                               CService& me)\n+        EXCLUSIVE_LOCKS_REQUIRED(!m_connected_mutex, !m_unused_i2p_sessions_mutex);\n+\n+    /**\n+     * Disconnect a given peer by closing its socket and release resources occupied by it.\n+     * @return Whether the peer existed and its socket was closed by this call.\n+     */\n+    bool CloseConnection(NodeId node_id)\n+        EXCLUSIVE_LOCKS_REQUIRED(!m_connected_mutex);\n+\n+    /**\n+     * Try to send some data to the given node.\n+     * @param[in] node_id Identifier of the node to send to.\n+     * @param[in] data The data to send, it might happen that only a prefix of this is sent.\n+     * @param[in] will_send_more Used as an optimization if the caller knows that they will\n+     * be sending more data soon after this call.\n+     * @param[out] errmsg If <0 is returned then this will contain a human readable message\n+     * explaining the error.\n+     * @retval >=0 The number of bytes actually sent.\n+     * @retval <0 A permanent error has occurred.\n+     */\n+    ssize_t SendBytes(NodeId node_id,\n+                      Span<const unsigned char> data,",
      "path": "src/common/sockman.h",
      "position": null,
      "original_position": 128,
      "commit_id": "7866c736c87a908cef75dc6901c9c0594c65b0eb",
      "original_commit_id": "645f625e29b36321bcba8db5758b0428b8ebd80f",
      "in_reply_to_id": null,
      "user": {
        "login": "pinheadmz",
        "id": 2084648,
        "node_id": "MDQ6VXNlcjIwODQ2NDg=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2084648?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/pinheadmz",
        "html_url": "https://github.com/pinheadmz",
        "followers_url": "https://api.github.com/users/pinheadmz/followers",
        "following_url": "https://api.github.com/users/pinheadmz/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/pinheadmz/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/pinheadmz/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/pinheadmz/subscriptions",
        "organizations_url": "https://api.github.com/users/pinheadmz/orgs",
        "repos_url": "https://api.github.com/users/pinheadmz/repos",
        "events_url": "https://api.github.com/users/pinheadmz/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/pinheadmz/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "Why not use std::span? I thought `Span` was only a temporary fill-in until C++20 something something? Also, I'm using std::span elsewhere... is `Span` the preference?",
      "created_at": "2024-12-10T20:12:05Z",
      "updated_at": "2024-12-10T20:12:05Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30988#discussion_r1878764170",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1878764170"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/30988"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 128,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1886282291",
      "pull_request_review_id": 2505319114,
      "id": 1886282291,
      "node_id": "PRRC_kwDOABII585wbmIz",
      "diff_hunk": "@@ -0,0 +1,427 @@\n+// Copyright (c) 2024-present The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or https://opensource.org/license/mit/.\n+\n+#ifndef BITCOIN_COMMON_SOCKMAN_H\n+#define BITCOIN_COMMON_SOCKMAN_H\n+\n+#include <i2p.h>\n+#include <netaddress.h>\n+#include <netbase.h>\n+#include <util/fs.h>\n+#include <util/sock.h>\n+#include <util/translation.h>\n+\n+#include <atomic>\n+#include <memory>\n+#include <queue>\n+#include <thread>\n+#include <variant>\n+#include <vector>\n+\n+typedef int64_t NodeId;\n+\n+/**\n+ * A socket manager class which handles socket operations.\n+ * To use this class, inherit from it and implement the pure virtual methods.\n+ * Handled operations:\n+ * - binding and listening on sockets\n+ * - starting of necessary threads to process socket operations\n+ * - accepting incoming connections\n+ * - making outbound connections\n+ * - closing connections\n+ * - waiting for IO readiness on sockets and doing send/recv accordingly\n+ */\n+class SockMan\n+{\n+public:\n+\n+    virtual ~SockMan() = default;\n+\n+    //\n+    // Non-virtual functions, to be reused by children classes.\n+    //\n+\n+    /**\n+     * Bind to a new address:port, start listening and add the listen socket to `m_listen`.\n+     * Should be called before `StartSocketsThreads()`.\n+     * @param[in] to Where to bind.\n+     * @param[out] errmsg Error string if an error occurs.\n+     * @retval true Success.\n+     * @retval false Failure, `strError` will be set.\n+     */\n+    bool BindAndStartListening(const CService& to, bilingual_str& errmsg);\n+\n+    /**\n+     * Options to influence `StartSocketsThreads()`.\n+     */\n+    struct Options {\n+        struct I2P {\n+            explicit I2P(const fs::path& file, const Proxy& proxy) : private_key_file{file}, sam_proxy{proxy} {}\n+\n+            const fs::path private_key_file;\n+            const Proxy sam_proxy;\n+        };\n+\n+        /**\n+         * I2P options. If set then a thread will be started that will accept incoming I2P connections.\n+         */\n+        std::optional<I2P> i2p;\n+    };\n+\n+    /**\n+     * Start the necessary threads for sockets IO.\n+     */\n+    void StartSocketsThreads(const Options& options);\n+\n+    /**\n+     * Join (wait for) the threads started by `StartSocketsThreads()` to exit.\n+     */\n+    void JoinSocketsThreads();\n+\n+    /**\n+     * A more readable std::tuple<std::string, uint16_t> for host and port.\n+     */\n+    struct StringHostIntPort {\n+        const std::string& host;\n+        uint16_t port;\n+    };\n+\n+    /**\n+     * Make an outbound connection, save the socket internally and return a newly generated node id.\n+     * @param[in] to The address to connect to, either as CService or a host as string and port as\n+     * an integer, if the later is used, then `proxy` must be valid.\n+     * @param[in] is_important If true, then log failures with higher severity.\n+     * @param[in] proxy Proxy to connect through if `proxy.IsValid()` is true.\n+     * @param[out] proxy_failed If `proxy` is valid and the connection failed because of the\n+     * proxy, then it will be set to true.\n+     * @param[out] me If the connection was successful then this is set to the address on the\n+     * local side of the socket.\n+     * @return Newly generated node id, or std::nullopt if the operation fails.\n+     */\n+    std::optional<NodeId> ConnectAndMakeNodeId(const std::variant<CService, StringHostIntPort>& to,\n+                                               bool is_important,\n+                                               const Proxy& proxy,\n+                                               bool& proxy_failed,\n+                                               CService& me)\n+        EXCLUSIVE_LOCKS_REQUIRED(!m_connected_mutex, !m_unused_i2p_sessions_mutex);\n+\n+    /**\n+     * Disconnect a given peer by closing its socket and release resources occupied by it.\n+     * @return Whether the peer existed and its socket was closed by this call.\n+     */\n+    bool CloseConnection(NodeId node_id)\n+        EXCLUSIVE_LOCKS_REQUIRED(!m_connected_mutex);\n+\n+    /**\n+     * Try to send some data to the given node.\n+     * @param[in] node_id Identifier of the node to send to.\n+     * @param[in] data The data to send, it might happen that only a prefix of this is sent.\n+     * @param[in] will_send_more Used as an optimization if the caller knows that they will\n+     * be sending more data soon after this call.\n+     * @param[out] errmsg If <0 is returned then this will contain a human readable message\n+     * explaining the error.\n+     * @retval >=0 The number of bytes actually sent.\n+     * @retval <0 A permanent error has occurred.\n+     */\n+    ssize_t SendBytes(NodeId node_id,\n+                      Span<const unsigned char> data,",
      "path": "src/common/sockman.h",
      "position": null,
      "original_position": 128,
      "commit_id": "7866c736c87a908cef75dc6901c9c0594c65b0eb",
      "original_commit_id": "645f625e29b36321bcba8db5758b0428b8ebd80f",
      "in_reply_to_id": 1878764170,
      "user": {
        "login": "Sjors",
        "id": 10217,
        "node_id": "MDQ6VXNlcjEwMjE3",
        "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Sjors",
        "html_url": "https://github.com/Sjors",
        "followers_url": "https://api.github.com/users/Sjors/followers",
        "following_url": "https://api.github.com/users/Sjors/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Sjors/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Sjors/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
        "organizations_url": "https://api.github.com/users/Sjors/orgs",
        "repos_url": "https://api.github.com/users/Sjors/repos",
        "events_url": "https://api.github.com/users/Sjors/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Sjors/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "Even in relatively new code folks often use `Span`, e.g. #30043. cc @sipa, @laanwj",
      "created_at": "2024-12-16T07:10:15Z",
      "updated_at": "2024-12-16T07:10:15Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30988#discussion_r1886282291",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1886282291"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/30988"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 128,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1891188093",
      "pull_request_review_id": 2513401237,
      "id": 1891188093,
      "node_id": "PRRC_kwDOABII585wuT19",
      "diff_hunk": "@@ -0,0 +1,427 @@\n+// Copyright (c) 2024-present The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or https://opensource.org/license/mit/.\n+\n+#ifndef BITCOIN_COMMON_SOCKMAN_H\n+#define BITCOIN_COMMON_SOCKMAN_H\n+\n+#include <i2p.h>\n+#include <netaddress.h>\n+#include <netbase.h>\n+#include <util/fs.h>\n+#include <util/sock.h>\n+#include <util/translation.h>\n+\n+#include <atomic>\n+#include <memory>\n+#include <queue>\n+#include <thread>\n+#include <variant>\n+#include <vector>\n+\n+typedef int64_t NodeId;\n+\n+/**\n+ * A socket manager class which handles socket operations.\n+ * To use this class, inherit from it and implement the pure virtual methods.\n+ * Handled operations:\n+ * - binding and listening on sockets\n+ * - starting of necessary threads to process socket operations\n+ * - accepting incoming connections\n+ * - making outbound connections\n+ * - closing connections\n+ * - waiting for IO readiness on sockets and doing send/recv accordingly\n+ */\n+class SockMan\n+{\n+public:\n+\n+    virtual ~SockMan() = default;\n+\n+    //\n+    // Non-virtual functions, to be reused by children classes.\n+    //\n+\n+    /**\n+     * Bind to a new address:port, start listening and add the listen socket to `m_listen`.\n+     * Should be called before `StartSocketsThreads()`.\n+     * @param[in] to Where to bind.\n+     * @param[out] errmsg Error string if an error occurs.\n+     * @retval true Success.\n+     * @retval false Failure, `strError` will be set.\n+     */\n+    bool BindAndStartListening(const CService& to, bilingual_str& errmsg);\n+\n+    /**\n+     * Options to influence `StartSocketsThreads()`.\n+     */\n+    struct Options {\n+        struct I2P {\n+            explicit I2P(const fs::path& file, const Proxy& proxy) : private_key_file{file}, sam_proxy{proxy} {}\n+\n+            const fs::path private_key_file;\n+            const Proxy sam_proxy;\n+        };\n+\n+        /**\n+         * I2P options. If set then a thread will be started that will accept incoming I2P connections.\n+         */\n+        std::optional<I2P> i2p;\n+    };\n+\n+    /**\n+     * Start the necessary threads for sockets IO.\n+     */\n+    void StartSocketsThreads(const Options& options);\n+\n+    /**\n+     * Join (wait for) the threads started by `StartSocketsThreads()` to exit.\n+     */\n+    void JoinSocketsThreads();\n+\n+    /**\n+     * A more readable std::tuple<std::string, uint16_t> for host and port.\n+     */\n+    struct StringHostIntPort {\n+        const std::string& host;\n+        uint16_t port;\n+    };\n+\n+    /**\n+     * Make an outbound connection, save the socket internally and return a newly generated node id.\n+     * @param[in] to The address to connect to, either as CService or a host as string and port as\n+     * an integer, if the later is used, then `proxy` must be valid.\n+     * @param[in] is_important If true, then log failures with higher severity.\n+     * @param[in] proxy Proxy to connect through if `proxy.IsValid()` is true.\n+     * @param[out] proxy_failed If `proxy` is valid and the connection failed because of the\n+     * proxy, then it will be set to true.\n+     * @param[out] me If the connection was successful then this is set to the address on the\n+     * local side of the socket.\n+     * @return Newly generated node id, or std::nullopt if the operation fails.\n+     */\n+    std::optional<NodeId> ConnectAndMakeNodeId(const std::variant<CService, StringHostIntPort>& to,\n+                                               bool is_important,\n+                                               const Proxy& proxy,\n+                                               bool& proxy_failed,\n+                                               CService& me)\n+        EXCLUSIVE_LOCKS_REQUIRED(!m_connected_mutex, !m_unused_i2p_sessions_mutex);\n+\n+    /**\n+     * Disconnect a given peer by closing its socket and release resources occupied by it.\n+     * @return Whether the peer existed and its socket was closed by this call.\n+     */\n+    bool CloseConnection(NodeId node_id)\n+        EXCLUSIVE_LOCKS_REQUIRED(!m_connected_mutex);\n+\n+    /**\n+     * Try to send some data to the given node.\n+     * @param[in] node_id Identifier of the node to send to.\n+     * @param[in] data The data to send, it might happen that only a prefix of this is sent.\n+     * @param[in] will_send_more Used as an optimization if the caller knows that they will\n+     * be sending more data soon after this call.\n+     * @param[out] errmsg If <0 is returned then this will contain a human readable message\n+     * explaining the error.\n+     * @retval >=0 The number of bytes actually sent.\n+     * @retval <0 A permanent error has occurred.\n+     */\n+    ssize_t SendBytes(NodeId node_id,\n+                      Span<const unsigned char> data,",
      "path": "src/common/sockman.h",
      "position": null,
      "original_position": 128,
      "commit_id": "7866c736c87a908cef75dc6901c9c0594c65b0eb",
      "original_commit_id": "645f625e29b36321bcba8db5758b0428b8ebd80f",
      "in_reply_to_id": 1878764170,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "Must have been just inertia. The caller of the newly added `SendBytes()` has an argument that is already `Span` from elsewhere in the code, coming from here:\r\n\r\nhttps://github.com/bitcoin/bitcoin/blob/c1252b14d714448295200a595086dd3e78b46c8f/src/net.h#L307-L311\r\n\r\nNow I changed the argument of the newly added `SendBytes()` to `std::span`, looks better and the `Span` variable is accepted. Thanks!\r\n\r\nwen `s/Span/std::span/` all over the place?",
      "created_at": "2024-12-19T05:47:48Z",
      "updated_at": "2024-12-19T05:47:48Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30988#discussion_r1891188093",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1891188093"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/30988"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 128,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1892975685",
      "pull_request_review_id": 2515908987,
      "id": 1892975685,
      "node_id": "PRRC_kwDOABII585w1IRF",
      "diff_hunk": "@@ -0,0 +1,427 @@\n+// Copyright (c) 2024-present The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or https://opensource.org/license/mit/.\n+\n+#ifndef BITCOIN_COMMON_SOCKMAN_H\n+#define BITCOIN_COMMON_SOCKMAN_H\n+\n+#include <i2p.h>\n+#include <netaddress.h>\n+#include <netbase.h>\n+#include <util/fs.h>\n+#include <util/sock.h>\n+#include <util/translation.h>\n+\n+#include <atomic>\n+#include <memory>\n+#include <queue>\n+#include <thread>\n+#include <variant>\n+#include <vector>\n+\n+typedef int64_t NodeId;\n+\n+/**\n+ * A socket manager class which handles socket operations.\n+ * To use this class, inherit from it and implement the pure virtual methods.\n+ * Handled operations:\n+ * - binding and listening on sockets\n+ * - starting of necessary threads to process socket operations\n+ * - accepting incoming connections\n+ * - making outbound connections\n+ * - closing connections\n+ * - waiting for IO readiness on sockets and doing send/recv accordingly\n+ */\n+class SockMan\n+{\n+public:\n+\n+    virtual ~SockMan() = default;\n+\n+    //\n+    // Non-virtual functions, to be reused by children classes.\n+    //\n+\n+    /**\n+     * Bind to a new address:port, start listening and add the listen socket to `m_listen`.\n+     * Should be called before `StartSocketsThreads()`.\n+     * @param[in] to Where to bind.\n+     * @param[out] errmsg Error string if an error occurs.\n+     * @retval true Success.\n+     * @retval false Failure, `strError` will be set.\n+     */\n+    bool BindAndStartListening(const CService& to, bilingual_str& errmsg);\n+\n+    /**\n+     * Options to influence `StartSocketsThreads()`.\n+     */\n+    struct Options {\n+        struct I2P {\n+            explicit I2P(const fs::path& file, const Proxy& proxy) : private_key_file{file}, sam_proxy{proxy} {}\n+\n+            const fs::path private_key_file;\n+            const Proxy sam_proxy;\n+        };\n+\n+        /**\n+         * I2P options. If set then a thread will be started that will accept incoming I2P connections.\n+         */\n+        std::optional<I2P> i2p;\n+    };\n+\n+    /**\n+     * Start the necessary threads for sockets IO.\n+     */\n+    void StartSocketsThreads(const Options& options);\n+\n+    /**\n+     * Join (wait for) the threads started by `StartSocketsThreads()` to exit.\n+     */\n+    void JoinSocketsThreads();\n+\n+    /**\n+     * A more readable std::tuple<std::string, uint16_t> for host and port.\n+     */\n+    struct StringHostIntPort {\n+        const std::string& host;\n+        uint16_t port;\n+    };\n+\n+    /**\n+     * Make an outbound connection, save the socket internally and return a newly generated node id.\n+     * @param[in] to The address to connect to, either as CService or a host as string and port as\n+     * an integer, if the later is used, then `proxy` must be valid.\n+     * @param[in] is_important If true, then log failures with higher severity.\n+     * @param[in] proxy Proxy to connect through if `proxy.IsValid()` is true.\n+     * @param[out] proxy_failed If `proxy` is valid and the connection failed because of the\n+     * proxy, then it will be set to true.\n+     * @param[out] me If the connection was successful then this is set to the address on the\n+     * local side of the socket.\n+     * @return Newly generated node id, or std::nullopt if the operation fails.\n+     */\n+    std::optional<NodeId> ConnectAndMakeNodeId(const std::variant<CService, StringHostIntPort>& to,\n+                                               bool is_important,\n+                                               const Proxy& proxy,\n+                                               bool& proxy_failed,\n+                                               CService& me)\n+        EXCLUSIVE_LOCKS_REQUIRED(!m_connected_mutex, !m_unused_i2p_sessions_mutex);\n+\n+    /**\n+     * Disconnect a given peer by closing its socket and release resources occupied by it.\n+     * @return Whether the peer existed and its socket was closed by this call.\n+     */\n+    bool CloseConnection(NodeId node_id)\n+        EXCLUSIVE_LOCKS_REQUIRED(!m_connected_mutex);\n+\n+    /**\n+     * Try to send some data to the given node.\n+     * @param[in] node_id Identifier of the node to send to.\n+     * @param[in] data The data to send, it might happen that only a prefix of this is sent.\n+     * @param[in] will_send_more Used as an optimization if the caller knows that they will\n+     * be sending more data soon after this call.\n+     * @param[out] errmsg If <0 is returned then this will contain a human readable message\n+     * explaining the error.\n+     * @retval >=0 The number of bytes actually sent.\n+     * @retval <0 A permanent error has occurred.\n+     */\n+    ssize_t SendBytes(NodeId node_id,\n+                      Span<const unsigned char> data,",
      "path": "src/common/sockman.h",
      "position": null,
      "original_position": 128,
      "commit_id": "7866c736c87a908cef75dc6901c9c0594c65b0eb",
      "original_commit_id": "645f625e29b36321bcba8db5758b0428b8ebd80f",
      "in_reply_to_id": 1878764170,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "> wen `s/Span/std::span/` all over the place?\r\n\r\nnow: https://github.com/bitcoin/bitcoin/pull/31519",
      "created_at": "2024-12-19T18:36:33Z",
      "updated_at": "2024-12-19T18:36:33Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30988#discussion_r1892975685",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1892975685"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/30988"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 128,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1914992602",
      "pull_request_review_id": 2550005361,
      "id": 1914992602,
      "node_id": "PRRC_kwDOABII585yJHfa",
      "diff_hunk": "@@ -3145,13 +3145,16 @@ bool CConnman::Bind(const CService& addr_, unsigned int flags, NetPermissionFlag\n     const CService addr{MaybeFlipIPv6toCJDNS(addr_)};\n \n     bilingual_str strError;\n-    if (!BindListenPort(addr, strError)) {\n+    if (!BindAndStartListening(addr, strError)) {\n+        LogPrintLevel(BCLog::NET, BCLog::Level::Error, \"%s\\n\", strError.original);\n         if ((flags & BF_REPORT_ERROR) && m_client_interface) {\n             m_client_interface->ThreadSafeMessageBox(strError, \"\", CClientUIInterface::MSG_ERROR);\n         }\n         return false;\n     }\n \n+    LogPrintLevel(BCLog::NET, BCLog::Level::Info, \"Bound to and listening at %s\\n\", addr.ToStringAddrPort());",
      "path": "src/net.cpp",
      "position": null,
      "original_position": 13,
      "commit_id": "7866c736c87a908cef75dc6901c9c0594c65b0eb",
      "original_commit_id": "4c23aacc2b82083f96255963f543dc35fff28334",
      "in_reply_to_id": null,
      "user": {
        "login": "Sjors",
        "id": 10217,
        "node_id": "MDQ6VXNlcjEwMjE3",
        "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Sjors",
        "html_url": "https://github.com/Sjors",
        "followers_url": "https://api.github.com/users/Sjors/followers",
        "following_url": "https://api.github.com/users/Sjors/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Sjors/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Sjors/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
        "organizations_url": "https://api.github.com/users/Sjors/orgs",
        "repos_url": "https://api.github.com/users/Sjors/repos",
        "events_url": "https://api.github.com/users/Sjors/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Sjors/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "4c23aacc2b82083f96255963f543dc35fff28334: I'm inclined to say \"listening **on** %s\"\r\n\r\nAs in: we bind _to_ a port in order to listen _on_ it.\r\n\r\nThe linux manual for `listen` also uses \"on\", as in \"listen for connections on a socket\"\r\nhttps://man7.org/linux/man-pages/man2/listen.2.html",
      "created_at": "2025-01-14T15:05:33Z",
      "updated_at": "2025-01-14T15:31:47Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30988#discussion_r1914992602",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1914992602"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/30988"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 3156,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1915015927",
      "pull_request_review_id": 2550005361,
      "id": 1915015927,
      "node_id": "PRRC_kwDOABII585yJNL3",
      "diff_hunk": "@@ -9,68 +9,77 @@\n #include <netbase.h>\n #include <util/sock.h>\n \n-bool SockMan::BindListenPort(const CService& addrBind, bilingual_str& strError)\n+bool SockMan::BindAndStartListening(const CService& to, bilingual_str& errmsg)",
      "path": "src/common/sockman.cpp",
      "position": 32,
      "original_position": 5,
      "commit_id": "7866c736c87a908cef75dc6901c9c0594c65b0eb",
      "original_commit_id": "4c23aacc2b82083f96255963f543dc35fff28334",
      "in_reply_to_id": null,
      "user": {
        "login": "Sjors",
        "id": 10217,
        "node_id": "MDQ6VXNlcjEwMjE3",
        "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Sjors",
        "html_url": "https://github.com/Sjors",
        "followers_url": "https://api.github.com/users/Sjors/followers",
        "following_url": "https://api.github.com/users/Sjors/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Sjors/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Sjors/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
        "organizations_url": "https://api.github.com/users/Sjors/orgs",
        "repos_url": "https://api.github.com/users/Sjors/repos",
        "events_url": "https://api.github.com/users/Sjors/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Sjors/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "4c23aacc2b82083f96255963f543dc35fff28334: since you need to print log statements here in a few places anyway, might as well drop the `errmsg` argument and always print logs here.",
      "created_at": "2025-01-14T15:15:03Z",
      "updated_at": "2025-01-14T15:31:47Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30988#discussion_r1915015927",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1915015927"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/30988"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 32,
      "original_line": 32,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1915209026",
      "pull_request_review_id": 2550364600,
      "id": 1915209026,
      "node_id": "PRRC_kwDOABII585yJ8VC",
      "diff_hunk": "@@ -9,68 +9,77 @@\n #include <netbase.h>\n #include <util/sock.h>\n \n-bool SockMan::BindListenPort(const CService& addrBind, bilingual_str& strError)\n+bool SockMan::BindAndStartListening(const CService& to, bilingual_str& errmsg)",
      "path": "src/common/sockman.cpp",
      "position": 32,
      "original_position": 5,
      "commit_id": "7866c736c87a908cef75dc6901c9c0594c65b0eb",
      "original_commit_id": "4c23aacc2b82083f96255963f543dc35fff28334",
      "in_reply_to_id": 1915015927,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "`BindAndStartListening()` needs to return an error string to the caller, because the caller not only logs it but also passes it to `ThreadSafeMessageBox()`.",
      "created_at": "2025-01-14T16:38:24Z",
      "updated_at": "2025-01-14T16:38:24Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30988#discussion_r1915209026",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1915209026"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/30988"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 32,
      "original_line": 32,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1915209813",
      "pull_request_review_id": 2550365991,
      "id": 1915209813,
      "node_id": "PRRC_kwDOABII585yJ8hV",
      "diff_hunk": "@@ -3145,13 +3145,16 @@ bool CConnman::Bind(const CService& addr_, unsigned int flags, NetPermissionFlag\n     const CService addr{MaybeFlipIPv6toCJDNS(addr_)};\n \n     bilingual_str strError;\n-    if (!BindListenPort(addr, strError)) {\n+    if (!BindAndStartListening(addr, strError)) {\n+        LogPrintLevel(BCLog::NET, BCLog::Level::Error, \"%s\\n\", strError.original);\n         if ((flags & BF_REPORT_ERROR) && m_client_interface) {\n             m_client_interface->ThreadSafeMessageBox(strError, \"\", CClientUIInterface::MSG_ERROR);\n         }\n         return false;\n     }\n \n+    LogPrintLevel(BCLog::NET, BCLog::Level::Info, \"Bound to and listening at %s\\n\", addr.ToStringAddrPort());",
      "path": "src/net.cpp",
      "position": null,
      "original_position": 13,
      "commit_id": "7866c736c87a908cef75dc6901c9c0594c65b0eb",
      "original_commit_id": "4c23aacc2b82083f96255963f543dc35fff28334",
      "in_reply_to_id": 1914992602,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "Done, `s/at/on/`",
      "created_at": "2025-01-14T16:38:52Z",
      "updated_at": "2025-01-14T16:38:52Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30988#discussion_r1915209813",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1915209813"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/30988"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 3156,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1915228277",
      "pull_request_review_id": 2550393864,
      "id": 1915228277,
      "node_id": "PRRC_kwDOABII585yKBB1",
      "diff_hunk": "@@ -9,68 +9,77 @@\n #include <netbase.h>\n #include <util/sock.h>\n \n-bool SockMan::BindListenPort(const CService& addrBind, bilingual_str& strError)\n+bool SockMan::BindAndStartListening(const CService& to, bilingual_str& errmsg)",
      "path": "src/common/sockman.cpp",
      "position": 32,
      "original_position": 5,
      "commit_id": "7866c736c87a908cef75dc6901c9c0594c65b0eb",
      "original_commit_id": "4c23aacc2b82083f96255963f543dc35fff28334",
      "in_reply_to_id": 1915015927,
      "user": {
        "login": "Sjors",
        "id": 10217,
        "node_id": "MDQ6VXNlcjEwMjE3",
        "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Sjors",
        "html_url": "https://github.com/Sjors",
        "followers_url": "https://api.github.com/users/Sjors/followers",
        "following_url": "https://api.github.com/users/Sjors/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Sjors/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Sjors/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
        "organizations_url": "https://api.github.com/users/Sjors/orgs",
        "repos_url": "https://api.github.com/users/Sjors/repos",
        "events_url": "https://api.github.com/users/Sjors/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Sjors/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "Ah ok, I missed that bit.",
      "created_at": "2025-01-14T16:45:41Z",
      "updated_at": "2025-01-14T16:45:42Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30988#discussion_r1915228277",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1915228277"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/30988"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 32,
      "original_line": 32,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1916382790",
      "pull_request_review_id": 2552280742,
      "id": 1916382790,
      "node_id": "PRRC_kwDOABII585yOa5G",
      "diff_hunk": "@@ -1737,7 +1737,10 @@ void CConnman::AcceptConnection(const ListenSocket& hListenSocket) {\n     const CService addr_bind{MaybeFlipIPv6toCJDNS(GetBindAddress(*sock))};\n \n     NetPermissionFlags permission_flags = NetPermissionFlags::None;\n-    hListenSocket.AddSocketPermissionFlags(permission_flags);\n+    auto it{m_listen_permissions.find(addr_bind)};\n+    if (it != m_listen_permissions.end()) {",
      "path": "src/net.cpp",
      "position": 386,
      "original_position": 6,
      "commit_id": "7866c736c87a908cef75dc6901c9c0594c65b0eb",
      "original_commit_id": "fd81820214e695ba228a954506397c3d781fe3fe",
      "in_reply_to_id": null,
      "user": {
        "login": "Sjors",
        "id": 10217,
        "node_id": "MDQ6VXNlcjEwMjE3",
        "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Sjors",
        "html_url": "https://github.com/Sjors",
        "followers_url": "https://api.github.com/users/Sjors/followers",
        "following_url": "https://api.github.com/users/Sjors/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Sjors/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Sjors/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
        "organizations_url": "https://api.github.com/users/Sjors/orgs",
        "repos_url": "https://api.github.com/users/Sjors/repos",
        "events_url": "https://api.github.com/users/Sjors/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Sjors/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "fd81820214e695ba228a954506397c3d781fe3fe: do want to add an `Assume` here, given that `Bind` always adds an entry?",
      "created_at": "2025-01-15T11:18:27Z",
      "updated_at": "2025-01-15T11:28:22Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30988#discussion_r1916382790",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1916382790"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/30988"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 1671,
      "original_line": 1671,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1916431512",
      "pull_request_review_id": 2552366143,
      "id": 1916431512,
      "node_id": "PRRC_kwDOABII585yOmyY",
      "diff_hunk": "@@ -2195,7 +2169,16 @@ void CConnman::SocketHandlerListening(const Sock::EventsPerSock& events_per_sock\n         }\n         const auto it = events_per_sock.find(sock);\n         if (it != events_per_sock.end() && it->second.occurred & Sock::RECV) {\n-            AcceptConnection(*sock);\n+            CService addr_accepted;\n+\n+            auto sock_accepted{AcceptConnection(*sock, addr_accepted)};\n+\n+            if (sock_accepted) {\n+                addr_accepted = MaybeFlipIPv6toCJDNS(addr_accepted);",
      "path": "src/net.cpp",
      "position": null,
      "original_position": 60,
      "commit_id": "7866c736c87a908cef75dc6901c9c0594c65b0eb",
      "original_commit_id": "0241b04cf406d482abfac3fddfad9a9c28725f32",
      "in_reply_to_id": null,
      "user": {
        "login": "Sjors",
        "id": 10217,
        "node_id": "MDQ6VXNlcjEwMjE3",
        "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Sjors",
        "html_url": "https://github.com/Sjors",
        "followers_url": "https://api.github.com/users/Sjors/followers",
        "following_url": "https://api.github.com/users/Sjors/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Sjors/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Sjors/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
        "organizations_url": "https://api.github.com/users/Sjors/orgs",
        "repos_url": "https://api.github.com/users/Sjors/repos",
        "events_url": "https://api.github.com/users/Sjors/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Sjors/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "0241b04cf406d482abfac3fddfad9a9c28725f32: previously this would not get called if `addr.SetSockAddr` failed in `AcceptConnection`. I suspect it doesn't matter though.",
      "created_at": "2025-01-15T11:54:18Z",
      "updated_at": "2025-01-15T12:37:21Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30988#discussion_r1916431512",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1916431512"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/30988"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 2177,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1916457190",
      "pull_request_review_id": 2552366143,
      "id": 1916457190,
      "node_id": "PRRC_kwDOABII585yOtDm",
      "diff_hunk": "@@ -9,9 +9,12 @@\n #include <util/sock.h>\n #include <util/translation.h>\n \n+#include <atomic>\n #include <memory>\n #include <vector>\n \n+typedef int64_t NodeId;",
      "path": "src/common/sockman.h",
      "position": 23,
      "original_position": 8,
      "commit_id": "7866c736c87a908cef75dc6901c9c0594c65b0eb",
      "original_commit_id": "5d4920f630417ceeee1c79304faac6803795cd64",
      "in_reply_to_id": 1804940161,
      "user": {
        "login": "Sjors",
        "id": 10217,
        "node_id": "MDQ6VXNlcjEwMjE3",
        "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Sjors",
        "html_url": "https://github.com/Sjors",
        "followers_url": "https://api.github.com/users/Sjors/followers",
        "following_url": "https://api.github.com/users/Sjors/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Sjors/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Sjors/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
        "organizations_url": "https://api.github.com/users/Sjors/orgs",
        "repos_url": "https://api.github.com/users/Sjors/repos",
        "events_url": "https://api.github.com/users/Sjors/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Sjors/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "1b05e1d4ba55a42ba74026b68fa4e616b973e06d: maybe `ConnectionId`?\r\n\r\nAnd then in net.h use `typedef ConnectionId NodeId;`\r\n\r\nhttps://github.com/Sjors/bitcoin/commit/f33049b45b7013022ed4c75c0bc52d878fe15fd5\r\n\r\nMost of the churn would be in `sockman.{h,cpp}`, so that seems acceptable.\r\n\r\nThat said, I don't think it's very important.",
      "created_at": "2025-01-15T12:01:48Z",
      "updated_at": "2025-01-15T12:37:21Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30988#discussion_r1916457190",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1916457190"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/30988"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 23,
      "original_line": 23,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1916636569",
      "pull_request_review_id": 2552728389,
      "id": 1916636569,
      "node_id": "PRRC_kwDOABII585yPY2Z",
      "diff_hunk": "@@ -59,6 +66,26 @@ class SockMan\n \n private:\n \n+    //\n+    // Pure virtual functions must be implemented by children classes.\n+    //\n+\n+    //\n+    // Non-pure virtual functions can be overridden by children classes or left\n+    // alone to use the default implementation from SockMan.\n+    //\n+\n+    /**\n+     * Be notified of a change in the state of listening for incoming I2P connections.\n+     * The default behavior, implemented by `SockMan`, is to ignore this event.\n+     * @param[in] addr Our listening address.\n+     * @param[in] success If true then the listen succeeded and we are now",
      "path": "src/common/sockman.h",
      "position": 263,
      "original_position": 31,
      "commit_id": "7866c736c87a908cef75dc6901c9c0594c65b0eb",
      "original_commit_id": "14fcef6b0d1d1fa9395f9af2bafbf3de63d14ac2",
      "in_reply_to_id": null,
      "user": {
        "login": "Sjors",
        "id": 10217,
        "node_id": "MDQ6VXNlcjEwMjE3",
        "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Sjors",
        "html_url": "https://github.com/Sjors",
        "followers_url": "https://api.github.com/users/Sjors/followers",
        "following_url": "https://api.github.com/users/Sjors/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Sjors/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Sjors/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
        "organizations_url": "https://api.github.com/users/Sjors/orgs",
        "repos_url": "https://api.github.com/users/Sjors/repos",
        "events_url": "https://api.github.com/users/Sjors/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Sjors/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "14fcef6b0d1d1fa9395f9af2bafbf3de63d14ac2: I find this confusing.\r\n\r\nI think the problem starts with the strange naming of `ThreadI2PAccept`, instead of `ThreadI2PHandler` akin to `ThreadSocketHandler`.\r\n\r\nAnyway, what that thread seems to do is, in a loop, try to `Listen` on the socket and once listening, `Accept(` new connections.\r\n\r\nWhenever listening fails or succeeds it calls `EventI2PListen` which then calls `AddLocal` / `RemoveLocal` to keep the announced public addresses up to date.\r\n\r\nWith that in mind, I would call this new method `EventI2PConnectivity` and rename `success` to either `connected` or `listening`. Then the rest makes sense.",
      "created_at": "2025-01-15T13:17:31Z",
      "updated_at": "2025-01-15T13:33:18Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30988#discussion_r1916636569",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1916636569"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/30988"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 263,
      "original_line": 263,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1916699333",
      "pull_request_review_id": 2552832660,
      "id": 1916699333,
      "node_id": "PRRC_kwDOABII585yPoLF",
      "diff_hunk": "@@ -1150,7 +1151,7 @@ class CConnman : private SockMan\n     void ForEachNode(const NodeFn& func)\n     {\n         LOCK(m_nodes_mutex);\n-        for (auto&& node : m_nodes) {\n+        for (auto& [id, node] : m_nodes) {",
      "path": "src/net.h",
      "position": null,
      "original_position": 13,
      "commit_id": "7866c736c87a908cef75dc6901c9c0594c65b0eb",
      "original_commit_id": "21c5e05619c8a6eb736bb1c61725f4b5f669ffb4",
      "in_reply_to_id": null,
      "user": {
        "login": "Sjors",
        "id": 10217,
        "node_id": "MDQ6VXNlcjEwMjE3",
        "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Sjors",
        "html_url": "https://github.com/Sjors",
        "followers_url": "https://api.github.com/users/Sjors/followers",
        "following_url": "https://api.github.com/users/Sjors/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Sjors/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Sjors/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
        "organizations_url": "https://api.github.com/users/Sjors/orgs",
        "repos_url": "https://api.github.com/users/Sjors/repos",
        "events_url": "https://api.github.com/users/Sjors/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Sjors/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "21c5e05619c8a6eb736bb1c61725f4b5f669ffb4: maybe use `[_, node]` in places where you don't need the `id`.\r\n\r\nIt's a bit unfortunate that you can't (?) directly loop over all `T` in `std::unordered_map<Key, T>`. Since most of the time we don't need `Key` (`id`) here.",
      "created_at": "2025-01-15T13:59:48Z",
      "updated_at": "2025-01-15T14:25:01Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30988#discussion_r1916699333",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1916699333"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/30988"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1154,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1916714492",
      "pull_request_review_id": 2552832660,
      "id": 1916714492,
      "node_id": "PRRC_kwDOABII585yPr38",
      "diff_hunk": "@@ -133,6 +133,22 @@ class SockMan\n     // alone to use the default implementation from SockMan.\n     //\n \n+    /**\n+     * SockMan would only call EventReadyToSend() if this returns true.",
      "path": "src/common/sockman.h",
      "position": null,
      "original_position": 5,
      "commit_id": "7866c736c87a908cef75dc6901c9c0594c65b0eb",
      "original_commit_id": "dc6393cb93c4851a363b69fd474656cac1ae3b3b",
      "in_reply_to_id": null,
      "user": {
        "login": "Sjors",
        "id": 10217,
        "node_id": "MDQ6VXNlcjEwMjE3",
        "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Sjors",
        "html_url": "https://github.com/Sjors",
        "followers_url": "https://api.github.com/users/Sjors/followers",
        "following_url": "https://api.github.com/users/Sjors/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Sjors/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Sjors/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
        "organizations_url": "https://api.github.com/users/Sjors/orgs",
        "repos_url": "https://api.github.com/users/Sjors/repos",
        "events_url": "https://api.github.com/users/Sjors/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Sjors/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "dc6393cb93c4851a363b69fd474656cac1ae3b3b: `EventReadyToSend` doesn't exist yet in this commit, so maybe the commit message can announce it.",
      "created_at": "2025-01-15T14:10:09Z",
      "updated_at": "2025-01-15T14:25:01Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30988#discussion_r1916714492",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1916714492"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/30988"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 137,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1916723639",
      "pull_request_review_id": 2552832660,
      "id": 1916723639,
      "node_id": "PRRC_kwDOABII585yPuG3",
      "diff_hunk": "@@ -2009,25 +2019,46 @@ bool CConnman::InactivityCheck(const CNode& node) const\n     return false;\n }\n \n+bool CConnman::ShouldTryToSend(NodeId node_id) const\n+{\n+    AssertLockNotHeld(m_nodes_mutex);\n+\n+    CNode* node{GetNodeById(node_id)};\n+    if (node == nullptr) {\n+        return false;\n+    }\n+    LOCK(node->cs_vSend);\n+    // Sending is possible if either there are bytes to send right now, or if there will be\n+    // once a potential message from vSendMsg is handed to the transport. GetBytesToSend\n+    // determines both of these in a single call.\n+    const auto& [to_send, more, _msg_type] = node->m_transport->GetBytesToSend(!node->vSendMsg.empty());\n+    return !to_send.empty() || more;\n+}\n+\n+bool CConnman::ShouldTryToRecv(NodeId node_id) const\n+{\n+    AssertLockNotHeld(m_nodes_mutex);\n+\n+    CNode* node{GetNodeById(node_id)};\n+    if (node == nullptr) {\n+        return false;\n+    }\n+    return !node->fPauseRecv;\n+}\n+\n Sock::EventsPerSock CConnman::GenerateWaitSockets(Span<CNode* const> nodes)\n {\n+    AssertLockNotHeld(m_nodes_mutex);\n+\n     Sock::EventsPerSock events_per_sock;\n \n     for (const auto& sock : m_listen) {\n         events_per_sock.emplace(sock, Sock::Events{Sock::RECV});\n     }\n \n     for (CNode* pnode : nodes) {\n-        bool select_recv = !pnode->fPauseRecv;\n-        bool select_send;\n-        {\n-            LOCK(pnode->cs_vSend);\n-            // Sending is possible if either there are bytes to send right now, or if there will be\n-            // once a potential message from vSendMsg is handed to the transport. GetBytesToSend\n-            // determines both of these in a single call.\n-            const auto& [to_send, more, _msg_type] = pnode->m_transport->GetBytesToSend(!pnode->vSendMsg.empty());\n-            select_send = !to_send.empty() || more;\n-        }\n+        const bool select_recv{ShouldTryToRecv(pnode->GetId())};",
      "path": "src/net.cpp",
      "position": null,
      "original_position": 69,
      "commit_id": "7866c736c87a908cef75dc6901c9c0594c65b0eb",
      "original_commit_id": "dc6393cb93c4851a363b69fd474656cac1ae3b3b",
      "in_reply_to_id": null,
      "user": {
        "login": "Sjors",
        "id": 10217,
        "node_id": "MDQ6VXNlcjEwMjE3",
        "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Sjors",
        "html_url": "https://github.com/Sjors",
        "followers_url": "https://api.github.com/users/Sjors/followers",
        "following_url": "https://api.github.com/users/Sjors/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Sjors/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Sjors/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
        "organizations_url": "https://api.github.com/users/Sjors/orgs",
        "repos_url": "https://api.github.com/users/Sjors/repos",
        "events_url": "https://api.github.com/users/Sjors/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Sjors/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "dc6393cb93c4851a363b69fd474656cac1ae3b3b: it would be good to annotate in `CConnman::SocketHandlerConnected` above `sendSet = it->second.occurred & Sock::SEND;` that `Sock::SEND` is unset when `ShouldTryToRecv` is `false`.",
      "created_at": "2025-01-15T14:16:14Z",
      "updated_at": "2025-01-15T14:25:01Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30988#discussion_r1916723639",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1916723639"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/30988"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 2060,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1920546152",
      "pull_request_review_id": 2559620130,
      "id": 1920546152,
      "node_id": "PRRC_kwDOABII585yeTVo",
      "diff_hunk": "@@ -0,0 +1,532 @@\n+// Copyright (c) 2024-present The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or https://opensource.org/license/mit/.\n+\n+#include <bitcoin-build-config.h> // IWYU pragma: keep\n+\n+#include <common/sockman.h>\n+#include <logging.h>\n+#include <netbase.h>\n+#include <util/sock.h>\n+#include <util/thread.h>\n+\n+#include <cassert>\n+\n+// The set of sockets cannot be modified while waiting\n+// The sleep time needs to be small to avoid new sockets stalling\n+static constexpr auto SELECT_TIMEOUT{50ms};\n+\n+static CService GetBindAddress(const Sock& sock)\n+{\n+    CService addr_bind;\n+    struct sockaddr_storage sockaddr_bind;\n+    socklen_t sockaddr_bind_len = sizeof(sockaddr_bind);\n+    if (!sock.GetSockName((struct sockaddr*)&sockaddr_bind, &sockaddr_bind_len)) {\n+        addr_bind.SetSockAddr((const struct sockaddr*)&sockaddr_bind);\n+    } else {\n+        LogPrintLevel(BCLog::NET, BCLog::Level::Warning, \"getsockname failed\\n\");\n+    }\n+    return addr_bind;\n+}\n+\n+bool SockMan::BindAndStartListening(const CService& to, bilingual_str& errmsg)\n+{\n+    // Create socket for listening for incoming connections\n+    struct sockaddr_storage storage;\n+    socklen_t len{sizeof(storage)};\n+    if (!to.GetSockAddr(reinterpret_cast<sockaddr*>(&storage), &len)) {\n+        errmsg = Untranslated(strprintf(\"Bind address family for %s not supported\", to.ToStringAddrPort()));\n+        return false;\n+    }\n+\n+    std::unique_ptr<Sock> sock{CreateSock(to.GetSAFamily(), SOCK_STREAM, IPPROTO_TCP)};\n+    if (!sock) {\n+        errmsg = Untranslated(strprintf(\"Cannot create %s listen socket: %s\",\n+                                        to.ToStringAddrPort(),\n+                                        NetworkErrorString(WSAGetLastError())));\n+        return false;\n+    }\n+\n+    int one{1};\n+\n+    // Allow binding if the port is still in TIME_WAIT state after\n+    // the program was closed and restarted.\n+    if (sock->SetSockOpt(SOL_SOCKET, SO_REUSEADDR, reinterpret_cast<sockopt_arg_type>(&one), sizeof(one)) == SOCKET_ERROR) {\n+        LogPrintLevel(BCLog::NET,\n+                      BCLog::Level::Info,\n+                      \"Cannot set SO_REUSEADDR on %s listen socket: %s, continuing anyway\\n\",\n+                      to.ToStringAddrPort(),\n+                      NetworkErrorString(WSAGetLastError()));\n+    }\n+\n+    // some systems don't have IPV6_V6ONLY but are always v6only; others do have the option\n+    // and enable it by default or not. Try to enable it, if possible.\n+    if (to.IsIPv6()) {\n+#ifdef IPV6_V6ONLY\n+        if (sock->SetSockOpt(IPPROTO_IPV6, IPV6_V6ONLY, reinterpret_cast<sockopt_arg_type>(&one), sizeof(one)) == SOCKET_ERROR) {\n+            LogPrintLevel(BCLog::NET,\n+                          BCLog::Level::Info,\n+                          \"Cannot set IPV6_V6ONLY on %s listen socket: %s, continuing anyway\\n\",\n+                          to.ToStringAddrPort(),\n+                          NetworkErrorString(WSAGetLastError()));\n+        }\n+#endif\n+#ifdef WIN32\n+        int prot_level{PROTECTION_LEVEL_UNRESTRICTED};\n+        if (sock->SetSockOpt(IPPROTO_IPV6,\n+                             IPV6_PROTECTION_LEVEL,\n+                             reinterpret_cast<const char*>(&prot_level),\n+                             sizeof(prot_level)) == SOCKET_ERROR) {\n+            LogPrintLevel(BCLog::NET,\n+                          BCLog::Level::Info,\n+                          \"Cannot set IPV6_PROTECTION_LEVEL on %s listen socket: %s, continuing anyway\\n\",\n+                          to.ToStringAddrPort(),\n+                          NetworkErrorString(WSAGetLastError()));\n+        }\n+#endif\n+    }\n+\n+    if (sock->Bind(reinterpret_cast<sockaddr*>(&storage), len) == SOCKET_ERROR) {\n+        const int err{WSAGetLastError()};\n+        errmsg = strprintf(_(\"Cannot bind to %s: %s%s\"),\n+                           to.ToStringAddrPort(),\n+                           NetworkErrorString(err),\n+                           err == WSAEADDRINUSE\n+                               ? std::string{\" (\"} + CLIENT_NAME + \" already running?)\"\n+                               : \"\");\n+        return false;\n+    }\n+\n+    // Listen for incoming connections\n+    if (sock->Listen(SOMAXCONN) == SOCKET_ERROR) {\n+        errmsg = strprintf(_(\"Cannot listen to %s: %s\"), to.ToStringAddrPort(), NetworkErrorString(WSAGetLastError()));\n+        return false;\n+    }\n+\n+    m_listen.emplace_back(std::move(sock));\n+\n+    return true;\n+}\n+\n+void SockMan::StartSocketsThreads(const Options& options)\n+{\n+    m_thread_socket_handler = std::thread(&util::TraceThread, \"net\", [this] { ThreadSocketHandler(); });",
      "path": "src/common/sockman.cpp",
      "position": null,
      "original_position": 113,
      "commit_id": "7866c736c87a908cef75dc6901c9c0594c65b0eb",
      "original_commit_id": "bcf1254e91782a33b5a1db542f3758831e0bfe2e",
      "in_reply_to_id": null,
      "user": {
        "login": "pinheadmz",
        "id": 2084648,
        "node_id": "MDQ6VXNlcjIwODQ2NDg=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2084648?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/pinheadmz",
        "html_url": "https://github.com/pinheadmz",
        "followers_url": "https://api.github.com/users/pinheadmz/followers",
        "following_url": "https://api.github.com/users/pinheadmz/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/pinheadmz/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/pinheadmz/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/pinheadmz/subscriptions",
        "organizations_url": "https://api.github.com/users/pinheadmz/orgs",
        "repos_url": "https://api.github.com/users/pinheadmz/repos",
        "events_url": "https://api.github.com/users/pinheadmz/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/pinheadmz/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "Does this hard-coded thread name cause any issues if sockman is used more than once?",
      "created_at": "2025-01-17T17:47:59Z",
      "updated_at": "2025-01-17T17:48:05Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30988#discussion_r1920546152",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1920546152"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/30988"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 113,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1927267574",
      "pull_request_review_id": 2570362263,
      "id": 1927267574,
      "node_id": "PRRC_kwDOABII585y38T2",
      "diff_hunk": "@@ -0,0 +1,428 @@\n+// Copyright (c) 2024-present The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or https://opensource.org/license/mit/.\n+\n+#ifndef BITCOIN_COMMON_SOCKMAN_H\n+#define BITCOIN_COMMON_SOCKMAN_H\n+\n+#include <i2p.h>\n+#include <netaddress.h>\n+#include <netbase.h>\n+#include <util/fs.h>\n+#include <util/sock.h>\n+#include <util/translation.h>\n+\n+#include <atomic>\n+#include <memory>\n+#include <queue>\n+#include <span>\n+#include <thread>\n+#include <variant>\n+#include <vector>\n+\n+typedef int64_t NodeId;\n+\n+/**\n+ * A socket manager class which handles socket operations.\n+ * To use this class, inherit from it and implement the pure virtual methods.\n+ * Handled operations:\n+ * - binding and listening on sockets\n+ * - starting of necessary threads to process socket operations\n+ * - accepting incoming connections\n+ * - making outbound connections\n+ * - closing connections\n+ * - waiting for IO readiness on sockets and doing send/recv accordingly\n+ */\n+class SockMan\n+{\n+public:\n+\n+    virtual ~SockMan() = default;\n+\n+    //\n+    // Non-virtual functions, to be reused by children classes.\n+    //\n+\n+    /**\n+     * Bind to a new address:port, start listening and add the listen socket to `m_listen`.\n+     * Should be called before `StartSocketsThreads()`.\n+     * @param[in] to Where to bind.\n+     * @param[out] errmsg Error string if an error occurs.\n+     * @retval true Success.\n+     * @retval false Failure, `strError` will be set.\n+     */\n+    bool BindAndStartListening(const CService& to, bilingual_str& errmsg);\n+\n+    /**\n+     * Options to influence `StartSocketsThreads()`.\n+     */\n+    struct Options {\n+        struct I2P {\n+            explicit I2P(const fs::path& file, const Proxy& proxy) : private_key_file{file}, sam_proxy{proxy} {}\n+\n+            const fs::path private_key_file;\n+            const Proxy sam_proxy;\n+        };\n+\n+        /**\n+         * I2P options. If set then a thread will be started that will accept incoming I2P connections.\n+         */\n+        std::optional<I2P> i2p;\n+    };\n+\n+    /**\n+     * Start the necessary threads for sockets IO.\n+     */\n+    void StartSocketsThreads(const Options& options);\n+\n+    /**\n+     * Join (wait for) the threads started by `StartSocketsThreads()` to exit.\n+     */\n+    void JoinSocketsThreads();\n+\n+    /**\n+     * A more readable std::tuple<std::string, uint16_t> for host and port.\n+     */\n+    struct StringHostIntPort {\n+        const std::string& host;\n+        uint16_t port;\n+    };\n+\n+    /**\n+     * Make an outbound connection, save the socket internally and return a newly generated node id.\n+     * @param[in] to The address to connect to, either as CService or a host as string and port as\n+     * an integer, if the later is used, then `proxy` must be valid.\n+     * @param[in] is_important If true, then log failures with higher severity.\n+     * @param[in] proxy Proxy to connect through if `proxy.IsValid()` is true.\n+     * @param[out] proxy_failed If `proxy` is valid and the connection failed because of the\n+     * proxy, then it will be set to true.\n+     * @param[out] me If the connection was successful then this is set to the address on the\n+     * local side of the socket.\n+     * @return Newly generated node id, or std::nullopt if the operation fails.\n+     */\n+    std::optional<NodeId> ConnectAndMakeNodeId(const std::variant<CService, StringHostIntPort>& to,\n+                                               bool is_important,\n+                                               const Proxy& proxy,\n+                                               bool& proxy_failed,\n+                                               CService& me)\n+        EXCLUSIVE_LOCKS_REQUIRED(!m_connected_mutex, !m_unused_i2p_sessions_mutex);\n+\n+    /**\n+     * Disconnect a given peer by closing its socket and release resources occupied by it.\n+     * @return Whether the peer existed and its socket was closed by this call.\n+     */\n+    bool CloseConnection(NodeId node_id)\n+        EXCLUSIVE_LOCKS_REQUIRED(!m_connected_mutex);\n+\n+    /**\n+     * Try to send some data to the given node.\n+     * @param[in] node_id Identifier of the node to send to.\n+     * @param[in] data The data to send, it might happen that only a prefix of this is sent.\n+     * @param[in] will_send_more Used as an optimization if the caller knows that they will\n+     * be sending more data soon after this call.\n+     * @param[out] errmsg If <0 is returned then this will contain a human readable message\n+     * explaining the error.\n+     * @retval >=0 The number of bytes actually sent.\n+     * @retval <0 A permanent error has occurred.\n+     */\n+    ssize_t SendBytes(NodeId node_id,\n+                      std::span<const unsigned char> data,\n+                      bool will_send_more,\n+                      std::string& errmsg) const\n+        EXCLUSIVE_LOCKS_REQUIRED(!m_connected_mutex);\n+\n+    /**\n+     * Close all sockets.\n+     */\n+    void CloseSockets();\n+\n+    /**\n+     * This is signaled when network activity should cease.\n+     * A pointer to it is saved in `m_i2p_sam_session`, so make sure that\n+     * the lifetime of `interruptNet` is not shorter than\n+     * the lifetime of `m_i2p_sam_session`.\n+     */\n+    CThreadInterrupt interruptNet;\n+\n+protected:\n+\n+    /**\n+     * During some tests mocked sockets are created outside of `SockMan`, make it\n+     * possible to add those so that send/recv can be exercised.\n+     */\n+    void TestOnlyAddExistentNode(NodeId node_id, std::unique_ptr<Sock>&& sock)\n+        EXCLUSIVE_LOCKS_REQUIRED(!m_connected_mutex);\n+\n+private:\n+\n+    /**\n+     * Cap on the size of `m_unused_i2p_sessions`, to ensure it does not\n+     * unexpectedly use too much memory.\n+     */\n+    static constexpr size_t MAX_UNUSED_I2P_SESSIONS_SIZE{10};\n+\n+    //\n+    // Pure virtual functions must be implemented by children classes.\n+    //\n+\n+    /**\n+     * Be notified when a new connection has been accepted.\n+     * @param[in] node_id Id of the newly accepted connection.\n+     * @param[in] me The address and port at our side of the connection.\n+     * @param[in] them The address and port at the peer's side of the connection.\n+     * @retval true The new connection was accepted at the higher level.\n+     * @retval false The connection was refused at the higher level, so the\n+     * associated socket and node_id should be discarded by `SockMan`.\n+     */\n+    virtual bool EventNewConnectionAccepted(NodeId node_id,\n+                                            const CService& me,\n+                                            const CService& them) = 0;\n+\n+    /**\n+     * Called when the socket is ready to send data and `ShouldTryToSend()` has\n+     * returned true. This is where the higher level code serializes its messages\n+     * and calls `SockMan::SendBytes()`.\n+     * @param[in] node_id Id of the node whose socket is ready to send.\n+     * @param[out] cancel_recv Should always be set upon return and if it is true,\n+     * then the next attempt to receive data from that node will be omitted.\n+     */\n+    virtual void EventReadyToSend(NodeId node_id, bool& cancel_recv) = 0;",
      "path": "src/common/sockman.h",
      "position": 196,
      "original_position": 189,
      "commit_id": "7866c736c87a908cef75dc6901c9c0594c65b0eb",
      "original_commit_id": "bcf1254e91782a33b5a1db542f3758831e0bfe2e",
      "in_reply_to_id": null,
      "user": {
        "login": "pinheadmz",
        "id": 2084648,
        "node_id": "MDQ6VXNlcjIwODQ2NDg=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2084648?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/pinheadmz",
        "html_url": "https://github.com/pinheadmz",
        "followers_url": "https://api.github.com/users/pinheadmz/followers",
        "following_url": "https://api.github.com/users/pinheadmz/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/pinheadmz/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/pinheadmz/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/pinheadmz/subscriptions",
        "organizations_url": "https://api.github.com/users/pinheadmz/orgs",
        "repos_url": "https://api.github.com/users/pinheadmz/repos",
        "events_url": "https://api.github.com/users/pinheadmz/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/pinheadmz/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "I might be misunderstanding `cancel_recv`, in my HTTP server I set it to `true` when I'm planning on disconnecting a node like if there was an error sending data or if `\"Connection: close\"` is set. However this causes weird behavior where new connections get hung up forever. In particular, `interface_rpc.py` stalls on the ultimate node shutdown and eventually times out after 120 seconds of rpc `stop` not working. When I set `cancel_recv=false` everywhere, i don't have this issue. (Still a lot of other issues to clean up in this branch!)\r\n\r\nhttps://github.com/pinheadmz/bitcoin/commit/df1965a4e97ce7f3df067df9b3dcc2bbd8e6e15b",
      "created_at": "2025-01-23T16:18:36Z",
      "updated_at": "2025-01-23T16:18:36Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30988#discussion_r1927267574",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1927267574"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/30988"
        }
      },
      "start_line": 188,
      "original_start_line": 181,
      "start_side": "RIGHT",
      "line": 196,
      "original_line": 196,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1932200054",
      "pull_request_review_id": 2578302481,
      "id": 1932200054,
      "node_id": "PRRC_kwDOABII585zKwh2",
      "diff_hunk": "@@ -1737,7 +1737,10 @@ void CConnman::AcceptConnection(const ListenSocket& hListenSocket) {\n     const CService addr_bind{MaybeFlipIPv6toCJDNS(GetBindAddress(*sock))};\n \n     NetPermissionFlags permission_flags = NetPermissionFlags::None;\n-    hListenSocket.AddSocketPermissionFlags(permission_flags);\n+    auto it{m_listen_permissions.find(addr_bind)};\n+    if (it != m_listen_permissions.end()) {",
      "path": "src/net.cpp",
      "position": 386,
      "original_position": 6,
      "commit_id": "7866c736c87a908cef75dc6901c9c0594c65b0eb",
      "original_commit_id": "fd81820214e695ba228a954506397c3d781fe3fe",
      "in_reply_to_id": 1916382790,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "Right, currently `Bind()` always adds an entry, but I do not want to impose that because the code here does not require it. It is fine if there is nothing in `m_listen_permissions`. Then the permissions will remain at `NetPermissionFlags::None`. So it is kind of optional for `Bind()` to add an entry to `m_listen_permissions` and no reason to enforce it.",
      "created_at": "2025-01-28T13:49:17Z",
      "updated_at": "2025-01-28T13:49:18Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30988#discussion_r1932200054",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1932200054"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/30988"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 1671,
      "original_line": 1671,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1932221561",
      "pull_request_review_id": 2578339856,
      "id": 1932221561,
      "node_id": "PRRC_kwDOABII585zK1x5",
      "diff_hunk": "@@ -2195,7 +2169,16 @@ void CConnman::SocketHandlerListening(const Sock::EventsPerSock& events_per_sock\n         }\n         const auto it = events_per_sock.find(sock);\n         if (it != events_per_sock.end() && it->second.occurred & Sock::RECV) {\n-            AcceptConnection(*sock);\n+            CService addr_accepted;\n+\n+            auto sock_accepted{AcceptConnection(*sock, addr_accepted)};\n+\n+            if (sock_accepted) {\n+                addr_accepted = MaybeFlipIPv6toCJDNS(addr_accepted);",
      "path": "src/net.cpp",
      "position": null,
      "original_position": 60,
      "commit_id": "7866c736c87a908cef75dc6901c9c0594c65b0eb",
      "original_commit_id": "0241b04cf406d482abfac3fddfad9a9c28725f32",
      "in_reply_to_id": 1916431512,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "Yes, good observation! Indeed the flip will do nothing on the invalid `0.0.0.0` `addr_accepted`.\r\n\r\nThe code in `master` is also a bit odd that it continues if `addr.SetSockAddr()` fails in `CConnman::AcceptConnection()` and it will pass the default constructed, invalid `0.0.0.0` address to `CreateNodeFromAcceptedSocket()`. I didn't change that in this PR as it would be a functional change that is not needed for this PR.",
      "created_at": "2025-01-28T14:01:14Z",
      "updated_at": "2025-01-28T14:01:14Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30988#discussion_r1932221561",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1932221561"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/30988"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 2177,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1932350726",
      "pull_request_review_id": 2578576538,
      "id": 1932350726,
      "node_id": "PRRC_kwDOABII585zLVUG",
      "diff_hunk": "@@ -59,6 +66,26 @@ class SockMan\n \n private:\n \n+    //\n+    // Pure virtual functions must be implemented by children classes.\n+    //\n+\n+    //\n+    // Non-pure virtual functions can be overridden by children classes or left\n+    // alone to use the default implementation from SockMan.\n+    //\n+\n+    /**\n+     * Be notified of a change in the state of listening for incoming I2P connections.\n+     * The default behavior, implemented by `SockMan`, is to ignore this event.\n+     * @param[in] addr Our listening address.\n+     * @param[in] success If true then the listen succeeded and we are now",
      "path": "src/common/sockman.h",
      "position": 263,
      "original_position": 31,
      "commit_id": "7866c736c87a908cef75dc6901c9c0594c65b0eb",
      "original_commit_id": "14fcef6b0d1d1fa9395f9af2bafbf3de63d14ac2",
      "in_reply_to_id": 1916636569,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "`ThreadI2PAccept` vs `ThreadI2PHandler`. The thing is that this thread is only accepting connections. It does not do anything about I2P connections that are already established. `ThreadSocketHandler` does both accepting new connections and doing send/recv on existent connections.\r\n\r\nYes, your observation is correct. Listening can fail temporary, e.g. if the I2P router daemon is restarted. This is unlike the TCP listening where once `bind()` and `listen()` succeed, then we are listening until we decide to close the socket. Tor is like I2P - it can fail to listen for a while if the Tor daemon is restarted. Our Tor code has the deficiency that it does not handle that, so it would act as if we are listening (e.g. advertising our Tor address) even if we are not listening.\r\n\r\nCurrent `EventI2PListen` vs `EventI2PConnectivity` - I think \"Connectivity\" would be too broad because this method is only called in the event where we start or stop listening for incoming I2P connections. It is not related to whether we have existent I2P connections or to our ability to make new outgoing I2P connections which \"Connectivity\" would imply.",
      "created_at": "2025-01-28T15:09:34Z",
      "updated_at": "2025-01-28T15:09:34Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30988#discussion_r1932350726",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1932350726"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/30988"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 263,
      "original_line": 263,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1932408258",
      "pull_request_review_id": 2578675533,
      "id": 1932408258,
      "node_id": "PRRC_kwDOABII585zLjXC",
      "diff_hunk": "@@ -59,6 +66,26 @@ class SockMan\n \n private:\n \n+    //\n+    // Pure virtual functions must be implemented by children classes.\n+    //\n+\n+    //\n+    // Non-pure virtual functions can be overridden by children classes or left\n+    // alone to use the default implementation from SockMan.\n+    //\n+\n+    /**\n+     * Be notified of a change in the state of listening for incoming I2P connections.\n+     * The default behavior, implemented by `SockMan`, is to ignore this event.\n+     * @param[in] addr Our listening address.\n+     * @param[in] success If true then the listen succeeded and we are now",
      "path": "src/common/sockman.h",
      "position": 263,
      "original_position": 31,
      "commit_id": "7866c736c87a908cef75dc6901c9c0594c65b0eb",
      "original_commit_id": "14fcef6b0d1d1fa9395f9af2bafbf3de63d14ac2",
      "in_reply_to_id": 1916636569,
      "user": {
        "login": "Sjors",
        "id": 10217,
        "node_id": "MDQ6VXNlcjEwMjE3",
        "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Sjors",
        "html_url": "https://github.com/Sjors",
        "followers_url": "https://api.github.com/users/Sjors/followers",
        "following_url": "https://api.github.com/users/Sjors/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Sjors/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Sjors/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
        "organizations_url": "https://api.github.com/users/Sjors/orgs",
        "repos_url": "https://api.github.com/users/Sjors/repos",
        "events_url": "https://api.github.com/users/Sjors/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Sjors/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "Maybe `EventI2PReady` or `EventI2PStatus`? Something to distinguish it from listen.",
      "created_at": "2025-01-28T15:41:46Z",
      "updated_at": "2025-01-28T15:41:46Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30988#discussion_r1932408258",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1932408258"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/30988"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 263,
      "original_line": 263,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1932474919",
      "pull_request_review_id": 2578787874,
      "id": 1932474919,
      "node_id": "PRRC_kwDOABII585zLzon",
      "diff_hunk": "@@ -1150,7 +1151,7 @@ class CConnman : private SockMan\n     void ForEachNode(const NodeFn& func)\n     {\n         LOCK(m_nodes_mutex);\n-        for (auto&& node : m_nodes) {\n+        for (auto& [id, node] : m_nodes) {",
      "path": "src/net.h",
      "position": null,
      "original_position": 13,
      "commit_id": "7866c736c87a908cef75dc6901c9c0594c65b0eb",
      "original_commit_id": "21c5e05619c8a6eb736bb1c61725f4b5f669ffb4",
      "in_reply_to_id": 1916699333,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "Changed to `[_, node]`, thanks! :)",
      "created_at": "2025-01-28T16:19:53Z",
      "updated_at": "2025-01-28T16:19:54Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30988#discussion_r1932474919",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1932474919"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/30988"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1154,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1932501557",
      "pull_request_review_id": 2578830820,
      "id": 1932501557,
      "node_id": "PRRC_kwDOABII585zL6I1",
      "diff_hunk": "@@ -133,6 +133,22 @@ class SockMan\n     // alone to use the default implementation from SockMan.\n     //\n \n+    /**\n+     * SockMan would only call EventReadyToSend() if this returns true.",
      "path": "src/common/sockman.h",
      "position": null,
      "original_position": 5,
      "commit_id": "7866c736c87a908cef75dc6901c9c0594c65b0eb",
      "original_commit_id": "dc6393cb93c4851a363b69fd474656cac1ae3b3b",
      "in_reply_to_id": 1916714492,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "Right! Adjusted the comments.",
      "created_at": "2025-01-28T16:33:39Z",
      "updated_at": "2025-01-28T16:33:40Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30988#discussion_r1932501557",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1932501557"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/30988"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 137,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1932523735",
      "pull_request_review_id": 2578867201,
      "id": 1932523735,
      "node_id": "PRRC_kwDOABII585zL_jX",
      "diff_hunk": "@@ -2009,25 +2019,46 @@ bool CConnman::InactivityCheck(const CNode& node) const\n     return false;\n }\n \n+bool CConnman::ShouldTryToSend(NodeId node_id) const\n+{\n+    AssertLockNotHeld(m_nodes_mutex);\n+\n+    CNode* node{GetNodeById(node_id)};\n+    if (node == nullptr) {\n+        return false;\n+    }\n+    LOCK(node->cs_vSend);\n+    // Sending is possible if either there are bytes to send right now, or if there will be\n+    // once a potential message from vSendMsg is handed to the transport. GetBytesToSend\n+    // determines both of these in a single call.\n+    const auto& [to_send, more, _msg_type] = node->m_transport->GetBytesToSend(!node->vSendMsg.empty());\n+    return !to_send.empty() || more;\n+}\n+\n+bool CConnman::ShouldTryToRecv(NodeId node_id) const\n+{\n+    AssertLockNotHeld(m_nodes_mutex);\n+\n+    CNode* node{GetNodeById(node_id)};\n+    if (node == nullptr) {\n+        return false;\n+    }\n+    return !node->fPauseRecv;\n+}\n+\n Sock::EventsPerSock CConnman::GenerateWaitSockets(Span<CNode* const> nodes)\n {\n+    AssertLockNotHeld(m_nodes_mutex);\n+\n     Sock::EventsPerSock events_per_sock;\n \n     for (const auto& sock : m_listen) {\n         events_per_sock.emplace(sock, Sock::Events{Sock::RECV});\n     }\n \n     for (CNode* pnode : nodes) {\n-        bool select_recv = !pnode->fPauseRecv;\n-        bool select_send;\n-        {\n-            LOCK(pnode->cs_vSend);\n-            // Sending is possible if either there are bytes to send right now, or if there will be\n-            // once a potential message from vSendMsg is handed to the transport. GetBytesToSend\n-            // determines both of these in a single call.\n-            const auto& [to_send, more, _msg_type] = pnode->m_transport->GetBytesToSend(!pnode->vSendMsg.empty());\n-            select_send = !to_send.empty() || more;\n-        }\n+        const bool select_recv{ShouldTryToRecv(pnode->GetId())};",
      "path": "src/net.cpp",
      "position": null,
      "original_position": 69,
      "commit_id": "7866c736c87a908cef75dc6901c9c0594c65b0eb",
      "original_commit_id": "dc6393cb93c4851a363b69fd474656cac1ae3b3b",
      "in_reply_to_id": 1916723639,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "Hmm, you probably mean `ShouldTryToSend` is `false`, right? And then the same applies to receiving. Amended this:\r\n\r\n```diff\r\n-                recvSet = it->second.occurred & Sock::RECV;\r\n-                sendSet = it->second.occurred & Sock::SEND;\r\n+                recvSet = it->second.occurred & Sock::RECV; // Sock::RECV could only be set if ShouldTryToRecv() has returned true in GenerateWaitSockets().\r\n+                sendSet = it->second.occurred & Sock::SEND; // Sock::SEND could only be set if ShouldTryToSend() has returned true in GenerateWaitSockets().\r\n```",
      "created_at": "2025-01-28T16:47:52Z",
      "updated_at": "2025-01-28T16:47:52Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30988#discussion_r1932523735",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1932523735"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/30988"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 2060,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1932564964",
      "pull_request_review_id": 2578936007,
      "id": 1932564964,
      "node_id": "PRRC_kwDOABII585zMJnk",
      "diff_hunk": "@@ -0,0 +1,532 @@\n+// Copyright (c) 2024-present The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or https://opensource.org/license/mit/.\n+\n+#include <bitcoin-build-config.h> // IWYU pragma: keep\n+\n+#include <common/sockman.h>\n+#include <logging.h>\n+#include <netbase.h>\n+#include <util/sock.h>\n+#include <util/thread.h>\n+\n+#include <cassert>\n+\n+// The set of sockets cannot be modified while waiting\n+// The sleep time needs to be small to avoid new sockets stalling\n+static constexpr auto SELECT_TIMEOUT{50ms};\n+\n+static CService GetBindAddress(const Sock& sock)\n+{\n+    CService addr_bind;\n+    struct sockaddr_storage sockaddr_bind;\n+    socklen_t sockaddr_bind_len = sizeof(sockaddr_bind);\n+    if (!sock.GetSockName((struct sockaddr*)&sockaddr_bind, &sockaddr_bind_len)) {\n+        addr_bind.SetSockAddr((const struct sockaddr*)&sockaddr_bind);\n+    } else {\n+        LogPrintLevel(BCLog::NET, BCLog::Level::Warning, \"getsockname failed\\n\");\n+    }\n+    return addr_bind;\n+}\n+\n+bool SockMan::BindAndStartListening(const CService& to, bilingual_str& errmsg)\n+{\n+    // Create socket for listening for incoming connections\n+    struct sockaddr_storage storage;\n+    socklen_t len{sizeof(storage)};\n+    if (!to.GetSockAddr(reinterpret_cast<sockaddr*>(&storage), &len)) {\n+        errmsg = Untranslated(strprintf(\"Bind address family for %s not supported\", to.ToStringAddrPort()));\n+        return false;\n+    }\n+\n+    std::unique_ptr<Sock> sock{CreateSock(to.GetSAFamily(), SOCK_STREAM, IPPROTO_TCP)};\n+    if (!sock) {\n+        errmsg = Untranslated(strprintf(\"Cannot create %s listen socket: %s\",\n+                                        to.ToStringAddrPort(),\n+                                        NetworkErrorString(WSAGetLastError())));\n+        return false;\n+    }\n+\n+    int one{1};\n+\n+    // Allow binding if the port is still in TIME_WAIT state after\n+    // the program was closed and restarted.\n+    if (sock->SetSockOpt(SOL_SOCKET, SO_REUSEADDR, reinterpret_cast<sockopt_arg_type>(&one), sizeof(one)) == SOCKET_ERROR) {\n+        LogPrintLevel(BCLog::NET,\n+                      BCLog::Level::Info,\n+                      \"Cannot set SO_REUSEADDR on %s listen socket: %s, continuing anyway\\n\",\n+                      to.ToStringAddrPort(),\n+                      NetworkErrorString(WSAGetLastError()));\n+    }\n+\n+    // some systems don't have IPV6_V6ONLY but are always v6only; others do have the option\n+    // and enable it by default or not. Try to enable it, if possible.\n+    if (to.IsIPv6()) {\n+#ifdef IPV6_V6ONLY\n+        if (sock->SetSockOpt(IPPROTO_IPV6, IPV6_V6ONLY, reinterpret_cast<sockopt_arg_type>(&one), sizeof(one)) == SOCKET_ERROR) {\n+            LogPrintLevel(BCLog::NET,\n+                          BCLog::Level::Info,\n+                          \"Cannot set IPV6_V6ONLY on %s listen socket: %s, continuing anyway\\n\",\n+                          to.ToStringAddrPort(),\n+                          NetworkErrorString(WSAGetLastError()));\n+        }\n+#endif\n+#ifdef WIN32\n+        int prot_level{PROTECTION_LEVEL_UNRESTRICTED};\n+        if (sock->SetSockOpt(IPPROTO_IPV6,\n+                             IPV6_PROTECTION_LEVEL,\n+                             reinterpret_cast<const char*>(&prot_level),\n+                             sizeof(prot_level)) == SOCKET_ERROR) {\n+            LogPrintLevel(BCLog::NET,\n+                          BCLog::Level::Info,\n+                          \"Cannot set IPV6_PROTECTION_LEVEL on %s listen socket: %s, continuing anyway\\n\",\n+                          to.ToStringAddrPort(),\n+                          NetworkErrorString(WSAGetLastError()));\n+        }\n+#endif\n+    }\n+\n+    if (sock->Bind(reinterpret_cast<sockaddr*>(&storage), len) == SOCKET_ERROR) {\n+        const int err{WSAGetLastError()};\n+        errmsg = strprintf(_(\"Cannot bind to %s: %s%s\"),\n+                           to.ToStringAddrPort(),\n+                           NetworkErrorString(err),\n+                           err == WSAEADDRINUSE\n+                               ? std::string{\" (\"} + CLIENT_NAME + \" already running?)\"\n+                               : \"\");\n+        return false;\n+    }\n+\n+    // Listen for incoming connections\n+    if (sock->Listen(SOMAXCONN) == SOCKET_ERROR) {\n+        errmsg = strprintf(_(\"Cannot listen to %s: %s\"), to.ToStringAddrPort(), NetworkErrorString(WSAGetLastError()));\n+        return false;\n+    }\n+\n+    m_listen.emplace_back(std::move(sock));\n+\n+    return true;\n+}\n+\n+void SockMan::StartSocketsThreads(const Options& options)\n+{\n+    m_thread_socket_handler = std::thread(&util::TraceThread, \"net\", [this] { ThreadSocketHandler(); });",
      "path": "src/common/sockman.cpp",
      "position": null,
      "original_position": 113,
      "commit_id": "7866c736c87a908cef75dc6901c9c0594c65b0eb",
      "original_commit_id": "bcf1254e91782a33b5a1db542f3758831e0bfe2e",
      "in_reply_to_id": 1920546152,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "Yes, it would mess up the logging. I put both `\"net\"` and `\"i2paccept\"` in `SockMan::Options`, so that they are not hardcoded here anymore and can be set by the callers of `SockMan`.",
      "created_at": "2025-01-28T17:15:25Z",
      "updated_at": "2025-01-28T17:15:25Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30988#discussion_r1932564964",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1932564964"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/30988"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 113,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1932753931",
      "pull_request_review_id": 2579242754,
      "id": 1932753931,
      "node_id": "PRRC_kwDOABII585zM3wL",
      "diff_hunk": "@@ -0,0 +1,428 @@\n+// Copyright (c) 2024-present The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or https://opensource.org/license/mit/.\n+\n+#ifndef BITCOIN_COMMON_SOCKMAN_H\n+#define BITCOIN_COMMON_SOCKMAN_H\n+\n+#include <i2p.h>\n+#include <netaddress.h>\n+#include <netbase.h>\n+#include <util/fs.h>\n+#include <util/sock.h>\n+#include <util/translation.h>\n+\n+#include <atomic>\n+#include <memory>\n+#include <queue>\n+#include <span>\n+#include <thread>\n+#include <variant>\n+#include <vector>\n+\n+typedef int64_t NodeId;\n+\n+/**\n+ * A socket manager class which handles socket operations.\n+ * To use this class, inherit from it and implement the pure virtual methods.\n+ * Handled operations:\n+ * - binding and listening on sockets\n+ * - starting of necessary threads to process socket operations\n+ * - accepting incoming connections\n+ * - making outbound connections\n+ * - closing connections\n+ * - waiting for IO readiness on sockets and doing send/recv accordingly\n+ */\n+class SockMan\n+{\n+public:\n+\n+    virtual ~SockMan() = default;\n+\n+    //\n+    // Non-virtual functions, to be reused by children classes.\n+    //\n+\n+    /**\n+     * Bind to a new address:port, start listening and add the listen socket to `m_listen`.\n+     * Should be called before `StartSocketsThreads()`.\n+     * @param[in] to Where to bind.\n+     * @param[out] errmsg Error string if an error occurs.\n+     * @retval true Success.\n+     * @retval false Failure, `strError` will be set.\n+     */\n+    bool BindAndStartListening(const CService& to, bilingual_str& errmsg);\n+\n+    /**\n+     * Options to influence `StartSocketsThreads()`.\n+     */\n+    struct Options {\n+        struct I2P {\n+            explicit I2P(const fs::path& file, const Proxy& proxy) : private_key_file{file}, sam_proxy{proxy} {}\n+\n+            const fs::path private_key_file;\n+            const Proxy sam_proxy;\n+        };\n+\n+        /**\n+         * I2P options. If set then a thread will be started that will accept incoming I2P connections.\n+         */\n+        std::optional<I2P> i2p;\n+    };\n+\n+    /**\n+     * Start the necessary threads for sockets IO.\n+     */\n+    void StartSocketsThreads(const Options& options);\n+\n+    /**\n+     * Join (wait for) the threads started by `StartSocketsThreads()` to exit.\n+     */\n+    void JoinSocketsThreads();\n+\n+    /**\n+     * A more readable std::tuple<std::string, uint16_t> for host and port.\n+     */\n+    struct StringHostIntPort {\n+        const std::string& host;\n+        uint16_t port;\n+    };\n+\n+    /**\n+     * Make an outbound connection, save the socket internally and return a newly generated node id.\n+     * @param[in] to The address to connect to, either as CService or a host as string and port as\n+     * an integer, if the later is used, then `proxy` must be valid.\n+     * @param[in] is_important If true, then log failures with higher severity.\n+     * @param[in] proxy Proxy to connect through if `proxy.IsValid()` is true.\n+     * @param[out] proxy_failed If `proxy` is valid and the connection failed because of the\n+     * proxy, then it will be set to true.\n+     * @param[out] me If the connection was successful then this is set to the address on the\n+     * local side of the socket.\n+     * @return Newly generated node id, or std::nullopt if the operation fails.\n+     */\n+    std::optional<NodeId> ConnectAndMakeNodeId(const std::variant<CService, StringHostIntPort>& to,\n+                                               bool is_important,\n+                                               const Proxy& proxy,\n+                                               bool& proxy_failed,\n+                                               CService& me)\n+        EXCLUSIVE_LOCKS_REQUIRED(!m_connected_mutex, !m_unused_i2p_sessions_mutex);\n+\n+    /**\n+     * Disconnect a given peer by closing its socket and release resources occupied by it.\n+     * @return Whether the peer existed and its socket was closed by this call.\n+     */\n+    bool CloseConnection(NodeId node_id)\n+        EXCLUSIVE_LOCKS_REQUIRED(!m_connected_mutex);\n+\n+    /**\n+     * Try to send some data to the given node.\n+     * @param[in] node_id Identifier of the node to send to.\n+     * @param[in] data The data to send, it might happen that only a prefix of this is sent.\n+     * @param[in] will_send_more Used as an optimization if the caller knows that they will\n+     * be sending more data soon after this call.\n+     * @param[out] errmsg If <0 is returned then this will contain a human readable message\n+     * explaining the error.\n+     * @retval >=0 The number of bytes actually sent.\n+     * @retval <0 A permanent error has occurred.\n+     */\n+    ssize_t SendBytes(NodeId node_id,\n+                      std::span<const unsigned char> data,\n+                      bool will_send_more,\n+                      std::string& errmsg) const\n+        EXCLUSIVE_LOCKS_REQUIRED(!m_connected_mutex);\n+\n+    /**\n+     * Close all sockets.\n+     */\n+    void CloseSockets();\n+\n+    /**\n+     * This is signaled when network activity should cease.\n+     * A pointer to it is saved in `m_i2p_sam_session`, so make sure that\n+     * the lifetime of `interruptNet` is not shorter than\n+     * the lifetime of `m_i2p_sam_session`.\n+     */\n+    CThreadInterrupt interruptNet;\n+\n+protected:\n+\n+    /**\n+     * During some tests mocked sockets are created outside of `SockMan`, make it\n+     * possible to add those so that send/recv can be exercised.\n+     */\n+    void TestOnlyAddExistentNode(NodeId node_id, std::unique_ptr<Sock>&& sock)\n+        EXCLUSIVE_LOCKS_REQUIRED(!m_connected_mutex);\n+\n+private:\n+\n+    /**\n+     * Cap on the size of `m_unused_i2p_sessions`, to ensure it does not\n+     * unexpectedly use too much memory.\n+     */\n+    static constexpr size_t MAX_UNUSED_I2P_SESSIONS_SIZE{10};\n+\n+    //\n+    // Pure virtual functions must be implemented by children classes.\n+    //\n+\n+    /**\n+     * Be notified when a new connection has been accepted.\n+     * @param[in] node_id Id of the newly accepted connection.\n+     * @param[in] me The address and port at our side of the connection.\n+     * @param[in] them The address and port at the peer's side of the connection.\n+     * @retval true The new connection was accepted at the higher level.\n+     * @retval false The connection was refused at the higher level, so the\n+     * associated socket and node_id should be discarded by `SockMan`.\n+     */\n+    virtual bool EventNewConnectionAccepted(NodeId node_id,\n+                                            const CService& me,\n+                                            const CService& them) = 0;\n+\n+    /**\n+     * Called when the socket is ready to send data and `ShouldTryToSend()` has\n+     * returned true. This is where the higher level code serializes its messages\n+     * and calls `SockMan::SendBytes()`.\n+     * @param[in] node_id Id of the node whose socket is ready to send.\n+     * @param[out] cancel_recv Should always be set upon return and if it is true,\n+     * then the next attempt to receive data from that node will be omitted.\n+     */\n+    virtual void EventReadyToSend(NodeId node_id, bool& cancel_recv) = 0;",
      "path": "src/common/sockman.h",
      "position": 196,
      "original_position": 189,
      "commit_id": "7866c736c87a908cef75dc6901c9c0594c65b0eb",
      "original_commit_id": "bcf1254e91782a33b5a1db542f3758831e0bfe2e",
      "in_reply_to_id": 1927267574,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "> `@param[out] cancel_recv Should always be set upon return`\r\n\r\nI think the problem was that `HTTPServer::EventReadyToSend()` could end up not setting `cancel_recv` in which case it remains uninitialized, containing a \"random\" value from the stack at the caller (which was probably `true`, so it canceled all receives from the client, never receiving anything causing an infinite loop):\r\n\r\n```cpp\r\n              bool cancel_recv;\r\n  \r\n              EventReadyToSend(node_id, cancel_recv);\r\n  \r\n              if (cancel_recv) {\r\n                  recv_ready = false;\r\n              }\r\n```\r\n\r\nValgrind or memory sanitizer should complain about this code reading uninitialized value in `if (cancel_recv)`.\r\n\r\nThe below fixes it, remove the last commit from your branch and move the setting of `cancel_recv` from the bottom to the top of the method. So that `cancel_recv` is set in all code paths inside `HTTPServer::EventReadyToSend()`.\r\n\r\n```diff\r\n--- i/src/httpserver.cpp\r\n+++ w/src/httpserver.cpp\r\n@@ -1123,12 +1123,15 @@ bool HTTPServer::EventNewConnectionAccepted(NodeId node_id,\r\n     m_connected_clients.emplace(client->m_node_id, std::move(client));\r\n     return true;\r\n }\r\n \r\n void HTTPServer::EventReadyToSend(NodeId node_id, bool& cancel_recv)\r\n {\r\n+    // Next attempt to receive data from this node is permitted\r\n+    cancel_recv = false;\r\n+\r\n     // Get the HTTPClient\r\n     auto client{WITH_LOCK(m_clients_mutex, return GetClientById(node_id);)};\r\n     if (client == nullptr) {\r\n         return;\r\n     }\r\n \r\n@@ -1149,26 +1152,26 @@ void HTTPServer::EventReadyToSend(NodeId node_id, bool& cancel_recv)\r\n             LogDebug(\r\n                 BCLog::HTTP,\r\n                 \"Error sending HTTP response headers to client %s (id=%lld): %s\\n\",\r\n                 client->m_origin,\r\n                 client->m_node_id,\r\n                 err);\r\n-            cancel_recv = false;\r\n+            cancel_recv = true;\r\n             client->m_disconnect = true;\r\n             return;\r\n         }\r\n \r\n         ssize_t body_bytes_sent = SendBytes(node_id, MakeUCharSpan(res.m_body), /*will_send_more=*/true, err);\r\n         if (body_bytes_sent < 0) {\r\n             LogDebug(\r\n                 BCLog::HTTP,\r\n                 \"Error sending HTTP response body to client %s (id=%lld): %s\\n\",\r\n                 client->m_origin,\r\n                 client->m_node_id,\r\n                 err);\r\n-            cancel_recv = false;\r\n+            cancel_recv = true;\r\n             client->m_disconnect = true;\r\n             return;\r\n         }\r\n \r\n         LogDebug(\r\n             BCLog::HTTP,\r\n@@ -1176,20 +1179,17 @@ void HTTPServer::EventReadyToSend(NodeId node_id, bool& cancel_recv)\r\n             hdr_bytes_sent + body_bytes_sent,\r\n             client->m_origin,\r\n             client->m_node_id);\r\n \r\n         // Our work is done here\r\n         if (!res.m_keep_alive) {\r\n-            cancel_recv = false;\r\n+            cancel_recv = true;\r\n             client->m_disconnect = true;\r\n             return;\r\n         }\r\n     }\r\n-\r\n-    // Next attempt to receive data from this node is permitted\r\n-    cancel_recv = false;\r\n }\r\n \r\n void HTTPServer::EventGotData(NodeId node_id, const uint8_t* data, size_t n)\r\n {\r\n     // Get the HTTPClient\r\n     auto client{WITH_LOCK(m_clients_mutex, return GetClientById(node_id);)};\r\n```",
      "created_at": "2025-01-28T19:36:29Z",
      "updated_at": "2025-01-28T19:36:30Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30988#discussion_r1932753931",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1932753931"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/30988"
        }
      },
      "start_line": 188,
      "original_start_line": 181,
      "start_side": "RIGHT",
      "line": 196,
      "original_line": 196,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1932812651",
      "pull_request_review_id": 2579341743,
      "id": 1932812651,
      "node_id": "PRRC_kwDOABII585zNGFr",
      "diff_hunk": "@@ -0,0 +1,428 @@\n+// Copyright (c) 2024-present The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or https://opensource.org/license/mit/.\n+\n+#ifndef BITCOIN_COMMON_SOCKMAN_H\n+#define BITCOIN_COMMON_SOCKMAN_H\n+\n+#include <i2p.h>\n+#include <netaddress.h>\n+#include <netbase.h>\n+#include <util/fs.h>\n+#include <util/sock.h>\n+#include <util/translation.h>\n+\n+#include <atomic>\n+#include <memory>\n+#include <queue>\n+#include <span>\n+#include <thread>\n+#include <variant>\n+#include <vector>\n+\n+typedef int64_t NodeId;\n+\n+/**\n+ * A socket manager class which handles socket operations.\n+ * To use this class, inherit from it and implement the pure virtual methods.\n+ * Handled operations:\n+ * - binding and listening on sockets\n+ * - starting of necessary threads to process socket operations\n+ * - accepting incoming connections\n+ * - making outbound connections\n+ * - closing connections\n+ * - waiting for IO readiness on sockets and doing send/recv accordingly\n+ */\n+class SockMan\n+{\n+public:\n+\n+    virtual ~SockMan() = default;\n+\n+    //\n+    // Non-virtual functions, to be reused by children classes.\n+    //\n+\n+    /**\n+     * Bind to a new address:port, start listening and add the listen socket to `m_listen`.\n+     * Should be called before `StartSocketsThreads()`.\n+     * @param[in] to Where to bind.\n+     * @param[out] errmsg Error string if an error occurs.\n+     * @retval true Success.\n+     * @retval false Failure, `strError` will be set.\n+     */\n+    bool BindAndStartListening(const CService& to, bilingual_str& errmsg);\n+\n+    /**\n+     * Options to influence `StartSocketsThreads()`.\n+     */\n+    struct Options {\n+        struct I2P {\n+            explicit I2P(const fs::path& file, const Proxy& proxy) : private_key_file{file}, sam_proxy{proxy} {}\n+\n+            const fs::path private_key_file;\n+            const Proxy sam_proxy;\n+        };\n+\n+        /**\n+         * I2P options. If set then a thread will be started that will accept incoming I2P connections.\n+         */\n+        std::optional<I2P> i2p;\n+    };\n+\n+    /**\n+     * Start the necessary threads for sockets IO.\n+     */\n+    void StartSocketsThreads(const Options& options);\n+\n+    /**\n+     * Join (wait for) the threads started by `StartSocketsThreads()` to exit.\n+     */\n+    void JoinSocketsThreads();\n+\n+    /**\n+     * A more readable std::tuple<std::string, uint16_t> for host and port.\n+     */\n+    struct StringHostIntPort {\n+        const std::string& host;\n+        uint16_t port;\n+    };\n+\n+    /**\n+     * Make an outbound connection, save the socket internally and return a newly generated node id.\n+     * @param[in] to The address to connect to, either as CService or a host as string and port as\n+     * an integer, if the later is used, then `proxy` must be valid.\n+     * @param[in] is_important If true, then log failures with higher severity.\n+     * @param[in] proxy Proxy to connect through if `proxy.IsValid()` is true.\n+     * @param[out] proxy_failed If `proxy` is valid and the connection failed because of the\n+     * proxy, then it will be set to true.\n+     * @param[out] me If the connection was successful then this is set to the address on the\n+     * local side of the socket.\n+     * @return Newly generated node id, or std::nullopt if the operation fails.\n+     */\n+    std::optional<NodeId> ConnectAndMakeNodeId(const std::variant<CService, StringHostIntPort>& to,\n+                                               bool is_important,\n+                                               const Proxy& proxy,\n+                                               bool& proxy_failed,\n+                                               CService& me)\n+        EXCLUSIVE_LOCKS_REQUIRED(!m_connected_mutex, !m_unused_i2p_sessions_mutex);\n+\n+    /**\n+     * Disconnect a given peer by closing its socket and release resources occupied by it.\n+     * @return Whether the peer existed and its socket was closed by this call.\n+     */\n+    bool CloseConnection(NodeId node_id)\n+        EXCLUSIVE_LOCKS_REQUIRED(!m_connected_mutex);\n+\n+    /**\n+     * Try to send some data to the given node.\n+     * @param[in] node_id Identifier of the node to send to.\n+     * @param[in] data The data to send, it might happen that only a prefix of this is sent.\n+     * @param[in] will_send_more Used as an optimization if the caller knows that they will\n+     * be sending more data soon after this call.\n+     * @param[out] errmsg If <0 is returned then this will contain a human readable message\n+     * explaining the error.\n+     * @retval >=0 The number of bytes actually sent.\n+     * @retval <0 A permanent error has occurred.\n+     */\n+    ssize_t SendBytes(NodeId node_id,\n+                      std::span<const unsigned char> data,\n+                      bool will_send_more,\n+                      std::string& errmsg) const\n+        EXCLUSIVE_LOCKS_REQUIRED(!m_connected_mutex);\n+\n+    /**\n+     * Close all sockets.\n+     */\n+    void CloseSockets();\n+\n+    /**\n+     * This is signaled when network activity should cease.\n+     * A pointer to it is saved in `m_i2p_sam_session`, so make sure that\n+     * the lifetime of `interruptNet` is not shorter than\n+     * the lifetime of `m_i2p_sam_session`.\n+     */\n+    CThreadInterrupt interruptNet;\n+\n+protected:\n+\n+    /**\n+     * During some tests mocked sockets are created outside of `SockMan`, make it\n+     * possible to add those so that send/recv can be exercised.\n+     */\n+    void TestOnlyAddExistentNode(NodeId node_id, std::unique_ptr<Sock>&& sock)\n+        EXCLUSIVE_LOCKS_REQUIRED(!m_connected_mutex);\n+\n+private:\n+\n+    /**\n+     * Cap on the size of `m_unused_i2p_sessions`, to ensure it does not\n+     * unexpectedly use too much memory.\n+     */\n+    static constexpr size_t MAX_UNUSED_I2P_SESSIONS_SIZE{10};\n+\n+    //\n+    // Pure virtual functions must be implemented by children classes.\n+    //\n+\n+    /**\n+     * Be notified when a new connection has been accepted.\n+     * @param[in] node_id Id of the newly accepted connection.\n+     * @param[in] me The address and port at our side of the connection.\n+     * @param[in] them The address and port at the peer's side of the connection.\n+     * @retval true The new connection was accepted at the higher level.\n+     * @retval false The connection was refused at the higher level, so the\n+     * associated socket and node_id should be discarded by `SockMan`.\n+     */\n+    virtual bool EventNewConnectionAccepted(NodeId node_id,\n+                                            const CService& me,\n+                                            const CService& them) = 0;\n+\n+    /**\n+     * Called when the socket is ready to send data and `ShouldTryToSend()` has\n+     * returned true. This is where the higher level code serializes its messages\n+     * and calls `SockMan::SendBytes()`.\n+     * @param[in] node_id Id of the node whose socket is ready to send.\n+     * @param[out] cancel_recv Should always be set upon return and if it is true,\n+     * then the next attempt to receive data from that node will be omitted.\n+     */\n+    virtual void EventReadyToSend(NodeId node_id, bool& cancel_recv) = 0;",
      "path": "src/common/sockman.h",
      "position": 196,
      "original_position": 189,
      "commit_id": "7866c736c87a908cef75dc6901c9c0594c65b0eb",
      "original_commit_id": "bcf1254e91782a33b5a1db542f3758831e0bfe2e",
      "in_reply_to_id": 1927267574,
      "user": {
        "login": "pinheadmz",
        "id": 2084648,
        "node_id": "MDQ6VXNlcjIwODQ2NDg=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2084648?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/pinheadmz",
        "html_url": "https://github.com/pinheadmz",
        "followers_url": "https://api.github.com/users/pinheadmz/followers",
        "following_url": "https://api.github.com/users/pinheadmz/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/pinheadmz/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/pinheadmz/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/pinheadmz/subscriptions",
        "organizations_url": "https://api.github.com/users/pinheadmz/orgs",
        "repos_url": "https://api.github.com/users/pinheadmz/repos",
        "events_url": "https://api.github.com/users/pinheadmz/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/pinheadmz/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "awesome thank you",
      "created_at": "2025-01-28T20:23:58Z",
      "updated_at": "2025-01-28T20:23:58Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30988#discussion_r1932812651",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1932812651"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/30988"
        }
      },
      "start_line": 188,
      "original_start_line": 181,
      "start_side": "RIGHT",
      "line": 196,
      "original_line": 196,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1935808313",
      "pull_request_review_id": 2584231283,
      "id": 1935808313,
      "node_id": "PRRC_kwDOABII585zYhc5",
      "diff_hunk": "@@ -1312,6 +1312,12 @@ class CConnman : private SockMan\n     virtual bool ShouldTryToRecv(NodeId node_id) const override\n         EXCLUSIVE_LOCKS_REQUIRED(!m_nodes_mutex);\n \n+    virtual void EventIOLoopCompletedForNode(NodeId node_id) override\n+        EXCLUSIVE_LOCKS_REQUIRED(!m_nodes_mutex);\n+\n+    virtual void EventIOLoopCompletedForAllPeers() override\n+        EXCLUSIVE_LOCKS_REQUIRED(!m_nodes_mutex, !m_reconnections_mutex);\n+ ",
      "path": "src/net.h",
      "position": null,
      "original_position": 9,
      "commit_id": "7866c736c87a908cef75dc6901c9c0594c65b0eb",
      "original_commit_id": "248ec2d2687fae47b63688e00b9ef18d4c0c9676",
      "in_reply_to_id": null,
      "user": {
        "login": "Sjors",
        "id": 10217,
        "node_id": "MDQ6VXNlcjEwMjE3",
        "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Sjors",
        "html_url": "https://github.com/Sjors",
        "followers_url": "https://api.github.com/users/Sjors/followers",
        "following_url": "https://api.github.com/users/Sjors/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Sjors/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Sjors/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
        "organizations_url": "https://api.github.com/users/Sjors/orgs",
        "repos_url": "https://api.github.com/users/Sjors/repos",
        "events_url": "https://api.github.com/users/Sjors/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Sjors/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "248ec2d2687fae47b63688e00b9ef18d4c0c9676 nit: when I run the linter (along with all other tests) on this commit it complains about trailing whitespace.\r\n\r\n```diff\r\ndiff --git a/src/net.cpp b/src/net.cpp\r\nindex 8d0dd84d91..0228ddce57 100644\r\n--- a/src/net.cpp\r\n+++ b/src/net.cpp\r\n@@ -2068,7 +2068,7 @@ void CConnman::EventIOLoopCompletedForAllPeers()\r\n     DisconnectNodes();\r\n     NotifyNumConnectionsChanged();\r\n }\r\n- \r\n+\r\n Sock::EventsPerSock CConnman::GenerateWaitSockets(Span<CNode* const> nodes)\r\n {\r\n     AssertLockNotHeld(m_nodes_mutex);\r\ndiff --git a/src/net.h b/src/net.h\r\nindex 8778bcb88a..6c2c202fbb 100644\r\n--- a/src/net.h\r\n+++ b/src/net.h\r\n@@ -1317,7 +1317,7 @@ private:\r\n \r\n     virtual void EventIOLoopCompletedForAllPeers() override\r\n         EXCLUSIVE_LOCKS_REQUIRED(!m_nodes_mutex, !m_reconnections_mutex);\r\n- \r\n+\r\n     /**\r\n      * Generate a collection of sockets to check for IO readiness.\r\n      * @param[in] nodes Select from these nodes' sockets.\r\n```",
      "created_at": "2025-01-30T15:25:18Z",
      "updated_at": "2025-01-30T15:25:18Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/30988#discussion_r1935808313",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1935808313"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/30988"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1320,
      "side": "RIGHT"
    }
  ]
}
{
  "type": "pull",
  "pull": {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/32694",
    "id": 2574422046,
    "node_id": "PR_kwDOABII586ZcpAe",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/32694",
    "diff_url": "https://github.com/bitcoin/bitcoin/pull/32694.diff",
    "patch_url": "https://github.com/bitcoin/bitcoin/pull/32694.patch",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/32694",
    "commits_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/32694/commits",
    "review_comments_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/32694/comments",
    "review_comment_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments%7B/number%7D",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/32694/comments",
    "statuses_url": "https://api.github.com/repos/bitcoin/bitcoin/statuses/4c5ec3a70a47798d8451da65c9c0059955cde937",
    "number": 32694,
    "state": "open",
    "locked": false,
    "maintainer_can_modify": true,
    "title": "index: move disk read lookups to base class",
    "user": {
      "login": "furszy",
      "id": 5377650,
      "node_id": "MDQ6VXNlcjUzNzc2NTA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/furszy",
      "html_url": "https://github.com/furszy",
      "followers_url": "https://api.github.com/users/furszy/followers",
      "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
      "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
      "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
      "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
      "organizations_url": "https://api.github.com/users/furszy/orgs",
      "repos_url": "https://api.github.com/users/furszy/repos",
      "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
      "received_events_url": "https://api.github.com/users/furszy/received_events",
      "type": "User",
      "site_admin": false,
      "patch_url": null
    },
    "body": "Combining common refactors from #24230 and #26966, aiming to move both efforts forward while reducing their size and review burden.\r\n\r\nBroadly, #24230 focuses on enabling indexes to run in a separate process, and #26966 aims to parallelize the indexes initial synchronization process. A shared prerequisite for both is ensuring that only the base index class interacts with the nodeâ€™s chain internals - child index classes should instead operate solely through chain events.\r\n\r\nThis PR moves disk read lookups from child index classes to the base index class. It also includes a few documentation improvements and a test-only code cleanup.",
    "labels": [
      {
        "id": 97470796,
        "node_id": "MDU6TGFiZWw5NzQ3MDc5Ng==",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/UTXO%20Db%20and%20Indexes",
        "name": "UTXO Db and Indexes",
        "color": "fbca04",
        "default": false
      }
    ],
    "created_at": "2025-06-06T20:38:40Z",
    "updated_at": "2025-06-10T16:58:15Z",
    "mergeable": true,
    "mergeable_state": "blocked",
    "merged": false,
    "merge_commit_sha": "9ae77afedf5b8aed2337e321a2cd269043520016",
    "assignees": [],
    "requested_reviewers": [],
    "requested_teams": [],
    "rebaseable": true,
    "head": {
      "label": "furszy:2025_indexes_remove_CBlockIndex_access",
      "ref": "2025_indexes_remove_CBlockIndex_access",
      "sha": "4c5ec3a70a47798d8451da65c9c0059955cde937",
      "user": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "repo": {
        "id": 143624913,
        "node_id": "MDEwOlJlcG9zaXRvcnkxNDM2MjQ5MTM=",
        "name": "bitcoin-core",
        "full_name": "furszy/bitcoin-core",
        "owner": {
          "login": "furszy",
          "id": 5377650,
          "node_id": "MDQ6VXNlcjUzNzc2NTA=",
          "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
          "gravatar_id": "",
          "url": "https://api.github.com/users/furszy",
          "html_url": "https://github.com/furszy",
          "followers_url": "https://api.github.com/users/furszy/followers",
          "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
          "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
          "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
          "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
          "organizations_url": "https://api.github.com/users/furszy/orgs",
          "repos_url": "https://api.github.com/users/furszy/repos",
          "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
          "received_events_url": "https://api.github.com/users/furszy/received_events",
          "type": "User",
          "site_admin": false,
          "patch_url": null
        },
        "private": false,
        "html_url": "https://github.com/furszy/bitcoin-core",
        "description": "Bitcoin-Core",
        "fork": true,
        "url": "https://api.github.com/repos/furszy/bitcoin-core",
        "archive_url": "https://api.github.com/repos/furszy/bitcoin-core/%7Barchive_format%7D%7B/ref%7D",
        "assignees_url": "https://api.github.com/repos/furszy/bitcoin-core/assignees%7B/user%7D",
        "blobs_url": "https://api.github.com/repos/furszy/bitcoin-core/git/blobs%7B/sha%7D",
        "branches_url": "https://api.github.com/repos/furszy/bitcoin-core/branches%7B/branch%7D",
        "collaborators_url": "https://api.github.com/repos/furszy/bitcoin-core/collaborators%7B/collaborator%7D",
        "comments_url": "https://api.github.com/repos/furszy/bitcoin-core/comments%7B/number%7D",
        "commits_url": "https://api.github.com/repos/furszy/bitcoin-core/commits%7B/sha%7D",
        "compare_url": "https://api.github.com/repos/furszy/bitcoin-core/compare/%7Bbase%7D...%7Bhead%7D",
        "contents_url": "https://api.github.com/repos/furszy/bitcoin-core/contents/%7B+path%7D",
        "contributors_url": "https://api.github.com/repos/furszy/bitcoin-core/contributors",
        "deployments_url": "https://api.github.com/repos/furszy/bitcoin-core/deployments",
        "downloads_url": "https://api.github.com/repos/furszy/bitcoin-core/downloads",
        "events_url": "https://api.github.com/repos/furszy/bitcoin-core/events",
        "forks_url": "https://api.github.com/repos/furszy/bitcoin-core/forks",
        "git_commits_url": "https://api.github.com/repos/furszy/bitcoin-core/git/commits%7B/sha%7D",
        "git_refs_url": "https://api.github.com/repos/furszy/bitcoin-core/git/refs%7B/sha%7D",
        "git_tags_url": "https://api.github.com/repos/furszy/bitcoin-core/git/tags%7B/sha%7D",
        "git_url": "git://github.com/furszy/bitcoin-core.git",
        "issue_comment_url": "https://api.github.com/repos/furszy/bitcoin-core/issues/comments%7B/number%7D",
        "issue_events_url": "https://api.github.com/repos/furszy/bitcoin-core/issues/events%7B/number%7D",
        "issues_url": "https://api.github.com/repos/furszy/bitcoin-core/issues%7B/number%7D",
        "keys_url": "https://api.github.com/repos/furszy/bitcoin-core/keys%7B/key_id%7D",
        "labels_url": "https://api.github.com/repos/furszy/bitcoin-core/labels%7B/name%7D",
        "languages_url": "https://api.github.com/repos/furszy/bitcoin-core/languages",
        "merges_url": "https://api.github.com/repos/furszy/bitcoin-core/merges",
        "milestones_url": "https://api.github.com/repos/furszy/bitcoin-core/milestones%7B/number%7D",
        "notifications_url": "https://api.github.com/repos/furszy/bitcoin-core/notifications%7B?since,all,participating}",
        "pulls_url": "https://api.github.com/repos/furszy/bitcoin-core/pulls%7B/number%7D",
        "releases_url": "https://api.github.com/repos/furszy/bitcoin-core/releases%7B/id%7D",
        "ssh_url": "git@github.com:furszy/bitcoin-core.git",
        "stargazers_url": "https://api.github.com/repos/furszy/bitcoin-core/stargazers",
        "statuses_url": "https://api.github.com/repos/furszy/bitcoin-core/statuses/%7Bsha%7D",
        "subscribers_url": "https://api.github.com/repos/furszy/bitcoin-core/subscribers",
        "subscription_url": "https://api.github.com/repos/furszy/bitcoin-core/subscription",
        "tags_url": "https://api.github.com/repos/furszy/bitcoin-core/tags",
        "teams_url": "https://api.github.com/repos/furszy/bitcoin-core/teams",
        "trees_url": "https://api.github.com/repos/furszy/bitcoin-core/git/trees%7B/sha%7D",
        "clone_url": "https://github.com/furszy/bitcoin-core.git",
        "hooks_url": "https://api.github.com/repos/furszy/bitcoin-core/hooks",
        "svn_url": "https://github.com/furszy/bitcoin-core",
        "homepage": "",
        "language": "C++",
        "forks_count": 3,
        "stargazers_count": 6,
        "watchers_count": 6,
        "size": 427354,
        "default_branch": "master",
        "open_issues_count": 0,
        "is_template": false,
        "topics": [],
        "has_issues": false,
        "has_projects": true,
        "has_wiki": true,
        "has_pages": false,
        "has_downloads": false,
        "archived": false,
        "disabled": false,
        "visibility": "public",
        "pushed_at": "2025-06-10T16:58:14Z",
        "created_at": "2018-08-05T15:28:43Z",
        "updated_at": "2025-05-21T08:37:58Z",
        "allow_forking": true,
        "license": {
          "key": "mit",
          "name": "MIT License",
          "node_id": "MDc6TGljZW5zZTEz",
          "spdx_id": "MIT",
          "url": "https://api.github.com/licenses/mit",
          "html_url": null,
          "description": null,
          "implementation": null,
          "permissions": null,
          "conditions": null,
          "limitations": null,
          "body": null,
          "featured": null
        }
      }
    },
    "base": {
      "label": "bitcoin:master",
      "ref": "master",
      "sha": "011a8c5f01685e7e126a1ab0bae8c46b7fac5250",
      "user": {
        "login": "bitcoin",
        "id": 528860,
        "node_id": "MDEyOk9yZ2FuaXphdGlvbjUyODg2MA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/528860?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/bitcoin",
        "html_url": "https://github.com/bitcoin",
        "followers_url": "https://api.github.com/users/bitcoin/followers",
        "following_url": "https://api.github.com/users/bitcoin/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/bitcoin/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/bitcoin/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/bitcoin/subscriptions",
        "organizations_url": "https://api.github.com/users/bitcoin/orgs",
        "repos_url": "https://api.github.com/users/bitcoin/repos",
        "events_url": "https://api.github.com/users/bitcoin/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/bitcoin/received_events",
        "type": "Organization",
        "site_admin": false,
        "patch_url": null
      },
      "repo": {
        "id": 1181927,
        "node_id": "MDEwOlJlcG9zaXRvcnkxMTgxOTI3",
        "name": "bitcoin",
        "full_name": "bitcoin/bitcoin",
        "owner": {
          "login": "bitcoin",
          "id": 528860,
          "node_id": "MDEyOk9yZ2FuaXphdGlvbjUyODg2MA==",
          "avatar_url": "https://avatars.githubusercontent.com/u/528860?v=4",
          "gravatar_id": "",
          "url": "https://api.github.com/users/bitcoin",
          "html_url": "https://github.com/bitcoin",
          "followers_url": "https://api.github.com/users/bitcoin/followers",
          "following_url": "https://api.github.com/users/bitcoin/following%7B/other_user%7D",
          "gists_url": "https://api.github.com/users/bitcoin/gists%7B/gist_id%7D",
          "starred_url": "https://api.github.com/users/bitcoin/starred%7B/owner%7D%7B/repo%7D",
          "subscriptions_url": "https://api.github.com/users/bitcoin/subscriptions",
          "organizations_url": "https://api.github.com/users/bitcoin/orgs",
          "repos_url": "https://api.github.com/users/bitcoin/repos",
          "events_url": "https://api.github.com/users/bitcoin/events%7B/privacy%7D",
          "received_events_url": "https://api.github.com/users/bitcoin/received_events",
          "type": "Organization",
          "site_admin": false,
          "patch_url": null
        },
        "private": false,
        "html_url": "https://github.com/bitcoin/bitcoin",
        "description": "Bitcoin Core integration/staging tree",
        "fork": false,
        "url": "https://api.github.com/repos/bitcoin/bitcoin",
        "archive_url": "https://api.github.com/repos/bitcoin/bitcoin/%7Barchive_format%7D%7B/ref%7D",
        "assignees_url": "https://api.github.com/repos/bitcoin/bitcoin/assignees%7B/user%7D",
        "blobs_url": "https://api.github.com/repos/bitcoin/bitcoin/git/blobs%7B/sha%7D",
        "branches_url": "https://api.github.com/repos/bitcoin/bitcoin/branches%7B/branch%7D",
        "collaborators_url": "https://api.github.com/repos/bitcoin/bitcoin/collaborators%7B/collaborator%7D",
        "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/comments%7B/number%7D",
        "commits_url": "https://api.github.com/repos/bitcoin/bitcoin/commits%7B/sha%7D",
        "compare_url": "https://api.github.com/repos/bitcoin/bitcoin/compare/%7Bbase%7D...%7Bhead%7D",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/%7B+path%7D",
        "contributors_url": "https://api.github.com/repos/bitcoin/bitcoin/contributors",
        "deployments_url": "https://api.github.com/repos/bitcoin/bitcoin/deployments",
        "downloads_url": "https://api.github.com/repos/bitcoin/bitcoin/downloads",
        "events_url": "https://api.github.com/repos/bitcoin/bitcoin/events",
        "forks_url": "https://api.github.com/repos/bitcoin/bitcoin/forks",
        "git_commits_url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits%7B/sha%7D",
        "git_refs_url": "https://api.github.com/repos/bitcoin/bitcoin/git/refs%7B/sha%7D",
        "git_tags_url": "https://api.github.com/repos/bitcoin/bitcoin/git/tags%7B/sha%7D",
        "git_url": "git://github.com/bitcoin/bitcoin.git",
        "issue_comment_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments%7B/number%7D",
        "issue_events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events%7B/number%7D",
        "issues_url": "https://api.github.com/repos/bitcoin/bitcoin/issues%7B/number%7D",
        "keys_url": "https://api.github.com/repos/bitcoin/bitcoin/keys%7B/key_id%7D",
        "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/labels%7B/name%7D",
        "languages_url": "https://api.github.com/repos/bitcoin/bitcoin/languages",
        "merges_url": "https://api.github.com/repos/bitcoin/bitcoin/merges",
        "milestones_url": "https://api.github.com/repos/bitcoin/bitcoin/milestones%7B/number%7D",
        "notifications_url": "https://api.github.com/repos/bitcoin/bitcoin/notifications%7B?since,all,participating}",
        "pulls_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls%7B/number%7D",
        "releases_url": "https://api.github.com/repos/bitcoin/bitcoin/releases%7B/id%7D",
        "ssh_url": "git@github.com:bitcoin/bitcoin.git",
        "stargazers_url": "https://api.github.com/repos/bitcoin/bitcoin/stargazers",
        "statuses_url": "https://api.github.com/repos/bitcoin/bitcoin/statuses/%7Bsha%7D",
        "subscribers_url": "https://api.github.com/repos/bitcoin/bitcoin/subscribers",
        "subscription_url": "https://api.github.com/repos/bitcoin/bitcoin/subscription",
        "tags_url": "https://api.github.com/repos/bitcoin/bitcoin/tags",
        "teams_url": "https://api.github.com/repos/bitcoin/bitcoin/teams",
        "trees_url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees%7B/sha%7D",
        "clone_url": "https://github.com/bitcoin/bitcoin.git",
        "hooks_url": "https://api.github.com/repos/bitcoin/bitcoin/hooks",
        "svn_url": "https://github.com/bitcoin/bitcoin",
        "homepage": "https://bitcoincore.org/en/download",
        "language": "C++",
        "forks_count": 37349,
        "stargazers_count": 84062,
        "watchers_count": 84062,
        "size": 283556,
        "default_branch": "master",
        "open_issues_count": 749,
        "is_template": false,
        "topics": [
          "bitcoin",
          "c-plus-plus",
          "cryptocurrency",
          "cryptography",
          "p2p"
        ],
        "has_issues": true,
        "has_projects": true,
        "has_wiki": false,
        "has_pages": false,
        "has_downloads": false,
        "archived": false,
        "disabled": false,
        "visibility": "public",
        "pushed_at": "2025-06-10T16:26:07Z",
        "created_at": "2010-12-19T15:16:43Z",
        "updated_at": "2025-06-10T16:48:35Z",
        "allow_forking": true,
        "license": {
          "key": "mit",
          "name": "MIT License",
          "node_id": "MDc6TGljZW5zZTEz",
          "spdx_id": "MIT",
          "url": "https://api.github.com/licenses/mit",
          "html_url": null,
          "description": null,
          "implementation": null,
          "permissions": null,
          "conditions": null,
          "limitations": null,
          "body": null,
          "featured": null
        }
      }
    },
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/32694"
      }
    },
    "author_association": "MEMBER",
    "draft": false,
    "additions": 134,
    "deletions": 152,
    "changed_files": 15,
    "commits": 4,
    "review_comments": 10,
    "comments": 1
  },
  "events": [
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDMzMWEyNWNiMTY2MzIwNDJkZDY3ODJhOWI2MmZjYzVjOGFhNmRhM2I",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/331a25cb16632042dd6782a9b62fcc5c8aa6da3b",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/331a25cb16632042dd6782a9b62fcc5c8aa6da3b",
      "tree": {
        "sha": "2da92aeead0581cb99fe8f42e9949e1bc01a5355",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/2da92aeead0581cb99fe8f42e9949e1bc01a5355"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree 2da92aeead0581cb99fe8f42e9949e1bc01a5355\nparent ae024137bda9fe189f4e7ccf26dbaffd44cbbeb6\nauthor furszy <matiasfurszyfer@protonmail.com> 1749234286 -0400\ncommitter furszy <matiasfurszyfer@protonmail.com> 1749241974 -0400\n\ntest: indexes, avoid creating threads when sync runs synchronously\n\nThe indexes test call StartBackgroundSync(), which spawns a thread to run Sync(),\nonly for the test thread to wait for it to complete by calling IndexWaitSynced().\n\nSo, since the sync is performed synchronously, we can skip the extra thread creation\nentirely and call Sync() directly.\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEEA++0fqwRHQpmlZfQXdI8zGhqpiMFAmhDUHYACgkQXdI8zGhq\npiPQBhAAuylSPvD3gipRmrvI3csM/n/qQpPbioptcyjHx5MfRjPXy9tNsDNUTMCP\nRi2Nte8mityjLutX6jpYYalnjVZYkJhLEZ2C4s7eGb5hf1CeA7HmnojmPapx5zjz\n9r0Ea+WtJROATbT+LK7qsOJy3k8m/m9dtHsLI5p4y5nY9fOdk1DlhlbqmrBt7vFK\nL8fLe5NgKCONKj66AuTLAHvj7h8G9h8dRXUB4jMTHG2wxzi6XoRN33FsMUGxm/C9\n8rzkcyIDO6UJEVOXWFid0ymvqeVk1awaH9lYqKbqbGS2XrlAnqeIee+3MYKliw5A\n0BvB5ZXnKsdGMJ7dbsmO8JgG4y0ESl5kaUvZjPjhCsrLzyJrxsN3afIFhOli3Ev5\nH6sh4BzYo7Noin7redf/NtjeBB4qQEVMNiTAd1NgrTPphDz7DiT8XZ7fYl5aboz1\nwjpr7H0ittwaFbTFKqPp3rYLnNKLY1ULRu3vnP7IdIiKxWxMlEY7wKNmLVyU2EV9\nHRmeDRFIT8vg01wHBNlFj5c6lQihDmo5rYfjcmCo3oN3uKNI1CflqB7AAbfXb0tJ\ngU/77P0/e3VsGa6EYjhTNp1twHea/C2khKK4b4x6WZMdx0B9TMVM4GTIZNLzYxs2\n8Mhg9MfgBujr81nlmbJCkkTyaYGBW8XCRCc4Ewc1Hw1XEy9mkKU=\n=4uN0\n-----END PGP SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/ae024137bda9fe189f4e7ccf26dbaffd44cbbeb6",
          "sha": "ae024137bda9fe189f4e7ccf26dbaffd44cbbeb6",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/ae024137bda9fe189f4e7ccf26dbaffd44cbbeb6"
        }
      ],
      "message": "test: indexes, avoid creating threads when sync runs synchronously\n\nThe indexes test call StartBackgroundSync(), which spawns a thread to run Sync(),\nonly for the test thread to wait for it to complete by calling IndexWaitSynced().\n\nSo, since the sync is performed synchronously, we can skip the extra thread creation\nentirely and call Sync() directly.",
      "committer": {
        "name": "furszy",
        "email": "matiasfurszyfer@protonmail.com",
        "date": "2025-06-06T20:32:54Z"
      },
      "author": {
        "name": "furszy",
        "email": "matiasfurszyfer@protonmail.com",
        "date": "2025-06-06T18:24:46Z"
      },
      "sha": "331a25cb16632042dd6782a9b62fcc5c8aa6da3b"
    },
    {
      "event": "commented",
      "id": 2950741891,
      "node_id": "IC_kwDOABII586v4L-D",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2950741891",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-06-06T20:38:42Z",
      "updated_at": "2025-06-10T16:51:42Z",
      "author_association": "CONTRIBUTOR",
      "body": "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--006a51241073e994b41acfe9ec718e94-->\n### Code Coverage & Benchmarks\nFor details see: https://corecheck.dev/bitcoin/bitcoin/pulls/32694.\n<!--021abf342d371248e50ceaed478a90ca-->\n### Reviews\nSee [the guideline](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#code-review) for information on the review process.\n| Type | Reviewers |\n| ---- | --------- |\n| Approach ACK | [TheCharlatan](https://github.com/bitcoin/bitcoin/pull/32694#pullrequestreview-2913396907) |\n| Stale ACK | [ryanofsky](https://github.com/bitcoin/bitcoin/pull/32694#pullrequestreview-2913210912) |\n\nIf your review is incorrectly listed, please react with ðŸ‘Ž to this comment and the bot will ignore it on the next update.\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* [#31308](https://github.com/bitcoin/bitcoin/pull/31308) (ci, iwyu: Treat warnings as errors for specific directories by hebasto)\n* [#30469](https://github.com/bitcoin/bitcoin/pull/30469) (index: Fix coinstats overflow and introduce index versioning by fjahr)\n* [#29307](https://github.com/bitcoin/bitcoin/pull/29307) (util: explicitly close all AutoFiles that have been written by vasild)\n* [#26966](https://github.com/bitcoin/bitcoin/pull/26966) (index: initial sync speedup, parallelize process by furszy)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.\n<!--5faf32d7da4f0f540f40219e4f7537a3-->",
      "user": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32694#issuecomment-2950741891",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/32694"
    },
    {
      "event": "labeled",
      "id": 18028585649,
      "node_id": "LE_lADOABII5866UC3QzwAAAAQylmKx",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/18028585649",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-06-06T20:38:57Z",
      "label": {
        "name": "UTXO Db and Indexes",
        "color": "fbca04"
      }
    },
    {
      "event": "reviewed",
      "id": 2913210912,
      "node_id": "PRR_kwDOABII586tpBIg",
      "url": null,
      "actor": null,
      "commit_id": "3f390efa313f4ac43e9134d5299d7faec74cca60",
      "commit_url": null,
      "created_at": null,
      "author_association": "CONTRIBUTOR",
      "body": "Code review ACK 3f390efa313f4ac43e9134d5299d7faec74cca60. Nice changes! This gets rid of blockstorage and CBlockIndex* accesses from index subclasses during sync to decouple the indexes from node internals and make new indexes more straightforward to write in the future. It should also simplify the parallelization PR and avoid the need for refactoring there.",
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32694#pullrequestreview-2913210912",
      "submitted_at": "2025-06-10T12:55:17Z",
      "state": "APPROVED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/32694"
    },
    {
      "event": "reviewed",
      "id": 2913396907,
      "node_id": "PRR_kwDOABII586tpuir",
      "url": null,
      "actor": null,
      "commit_id": "3f390efa313f4ac43e9134d5299d7faec74cca60",
      "commit_url": null,
      "created_at": null,
      "author_association": "CONTRIBUTOR",
      "body": "Approach ACK\r\n\r\nThis felt all felt very familiar :)\r\n\r\nCan you double-check the commit message of 50696f07784b5dcf04a398f7592dead4dde6d2e9. I think there is a word too much in the first and second sentence.",
      "user": {
        "login": "TheCharlatan",
        "id": 8421793,
        "node_id": "MDQ6VXNlcjg0MjE3OTM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8421793?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/TheCharlatan",
        "html_url": "https://github.com/TheCharlatan",
        "followers_url": "https://api.github.com/users/TheCharlatan/followers",
        "following_url": "https://api.github.com/users/TheCharlatan/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/TheCharlatan/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/TheCharlatan/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/TheCharlatan/subscriptions",
        "organizations_url": "https://api.github.com/users/TheCharlatan/orgs",
        "repos_url": "https://api.github.com/users/TheCharlatan/repos",
        "events_url": "https://api.github.com/users/TheCharlatan/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/TheCharlatan/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32694#pullrequestreview-2913396907",
      "submitted_at": "2025-06-10T13:39:08Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/32694"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 18079426209,
      "node_id": "HRFPE_lADOABII5866UC3QzwAAAAQ1niah",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/18079426209",
      "actor": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": "0ce3d9bac20eb2b074c269a40f9a0408e2533c81",
      "commit_url": "https://api.github.com/repos/furszy/bitcoin-core/commits/0ce3d9bac20eb2b074c269a40f9a0408e2533c81",
      "created_at": "2025-06-10T16:51:21Z"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDBhMjQ4NzA4ZGM5ZDQ2NWRiMDkxNjhjMzliM2YxMmNiNGM5NDY1Yjc",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/0a248708dc9d465db09168c39b3f12cb4c9465b7",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/0a248708dc9d465db09168c39b3f12cb4c9465b7",
      "tree": {
        "sha": "662d8dd9ee3c5109c9007b6f1f734fd9377fb2c9",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/662d8dd9ee3c5109c9007b6f1f734fd9377fb2c9"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree 662d8dd9ee3c5109c9007b6f1f734fd9377fb2c9\nparent 331a25cb16632042dd6782a9b62fcc5c8aa6da3b\nauthor Ryan Ofsky <ryan@ofsky.org> 1643054529 -0500\ncommitter furszy <matiasfurszyfer@protonmail.com> 1749574635 -0400\n\nindexes, refactor: Stop requiring CBlockIndex type to call IsBIP30Unspendable\n\nThis commit does not change behavior in any way.\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEEA++0fqwRHQpmlZfQXdI8zGhqpiMFAmhIY+sACgkQXdI8zGhq\npiNpwA//QEjP4LpoDphdYCuF0/TdzTwfWVWl1geCPGP7leKdGZFPxO1tBQQLmUwA\nl/Z0EI4cybXcETvy9OmdfpD5yxLwkbV09kDqmE+uTM0YkXCJzH/jErK6QMiv3iV7\ng8y9a5/YXpT+T+BcI3g/DfdIuXLU4l3y7dGUUJVy03pAB3CZ4TcaICQHYlCISJht\nIY1bsWyYA9G/Sxbf49/BygCR0bslZx+QixUECYvbuV01ts5ny3pMpbafy4qLLAvj\ncLbzNEmt4ohZHbLhPj2Diz4mAUtPK1Wv2wbb5UGPJspkvToX8+H/7zbLKru2Wzq6\ntrOyquWPhSbPVc6GVhxRdOmVGVPawUvwz7udsVQQhM6Ud/oIUSDOKungJlleN971\n36ZUjOzu34RmkUQskCIpHAJwWT5ASdecKt4TvB87sP6MR0wnvHNIJ8EsL0DRAdzm\nVn+kbkrXPTcfojG30cNFldMWH/bNgAcTwM6Wh4spQpshSGm+yB6GZ8EwvZKhdc4R\nzGcMEk7tRAEtArOWA64258mveKCWJVXLE0tqmp9BqZaNeFiAfssSzKoHCezfNAKg\n6MxhlS9ZjuCMyt1nqGIQVScxJr+OKNHf/Js58qXXIY+Y3eL5NGgNiMJuzJsQw1mJ\nitVfyon2vBFhgfGDorrUmWKEJJ7omdbWPhGMuhNMoGPdAg2b/dg=\n=UMHX\n-----END PGP SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/331a25cb16632042dd6782a9b62fcc5c8aa6da3b",
          "sha": "331a25cb16632042dd6782a9b62fcc5c8aa6da3b",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/331a25cb16632042dd6782a9b62fcc5c8aa6da3b"
        }
      ],
      "message": "indexes, refactor: Stop requiring CBlockIndex type to call IsBIP30Unspendable\n\nThis commit does not change behavior in any way.",
      "committer": {
        "name": "furszy",
        "email": "matiasfurszyfer@protonmail.com",
        "date": "2025-06-10T16:57:15Z"
      },
      "author": {
        "name": "Ryan Ofsky",
        "email": "ryan@ofsky.org",
        "date": "2022-01-24T20:02:09Z"
      },
      "sha": "0a248708dc9d465db09168c39b3f12cb4c9465b7"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDZmMTM5MmNjNDJjZGU2Mzg3NzNmMmI2OTdkN2QyYzU4YWJjZGM4NjA",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/6f1392cc42cde638773f2b697d7d2c58abcdc860",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/6f1392cc42cde638773f2b697d7d2c58abcdc860",
      "tree": {
        "sha": "850ec72d95c23d36c7ef40a71e57a26f5e5dccfa",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/850ec72d95c23d36c7ef40a71e57a26f5e5dccfa"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree 850ec72d95c23d36c7ef40a71e57a26f5e5dccfa\nparent 0a248708dc9d465db09168c39b3f12cb4c9465b7\nauthor Ryan Ofsky <ryan@ofsky.org> 1642998041 -0500\ncommitter furszy <matiasfurszyfer@protonmail.com> 1749574635 -0400\n\nindexes, refactor: Remove remaining CBlockIndex* uses in index Rewind methods\n\nMove ReadBlock code from CoinStatsIndex::CustomRewind to BaseIndex::Rewind\n\nMove ReadUndo code from CoinStatsIndex::ReverseBlock to BaseIndex::Rewind\n\nThis commit does change behavior slightly. Since the new CustomRemove\nmethods only take a single block at a time instead of a range of\ndisconnected blocks, when they call CopyHeightIndexToHashIndex they will\nnow do an index seek for each removed block instead of only seeking once\nto the height of the earliest removed block. Seeking instead of scanning\nis a little worse for performance if there is a >1 block reorg, but\nprobably not noticeable unless the reorg is very deep.\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEEA++0fqwRHQpmlZfQXdI8zGhqpiMFAmhIY+sACgkQXdI8zGhq\npiMLbw/+JA4aXtx+JGMs/BbJT5wk5h62vPRTbyl9LkMm2M9Tma0bAkHTyCLMzVmG\nIlCeCtnvI0rFRbmV8uA/uAbNoDBFZ/1dVvtt2XLRkvk2nib/qpXdDfCIq730e09/\nrYA7IkuBn+aPozrflBIvQ8s0INVAmEIaaokiPIRzdyjDAI+rqQuhfKIwRdNgeTLw\nUVWIZ6pl+4h3RgFM2cNXc3uRlzepa1XxbG1at6Oqctrj1U4gDOUx17Y4VZnrhlTm\neiPy9GQg1g80wSyiiyPZPW9LX2NDpiJ8egjVK1XuQPLdciHvOqS1Pw0Bxa3leCU0\nLv3eEagpY6BTiS69Ys9OlS3+tzkLjAeacH/x2XTgEP7aPs9/x4VTcH8JG80HJZKY\nHXtlY88a94IlL9KfLXAQ/esHJ9ZHmYt5vZPBnrvFGNoZAU4SrnPuVlcL+NhRU35h\ns/+RkG9j/CdmLENnnu4JgChqol7v/H1Yub9FFa3yo2aLxlUDz8r5tflNoBHL6luT\nsUMsCmQ2PsHnL9s9UvkWfySWiSF8A2qNP0KI8W+EXPpiFK44ng4NbraGB8VTeEO/\ndRjHw9Rbrp8umk+NIhQITBWCSGTVp5uEjtT0pn+bsRDfXp/TskVsjCNYViZd7ZHd\ndyeLr+bIIYmn3vRZLOApVHySCFFJvKmcmm2sCklkE9WQLylszCM=\n=jkbD\n-----END PGP SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/0a248708dc9d465db09168c39b3f12cb4c9465b7",
          "sha": "0a248708dc9d465db09168c39b3f12cb4c9465b7",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/0a248708dc9d465db09168c39b3f12cb4c9465b7"
        }
      ],
      "message": "indexes, refactor: Remove remaining CBlockIndex* uses in index Rewind methods\n\nMove ReadBlock code from CoinStatsIndex::CustomRewind to BaseIndex::Rewind\n\nMove ReadUndo code from CoinStatsIndex::ReverseBlock to BaseIndex::Rewind\n\nThis commit does change behavior slightly. Since the new CustomRemove\nmethods only take a single block at a time instead of a range of\ndisconnected blocks, when they call CopyHeightIndexToHashIndex they will\nnow do an index seek for each removed block instead of only seeking once\nto the height of the earliest removed block. Seeking instead of scanning\nis a little worse for performance if there is a >1 block reorg, but\nprobably not noticeable unless the reorg is very deep.",
      "committer": {
        "name": "furszy",
        "email": "matiasfurszyfer@protonmail.com",
        "date": "2025-06-10T16:57:15Z"
      },
      "author": {
        "name": "Ryan Ofsky",
        "email": "ryan@ofsky.org",
        "date": "2022-01-24T04:20:41Z"
      },
      "sha": "6f1392cc42cde638773f2b697d7d2c58abcdc860"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDRjNWVjM2E3MGE0Nzc5OGQ4NDUxZGE2NWM5YzAwNTk5NTVjZGU5Mzc",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/4c5ec3a70a47798d8451da65c9c0059955cde937",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/4c5ec3a70a47798d8451da65c9c0059955cde937",
      "tree": {
        "sha": "a3562d5d83e5f169ae9ddc75ea9527f916d31eae",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/a3562d5d83e5f169ae9ddc75ea9527f916d31eae"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree a3562d5d83e5f169ae9ddc75ea9527f916d31eae\nparent 6f1392cc42cde638773f2b697d7d2c58abcdc860\nauthor furszy <matiasfurszyfer@protonmail.com> 1676727564 -0300\ncommitter furszy <matiasfurszyfer@protonmail.com> 1749574684 -0400\n\nindex: remove CBlockIndex access from CustomAppend()\n\nMoved CBlockUndo disk read lookups from child index classes to\nthe base index class.\n\nThe goal is for child index classes to synchronize only through\nevents, without directly accessing the chain database.\n\nThis change will enable future parallel synchronization mechanisms,\nreduce database access (when batched), and contribute toward the\ngoal of running indexes in a separate process (with no chain\ndatabase access).\n\nBesides that, this commit also documents how NextSyncBlock() behaves.\nIt is not immediately clear this function could return the first\nblock after the fork point during a reorg.\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEEA++0fqwRHQpmlZfQXdI8zGhqpiMFAmhIZBwACgkQXdI8zGhq\npiMRlRAAnBL4o3ZOBDELWo18NdyDCvFncwWc9KYdkp4rA69wDK9PwcNb6xnS3yAD\n1IsXPJ3AU/iYd6pbUc9etjXfV3qIvISV7U/z/8ZHSQi3gGPCHn6VXp/y4W3DP2eO\nsqtFSv89U7w+XdTpdmiuCRV+d+bO01NYb4E2B64FABIOZFms2khVgyziGaStk+lO\ntRk9DD854NPmAiqIn+9LtgRiZOk6zYunxhqqnawduzFdUV8PYIRCs2XdH7E/LuHG\n1psU6RVDVlT0sxO0OvJN639vqp1UMe2MAf4LrVwcOGj79JEvGX5tMc83mutaxSnt\nUptwq4nKCysUJD6ChE907BJfIlfaqwLJ8CtNiWMxsdD2/NTPBkhVkSmR4ObxvLrE\nVFLAow7WbcT4+hPCBYq86w0gedijdNILjSIBXdpTkEgdpYva3Me/Z3SY5riebKOS\nVGknR7BWI7yOr/gcC1ubqEOdED6Wz/GbEqv1Mdhs8GDxtA2JELsxkwhrA4TGmC1D\nvPLc+3LRfuHWElLfYWdINj04xFdjrOySOXHXYGypVqYEwXZxtwOMvikPCO5Ncd+u\nkJlG6Z4mnPPnEUXhJb8i78dgjcO0ILbf2h3/95vmk7Gn+eIYJRiGWEWXR5BaBjzM\nH/c14bUNmbcOo04xH/+PNTatF8Y0deaeXixnoqCEQidk2Ef5NxU=\n=6POZ\n-----END PGP SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/6f1392cc42cde638773f2b697d7d2c58abcdc860",
          "sha": "6f1392cc42cde638773f2b697d7d2c58abcdc860",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/6f1392cc42cde638773f2b697d7d2c58abcdc860"
        }
      ],
      "message": "index: remove CBlockIndex access from CustomAppend()\n\nMoved CBlockUndo disk read lookups from child index classes to\nthe base index class.\n\nThe goal is for child index classes to synchronize only through\nevents, without directly accessing the chain database.\n\nThis change will enable future parallel synchronization mechanisms,\nreduce database access (when batched), and contribute toward the\ngoal of running indexes in a separate process (with no chain\ndatabase access).\n\nBesides that, this commit also documents how NextSyncBlock() behaves.\nIt is not immediately clear this function could return the first\nblock after the fork point during a reorg.",
      "committer": {
        "name": "furszy",
        "email": "matiasfurszyfer@protonmail.com",
        "date": "2025-06-10T16:58:04Z"
      },
      "author": {
        "name": "furszy",
        "email": "matiasfurszyfer@protonmail.com",
        "date": "2023-02-18T13:39:24Z"
      },
      "sha": "4c5ec3a70a47798d8451da65c9c0059955cde937"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 18079520995,
      "node_id": "HRFPE_lADOABII5866UC3QzwAAAAQ1n5jj",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/18079520995",
      "actor": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": "4c5ec3a70a47798d8451da65c9c0059955cde937",
      "commit_url": "https://api.github.com/repos/furszy/bitcoin-core/commits/4c5ec3a70a47798d8451da65c9c0059955cde937",
      "created_at": "2025-06-10T16:58:15Z"
    }
  ],
  "comments": [
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2137685544",
      "pull_request_review_id": 2913210912,
      "id": 2137685544,
      "node_id": "PRRC_kwDOABII585_an4o",
      "diff_hunk": "@@ -143,10 +142,7 @@ BOOST_FIXTURE_TEST_CASE(blockfilter_index_initial_sync, BuildChainTestingSetup)\n     // BlockUntilSyncedToCurrentChain should return false before index is started.\n     BOOST_CHECK(!filter_index.BlockUntilSyncedToCurrentChain());\n \n-    BOOST_REQUIRE(filter_index.StartBackgroundSync());",
      "path": "src/test/blockfilter_index_tests.cpp",
      "position": 12,
      "original_position": 12,
      "commit_id": "4c5ec3a70a47798d8451da65c9c0059955cde937",
      "original_commit_id": "331a25cb16632042dd6782a9b62fcc5c8aa6da3b",
      "in_reply_to_id": null,
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "In commit \"test: indexes, avoid creating threads when sync runs synchronously\" (331a25cb16632042dd6782a9b62fcc5c8aa6da3b)\r\n\r\nMotivation for this commit seems unclear. It seems to initialize indexes in unit tests differently than they are initialized in the node and reduce test coverage a little. Maybe commit message can be updated to mention reasons for wanting to do this?",
      "created_at": "2025-06-10T11:53:43Z",
      "updated_at": "2025-06-10T12:55:17Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32694#discussion_r2137685544",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2137685544"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/32694"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 146,
      "original_line": 146,
      "side": "LEFT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2137710074",
      "pull_request_review_id": 2913210912,
      "id": 2137710074,
      "node_id": "PRRC_kwDOABII585_at36",
      "diff_hunk": "@@ -130,6 +130,12 @@ bool BaseIndex::Init()\n     return true;\n }\n \n+// Returns the next block to process during initial sync.\n+// Possible return values:\n+// 1) The genesis block if pindex_prev=nullptr\n+// 2) The next block after pindex_prev, if pindex_prev is on the active chain (null if it reached the tip).\n+// 3) The block immediately following the fork point between pindex_prev and the active chain,\n+//    if pindex_prev is not part of the active chain -> the caller must perform a rewind if this happens.",
      "path": "src/index/base.cpp",
      "position": null,
      "original_position": 9,
      "commit_id": "4c5ec3a70a47798d8451da65c9c0059955cde937",
      "original_commit_id": "c0bd2c5a8a9057ca62f66e456c6d8a5994d88431",
      "in_reply_to_id": null,
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "In commit \"test: indexes, avoid creating threads when sync runs synchronously\" (331a25cb16632042dd6782a9b62fcc5c8aa6da3b)\r\n\r\nThis seems ok but the description is now longer than the function is and it seems to repeat a number of uninteresting details about what the function is doing. Maybe consider dropping the function level comment and just adding a short comment above the findfork call on line 151 since that is the part that seems to be surprising. Something like \"Since block is not in the chain, return the next block in the chain \\*\\*after\\*\\* the last common ancestor. Caller will be responsible for rewinding back to the common ancestor.\"",
      "created_at": "2025-06-10T12:04:29Z",
      "updated_at": "2025-06-10T12:55:17Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32694#discussion_r2137710074",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2137710074"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/32694"
        }
      },
      "start_line": null,
      "original_start_line": 133,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 138,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2137763212",
      "pull_request_review_id": 2913210912,
      "id": 2137763212,
      "node_id": "PRRC_kwDOABII585_a62M",
      "diff_hunk": "@@ -343,17 +363,14 @@ void BaseIndex::BlockConnected(ChainstateRole role, const std::shared_ptr<const\n             return;\n         }\n     }\n-    interfaces::BlockInfo block_info = kernel::MakeBlockInfo(pindex, block.get());\n-    if (CustomAppend(block_info)) {\n+\n+    // Dispatch block to child class; errors are logged internally and abort the node.\n+    if (ProcessBlock(pindex)) {",
      "path": "src/index/base.cpp",
      "position": null,
      "original_position": 70,
      "commit_id": "4c5ec3a70a47798d8451da65c9c0059955cde937",
      "original_commit_id": "3f390efa313f4ac43e9134d5299d7faec74cca60",
      "in_reply_to_id": null,
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "In commit \"index: remove CBlockIndex access from CustomAppend()\" (3f390efa313f4ac43e9134d5299d7faec74cca60)\r\n\r\nShould be `ProcessBlock(pindex, block.get())` to avoid rereading the block from disk?",
      "created_at": "2025-06-10T12:26:40Z",
      "updated_at": "2025-06-10T12:55:17Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32694#discussion_r2137763212",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2137763212"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/32694"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 368,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2137774461",
      "pull_request_review_id": 2913210912,
      "id": 2137774461,
      "node_id": "PRRC_kwDOABII585_a9l9",
      "diff_hunk": "@@ -120,12 +120,7 @@ bool CoinStatsIndex::CustomAppend(const interfaces::BlockInfo& block)\n \n     // Ignore genesis block\n     if (block.height > 0) {\n-        // pindex variable gives indexing code access to node internals. It\n-        // will be removed in upcoming commit\n-        const CBlockIndex* pindex = WITH_LOCK(cs_main, return m_chainstate->m_blockman.LookupBlockIndex(block.hash));\n-        if (!m_chainstate->m_blockman.ReadBlockUndo(block_undo, *pindex)) {\n-            return false;\n-        }\n+        block_undo = *Assert(block.undo_data);",
      "path": "src/index/coinstatsindex.cpp",
      "position": null,
      "original_position": 10,
      "commit_id": "4c5ec3a70a47798d8451da65c9c0059955cde937",
      "original_commit_id": "3f390efa313f4ac43e9134d5299d7faec74cca60",
      "in_reply_to_id": null,
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "In commit \"index: remove CBlockIndex access from CustomAppend()\" (3f390efa313f4ac43e9134d5299d7faec74cca60)\r\n\r\nIt's a bit inefficient to copy the undo data here, and the code seems overcomplicated because the `block_undo` variable is only referenced once, 60 lines below. Would suggest dropping the `block_undo` variable and just accessing `block.undo_data` directly below.\r\n\r\nThe `block_undo` variable in BlockFilterIndex::CustomAppend could also go away to simplify that function.",
      "created_at": "2025-06-10T12:32:17Z",
      "updated_at": "2025-06-10T12:55:17Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32694#discussion_r2137774461",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2137774461"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/32694"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 123,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2137793161",
      "pull_request_review_id": 2913396907,
      "id": 2137793161,
      "node_id": "PRRC_kwDOABII585_bCKJ",
      "diff_hunk": "@@ -153,6 +153,39 @@ static const CBlockIndex* NextSyncBlock(const CBlockIndex* pindex_prev, CChain&\n     return chain.Next(chain.FindFork(pindex_prev));\n }\n \n+bool BaseIndex::ProcessBlock(const CBlockIndex* pindex, const CBlock* block_data)\n+{\n+    interfaces::BlockInfo block_info = kernel::MakeBlockInfo(pindex, block_data);\n+\n+    CBlock block;",
      "path": "src/index/base.cpp",
      "position": 21,
      "original_position": 8,
      "commit_id": "4c5ec3a70a47798d8451da65c9c0059955cde937",
      "original_commit_id": "3f390efa313f4ac43e9134d5299d7faec74cca60",
      "in_reply_to_id": null,
      "user": {
        "login": "TheCharlatan",
        "id": 8421793,
        "node_id": "MDQ6VXNlcjg0MjE3OTM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8421793?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/TheCharlatan",
        "html_url": "https://github.com/TheCharlatan",
        "followers_url": "https://api.github.com/users/TheCharlatan/followers",
        "following_url": "https://api.github.com/users/TheCharlatan/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/TheCharlatan/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/TheCharlatan/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/TheCharlatan/subscriptions",
        "organizations_url": "https://api.github.com/users/TheCharlatan/orgs",
        "repos_url": "https://api.github.com/users/TheCharlatan/repos",
        "events_url": "https://api.github.com/users/TheCharlatan/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/TheCharlatan/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "Nit: There is no reason to declare this (and CBlockUndo)  outside the if statement, right?",
      "created_at": "2025-06-10T12:40:57Z",
      "updated_at": "2025-06-10T13:39:08Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32694#discussion_r2137793161",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2137793161"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/32694"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 156,
      "original_line": 156,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2138145261",
      "pull_request_review_id": 2913699334,
      "id": 2138145261,
      "node_id": "PRRC_kwDOABII585_cYHt",
      "diff_hunk": "@@ -343,17 +363,14 @@ void BaseIndex::BlockConnected(ChainstateRole role, const std::shared_ptr<const\n             return;\n         }\n     }\n-    interfaces::BlockInfo block_info = kernel::MakeBlockInfo(pindex, block.get());\n-    if (CustomAppend(block_info)) {\n+\n+    // Dispatch block to child class; errors are logged internally and abort the node.\n+    if (ProcessBlock(pindex)) {",
      "path": "src/index/base.cpp",
      "position": null,
      "original_position": 70,
      "commit_id": "4c5ec3a70a47798d8451da65c9c0059955cde937",
      "original_commit_id": "3f390efa313f4ac43e9134d5299d7faec74cca60",
      "in_reply_to_id": 2137763212,
      "user": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "> Should be ProcessBlock(pindex, block.get()) to avoid rereading the block from disk?\r\n\r\nupps, yes!",
      "created_at": "2025-06-10T15:02:25Z",
      "updated_at": "2025-06-10T16:52:48Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32694#discussion_r2138145261",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2138145261"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/32694"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 368,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2138165793",
      "pull_request_review_id": 2913699334,
      "id": 2138165793,
      "node_id": "PRRC_kwDOABII585_cdIh",
      "diff_hunk": "@@ -153,6 +153,39 @@ static const CBlockIndex* NextSyncBlock(const CBlockIndex* pindex_prev, CChain&\n     return chain.Next(chain.FindFork(pindex_prev));\n }\n \n+bool BaseIndex::ProcessBlock(const CBlockIndex* pindex, const CBlock* block_data)\n+{\n+    interfaces::BlockInfo block_info = kernel::MakeBlockInfo(pindex, block_data);\n+\n+    CBlock block;",
      "path": "src/index/base.cpp",
      "position": 21,
      "original_position": 8,
      "commit_id": "4c5ec3a70a47798d8451da65c9c0059955cde937",
      "original_commit_id": "3f390efa313f4ac43e9134d5299d7faec74cca60",
      "in_reply_to_id": 2137793161,
      "user": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "> Nit: There is no reason to declare this (and CBlockUndo) outside the if statement, right?\r\n\r\nThereâ€™s actually a slightly important reason for that. If the object is declared inside the if-block, it will be destructed when going out of scope. This would leave null pointers in the `BlockInfo` struct that we provide to child classes.",
      "created_at": "2025-06-10T15:12:11Z",
      "updated_at": "2025-06-10T16:52:48Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32694#discussion_r2138165793",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2138165793"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/32694"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 156,
      "original_line": 156,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2138167718",
      "pull_request_review_id": 2913699334,
      "id": 2138167718,
      "node_id": "PRRC_kwDOABII585_cdmm",
      "diff_hunk": "@@ -120,12 +120,7 @@ bool CoinStatsIndex::CustomAppend(const interfaces::BlockInfo& block)\n \n     // Ignore genesis block\n     if (block.height > 0) {\n-        // pindex variable gives indexing code access to node internals. It\n-        // will be removed in upcoming commit\n-        const CBlockIndex* pindex = WITH_LOCK(cs_main, return m_chainstate->m_blockman.LookupBlockIndex(block.hash));\n-        if (!m_chainstate->m_blockman.ReadBlockUndo(block_undo, *pindex)) {\n-            return false;\n-        }\n+        block_undo = *Assert(block.undo_data);",
      "path": "src/index/coinstatsindex.cpp",
      "position": null,
      "original_position": 10,
      "commit_id": "4c5ec3a70a47798d8451da65c9c0059955cde937",
      "original_commit_id": "3f390efa313f4ac43e9134d5299d7faec74cca60",
      "in_reply_to_id": 2137774461,
      "user": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "> In commit \"index: remove CBlockIndex access from CustomAppend()\" ([3f390ef](https://github.com/bitcoin/bitcoin/commit/3f390efa313f4ac43e9134d5299d7faec74cca60))\r\n> \r\n> It's a bit inefficient to copy the undo data here, and the code seems overcomplicated because the `block_undo` variable is only referenced once, 60 lines below. Would suggest dropping the `block_undo` variable and just accessing `block.undo_data` directly below.\r\n> \r\n> The `block_undo` variable in BlockFilterIndex::CustomAppend could also go away to simplify that function.\r\n\r\nDone as suggested. Thanks!",
      "created_at": "2025-06-10T15:13:08Z",
      "updated_at": "2025-06-10T16:52:48Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32694#discussion_r2138167718",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2138167718"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/32694"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 123,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2138224678",
      "pull_request_review_id": 2913699334,
      "id": 2138224678,
      "node_id": "PRRC_kwDOABII585_crgm",
      "diff_hunk": "@@ -143,10 +142,7 @@ BOOST_FIXTURE_TEST_CASE(blockfilter_index_initial_sync, BuildChainTestingSetup)\n     // BlockUntilSyncedToCurrentChain should return false before index is started.\n     BOOST_CHECK(!filter_index.BlockUntilSyncedToCurrentChain());\n \n-    BOOST_REQUIRE(filter_index.StartBackgroundSync());",
      "path": "src/test/blockfilter_index_tests.cpp",
      "position": 12,
      "original_position": 12,
      "commit_id": "4c5ec3a70a47798d8451da65c9c0059955cde937",
      "original_commit_id": "331a25cb16632042dd6782a9b62fcc5c8aa6da3b",
      "in_reply_to_id": 2137685544,
      "user": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "> In commit \"test: indexes, avoid creating threads when sync runs synchronously\" ([331a25c](https://github.com/bitcoin/bitcoin/commit/331a25cb16632042dd6782a9b62fcc5c8aa6da3b))\r\n> \r\n> Motivation for this commit seems unclear. It seems to initialize indexes in unit tests differently than they are initialized in the node and reduce test coverage a little. Maybe commit message can be updated to mention reasons for wanting to do this?\r\n\r\n\r\nHaving unit tests waiting for secondary thread creation seemed odd to me; especially since these tests are meant to only run and verify the initial index synchronization output once (once the initial sync is completed, they sync new blocks only via block connection signals). Apart from that, the functionality should already be covered by the functional tests.\r\n\r\nThat being said, we could drop it too if preferred. I think I just dislike having the thread inside the index class.",
      "created_at": "2025-06-10T15:33:09Z",
      "updated_at": "2025-06-10T16:52:48Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32694#discussion_r2138224678",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2138224678"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/32694"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 146,
      "original_line": 146,
      "side": "LEFT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2138367736",
      "pull_request_review_id": 2913699334,
      "id": 2138367736,
      "node_id": "PRRC_kwDOABII585_dOb4",
      "diff_hunk": "@@ -130,6 +130,12 @@ bool BaseIndex::Init()\n     return true;\n }\n \n+// Returns the next block to process during initial sync.\n+// Possible return values:\n+// 1) The genesis block if pindex_prev=nullptr\n+// 2) The next block after pindex_prev, if pindex_prev is on the active chain (null if it reached the tip).\n+// 3) The block immediately following the fork point between pindex_prev and the active chain,\n+//    if pindex_prev is not part of the active chain -> the caller must perform a rewind if this happens.",
      "path": "src/index/base.cpp",
      "position": null,
      "original_position": 9,
      "commit_id": "4c5ec3a70a47798d8451da65c9c0059955cde937",
      "original_commit_id": "c0bd2c5a8a9057ca62f66e456c6d8a5994d88431",
      "in_reply_to_id": 2137710074,
      "user": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "Done as suggested. Ended up squashing the commit inside the last one.",
      "created_at": "2025-06-10T16:52:34Z",
      "updated_at": "2025-06-10T16:58:37Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32694#discussion_r2138367736",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2138367736"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/32694"
        }
      },
      "start_line": null,
      "original_start_line": 133,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 138,
      "side": "RIGHT"
    }
  ]
}
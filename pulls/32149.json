{
  "type": "pull",
  "pull": {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/32149",
    "id": 2420945586,
    "node_id": "PR_kwDOABII586QTLKy",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/32149",
    "diff_url": "https://github.com/bitcoin/bitcoin/pull/32149.diff",
    "patch_url": "https://github.com/bitcoin/bitcoin/pull/32149.patch",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/32149",
    "commits_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/32149/commits",
    "review_comments_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/32149/comments",
    "review_comment_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments%7B/number%7D",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/32149/comments",
    "statuses_url": "https://api.github.com/repos/bitcoin/bitcoin/statuses/c5b28782e58e0a4cb4eafe2e0330de60f63f39b1",
    "number": 32149,
    "state": "open",
    "locked": false,
    "maintainer_can_modify": true,
    "title": "wallet, migration: Fix empty wallet crash",
    "user": {
      "login": "pablomartin4btc",
      "id": 110166421,
      "node_id": "U_kgDOBpEBlQ",
      "avatar_url": "https://avatars.githubusercontent.com/u/110166421?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/pablomartin4btc",
      "html_url": "https://github.com/pablomartin4btc",
      "followers_url": "https://api.github.com/users/pablomartin4btc/followers",
      "following_url": "https://api.github.com/users/pablomartin4btc/following%7B/other_user%7D",
      "gists_url": "https://api.github.com/users/pablomartin4btc/gists%7B/gist_id%7D",
      "starred_url": "https://api.github.com/users/pablomartin4btc/starred%7B/owner%7D%7B/repo%7D",
      "subscriptions_url": "https://api.github.com/users/pablomartin4btc/subscriptions",
      "organizations_url": "https://api.github.com/users/pablomartin4btc/orgs",
      "repos_url": "https://api.github.com/users/pablomartin4btc/repos",
      "events_url": "https://api.github.com/users/pablomartin4btc/events%7B/privacy%7D",
      "received_events_url": "https://api.github.com/users/pablomartin4btc/received_events",
      "type": "User",
      "site_admin": false,
      "patch_url": null
    },
    "body": "Same as with a blank wallet (#28976), wallets with no legacy records (i.e. empty, non-blank, watch-only wallet) do not require to be migrated.\r\n\r\nSteps to reproduce the issue:\r\n\r\n1.- `createwallet \"empty_wo_noblank_legacy_wallet\" true false \"\" false false`\r\n2.- `migratewallet`\r\n\r\n```\r\nwallet/wallet.cpp:4071 GetDescriptorsForLegacy: Assertion `legacy_spkm' failed.\r\nAborted (core dumped)\r\n```",
    "labels": [
      {
        "id": 149424,
        "node_id": "MDU6TGFiZWwxNDk0MjQ=",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Wallet",
        "name": "Wallet",
        "color": "08a781",
        "default": false
      }
    ],
    "created_at": "2025-03-27T02:32:08Z",
    "updated_at": "2025-03-28T16:28:45Z",
    "mergeable": true,
    "mergeable_state": "blocked",
    "merged": false,
    "merge_commit_sha": "265347741f29ea0c1e26240ca46ba42061130825",
    "assignees": [],
    "requested_reviewers": [],
    "requested_teams": [],
    "rebaseable": true,
    "head": {
      "label": "pablomartin4btc:wallet-migration-empty-wallet-crash-fix",
      "ref": "wallet-migration-empty-wallet-crash-fix",
      "sha": "c5b28782e58e0a4cb4eafe2e0330de60f63f39b1",
      "user": {
        "login": "pablomartin4btc",
        "id": 110166421,
        "node_id": "U_kgDOBpEBlQ",
        "avatar_url": "https://avatars.githubusercontent.com/u/110166421?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/pablomartin4btc",
        "html_url": "https://github.com/pablomartin4btc",
        "followers_url": "https://api.github.com/users/pablomartin4btc/followers",
        "following_url": "https://api.github.com/users/pablomartin4btc/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/pablomartin4btc/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/pablomartin4btc/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/pablomartin4btc/subscriptions",
        "organizations_url": "https://api.github.com/users/pablomartin4btc/orgs",
        "repos_url": "https://api.github.com/users/pablomartin4btc/repos",
        "events_url": "https://api.github.com/users/pablomartin4btc/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/pablomartin4btc/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "repo": {
        "id": 519258839,
        "node_id": "R_kgDOHvNC1w",
        "name": "bitcoin",
        "full_name": "pablomartin4btc/bitcoin",
        "owner": {
          "login": "pablomartin4btc",
          "id": 110166421,
          "node_id": "U_kgDOBpEBlQ",
          "avatar_url": "https://avatars.githubusercontent.com/u/110166421?v=4",
          "gravatar_id": "",
          "url": "https://api.github.com/users/pablomartin4btc",
          "html_url": "https://github.com/pablomartin4btc",
          "followers_url": "https://api.github.com/users/pablomartin4btc/followers",
          "following_url": "https://api.github.com/users/pablomartin4btc/following%7B/other_user%7D",
          "gists_url": "https://api.github.com/users/pablomartin4btc/gists%7B/gist_id%7D",
          "starred_url": "https://api.github.com/users/pablomartin4btc/starred%7B/owner%7D%7B/repo%7D",
          "subscriptions_url": "https://api.github.com/users/pablomartin4btc/subscriptions",
          "organizations_url": "https://api.github.com/users/pablomartin4btc/orgs",
          "repos_url": "https://api.github.com/users/pablomartin4btc/repos",
          "events_url": "https://api.github.com/users/pablomartin4btc/events%7B/privacy%7D",
          "received_events_url": "https://api.github.com/users/pablomartin4btc/received_events",
          "type": "User",
          "site_admin": false,
          "patch_url": null
        },
        "private": false,
        "html_url": "https://github.com/pablomartin4btc/bitcoin",
        "description": "Bitcoin Core integration/staging tree",
        "fork": true,
        "url": "https://api.github.com/repos/pablomartin4btc/bitcoin",
        "archive_url": "https://api.github.com/repos/pablomartin4btc/bitcoin/%7Barchive_format%7D%7B/ref%7D",
        "assignees_url": "https://api.github.com/repos/pablomartin4btc/bitcoin/assignees%7B/user%7D",
        "blobs_url": "https://api.github.com/repos/pablomartin4btc/bitcoin/git/blobs%7B/sha%7D",
        "branches_url": "https://api.github.com/repos/pablomartin4btc/bitcoin/branches%7B/branch%7D",
        "collaborators_url": "https://api.github.com/repos/pablomartin4btc/bitcoin/collaborators%7B/collaborator%7D",
        "comments_url": "https://api.github.com/repos/pablomartin4btc/bitcoin/comments%7B/number%7D",
        "commits_url": "https://api.github.com/repos/pablomartin4btc/bitcoin/commits%7B/sha%7D",
        "compare_url": "https://api.github.com/repos/pablomartin4btc/bitcoin/compare/%7Bbase%7D...%7Bhead%7D",
        "contents_url": "https://api.github.com/repos/pablomartin4btc/bitcoin/contents/%7B+path%7D",
        "contributors_url": "https://api.github.com/repos/pablomartin4btc/bitcoin/contributors",
        "deployments_url": "https://api.github.com/repos/pablomartin4btc/bitcoin/deployments",
        "downloads_url": "https://api.github.com/repos/pablomartin4btc/bitcoin/downloads",
        "events_url": "https://api.github.com/repos/pablomartin4btc/bitcoin/events",
        "forks_url": "https://api.github.com/repos/pablomartin4btc/bitcoin/forks",
        "git_commits_url": "https://api.github.com/repos/pablomartin4btc/bitcoin/git/commits%7B/sha%7D",
        "git_refs_url": "https://api.github.com/repos/pablomartin4btc/bitcoin/git/refs%7B/sha%7D",
        "git_tags_url": "https://api.github.com/repos/pablomartin4btc/bitcoin/git/tags%7B/sha%7D",
        "git_url": "git://github.com/pablomartin4btc/bitcoin.git",
        "issue_comment_url": "https://api.github.com/repos/pablomartin4btc/bitcoin/issues/comments%7B/number%7D",
        "issue_events_url": "https://api.github.com/repos/pablomartin4btc/bitcoin/issues/events%7B/number%7D",
        "issues_url": "https://api.github.com/repos/pablomartin4btc/bitcoin/issues%7B/number%7D",
        "keys_url": "https://api.github.com/repos/pablomartin4btc/bitcoin/keys%7B/key_id%7D",
        "labels_url": "https://api.github.com/repos/pablomartin4btc/bitcoin/labels%7B/name%7D",
        "languages_url": "https://api.github.com/repos/pablomartin4btc/bitcoin/languages",
        "merges_url": "https://api.github.com/repos/pablomartin4btc/bitcoin/merges",
        "milestones_url": "https://api.github.com/repos/pablomartin4btc/bitcoin/milestones%7B/number%7D",
        "notifications_url": "https://api.github.com/repos/pablomartin4btc/bitcoin/notifications%7B?since,all,participating}",
        "pulls_url": "https://api.github.com/repos/pablomartin4btc/bitcoin/pulls%7B/number%7D",
        "releases_url": "https://api.github.com/repos/pablomartin4btc/bitcoin/releases%7B/id%7D",
        "ssh_url": "git@github.com:pablomartin4btc/bitcoin.git",
        "stargazers_url": "https://api.github.com/repos/pablomartin4btc/bitcoin/stargazers",
        "statuses_url": "https://api.github.com/repos/pablomartin4btc/bitcoin/statuses/%7Bsha%7D",
        "subscribers_url": "https://api.github.com/repos/pablomartin4btc/bitcoin/subscribers",
        "subscription_url": "https://api.github.com/repos/pablomartin4btc/bitcoin/subscription",
        "tags_url": "https://api.github.com/repos/pablomartin4btc/bitcoin/tags",
        "teams_url": "https://api.github.com/repos/pablomartin4btc/bitcoin/teams",
        "trees_url": "https://api.github.com/repos/pablomartin4btc/bitcoin/git/trees%7B/sha%7D",
        "clone_url": "https://github.com/pablomartin4btc/bitcoin.git",
        "hooks_url": "https://api.github.com/repos/pablomartin4btc/bitcoin/hooks",
        "svn_url": "https://github.com/pablomartin4btc/bitcoin",
        "homepage": "https://bitcoincore.org/en/download",
        "language": "C++",
        "forks_count": 0,
        "stargazers_count": 1,
        "watchers_count": 1,
        "size": 237491,
        "default_branch": "master",
        "open_issues_count": 0,
        "is_template": false,
        "topics": [],
        "has_issues": false,
        "has_projects": true,
        "has_wiki": false,
        "has_pages": false,
        "has_downloads": false,
        "archived": false,
        "disabled": false,
        "visibility": "public",
        "pushed_at": "2025-03-28T16:28:15Z",
        "created_at": "2022-07-29T15:13:24Z",
        "updated_at": "2025-03-28T16:26:14Z",
        "allow_forking": true,
        "license": {
          "key": "mit",
          "name": "MIT License",
          "node_id": "MDc6TGljZW5zZTEz",
          "spdx_id": "MIT",
          "url": "https://api.github.com/licenses/mit",
          "html_url": null,
          "description": null,
          "implementation": null,
          "permissions": null,
          "conditions": null,
          "limitations": null,
          "body": null,
          "featured": null
        }
      }
    },
    "base": {
      "label": "bitcoin:master",
      "ref": "master",
      "sha": "9acc25bcb674c05702d14b65487caeafa5ad549b",
      "user": {
        "login": "bitcoin",
        "id": 528860,
        "node_id": "MDEyOk9yZ2FuaXphdGlvbjUyODg2MA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/528860?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/bitcoin",
        "html_url": "https://github.com/bitcoin",
        "followers_url": "https://api.github.com/users/bitcoin/followers",
        "following_url": "https://api.github.com/users/bitcoin/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/bitcoin/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/bitcoin/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/bitcoin/subscriptions",
        "organizations_url": "https://api.github.com/users/bitcoin/orgs",
        "repos_url": "https://api.github.com/users/bitcoin/repos",
        "events_url": "https://api.github.com/users/bitcoin/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/bitcoin/received_events",
        "type": "Organization",
        "site_admin": false,
        "patch_url": null
      },
      "repo": {
        "id": 1181927,
        "node_id": "MDEwOlJlcG9zaXRvcnkxMTgxOTI3",
        "name": "bitcoin",
        "full_name": "bitcoin/bitcoin",
        "owner": {
          "login": "bitcoin",
          "id": 528860,
          "node_id": "MDEyOk9yZ2FuaXphdGlvbjUyODg2MA==",
          "avatar_url": "https://avatars.githubusercontent.com/u/528860?v=4",
          "gravatar_id": "",
          "url": "https://api.github.com/users/bitcoin",
          "html_url": "https://github.com/bitcoin",
          "followers_url": "https://api.github.com/users/bitcoin/followers",
          "following_url": "https://api.github.com/users/bitcoin/following%7B/other_user%7D",
          "gists_url": "https://api.github.com/users/bitcoin/gists%7B/gist_id%7D",
          "starred_url": "https://api.github.com/users/bitcoin/starred%7B/owner%7D%7B/repo%7D",
          "subscriptions_url": "https://api.github.com/users/bitcoin/subscriptions",
          "organizations_url": "https://api.github.com/users/bitcoin/orgs",
          "repos_url": "https://api.github.com/users/bitcoin/repos",
          "events_url": "https://api.github.com/users/bitcoin/events%7B/privacy%7D",
          "received_events_url": "https://api.github.com/users/bitcoin/received_events",
          "type": "Organization",
          "site_admin": false,
          "patch_url": null
        },
        "private": false,
        "html_url": "https://github.com/bitcoin/bitcoin",
        "description": "Bitcoin Core integration/staging tree",
        "fork": false,
        "url": "https://api.github.com/repos/bitcoin/bitcoin",
        "archive_url": "https://api.github.com/repos/bitcoin/bitcoin/%7Barchive_format%7D%7B/ref%7D",
        "assignees_url": "https://api.github.com/repos/bitcoin/bitcoin/assignees%7B/user%7D",
        "blobs_url": "https://api.github.com/repos/bitcoin/bitcoin/git/blobs%7B/sha%7D",
        "branches_url": "https://api.github.com/repos/bitcoin/bitcoin/branches%7B/branch%7D",
        "collaborators_url": "https://api.github.com/repos/bitcoin/bitcoin/collaborators%7B/collaborator%7D",
        "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/comments%7B/number%7D",
        "commits_url": "https://api.github.com/repos/bitcoin/bitcoin/commits%7B/sha%7D",
        "compare_url": "https://api.github.com/repos/bitcoin/bitcoin/compare/%7Bbase%7D...%7Bhead%7D",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/%7B+path%7D",
        "contributors_url": "https://api.github.com/repos/bitcoin/bitcoin/contributors",
        "deployments_url": "https://api.github.com/repos/bitcoin/bitcoin/deployments",
        "downloads_url": "https://api.github.com/repos/bitcoin/bitcoin/downloads",
        "events_url": "https://api.github.com/repos/bitcoin/bitcoin/events",
        "forks_url": "https://api.github.com/repos/bitcoin/bitcoin/forks",
        "git_commits_url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits%7B/sha%7D",
        "git_refs_url": "https://api.github.com/repos/bitcoin/bitcoin/git/refs%7B/sha%7D",
        "git_tags_url": "https://api.github.com/repos/bitcoin/bitcoin/git/tags%7B/sha%7D",
        "git_url": "git://github.com/bitcoin/bitcoin.git",
        "issue_comment_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments%7B/number%7D",
        "issue_events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events%7B/number%7D",
        "issues_url": "https://api.github.com/repos/bitcoin/bitcoin/issues%7B/number%7D",
        "keys_url": "https://api.github.com/repos/bitcoin/bitcoin/keys%7B/key_id%7D",
        "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/labels%7B/name%7D",
        "languages_url": "https://api.github.com/repos/bitcoin/bitcoin/languages",
        "merges_url": "https://api.github.com/repos/bitcoin/bitcoin/merges",
        "milestones_url": "https://api.github.com/repos/bitcoin/bitcoin/milestones%7B/number%7D",
        "notifications_url": "https://api.github.com/repos/bitcoin/bitcoin/notifications%7B?since,all,participating}",
        "pulls_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls%7B/number%7D",
        "releases_url": "https://api.github.com/repos/bitcoin/bitcoin/releases%7B/id%7D",
        "ssh_url": "git@github.com:bitcoin/bitcoin.git",
        "stargazers_url": "https://api.github.com/repos/bitcoin/bitcoin/stargazers",
        "statuses_url": "https://api.github.com/repos/bitcoin/bitcoin/statuses/%7Bsha%7D",
        "subscribers_url": "https://api.github.com/repos/bitcoin/bitcoin/subscribers",
        "subscription_url": "https://api.github.com/repos/bitcoin/bitcoin/subscription",
        "tags_url": "https://api.github.com/repos/bitcoin/bitcoin/tags",
        "teams_url": "https://api.github.com/repos/bitcoin/bitcoin/teams",
        "trees_url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees%7B/sha%7D",
        "clone_url": "https://github.com/bitcoin/bitcoin.git",
        "hooks_url": "https://api.github.com/repos/bitcoin/bitcoin/hooks",
        "svn_url": "https://github.com/bitcoin/bitcoin",
        "homepage": "https://bitcoincore.org/en/download",
        "language": "C++",
        "forks_count": 36969,
        "stargazers_count": 82668,
        "watchers_count": 82668,
        "size": 278953,
        "default_branch": "master",
        "open_issues_count": 686,
        "is_template": false,
        "topics": [
          "bitcoin",
          "c-plus-plus",
          "cryptocurrency",
          "cryptography",
          "p2p"
        ],
        "has_issues": true,
        "has_projects": true,
        "has_wiki": false,
        "has_pages": false,
        "has_downloads": false,
        "archived": false,
        "disabled": false,
        "visibility": "public",
        "pushed_at": "2025-03-28T15:14:43Z",
        "created_at": "2010-12-19T15:16:43Z",
        "updated_at": "2025-03-28T15:44:55Z",
        "allow_forking": true,
        "license": {
          "key": "mit",
          "name": "MIT License",
          "node_id": "MDc6TGljZW5zZTEz",
          "spdx_id": "MIT",
          "url": "https://api.github.com/licenses/mit",
          "html_url": null,
          "description": null,
          "implementation": null,
          "permissions": null,
          "conditions": null,
          "limitations": null,
          "body": null,
          "featured": null
        }
      }
    },
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/32149"
      }
    },
    "author_association": "MEMBER",
    "draft": false,
    "additions": 55,
    "deletions": 21,
    "changed_files": 5,
    "commits": 2,
    "review_comments": 14,
    "comments": 3
  },
  "events": [
    {
      "event": "commented",
      "id": 2756303351,
      "node_id": "IC_kwDOABII586kSdn3",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2756303351",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-03-27T02:32:12Z",
      "updated_at": "2025-03-27T07:41:48Z",
      "author_association": "CONTRIBUTOR",
      "body": "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--006a51241073e994b41acfe9ec718e94-->\n### Code Coverage & Benchmarks\nFor details see: https://corecheck.dev/bitcoin/bitcoin/pulls/32149.\n<!--021abf342d371248e50ceaed478a90ca-->\n### Reviews\nSee [the guideline](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#code-review) for information on the review process.\nA summary of reviews will appear here.\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* [#30343](https://github.com/bitcoin/bitcoin/pull/30343) (wallet, logging: Replace WalletLogPrintf() with LogInfo() by ryanofsky)\n* [#29124](https://github.com/bitcoin/bitcoin/pull/29124) (wallet: Automatically repair corrupted metadata with doubled derivation path by achow101)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.\n",
      "user": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32149#issuecomment-2756303351",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/32149"
    },
    {
      "event": "labeled",
      "id": 17009095630,
      "node_id": "LE_lADOABII586v6URNzwAAAAP10jPO",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/17009095630",
      "actor": {
        "login": "laanwj",
        "id": 126646,
        "node_id": "MDQ6VXNlcjEyNjY0Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/126646?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/laanwj",
        "html_url": "https://github.com/laanwj",
        "followers_url": "https://api.github.com/users/laanwj/followers",
        "following_url": "https://api.github.com/users/laanwj/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/laanwj/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/laanwj/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
        "organizations_url": "https://api.github.com/users/laanwj/orgs",
        "repos_url": "https://api.github.com/users/laanwj/repos",
        "events_url": "https://api.github.com/users/laanwj/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/laanwj/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-03-27T09:40:45Z",
      "label": {
        "name": "Wallet",
        "color": "08a781"
      }
    },
    {
      "event": "reviewed",
      "id": 2721679868,
      "node_id": "PRR_kwDOABII586iOYn8",
      "url": null,
      "actor": null,
      "commit_id": "9962614b9060e9713042de91dc04ff5ea6604ae1",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "user": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32149#pullrequestreview-2721679868",
      "submitted_at": "2025-03-27T14:20:09Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/32149"
    },
    {
      "event": "reviewed",
      "id": 2722034324,
      "node_id": "PRR_kwDOABII586iPvKU",
      "url": null,
      "actor": null,
      "commit_id": "9962614b9060e9713042de91dc04ff5ea6604ae1",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "body": "added another suggestion",
      "user": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32149#pullrequestreview-2722034324",
      "submitted_at": "2025-03-27T14:51:12Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/32149"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 17017108847,
      "node_id": "HRFPE_lADOABII586v6URNzwAAAAP2THlv",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/17017108847",
      "actor": {
        "login": "pablomartin4btc",
        "id": 110166421,
        "node_id": "U_kgDOBpEBlQ",
        "avatar_url": "https://avatars.githubusercontent.com/u/110166421?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/pablomartin4btc",
        "html_url": "https://github.com/pablomartin4btc",
        "followers_url": "https://api.github.com/users/pablomartin4btc/followers",
        "following_url": "https://api.github.com/users/pablomartin4btc/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/pablomartin4btc/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/pablomartin4btc/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/pablomartin4btc/subscriptions",
        "organizations_url": "https://api.github.com/users/pablomartin4btc/orgs",
        "repos_url": "https://api.github.com/users/pablomartin4btc/repos",
        "events_url": "https://api.github.com/users/pablomartin4btc/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/pablomartin4btc/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": "6adb2aaa33a93aed323bc9a7c4eac1857979aa5d",
      "commit_url": "https://api.github.com/repos/pablomartin4btc/bitcoin/commits/6adb2aaa33a93aed323bc9a7c4eac1857979aa5d",
      "created_at": "2025-03-27T16:09:28Z"
    },
    {
      "event": "labeled",
      "id": 17017760778,
      "node_id": "LE_lADOABII586v6URNzwAAAAP2VmwK",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/17017760778",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-03-27T16:42:48Z",
      "label": {
        "name": "CI failed",
        "color": "cccccc"
      }
    },
    {
      "event": "head_ref_force_pushed",
      "id": 17018110537,
      "node_id": "HRFPE_lADOABII586v6URNzwAAAAP2W8JJ",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/17018110537",
      "actor": {
        "login": "pablomartin4btc",
        "id": 110166421,
        "node_id": "U_kgDOBpEBlQ",
        "avatar_url": "https://avatars.githubusercontent.com/u/110166421?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/pablomartin4btc",
        "html_url": "https://github.com/pablomartin4btc",
        "followers_url": "https://api.github.com/users/pablomartin4btc/followers",
        "following_url": "https://api.github.com/users/pablomartin4btc/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/pablomartin4btc/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/pablomartin4btc/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/pablomartin4btc/subscriptions",
        "organizations_url": "https://api.github.com/users/pablomartin4btc/orgs",
        "repos_url": "https://api.github.com/users/pablomartin4btc/repos",
        "events_url": "https://api.github.com/users/pablomartin4btc/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/pablomartin4btc/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": "22f954a3d20e7bdf27e0e4ed03b251696b5fe718",
      "commit_url": "https://api.github.com/repos/pablomartin4btc/bitcoin/commits/22f954a3d20e7bdf27e0e4ed03b251696b5fe718",
      "created_at": "2025-03-27T16:53:57Z"
    },
    {
      "event": "commented",
      "id": 2758766640,
      "node_id": "IC_kwDOABII586kb3Aw",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2758766640",
      "actor": {
        "login": "pablomartin4btc",
        "id": 110166421,
        "node_id": "U_kgDOBpEBlQ",
        "avatar_url": "https://avatars.githubusercontent.com/u/110166421?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/pablomartin4btc",
        "html_url": "https://github.com/pablomartin4btc",
        "followers_url": "https://api.github.com/users/pablomartin4btc/followers",
        "following_url": "https://api.github.com/users/pablomartin4btc/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/pablomartin4btc/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/pablomartin4btc/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/pablomartin4btc/subscriptions",
        "organizations_url": "https://api.github.com/users/pablomartin4btc/orgs",
        "repos_url": "https://api.github.com/users/pablomartin4btc/repos",
        "events_url": "https://api.github.com/users/pablomartin4btc/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/pablomartin4btc/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-03-27T16:55:18Z",
      "updated_at": "2025-03-27T16:55:18Z",
      "author_association": "MEMBER",
      "body": "_<ins>Updates</ins>:_\r\n- Addressed @furszy's feedback.",
      "user": {
        "login": "pablomartin4btc",
        "id": 110166421,
        "node_id": "U_kgDOBpEBlQ",
        "avatar_url": "https://avatars.githubusercontent.com/u/110166421?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/pablomartin4btc",
        "html_url": "https://github.com/pablomartin4btc",
        "followers_url": "https://api.github.com/users/pablomartin4btc/followers",
        "following_url": "https://api.github.com/users/pablomartin4btc/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/pablomartin4btc/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/pablomartin4btc/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/pablomartin4btc/subscriptions",
        "organizations_url": "https://api.github.com/users/pablomartin4btc/orgs",
        "repos_url": "https://api.github.com/users/pablomartin4btc/repos",
        "events_url": "https://api.github.com/users/pablomartin4btc/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/pablomartin4btc/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32149#issuecomment-2758766640",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/32149"
    },
    {
      "event": "mentioned",
      "id": 17018148672,
      "node_id": "MEE_lADOABII586v6URNzwAAAAP2XFdA",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/17018148672",
      "actor": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-03-27T16:55:19Z"
    },
    {
      "event": "subscribed",
      "id": 17018148698,
      "node_id": "SE_lADOABII586v6URNzwAAAAP2XFda",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/17018148698",
      "actor": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-03-27T16:55:20Z"
    },
    {
      "event": "unlabeled",
      "id": 17021074139,
      "node_id": "UNLE_lADOABII586v6URNzwAAAAP2iPrb",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/17021074139",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-03-27T19:47:25Z",
      "label": {
        "name": "CI failed",
        "color": "cccccc"
      }
    },
    {
      "event": "reviewed",
      "id": 2725439754,
      "node_id": "PRR_kwDOABII586icukK",
      "url": null,
      "actor": null,
      "commit_id": "22f954a3d20e7bdf27e0e4ed03b251696b5fe718",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "user": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32149#pullrequestreview-2725439754",
      "submitted_at": "2025-03-28T13:00:52Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/32149"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKGZmN2Y5YmIwYjhmMzM5MTlkNTQwZWJkYzg5YTYzYWIxYWI2NWZjNjY",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/ff7f9bb0b8f33919d540ebdc89a63ab1ab65fc66",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/ff7f9bb0b8f33919d540ebdc89a63ab1ab65fc66",
      "tree": {
        "sha": "63b4335a2ac0d5906bdb974ea1ad1dae7a808635",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/63b4335a2ac0d5906bdb974ea1ad1dae7a808635"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/c0b7159de47592c95c6db061de682b4af4058102",
          "sha": "c0b7159de47592c95c6db061de682b4af4058102",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/c0b7159de47592c95c6db061de682b4af4058102"
        }
      ],
      "message": "wallet, refactor: Decouple into HasLegacyRecords()\n\nThe new helper will be used to fix a crash in the\nwallet migration process (watch-only, non-blank,\nprivate keys disabled, empty wallet - no scripts\nor addresses imported).\n\nCo-authored-by: Matias Furszyfer <mfurszy@protonmail.com>",
      "committer": {
        "name": "pablomartin4btc",
        "email": "pablomartin4btc@gmail.com",
        "date": "2025-03-28T16:18:54Z"
      },
      "author": {
        "name": "pablomartin4btc",
        "email": "pablomartin4btc@gmail.com",
        "date": "2025-03-26T18:44:32Z"
      },
      "sha": "ff7f9bb0b8f33919d540ebdc89a63ab1ab65fc66"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKGM1YjI4NzgyZTU4ZTBhNGNiNGVhZmUyZTAzMzBkZTYwZjYzZjM5YjE",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/c5b28782e58e0a4cb4eafe2e0330de60f63f39b1",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/c5b28782e58e0a4cb4eafe2e0330de60f63f39b1",
      "tree": {
        "sha": "dea0688d7a648ac64d287842c45a3189e59bf655",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/dea0688d7a648ac64d287842c45a3189e59bf655"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/ff7f9bb0b8f33919d540ebdc89a63ab1ab65fc66",
          "sha": "ff7f9bb0b8f33919d540ebdc89a63ab1ab65fc66",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/ff7f9bb0b8f33919d540ebdc89a63ab1ab65fc66"
        }
      ],
      "message": "wallet, migration: Fix crash om empty wallet\n\nSame as with a blank wallet, wallets with no legacy\nrecords (i.e. empty, non-blank, watch-only wallet)\ndo not require to be migrated.",
      "committer": {
        "name": "pablomartin4btc",
        "email": "pablomartin4btc@gmail.com",
        "date": "2025-03-28T16:19:30Z"
      },
      "author": {
        "name": "pablomartin4btc",
        "email": "pablomartin4btc@gmail.com",
        "date": "2025-03-26T22:13:44Z"
      },
      "sha": "c5b28782e58e0a4cb4eafe2e0330de60f63f39b1"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 17035247568,
      "node_id": "HRFPE_lADOABII586v6URNzwAAAAP3YT_Q",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/17035247568",
      "actor": {
        "login": "pablomartin4btc",
        "id": 110166421,
        "node_id": "U_kgDOBpEBlQ",
        "avatar_url": "https://avatars.githubusercontent.com/u/110166421?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/pablomartin4btc",
        "html_url": "https://github.com/pablomartin4btc",
        "followers_url": "https://api.github.com/users/pablomartin4btc/followers",
        "following_url": "https://api.github.com/users/pablomartin4btc/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/pablomartin4btc/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/pablomartin4btc/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/pablomartin4btc/subscriptions",
        "organizations_url": "https://api.github.com/users/pablomartin4btc/orgs",
        "repos_url": "https://api.github.com/users/pablomartin4btc/repos",
        "events_url": "https://api.github.com/users/pablomartin4btc/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/pablomartin4btc/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": "c5b28782e58e0a4cb4eafe2e0330de60f63f39b1",
      "commit_url": "https://api.github.com/repos/pablomartin4btc/bitcoin/commits/c5b28782e58e0a4cb4eafe2e0330de60f63f39b1",
      "created_at": "2025-03-28T16:19:41Z"
    },
    {
      "event": "commented",
      "id": 2761858650,
      "node_id": "IC_kwDOABII586knp5a",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2761858650",
      "actor": {
        "login": "pablomartin4btc",
        "id": 110166421,
        "node_id": "U_kgDOBpEBlQ",
        "avatar_url": "https://avatars.githubusercontent.com/u/110166421?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/pablomartin4btc",
        "html_url": "https://github.com/pablomartin4btc",
        "followers_url": "https://api.github.com/users/pablomartin4btc/followers",
        "following_url": "https://api.github.com/users/pablomartin4btc/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/pablomartin4btc/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/pablomartin4btc/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/pablomartin4btc/subscriptions",
        "organizations_url": "https://api.github.com/users/pablomartin4btc/orgs",
        "repos_url": "https://api.github.com/users/pablomartin4btc/repos",
        "events_url": "https://api.github.com/users/pablomartin4btc/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/pablomartin4btc/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-03-28T16:28:43Z",
      "updated_at": "2025-03-28T16:28:43Z",
      "author_association": "MEMBER",
      "body": "_<ins>Updates</ins>:_\r\n- Addressed @furszy's [feedback](https://github.com/bitcoin/bitcoin/pull/32149#discussion_r2018614237).",
      "user": {
        "login": "pablomartin4btc",
        "id": 110166421,
        "node_id": "U_kgDOBpEBlQ",
        "avatar_url": "https://avatars.githubusercontent.com/u/110166421?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/pablomartin4btc",
        "html_url": "https://github.com/pablomartin4btc",
        "followers_url": "https://api.github.com/users/pablomartin4btc/followers",
        "following_url": "https://api.github.com/users/pablomartin4btc/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/pablomartin4btc/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/pablomartin4btc/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/pablomartin4btc/subscriptions",
        "organizations_url": "https://api.github.com/users/pablomartin4btc/orgs",
        "repos_url": "https://api.github.com/users/pablomartin4btc/repos",
        "events_url": "https://api.github.com/users/pablomartin4btc/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/pablomartin4btc/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32149#issuecomment-2761858650",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/32149"
    },
    {
      "event": "mentioned",
      "id": 17035383251,
      "node_id": "MEE_lADOABII586v6URNzwAAAAP3Y1HT",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/17035383251",
      "actor": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-03-28T16:28:45Z"
    },
    {
      "event": "subscribed",
      "id": 17035383309,
      "node_id": "SE_lADOABII586v6URNzwAAAAP3Y1IN",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/17035383309",
      "actor": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-03-28T16:28:45Z"
    }
  ],
  "comments": [
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2016751555",
      "pull_request_review_id": 2721679868,
      "id": 2016751555,
      "node_id": "PRRC_kwDOABII5854NS_D",
      "diff_hunk": "@@ -4534,8 +4534,15 @@ util::Result<MigrationResult> MigrateLegacyToDescriptor(std::shared_ptr<CWallet>\n         // First change to using SQLite\n         if (!local_wallet->MigrateToSQLite(error)) return util::Error{error};\n \n+        bool empty_wallet{false};\n+        {\n+            // Keep the batch alive only for this call\n+            const auto& db_batch = local_wallet->GetDatabase().MakeBatch();\n+            empty_wallet = !HasLegacyRecords(local_wallet.get(), *db_batch);\n+        }\n+\n         // Do the migration of keys and scripts for non-blank wallets, and cleanup if it fails\n-        success = local_wallet->IsWalletFlagSet(WALLET_FLAG_BLANK_WALLET);\n+        success = empty_wallet || local_wallet->IsWalletFlagSet(WALLET_FLAG_BLANK_WALLET);",
      "path": "src/wallet/wallet.cpp",
      "position": null,
      "original_position": 13,
      "commit_id": "c5b28782e58e0a4cb4eafe2e0330de60f63f39b1",
      "original_commit_id": "9962614b9060e9713042de91dc04ff5ea6604ae1",
      "in_reply_to_id": null,
      "user": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "In 9962614b9060:\r\n\r\nI changed my mind here. The blank flag check seems redundant and could even be harmful if it isn't unset after key import or creation for some reason. This could just be a:\r\n```c++\r\nsuccess = empty_wallet;\r\n```",
      "created_at": "2025-03-27T14:05:34Z",
      "updated_at": "2025-03-27T14:20:09Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32149#discussion_r2016751555",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2016751555"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/32149"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 4545,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2016756786",
      "pull_request_review_id": 2721679868,
      "id": 2016756786,
      "node_id": "PRRC_kwDOABII5854NUQy",
      "diff_hunk": "@@ -445,6 +445,39 @@ def test_no_privkeys(self):\n         # After migrating, the \"keypool\" is empty\n         assert_raises_rpc_error(-4, \"Error: This wallet has no available keys\", watchonly1.getnewaddress)\n \n+        # Migrating a watch-only blank empty wallet (with no pubkeys)\n+        self.log.info(\"Test migration of a pure watchonly blank empty wallet (with no pubkeys)\")\n+        watchonly2 = self.create_legacy_wallet(\"watchonly2\", disable_private_keys=True, blank=True)",
      "path": "test/functional/wallet_migration.py",
      "position": null,
      "original_position": 6,
      "commit_id": "c5b28782e58e0a4cb4eafe2e0330de60f63f39b1",
      "original_commit_id": "9962614b9060e9713042de91dc04ff5ea6604ae1",
      "in_reply_to_id": null,
      "user": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "the `blank=True` flag is not needed when you disable private keys.",
      "created_at": "2025-03-27T14:07:50Z",
      "updated_at": "2025-03-27T14:20:09Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32149#discussion_r2016756786",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2016756786"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/32149"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 450,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2016767447",
      "pull_request_review_id": 2721679868,
      "id": 2016767447,
      "node_id": "PRRC_kwDOABII5854NW3X",
      "diff_hunk": "@@ -445,6 +445,39 @@ def test_no_privkeys(self):\n         # After migrating, the \"keypool\" is empty\n         assert_raises_rpc_error(-4, \"Error: This wallet has no available keys\", watchonly1.getnewaddress)\n \n+        # Migrating a watch-only blank empty wallet (with no pubkeys)\n+        self.log.info(\"Test migration of a pure watchonly blank empty wallet (with no pubkeys)\")\n+        watchonly2 = self.create_legacy_wallet(\"watchonly2\", disable_private_keys=True, blank=True)\n+        # Before migrating\n+        info = watchonly2.getwalletinfo()\n+        assert_equal(info[\"descriptors\"], False)\n+        assert_equal(info[\"private_keys_enabled\"], False)\n+        assert_equal(info[\"blank\"], True)",
      "path": "test/functional/wallet_migration.py",
      "position": null,
      "original_position": 11,
      "commit_id": "c5b28782e58e0a4cb4eafe2e0330de60f63f39b1",
      "original_commit_id": "9962614b9060e9713042de91dc04ff5ea6604ae1",
      "in_reply_to_id": null,
      "user": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "In https://github.com/bitcoin/bitcoin/commit/9962614b9060e9713042de91dc04ff5ea6604ae1:\r\n\r\nThe first check is redundant —`create_legacy_wallet()` already performs it. The other two checks are unnecessary. You want to verify migration here, not whether `createwallet()` works as expected, that's something different.",
      "created_at": "2025-03-27T14:12:38Z",
      "updated_at": "2025-03-27T14:20:09Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32149#discussion_r2016767447",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2016767447"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/32149"
        }
      },
      "start_line": null,
      "original_start_line": 451,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 455,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2016770083",
      "pull_request_review_id": 2721679868,
      "id": 2016770083,
      "node_id": "PRRC_kwDOABII5854NXgj",
      "diff_hunk": "@@ -445,6 +445,39 @@ def test_no_privkeys(self):\n         # After migrating, the \"keypool\" is empty\n         assert_raises_rpc_error(-4, \"Error: This wallet has no available keys\", watchonly1.getnewaddress)\n \n+        # Migrating a watch-only blank empty wallet (with no pubkeys)\n+        self.log.info(\"Test migration of a pure watchonly blank empty wallet (with no pubkeys)\")\n+        watchonly2 = self.create_legacy_wallet(\"watchonly2\", disable_private_keys=True, blank=True)\n+        # Before migrating\n+        info = watchonly2.getwalletinfo()\n+        assert_equal(info[\"descriptors\"], False)\n+        assert_equal(info[\"private_keys_enabled\"], False)\n+        assert_equal(info[\"blank\"], True)\n+\n+        _, watchonly2 = self.migrate_and_get_rpc(\"watchonly2\")\n+        # After migrating\n+        info = watchonly2.getwalletinfo()\n+        assert_equal(info[\"descriptors\"], True)",
      "path": "test/functional/wallet_migration.py",
      "position": null,
      "original_position": 16,
      "commit_id": "c5b28782e58e0a4cb4eafe2e0330de60f63f39b1",
      "original_commit_id": "9962614b9060e9713042de91dc04ff5ea6604ae1",
      "in_reply_to_id": null,
      "user": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "In https://github.com/bitcoin/bitcoin/commit/9962614b9060e9713042de91dc04ff5ea6604ae1:\r\n\r\nthis check is redundant, `migrate_and_get_rpc()` already checks it.",
      "created_at": "2025-03-27T14:13:46Z",
      "updated_at": "2025-03-27T14:20:09Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32149#discussion_r2016770083",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2016770083"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/32149"
        }
      },
      "start_line": null,
      "original_start_line": 457,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 460,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2016780253",
      "pull_request_review_id": 2721679868,
      "id": 2016780253,
      "node_id": "PRRC_kwDOABII5854NZ_d",
      "diff_hunk": "@@ -445,6 +445,39 @@ def test_no_privkeys(self):\n         # After migrating, the \"keypool\" is empty\n         assert_raises_rpc_error(-4, \"Error: This wallet has no available keys\", watchonly1.getnewaddress)\n \n+        # Migrating a watch-only blank empty wallet (with no pubkeys)\n+        self.log.info(\"Test migration of a pure watchonly blank empty wallet (with no pubkeys)\")\n+        watchonly2 = self.create_legacy_wallet(\"watchonly2\", disable_private_keys=True, blank=True)\n+        # Before migrating\n+        info = watchonly2.getwalletinfo()\n+        assert_equal(info[\"descriptors\"], False)\n+        assert_equal(info[\"private_keys_enabled\"], False)\n+        assert_equal(info[\"blank\"], True)\n+\n+        _, watchonly2 = self.migrate_and_get_rpc(\"watchonly2\")\n+        # After migrating\n+        info = watchonly2.getwalletinfo()\n+        assert_equal(info[\"descriptors\"], True)\n+        assert_equal(info[\"private_keys_enabled\"], False)\n+        assert_equal(info[\"blank\"], True)",
      "path": "test/functional/wallet_migration.py",
      "position": null,
      "original_position": 18,
      "commit_id": "c5b28782e58e0a4cb4eafe2e0330de60f63f39b1",
      "original_commit_id": "9962614b9060e9713042de91dc04ff5ea6604ae1",
      "in_reply_to_id": null,
      "user": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "In https://github.com/bitcoin/bitcoin/commit/9962614b9060e9713042de91dc04ff5ea6604ae1:\r\n\r\nThis is actually asserting the wrong behavior. The migrated wallet should have private keys disabled, just like the legacy wallet.",
      "created_at": "2025-03-27T14:18:12Z",
      "updated_at": "2025-03-27T14:20:09Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32149#discussion_r2016780253",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2016780253"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/32149"
        }
      },
      "start_line": null,
      "original_start_line": 457,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 462,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2016804703",
      "pull_request_review_id": 2721941685,
      "id": 2016804703,
      "node_id": "PRRC_kwDOABII5854Nf9f",
      "diff_hunk": "@@ -4534,8 +4534,15 @@ util::Result<MigrationResult> MigrateLegacyToDescriptor(std::shared_ptr<CWallet>\n         // First change to using SQLite\n         if (!local_wallet->MigrateToSQLite(error)) return util::Error{error};\n \n+        bool empty_wallet{false};\n+        {\n+            // Keep the batch alive only for this call\n+            const auto& db_batch = local_wallet->GetDatabase().MakeBatch();\n+            empty_wallet = !HasLegacyRecords(local_wallet.get(), *db_batch);\n+        }\n+\n         // Do the migration of keys and scripts for non-blank wallets, and cleanup if it fails\n-        success = local_wallet->IsWalletFlagSet(WALLET_FLAG_BLANK_WALLET);\n+        success = empty_wallet || local_wallet->IsWalletFlagSet(WALLET_FLAG_BLANK_WALLET);",
      "path": "src/wallet/wallet.cpp",
      "position": null,
      "original_position": 13,
      "commit_id": "c5b28782e58e0a4cb4eafe2e0330de60f63f39b1",
      "original_commit_id": "9962614b9060e9713042de91dc04ff5ea6604ae1",
      "in_reply_to_id": 2016751555,
      "user": {
        "login": "pablomartin4btc",
        "id": 110166421,
        "node_id": "U_kgDOBpEBlQ",
        "avatar_url": "https://avatars.githubusercontent.com/u/110166421?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/pablomartin4btc",
        "html_url": "https://github.com/pablomartin4btc",
        "followers_url": "https://api.github.com/users/pablomartin4btc/followers",
        "following_url": "https://api.github.com/users/pablomartin4btc/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/pablomartin4btc/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/pablomartin4btc/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/pablomartin4btc/subscriptions",
        "organizations_url": "https://api.github.com/users/pablomartin4btc/orgs",
        "repos_url": "https://api.github.com/users/pablomartin4btc/repos",
        "events_url": "https://api.github.com/users/pablomartin4btc/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/pablomartin4btc/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "Ok, I'll check, I've tested already that when you import an address the flag gets unset.",
      "created_at": "2025-03-27T14:28:04Z",
      "updated_at": "2025-03-27T14:28:04Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32149#discussion_r2016804703",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2016804703"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/32149"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 4545,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2016809896",
      "pull_request_review_id": 2721952900,
      "id": 2016809896,
      "node_id": "PRRC_kwDOABII5854NhOo",
      "diff_hunk": "@@ -445,6 +445,39 @@ def test_no_privkeys(self):\n         # After migrating, the \"keypool\" is empty\n         assert_raises_rpc_error(-4, \"Error: This wallet has no available keys\", watchonly1.getnewaddress)\n \n+        # Migrating a watch-only blank empty wallet (with no pubkeys)\n+        self.log.info(\"Test migration of a pure watchonly blank empty wallet (with no pubkeys)\")\n+        watchonly2 = self.create_legacy_wallet(\"watchonly2\", disable_private_keys=True, blank=True)",
      "path": "test/functional/wallet_migration.py",
      "position": null,
      "original_position": 6,
      "commit_id": "c5b28782e58e0a4cb4eafe2e0330de60f63f39b1",
      "original_commit_id": "9962614b9060e9713042de91dc04ff5ea6604ae1",
      "in_reply_to_id": 2016756786,
      "user": {
        "login": "pablomartin4btc",
        "id": 110166421,
        "node_id": "U_kgDOBpEBlQ",
        "avatar_url": "https://avatars.githubusercontent.com/u/110166421?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/pablomartin4btc",
        "html_url": "https://github.com/pablomartin4btc",
        "followers_url": "https://api.github.com/users/pablomartin4btc/followers",
        "following_url": "https://api.github.com/users/pablomartin4btc/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/pablomartin4btc/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/pablomartin4btc/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/pablomartin4btc/subscriptions",
        "organizations_url": "https://api.github.com/users/pablomartin4btc/orgs",
        "repos_url": "https://api.github.com/users/pablomartin4btc/repos",
        "events_url": "https://api.github.com/users/pablomartin4btc/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/pablomartin4btc/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "But wanted to make it explicit that as the wallet is empty, not imported address, the flag will remain the same after migration.",
      "created_at": "2025-03-27T14:30:22Z",
      "updated_at": "2025-03-27T14:30:22Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32149#discussion_r2016809896",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2016809896"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/32149"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 450,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2016810958",
      "pull_request_review_id": 2721954401,
      "id": 2016810958,
      "node_id": "PRRC_kwDOABII5854NhfO",
      "diff_hunk": "@@ -445,6 +445,39 @@ def test_no_privkeys(self):\n         # After migrating, the \"keypool\" is empty\n         assert_raises_rpc_error(-4, \"Error: This wallet has no available keys\", watchonly1.getnewaddress)\n \n+        # Migrating a watch-only blank empty wallet (with no pubkeys)\n+        self.log.info(\"Test migration of a pure watchonly blank empty wallet (with no pubkeys)\")\n+        watchonly2 = self.create_legacy_wallet(\"watchonly2\", disable_private_keys=True, blank=True)\n+        # Before migrating\n+        info = watchonly2.getwalletinfo()\n+        assert_equal(info[\"descriptors\"], False)\n+        assert_equal(info[\"private_keys_enabled\"], False)\n+        assert_equal(info[\"blank\"], True)",
      "path": "test/functional/wallet_migration.py",
      "position": null,
      "original_position": 11,
      "commit_id": "c5b28782e58e0a4cb4eafe2e0330de60f63f39b1",
      "original_commit_id": "9962614b9060e9713042de91dc04ff5ea6604ae1",
      "in_reply_to_id": 2016767447,
      "user": {
        "login": "pablomartin4btc",
        "id": 110166421,
        "node_id": "U_kgDOBpEBlQ",
        "avatar_url": "https://avatars.githubusercontent.com/u/110166421?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/pablomartin4btc",
        "html_url": "https://github.com/pablomartin4btc",
        "followers_url": "https://api.github.com/users/pablomartin4btc/followers",
        "following_url": "https://api.github.com/users/pablomartin4btc/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/pablomartin4btc/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/pablomartin4btc/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/pablomartin4btc/subscriptions",
        "organizations_url": "https://api.github.com/users/pablomartin4btc/orgs",
        "repos_url": "https://api.github.com/users/pablomartin4btc/repos",
        "events_url": "https://api.github.com/users/pablomartin4btc/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/pablomartin4btc/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "Ok, I'll remove it.",
      "created_at": "2025-03-27T14:30:48Z",
      "updated_at": "2025-03-27T14:30:49Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32149#discussion_r2016810958",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2016810958"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/32149"
        }
      },
      "start_line": null,
      "original_start_line": 451,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 455,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2016826542",
      "pull_request_review_id": 2721981901,
      "id": 2016826542,
      "node_id": "PRRC_kwDOABII5854NlSu",
      "diff_hunk": "@@ -445,6 +445,39 @@ def test_no_privkeys(self):\n         # After migrating, the \"keypool\" is empty\n         assert_raises_rpc_error(-4, \"Error: This wallet has no available keys\", watchonly1.getnewaddress)\n \n+        # Migrating a watch-only blank empty wallet (with no pubkeys)\n+        self.log.info(\"Test migration of a pure watchonly blank empty wallet (with no pubkeys)\")\n+        watchonly2 = self.create_legacy_wallet(\"watchonly2\", disable_private_keys=True, blank=True)\n+        # Before migrating\n+        info = watchonly2.getwalletinfo()\n+        assert_equal(info[\"descriptors\"], False)\n+        assert_equal(info[\"private_keys_enabled\"], False)\n+        assert_equal(info[\"blank\"], True)\n+\n+        _, watchonly2 = self.migrate_and_get_rpc(\"watchonly2\")\n+        # After migrating\n+        info = watchonly2.getwalletinfo()\n+        assert_equal(info[\"descriptors\"], True)\n+        assert_equal(info[\"private_keys_enabled\"], False)\n+        assert_equal(info[\"blank\"], True)",
      "path": "test/functional/wallet_migration.py",
      "position": null,
      "original_position": 18,
      "commit_id": "c5b28782e58e0a4cb4eafe2e0330de60f63f39b1",
      "original_commit_id": "9962614b9060e9713042de91dc04ff5ea6604ae1",
      "in_reply_to_id": 2016780253,
      "user": {
        "login": "pablomartin4btc",
        "id": 110166421,
        "node_id": "U_kgDOBpEBlQ",
        "avatar_url": "https://avatars.githubusercontent.com/u/110166421?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/pablomartin4btc",
        "html_url": "https://github.com/pablomartin4btc",
        "followers_url": "https://api.github.com/users/pablomartin4btc/followers",
        "following_url": "https://api.github.com/users/pablomartin4btc/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/pablomartin4btc/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/pablomartin4btc/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/pablomartin4btc/subscriptions",
        "organizations_url": "https://api.github.com/users/pablomartin4btc/orgs",
        "repos_url": "https://api.github.com/users/pablomartin4btc/repos",
        "events_url": "https://api.github.com/users/pablomartin4btc/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/pablomartin4btc/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "> The migrated wallet should have private keys **disabled**\r\n\r\nYes, it's doing that (private_keys_**enabled** = **False**), otherwise it would be failing.",
      "created_at": "2025-03-27T14:37:57Z",
      "updated_at": "2025-03-27T14:37:58Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32149#discussion_r2016826542",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2016826542"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/32149"
        }
      },
      "start_line": null,
      "original_start_line": 457,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 462,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2016844918",
      "pull_request_review_id": 2722012886,
      "id": 2016844918,
      "node_id": "PRRC_kwDOABII5854Npx2",
      "diff_hunk": "@@ -445,6 +445,39 @@ def test_no_privkeys(self):\n         # After migrating, the \"keypool\" is empty\n         assert_raises_rpc_error(-4, \"Error: This wallet has no available keys\", watchonly1.getnewaddress)\n \n+        # Migrating a watch-only blank empty wallet (with no pubkeys)\n+        self.log.info(\"Test migration of a pure watchonly blank empty wallet (with no pubkeys)\")\n+        watchonly2 = self.create_legacy_wallet(\"watchonly2\", disable_private_keys=True, blank=True)\n+        # Before migrating\n+        info = watchonly2.getwalletinfo()\n+        assert_equal(info[\"descriptors\"], False)\n+        assert_equal(info[\"private_keys_enabled\"], False)\n+        assert_equal(info[\"blank\"], True)\n+\n+        _, watchonly2 = self.migrate_and_get_rpc(\"watchonly2\")\n+        # After migrating\n+        info = watchonly2.getwalletinfo()\n+        assert_equal(info[\"descriptors\"], True)\n+        assert_equal(info[\"private_keys_enabled\"], False)\n+        assert_equal(info[\"blank\"], True)",
      "path": "test/functional/wallet_migration.py",
      "position": null,
      "original_position": 18,
      "commit_id": "c5b28782e58e0a4cb4eafe2e0330de60f63f39b1",
      "original_commit_id": "9962614b9060e9713042de91dc04ff5ea6604ae1",
      "in_reply_to_id": 2016780253,
      "user": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "ha, I read it in the other way around.. \"private_keys_disabled\".. all good. Can solve this comment.",
      "created_at": "2025-03-27T14:44:17Z",
      "updated_at": "2025-03-27T14:44:18Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32149#discussion_r2016844918",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2016844918"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/32149"
        }
      },
      "start_line": null,
      "original_start_line": 457,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 462,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2016856942",
      "pull_request_review_id": 2722034324,
      "id": 2016856942,
      "node_id": "PRRC_kwDOABII5854Nstu",
      "diff_hunk": "@@ -445,6 +445,39 @@ def test_no_privkeys(self):\n         # After migrating, the \"keypool\" is empty\n         assert_raises_rpc_error(-4, \"Error: This wallet has no available keys\", watchonly1.getnewaddress)\n \n+        # Migrating a watch-only blank empty wallet (with no pubkeys)\n+        self.log.info(\"Test migration of a pure watchonly blank empty wallet (with no pubkeys)\")\n+        watchonly2 = self.create_legacy_wallet(\"watchonly2\", disable_private_keys=True, blank=True)\n+        # Before migrating\n+        info = watchonly2.getwalletinfo()\n+        assert_equal(info[\"descriptors\"], False)\n+        assert_equal(info[\"private_keys_enabled\"], False)\n+        assert_equal(info[\"blank\"], True)\n+\n+        _, watchonly2 = self.migrate_and_get_rpc(\"watchonly2\")\n+        # After migrating\n+        info = watchonly2.getwalletinfo()\n+        assert_equal(info[\"descriptors\"], True)\n+        assert_equal(info[\"private_keys_enabled\"], False)\n+        assert_equal(info[\"blank\"], True)\n+        self.assert_is_sqlite(\"watchonly2\")\n+\n+        # Migrating a watch-only non-blank empty wallet (with no pubkeys)\n+        self.log.info(\"Test migration of a pure watchonly non-blank empty wallet (with no pubkeys)\")\n+        watchonly3 = self.create_legacy_wallet(\"watchonly3\", disable_private_keys=True, blank=False)\n+        # Before migrating\n+        info = watchonly3.getwalletinfo()\n+        assert_equal(info[\"descriptors\"], False)\n+        assert_equal(info[\"private_keys_enabled\"], False)\n+        assert_equal(info[\"blank\"], False)\n+\n+        _, watchonly3 = self.migrate_and_get_rpc(\"watchonly3\")\n+        info = watchonly3.getwalletinfo()\n+        assert_equal(info[\"descriptors\"], True)\n+        assert_equal(info[\"private_keys_enabled\"], False)\n+        assert_equal(info[\"blank\"], False)\n+        self.assert_is_sqlite(\"watchonly3\")\n+",
      "path": "test/functional/wallet_migration.py",
      "position": null,
      "original_position": 36,
      "commit_id": "c5b28782e58e0a4cb4eafe2e0330de60f63f39b1",
      "original_commit_id": "9962614b9060e9713042de91dc04ff5ea6604ae1",
      "in_reply_to_id": null,
      "user": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "Could probably re-write this test in just a few lines:\r\n```python3\r\nself.log.info(\"Test migration of a watch-only empty wallet\")\r\nfor is_blank in [True, False]:\r\n    self.create_legacy_wallet(\"watchonly_empty\", disable_private_keys=True, blank=is_blank)\r\n    _, watchonly_empty = self.migrate_and_get_rpc(\"watchonly_empty\")\r\n    info = watchonly_empty.getwalletinfo()\r\n    assert_equal(info[\"private_keys_enabled\"], False)\r\n    assert_equal(info[\"blank\"], is_blank)\r\n```",
      "created_at": "2025-03-27T14:50:05Z",
      "updated_at": "2025-03-27T14:51:12Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32149#discussion_r2016856942",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2016856942"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/32149"
        }
      },
      "start_line": null,
      "original_start_line": 448,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 456,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2016872082",
      "pull_request_review_id": 2722061675,
      "id": 2016872082,
      "node_id": "PRRC_kwDOABII5854NwaS",
      "diff_hunk": "@@ -445,6 +445,39 @@ def test_no_privkeys(self):\n         # After migrating, the \"keypool\" is empty\n         assert_raises_rpc_error(-4, \"Error: This wallet has no available keys\", watchonly1.getnewaddress)\n \n+        # Migrating a watch-only blank empty wallet (with no pubkeys)\n+        self.log.info(\"Test migration of a pure watchonly blank empty wallet (with no pubkeys)\")\n+        watchonly2 = self.create_legacy_wallet(\"watchonly2\", disable_private_keys=True, blank=True)\n+        # Before migrating\n+        info = watchonly2.getwalletinfo()\n+        assert_equal(info[\"descriptors\"], False)\n+        assert_equal(info[\"private_keys_enabled\"], False)\n+        assert_equal(info[\"blank\"], True)\n+\n+        _, watchonly2 = self.migrate_and_get_rpc(\"watchonly2\")\n+        # After migrating\n+        info = watchonly2.getwalletinfo()\n+        assert_equal(info[\"descriptors\"], True)",
      "path": "test/functional/wallet_migration.py",
      "position": null,
      "original_position": 16,
      "commit_id": "c5b28782e58e0a4cb4eafe2e0330de60f63f39b1",
      "original_commit_id": "9962614b9060e9713042de91dc04ff5ea6604ae1",
      "in_reply_to_id": 2016770083,
      "user": {
        "login": "pablomartin4btc",
        "id": 110166421,
        "node_id": "U_kgDOBpEBlQ",
        "avatar_url": "https://avatars.githubusercontent.com/u/110166421?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/pablomartin4btc",
        "html_url": "https://github.com/pablomartin4btc",
        "followers_url": "https://api.github.com/users/pablomartin4btc/followers",
        "following_url": "https://api.github.com/users/pablomartin4btc/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/pablomartin4btc/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/pablomartin4btc/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/pablomartin4btc/subscriptions",
        "organizations_url": "https://api.github.com/users/pablomartin4btc/orgs",
        "repos_url": "https://api.github.com/users/pablomartin4btc/repos",
        "events_url": "https://api.github.com/users/pablomartin4btc/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/pablomartin4btc/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "I can see I got confused with other tests that validate it but I see they call `migratewallet` instead (and then `get_wallet_rpc` - I can do a follow-up to clean it up later). Same for `assert_is_sqlite`, I'll remove it, since `migrate_and_get_rpc()` already calls it within. Thanks!",
      "created_at": "2025-03-27T14:57:32Z",
      "updated_at": "2025-03-27T14:57:32Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32149#discussion_r2016872082",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2016872082"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/32149"
        }
      },
      "start_line": null,
      "original_start_line": 457,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 460,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2016874922",
      "pull_request_review_id": 2722066696,
      "id": 2016874922,
      "node_id": "PRRC_kwDOABII5854NxGq",
      "diff_hunk": "@@ -445,6 +445,39 @@ def test_no_privkeys(self):\n         # After migrating, the \"keypool\" is empty\n         assert_raises_rpc_error(-4, \"Error: This wallet has no available keys\", watchonly1.getnewaddress)\n \n+        # Migrating a watch-only blank empty wallet (with no pubkeys)\n+        self.log.info(\"Test migration of a pure watchonly blank empty wallet (with no pubkeys)\")\n+        watchonly2 = self.create_legacy_wallet(\"watchonly2\", disable_private_keys=True, blank=True)\n+        # Before migrating\n+        info = watchonly2.getwalletinfo()\n+        assert_equal(info[\"descriptors\"], False)\n+        assert_equal(info[\"private_keys_enabled\"], False)\n+        assert_equal(info[\"blank\"], True)\n+\n+        _, watchonly2 = self.migrate_and_get_rpc(\"watchonly2\")\n+        # After migrating\n+        info = watchonly2.getwalletinfo()\n+        assert_equal(info[\"descriptors\"], True)\n+        assert_equal(info[\"private_keys_enabled\"], False)\n+        assert_equal(info[\"blank\"], True)\n+        self.assert_is_sqlite(\"watchonly2\")\n+\n+        # Migrating a watch-only non-blank empty wallet (with no pubkeys)\n+        self.log.info(\"Test migration of a pure watchonly non-blank empty wallet (with no pubkeys)\")\n+        watchonly3 = self.create_legacy_wallet(\"watchonly3\", disable_private_keys=True, blank=False)\n+        # Before migrating\n+        info = watchonly3.getwalletinfo()\n+        assert_equal(info[\"descriptors\"], False)\n+        assert_equal(info[\"private_keys_enabled\"], False)\n+        assert_equal(info[\"blank\"], False)\n+\n+        _, watchonly3 = self.migrate_and_get_rpc(\"watchonly3\")\n+        info = watchonly3.getwalletinfo()\n+        assert_equal(info[\"descriptors\"], True)\n+        assert_equal(info[\"private_keys_enabled\"], False)\n+        assert_equal(info[\"blank\"], False)\n+        self.assert_is_sqlite(\"watchonly3\")\n+",
      "path": "test/functional/wallet_migration.py",
      "position": null,
      "original_position": 36,
      "commit_id": "c5b28782e58e0a4cb4eafe2e0330de60f63f39b1",
      "original_commit_id": "9962614b9060e9713042de91dc04ff5ea6604ae1",
      "in_reply_to_id": 2016856942,
      "user": {
        "login": "pablomartin4btc",
        "id": 110166421,
        "node_id": "U_kgDOBpEBlQ",
        "avatar_url": "https://avatars.githubusercontent.com/u/110166421?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/pablomartin4btc",
        "html_url": "https://github.com/pablomartin4btc",
        "followers_url": "https://api.github.com/users/pablomartin4btc/followers",
        "following_url": "https://api.github.com/users/pablomartin4btc/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/pablomartin4btc/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/pablomartin4btc/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/pablomartin4btc/subscriptions",
        "organizations_url": "https://api.github.com/users/pablomartin4btc/orgs",
        "repos_url": "https://api.github.com/users/pablomartin4btc/repos",
        "events_url": "https://api.github.com/users/pablomartin4btc/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/pablomartin4btc/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "Yup, much better! Cheers!",
      "created_at": "2025-03-27T14:58:58Z",
      "updated_at": "2025-03-27T14:58:58Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32149#discussion_r2016874922",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2016874922"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/32149"
        }
      },
      "start_line": null,
      "original_start_line": 448,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 456,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2018614237",
      "pull_request_review_id": 2725439754,
      "id": 2018614237,
      "node_id": "PRRC_kwDOABII5854UZvd",
      "diff_hunk": "@@ -48,10 +48,13 @@ BOOST_AUTO_TEST_CASE(walletdb_read_write_deadlock)\n         LOCK(wallet->cs_wallet);\n         auto legacy_spkm = wallet->GetOrCreateLegacyScriptPubKeyMan();\n         BOOST_CHECK(legacy_spkm->SetupGeneration(true));\n+        const auto& db_batch = wallet->GetDatabase().MakeBatch();\n+        BOOST_CHECK(HasLegacyRecords(wallet.get(), *db_batch));",
      "path": "src/wallet/test/walletdb_tests.cpp",
      "position": null,
      "original_position": 5,
      "commit_id": "c5b28782e58e0a4cb4eafe2e0330de60f63f39b1",
      "original_commit_id": "61f0d7908c01198674fd2f7f20d911e543da0014",
      "in_reply_to_id": null,
      "user": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "This leaves the db batch object alive and could conflict with the `Flush()` and `DeleteRecords()` internals, as both access the db.\r\n\r\nBetter to limit the scope of the db batch object only to this function call.",
      "created_at": "2025-03-28T13:00:10Z",
      "updated_at": "2025-03-28T13:00:52Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32149#discussion_r2018614237",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2018614237"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/32149"
        }
      },
      "start_line": null,
      "original_start_line": 51,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 52,
      "side": "RIGHT"
    }
  ]
}
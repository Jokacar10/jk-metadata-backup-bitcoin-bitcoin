{
  "type": "pull",
  "pull": {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/33392",
    "id": 2829858173,
    "node_id": "PR_kwDOABII586orDV9",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/33392",
    "diff_url": "https://github.com/bitcoin/bitcoin/pull/33392.diff",
    "patch_url": "https://github.com/bitcoin/bitcoin/pull/33392.patch",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/33392",
    "commits_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/33392/commits",
    "review_comments_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/33392/comments",
    "review_comment_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments%7B/number%7D",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/33392/comments",
    "statuses_url": "https://api.github.com/repos/bitcoin/bitcoin/statuses/93baccaa356d94fb9a2573ffe45dd196798867b7",
    "number": 33392,
    "state": "open",
    "locked": false,
    "maintainer_can_modify": true,
    "title": "rpc: add scan_utxoset option to getbalance(s) to verify wallet balance accuracy",
    "user": {
      "login": "musaHaruna",
      "id": 124810379,
      "node_id": "U_kgDOB3B0iw",
      "avatar_url": "https://avatars.githubusercontent.com/u/124810379?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/musaHaruna",
      "html_url": "https://github.com/musaHaruna",
      "followers_url": "https://api.github.com/users/musaHaruna/followers",
      "following_url": "https://api.github.com/users/musaHaruna/following%7B/other_user%7D",
      "gists_url": "https://api.github.com/users/musaHaruna/gists%7B/gist_id%7D",
      "starred_url": "https://api.github.com/users/musaHaruna/starred%7B/owner%7D%7B/repo%7D",
      "subscriptions_url": "https://api.github.com/users/musaHaruna/subscriptions",
      "organizations_url": "https://api.github.com/users/musaHaruna/orgs",
      "repos_url": "https://api.github.com/users/musaHaruna/repos",
      "events_url": "https://api.github.com/users/musaHaruna/events%7B/privacy%7D",
      "received_events_url": "https://api.github.com/users/musaHaruna/received_events",
      "type": "User",
      "site_admin": false,
      "patch_url": null
    },
    "body": "Fixes [#28898](https://github.com/bitcoin/bitcoin/issues/28898)\r\nUsers who import descriptors with incorrect birthdates may encounter inaccurate wallet balances. In such cases, the wallet may miss historical transactions that belong to it, resulting in underreported balances.\r\nCurrently, the only way to correct this is to manually run rescanblockchain or reimport descriptors with proper metadata. However, users may not realize that their wallet balance is incomplete.\r\nThis PR introduces a mechanism for wallets to verify their trusted balance against the UTXO set. By rescanning the current UTXO set, the wallet can detect discrepancies and suggest corrective actions to the user.\r\n\r\n**Features**\r\nAdds a scan_utxoset argument to both getbalance and getbalances RPCs.\r\nWhen enabled:\r\nThe wallet collects all scriptPubKeys from its descriptors.\r\nThe node scans the chainstate UTXO set for matching outputs.\r\nA scanned balance is calculated independently of the wallet’s transaction history.\r\n\r\nIf the scanned balance differs from the wallet’s trusted balance:\r\nThe result includes a utxo_discrepancy object with both balances and a suggested action.\r\nUsers are advised to run rescanblockchain or reimport descriptors with correct birthdates.\r\n\r\n**Example usage**\r\nNormal trusted balance\r\n`$ bitcoin-cli getbalance\r\n0.01000000\r\n`\r\n\r\nWith UTXO set scan\r\n```\r\n$ bitcoin-cli getbalance \"* 0 false false true\"\r\n{\r\n  \"amount\": 0.01000000,\r\n  \"scanned_amount\": 0.01500000,\r\n  \"warnings\": \"Scanned UTXO balance (0.01500000 BTC) is larger than the wallet's trusted balance (0.01000000 BTC). If this is unexpected, consider running rescanblockchain or reimporting descriptors with correct birthdates to restore missing transaction history.\"\r\n}\r\n\r\n$ bitcoin-cli getbalances true\r\n{\r\n  \"mine\": {\r\n    \"trusted\": 0.01000000,\r\n    \"untrusted_pending\": 0.00000000,\r\n    \"immature\": 0.00000000\r\n  },\r\n  \"utxo_scanned_balance\": 0.01500000,\r\n  \"utxo_discrepancy\": {\r\n    \"wallet_trusted_balance\": 0.01000000,\r\n    \"utxo_scanned_balance\": 0.01500000,\r\n    \"suggested_action\": \"If this is unexpected, consider running rescanblockchain or reimporting descriptors with correct birthdates to restore missing transaction history.\"\r\n  },\r\n  \"lastprocessedblock\": {\r\n    \"height\": 900000,\r\n    \"hash\": \"000000000000000...\"\r\n  }\r\n}\r\n```\r\n\r\n**Implementation Notes**\r\nIntroduces `FindCoinsByScript` to scan the chainstate UTXO set for a set of scripts.\r\n`ScanWalletUTXOSet` aggregates spendable/watched outputs and tallies balances.\r\nResults are merged into existing getbalance / getbalances RPCs behind a new scan_utxoset flag.\r\nCoinbase maturity rules are applied consistently.\r\n\r\n**Review Notes**\r\nThis does not replace rescanblockchain; it only provides a diagnostic check.\r\nFor large wallets, UTXO scans may be expensive but should complete faster than a full rescan.\r\nMaintains backwards compatibility by defaulting scan_utxoset=false.\r\nAdds optional result fields only when scan_utxoset is enabled.\r\n",
    "labels": [
      {
        "id": 98279177,
        "node_id": "MDU6TGFiZWw5ODI3OTE3Nw==",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/RPC/REST/ZMQ",
        "name": "RPC/REST/ZMQ",
        "color": "0052cc",
        "default": false
      }
    ],
    "created_at": "2025-09-15T16:17:12Z",
    "updated_at": "2025-09-16T11:56:15Z",
    "mergeable": true,
    "mergeable_state": "blocked",
    "merged": false,
    "merge_commit_sha": "810a2cf818993f5beb8b6fadec26c19cb998d338",
    "assignees": [],
    "requested_reviewers": [],
    "requested_teams": [],
    "rebaseable": true,
    "head": {
      "label": "musaHaruna:feature/scan-utxoset-balance-check",
      "ref": "feature/scan-utxoset-balance-check",
      "sha": "93baccaa356d94fb9a2573ffe45dd196798867b7",
      "user": {
        "login": "musaHaruna",
        "id": 124810379,
        "node_id": "U_kgDOB3B0iw",
        "avatar_url": "https://avatars.githubusercontent.com/u/124810379?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/musaHaruna",
        "html_url": "https://github.com/musaHaruna",
        "followers_url": "https://api.github.com/users/musaHaruna/followers",
        "following_url": "https://api.github.com/users/musaHaruna/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/musaHaruna/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/musaHaruna/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/musaHaruna/subscriptions",
        "organizations_url": "https://api.github.com/users/musaHaruna/orgs",
        "repos_url": "https://api.github.com/users/musaHaruna/repos",
        "events_url": "https://api.github.com/users/musaHaruna/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/musaHaruna/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "repo": {
        "id": 941838367,
        "node_id": "R_kgDOOCNQHw",
        "name": "bitcoin",
        "full_name": "musaHaruna/bitcoin",
        "owner": {
          "login": "musaHaruna",
          "id": 124810379,
          "node_id": "U_kgDOB3B0iw",
          "avatar_url": "https://avatars.githubusercontent.com/u/124810379?v=4",
          "gravatar_id": "",
          "url": "https://api.github.com/users/musaHaruna",
          "html_url": "https://github.com/musaHaruna",
          "followers_url": "https://api.github.com/users/musaHaruna/followers",
          "following_url": "https://api.github.com/users/musaHaruna/following%7B/other_user%7D",
          "gists_url": "https://api.github.com/users/musaHaruna/gists%7B/gist_id%7D",
          "starred_url": "https://api.github.com/users/musaHaruna/starred%7B/owner%7D%7B/repo%7D",
          "subscriptions_url": "https://api.github.com/users/musaHaruna/subscriptions",
          "organizations_url": "https://api.github.com/users/musaHaruna/orgs",
          "repos_url": "https://api.github.com/users/musaHaruna/repos",
          "events_url": "https://api.github.com/users/musaHaruna/events%7B/privacy%7D",
          "received_events_url": "https://api.github.com/users/musaHaruna/received_events",
          "type": "User",
          "site_admin": false,
          "patch_url": null
        },
        "private": false,
        "html_url": "https://github.com/musaHaruna/bitcoin",
        "description": "Bitcoin Core integration/staging tree",
        "fork": true,
        "url": "https://api.github.com/repos/musaHaruna/bitcoin",
        "archive_url": "https://api.github.com/repos/musaHaruna/bitcoin/%7Barchive_format%7D%7B/ref%7D",
        "assignees_url": "https://api.github.com/repos/musaHaruna/bitcoin/assignees%7B/user%7D",
        "blobs_url": "https://api.github.com/repos/musaHaruna/bitcoin/git/blobs%7B/sha%7D",
        "branches_url": "https://api.github.com/repos/musaHaruna/bitcoin/branches%7B/branch%7D",
        "collaborators_url": "https://api.github.com/repos/musaHaruna/bitcoin/collaborators%7B/collaborator%7D",
        "comments_url": "https://api.github.com/repos/musaHaruna/bitcoin/comments%7B/number%7D",
        "commits_url": "https://api.github.com/repos/musaHaruna/bitcoin/commits%7B/sha%7D",
        "compare_url": "https://api.github.com/repos/musaHaruna/bitcoin/compare/%7Bbase%7D...%7Bhead%7D",
        "contents_url": "https://api.github.com/repos/musaHaruna/bitcoin/contents/%7B+path%7D",
        "contributors_url": "https://api.github.com/repos/musaHaruna/bitcoin/contributors",
        "deployments_url": "https://api.github.com/repos/musaHaruna/bitcoin/deployments",
        "downloads_url": "https://api.github.com/repos/musaHaruna/bitcoin/downloads",
        "events_url": "https://api.github.com/repos/musaHaruna/bitcoin/events",
        "forks_url": "https://api.github.com/repos/musaHaruna/bitcoin/forks",
        "git_commits_url": "https://api.github.com/repos/musaHaruna/bitcoin/git/commits%7B/sha%7D",
        "git_refs_url": "https://api.github.com/repos/musaHaruna/bitcoin/git/refs%7B/sha%7D",
        "git_tags_url": "https://api.github.com/repos/musaHaruna/bitcoin/git/tags%7B/sha%7D",
        "git_url": "git://github.com/musaHaruna/bitcoin.git",
        "issue_comment_url": "https://api.github.com/repos/musaHaruna/bitcoin/issues/comments%7B/number%7D",
        "issue_events_url": "https://api.github.com/repos/musaHaruna/bitcoin/issues/events%7B/number%7D",
        "issues_url": "https://api.github.com/repos/musaHaruna/bitcoin/issues%7B/number%7D",
        "keys_url": "https://api.github.com/repos/musaHaruna/bitcoin/keys%7B/key_id%7D",
        "labels_url": "https://api.github.com/repos/musaHaruna/bitcoin/labels%7B/name%7D",
        "languages_url": "https://api.github.com/repos/musaHaruna/bitcoin/languages",
        "merges_url": "https://api.github.com/repos/musaHaruna/bitcoin/merges",
        "milestones_url": "https://api.github.com/repos/musaHaruna/bitcoin/milestones%7B/number%7D",
        "notifications_url": "https://api.github.com/repos/musaHaruna/bitcoin/notifications%7B?since,all,participating}",
        "pulls_url": "https://api.github.com/repos/musaHaruna/bitcoin/pulls%7B/number%7D",
        "releases_url": "https://api.github.com/repos/musaHaruna/bitcoin/releases%7B/id%7D",
        "ssh_url": "git@github.com:musaHaruna/bitcoin.git",
        "stargazers_url": "https://api.github.com/repos/musaHaruna/bitcoin/stargazers",
        "statuses_url": "https://api.github.com/repos/musaHaruna/bitcoin/statuses/%7Bsha%7D",
        "subscribers_url": "https://api.github.com/repos/musaHaruna/bitcoin/subscribers",
        "subscription_url": "https://api.github.com/repos/musaHaruna/bitcoin/subscription",
        "tags_url": "https://api.github.com/repos/musaHaruna/bitcoin/tags",
        "teams_url": "https://api.github.com/repos/musaHaruna/bitcoin/teams",
        "trees_url": "https://api.github.com/repos/musaHaruna/bitcoin/git/trees%7B/sha%7D",
        "clone_url": "https://github.com/musaHaruna/bitcoin.git",
        "hooks_url": "https://api.github.com/repos/musaHaruna/bitcoin/hooks",
        "svn_url": "https://github.com/musaHaruna/bitcoin",
        "homepage": "https://bitcoincore.org/en/download",
        "language": "C++",
        "forks_count": 0,
        "stargazers_count": 0,
        "watchers_count": 0,
        "size": 250964,
        "default_branch": "master",
        "open_issues_count": 1,
        "is_template": false,
        "topics": [],
        "has_issues": false,
        "has_projects": true,
        "has_wiki": false,
        "has_pages": false,
        "has_downloads": true,
        "archived": false,
        "disabled": false,
        "visibility": "public",
        "pushed_at": "2025-09-16T11:55:31Z",
        "created_at": "2025-03-03T06:14:54Z",
        "updated_at": "2025-09-14T11:23:02Z",
        "allow_forking": true,
        "license": {
          "key": "mit",
          "name": "MIT License",
          "node_id": "MDc6TGljZW5zZTEz",
          "spdx_id": "MIT",
          "url": "https://api.github.com/licenses/mit",
          "html_url": null,
          "description": null,
          "implementation": null,
          "permissions": null,
          "conditions": null,
          "limitations": null,
          "body": null,
          "featured": null
        }
      }
    },
    "base": {
      "label": "bitcoin:master",
      "ref": "master",
      "sha": "c4adfbf70626d34c23b338f4d6af5a6835f9c9bb",
      "user": {
        "login": "bitcoin",
        "id": 528860,
        "node_id": "MDEyOk9yZ2FuaXphdGlvbjUyODg2MA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/528860?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/bitcoin",
        "html_url": "https://github.com/bitcoin",
        "followers_url": "https://api.github.com/users/bitcoin/followers",
        "following_url": "https://api.github.com/users/bitcoin/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/bitcoin/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/bitcoin/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/bitcoin/subscriptions",
        "organizations_url": "https://api.github.com/users/bitcoin/orgs",
        "repos_url": "https://api.github.com/users/bitcoin/repos",
        "events_url": "https://api.github.com/users/bitcoin/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/bitcoin/received_events",
        "type": "Organization",
        "site_admin": false,
        "patch_url": null
      },
      "repo": {
        "id": 1181927,
        "node_id": "MDEwOlJlcG9zaXRvcnkxMTgxOTI3",
        "name": "bitcoin",
        "full_name": "bitcoin/bitcoin",
        "owner": {
          "login": "bitcoin",
          "id": 528860,
          "node_id": "MDEyOk9yZ2FuaXphdGlvbjUyODg2MA==",
          "avatar_url": "https://avatars.githubusercontent.com/u/528860?v=4",
          "gravatar_id": "",
          "url": "https://api.github.com/users/bitcoin",
          "html_url": "https://github.com/bitcoin",
          "followers_url": "https://api.github.com/users/bitcoin/followers",
          "following_url": "https://api.github.com/users/bitcoin/following%7B/other_user%7D",
          "gists_url": "https://api.github.com/users/bitcoin/gists%7B/gist_id%7D",
          "starred_url": "https://api.github.com/users/bitcoin/starred%7B/owner%7D%7B/repo%7D",
          "subscriptions_url": "https://api.github.com/users/bitcoin/subscriptions",
          "organizations_url": "https://api.github.com/users/bitcoin/orgs",
          "repos_url": "https://api.github.com/users/bitcoin/repos",
          "events_url": "https://api.github.com/users/bitcoin/events%7B/privacy%7D",
          "received_events_url": "https://api.github.com/users/bitcoin/received_events",
          "type": "Organization",
          "site_admin": false,
          "patch_url": null
        },
        "private": false,
        "html_url": "https://github.com/bitcoin/bitcoin",
        "description": "Bitcoin Core integration/staging tree",
        "fork": false,
        "url": "https://api.github.com/repos/bitcoin/bitcoin",
        "archive_url": "https://api.github.com/repos/bitcoin/bitcoin/%7Barchive_format%7D%7B/ref%7D",
        "assignees_url": "https://api.github.com/repos/bitcoin/bitcoin/assignees%7B/user%7D",
        "blobs_url": "https://api.github.com/repos/bitcoin/bitcoin/git/blobs%7B/sha%7D",
        "branches_url": "https://api.github.com/repos/bitcoin/bitcoin/branches%7B/branch%7D",
        "collaborators_url": "https://api.github.com/repos/bitcoin/bitcoin/collaborators%7B/collaborator%7D",
        "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/comments%7B/number%7D",
        "commits_url": "https://api.github.com/repos/bitcoin/bitcoin/commits%7B/sha%7D",
        "compare_url": "https://api.github.com/repos/bitcoin/bitcoin/compare/%7Bbase%7D...%7Bhead%7D",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/%7B+path%7D",
        "contributors_url": "https://api.github.com/repos/bitcoin/bitcoin/contributors",
        "deployments_url": "https://api.github.com/repos/bitcoin/bitcoin/deployments",
        "downloads_url": "https://api.github.com/repos/bitcoin/bitcoin/downloads",
        "events_url": "https://api.github.com/repos/bitcoin/bitcoin/events",
        "forks_url": "https://api.github.com/repos/bitcoin/bitcoin/forks",
        "git_commits_url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits%7B/sha%7D",
        "git_refs_url": "https://api.github.com/repos/bitcoin/bitcoin/git/refs%7B/sha%7D",
        "git_tags_url": "https://api.github.com/repos/bitcoin/bitcoin/git/tags%7B/sha%7D",
        "git_url": "git://github.com/bitcoin/bitcoin.git",
        "issue_comment_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments%7B/number%7D",
        "issue_events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events%7B/number%7D",
        "issues_url": "https://api.github.com/repos/bitcoin/bitcoin/issues%7B/number%7D",
        "keys_url": "https://api.github.com/repos/bitcoin/bitcoin/keys%7B/key_id%7D",
        "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/labels%7B/name%7D",
        "languages_url": "https://api.github.com/repos/bitcoin/bitcoin/languages",
        "merges_url": "https://api.github.com/repos/bitcoin/bitcoin/merges",
        "milestones_url": "https://api.github.com/repos/bitcoin/bitcoin/milestones%7B/number%7D",
        "notifications_url": "https://api.github.com/repos/bitcoin/bitcoin/notifications%7B?since,all,participating}",
        "pulls_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls%7B/number%7D",
        "releases_url": "https://api.github.com/repos/bitcoin/bitcoin/releases%7B/id%7D",
        "ssh_url": "git@github.com:bitcoin/bitcoin.git",
        "stargazers_url": "https://api.github.com/repos/bitcoin/bitcoin/stargazers",
        "statuses_url": "https://api.github.com/repos/bitcoin/bitcoin/statuses/%7Bsha%7D",
        "subscribers_url": "https://api.github.com/repos/bitcoin/bitcoin/subscribers",
        "subscription_url": "https://api.github.com/repos/bitcoin/bitcoin/subscription",
        "tags_url": "https://api.github.com/repos/bitcoin/bitcoin/tags",
        "teams_url": "https://api.github.com/repos/bitcoin/bitcoin/teams",
        "trees_url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees%7B/sha%7D",
        "clone_url": "https://github.com/bitcoin/bitcoin.git",
        "hooks_url": "https://api.github.com/repos/bitcoin/bitcoin/hooks",
        "svn_url": "https://github.com/bitcoin/bitcoin",
        "homepage": "https://bitcoincore.org/en/download",
        "language": "C++",
        "forks_count": 37789,
        "stargazers_count": 85528,
        "watchers_count": 85528,
        "size": 293569,
        "default_branch": "master",
        "open_issues_count": 785,
        "is_template": false,
        "topics": [
          "bitcoin",
          "c-plus-plus",
          "cryptocurrency",
          "cryptography",
          "p2p"
        ],
        "has_issues": true,
        "has_projects": true,
        "has_wiki": false,
        "has_pages": false,
        "has_downloads": false,
        "archived": false,
        "disabled": false,
        "visibility": "public",
        "pushed_at": "2025-09-16T10:20:59Z",
        "created_at": "2010-12-19T15:16:43Z",
        "updated_at": "2025-09-16T11:54:34Z",
        "allow_forking": true,
        "license": {
          "key": "mit",
          "name": "MIT License",
          "node_id": "MDc6TGljZW5zZTEz",
          "spdx_id": "MIT",
          "url": "https://api.github.com/licenses/mit",
          "html_url": null,
          "description": null,
          "implementation": null,
          "permissions": null,
          "conditions": null,
          "limitations": null,
          "body": null,
          "featured": null
        }
      }
    },
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/33392"
      }
    },
    "author_association": "NONE",
    "draft": false,
    "additions": 382,
    "deletions": 33,
    "changed_files": 8,
    "commits": 4,
    "review_comments": 0,
    "comments": 1
  },
  "events": [
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKGJhOWYxMzQ3MzRiNjFhNDBjNWQ2ZmMzZjlkMzgzNjkxNGE5NWQ4NWM",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/ba9f134734b61a40c5d6fc3f9d3836914a95d85c",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/ba9f134734b61a40c5d6fc3f9d3836914a95d85c",
      "tree": {
        "sha": "6bf062a7e39059fc69f29693f27a8d123a56c367",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/6bf062a7e39059fc69f29693f27a8d123a56c367"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/d20f10affba83601f1855bc87d0f47e9dfd5caae",
          "sha": "d20f10affba83601f1855bc87d0f47e9dfd5caae",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/d20f10affba83601f1855bc87d0f47e9dfd5caae"
        }
      ],
      "message": "node: add and implement FindCoinsByScript for UTXO-set scan by script\n\nAdd node::FindCoinsByScript and wire it into the node interface as\nNode::getCoinsByScript(), then implement the DB-backed scan that iterates\nthe on-disk UTXO DB with a CCoinsViewCursor.",
      "committer": {
        "name": "Musa Haruna",
        "email": "hmusa3962@gmail.com",
        "date": "2025-09-14T11:04:16Z"
      },
      "author": {
        "name": "Musa Haruna",
        "email": "hmusa3962@gmail.com",
        "date": "2025-09-14T11:04:16Z"
      },
      "sha": "ba9f134734b61a40c5d6fc3f9d3836914a95d85c"
    },
    {
      "event": "labeled",
      "id": 19705655772,
      "node_id": "LE_lADOABII587LxCIazwAAAASWjHHc",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/19705655772",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-09-15T16:17:15Z",
      "label": {
        "name": "RPC/REST/ZMQ",
        "color": "0052cc"
      }
    },
    {
      "event": "commented",
      "id": 3292958552,
      "node_id": "IC_kwDOABII587ERo9Y",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/3292958552",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-09-15T16:17:17Z",
      "updated_at": "2025-09-16T11:56:15Z",
      "author_association": "CONTRIBUTOR",
      "body": "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--006a51241073e994b41acfe9ec718e94-->\n### Code Coverage & Benchmarks\nFor details see: https://corecheck.dev/bitcoin/bitcoin/pulls/33392.\n<!--021abf342d371248e50ceaed478a90ca-->\n### Reviews\nSee [the guideline](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#code-review) for information on the review process.\nA summary of reviews will appear here.\n<!--5faf32d7da4f0f540f40219e4f7537a3-->",
      "user": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/33392#issuecomment-3292958552",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/33392"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDdkYjc4YzM4MDViZDJiNDNiMjJjNzMwYWNiZDgzMTU3ZjcyZTIzYzc",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/7db78c3805bd2b43b22c730acbd83157f72e23c7",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/7db78c3805bd2b43b22c730acbd83157f72e23c7",
      "tree": {
        "sha": "c0d3e585158c66ee06984cbde108791eb4ce2e35",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/c0d3e585158c66ee06984cbde108791eb4ce2e35"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/ba9f134734b61a40c5d6fc3f9d3836914a95d85c",
          "sha": "ba9f134734b61a40c5d6fc3f9d3836914a95d85c",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/ba9f134734b61a40c5d6fc3f9d3836914a95d85c"
        }
      ],
      "message": "rpc: add optional scan_utxoset argument to getbalances\n\nExtend the getbalances RPC with a boolean `scan_utxoset` argument. When\nset to true, the UTXO set is scanned to recalculate the wallet's\nspendable balance independently of the wallet database. Through\nScanWalletUTXOSet function which  gathers wallet-owned scriptPubKeys\n(mine vs watch-only), queries the chainstate via getCoinsByScript,\nand tallies the resulting coins with coinbase maturity checks.\nThe function prefers spendable (mine) results when available,\notherwise falls back to watch-only.\n\nThe result object includes:\n - `utxo_scanned_balance`: recalculated spendable balance\n - `utxo_discrepancy`: only present if the scanned balance differs from\n   the wallet's trusted balance, with a suggested action to rescan or\n   reimport descriptors.\n\nThis allows users to detect balance mismatches caused by missing history\nand decide whether to perform a full rescan.",
      "committer": {
        "name": "Musa Haruna",
        "email": "hmusa3962@gmail.com",
        "date": "2025-09-16T11:50:11Z"
      },
      "author": {
        "name": "Musa Haruna",
        "email": "hmusa3962@gmail.com",
        "date": "2025-09-14T11:11:04Z"
      },
      "sha": "7db78c3805bd2b43b22c730acbd83157f72e23c7"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKGIyNGEyM2FjNjZiODNlMDQ1OWIxMTM2OThlMGVjNWMyMzdmZjkxZTE",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/b24a23ac66b83e0459b113698e0ec5c237ff91e1",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/b24a23ac66b83e0459b113698e0ec5c237ff91e1",
      "tree": {
        "sha": "5b874d80ef2171bc0ca9e3b75ed907ed9cf275ff",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/5b874d80ef2171bc0ca9e3b75ed907ed9cf275ff"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/7db78c3805bd2b43b22c730acbd83157f72e23c7",
          "sha": "7db78c3805bd2b43b22c730acbd83157f72e23c7",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/7db78c3805bd2b43b22c730acbd83157f72e23c7"
        }
      ],
      "message": "rpc: add optional scan_utxoset argument to getbalance\n\nExtend the getbalance RPC with a boolean `scan_utxoset` argument. When\nfalse (default), getbalance continues to return a numeric trusted balance\nfor backward compatibility.\n\nWhen true, getbalance instead returns an object with both:\n - `amount`: the trusted wallet balance, and\n - `scanned_amount`: the spendable balance recalculated by scanning the\n   UTXO set.\n\nIf the scanned amount exceeds the trusted balance, a `warnings` field is\nadded with guidance to run rescanblockchain or reimport descriptors.\n\nThis provides a lightweight way to cross-check wallet balances against\nthe UTXO set without performing a full rescan.",
      "committer": {
        "name": "Musa Haruna",
        "email": "hmusa3962@gmail.com",
        "date": "2025-09-16T11:54:59Z"
      },
      "author": {
        "name": "Musa Haruna",
        "email": "hmusa3962@gmail.com",
        "date": "2025-09-14T11:14:27Z"
      },
      "sha": "b24a23ac66b83e0459b113698e0ec5c237ff91e1"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDkzYmFjY2FhMzU2ZDk0ZmI5YTI1NzNmZmU0NWRkMTk2Nzk4ODY3Yjc",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/93baccaa356d94fb9a2573ffe45dd196798867b7",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/93baccaa356d94fb9a2573ffe45dd196798867b7",
      "tree": {
        "sha": "5eaca4e9875e75eaae954f1585cb4089e53296a9",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/5eaca4e9875e75eaae954f1585cb4089e53296a9"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/b24a23ac66b83e0459b113698e0ec5c237ff91e1",
          "sha": "b24a23ac66b83e0459b113698e0ec5c237ff91e1",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/b24a23ac66b83e0459b113698e0ec5c237ff91e1"
        }
      ],
      "message": "test: add wallet balance UTXO scan functional tests\n\nAdds new functional tests for wallet balance behavior when scanning the UTXO set:\n- Detect balance for spendable wallets with incorrect birthtime\n- Detect balance for watch-only wallets with incorrect birthtime\n- Ensure mempool-only outputs are excluded from UTXO scans\n\nAlso verifies wallet birthtime updates, rescans, and reindex interactions.",
      "committer": {
        "name": "Musa Haruna",
        "email": "hmusa3962@gmail.com",
        "date": "2025-09-16T11:54:59Z"
      },
      "author": {
        "name": "Musa Haruna",
        "email": "hmusa3962@gmail.com",
        "date": "2025-09-15T14:00:34Z"
      },
      "sha": "93baccaa356d94fb9a2573ffe45dd196798867b7"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 19724845449,
      "node_id": "HRFPE_lADOABII587LxCIazwAAAASXsUGJ",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/19724845449",
      "actor": {
        "login": "musaHaruna",
        "id": 124810379,
        "node_id": "U_kgDOB3B0iw",
        "avatar_url": "https://avatars.githubusercontent.com/u/124810379?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/musaHaruna",
        "html_url": "https://github.com/musaHaruna",
        "followers_url": "https://api.github.com/users/musaHaruna/followers",
        "following_url": "https://api.github.com/users/musaHaruna/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/musaHaruna/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/musaHaruna/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/musaHaruna/subscriptions",
        "organizations_url": "https://api.github.com/users/musaHaruna/orgs",
        "repos_url": "https://api.github.com/users/musaHaruna/repos",
        "events_url": "https://api.github.com/users/musaHaruna/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/musaHaruna/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": "93baccaa356d94fb9a2573ffe45dd196798867b7",
      "commit_url": "https://api.github.com/repos/musaHaruna/bitcoin/commits/93baccaa356d94fb9a2573ffe45dd196798867b7",
      "created_at": "2025-09-16T11:55:32Z"
    }
  ],
  "comments": []
}
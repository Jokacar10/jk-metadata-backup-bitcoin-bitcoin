{
  "type": "pull",
  "pull": {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31981",
    "id": 2370462287,
    "node_id": "PR_kwDOABII586NSmJP",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/31981",
    "diff_url": "https://github.com/bitcoin/bitcoin/pull/31981.diff",
    "patch_url": "https://github.com/bitcoin/bitcoin/pull/31981.patch",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/31981",
    "commits_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31981/commits",
    "review_comments_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31981/comments",
    "review_comment_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments%7B/number%7D",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/31981/comments",
    "statuses_url": "https://api.github.com/repos/bitcoin/bitcoin/statuses/afa092982bc71b3d72a9fc1cf326dc36fe914f6d",
    "number": 31981,
    "state": "open",
    "locked": false,
    "maintainer_can_modify": true,
    "title": "Add checkBlock() to Mining interface",
    "user": {
      "login": "Sjors",
      "id": 10217,
      "node_id": "MDQ6VXNlcjEwMjE3",
      "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Sjors",
      "html_url": "https://github.com/Sjors",
      "followers_url": "https://api.github.com/users/Sjors/followers",
      "following_url": "https://api.github.com/users/Sjors/following%7B/other_user%7D",
      "gists_url": "https://api.github.com/users/Sjors/gists%7B/gist_id%7D",
      "starred_url": "https://api.github.com/users/Sjors/starred%7B/owner%7D%7B/repo%7D",
      "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
      "organizations_url": "https://api.github.com/users/Sjors/orgs",
      "repos_url": "https://api.github.com/users/Sjors/repos",
      "events_url": "https://api.github.com/users/Sjors/events%7B/privacy%7D",
      "received_events_url": "https://api.github.com/users/Sjors/received_events",
      "type": "User",
      "site_admin": false,
      "patch_url": null
    },
    "body": "This PR adds the IPC equivalent of the `getblocktemplate` RPC in `proposal` mode.\r\n\r\nIn order to do so it moves `TestBlockValidity` to `ChainstateManager` and has is return error reasons as a string instead of `BlockValidationState`. This avoids complexity in IPC code for handling the latter struct.\r\n\r\nThe new Mining interface method is used in `miner_tests` and the `getblocktemplate` and `generateblock` RPC calls, so it has test coverage.\r\n\r\nThe `inconclusive-not-best-prevblk` check is moved from RPC\r\ncode to `TestBlockValidity`.\r\n\r\nTest coverage is increased by `mining_template_verification.py`.\r\n\r\nSuperseedes #31564\r\n\r\n## Background\r\n\r\n### Verifying block templates (no PoW)\r\n\r\nStratum v2 allows miners to generate their own block template. Pools may wish (or need) to verify these templates. This typically involves comparing mempools, asking miners to providing missing transactions and then reconstructing the proposed block.[^0] This is not sufficient to ensure a proposed block is actually valid. In some schemes miners could take advantage of incomplete validation[^1].\r\n\r\nThe Stratum Reference Implementation (SRI), currently the only Stratum v2 implementation, collects all missing mempool transactions, but does not yet fully verify the block.[^2]. It could use the `getblocktemplate` RPC in `proposal` mode, but using IPC is more performant, as it avoids serialising up to 4 MB of transaction data as JSON.\r\n\r\n(although SRI could use this PR, the Template Provider role doesn't need it, so this is _not_ part of #31098)\r\n\r\n[^0]: https://github.com/stratum-mining/sv2-spec/blob/main/06-Job-Declaration-Protocol.md  \r\n[^1]: https://delvingbitcoin.org/t/pplns-with-job-declaration/1099/45?u=sjors\r\n[^2]: https://github.com/stratum-mining/stratum/blob/v1.1.0/roles/jd-server/src/lib/job_declarator/message_handler.rs#L196\r\n",
    "labels": [
      {
        "id": 118378960,
        "node_id": "MDU6TGFiZWwxMTgzNzg5NjA=",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Mining",
        "name": "Mining",
        "color": "c7def8",
        "default": false
      }
    ],
    "created_at": "2025-03-04T11:04:38Z",
    "updated_at": "2025-03-04T12:20:16Z",
    "mergeable": true,
    "mergeable_state": "blocked",
    "merged": false,
    "merge_commit_sha": "ee724c771b30e66f10c6f60d42e67fd8de8e8988",
    "assignees": [],
    "requested_reviewers": [],
    "requested_teams": [],
    "rebaseable": true,
    "head": {
      "label": "Sjors:2025/03/checkBlock",
      "ref": "2025/03/checkBlock",
      "sha": "afa092982bc71b3d72a9fc1cf326dc36fe914f6d",
      "user": {
        "login": "Sjors",
        "id": 10217,
        "node_id": "MDQ6VXNlcjEwMjE3",
        "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Sjors",
        "html_url": "https://github.com/Sjors",
        "followers_url": "https://api.github.com/users/Sjors/followers",
        "following_url": "https://api.github.com/users/Sjors/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Sjors/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Sjors/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
        "organizations_url": "https://api.github.com/users/Sjors/orgs",
        "repos_url": "https://api.github.com/users/Sjors/repos",
        "events_url": "https://api.github.com/users/Sjors/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Sjors/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "repo": {
        "id": 92390696,
        "node_id": "MDEwOlJlcG9zaXRvcnk5MjM5MDY5Ng==",
        "name": "bitcoin",
        "full_name": "Sjors/bitcoin",
        "owner": {
          "login": "Sjors",
          "id": 10217,
          "node_id": "MDQ6VXNlcjEwMjE3",
          "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
          "gravatar_id": "",
          "url": "https://api.github.com/users/Sjors",
          "html_url": "https://github.com/Sjors",
          "followers_url": "https://api.github.com/users/Sjors/followers",
          "following_url": "https://api.github.com/users/Sjors/following%7B/other_user%7D",
          "gists_url": "https://api.github.com/users/Sjors/gists%7B/gist_id%7D",
          "starred_url": "https://api.github.com/users/Sjors/starred%7B/owner%7D%7B/repo%7D",
          "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
          "organizations_url": "https://api.github.com/users/Sjors/orgs",
          "repos_url": "https://api.github.com/users/Sjors/repos",
          "events_url": "https://api.github.com/users/Sjors/events%7B/privacy%7D",
          "received_events_url": "https://api.github.com/users/Sjors/received_events",
          "type": "User",
          "site_admin": false,
          "patch_url": null
        },
        "private": false,
        "html_url": "https://github.com/Sjors/bitcoin",
        "description": "Bitcoin Core integration/staging tree",
        "fork": true,
        "url": "https://api.github.com/repos/Sjors/bitcoin",
        "archive_url": "https://api.github.com/repos/Sjors/bitcoin/%7Barchive_format%7D%7B/ref%7D",
        "assignees_url": "https://api.github.com/repos/Sjors/bitcoin/assignees%7B/user%7D",
        "blobs_url": "https://api.github.com/repos/Sjors/bitcoin/git/blobs%7B/sha%7D",
        "branches_url": "https://api.github.com/repos/Sjors/bitcoin/branches%7B/branch%7D",
        "collaborators_url": "https://api.github.com/repos/Sjors/bitcoin/collaborators%7B/collaborator%7D",
        "comments_url": "https://api.github.com/repos/Sjors/bitcoin/comments%7B/number%7D",
        "commits_url": "https://api.github.com/repos/Sjors/bitcoin/commits%7B/sha%7D",
        "compare_url": "https://api.github.com/repos/Sjors/bitcoin/compare/%7Bbase%7D...%7Bhead%7D",
        "contents_url": "https://api.github.com/repos/Sjors/bitcoin/contents/%7B+path%7D",
        "contributors_url": "https://api.github.com/repos/Sjors/bitcoin/contributors",
        "deployments_url": "https://api.github.com/repos/Sjors/bitcoin/deployments",
        "downloads_url": "https://api.github.com/repos/Sjors/bitcoin/downloads",
        "events_url": "https://api.github.com/repos/Sjors/bitcoin/events",
        "forks_url": "https://api.github.com/repos/Sjors/bitcoin/forks",
        "git_commits_url": "https://api.github.com/repos/Sjors/bitcoin/git/commits%7B/sha%7D",
        "git_refs_url": "https://api.github.com/repos/Sjors/bitcoin/git/refs%7B/sha%7D",
        "git_tags_url": "https://api.github.com/repos/Sjors/bitcoin/git/tags%7B/sha%7D",
        "git_url": "git://github.com/Sjors/bitcoin.git",
        "issue_comment_url": "https://api.github.com/repos/Sjors/bitcoin/issues/comments%7B/number%7D",
        "issue_events_url": "https://api.github.com/repos/Sjors/bitcoin/issues/events%7B/number%7D",
        "issues_url": "https://api.github.com/repos/Sjors/bitcoin/issues%7B/number%7D",
        "keys_url": "https://api.github.com/repos/Sjors/bitcoin/keys%7B/key_id%7D",
        "labels_url": "https://api.github.com/repos/Sjors/bitcoin/labels%7B/name%7D",
        "languages_url": "https://api.github.com/repos/Sjors/bitcoin/languages",
        "merges_url": "https://api.github.com/repos/Sjors/bitcoin/merges",
        "milestones_url": "https://api.github.com/repos/Sjors/bitcoin/milestones%7B/number%7D",
        "notifications_url": "https://api.github.com/repos/Sjors/bitcoin/notifications%7B?since,all,participating}",
        "pulls_url": "https://api.github.com/repos/Sjors/bitcoin/pulls%7B/number%7D",
        "releases_url": "https://api.github.com/repos/Sjors/bitcoin/releases%7B/id%7D",
        "ssh_url": "git@github.com:Sjors/bitcoin.git",
        "stargazers_url": "https://api.github.com/repos/Sjors/bitcoin/stargazers",
        "statuses_url": "https://api.github.com/repos/Sjors/bitcoin/statuses/%7Bsha%7D",
        "subscribers_url": "https://api.github.com/repos/Sjors/bitcoin/subscribers",
        "subscription_url": "https://api.github.com/repos/Sjors/bitcoin/subscription",
        "tags_url": "https://api.github.com/repos/Sjors/bitcoin/tags",
        "teams_url": "https://api.github.com/repos/Sjors/bitcoin/teams",
        "trees_url": "https://api.github.com/repos/Sjors/bitcoin/git/trees%7B/sha%7D",
        "clone_url": "https://github.com/Sjors/bitcoin.git",
        "hooks_url": "https://api.github.com/repos/Sjors/bitcoin/hooks",
        "svn_url": "https://github.com/Sjors/bitcoin",
        "homepage": "https://bitcoin.org/en/download",
        "language": "C++",
        "forks_count": 10,
        "stargazers_count": 12,
        "watchers_count": 12,
        "size": 257762,
        "default_branch": "sv2",
        "open_issues_count": 13,
        "is_template": false,
        "topics": [],
        "has_issues": true,
        "has_projects": false,
        "has_wiki": false,
        "has_pages": false,
        "has_downloads": false,
        "archived": false,
        "disabled": false,
        "visibility": "public",
        "pushed_at": "2025-03-04T11:39:33Z",
        "created_at": "2017-05-25T10:05:54Z",
        "updated_at": "2025-02-21T15:16:56Z",
        "allow_forking": true,
        "license": {
          "key": "mit",
          "name": "MIT License",
          "node_id": "MDc6TGljZW5zZTEz",
          "spdx_id": "MIT",
          "url": "https://api.github.com/licenses/mit",
          "html_url": null,
          "description": null,
          "implementation": null,
          "permissions": null,
          "conditions": null,
          "limitations": null,
          "body": null,
          "featured": null
        }
      }
    },
    "base": {
      "label": "bitcoin:master",
      "ref": "master",
      "sha": "15717f0ef3960969ee550a4a41741987b86684dc",
      "user": {
        "login": "bitcoin",
        "id": 528860,
        "node_id": "MDEyOk9yZ2FuaXphdGlvbjUyODg2MA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/528860?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/bitcoin",
        "html_url": "https://github.com/bitcoin",
        "followers_url": "https://api.github.com/users/bitcoin/followers",
        "following_url": "https://api.github.com/users/bitcoin/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/bitcoin/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/bitcoin/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/bitcoin/subscriptions",
        "organizations_url": "https://api.github.com/users/bitcoin/orgs",
        "repos_url": "https://api.github.com/users/bitcoin/repos",
        "events_url": "https://api.github.com/users/bitcoin/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/bitcoin/received_events",
        "type": "Organization",
        "site_admin": false,
        "patch_url": null
      },
      "repo": {
        "id": 1181927,
        "node_id": "MDEwOlJlcG9zaXRvcnkxMTgxOTI3",
        "name": "bitcoin",
        "full_name": "bitcoin/bitcoin",
        "owner": {
          "login": "bitcoin",
          "id": 528860,
          "node_id": "MDEyOk9yZ2FuaXphdGlvbjUyODg2MA==",
          "avatar_url": "https://avatars.githubusercontent.com/u/528860?v=4",
          "gravatar_id": "",
          "url": "https://api.github.com/users/bitcoin",
          "html_url": "https://github.com/bitcoin",
          "followers_url": "https://api.github.com/users/bitcoin/followers",
          "following_url": "https://api.github.com/users/bitcoin/following%7B/other_user%7D",
          "gists_url": "https://api.github.com/users/bitcoin/gists%7B/gist_id%7D",
          "starred_url": "https://api.github.com/users/bitcoin/starred%7B/owner%7D%7B/repo%7D",
          "subscriptions_url": "https://api.github.com/users/bitcoin/subscriptions",
          "organizations_url": "https://api.github.com/users/bitcoin/orgs",
          "repos_url": "https://api.github.com/users/bitcoin/repos",
          "events_url": "https://api.github.com/users/bitcoin/events%7B/privacy%7D",
          "received_events_url": "https://api.github.com/users/bitcoin/received_events",
          "type": "Organization",
          "site_admin": false,
          "patch_url": null
        },
        "private": false,
        "html_url": "https://github.com/bitcoin/bitcoin",
        "description": "Bitcoin Core integration/staging tree",
        "fork": false,
        "url": "https://api.github.com/repos/bitcoin/bitcoin",
        "archive_url": "https://api.github.com/repos/bitcoin/bitcoin/%7Barchive_format%7D%7B/ref%7D",
        "assignees_url": "https://api.github.com/repos/bitcoin/bitcoin/assignees%7B/user%7D",
        "blobs_url": "https://api.github.com/repos/bitcoin/bitcoin/git/blobs%7B/sha%7D",
        "branches_url": "https://api.github.com/repos/bitcoin/bitcoin/branches%7B/branch%7D",
        "collaborators_url": "https://api.github.com/repos/bitcoin/bitcoin/collaborators%7B/collaborator%7D",
        "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/comments%7B/number%7D",
        "commits_url": "https://api.github.com/repos/bitcoin/bitcoin/commits%7B/sha%7D",
        "compare_url": "https://api.github.com/repos/bitcoin/bitcoin/compare/%7Bbase%7D...%7Bhead%7D",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/%7B+path%7D",
        "contributors_url": "https://api.github.com/repos/bitcoin/bitcoin/contributors",
        "deployments_url": "https://api.github.com/repos/bitcoin/bitcoin/deployments",
        "downloads_url": "https://api.github.com/repos/bitcoin/bitcoin/downloads",
        "events_url": "https://api.github.com/repos/bitcoin/bitcoin/events",
        "forks_url": "https://api.github.com/repos/bitcoin/bitcoin/forks",
        "git_commits_url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits%7B/sha%7D",
        "git_refs_url": "https://api.github.com/repos/bitcoin/bitcoin/git/refs%7B/sha%7D",
        "git_tags_url": "https://api.github.com/repos/bitcoin/bitcoin/git/tags%7B/sha%7D",
        "git_url": "git://github.com/bitcoin/bitcoin.git",
        "issue_comment_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments%7B/number%7D",
        "issue_events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events%7B/number%7D",
        "issues_url": "https://api.github.com/repos/bitcoin/bitcoin/issues%7B/number%7D",
        "keys_url": "https://api.github.com/repos/bitcoin/bitcoin/keys%7B/key_id%7D",
        "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/labels%7B/name%7D",
        "languages_url": "https://api.github.com/repos/bitcoin/bitcoin/languages",
        "merges_url": "https://api.github.com/repos/bitcoin/bitcoin/merges",
        "milestones_url": "https://api.github.com/repos/bitcoin/bitcoin/milestones%7B/number%7D",
        "notifications_url": "https://api.github.com/repos/bitcoin/bitcoin/notifications%7B?since,all,participating}",
        "pulls_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls%7B/number%7D",
        "releases_url": "https://api.github.com/repos/bitcoin/bitcoin/releases%7B/id%7D",
        "ssh_url": "git@github.com:bitcoin/bitcoin.git",
        "stargazers_url": "https://api.github.com/repos/bitcoin/bitcoin/stargazers",
        "statuses_url": "https://api.github.com/repos/bitcoin/bitcoin/statuses/%7Bsha%7D",
        "subscribers_url": "https://api.github.com/repos/bitcoin/bitcoin/subscribers",
        "subscription_url": "https://api.github.com/repos/bitcoin/bitcoin/subscription",
        "tags_url": "https://api.github.com/repos/bitcoin/bitcoin/tags",
        "teams_url": "https://api.github.com/repos/bitcoin/bitcoin/teams",
        "trees_url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees%7B/sha%7D",
        "clone_url": "https://github.com/bitcoin/bitcoin.git",
        "hooks_url": "https://api.github.com/repos/bitcoin/bitcoin/hooks",
        "svn_url": "https://github.com/bitcoin/bitcoin",
        "homepage": "https://bitcoincore.org/en/download",
        "language": "C++",
        "forks_count": 36873,
        "stargazers_count": 82309,
        "watchers_count": 82309,
        "size": 276113,
        "default_branch": "master",
        "open_issues_count": 678,
        "is_template": false,
        "topics": [
          "bitcoin",
          "c-plus-plus",
          "cryptocurrency",
          "cryptography",
          "p2p"
        ],
        "has_issues": true,
        "has_projects": true,
        "has_wiki": false,
        "has_pages": false,
        "has_downloads": false,
        "archived": false,
        "disabled": false,
        "visibility": "public",
        "pushed_at": "2025-03-04T00:40:44Z",
        "created_at": "2010-12-19T15:16:43Z",
        "updated_at": "2025-03-04T12:04:34Z",
        "allow_forking": true,
        "license": {
          "key": "mit",
          "name": "MIT License",
          "node_id": "MDc6TGljZW5zZTEz",
          "spdx_id": "MIT",
          "url": "https://api.github.com/licenses/mit",
          "html_url": null,
          "description": null,
          "implementation": null,
          "permissions": null,
          "conditions": null,
          "limitations": null,
          "body": null,
          "featured": null
        }
      }
    },
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31981"
      }
    },
    "author_association": "MEMBER",
    "draft": false,
    "additions": 441,
    "deletions": 122,
    "changed_files": 15,
    "commits": 4,
    "review_comments": 0,
    "comments": 2
  },
  "events": [
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDQ2ZmMxOTllMGZlNTgzOTA1Njk3NGY4NGEyZjBiMzZiOTMxZGE5Mzg",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/46fc199e0fe5839056974f84a2f0b36b931da938",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/46fc199e0fe5839056974f84a2f0b36b931da938",
      "tree": {
        "sha": "4b2289a4b170f9b399fbcc07e2237746e81015b2",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/4b2289a4b170f9b399fbcc07e2237746e81015b2"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree 4b2289a4b170f9b399fbcc07e2237746e81015b2\nparent 15717f0ef3960969ee550a4a41741987b86684dc\nauthor Sjors Provoost <sjors@sprovoost.nl> 1737630906 +0100\ncommitter Sjors Provoost <sjors@sprovoost.nl> 1741084187 -0500\n\nvalidation: refactor TestBlockValidity\n\nA later commit adds checkBlock() to the Mining interface. In order to\navoid passing BlockValidationState over IPC, this commit first\nrefactors TestBlockValidity to return a boolean instead, and pass failure\nreasons via a string.\n\nTestBlockValidity is moved into ChainstateManager which allows some\nsimplifications.\n\nComments are expanded.\n\nThe ContextualCheckBlockHeader check is moved to after CheckBlock,\nwhich is more similar to normal validation where context-free checks\nare done first.\n\nValidation failure reasons are no longer printed through LogError(),\nsince it depends on the caller whether this implies an actual bug\nin the node, or an externally sourced block that happens to be invalid.\nWhen called from getblocktemplate, via BlockAssembler::CreateNewBlock(),\nthis method already throws an std::runtime_error if validation fails.\n\nAdditionally it moves the inconclusive-not-best-prevblk check from RPC\ncode to TestBlockValidity.\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEE7ZvfetalXiMuhFJCV/+b28wwEAkFAmfG1hsACgkQV/+b28ww\nEAlA6g/+L6mZX7pyrezRcGScVY6iICCkE3r6nPAEtoMzQsc2efyf6qiGlXRYFWrH\nEudXMnIeo9pyHnXUjDByc1eB80TOB8MNOU9leGXSektwxRpxXEGC8yzotU54SaEd\nY5TcsQfPDrradinyNLTwFLXPu/NIPToL1rrDymIvnjCoI1ANCSl3irQkeUeDGJCA\ntIHyium5YY3hc0Oxh9JdJqQyYg+aXS7H8O2Q1sGUkIES3ZgR2TCZBSALmMo0AqJz\nv+39WzgdEUyFv4s0e+wBjgAdTVCnmNiRB+VZY/JLRu5idzCBb+szX7E2i/XY7X4y\nyMxaBzAaeSg/26JoIBocAoe6RmdKNplrZp4MsCmokG2H1CQs8mFyIG6i7VmqBixI\nCePA5tA8t07ePvi/TArPoIkCvfReVphouFmuY/j5rvjXxw1C47EJ4Gh1Kwu2y96s\n41W0rxX6e6Lzv3sMKVf5YVrjEZd4XP4j8Tp4aCIB/0HOZJ2wRn0UP+iKAyq8iGKP\ndbGuel+lr1CrwmWjsFX6m3NIgnlVRPyFVTy+IUKl/FdVd4duzlvejWeaQNAWLVFz\ngPTLMpTcAd3oKBP5K5CDwf/phC5KVPZcVgP2/TtQNk5Z2XB0yshpkmpuN4VDir8E\nMkL70oRJisYf+NzKp5JiOJCIR8dNuBkHtqQGJ4CTg96YsX1JQHk=\n=THs0\n-----END PGP SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/15717f0ef3960969ee550a4a41741987b86684dc",
          "sha": "15717f0ef3960969ee550a4a41741987b86684dc",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/15717f0ef3960969ee550a4a41741987b86684dc"
        }
      ],
      "message": "validation: refactor TestBlockValidity\n\nA later commit adds checkBlock() to the Mining interface. In order to\navoid passing BlockValidationState over IPC, this commit first\nrefactors TestBlockValidity to return a boolean instead, and pass failure\nreasons via a string.\n\nTestBlockValidity is moved into ChainstateManager which allows some\nsimplifications.\n\nComments are expanded.\n\nThe ContextualCheckBlockHeader check is moved to after CheckBlock,\nwhich is more similar to normal validation where context-free checks\nare done first.\n\nValidation failure reasons are no longer printed through LogError(),\nsince it depends on the caller whether this implies an actual bug\nin the node, or an externally sourced block that happens to be invalid.\nWhen called from getblocktemplate, via BlockAssembler::CreateNewBlock(),\nthis method already throws an std::runtime_error if validation fails.\n\nAdditionally it moves the inconclusive-not-best-prevblk check from RPC\ncode to TestBlockValidity.",
      "committer": {
        "name": "Sjors Provoost",
        "email": "sjors@sprovoost.nl",
        "date": "2025-03-04T10:29:47Z"
      },
      "author": {
        "name": "Sjors Provoost",
        "email": "sjors@sprovoost.nl",
        "date": "2025-01-23T11:15:06Z"
      },
      "sha": "46fc199e0fe5839056974f84a2f0b36b931da938"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKGI4ZDhkZDE0OGYxYjA0OTMxYzc2MjNmMTIzNjZmNTIzN2QxYjc1ZTM",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/b8d8dd148f1b04931c7623f12366f5237d1b75e3",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/b8d8dd148f1b04931c7623f12366f5237d1b75e3",
      "tree": {
        "sha": "2f59a939cb55ab3e97cb03117c1fab0421110bbc",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/2f59a939cb55ab3e97cb03117c1fab0421110bbc"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree 2f59a939cb55ab3e97cb03117c1fab0421110bbc\nparent 46fc199e0fe5839056974f84a2f0b36b931da938\nauthor Sjors Provoost <sjors@sprovoost.nl> 1737633594 +0100\ncommitter Sjors Provoost <sjors@sprovoost.nl> 1741084187 -0500\n\nipc: drop BlockValidationState special handling\n\nThe Mining interface avoids using BlockValidationState.\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEE7ZvfetalXiMuhFJCV/+b28wwEAkFAmfG1hsACgkQV/+b28ww\nEAlqPxAAgDECw+kw+lNt3uOVopE65KmJIkEwKwBdQjsXSdodiRvmXC5S8/mk95V3\nYYsyqqru0PHvZpKW/gLphuTYCG2O+aKU09lj9CJcUJG4QmjzxTuWgD2eEqa61Ew5\n/Hl/TJK2fCKKnWoRZFFOoHD5KGqU+6rvQ2Mfp7M7lXu/+ofRiTF/ul7Voi5etoHL\n93m3YOg+EozsNMIEPswE9KKJgjg1DEP0q1DcBcOrqXOEN1diAMVVnyu1BPYsOt3n\niyP3qpBKHBDRT0ZD2enpm2Mt81RcR0e4c/1ZBFe4Moeta7o3A9wj5p00WQzjLrch\nxFogI3IebSRgGtJxRt8M0PmJ3z2y8gXvfyp4N9OTujrbEtouItF7DOhIUHZGj/wo\nD/kgaiRYzne/3TxZ0h9gQwAty42+8cG1By2QzSSFPlpVuinAwRHmV39FJm6B0w/1\nu79ZhqPDTR1lwykWmyKTCEN4YJGb83h49v/Q/1PPyWEbZxf0YsXww9kjHJ3FBS45\n5Mo9z6a5ZzOWBlSdW4dFtca/yxOYMXWLIBstchIMyEFa6YwWEYe7Gpae0XfQ2xL9\nPtkqroatHb80NLWrm6RH/FLLS6suJ6lAF+6v46DyMyzll2jz47pm+1bUCdglHj7Y\n/E9Pz1fvZgRHnOMlhjgKyequp6PN3udBfbsMSd6gf4jO/vd46zU=\n=pigQ\n-----END PGP SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/46fc199e0fe5839056974f84a2f0b36b931da938",
          "sha": "46fc199e0fe5839056974f84a2f0b36b931da938",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/46fc199e0fe5839056974f84a2f0b36b931da938"
        }
      ],
      "message": "ipc: drop BlockValidationState special handling\n\nThe Mining interface avoids using BlockValidationState.",
      "committer": {
        "name": "Sjors Provoost",
        "email": "sjors@sprovoost.nl",
        "date": "2025-03-04T10:29:47Z"
      },
      "author": {
        "name": "Sjors Provoost",
        "email": "sjors@sprovoost.nl",
        "date": "2025-01-23T11:59:54Z"
      },
      "sha": "b8d8dd148f1b04931c7623f12366f5237d1b75e3"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKGU4MWI1YzAxZjNkMDMyMzBjM2QxM2E1ZThhMzhhNTY0NzE4MTUxZDA",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/e81b5c01f3d03230c3d13a5e8a38a564718151d0",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/e81b5c01f3d03230c3d13a5e8a38a564718151d0",
      "tree": {
        "sha": "489148e36d14a774cef272960a15fd81ca31973f",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/489148e36d14a774cef272960a15fd81ca31973f"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree 489148e36d14a774cef272960a15fd81ca31973f\nparent b8d8dd148f1b04931c7623f12366f5237d1b75e3\nauthor Sjors Provoost <sjors@sprovoost.nl> 1737628760 +0100\ncommitter Sjors Provoost <sjors@sprovoost.nl> 1741084187 -0500\n\nAdd checkBlock to Mining interface\n\nAnd use it in miner_tests, getblocktemplate and generateblock.\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEE7ZvfetalXiMuhFJCV/+b28wwEAkFAmfG1hsACgkQV/+b28ww\nEAmT1Q//UBcKVaB5wdZOdLg44qynPWLKRRgzIFxYkKk3Be/1r5IaHV/7rtjlzW2E\nwqq9mr2qcWWU7R4ZOiptZQPTyWx8QBGHSq8fMuOmEn8g59vDqh61RAavvc90m6E+\n5D9WptNDfEA+U6ViRduyRJxc1qL4YJ3ftugNaC9Ja0RnM7+ggeZ0lYspUc6DOylW\nSF5LSvzgp9w/a//r56Dn59DlgdXbmTnrvWxLOkFhoJ5kAIs3/q2+R2PMBZbDW541\ngDgVB3FjXMWBxzwGVTEW/BpgE1dlAR8UQniNh4CpdL/bp1mch1/NcDQSVBSldRhC\niTxSminXvxzKPAgmWwSYavJl5d0S0RZRBnxGPfkpyIoRHwYH/Afrl6HVf0dQV2/z\nxWIfb9AuS3U4JongV11d0VMC64JziXzhN4oZYtYGAbhiO0XcxENC2PSoR+JHytgh\nLnciktXHnE4I+SIdMZq+15GXioUR/owRZafgW4Rb4LlA7Emkn67wKCgD4/LcSlzt\n5HOmhx1y/hNCDdBNwaAU56O5Zf0iOnQTbsqDRWq9VJVwB8H0ejBTxHI3Jj5xY6Bl\nrB1KteHM0Y/vh6aThCGWnxiC5h2uno4XwBbvzKaR5cjqvIRU8aeK+JarhPrGLKAV\nSihdzdc13EPU7J4yS76RREz49JIUvQKdpNbuLA4+TK131KtTG6U=\n=2VWD\n-----END PGP SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/b8d8dd148f1b04931c7623f12366f5237d1b75e3",
          "sha": "b8d8dd148f1b04931c7623f12366f5237d1b75e3",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/b8d8dd148f1b04931c7623f12366f5237d1b75e3"
        }
      ],
      "message": "Add checkBlock to Mining interface\n\nAnd use it in miner_tests, getblocktemplate and generateblock.",
      "committer": {
        "name": "Sjors Provoost",
        "email": "sjors@sprovoost.nl",
        "date": "2025-03-04T10:29:47Z"
      },
      "author": {
        "name": "Sjors Provoost",
        "email": "sjors@sprovoost.nl",
        "date": "2025-01-23T10:39:20Z"
      },
      "sha": "e81b5c01f3d03230c3d13a5e8a38a564718151d0"
    },
    {
      "event": "commented",
      "id": 2697111800,
      "node_id": "IC_kwDOABII586gwqj4",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2697111800",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-03-04T11:04:41Z",
      "updated_at": "2025-03-04T12:02:02Z",
      "author_association": "CONTRIBUTOR",
      "body": "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--006a51241073e994b41acfe9ec718e94-->\n### Code Coverage & Benchmarks\nFor details see: https://corecheck.dev/bitcoin/bitcoin/pulls/31981.\n<!--021abf342d371248e50ceaed478a90ca-->\n### Reviews\nSee [the guideline](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#code-review) for information on the review process.\nA summary of reviews will appear here.\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* [#31283](https://github.com/bitcoin/bitcoin/pull/31283) (Add waitNext() to BlockTemplate interface by Sjors)\n* [#29415](https://github.com/bitcoin/bitcoin/pull/29415) (Broadcast own transactions only via short-lived Tor or I2P connections by vasild)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.\n",
      "user": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31981#issuecomment-2697111800",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/31981"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKGFmYTA5Mjk4MmJjNzFiM2Q3MmE5ZmMxY2YzMjZkYzM2ZmU5MTRmNmQ",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/afa092982bc71b3d72a9fc1cf326dc36fe914f6d",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/afa092982bc71b3d72a9fc1cf326dc36fe914f6d",
      "tree": {
        "sha": "7ef0b87f9571cc7408a8696f61eed7591eed8820",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/7ef0b87f9571cc7408a8696f61eed7591eed8820"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree 7ef0b87f9571cc7408a8696f61eed7591eed8820\nparent e81b5c01f3d03230c3d13a5e8a38a564718151d0\nauthor Sjors Provoost <sjors@sprovoost.nl> 1741088361 -0500\ncommitter Sjors Provoost <sjors@sprovoost.nl> 1741088361 -0500\n\ntest: more template verification tests\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEE7ZvfetalXiMuhFJCV/+b28wwEAkFAmfG5msACgkQV/+b28ww\nEAkpthAApw6Qof8xLp7YjcT7sa2lfqQQu+tKr388ZoPvQURbsZnq5BZMXpZlUK3I\nVkCO+7ekm3HSfhcqDzdOgqTxzK2VnYR8MliqTP8wJ0B9bUQMxLCCwGdk3W/0KO5b\n4xzJh0TO5bIeWrORUb7HLYEL7KWkLgYGNrefWGJfcy/XbS66FurtfY6ouc0AGZcE\n/3MAaIrSVuRFsRUq/XtZbDN8e/0aWo5J9ws7XgL+03aS1X4tIlcaBNgdPrflWIM0\nLw7C7UtEPBlmy3Sp0swEJt0RH2/KuwOtH91uiy/6vbE0P8aIeVJtuSRwSWr9mYlB\nXJ7PIS23WRU42jPb/8ZvelkHB5QYshJpj67yzafXmG8XrP4QjlmGV3OfAyjVDT0J\nWkcAgxCRi6et/DxKYqf1OK9ox0njIveSMWn2XPYlZeQnVv4Ki2p43OANu27kw/ku\ndf1oylyAd4shWRMvoEQg9mgB8/vCnGQz+yfqNOxMldXBLyyJ1eX50Gc5wm1CUagO\nYED/A+fMZr8FhuStagGpgVIsDOxGjSPmee5C/OiAO15DKcYFukiLIE8O0ZHghm5l\nhthSEoMN5gyLV2NKOs6CSwJOQRAMNXXY18CQwKGFCpqhCP8N7XIZptnPFZ5sVHT2\n9zTMhFWNrFiFWYrl3cb3Ho+BJui0O9Smut8g701QBxOPpWJumZI=\n=302s\n-----END PGP SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/e81b5c01f3d03230c3d13a5e8a38a564718151d0",
          "sha": "e81b5c01f3d03230c3d13a5e8a38a564718151d0",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/e81b5c01f3d03230c3d13a5e8a38a564718151d0"
        }
      ],
      "message": "test: more template verification tests",
      "committer": {
        "name": "Sjors Provoost",
        "email": "sjors@sprovoost.nl",
        "date": "2025-03-04T11:39:21Z"
      },
      "author": {
        "name": "Sjors Provoost",
        "email": "sjors@sprovoost.nl",
        "date": "2025-03-04T11:39:21Z"
      },
      "sha": "afa092982bc71b3d72a9fc1cf326dc36fe914f6d"
    },
    {
      "event": "commented",
      "id": 2697242642,
      "node_id": "IC_kwDOABII586gxKgS",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2697242642",
      "actor": {
        "login": "Sjors",
        "id": 10217,
        "node_id": "MDQ6VXNlcjEwMjE3",
        "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Sjors",
        "html_url": "https://github.com/Sjors",
        "followers_url": "https://api.github.com/users/Sjors/followers",
        "following_url": "https://api.github.com/users/Sjors/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Sjors/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Sjors/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
        "organizations_url": "https://api.github.com/users/Sjors/orgs",
        "repos_url": "https://api.github.com/users/Sjors/repos",
        "events_url": "https://api.github.com/users/Sjors/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Sjors/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-03-04T11:39:40Z",
      "updated_at": "2025-03-04T11:39:40Z",
      "author_association": "MEMBER",
      "body": "I also salvaged the functional tests from 15d841e41bb61f435dd3e60e99fa4db47d34a3a6.",
      "user": {
        "login": "Sjors",
        "id": 10217,
        "node_id": "MDQ6VXNlcjEwMjE3",
        "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Sjors",
        "html_url": "https://github.com/Sjors",
        "followers_url": "https://api.github.com/users/Sjors/followers",
        "following_url": "https://api.github.com/users/Sjors/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Sjors/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Sjors/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
        "organizations_url": "https://api.github.com/users/Sjors/orgs",
        "repos_url": "https://api.github.com/users/Sjors/repos",
        "events_url": "https://api.github.com/users/Sjors/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Sjors/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31981#issuecomment-2697242642",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/31981"
    },
    {
      "event": "labeled",
      "id": 16557252929,
      "node_id": "LE_lADOABII586sfKwPzwAAAAPa46FB",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/16557252929",
      "actor": {
        "login": "laanwj",
        "id": 126646,
        "node_id": "MDQ6VXNlcjEyNjY0Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/126646?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/laanwj",
        "html_url": "https://github.com/laanwj",
        "followers_url": "https://api.github.com/users/laanwj/followers",
        "following_url": "https://api.github.com/users/laanwj/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/laanwj/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/laanwj/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
        "organizations_url": "https://api.github.com/users/laanwj/orgs",
        "repos_url": "https://api.github.com/users/laanwj/repos",
        "events_url": "https://api.github.com/users/laanwj/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/laanwj/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-03-04T12:20:16Z",
      "label": {
        "name": "Mining",
        "color": "c7def8"
      }
    }
  ],
  "comments": []
}
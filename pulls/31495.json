{
  "type": "pull",
  "pull": {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31495",
    "id": 2234616382,
    "node_id": "PR_kwDOABII586FMYo-",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/31495",
    "diff_url": "https://github.com/bitcoin/bitcoin/pull/31495.diff",
    "patch_url": "https://github.com/bitcoin/bitcoin/pull/31495.patch",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/31495",
    "commits_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31495/commits",
    "review_comments_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31495/comments",
    "review_comment_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments%7B/number%7D",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/31495/comments",
    "statuses_url": "https://api.github.com/repos/bitcoin/bitcoin/statuses/d8608d140cf3064ecccd09ce5714a04375d8a78e",
    "number": 31495,
    "state": "open",
    "locked": false,
    "maintainer_can_modify": true,
    "title": "wallet: Utilize IsMine() and CanProvide() in migration to cover edge cases",
    "user": {
      "login": "achow101",
      "id": 3782274,
      "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/achow101",
      "html_url": "https://github.com/achow101",
      "followers_url": "https://api.github.com/users/achow101/followers",
      "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
      "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
      "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
      "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
      "organizations_url": "https://api.github.com/users/achow101/orgs",
      "repos_url": "https://api.github.com/users/achow101/repos",
      "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
      "received_events_url": "https://api.github.com/users/achow101/received_events",
      "type": "User",
      "site_admin": false,
      "patch_url": null
    },
    "body": "The legacy wallet `IsMine()` is essentially a black box that would tell us whether the wallet is watching an output script. In order to migrate legacy wallets to descriptor wallets, we need to be able to compute all of the output scripts that a legacy wallet would watch. The original approach for this was to understand `IsMine()` and write a function which would be its inverse. This was partially done in the original migration code, and attempted to be completed in #30328. However, further analysis of `IsMine()` has continued to reveal additional edge cases which make writing an inverse function increasingly difficult to verify correctness.\r\n\r\nThis PR instead changes migration to utilize `IsMine()` to produce the output scripts by first computing a superset of all of the output scripts that `IsMine()` would watch and testing each script against `IsMine()` to filter for the ones that actually are watched. The superset is constructed by computing all possible output scripts for the keys and scripts in the wallet - for keys, every key could be a P2PK, P2PKH, P2WPKH, and P2SH-P2WPKH; for scripts, every script could be an output script, the redeemScript of a P2SH, the witnessScript of a P2WSH, and the witnessScript of a P2SH-P2WSH.\r\n\r\nAdditionally, the legacy wallet can contain scripts that are redeemScripts and witnessScripts, while not watching for any output script utilizing that script. These are known as solvable scripts and are migrated to a separate \"solvables\" wallet. The previous approach to identifying these solvables was similar to identifying output scripts - finding known solvable conditions and computing the scripts. However, this also can miss scripts, so the solvables are now identified in a manner similar to the output scripts but using the function `CanProvide()`. Using the same superset as before, all output scripts which are `ISMINE_NO` are put through `CanProvide()` which will perform a dummy signing and then a key lookup to determine whether the legacy wallet could provide any solving data for the output script. The scripts that pass will have their descriptors inferred and the script included in the solvables wallet.\r\n\r\nThe main downside of this approach is that `IsMine()` and `CanProvide()` can no longer be deleted. They will need to be refactored to be migration only code instead in #28710.\r\n\r\nLastly, I've added 2 test cases for the edge cases that prompted this change of approach. In particular, miniscript witnessScripts and `rawtr()` output scripts are  solvable and signable in a legacy wallet, although never `ISMINE_SPENDABLE`.",
    "labels": [
      {
        "id": 149424,
        "node_id": "MDU6TGFiZWwxNDk0MjQ=",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Wallet",
        "name": "Wallet",
        "color": "08a781",
        "default": false
      }
    ],
    "created_at": "2024-12-13T22:07:10Z",
    "updated_at": "2025-01-05T19:16:55Z",
    "mergeable": true,
    "mergeable_state": "blocked",
    "merge_commit_sha": "7f80d13445634bcd1d2a644de1d5774ec52198bc",
    "assignees": [],
    "requested_reviewers": [],
    "requested_teams": [],
    "rebaseable": true,
    "head": {
      "label": "achow101:migrate-corner-case-scripts",
      "ref": "migrate-corner-case-scripts",
      "sha": "d8608d140cf3064ecccd09ce5714a04375d8a78e",
      "user": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "repo": {
        "id": 45006379,
        "node_id": "MDEwOlJlcG9zaXRvcnk0NTAwNjM3OQ==",
        "name": "bitcoin",
        "full_name": "achow101/bitcoin",
        "owner": {
          "login": "achow101",
          "id": 3782274,
          "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
          "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
          "gravatar_id": "",
          "url": "https://api.github.com/users/achow101",
          "html_url": "https://github.com/achow101",
          "followers_url": "https://api.github.com/users/achow101/followers",
          "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
          "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
          "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
          "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
          "organizations_url": "https://api.github.com/users/achow101/orgs",
          "repos_url": "https://api.github.com/users/achow101/repos",
          "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
          "received_events_url": "https://api.github.com/users/achow101/received_events",
          "type": "User",
          "site_admin": false,
          "patch_url": null
        },
        "private": false,
        "html_url": "https://github.com/achow101/bitcoin",
        "description": "Bitcoin Core integration/staging tree",
        "fork": true,
        "url": "https://api.github.com/repos/achow101/bitcoin",
        "archive_url": "https://api.github.com/repos/achow101/bitcoin/%7Barchive_format%7D%7B/ref%7D",
        "assignees_url": "https://api.github.com/repos/achow101/bitcoin/assignees%7B/user%7D",
        "blobs_url": "https://api.github.com/repos/achow101/bitcoin/git/blobs%7B/sha%7D",
        "branches_url": "https://api.github.com/repos/achow101/bitcoin/branches%7B/branch%7D",
        "collaborators_url": "https://api.github.com/repos/achow101/bitcoin/collaborators%7B/collaborator%7D",
        "comments_url": "https://api.github.com/repos/achow101/bitcoin/comments%7B/number%7D",
        "commits_url": "https://api.github.com/repos/achow101/bitcoin/commits%7B/sha%7D",
        "compare_url": "https://api.github.com/repos/achow101/bitcoin/compare/%7Bbase%7D...%7Bhead%7D",
        "contents_url": "https://api.github.com/repos/achow101/bitcoin/contents/%7B+path%7D",
        "contributors_url": "https://api.github.com/repos/achow101/bitcoin/contributors",
        "deployments_url": "https://api.github.com/repos/achow101/bitcoin/deployments",
        "downloads_url": "https://api.github.com/repos/achow101/bitcoin/downloads",
        "events_url": "https://api.github.com/repos/achow101/bitcoin/events",
        "forks_url": "https://api.github.com/repos/achow101/bitcoin/forks",
        "git_commits_url": "https://api.github.com/repos/achow101/bitcoin/git/commits%7B/sha%7D",
        "git_refs_url": "https://api.github.com/repos/achow101/bitcoin/git/refs%7B/sha%7D",
        "git_tags_url": "https://api.github.com/repos/achow101/bitcoin/git/tags%7B/sha%7D",
        "git_url": "git://github.com/achow101/bitcoin.git",
        "issue_comment_url": "https://api.github.com/repos/achow101/bitcoin/issues/comments%7B/number%7D",
        "issue_events_url": "https://api.github.com/repos/achow101/bitcoin/issues/events%7B/number%7D",
        "issues_url": "https://api.github.com/repos/achow101/bitcoin/issues%7B/number%7D",
        "keys_url": "https://api.github.com/repos/achow101/bitcoin/keys%7B/key_id%7D",
        "labels_url": "https://api.github.com/repos/achow101/bitcoin/labels%7B/name%7D",
        "languages_url": "https://api.github.com/repos/achow101/bitcoin/languages",
        "merges_url": "https://api.github.com/repos/achow101/bitcoin/merges",
        "milestones_url": "https://api.github.com/repos/achow101/bitcoin/milestones%7B/number%7D",
        "notifications_url": "https://api.github.com/repos/achow101/bitcoin/notifications%7B?since,all,participating}",
        "pulls_url": "https://api.github.com/repos/achow101/bitcoin/pulls%7B/number%7D",
        "releases_url": "https://api.github.com/repos/achow101/bitcoin/releases%7B/id%7D",
        "ssh_url": "git@github.com:achow101/bitcoin.git",
        "stargazers_url": "https://api.github.com/repos/achow101/bitcoin/stargazers",
        "statuses_url": "https://api.github.com/repos/achow101/bitcoin/statuses/%7Bsha%7D",
        "subscribers_url": "https://api.github.com/repos/achow101/bitcoin/subscribers",
        "subscription_url": "https://api.github.com/repos/achow101/bitcoin/subscription",
        "tags_url": "https://api.github.com/repos/achow101/bitcoin/tags",
        "teams_url": "https://api.github.com/repos/achow101/bitcoin/teams",
        "trees_url": "https://api.github.com/repos/achow101/bitcoin/git/trees%7B/sha%7D",
        "clone_url": "https://github.com/achow101/bitcoin.git",
        "hooks_url": "https://api.github.com/repos/achow101/bitcoin/hooks",
        "svn_url": "https://github.com/achow101/bitcoin",
        "homepage": "https://bitcoin.org/en/download",
        "language": "C++",
        "forks_count": 8,
        "stargazers_count": 39,
        "watchers_count": 39,
        "size": 287805,
        "default_branch": "master",
        "open_issues_count": 0,
        "is_template": false,
        "topics": [],
        "has_issues": false,
        "has_projects": true,
        "has_wiki": false,
        "has_pages": false,
        "has_downloads": false,
        "archived": false,
        "disabled": false,
        "visibility": "public",
        "pushed_at": "2025-01-03T18:13:10Z",
        "created_at": "2015-10-27T00:20:28Z",
        "updated_at": "2024-10-04T23:43:44Z",
        "allow_forking": true,
        "license": {
          "key": "mit",
          "name": "MIT License",
          "node_id": "MDc6TGljZW5zZTEz",
          "spdx_id": "MIT",
          "url": "https://api.github.com/licenses/mit",
          "html_url": null,
          "description": null,
          "implementation": null,
          "permissions": null,
          "conditions": null,
          "limitations": null,
          "body": null,
          "featured": null
        }
      }
    },
    "base": {
      "label": "bitcoin:master",
      "ref": "master",
      "sha": "b042c4f0538c6f9cdf8efbcef552796851e38a85",
      "user": {
        "login": "bitcoin",
        "id": 528860,
        "node_id": "MDEyOk9yZ2FuaXphdGlvbjUyODg2MA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/528860?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/bitcoin",
        "html_url": "https://github.com/bitcoin",
        "followers_url": "https://api.github.com/users/bitcoin/followers",
        "following_url": "https://api.github.com/users/bitcoin/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/bitcoin/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/bitcoin/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/bitcoin/subscriptions",
        "organizations_url": "https://api.github.com/users/bitcoin/orgs",
        "repos_url": "https://api.github.com/users/bitcoin/repos",
        "events_url": "https://api.github.com/users/bitcoin/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/bitcoin/received_events",
        "type": "Organization",
        "site_admin": false,
        "patch_url": null
      },
      "repo": {
        "id": 1181927,
        "node_id": "MDEwOlJlcG9zaXRvcnkxMTgxOTI3",
        "name": "bitcoin",
        "full_name": "bitcoin/bitcoin",
        "owner": {
          "login": "bitcoin",
          "id": 528860,
          "node_id": "MDEyOk9yZ2FuaXphdGlvbjUyODg2MA==",
          "avatar_url": "https://avatars.githubusercontent.com/u/528860?v=4",
          "gravatar_id": "",
          "url": "https://api.github.com/users/bitcoin",
          "html_url": "https://github.com/bitcoin",
          "followers_url": "https://api.github.com/users/bitcoin/followers",
          "following_url": "https://api.github.com/users/bitcoin/following%7B/other_user%7D",
          "gists_url": "https://api.github.com/users/bitcoin/gists%7B/gist_id%7D",
          "starred_url": "https://api.github.com/users/bitcoin/starred%7B/owner%7D%7B/repo%7D",
          "subscriptions_url": "https://api.github.com/users/bitcoin/subscriptions",
          "organizations_url": "https://api.github.com/users/bitcoin/orgs",
          "repos_url": "https://api.github.com/users/bitcoin/repos",
          "events_url": "https://api.github.com/users/bitcoin/events%7B/privacy%7D",
          "received_events_url": "https://api.github.com/users/bitcoin/received_events",
          "type": "Organization",
          "site_admin": false,
          "patch_url": null
        },
        "private": false,
        "html_url": "https://github.com/bitcoin/bitcoin",
        "description": "Bitcoin Core integration/staging tree",
        "fork": false,
        "url": "https://api.github.com/repos/bitcoin/bitcoin",
        "archive_url": "https://api.github.com/repos/bitcoin/bitcoin/%7Barchive_format%7D%7B/ref%7D",
        "assignees_url": "https://api.github.com/repos/bitcoin/bitcoin/assignees%7B/user%7D",
        "blobs_url": "https://api.github.com/repos/bitcoin/bitcoin/git/blobs%7B/sha%7D",
        "branches_url": "https://api.github.com/repos/bitcoin/bitcoin/branches%7B/branch%7D",
        "collaborators_url": "https://api.github.com/repos/bitcoin/bitcoin/collaborators%7B/collaborator%7D",
        "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/comments%7B/number%7D",
        "commits_url": "https://api.github.com/repos/bitcoin/bitcoin/commits%7B/sha%7D",
        "compare_url": "https://api.github.com/repos/bitcoin/bitcoin/compare/%7Bbase%7D...%7Bhead%7D",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/%7B+path%7D",
        "contributors_url": "https://api.github.com/repos/bitcoin/bitcoin/contributors",
        "deployments_url": "https://api.github.com/repos/bitcoin/bitcoin/deployments",
        "downloads_url": "https://api.github.com/repos/bitcoin/bitcoin/downloads",
        "events_url": "https://api.github.com/repos/bitcoin/bitcoin/events",
        "forks_url": "https://api.github.com/repos/bitcoin/bitcoin/forks",
        "git_commits_url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits%7B/sha%7D",
        "git_refs_url": "https://api.github.com/repos/bitcoin/bitcoin/git/refs%7B/sha%7D",
        "git_tags_url": "https://api.github.com/repos/bitcoin/bitcoin/git/tags%7B/sha%7D",
        "git_url": "git://github.com/bitcoin/bitcoin.git",
        "issue_comment_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments%7B/number%7D",
        "issue_events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events%7B/number%7D",
        "issues_url": "https://api.github.com/repos/bitcoin/bitcoin/issues%7B/number%7D",
        "keys_url": "https://api.github.com/repos/bitcoin/bitcoin/keys%7B/key_id%7D",
        "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/labels%7B/name%7D",
        "languages_url": "https://api.github.com/repos/bitcoin/bitcoin/languages",
        "merges_url": "https://api.github.com/repos/bitcoin/bitcoin/merges",
        "milestones_url": "https://api.github.com/repos/bitcoin/bitcoin/milestones%7B/number%7D",
        "notifications_url": "https://api.github.com/repos/bitcoin/bitcoin/notifications%7B?since,all,participating}",
        "pulls_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls%7B/number%7D",
        "releases_url": "https://api.github.com/repos/bitcoin/bitcoin/releases%7B/id%7D",
        "ssh_url": "git@github.com:bitcoin/bitcoin.git",
        "stargazers_url": "https://api.github.com/repos/bitcoin/bitcoin/stargazers",
        "statuses_url": "https://api.github.com/repos/bitcoin/bitcoin/statuses/%7Bsha%7D",
        "subscribers_url": "https://api.github.com/repos/bitcoin/bitcoin/subscribers",
        "subscription_url": "https://api.github.com/repos/bitcoin/bitcoin/subscription",
        "tags_url": "https://api.github.com/repos/bitcoin/bitcoin/tags",
        "teams_url": "https://api.github.com/repos/bitcoin/bitcoin/teams",
        "trees_url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees%7B/sha%7D",
        "clone_url": "https://github.com/bitcoin/bitcoin.git",
        "hooks_url": "https://api.github.com/repos/bitcoin/bitcoin/hooks",
        "svn_url": "https://github.com/bitcoin/bitcoin",
        "homepage": "https://bitcoincore.org/en/download",
        "language": "C++",
        "forks_count": 36482,
        "stargazers_count": 81110,
        "watchers_count": 81110,
        "size": 273906,
        "default_branch": "master",
        "open_issues_count": 691,
        "is_template": false,
        "topics": [
          "bitcoin",
          "c-plus-plus",
          "cryptocurrency",
          "cryptography",
          "p2p"
        ],
        "has_issues": true,
        "has_projects": true,
        "has_wiki": false,
        "has_pages": false,
        "has_downloads": false,
        "archived": false,
        "disabled": false,
        "visibility": "public",
        "pushed_at": "2025-01-03T18:58:26Z",
        "created_at": "2010-12-19T15:16:43Z",
        "updated_at": "2025-01-05T19:53:22Z",
        "allow_forking": true,
        "license": {
          "key": "mit",
          "name": "MIT License",
          "node_id": "MDc6TGljZW5zZTEz",
          "spdx_id": "MIT",
          "url": "https://api.github.com/licenses/mit",
          "html_url": null,
          "description": null,
          "implementation": null,
          "permissions": null,
          "conditions": null,
          "limitations": null,
          "body": null,
          "featured": null
        }
      }
    },
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31495"
      }
    },
    "author_association": "MEMBER",
    "draft": false,
    "additions": 403,
    "deletions": 96,
    "changed_files": 3,
    "commits": 9,
    "review_comments": 2,
    "comments": 2
  },
  "events": [
    {
      "event": "commented",
      "id": 2542459023,
      "node_id": "IC_kwDOABII586XitiP",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2542459023",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-12-13T22:07:13Z",
      "updated_at": "2025-01-05T19:16:55Z",
      "author_association": "CONTRIBUTOR",
      "body": "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--006a51241073e994b41acfe9ec718e94-->\n### Code Coverage & Benchmarks\nFor details see: https://corecheck.dev/bitcoin/bitcoin/pulls/31495.\n<!--021abf342d371248e50ceaed478a90ca-->\n### Reviews\nSee [the guideline](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#code-review) for information on the review process.\n| Type | Reviewers |\n| ---- | --------- |\n| Concept ACK | [sipa](https://github.com/bitcoin/bitcoin/pull/31495#issuecomment-2543324905), [theStack](https://github.com/bitcoin/bitcoin/pull/31495#pullrequestreview-2530939442) |\n\nIf your review is incorrectly listed, please react with 👎 to this comment and the bot will ignore it on the next update.\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* [#31423](https://github.com/bitcoin/bitcoin/pull/31423) (wallet: migration, don't create spendable wallet from a watch-only legacy wallet by furszy)\n* [#28710](https://github.com/bitcoin/bitcoin/pull/28710) (Remove the legacy wallet and BDB dependency by achow101)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.\n",
      "user": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31495#issuecomment-2542459023",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/31495"
    },
    {
      "event": "labeled",
      "id": 15654009826,
      "node_id": "LE_lADOABII586jRhxQzwAAAAOlDTvi",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/15654009826",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-12-13T22:07:16Z",
      "label": {
        "name": "Wallet",
        "color": "08a781"
      }
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDg4YjY3Yzk1Y2JjOWMzYWU3NWNjYmMzOWU0YWJhMjE1Yjk5MTBiOGI",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/88b67c95cbc9c3ae75ccbc39e4aba215b9910b8b",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/88b67c95cbc9c3ae75ccbc39e4aba215b9910b8b",
      "tree": {
        "sha": "030d65d434dce1dfb93abb49570a6f42a41ef3d6",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/030d65d434dce1dfb93abb49570a6f42a41ef3d6"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/d73f37dda221835b5109ede1b84db2dc7c4b74a1",
          "sha": "d73f37dda221835b5109ede1b84db2dc7c4b74a1",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/d73f37dda221835b5109ede1b84db2dc7c4b74a1"
        }
      ],
      "message": "test: Extra verification that migratewallet migrates",
      "committer": {
        "name": "Ava Chow",
        "email": "github@achow101.com",
        "date": "2024-12-13T22:10:25Z"
      },
      "author": {
        "name": "Ava Chow",
        "email": "github@achow101.com",
        "date": "2024-12-07T16:34:26Z"
      },
      "sha": "88b67c95cbc9c3ae75ccbc39e4aba215b9910b8b"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 15654029170,
      "node_id": "HRFPE_lADOABII586jRhxQzwAAAAOlDYdy",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/15654029170",
      "actor": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": "ef20f9f476aa9e38df8358f4a0293cb669f2a336",
      "commit_url": "https://api.github.com/repos/achow101/bitcoin/commits/ef20f9f476aa9e38df8358f4a0293cb669f2a336",
      "created_at": "2024-12-13T22:10:29Z"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDljMjFiOGY1ODE1NDJhZWUwZjU5OWYxZDg5OTZhYzk3MDcxYmRmNmY",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/9c21b8f581542aee0f599f1d8996ac97071bdf6f",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/9c21b8f581542aee0f599f1d8996ac97071bdf6f",
      "tree": {
        "sha": "4cd7b5e18ab5fa475a5f062993b5fdb43f94bafe",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/4cd7b5e18ab5fa475a5f062993b5fdb43f94bafe"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/88b67c95cbc9c3ae75ccbc39e4aba215b9910b8b",
          "sha": "88b67c95cbc9c3ae75ccbc39e4aba215b9910b8b",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/88b67c95cbc9c3ae75ccbc39e4aba215b9910b8b"
        }
      ],
      "message": "tests: Test migration of additional P2WSH scripts",
      "committer": {
        "name": "Ava Chow",
        "email": "github@achow101.com",
        "date": "2024-12-13T22:10:43Z"
      },
      "author": {
        "name": "Ava Chow",
        "email": "github@achow101.com",
        "date": "2024-11-16T01:22:18Z"
      },
      "sha": "9c21b8f581542aee0f599f1d8996ac97071bdf6f"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDIyZjZjZGQ0NDA3MWE4YTliNmU1YWIxYmJmMzExODc3MTBlNWU4ZDI",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/22f6cdd44071a8a9b6e5ab1bbf31187710e5e8d2",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/22f6cdd44071a8a9b6e5ab1bbf31187710e5e8d2",
      "tree": {
        "sha": "61b1f0e5c97f1ff4b506939a2129f5de4c5da6e0",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/61b1f0e5c97f1ff4b506939a2129f5de4c5da6e0"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/9c21b8f581542aee0f599f1d8996ac97071bdf6f",
          "sha": "9c21b8f581542aee0f599f1d8996ac97071bdf6f",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/9c21b8f581542aee0f599f1d8996ac97071bdf6f"
        }
      ],
      "message": "legacy spkm: Move CanProvide to LegacyDataSPKM\n\nThis function will be needed in migration",
      "committer": {
        "name": "Ava Chow",
        "email": "github@achow101.com",
        "date": "2024-12-13T22:10:43Z"
      },
      "author": {
        "name": "Ava Chow",
        "email": "github@achow101.com",
        "date": "2024-12-13T19:41:00Z"
      },
      "sha": "22f6cdd44071a8a9b6e5ab1bbf31187710e5e8d2"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDYzN2E0Y2U5ZDNjM2EwMWQyN2ExZDFiYjFmMTNjNWE4NjhlYzZmMzY",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/637a4ce9d3c3a01d27a1d1bb1f13c5a868ec6f36",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/637a4ce9d3c3a01d27a1d1bb1f13c5a868ec6f36",
      "tree": {
        "sha": "305b9a4dc8a4074c42a7cca78fdefd00d497eefa",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/305b9a4dc8a4074c42a7cca78fdefd00d497eefa"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/22f6cdd44071a8a9b6e5ab1bbf31187710e5e8d2",
          "sha": "22f6cdd44071a8a9b6e5ab1bbf31187710e5e8d2",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/22f6cdd44071a8a9b6e5ab1bbf31187710e5e8d2"
        }
      ],
      "message": "legacy spkm: use IsMine() to extract watched output scripts\n\nInstead of (partially) trying to reverse IsMine() to get the output\nscripts that a LegacySPKM would track, we can preserve it in migration\nonly code and utilize it to get an accurate set of output scripts.\n\nThis is accomplished by computing a set of output script candidates from\nmap(Crypted)Keys, mapScripts, and setWatchOnly. This candidate set is an\nupper bound on the scripts tracked by the wallet. Then IsMine() is used\nto filter to the exact output scripts that LegacySPKM would track.\n\nBy changing GetScriptPubKeys() this way, we can avoid complexities in\nreversing IsMine() and get a more complete set of output scripts.",
      "committer": {
        "name": "Ava Chow",
        "email": "github@achow101.com",
        "date": "2024-12-13T22:10:43Z"
      },
      "author": {
        "name": "Ava Chow",
        "email": "github@achow101.com",
        "date": "2024-12-13T19:41:32Z"
      },
      "sha": "637a4ce9d3c3a01d27a1d1bb1f13c5a868ec6f36"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDVlZDg0NjRjMGJlNTJjOTI1NTdhMmM5NGUxMGMyOTVmMDUzOGYyZmE",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/5ed8464c0be52c92557a2c94e10c295f0538f2fa",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/5ed8464c0be52c92557a2c94e10c295f0538f2fa",
      "tree": {
        "sha": "a39f3b9935efcb3e3c7287b09682d61d21d4aa76",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/a39f3b9935efcb3e3c7287b09682d61d21d4aa76"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/637a4ce9d3c3a01d27a1d1bb1f13c5a868ec6f36",
          "sha": "637a4ce9d3c3a01d27a1d1bb1f13c5a868ec6f36",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/637a4ce9d3c3a01d27a1d1bb1f13c5a868ec6f36"
        }
      ],
      "message": "migration: Skip descriptors which do not parse\n\nInferDescriptors can sometimes make descriptors which are actually\ninvalid and cannot be parsed. Detect and skip such descriptors by doing\na Parse() check before adding the descriptor to the wallet.",
      "committer": {
        "name": "Ava Chow",
        "email": "github@achow101.com",
        "date": "2024-12-13T22:10:43Z"
      },
      "author": {
        "name": "Ava Chow",
        "email": "github@achow101.com",
        "date": "2024-12-13T19:45:32Z"
      },
      "sha": "5ed8464c0be52c92557a2c94e10c295f0538f2fa"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDIyZWMxZGMzMWZhM2UxYWE4NjVjNDM3MjdjMTFjMWFkMWYzOGU5MjQ",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/22ec1dc31fa3e1aa865c43727c11c1ad1f38e924",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/22ec1dc31fa3e1aa865c43727c11c1ad1f38e924",
      "tree": {
        "sha": "618ba17ee1dc2ddbe3ee78e19103ee20fef20727",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/618ba17ee1dc2ddbe3ee78e19103ee20fef20727"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/5ed8464c0be52c92557a2c94e10c295f0538f2fa",
          "sha": "5ed8464c0be52c92557a2c94e10c295f0538f2fa",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/5ed8464c0be52c92557a2c94e10c295f0538f2fa"
        }
      ],
      "message": "wallet migration: Determine Solvables with CanProvide\n\nLegacySPKM would determine whether it could provide any script data to a\ntransaction through the use of the CanProvide function. Instead of\npartially reversing signing logic to figure out the output scripts of\nsolvable things, we use the same candidate set approach in\nGetScriptPubKeys() and instead filter the candidate set first for\nthings that are ISMINE_NO, and second with CanProvide(). This should\ngive a more accurate solvables wallet.",
      "committer": {
        "name": "Ava Chow",
        "email": "github@achow101.com",
        "date": "2024-12-13T22:10:43Z"
      },
      "author": {
        "name": "Ava Chow",
        "email": "github@achow101.com",
        "date": "2024-12-13T19:46:31Z"
      },
      "sha": "22ec1dc31fa3e1aa865c43727c11c1ad1f38e924"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 15654040451,
      "node_id": "HRFPE_lADOABII586jRhxQzwAAAAOlDbOD",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/15654040451",
      "actor": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": "1780617cdb38742d820bfb2d66a798c0e3ce3afc",
      "commit_url": "https://api.github.com/repos/achow101/bitcoin/commits/1780617cdb38742d820bfb2d66a798c0e3ce3afc",
      "created_at": "2024-12-13T22:12:19Z"
    },
    {
      "event": "commented",
      "id": 2543324905,
      "node_id": "IC_kwDOABII586XmA7p",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2543324905",
      "actor": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-12-14T19:46:53Z",
      "updated_at": "2024-12-14T19:46:53Z",
      "author_association": "MEMBER",
      "body": "Concept ACK",
      "user": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31495#issuecomment-2543324905",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/31495"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDg1MDk2MmQwMDc0NjgzY2NjYmUwZjYzYzg2NGE3MGUwZjMxYThjYWY",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/850962d0074683cccbe0f63c864a70e0f31a8caf",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/850962d0074683cccbe0f63c864a70e0f31a8caf",
      "tree": {
        "sha": "6b1f4e5fc5e93d7739c3c333cfc2ff0e557909d8",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/6b1f4e5fc5e93d7739c3c333cfc2ff0e557909d8"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/22ec1dc31fa3e1aa865c43727c11c1ad1f38e924",
          "sha": "22ec1dc31fa3e1aa865c43727c11c1ad1f38e924",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/22ec1dc31fa3e1aa865c43727c11c1ad1f38e924"
        }
      ],
      "message": "test: Test migration of miniscript in legacy wallets",
      "committer": {
        "name": "Ava Chow",
        "email": "github@achow101.com",
        "date": "2024-12-16T20:08:32Z"
      },
      "author": {
        "name": "Ava Chow",
        "email": "github@achow101.com",
        "date": "2024-12-13T21:07:10Z"
      },
      "sha": "850962d0074683cccbe0f63c864a70e0f31a8caf"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDliODVhOTRkYzM2NmY5MzM3MDMzZmU4YWVhOWJkZjY1MDEyMGVkMWY",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/9b85a94dc366f9337033fe8aea9bdf650120ed1f",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/9b85a94dc366f9337033fe8aea9bdf650120ed1f",
      "tree": {
        "sha": "86435559d76fc90a68c83c89c921c7aef2c68d63",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/86435559d76fc90a68c83c89c921c7aef2c68d63"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/850962d0074683cccbe0f63c864a70e0f31a8caf",
          "sha": "850962d0074683cccbe0f63c864a70e0f31a8caf",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/850962d0074683cccbe0f63c864a70e0f31a8caf"
        }
      ],
      "message": "test: Test migration of taproot output scripts",
      "committer": {
        "name": "Ava Chow",
        "email": "github@achow101.com",
        "date": "2024-12-16T20:08:34Z"
      },
      "author": {
        "name": "Ava Chow",
        "email": "github@achow101.com",
        "date": "2024-12-13T21:49:40Z"
      },
      "sha": "9b85a94dc366f9337033fe8aea9bdf650120ed1f"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKGQ4NjA4ZDE0MGNmMzA2NGVjY2NkMDljZTU3MTRhMDQzNzVkOGE3OGU",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/d8608d140cf3064ecccd09ce5714a04375d8a78e",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/d8608d140cf3064ecccd09ce5714a04375d8a78e",
      "tree": {
        "sha": "587988dbea472d0ec2cd9e30fba7d47814b133b8",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/587988dbea472d0ec2cd9e30fba7d47814b133b8"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/9b85a94dc366f9337033fe8aea9bdf650120ed1f",
          "sha": "9b85a94dc366f9337033fe8aea9bdf650120ed1f",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/9b85a94dc366f9337033fe8aea9bdf650120ed1f"
        }
      ],
      "message": "test: Test migration of a solvable script with no privkeys\n\nThe legacy wallet will be able to solve output scripts where the\nredeemScript or witnessScript is known, but does not know any of the\nprivate keys involved in that script. These should be migrated to the\nsolvables wallet.",
      "committer": {
        "name": "Ava Chow",
        "email": "github@achow101.com",
        "date": "2024-12-16T20:08:47Z"
      },
      "author": {
        "name": "Ava Chow",
        "email": "github@achow101.com",
        "date": "2024-12-16T20:07:19Z"
      },
      "sha": "d8608d140cf3064ecccd09ce5714a04375d8a78e"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 15675947653,
      "node_id": "HRFPE_lADOABII586jRhxQzwAAAAOmW_qF",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/15675947653",
      "actor": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": "d8608d140cf3064ecccd09ce5714a04375d8a78e",
      "commit_url": "https://api.github.com/repos/achow101/bitcoin/commits/d8608d140cf3064ecccd09ce5714a04375d8a78e",
      "created_at": "2024-12-16T20:09:35Z"
    },
    {
      "event": "reviewed",
      "id": 2530939442,
      "node_id": "PRR_kwDOABII586W2xIy",
      "url": null,
      "actor": null,
      "commit_id": "d8608d140cf3064ecccd09ce5714a04375d8a78e",
      "commit_url": null,
      "created_at": null,
      "author_association": "CONTRIBUTOR",
      "body": "Concept ACK",
      "user": {
        "login": "theStack",
        "id": 91535,
        "node_id": "MDQ6VXNlcjkxNTM1",
        "avatar_url": "https://avatars.githubusercontent.com/u/91535?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theStack",
        "html_url": "https://github.com/theStack",
        "followers_url": "https://api.github.com/users/theStack/followers",
        "following_url": "https://api.github.com/users/theStack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theStack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theStack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theStack/subscriptions",
        "organizations_url": "https://api.github.com/users/theStack/orgs",
        "repos_url": "https://api.github.com/users/theStack/repos",
        "events_url": "https://api.github.com/users/theStack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theStack/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31495#pullrequestreview-2530939442",
      "submitted_at": "2025-01-05T19:16:52Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31495"
    }
  ],
  "comments": [
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1903312194",
      "pull_request_review_id": 2530939442,
      "id": 1903312194,
      "node_id": "PRRC_kwDOABII585xcj1C",
      "diff_hunk": "@@ -1063,6 +1065,155 @@ def test_manual_keys_import(self):\n         assert_equal(expected_descs, migrated_desc)\n         wo_wallet.unloadwallet()\n \n+    def test_p2wsh(self):\n+        self.log.info(\"Test that non-multisig P2WSH output scripts are migrated\")\n+        def_wallet = self.master_node.get_wallet_rpc(self.default_wallet_name)\n+\n+        wallet = self.create_legacy_wallet(\"p2wsh\")\n+\n+        # Craft wsh(pkh(key))\n+        pubkey = wallet.getaddressinfo(wallet.getnewaddress())[\"pubkey\"]\n+        pkh_script = key_to_p2pkh_script(pubkey).hex()\n+        wsh_pkh_script = script_to_p2wsh_script(pkh_script).hex()\n+        wsh_pkh_addr = script_to_p2wsh(pkh_script)\n+\n+        wallet.importaddress(address=pkh_script, p2sh=False)\n+        wallet.importaddress(address=wsh_pkh_script, p2sh=False)\n+\n+        def_wallet.sendtoaddress(wsh_pkh_addr, 5)\n+        self.generate(self.nodes[0], 6)\n+        assert_equal(wallet.getbalances()['mine']['trusted'], 5)\n+\n+        _, wallet = self.migrate_and_get_rpc(\"p2wsh\")\n+\n+        assert_equal(wallet.getbalances()['mine']['trusted'], 5)\n+        addr_info = wallet.getaddressinfo(wsh_pkh_addr)\n+        assert_equal(addr_info[\"ismine\"], True)\n+        assert_equal(addr_info[\"iswatchonly\"], False)\n+        assert_equal(addr_info[\"solvable\"], True)\n+\n+        wallet.unloadwallet()\n+\n+    def test_disallowed_p2wsh(self):\n+        self.log.info(\"Test that P2WSH output scripts with invalid witnessScripts are not migrated and do not cause migration failure\")\n+        def_wallet = self.master_node.get_wallet_rpc(self.default_wallet_name)\n+\n+        wallet = self.create_legacy_wallet(\"invalid_p2wsh\")\n+\n+        invalid_addrs = []\n+\n+        # For a P2WSH output script stored in the legacy wallet's mapScripts, both the native P2WSH\n+        # and the P2SH-P2WSH are detected by IsMine. We need to verify that descriptors for both\n+        # output scripts are added to the resulting descriptor wallet.\n+        # However, this cannot be done using a multisig as wallet migration treats multisigs specially.\n+        # Instead, this is tested by importing a wsh(pkh()) script. But importing this directly will\n+        # insert the wsh() into setWatchOnly which means that the setWatchOnly migration ends up handling\n+        # this case, which we do not want.\n+        # In order to get the wsh(pkh()) into only mapScripts and not setWatchOnly, we need to utilize\n+        # importmulti and wrap the wsh(pkh()) inside of a sh(). This will insert the sh(wsh(pkh())) into\n+        # setWatchOnly but not the wsh(pkh()).\n+        # Furthermore, migration should not migrate the wsh(pkh()) if the key is uncompressed.\n+        comp_eckey = ECKey()\n+        comp_eckey.generate(compressed=True)",
      "path": "test/functional/wallet_migration.py",
      "position": 98,
      "original_position": 71,
      "commit_id": "d8608d140cf3064ecccd09ce5714a04375d8a78e",
      "original_commit_id": "9c21b8f581542aee0f599f1d8996ac97071bdf6f",
      "in_reply_to_id": null,
      "user": {
        "login": "theStack",
        "id": 91535,
        "node_id": "MDQ6VXNlcjkxNTM1",
        "avatar_url": "https://avatars.githubusercontent.com/u/91535?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theStack",
        "html_url": "https://github.com/theStack",
        "followers_url": "https://api.github.com/users/theStack/followers",
        "following_url": "https://api.github.com/users/theStack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theStack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theStack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theStack/subscriptions",
        "organizations_url": "https://api.github.com/users/theStack/orgs",
        "repos_url": "https://api.github.com/users/theStack/repos",
        "events_url": "https://api.github.com/users/theStack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theStack/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "seems like the picked commit 9c21b8f581542aee0f599f1d8996ac97071bdf6f is out-dated, as this sub-test was already changed to use `generate_keypair` in #30328 (see e.g. https://github.com/bitcoin/bitcoin/pull/30328#discussion_r1878288769)",
      "created_at": "2025-01-05T17:37:04Z",
      "updated_at": "2025-01-05T19:16:52Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31495#discussion_r1903312194",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1903312194"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31495"
        }
      },
      "start_line": 1117,
      "original_start_line": 1116,
      "start_side": "RIGHT",
      "line": 1118,
      "original_line": 1117,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1903322566",
      "pull_request_review_id": 2530939442,
      "id": 1903322566,
      "node_id": "PRRC_kwDOABII585xcmXG",
      "diff_hunk": "@@ -1955,6 +1955,7 @@ std::optional<MigrationData> LegacyDataSPKM::MigrateToDescriptor()\n         std::string desc_str;\n         bool watchonly = !desc->ToPrivateString(*this, desc_str);\n         if (watchonly && !m_storage.IsWalletFlagSet(WALLET_FLAG_DISABLE_PRIVATE_KEYS)) {\n+            WalletLogPrintf(\"%s\\n\", desc->ToString());",
      "path": "src/wallet/scriptpubkeyman.cpp",
      "position": 140,
      "original_position": 4,
      "commit_id": "d8608d140cf3064ecccd09ce5714a04375d8a78e",
      "original_commit_id": "850962d0074683cccbe0f63c864a70e0f31a8caf",
      "in_reply_to_id": null,
      "user": {
        "login": "theStack",
        "id": 91535,
        "node_id": "MDQ6VXNlcjkxNTM1",
        "avatar_url": "https://avatars.githubusercontent.com/u/91535?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theStack",
        "html_url": "https://github.com/theStack",
        "followers_url": "https://api.github.com/users/theStack/followers",
        "following_url": "https://api.github.com/users/theStack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theStack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theStack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theStack/subscriptions",
        "organizations_url": "https://api.github.com/users/theStack/orgs",
        "repos_url": "https://api.github.com/users/theStack/repos",
        "events_url": "https://api.github.com/users/theStack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theStack/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "in commit 850962d0074683cccbe0f63c864a70e0f31a8caf: is this a left-over from debugging or introduced intentionally?",
      "created_at": "2025-01-05T18:56:57Z",
      "updated_at": "2025-01-05T19:16:52Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31495#discussion_r1903322566",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1903322566"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31495"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 1958,
      "original_line": 1958,
      "side": "RIGHT"
    }
  ]
}
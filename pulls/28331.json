{
  "type": "pull",
  "pull": {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28331",
    "id": 1487184303,
    "node_id": "PR_kwDOABII585YpKGv",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/28331",
    "diff_url": "https://github.com/bitcoin/bitcoin/pull/28331.diff",
    "patch_url": "https://github.com/bitcoin/bitcoin/pull/28331.patch",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/28331",
    "commits_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28331/commits",
    "review_comments_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28331/comments",
    "review_comment_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments%7B/number%7D",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/28331/comments",
    "statuses_url": "https://api.github.com/repos/bitcoin/bitcoin/statuses/75a329103505736acb9036224da2dfa8ab038c43",
    "number": 28331,
    "state": "closed",
    "locked": true,
    "maintainer_can_modify": false,
    "title": "BIP324 integration",
    "user": {
      "login": "sipa",
      "id": 548488,
      "node_id": "MDQ6VXNlcjU0ODQ4OA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/sipa",
      "html_url": "https://github.com/sipa",
      "followers_url": "https://api.github.com/users/sipa/followers",
      "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
      "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
      "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
      "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
      "organizations_url": "https://api.github.com/users/sipa/orgs",
      "repos_url": "https://api.github.com/users/sipa/repos",
      "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
      "received_events_url": "https://api.github.com/users/sipa/received_events",
      "type": "User",
      "site_admin": false,
      "patch_url": null
    },
    "body": "Part of #27634.\r\n\r\nThis makes BIP324 support feature complete, through a (default off) `-v2transport` option for enabling V2 connections. If it is enabled:\r\n* The `NODE_P2P_V2` service flag (*1 << 11*) is advertized.\r\n* Inbound connections can use V1 or V2 (automatically detected based on the protocol used by the peer)\r\n* V2 connections are used on outbound when the `NODE_P2P_V2` service is available (or the new `use_v2` parameter is set on the `addnode` RPC).\r\n* V2 outbound connections that instantly fail get retried as V1.\r\n\r\nThere are two new RPC fields, `\"transport_protocol_type\"` and `\"session_id\"`, in `getpeerinfo`.\r\n",
    "labels": [
      {
        "id": 98298007,
        "node_id": "MDU6TGFiZWw5ODI5ODAwNw==",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/P2P",
        "name": "P2P",
        "color": "006b75",
        "default": false
      }
    ],
    "created_at": "2023-08-24T00:25:16Z",
    "updated_at": "2025-05-21T06:09:20Z",
    "closed_at": "2023-10-03T09:13:13Z",
    "mergeable_state": "unknown",
    "merged": true,
    "merged_at": "2023-10-03T09:13:13Z",
    "merged_by": {
      "login": "fanquake",
      "id": 863730,
      "node_id": "MDQ6VXNlcjg2MzczMA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/863730?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/fanquake",
      "html_url": "https://github.com/fanquake",
      "followers_url": "https://api.github.com/users/fanquake/followers",
      "following_url": "https://api.github.com/users/fanquake/following%7B/other_user%7D",
      "gists_url": "https://api.github.com/users/fanquake/gists%7B/gist_id%7D",
      "starred_url": "https://api.github.com/users/fanquake/starred%7B/owner%7D%7B/repo%7D",
      "subscriptions_url": "https://api.github.com/users/fanquake/subscriptions",
      "organizations_url": "https://api.github.com/users/fanquake/orgs",
      "repos_url": "https://api.github.com/users/fanquake/repos",
      "events_url": "https://api.github.com/users/fanquake/events%7B/privacy%7D",
      "received_events_url": "https://api.github.com/users/fanquake/received_events",
      "type": "User",
      "site_admin": false,
      "patch_url": null
    },
    "merge_commit_sha": "6f882e6f8689af1f188b687c2128524880815cef",
    "assignees": [],
    "requested_reviewers": [
      {
        "login": "ajtowns",
        "id": 127186,
        "node_id": "MDQ6VXNlcjEyNzE4Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/127186?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ajtowns",
        "html_url": "https://github.com/ajtowns",
        "followers_url": "https://api.github.com/users/ajtowns/followers",
        "following_url": "https://api.github.com/users/ajtowns/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ajtowns/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ajtowns/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ajtowns/subscriptions",
        "organizations_url": "https://api.github.com/users/ajtowns/orgs",
        "repos_url": "https://api.github.com/users/ajtowns/repos",
        "events_url": "https://api.github.com/users/ajtowns/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ajtowns/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      }
    ],
    "requested_teams": [],
    "head": {
      "label": "sipa:202308_bip324_integration",
      "ref": "202308_bip324_integration",
      "sha": "75a329103505736acb9036224da2dfa8ab038c43",
      "user": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "repo": {
        "id": 1458655,
        "node_id": "MDEwOlJlcG9zaXRvcnkxNDU4NjU1",
        "name": "bitcoin",
        "full_name": "sipa/bitcoin",
        "owner": {
          "login": "sipa",
          "id": 548488,
          "node_id": "MDQ6VXNlcjU0ODQ4OA==",
          "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
          "gravatar_id": "",
          "url": "https://api.github.com/users/sipa",
          "html_url": "https://github.com/sipa",
          "followers_url": "https://api.github.com/users/sipa/followers",
          "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
          "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
          "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
          "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
          "organizations_url": "https://api.github.com/users/sipa/orgs",
          "repos_url": "https://api.github.com/users/sipa/repos",
          "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
          "received_events_url": "https://api.github.com/users/sipa/received_events",
          "type": "User",
          "site_admin": false,
          "patch_url": null
        },
        "private": false,
        "html_url": "https://github.com/sipa/bitcoin",
        "description": "Bitcoin integration/staging tree",
        "fork": true,
        "url": "https://api.github.com/repos/sipa/bitcoin",
        "archive_url": "https://api.github.com/repos/sipa/bitcoin/%7Barchive_format%7D%7B/ref%7D",
        "assignees_url": "https://api.github.com/repos/sipa/bitcoin/assignees%7B/user%7D",
        "blobs_url": "https://api.github.com/repos/sipa/bitcoin/git/blobs%7B/sha%7D",
        "branches_url": "https://api.github.com/repos/sipa/bitcoin/branches%7B/branch%7D",
        "collaborators_url": "https://api.github.com/repos/sipa/bitcoin/collaborators%7B/collaborator%7D",
        "comments_url": "https://api.github.com/repos/sipa/bitcoin/comments%7B/number%7D",
        "commits_url": "https://api.github.com/repos/sipa/bitcoin/commits%7B/sha%7D",
        "compare_url": "https://api.github.com/repos/sipa/bitcoin/compare/%7Bbase%7D...%7Bhead%7D",
        "contents_url": "https://api.github.com/repos/sipa/bitcoin/contents/%7B+path%7D",
        "contributors_url": "https://api.github.com/repos/sipa/bitcoin/contributors",
        "deployments_url": "https://api.github.com/repos/sipa/bitcoin/deployments",
        "downloads_url": "https://api.github.com/repos/sipa/bitcoin/downloads",
        "events_url": "https://api.github.com/repos/sipa/bitcoin/events",
        "forks_url": "https://api.github.com/repos/sipa/bitcoin/forks",
        "git_commits_url": "https://api.github.com/repos/sipa/bitcoin/git/commits%7B/sha%7D",
        "git_refs_url": "https://api.github.com/repos/sipa/bitcoin/git/refs%7B/sha%7D",
        "git_tags_url": "https://api.github.com/repos/sipa/bitcoin/git/tags%7B/sha%7D",
        "git_url": "git://github.com/sipa/bitcoin.git",
        "issue_comment_url": "https://api.github.com/repos/sipa/bitcoin/issues/comments%7B/number%7D",
        "issue_events_url": "https://api.github.com/repos/sipa/bitcoin/issues/events%7B/number%7D",
        "issues_url": "https://api.github.com/repos/sipa/bitcoin/issues%7B/number%7D",
        "keys_url": "https://api.github.com/repos/sipa/bitcoin/keys%7B/key_id%7D",
        "labels_url": "https://api.github.com/repos/sipa/bitcoin/labels%7B/name%7D",
        "languages_url": "https://api.github.com/repos/sipa/bitcoin/languages",
        "merges_url": "https://api.github.com/repos/sipa/bitcoin/merges",
        "milestones_url": "https://api.github.com/repos/sipa/bitcoin/milestones%7B/number%7D",
        "notifications_url": "https://api.github.com/repos/sipa/bitcoin/notifications%7B?since,all,participating}",
        "pulls_url": "https://api.github.com/repos/sipa/bitcoin/pulls%7B/number%7D",
        "releases_url": "https://api.github.com/repos/sipa/bitcoin/releases%7B/id%7D",
        "ssh_url": "git@github.com:sipa/bitcoin.git",
        "stargazers_url": "https://api.github.com/repos/sipa/bitcoin/stargazers",
        "statuses_url": "https://api.github.com/repos/sipa/bitcoin/statuses/%7Bsha%7D",
        "subscribers_url": "https://api.github.com/repos/sipa/bitcoin/subscribers",
        "subscription_url": "https://api.github.com/repos/sipa/bitcoin/subscription",
        "tags_url": "https://api.github.com/repos/sipa/bitcoin/tags",
        "teams_url": "https://api.github.com/repos/sipa/bitcoin/teams",
        "trees_url": "https://api.github.com/repos/sipa/bitcoin/git/trees%7B/sha%7D",
        "clone_url": "https://github.com/sipa/bitcoin.git",
        "hooks_url": "https://api.github.com/repos/sipa/bitcoin/hooks",
        "svn_url": "https://github.com/sipa/bitcoin",
        "homepage": "http://www.bitcoin.org",
        "language": "TypeScript",
        "forks_count": 20,
        "stargazers_count": 90,
        "watchers_count": 90,
        "size": 261423,
        "default_branch": "lows",
        "open_issues_count": 16,
        "is_template": false,
        "topics": [],
        "has_issues": true,
        "has_projects": true,
        "has_wiki": true,
        "has_pages": false,
        "has_downloads": false,
        "archived": false,
        "disabled": false,
        "visibility": "public",
        "pushed_at": "2025-05-21T01:15:09Z",
        "created_at": "2011-03-09T10:46:59Z",
        "updated_at": "2025-02-27T11:11:39Z",
        "allow_forking": true,
        "license": {
          "key": "mit",
          "name": "MIT License",
          "node_id": "MDc6TGljZW5zZTEz",
          "spdx_id": "MIT",
          "url": "https://api.github.com/licenses/mit",
          "html_url": null,
          "description": null,
          "implementation": null,
          "permissions": null,
          "conditions": null,
          "limitations": null,
          "body": null,
          "featured": null
        }
      }
    },
    "base": {
      "label": "bitcoin:master",
      "ref": "master",
      "sha": "e7b0004b375be25096fbaf3d5f6980095a90fc0c",
      "user": {
        "login": "bitcoin",
        "id": 528860,
        "node_id": "MDEyOk9yZ2FuaXphdGlvbjUyODg2MA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/528860?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/bitcoin",
        "html_url": "https://github.com/bitcoin",
        "followers_url": "https://api.github.com/users/bitcoin/followers",
        "following_url": "https://api.github.com/users/bitcoin/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/bitcoin/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/bitcoin/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/bitcoin/subscriptions",
        "organizations_url": "https://api.github.com/users/bitcoin/orgs",
        "repos_url": "https://api.github.com/users/bitcoin/repos",
        "events_url": "https://api.github.com/users/bitcoin/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/bitcoin/received_events",
        "type": "Organization",
        "site_admin": false,
        "patch_url": null
      },
      "repo": {
        "id": 1181927,
        "node_id": "MDEwOlJlcG9zaXRvcnkxMTgxOTI3",
        "name": "bitcoin",
        "full_name": "bitcoin/bitcoin",
        "owner": {
          "login": "bitcoin",
          "id": 528860,
          "node_id": "MDEyOk9yZ2FuaXphdGlvbjUyODg2MA==",
          "avatar_url": "https://avatars.githubusercontent.com/u/528860?v=4",
          "gravatar_id": "",
          "url": "https://api.github.com/users/bitcoin",
          "html_url": "https://github.com/bitcoin",
          "followers_url": "https://api.github.com/users/bitcoin/followers",
          "following_url": "https://api.github.com/users/bitcoin/following%7B/other_user%7D",
          "gists_url": "https://api.github.com/users/bitcoin/gists%7B/gist_id%7D",
          "starred_url": "https://api.github.com/users/bitcoin/starred%7B/owner%7D%7B/repo%7D",
          "subscriptions_url": "https://api.github.com/users/bitcoin/subscriptions",
          "organizations_url": "https://api.github.com/users/bitcoin/orgs",
          "repos_url": "https://api.github.com/users/bitcoin/repos",
          "events_url": "https://api.github.com/users/bitcoin/events%7B/privacy%7D",
          "received_events_url": "https://api.github.com/users/bitcoin/received_events",
          "type": "Organization",
          "site_admin": false,
          "patch_url": null
        },
        "private": false,
        "html_url": "https://github.com/bitcoin/bitcoin",
        "description": "Bitcoin Core integration/staging tree",
        "fork": false,
        "url": "https://api.github.com/repos/bitcoin/bitcoin",
        "archive_url": "https://api.github.com/repos/bitcoin/bitcoin/%7Barchive_format%7D%7B/ref%7D",
        "assignees_url": "https://api.github.com/repos/bitcoin/bitcoin/assignees%7B/user%7D",
        "blobs_url": "https://api.github.com/repos/bitcoin/bitcoin/git/blobs%7B/sha%7D",
        "branches_url": "https://api.github.com/repos/bitcoin/bitcoin/branches%7B/branch%7D",
        "collaborators_url": "https://api.github.com/repos/bitcoin/bitcoin/collaborators%7B/collaborator%7D",
        "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/comments%7B/number%7D",
        "commits_url": "https://api.github.com/repos/bitcoin/bitcoin/commits%7B/sha%7D",
        "compare_url": "https://api.github.com/repos/bitcoin/bitcoin/compare/%7Bbase%7D...%7Bhead%7D",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/%7B+path%7D",
        "contributors_url": "https://api.github.com/repos/bitcoin/bitcoin/contributors",
        "deployments_url": "https://api.github.com/repos/bitcoin/bitcoin/deployments",
        "downloads_url": "https://api.github.com/repos/bitcoin/bitcoin/downloads",
        "events_url": "https://api.github.com/repos/bitcoin/bitcoin/events",
        "forks_url": "https://api.github.com/repos/bitcoin/bitcoin/forks",
        "git_commits_url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits%7B/sha%7D",
        "git_refs_url": "https://api.github.com/repos/bitcoin/bitcoin/git/refs%7B/sha%7D",
        "git_tags_url": "https://api.github.com/repos/bitcoin/bitcoin/git/tags%7B/sha%7D",
        "git_url": "git://github.com/bitcoin/bitcoin.git",
        "issue_comment_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments%7B/number%7D",
        "issue_events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events%7B/number%7D",
        "issues_url": "https://api.github.com/repos/bitcoin/bitcoin/issues%7B/number%7D",
        "keys_url": "https://api.github.com/repos/bitcoin/bitcoin/keys%7B/key_id%7D",
        "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/labels%7B/name%7D",
        "languages_url": "https://api.github.com/repos/bitcoin/bitcoin/languages",
        "merges_url": "https://api.github.com/repos/bitcoin/bitcoin/merges",
        "milestones_url": "https://api.github.com/repos/bitcoin/bitcoin/milestones%7B/number%7D",
        "notifications_url": "https://api.github.com/repos/bitcoin/bitcoin/notifications%7B?since,all,participating}",
        "pulls_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls%7B/number%7D",
        "releases_url": "https://api.github.com/repos/bitcoin/bitcoin/releases%7B/id%7D",
        "ssh_url": "git@github.com:bitcoin/bitcoin.git",
        "stargazers_url": "https://api.github.com/repos/bitcoin/bitcoin/stargazers",
        "statuses_url": "https://api.github.com/repos/bitcoin/bitcoin/statuses/%7Bsha%7D",
        "subscribers_url": "https://api.github.com/repos/bitcoin/bitcoin/subscribers",
        "subscription_url": "https://api.github.com/repos/bitcoin/bitcoin/subscription",
        "tags_url": "https://api.github.com/repos/bitcoin/bitcoin/tags",
        "teams_url": "https://api.github.com/repos/bitcoin/bitcoin/teams",
        "trees_url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees%7B/sha%7D",
        "clone_url": "https://github.com/bitcoin/bitcoin.git",
        "hooks_url": "https://api.github.com/repos/bitcoin/bitcoin/hooks",
        "svn_url": "https://github.com/bitcoin/bitcoin",
        "homepage": "https://bitcoincore.org/en/download",
        "language": "C++",
        "forks_count": 37245,
        "stargazers_count": 83700,
        "watchers_count": 83700,
        "size": 282330,
        "default_branch": "master",
        "open_issues_count": 729,
        "is_template": false,
        "topics": [
          "bitcoin",
          "c-plus-plus",
          "cryptocurrency",
          "cryptography",
          "p2p"
        ],
        "has_issues": true,
        "has_projects": true,
        "has_wiki": false,
        "has_pages": false,
        "has_downloads": false,
        "archived": false,
        "disabled": false,
        "visibility": "public",
        "pushed_at": "2025-05-20T19:30:29Z",
        "created_at": "2010-12-19T15:16:43Z",
        "updated_at": "2025-05-21T02:32:36Z",
        "allow_forking": true,
        "license": {
          "key": "mit",
          "name": "MIT License",
          "node_id": "MDc6TGljZW5zZTEz",
          "spdx_id": "MIT",
          "url": "https://api.github.com/licenses/mit",
          "html_url": null,
          "description": null,
          "implementation": null,
          "permissions": null,
          "conditions": null,
          "limitations": null,
          "body": null,
          "featured": null
        }
      }
    },
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28331"
      }
    },
    "author_association": "MEMBER",
    "draft": false,
    "additions": 540,
    "deletions": 83,
    "changed_files": 22,
    "commits": 10,
    "review_comments": 136,
    "comments": 36
  },
  "events": [
    {
      "event": "commented",
      "id": 1690809934,
      "node_id": "IC_kwDOABII585kx7ZO",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1690809934",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-08-24T00:25:18Z",
      "updated_at": "2023-10-03T09:12:46Z",
      "author_association": "CONTRIBUTOR",
      "body": "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--021abf342d371248e50ceaed478a90ca-->\n### Reviews\nSee [the guideline](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#code-review) for information on the review process.\n| Type | Reviewers |\n| ---- | --------- |\n| ACK | [theStack](https://github.com/bitcoin/bitcoin/pull/28331#pullrequestreview-1653679049), [mzumsande](https://github.com/bitcoin/bitcoin/pull/28331#issuecomment-1743939613), [Sjors](https://github.com/bitcoin/bitcoin/pull/28331#issuecomment-1744557221) |\n| Approach ACK | [jonatack](https://github.com/bitcoin/bitcoin/pull/28331#pullrequestreview-1625394283) |\n| Stale ACK | [ajtowns](https://github.com/bitcoin/bitcoin/pull/28331#pullrequestreview-1641976091), [vasild](https://github.com/bitcoin/bitcoin/pull/28331#pullrequestreview-1652460362) |\n\nIf your review is incorrectly listed, please react with 👎 to this comment and the bot will ignore it on the next update.\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* [#bitcoin-core/gui/754](https://github.com/bitcoin-core/gui/pull/754) (Add BIP324-specific labels to peer details by hebasto)\n* [#28464](https://github.com/bitcoin/bitcoin/pull/28464) (net: improve max-connection limits code by mzumsande)\n* [#28463](https://github.com/bitcoin/bitcoin/pull/28463) (p2p: Increase inbound capacity for block-relay only connections by mzumsande)\n* [#28155](https://github.com/bitcoin/bitcoin/pull/28155) (net: improves addnode / m_added_nodes logic by sr-gi)\n* [#27600](https://github.com/bitcoin/bitcoin/pull/27600) (net: Add new permission `forceinbound` to evict a random unprotected connection if all slots are otherwise full by pinheadmz)\n* [#27581](https://github.com/bitcoin/bitcoin/pull/27581) (net: Continuous ASMap health check by fjahr)\n* [#27114](https://github.com/bitcoin/bitcoin/pull/27114) (p2p: Allow whitelisting outgoing connections by brunoerg)\n* [#27052](https://github.com/bitcoin/bitcoin/pull/27052) (test: rpc: add last block announcement time to getpeerinfo result by LarryRuane)\n* [#26863](https://github.com/bitcoin/bitcoin/pull/26863) (test: merge banning test from p2p_disconnect_ban to rpc_setban by brunoerg)\n* [#26728](https://github.com/bitcoin/bitcoin/pull/26728) (wallet: Have the wallet store the key for automatically generated descriptors by achow101)\n* [#26114](https://github.com/bitcoin/bitcoin/pull/26114) (net: Make AddrFetch connections to fixed seeds by mzumsande)\n* [#25907](https://github.com/bitcoin/bitcoin/pull/25907) (wallet: rpc to add automatically generated descriptors by achow101)\n* [#22341](https://github.com/bitcoin/bitcoin/pull/22341) (rpc: add getxpub by Sjors)\n* [#20892](https://github.com/bitcoin/bitcoin/pull/20892) (tests: Run both descriptor and legacy tests within a single test invocation by achow101)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.\n",
      "user": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28331#issuecomment-1690809934",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/28331"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 10175768773,
      "node_id": "HRFPE_lADOABII585vHSmAzwAAAAJehejF",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10175768773",
      "actor": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": "06d98ea9e7cb606720bf37249d3764d8c6283da3",
      "commit_url": "https://api.github.com/repos/sipa/bitcoin/commits/06d98ea9e7cb606720bf37249d3764d8c6283da3",
      "created_at": "2023-08-24T01:17:19Z"
    },
    {
      "event": "labeled",
      "id": 10175769100,
      "node_id": "LE_lADOABII585vHSmAzwAAAAJeheoM",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10175769100",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-08-24T01:17:23Z",
      "label": {
        "name": "CI failed",
        "color": "cccccc"
      }
    },
    {
      "event": "unlabeled",
      "id": 10178887165,
      "node_id": "UNLE_lADOABII585vHSmAzwAAAAJetX39",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10178887165",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-08-24T09:10:55Z",
      "label": {
        "name": "CI failed",
        "color": "cccccc"
      }
    },
    {
      "event": "head_ref_force_pushed",
      "id": 10181186646,
      "node_id": "HRFPE_lADOABII585vHSmAzwAAAAJe2JRW",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10181186646",
      "actor": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": "5e071a495b941f636e98a74e186f1a406dcd21f8",
      "commit_url": "https://api.github.com/repos/sipa/bitcoin/commits/5e071a495b941f636e98a74e186f1a406dcd21f8",
      "created_at": "2023-08-24T13:03:14Z"
    },
    {
      "event": "labeled",
      "id": 10183204130,
      "node_id": "LE_lADOABII585vHSmAzwAAAAJe910i",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10183204130",
      "actor": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-08-24T15:46:30Z",
      "label": {
        "name": "P2P",
        "color": "006b75"
      }
    },
    {
      "event": "commented",
      "id": 1693239025,
      "node_id": "IC_kwDOABII585k7Mbx",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1693239025",
      "actor": {
        "login": "Sjors",
        "id": 10217,
        "node_id": "MDQ6VXNlcjEwMjE3",
        "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Sjors",
        "html_url": "https://github.com/Sjors",
        "followers_url": "https://api.github.com/users/Sjors/followers",
        "following_url": "https://api.github.com/users/Sjors/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Sjors/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Sjors/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
        "organizations_url": "https://api.github.com/users/Sjors/orgs",
        "repos_url": "https://api.github.com/users/Sjors/repos",
        "events_url": "https://api.github.com/users/Sjors/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Sjors/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-08-25T11:53:39Z",
      "updated_at": "2023-08-25T12:21:03Z",
      "author_association": "MEMBER",
      "body": "Not needed for testing here, but it would still be cool to have a lock icon in the peers tab in the GUI, and reveal the session id if you click on it. cc @hebasto \r\n\r\nTested a manual connection between macOS and Ubuntu, found matching session ids, pfew - no man in the middle attack on my local network :-)\r\n\r\nMy DNS seed hasn't discovered any peers yet announcing the service flag, that could take a while. https://github.com/sipa/bitcoin-seeder/pull/102",
      "user": {
        "login": "Sjors",
        "id": 10217,
        "node_id": "MDQ6VXNlcjEwMjE3",
        "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Sjors",
        "html_url": "https://github.com/Sjors",
        "followers_url": "https://api.github.com/users/Sjors/followers",
        "following_url": "https://api.github.com/users/Sjors/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Sjors/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Sjors/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
        "organizations_url": "https://api.github.com/users/Sjors/orgs",
        "repos_url": "https://api.github.com/users/Sjors/repos",
        "events_url": "https://api.github.com/users/Sjors/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Sjors/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28331#issuecomment-1693239025",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/28331"
    },
    {
      "event": "mentioned",
      "id": 10192231398,
      "node_id": "MEE_lADOABII585vHSmAzwAAAAJfgRvm",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10192231398",
      "actor": {
        "login": "hebasto",
        "id": 32963518,
        "node_id": "MDQ6VXNlcjMyOTYzNTE4",
        "avatar_url": "https://avatars.githubusercontent.com/u/32963518?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/hebasto",
        "html_url": "https://github.com/hebasto",
        "followers_url": "https://api.github.com/users/hebasto/followers",
        "following_url": "https://api.github.com/users/hebasto/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/hebasto/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/hebasto/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/hebasto/subscriptions",
        "organizations_url": "https://api.github.com/users/hebasto/orgs",
        "repos_url": "https://api.github.com/users/hebasto/repos",
        "events_url": "https://api.github.com/users/hebasto/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/hebasto/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-08-25T11:53:40Z"
    },
    {
      "event": "subscribed",
      "id": 10192231405,
      "node_id": "SE_lADOABII585vHSmAzwAAAAJfgRvt",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10192231405",
      "actor": {
        "login": "hebasto",
        "id": 32963518,
        "node_id": "MDQ6VXNlcjMyOTYzNTE4",
        "avatar_url": "https://avatars.githubusercontent.com/u/32963518?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/hebasto",
        "html_url": "https://github.com/hebasto",
        "followers_url": "https://api.github.com/users/hebasto/followers",
        "following_url": "https://api.github.com/users/hebasto/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/hebasto/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/hebasto/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/hebasto/subscriptions",
        "organizations_url": "https://api.github.com/users/hebasto/orgs",
        "repos_url": "https://api.github.com/users/hebasto/repos",
        "events_url": "https://api.github.com/users/hebasto/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/hebasto/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-08-25T11:53:40Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 10203196437,
      "node_id": "HRFPE_lADOABII585vHSmAzwAAAAJgKGwV",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10203196437",
      "actor": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": "06a00c45b2691df3faebc7022c5b76f090fd8e7a",
      "commit_url": "https://api.github.com/repos/sipa/bitcoin/commits/06a00c45b2691df3faebc7022c5b76f090fd8e7a",
      "created_at": "2023-08-28T01:09:37Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 10203256933,
      "node_id": "HRFPE_lADOABII585vHSmAzwAAAAJgKVhl",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10203256933",
      "actor": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": "35f038444602211e56cc02ea2bbfd2d9836cc75f",
      "commit_url": "https://api.github.com/repos/sipa/bitcoin/commits/35f038444602211e56cc02ea2bbfd2d9836cc75f",
      "created_at": "2023-08-28T01:17:29Z"
    },
    {
      "event": "labeled",
      "id": 10203805060,
      "node_id": "LE_lADOABII585vHSmAzwAAAAJgMbWE",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10203805060",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-08-28T02:33:08Z",
      "label": {
        "name": "CI failed",
        "color": "cccccc"
      }
    },
    {
      "event": "head_ref_force_pushed",
      "id": 10215744997,
      "node_id": "HRFPE_lADOABII585vHSmAzwAAAAJg5-Xl",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10215744997",
      "actor": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": "bdb7f73925a7f7b7fe744767a702f2d7a5494f38",
      "commit_url": "https://api.github.com/repos/sipa/bitcoin/commits/bdb7f73925a7f7b7fe744767a702f2d7a5494f38",
      "created_at": "2023-08-29T02:58:49Z"
    },
    {
      "event": "unlabeled",
      "id": 10216122269,
      "node_id": "UNLE_lADOABII585vHSmAzwAAAAJg7aed",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10216122269",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-08-29T04:29:34Z",
      "label": {
        "name": "CI failed",
        "color": "cccccc"
      }
    },
    {
      "event": "commented",
      "id": 1697514804,
      "node_id": "IC_kwDOABII585lLgU0",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1697514804",
      "actor": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-08-29T14:07:03Z",
      "updated_at": "2023-08-29T14:07:03Z",
      "author_association": "MEMBER",
      "body": "@Sjors Re https://github.com/bitcoin/bitcoin/pull/28196#issuecomment-1689980940:\r\n\r\nI've changed a net debug-level log message to say \"trying v2 connection ... lastseen=...hrs\\n\"",
      "user": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28331#issuecomment-1697514804",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/28331"
    },
    {
      "event": "mentioned",
      "id": 10221779887,
      "node_id": "MEE_lADOABII585vHSmAzwAAAAJhQ_uv",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10221779887",
      "actor": {
        "login": "Sjors",
        "id": 10217,
        "node_id": "MDQ6VXNlcjEwMjE3",
        "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Sjors",
        "html_url": "https://github.com/Sjors",
        "followers_url": "https://api.github.com/users/Sjors/followers",
        "following_url": "https://api.github.com/users/Sjors/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Sjors/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Sjors/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
        "organizations_url": "https://api.github.com/users/Sjors/orgs",
        "repos_url": "https://api.github.com/users/Sjors/repos",
        "events_url": "https://api.github.com/users/Sjors/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Sjors/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-08-29T14:07:03Z"
    },
    {
      "event": "subscribed",
      "id": 10221779914,
      "node_id": "SE_lADOABII585vHSmAzwAAAAJhQ_vK",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10221779914",
      "actor": {
        "login": "Sjors",
        "id": 10217,
        "node_id": "MDQ6VXNlcjEwMjE3",
        "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Sjors",
        "html_url": "https://github.com/Sjors",
        "followers_url": "https://api.github.com/users/Sjors/followers",
        "following_url": "https://api.github.com/users/Sjors/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Sjors/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Sjors/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
        "organizations_url": "https://api.github.com/users/Sjors/orgs",
        "repos_url": "https://api.github.com/users/Sjors/repos",
        "events_url": "https://api.github.com/users/Sjors/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Sjors/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-08-29T14:07:03Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 10225366057,
      "node_id": "HRFPE_lADOABII585vHSmAzwAAAAJherQp",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10225366057",
      "actor": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": "3f959b9c5d5d666c26be418153ab125090071c0f",
      "commit_url": "https://api.github.com/repos/sipa/bitcoin/commits/3f959b9c5d5d666c26be418153ab125090071c0f",
      "created_at": "2023-08-29T20:08:18Z"
    },
    {
      "event": "labeled",
      "id": 10226147716,
      "node_id": "LE_lADOABII585vHSmAzwAAAAJhhqGE",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10226147716",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-08-29T21:39:46Z",
      "label": {
        "name": "CI failed",
        "color": "cccccc"
      }
    },
    {
      "event": "head_ref_force_pushed",
      "id": 10226367985,
      "node_id": "HRFPE_lADOABII585vHSmAzwAAAAJhif3x",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10226367985",
      "actor": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": "1f13994c22ac6d63cfe27dbcb9cc96e534fb2088",
      "commit_url": "https://api.github.com/repos/sipa/bitcoin/commits/1f13994c22ac6d63cfe27dbcb9cc96e534fb2088",
      "created_at": "2023-08-29T22:14:28Z"
    },
    {
      "event": "unlabeled",
      "id": 10226829087,
      "node_id": "UNLE_lADOABII585vHSmAzwAAAAJhkQcf",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10226829087",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-08-29T23:36:51Z",
      "label": {
        "name": "CI failed",
        "color": "cccccc"
      }
    },
    {
      "event": "head_ref_force_pushed",
      "id": 10227706212,
      "node_id": "HRFPE_lADOABII585vHSmAzwAAAAJhnmlk",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10227706212",
      "actor": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": "f770273b3842e45a612cb8bb81d46e3d0883230a",
      "commit_url": "https://api.github.com/repos/sipa/bitcoin/commits/f770273b3842e45a612cb8bb81d46e3d0883230a",
      "created_at": "2023-08-30T02:48:12Z"
    },
    {
      "event": "commented",
      "id": 1699262624,
      "node_id": "IC_kwDOABII585lSLCg",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1699262624",
      "actor": {
        "login": "Sjors",
        "id": 10217,
        "node_id": "MDQ6VXNlcjEwMjE3",
        "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Sjors",
        "html_url": "https://github.com/Sjors",
        "followers_url": "https://api.github.com/users/Sjors/followers",
        "following_url": "https://api.github.com/users/Sjors/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Sjors/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Sjors/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
        "organizations_url": "https://api.github.com/users/Sjors/orgs",
        "repos_url": "https://api.github.com/users/Sjors/repos",
        "events_url": "https://api.github.com/users/Sjors/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Sjors/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-08-30T14:09:43Z",
      "updated_at": "2023-08-30T14:09:43Z",
      "author_association": "MEMBER",
      "body": "> I've changed a net debug-level log message to say \"trying v2 connection ... lastseen=...hrs\\n\"\r\n\r\nNice! Though I'm not seeing that in your latest push f770273b3842e45a612cb8bb81d46e3d0883230a.",
      "user": {
        "login": "Sjors",
        "id": 10217,
        "node_id": "MDQ6VXNlcjEwMjE3",
        "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Sjors",
        "html_url": "https://github.com/Sjors",
        "followers_url": "https://api.github.com/users/Sjors/followers",
        "following_url": "https://api.github.com/users/Sjors/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Sjors/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Sjors/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
        "organizations_url": "https://api.github.com/users/Sjors/orgs",
        "repos_url": "https://api.github.com/users/Sjors/repos",
        "events_url": "https://api.github.com/users/Sjors/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Sjors/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28331#issuecomment-1699262624",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/28331"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 10234450352,
      "node_id": "HRFPE_lADOABII585vHSmAzwAAAAJiBVGw",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10234450352",
      "actor": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": "d9b1e5cc52951aa0fcef0131964fa6f1ea4841d9",
      "commit_url": "https://api.github.com/repos/sipa/bitcoin/commits/d9b1e5cc52951aa0fcef0131964fa6f1ea4841d9",
      "created_at": "2023-08-30T15:18:39Z"
    },
    {
      "event": "commented",
      "id": 1699553968,
      "node_id": "IC_kwDOABII585lTSKw",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1699553968",
      "actor": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-08-30T17:10:29Z",
      "updated_at": "2023-08-30T17:10:29Z",
      "author_association": "MEMBER",
      "body": "@Sjors https://github.com/bitcoin/bitcoin/blob/f770273b3842e45a612cb8bb81d46e3d0883230a/src/net.cpp#L470",
      "user": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28331#issuecomment-1699553968",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/28331"
    },
    {
      "event": "mentioned",
      "id": 10235537127,
      "node_id": "MEE_lADOABII585vHSmAzwAAAAJiFebn",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10235537127",
      "actor": {
        "login": "Sjors",
        "id": 10217,
        "node_id": "MDQ6VXNlcjEwMjE3",
        "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Sjors",
        "html_url": "https://github.com/Sjors",
        "followers_url": "https://api.github.com/users/Sjors/followers",
        "following_url": "https://api.github.com/users/Sjors/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Sjors/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Sjors/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
        "organizations_url": "https://api.github.com/users/Sjors/orgs",
        "repos_url": "https://api.github.com/users/Sjors/repos",
        "events_url": "https://api.github.com/users/Sjors/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Sjors/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-08-30T17:10:30Z"
    },
    {
      "event": "subscribed",
      "id": 10235537140,
      "node_id": "SE_lADOABII585vHSmAzwAAAAJiFeb0",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10235537140",
      "actor": {
        "login": "Sjors",
        "id": 10217,
        "node_id": "MDQ6VXNlcjEwMjE3",
        "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Sjors",
        "html_url": "https://github.com/Sjors",
        "followers_url": "https://api.github.com/users/Sjors/followers",
        "following_url": "https://api.github.com/users/Sjors/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Sjors/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Sjors/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
        "organizations_url": "https://api.github.com/users/Sjors/orgs",
        "repos_url": "https://api.github.com/users/Sjors/repos",
        "events_url": "https://api.github.com/users/Sjors/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Sjors/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-08-30T17:10:30Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 10237179888,
      "node_id": "HRFPE_lADOABII585vHSmAzwAAAAJiLvfw",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10237179888",
      "actor": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": "73abdbac49950bb1eac1a44ceb367f6686d38155",
      "commit_url": "https://api.github.com/repos/sipa/bitcoin/commits/73abdbac49950bb1eac1a44ceb367f6686d38155",
      "created_at": "2023-08-30T20:37:27Z"
    },
    {
      "event": "commented",
      "id": 1700553281,
      "node_id": "IC_kwDOABII585lXGJB",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1700553281",
      "actor": {
        "login": "Sjors",
        "id": 10217,
        "node_id": "MDQ6VXNlcjEwMjE3",
        "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Sjors",
        "html_url": "https://github.com/Sjors",
        "followers_url": "https://api.github.com/users/Sjors/followers",
        "following_url": "https://api.github.com/users/Sjors/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Sjors/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Sjors/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
        "organizations_url": "https://api.github.com/users/Sjors/orgs",
        "repos_url": "https://api.github.com/users/Sjors/repos",
        "events_url": "https://api.github.com/users/Sjors/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Sjors/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-08-31T08:01:18Z",
      "updated_at": "2023-08-31T08:01:18Z",
      "author_association": "MEMBER",
      "body": "Oh sorry, I lazy grepped for \"v2 connection\". ",
      "user": {
        "login": "Sjors",
        "id": 10217,
        "node_id": "MDQ6VXNlcjEwMjE3",
        "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Sjors",
        "html_url": "https://github.com/Sjors",
        "followers_url": "https://api.github.com/users/Sjors/followers",
        "following_url": "https://api.github.com/users/Sjors/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Sjors/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Sjors/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
        "organizations_url": "https://api.github.com/users/Sjors/orgs",
        "repos_url": "https://api.github.com/users/Sjors/repos",
        "events_url": "https://api.github.com/users/Sjors/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Sjors/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28331#issuecomment-1700553281",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/28331"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 10248874442,
      "node_id": "HRFPE_lADOABII585vHSmAzwAAAAJi4WnK",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10248874442",
      "actor": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": "900063c13d5e00986e9c81b2f93ad65100c27be5",
      "commit_url": "https://api.github.com/repos/sipa/bitcoin/commits/900063c13d5e00986e9c81b2f93ad65100c27be5",
      "created_at": "2023-08-31T19:06:23Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 10249863815,
      "node_id": "HRFPE_lADOABII585vHSmAzwAAAAJi8IKH",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10249863815",
      "actor": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": "e0c2c2e06b93344e92063c9edf7cab36d506bd9d",
      "commit_url": "https://api.github.com/repos/sipa/bitcoin/commits/e0c2c2e06b93344e92063c9edf7cab36d506bd9d",
      "created_at": "2023-08-31T20:45:33Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 10260473588,
      "node_id": "HRFPE_lADOABII585vHSmAzwAAAAJjkmb0",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10260473588",
      "actor": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": "15c4532c6214ce01d8e66426990937e6bd49f41e",
      "commit_url": "https://api.github.com/repos/sipa/bitcoin/commits/15c4532c6214ce01d8e66426990937e6bd49f41e",
      "created_at": "2023-09-01T19:36:33Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 10262833313,
      "node_id": "HRFPE_lADOABII585vHSmAzwAAAAJjtmih",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10262833313",
      "actor": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": "c97be7b7406d9b22174a75a5cbd869c11a1d20fe",
      "commit_url": "https://api.github.com/repos/sipa/bitcoin/commits/c97be7b7406d9b22174a75a5cbd869c11a1d20fe",
      "created_at": "2023-09-02T03:38:53Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 10267132457,
      "node_id": "HRFPE_lADOABII585vHSmAzwAAAAJj-AIp",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10267132457",
      "actor": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": "76b52b324e37fc30a30fb088ff8ff921ee34ce83",
      "commit_url": "https://api.github.com/repos/sipa/bitcoin/commits/76b52b324e37fc30a30fb088ff8ff921ee34ce83",
      "created_at": "2023-09-03T19:31:47Z"
    },
    {
      "event": "labeled",
      "id": 10267369017,
      "node_id": "LE_lADOABII585vHSmAzwAAAAJj-545",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10267369017",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-09-03T21:09:37Z",
      "label": {
        "name": "CI failed",
        "color": "cccccc"
      }
    },
    {
      "event": "head_ref_force_pushed",
      "id": 10273954063,
      "node_id": "HRFPE_lADOABII585vHSmAzwAAAAJkYBkP",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10273954063",
      "actor": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": "65232167e6cd75f9c8a205b89aa6a2e67de022ed",
      "commit_url": "https://api.github.com/repos/sipa/bitcoin/commits/65232167e6cd75f9c8a205b89aa6a2e67de022ed",
      "created_at": "2023-09-04T13:09:22Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 10277211578,
      "node_id": "HRFPE_lADOABII585vHSmAzwAAAAJkkc26",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10277211578",
      "actor": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": "4eebea96d61bbad15273b7def2143dcd8d6d4f01",
      "commit_url": "https://api.github.com/repos/sipa/bitcoin/commits/4eebea96d61bbad15273b7def2143dcd8d6d4f01",
      "created_at": "2023-09-04T21:50:58Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 10277316118,
      "node_id": "HRFPE_lADOABII585vHSmAzwAAAAJkk2YW",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10277316118",
      "actor": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": "df1425cc2ee2ff5b226c3942e55c861c2cdfec13",
      "commit_url": "https://api.github.com/repos/sipa/bitcoin/commits/df1425cc2ee2ff5b226c3942e55c861c2cdfec13",
      "created_at": "2023-09-04T22:24:41Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 10277317047,
      "node_id": "HRFPE_lADOABII585vHSmAzwAAAAJkk2m3",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10277317047",
      "actor": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": "3146b5d3bd1e076dcd3163ce1e15ef571843ac7d",
      "commit_url": "https://api.github.com/repos/sipa/bitcoin/commits/3146b5d3bd1e076dcd3163ce1e15ef571843ac7d",
      "created_at": "2023-09-04T22:24:58Z"
    },
    {
      "event": "unlabeled",
      "id": 10277582617,
      "node_id": "UNLE_lADOABII585vHSmAzwAAAAJkl3cZ",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10277582617",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-09-05T00:00:37Z",
      "label": {
        "name": "CI failed",
        "color": "cccccc"
      }
    },
    {
      "event": "head_ref_force_pushed",
      "id": 10277999817,
      "node_id": "HRFPE_lADOABII585vHSmAzwAAAAJkndTJ",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10277999817",
      "actor": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": "e1ca6e1b63e61e224be5184d97f2a931282c106d",
      "commit_url": "https://api.github.com/repos/sipa/bitcoin/commits/e1ca6e1b63e61e224be5184d97f2a931282c106d",
      "created_at": "2023-09-05T01:46:00Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 10278152426,
      "node_id": "HRFPE_lADOABII585vHSmAzwAAAAJkoCjq",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10278152426",
      "actor": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": "196df2ab0017964ef10a9c720a1fc7abbea5176e",
      "commit_url": "https://api.github.com/repos/sipa/bitcoin/commits/196df2ab0017964ef10a9c720a1fc7abbea5176e",
      "created_at": "2023-09-05T02:19:07Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 10283468918,
      "node_id": "HRFPE_lADOABII585vHSmAzwAAAAJk8Uh2",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10283468918",
      "actor": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": "367f7f7a9fce68f7e6b8bf25846c086532a4044f",
      "commit_url": "https://api.github.com/repos/sipa/bitcoin/commits/367f7f7a9fce68f7e6b8bf25846c086532a4044f",
      "created_at": "2023-09-05T13:05:33Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 10284991329,
      "node_id": "HRFPE_lADOABII585vHSmAzwAAAAJlCINh",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10284991329",
      "actor": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": "faca409cc061ae30f15d7fefeeff67cc8fdf4a62",
      "commit_url": "https://api.github.com/repos/sipa/bitcoin/commits/faca409cc061ae30f15d7fefeeff67cc8fdf4a62",
      "created_at": "2023-09-05T15:09:37Z"
    },
    {
      "event": "labeled",
      "id": 10284992112,
      "node_id": "LE_lADOABII585vHSmAzwAAAAJlCIZw",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10284992112",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-09-05T15:09:41Z",
      "label": {
        "name": "CI failed",
        "color": "cccccc"
      }
    },
    {
      "event": "head_ref_force_pushed",
      "id": 10286114982,
      "node_id": "HRFPE_lADOABII585vHSmAzwAAAAJlGaim",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10286114982",
      "actor": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": "18d1bdabcda8224621915199194e96a2a0d9b28a",
      "commit_url": "https://api.github.com/repos/sipa/bitcoin/commits/18d1bdabcda8224621915199194e96a2a0d9b28a",
      "created_at": "2023-09-05T17:09:09Z"
    },
    {
      "event": "unlabeled",
      "id": 10287280816,
      "node_id": "UNLE_lADOABII585vHSmAzwAAAAJlK3Kw",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10287280816",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-09-05T19:22:44Z",
      "label": {
        "name": "CI failed",
        "color": "cccccc"
      }
    },
    {
      "event": "head_ref_force_pushed",
      "id": 10290385323,
      "node_id": "HRFPE_lADOABII585vHSmAzwAAAAJlWtGr",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10290385323",
      "actor": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": "dc91552b66c6f2808d7085fcc6f25b57a5a0ff95",
      "commit_url": "https://api.github.com/repos/sipa/bitcoin/commits/dc91552b66c6f2808d7085fcc6f25b57a5a0ff95",
      "created_at": "2023-09-06T03:39:54Z"
    },
    {
      "event": "labeled",
      "id": 10291444182,
      "node_id": "LE_lADOABII585vHSmAzwAAAAJlavnW",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10291444182",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-09-06T06:00:12Z",
      "label": {
        "name": "CI failed",
        "color": "cccccc"
      }
    },
    {
      "event": "head_ref_force_pushed",
      "id": 10295561696,
      "node_id": "HRFPE_lADOABII585vHSmAzwAAAAJlqc3g",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10295561696",
      "actor": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": "402993fcfe050a3ba75f3d2f2374b3fdda236a97",
      "commit_url": "https://api.github.com/repos/sipa/bitcoin/commits/402993fcfe050a3ba75f3d2f2374b3fdda236a97",
      "created_at": "2023-09-06T12:52:35Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 10296039647,
      "node_id": "HRFPE_lADOABII585vHSmAzwAAAAJlsRjf",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10296039647",
      "actor": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": "6e558f767d6a88a5bfe6d89ac4909e6f90d64593",
      "commit_url": "https://api.github.com/repos/sipa/bitcoin/commits/6e558f767d6a88a5bfe6d89ac4909e6f90d64593",
      "created_at": "2023-09-06T13:32:02Z"
    },
    {
      "event": "unlabeled",
      "id": 10297268746,
      "node_id": "UNLE_lADOABII585vHSmAzwAAAAJlw9oK",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10297268746",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-09-06T15:06:54Z",
      "label": {
        "name": "CI failed",
        "color": "cccccc"
      }
    },
    {
      "event": "head_ref_force_pushed",
      "id": 10299360614,
      "node_id": "HRFPE_lADOABII585vHSmAzwAAAAJl48Vm",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10299360614",
      "actor": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": "d86b58b8469358ac09237e84a8866d2f27a36470",
      "commit_url": "https://api.github.com/repos/sipa/bitcoin/commits/d86b58b8469358ac09237e84a8866d2f27a36470",
      "created_at": "2023-09-06T18:38:29Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 10299650580,
      "node_id": "HRFPE_lADOABII585vHSmAzwAAAAJl6DIU",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10299650580",
      "actor": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": "bbd378c8f0b29f57c795ea52c84be1374de1b4ea",
      "commit_url": "https://api.github.com/repos/sipa/bitcoin/commits/bbd378c8f0b29f57c795ea52c84be1374de1b4ea",
      "created_at": "2023-09-06T19:13:20Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 10300403743,
      "node_id": "HRFPE_lADOABII585vHSmAzwAAAAJl87Af",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10300403743",
      "actor": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": "468bec1e3fdaa1a1faafc63e15bdd88e58b877c6",
      "commit_url": "https://api.github.com/repos/sipa/bitcoin/commits/468bec1e3fdaa1a1faafc63e15bdd88e58b877c6",
      "created_at": "2023-09-06T20:42:42Z"
    },
    {
      "event": "labeled",
      "id": 10300404485,
      "node_id": "LE_lADOABII585vHSmAzwAAAAJl87MF",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10300404485",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-09-06T20:42:47Z",
      "label": {
        "name": "CI failed",
        "color": "cccccc"
      }
    },
    {
      "event": "head_ref_force_pushed",
      "id": 10300594171,
      "node_id": "HRFPE_lADOABII585vHSmAzwAAAAJl9pf7",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10300594171",
      "actor": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": "a93d0852b5c615d5e1a744eadd6953bd651bfca2",
      "commit_url": "https://api.github.com/repos/sipa/bitcoin/commits/a93d0852b5c615d5e1a744eadd6953bd651bfca2",
      "created_at": "2023-09-06T21:07:09Z"
    },
    {
      "event": "unlabeled",
      "id": 10303892152,
      "node_id": "UNLE_lADOABII585vHSmAzwAAAAJmKOq4",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10303892152",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-09-07T07:39:45Z",
      "label": {
        "name": "CI failed",
        "color": "cccccc"
      }
    },
    {
      "event": "head_ref_force_pushed",
      "id": 10307212281,
      "node_id": "HRFPE_lADOABII585vHSmAzwAAAAJmW5P5",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10307212281",
      "actor": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": "fc194fc719a039aace9a1d84af3147347c154b6a",
      "commit_url": "https://api.github.com/repos/sipa/bitcoin/commits/fc194fc719a039aace9a1d84af3147347c154b6a",
      "created_at": "2023-09-07T13:07:45Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 10319496941,
      "node_id": "HRFPE_lADOABII585vHSmAzwAAAAJnFwbt",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10319496941",
      "actor": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": "c6654eee96a68f398c91a260cae1c18c35d83a27",
      "commit_url": "https://api.github.com/repos/sipa/bitcoin/commits/c6654eee96a68f398c91a260cae1c18c35d83a27",
      "created_at": "2023-09-08T15:22:19Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 10324553022,
      "node_id": "HRFPE_lADOABII585vHSmAzwAAAAJnZC0-",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10324553022",
      "actor": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": "0f076509523bdf8388c3a98a5da238c99d265c34",
      "commit_url": "https://api.github.com/repos/sipa/bitcoin/commits/0f076509523bdf8388c3a98a5da238c99d265c34",
      "created_at": "2023-09-09T15:53:32Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 10325288999,
      "node_id": "HRFPE_lADOABII585vHSmAzwAAAAJnb2gn",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10325288999",
      "actor": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": "8704497fcab8cffc90ee45381f86895f4d9a5296",
      "commit_url": "https://api.github.com/repos/sipa/bitcoin/commits/8704497fcab8cffc90ee45381f86895f4d9a5296",
      "created_at": "2023-09-10T01:44:45Z"
    },
    {
      "event": "labeled",
      "id": 10326260258,
      "node_id": "LE_lADOABII585vHSmAzwAAAAJnfjoi",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10326260258",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-09-10T12:17:41Z",
      "label": {
        "name": "CI failed",
        "color": "cccccc"
      }
    },
    {
      "event": "head_ref_force_pushed",
      "id": 10326362222,
      "node_id": "HRFPE_lADOABII585vHSmAzwAAAAJnf8hu",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10326362222",
      "actor": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": "7dc0a5fc4d6627ddec7c2b26c741d8f1b7606076",
      "commit_url": "https://api.github.com/repos/sipa/bitcoin/commits/7dc0a5fc4d6627ddec7c2b26c741d8f1b7606076",
      "created_at": "2023-09-10T13:22:27Z"
    },
    {
      "event": "ready_for_review",
      "id": 10326554844,
      "node_id": "RFRE_lADOABII585vHSmAzwAAAAJngrjc",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10326554844",
      "actor": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-09-10T15:19:55Z"
    },
    {
      "event": "commented",
      "id": 1712841353,
      "node_id": "IC_kwDOABII585mF-KJ",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1712841353",
      "actor": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-09-10T15:20:07Z",
      "updated_at": "2023-09-10T15:20:07Z",
      "author_association": "MEMBER",
      "body": "Marked as ready for review.",
      "user": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28331#issuecomment-1712841353",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/28331"
    },
    {
      "event": "unlabeled",
      "id": 10327050726,
      "node_id": "UNLE_lADOABII585vHSmAzwAAAAJniknm",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10327050726",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-09-10T18:23:26Z",
      "label": {
        "name": "CI failed",
        "color": "cccccc"
      }
    },
    {
      "event": "head_ref_force_pushed",
      "id": 10327448148,
      "node_id": "HRFPE_lADOABII585vHSmAzwAAAAJnkFpU",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10327448148",
      "actor": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": "f47e8b8251a9d6ba6182c2ec68fb5f53df5d6144",
      "commit_url": "https://api.github.com/repos/sipa/bitcoin/commits/f47e8b8251a9d6ba6182c2ec68fb5f53df5d6144",
      "created_at": "2023-09-10T22:30:01Z"
    },
    {
      "event": "labeled",
      "id": 10331521961,
      "node_id": "LE_lADOABII585vHSmAzwAAAAJnzoOp",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10331521961",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-09-11T09:23:19Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "commented",
      "id": 1713679095,
      "node_id": "IC_kwDOABII585mJKr3",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1713679095",
      "actor": {
        "login": "hebasto",
        "id": 32963518,
        "node_id": "MDQ6VXNlcjMyOTYzNTE4",
        "avatar_url": "https://avatars.githubusercontent.com/u/32963518?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/hebasto",
        "html_url": "https://github.com/hebasto",
        "followers_url": "https://api.github.com/users/hebasto/followers",
        "following_url": "https://api.github.com/users/hebasto/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/hebasto/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/hebasto/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/hebasto/subscriptions",
        "organizations_url": "https://api.github.com/users/hebasto/orgs",
        "repos_url": "https://api.github.com/users/hebasto/repos",
        "events_url": "https://api.github.com/users/hebasto/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/hebasto/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-09-11T11:19:03Z",
      "updated_at": "2023-09-11T11:19:03Z",
      "author_association": "MEMBER",
      "body": "> ... it would still be cool to have a lock icon in the peers tab in the GUI...\r\n\r\nSee https://github.com/bitcoin-core/gui/pull/754 (however, not a lock icon).",
      "user": {
        "login": "hebasto",
        "id": 32963518,
        "node_id": "MDQ6VXNlcjMyOTYzNTE4",
        "avatar_url": "https://avatars.githubusercontent.com/u/32963518?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/hebasto",
        "html_url": "https://github.com/hebasto",
        "followers_url": "https://api.github.com/users/hebasto/followers",
        "following_url": "https://api.github.com/users/hebasto/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/hebasto/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/hebasto/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/hebasto/subscriptions",
        "organizations_url": "https://api.github.com/users/hebasto/orgs",
        "repos_url": "https://api.github.com/users/hebasto/repos",
        "events_url": "https://api.github.com/users/hebasto/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/hebasto/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28331#issuecomment-1713679095",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/28331"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 10332949741,
      "node_id": "HRFPE_lADOABII585vHSmAzwAAAAJn5Ezt",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10332949741",
      "actor": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": "2aabbdf4de01ef1a3fb0c1bb86ef163c9fba587b",
      "commit_url": "https://api.github.com/repos/sipa/bitcoin/commits/2aabbdf4de01ef1a3fb0c1bb86ef163c9fba587b",
      "created_at": "2023-09-11T11:33:32Z"
    },
    {
      "event": "unlabeled",
      "id": 10334391567,
      "node_id": "UNLE_lADOABII585vHSmAzwAAAAJn-k0P",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10334391567",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-09-11T13:37:54Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "reviewed",
      "id": 1620466774,
      "node_id": "PRR_kwDOABII585gllxW",
      "url": null,
      "actor": null,
      "commit_id": "2aabbdf4de01ef1a3fb0c1bb86ef163c9fba587b",
      "commit_url": null,
      "created_at": null,
      "author_association": "CONTRIBUTOR",
      "body": "Concept ACK\r\n\r\nDid a quick first review round, a more detailled one is about to follow.",
      "user": {
        "login": "theStack",
        "id": 91535,
        "node_id": "MDQ6VXNlcjkxNTM1",
        "avatar_url": "https://avatars.githubusercontent.com/u/91535?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theStack",
        "html_url": "https://github.com/theStack",
        "followers_url": "https://api.github.com/users/theStack/followers",
        "following_url": "https://api.github.com/users/theStack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theStack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theStack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theStack/subscriptions",
        "organizations_url": "https://api.github.com/users/theStack/orgs",
        "repos_url": "https://api.github.com/users/theStack/repos",
        "events_url": "https://api.github.com/users/theStack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theStack/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28331#pullrequestreview-1620466774",
      "submitted_at": "2023-09-11T17:21:08Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28331"
    },
    {
      "event": "reviewed",
      "id": 1621530741,
      "node_id": "PRR_kwDOABII585gpph1",
      "url": null,
      "actor": null,
      "commit_id": "2aabbdf4de01ef1a3fb0c1bb86ef163c9fba587b",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "body": "left some nits on the tests, feel free to ignore.",
      "user": {
        "login": "maflcko",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/maflcko",
        "html_url": "https://github.com/maflcko",
        "followers_url": "https://api.github.com/users/maflcko/followers",
        "following_url": "https://api.github.com/users/maflcko/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/maflcko/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/maflcko/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/maflcko/subscriptions",
        "organizations_url": "https://api.github.com/users/maflcko/orgs",
        "repos_url": "https://api.github.com/users/maflcko/repos",
        "events_url": "https://api.github.com/users/maflcko/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/maflcko/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28331#pullrequestreview-1621530741",
      "submitted_at": "2023-09-12T08:02:43Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28331"
    },
    {
      "event": "commented",
      "id": 1718137057,
      "node_id": "IC_kwDOABII585maLDh",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1718137057",
      "actor": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-09-13T18:41:21Z",
      "updated_at": "2023-09-13T18:41:50Z",
      "author_association": "MEMBER",
      "body": "Couple things while testing this out:\r\n\r\n* Would be nice to have the transport type and session id also show in the GUI's peer info page\r\n* Could we log the connection version once the connection is established? Maybe once we receive their version message? The transport version can be figured out from the logs for outbound connections, but not for inbound.",
      "user": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28331#issuecomment-1718137057",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/28331"
    },
    {
      "event": "commented",
      "id": 1718168633,
      "node_id": "IC_kwDOABII585maSw5",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1718168633",
      "actor": {
        "login": "Sjors",
        "id": 10217,
        "node_id": "MDQ6VXNlcjEwMjE3",
        "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Sjors",
        "html_url": "https://github.com/Sjors",
        "followers_url": "https://api.github.com/users/Sjors/followers",
        "following_url": "https://api.github.com/users/Sjors/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Sjors/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Sjors/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
        "organizations_url": "https://api.github.com/users/Sjors/orgs",
        "repos_url": "https://api.github.com/users/Sjors/repos",
        "events_url": "https://api.github.com/users/Sjors/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Sjors/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-09-13T19:06:10Z",
      "updated_at": "2023-09-13T19:06:10Z",
      "author_association": "MEMBER",
      "body": "(deleted my last comment, forgot to add `true` to the RPC call)",
      "user": {
        "login": "Sjors",
        "id": 10217,
        "node_id": "MDQ6VXNlcjEwMjE3",
        "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Sjors",
        "html_url": "https://github.com/Sjors",
        "followers_url": "https://api.github.com/users/Sjors/followers",
        "following_url": "https://api.github.com/users/Sjors/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Sjors/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Sjors/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
        "organizations_url": "https://api.github.com/users/Sjors/orgs",
        "repos_url": "https://api.github.com/users/Sjors/repos",
        "events_url": "https://api.github.com/users/Sjors/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Sjors/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28331#issuecomment-1718168633",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/28331"
    },
    {
      "event": "reviewed",
      "id": 1625319787,
      "node_id": "PRR_kwDOABII585g4Glr",
      "url": null,
      "actor": null,
      "commit_id": "2aabbdf4de01ef1a3fb0c1bb86ef163c9fba587b",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "body": "Lightly reviewed 2aabbdf4de01ef1a3fb0c1bb86ef163c9fba587b. I've also been running this on mainnet for a while.\r\n\r\nI assume 55079fedeeca488f360d200b1d2d24c2f614bc73 will be replaced with whatever ends up merged in #28452?\r\n\r\n1768aff56d6feedcb22b21df12e8926924fdac6a look fine, modulo https://github.com/bitcoin/bitcoin/pull/28331/commits/1768aff56d6feedcb22b21df12e8926924fdac6a#r1321845616\r\n\r\nI didn't study 8672b854fb7a81a400150ef09e99a06c829b68f8 much.\r\n\r\nCan you expand the description of 4cfbbceff35fcf22a232c66278c4ababd750d9bb a bit to explain under what circumstances `PerformReconnections()` is called and elaborate a bit on the various delays? Particuarly, if we tried a v2 connection and failed, how long do we wait before retrying with v1?",
      "user": {
        "login": "Sjors",
        "id": 10217,
        "node_id": "MDQ6VXNlcjEwMjE3",
        "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Sjors",
        "html_url": "https://github.com/Sjors",
        "followers_url": "https://api.github.com/users/Sjors/followers",
        "following_url": "https://api.github.com/users/Sjors/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Sjors/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Sjors/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
        "organizations_url": "https://api.github.com/users/Sjors/orgs",
        "repos_url": "https://api.github.com/users/Sjors/repos",
        "events_url": "https://api.github.com/users/Sjors/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Sjors/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28331#pullrequestreview-1625319787",
      "submitted_at": "2023-09-13T20:12:54Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28331"
    },
    {
      "event": "reviewed",
      "id": 1625394283,
      "node_id": "PRR_kwDOABII585g4Yxr",
      "url": null,
      "actor": null,
      "commit_id": "2aabbdf4de01ef1a3fb0c1bb86ef163c9fba587b",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "body": "Approach ACK. Suggest reviewers consider testing this using the logging in #28248 that uncovered peer connection issues in the interactions between automatic and manual, outbound and inbound, and some that are network-specific, given that this pull adds another dimension.",
      "user": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28331#pullrequestreview-1625394283",
      "submitted_at": "2023-09-13T20:30:11Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28331"
    },
    {
      "event": "commented",
      "id": 1718391205,
      "node_id": "IC_kwDOABII585mbJGl",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1718391205",
      "actor": {
        "login": "hebasto",
        "id": 32963518,
        "node_id": "MDQ6VXNlcjMyOTYzNTE4",
        "avatar_url": "https://avatars.githubusercontent.com/u/32963518?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/hebasto",
        "html_url": "https://github.com/hebasto",
        "followers_url": "https://api.github.com/users/hebasto/followers",
        "following_url": "https://api.github.com/users/hebasto/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/hebasto/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/hebasto/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/hebasto/subscriptions",
        "organizations_url": "https://api.github.com/users/hebasto/orgs",
        "repos_url": "https://api.github.com/users/hebasto/repos",
        "events_url": "https://api.github.com/users/hebasto/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/hebasto/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-09-13T22:22:08Z",
      "updated_at": "2023-09-13T22:22:08Z",
      "author_association": "MEMBER",
      "body": ">    * Would be nice to have the transport type and session id also show in the GUI's peer info page\r\n\r\nhttps://github.com/bitcoin-core/gui/pull/754",
      "user": {
        "login": "hebasto",
        "id": 32963518,
        "node_id": "MDQ6VXNlcjMyOTYzNTE4",
        "avatar_url": "https://avatars.githubusercontent.com/u/32963518?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/hebasto",
        "html_url": "https://github.com/hebasto",
        "followers_url": "https://api.github.com/users/hebasto/followers",
        "following_url": "https://api.github.com/users/hebasto/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/hebasto/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/hebasto/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/hebasto/subscriptions",
        "organizations_url": "https://api.github.com/users/hebasto/orgs",
        "repos_url": "https://api.github.com/users/hebasto/repos",
        "events_url": "https://api.github.com/users/hebasto/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/hebasto/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28331#issuecomment-1718391205",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/28331"
    },
    {
      "event": "commented",
      "id": 1718394831,
      "node_id": "IC_kwDOABII585mbJ_P",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1718394831",
      "actor": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-09-13T22:26:46Z",
      "updated_at": "2023-09-13T22:26:46Z",
      "author_association": "MEMBER",
      "body": "> Would be nice to have the transport type and session id also show in the GUI's peer info page\r\n\r\nAm updating `-netinfo` for bip324 / v2 p2p as well.\r\n",
      "user": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28331#issuecomment-1718394831",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/28331"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 10365240087,
      "node_id": "HRFPE_lADOABII585vHSmAzwAAAAJp0QMX",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10365240087",
      "actor": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": "018594ef44dc57e828a9a38c9643f85fb6c2a1e4",
      "commit_url": "https://api.github.com/repos/sipa/bitcoin/commits/018594ef44dc57e828a9a38c9643f85fb6c2a1e4",
      "created_at": "2023-09-13T22:37:43Z"
    },
    {
      "event": "commented",
      "id": 1718407366,
      "node_id": "IC_kwDOABII585mbNDG",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1718407366",
      "actor": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-09-13T22:43:38Z",
      "updated_at": "2023-09-13T22:43:38Z",
      "author_association": "MEMBER",
      "body": "@achow101 \r\n\r\n> * Would be nice to have the transport type and session id also show in the GUI's peer info page\r\n\r\nhttps://github.com/bitcoin-core/gui/pull/754\r\n\r\n> * Could we log the connection version once the connection is established? Maybe once we receive their version message? The transport version can be figured out from the logs for outbound connections, but not for inbound.\r\n\r\nI've added logging on VERACK for both inbound and outbound (but only with -debug=net for inbound, because possible spam).\r\n\r\n@Sjors\r\n\r\n> I assume https://github.com/bitcoin/bitcoin/commit/55079fedeeca488f360d200b1d2d24c2f614bc73 will be replaced with whatever ends up merged in https://github.com/bitcoin/bitcoin/pull/28452?\r\n\r\nRebased on top of it.\r\n\r\n> Can you expand the description of https://github.com/bitcoin/bitcoin/commit/4cfbbceff35fcf22a232c66278c4ababd750d9bb a bit to explain under what circumstances PerformReconnections() is called and elaborate a bit on the various delays? Particuarly, if we tried a v2 connection and failed, how long do we wait before retrying with v1?\r\n\r\nIt should be pretty much immediately - the very next time a connection is attempted to be created.",
      "user": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28331#issuecomment-1718407366",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/28331"
    },
    {
      "event": "mentioned",
      "id": 10365268177,
      "node_id": "MEE_lADOABII585vHSmAzwAAAAJp0XDR",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10365268177",
      "actor": {
        "login": "Sjors",
        "id": 10217,
        "node_id": "MDQ6VXNlcjEwMjE3",
        "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Sjors",
        "html_url": "https://github.com/Sjors",
        "followers_url": "https://api.github.com/users/Sjors/followers",
        "following_url": "https://api.github.com/users/Sjors/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Sjors/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Sjors/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
        "organizations_url": "https://api.github.com/users/Sjors/orgs",
        "repos_url": "https://api.github.com/users/Sjors/repos",
        "events_url": "https://api.github.com/users/Sjors/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Sjors/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-09-13T22:43:39Z"
    },
    {
      "event": "subscribed",
      "id": 10365268181,
      "node_id": "SE_lADOABII585vHSmAzwAAAAJp0XDV",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10365268181",
      "actor": {
        "login": "Sjors",
        "id": 10217,
        "node_id": "MDQ6VXNlcjEwMjE3",
        "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Sjors",
        "html_url": "https://github.com/Sjors",
        "followers_url": "https://api.github.com/users/Sjors/followers",
        "following_url": "https://api.github.com/users/Sjors/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Sjors/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Sjors/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
        "organizations_url": "https://api.github.com/users/Sjors/orgs",
        "repos_url": "https://api.github.com/users/Sjors/repos",
        "events_url": "https://api.github.com/users/Sjors/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Sjors/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-09-13T22:43:39Z"
    },
    {
      "event": "mentioned",
      "id": 10365268194,
      "node_id": "MEE_lADOABII585vHSmAzwAAAAJp0XDi",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10365268194",
      "actor": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-09-13T22:43:39Z"
    },
    {
      "event": "subscribed",
      "id": 10365268201,
      "node_id": "SE_lADOABII585vHSmAzwAAAAJp0XDp",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10365268201",
      "actor": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-09-13T22:43:39Z"
    },
    {
      "event": "reviewed",
      "id": 1625578789,
      "node_id": "PRR_kwDOABII585g5F0l",
      "url": null,
      "actor": null,
      "commit_id": "f2048453190df06282e515977cd805db709c7e60",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "user": {
        "login": "Sjors",
        "id": 10217,
        "node_id": "MDQ6VXNlcjEwMjE3",
        "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Sjors",
        "html_url": "https://github.com/Sjors",
        "followers_url": "https://api.github.com/users/Sjors/followers",
        "following_url": "https://api.github.com/users/Sjors/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Sjors/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Sjors/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
        "organizations_url": "https://api.github.com/users/Sjors/orgs",
        "repos_url": "https://api.github.com/users/Sjors/repos",
        "events_url": "https://api.github.com/users/Sjors/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Sjors/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28331#pullrequestreview-1625578789",
      "submitted_at": "2023-09-13T23:18:00Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28331"
    },
    {
      "event": "reviewed",
      "id": 1625946910,
      "node_id": "PRR_kwDOABII585g6fse",
      "url": null,
      "actor": null,
      "commit_id": "018594ef44dc57e828a9a38c9643f85fb6c2a1e4",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "body": "Clarified my test nit about `invalid_call=False`. Feel free to ignore",
      "user": {
        "login": "maflcko",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/maflcko",
        "html_url": "https://github.com/maflcko",
        "followers_url": "https://api.github.com/users/maflcko/followers",
        "following_url": "https://api.github.com/users/maflcko/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/maflcko/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/maflcko/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/maflcko/subscriptions",
        "organizations_url": "https://api.github.com/users/maflcko/orgs",
        "repos_url": "https://api.github.com/users/maflcko/repos",
        "events_url": "https://api.github.com/users/maflcko/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/maflcko/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28331#pullrequestreview-1625946910",
      "submitted_at": "2023-09-14T06:15:33Z",
      "state": "APPROVED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28331"
    },
    {
      "event": "labeled",
      "id": 10370575141,
      "node_id": "LE_lADOABII585vHSmAzwAAAAJqImsl",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10370575141",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-09-14T10:37:44Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "head_ref_force_pushed",
      "id": 10371583026,
      "node_id": "HRFPE_lADOABII585vHSmAzwAAAAJqMcwy",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10371583026",
      "actor": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": "0c4a18deb77c575cbce4b84adff7e26b57f6fdfd",
      "commit_url": "https://api.github.com/repos/sipa/bitcoin/commits/0c4a18deb77c575cbce4b84adff7e26b57f6fdfd",
      "created_at": "2023-09-14T12:18:39Z"
    },
    {
      "event": "unlabeled",
      "id": 10371900770,
      "node_id": "UNLE_lADOABII585vHSmAzwAAAAJqNqVi",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10371900770",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-09-14T12:47:30Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "head_ref_force_pushed",
      "id": 10372000616,
      "node_id": "HRFPE_lADOABII585vHSmAzwAAAAJqOCto",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10372000616",
      "actor": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": "d412e7ff0da595ef5b1da53562e2d73e21c4e417",
      "commit_url": "https://api.github.com/repos/sipa/bitcoin/commits/d412e7ff0da595ef5b1da53562e2d73e21c4e417",
      "created_at": "2023-09-14T12:56:38Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 10372050154,
      "node_id": "HRFPE_lADOABII585vHSmAzwAAAAJqOOzq",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10372050154",
      "actor": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": "0ddc8a82f2b4f9751e1f474fe1138b7488b3ed27",
      "commit_url": "https://api.github.com/repos/sipa/bitcoin/commits/0ddc8a82f2b4f9751e1f474fe1138b7488b3ed27",
      "created_at": "2023-09-14T13:01:01Z"
    },
    {
      "event": "commented",
      "id": 1719522412,
      "node_id": "IC_kwDOABII585mfdRs",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1719522412",
      "actor": {
        "login": "jsarenik",
        "id": 244565,
        "node_id": "MDQ6VXNlcjI0NDU2NQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/244565?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jsarenik",
        "html_url": "https://github.com/jsarenik",
        "followers_url": "https://api.github.com/users/jsarenik/followers",
        "following_url": "https://api.github.com/users/jsarenik/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jsarenik/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jsarenik/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jsarenik/subscriptions",
        "organizations_url": "https://api.github.com/users/jsarenik/orgs",
        "repos_url": "https://api.github.com/users/jsarenik/repos",
        "events_url": "https://api.github.com/users/jsarenik/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jsarenik/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-09-14T14:05:25Z",
      "updated_at": "2024-02-22T14:01:08Z",
      "author_association": "NONE",
      "body": "One running on ln.uk.ms, see http://anyone.eu.org/bitcoin.txt or https://be.anyone.eu.org/node-details for addresses.",
      "user": {
        "login": "jsarenik",
        "id": 244565,
        "node_id": "MDQ6VXNlcjI0NDU2NQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/244565?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jsarenik",
        "html_url": "https://github.com/jsarenik",
        "followers_url": "https://api.github.com/users/jsarenik/followers",
        "following_url": "https://api.github.com/users/jsarenik/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jsarenik/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jsarenik/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jsarenik/subscriptions",
        "organizations_url": "https://api.github.com/users/jsarenik/orgs",
        "repos_url": "https://api.github.com/users/jsarenik/repos",
        "events_url": "https://api.github.com/users/jsarenik/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jsarenik/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28331#issuecomment-1719522412",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/28331"
    },
    {
      "event": "reviewed",
      "id": 1628752549,
      "node_id": "PRR_kwDOABII585hFMql",
      "url": null,
      "actor": null,
      "commit_id": "0ddc8a82f2b4f9751e1f474fe1138b7488b3ed27",
      "commit_url": null,
      "created_at": null,
      "author_association": "CONTRIBUTOR",
      "body": "After startup I frequently see `getpeerinfo` outbound peer entries like the following:\r\n```\r\n$ ./src/bitcoin-cli getpeerinfo\r\n{\r\n  ...,\r\n  \"services\": \"0000000000000000\",\r\n  \"servicesnames\": [\r\n  ],\r\n  \"bytessent_per_msg\": {\r\n    \"\": 2614\r\n  },\r\n  \"bytesrecv_per_msg\": {\r\n  },\r\n  \"connection_type\": \"outbound-full-relay\",\r\n  \"transport_protocol_type\": \"v2\",\r\n  \"session_id\": \"\"\r\n}\r\n```\r\n\r\nSo it seems that even though the p2p v2 handshake isn't completed yet, the \"transport_protocol_type\" is already reported as \"v2\". Should we also use \"detecting\" (or something else) for the sender side in this case?\r\n\r\nHaven't checked in detail, but I suspect that this happens if a peer according to addrman signals NODE_P2P_V2 and we hence try to initiate a v2 connection, but the other side only supports p2p v1? (or, for some other reason the handshake doesn't complete).",
      "user": {
        "login": "theStack",
        "id": 91535,
        "node_id": "MDQ6VXNlcjkxNTM1",
        "avatar_url": "https://avatars.githubusercontent.com/u/91535?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theStack",
        "html_url": "https://github.com/theStack",
        "followers_url": "https://api.github.com/users/theStack/followers",
        "following_url": "https://api.github.com/users/theStack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theStack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theStack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theStack/subscriptions",
        "organizations_url": "https://api.github.com/users/theStack/orgs",
        "repos_url": "https://api.github.com/users/theStack/repos",
        "events_url": "https://api.github.com/users/theStack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theStack/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28331#pullrequestreview-1628752549",
      "submitted_at": "2023-09-15T11:31:02Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28331"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 10382653631,
      "node_id": "HRFPE_lADOABII585vHSmAzwAAAAJq2ri_",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10382653631",
      "actor": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": "ead7f966b9798d74477a49dabf0b21a026b7802c",
      "commit_url": "https://api.github.com/repos/sipa/bitcoin/commits/ead7f966b9798d74477a49dabf0b21a026b7802c",
      "created_at": "2023-09-15T12:03:15Z"
    },
    {
      "event": "commented",
      "id": 1721167073,
      "node_id": "IC_kwDOABII585mluzh",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1721167073",
      "actor": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-09-15T12:06:26Z",
      "updated_at": "2023-09-15T12:06:26Z",
      "author_association": "MEMBER",
      "body": "@theStack Good call, that's confusing.\r\n\r\nWhat's going on is that the code only reported \"detecting\" for inbound possibly-v2 connections where the 12-byte prefix hasn't been received yet. In inbound that's more or less correct, except that peer that send non-bitcoin traffic would also get incorrectly classified as v2.\r\n\r\nI've changed it to align the transport version and the session id: only say v2 when the garbage auth packet has been completely received; before that point \"detecting\" will be reported.\r\n\r\nDiff:\r\n\r\n```diff\r\n--- a/src/net.cpp\r\n+++ b/src/net.cpp\r\n@@ -1637,15 +1637,14 @@ Transport::Info V2Transport::GetInfo() const noexcept\r\n \r\n     Transport::Info info;\r\n \r\n-    // Report DETECTING as transport type if we don't know whether the peer is V1 or V2.\r\n-    info.transport_type = m_recv_state ==\r\n-        RecvState::KEY_MAYBE_V1 ? TransportProtocolType::DETECTING : TransportProtocolType::V2;\r\n-\r\n-    // Do not report the session ID until the garbage authentication packet has been received and\r\n-    // verified (confirming that the other side very likely has the same keys as us).\r\n+    // Do not report v2 and session ID until the garbage authentication packet has been received\r\n+    // and verified (confirming that the other side very likely has the same keys as us).\r\n     if (m_recv_state != RecvState::KEY_MAYBE_V1 && m_recv_state != RecvState::KEY &&\r\n         m_recv_state != RecvState::GARB_GARBTERM && m_recv_state != RecvState::GARBAUTH) {\r\n+        info.transport_type = TransportProtocolType::V2;\r\n         info.session_id = uint256(MakeUCharSpan(m_cipher.GetSessionID()));\r\n+    } else {\r\n+        info.transport_type = TransportProtocolType::DETECTING;\r\n     }\r\n \r\n     return info;\r\n```",
      "user": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28331#issuecomment-1721167073",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/28331"
    },
    {
      "event": "mentioned",
      "id": 10382682302,
      "node_id": "MEE_lADOABII585vHSmAzwAAAAJq2yi-",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10382682302",
      "actor": {
        "login": "theStack",
        "id": 91535,
        "node_id": "MDQ6VXNlcjkxNTM1",
        "avatar_url": "https://avatars.githubusercontent.com/u/91535?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theStack",
        "html_url": "https://github.com/theStack",
        "followers_url": "https://api.github.com/users/theStack/followers",
        "following_url": "https://api.github.com/users/theStack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theStack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theStack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theStack/subscriptions",
        "organizations_url": "https://api.github.com/users/theStack/orgs",
        "repos_url": "https://api.github.com/users/theStack/repos",
        "events_url": "https://api.github.com/users/theStack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theStack/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-09-15T12:06:26Z"
    },
    {
      "event": "subscribed",
      "id": 10382682318,
      "node_id": "SE_lADOABII585vHSmAzwAAAAJq2yjO",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10382682318",
      "actor": {
        "login": "theStack",
        "id": 91535,
        "node_id": "MDQ6VXNlcjkxNTM1",
        "avatar_url": "https://avatars.githubusercontent.com/u/91535?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theStack",
        "html_url": "https://github.com/theStack",
        "followers_url": "https://api.github.com/users/theStack/followers",
        "following_url": "https://api.github.com/users/theStack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theStack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theStack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theStack/subscriptions",
        "organizations_url": "https://api.github.com/users/theStack/orgs",
        "repos_url": "https://api.github.com/users/theStack/repos",
        "events_url": "https://api.github.com/users/theStack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theStack/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-09-15T12:06:26Z"
    },
    {
      "event": "commented",
      "id": 1721445548,
      "node_id": "IC_kwDOABII585mmyys",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1721445548",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-09-15T15:14:32Z",
      "updated_at": "2023-09-15T15:14:32Z",
      "author_association": "CONTRIBUTOR",
      "body": "Concept ACK\r\n\r\n`-v2transport` is maybe a bit too obscure from the users' point of view? Something like `-p2pencryption` may be clearer.",
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28331#issuecomment-1721445548",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/28331"
    },
    {
      "event": "commented",
      "id": 1721451993,
      "node_id": "IC_kwDOABII585mm0XZ",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1721451993",
      "actor": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-09-15T15:18:39Z",
      "updated_at": "2023-09-15T15:20:12Z",
      "author_association": "MEMBER",
      "body": "@vasild \n\n* I consider the `-v2transport` an option just for people who want to experiment with it, before it gets enabled by default.\n* I worry that advertising the feature as \"encryption\" would result in incorrect assumptions about what it achieves (which is raising costs for large-scale observers, if deployed at scale; it doesn't really protect privacy for your own actions against a deliberate attacker).",
      "user": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28331#issuecomment-1721451993",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/28331"
    },
    {
      "event": "mentioned",
      "id": 10384726229,
      "node_id": "MEE_lADOABII585vHSmAzwAAAAJq-ljV",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10384726229",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-09-15T15:18:39Z"
    },
    {
      "event": "subscribed",
      "id": 10384726242,
      "node_id": "SE_lADOABII585vHSmAzwAAAAJq-lji",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10384726242",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-09-15T15:18:39Z"
    },
    {
      "event": "reviewed",
      "id": 1627710444,
      "node_id": "PRR_kwDOABII585hBOPs",
      "url": null,
      "actor": null,
      "commit_id": "ead7f966b9798d74477a49dabf0b21a026b7802c",
      "commit_url": null,
      "created_at": null,
      "author_association": "CONTRIBUTOR",
      "body": "Concept ACK",
      "user": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28331#pullrequestreview-1627710444",
      "submitted_at": "2023-09-15T15:34:28Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28331"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 10387356677,
      "node_id": "HRFPE_lADOABII585vHSmAzwAAAAJrInwF",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10387356677",
      "actor": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": "3a863961d18f816155a58fcae41933746f30bcae",
      "commit_url": "https://api.github.com/repos/sipa/bitcoin/commits/3a863961d18f816155a58fcae41933746f30bcae",
      "created_at": "2023-09-15T20:51:42Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 10387664004,
      "node_id": "HRFPE_lADOABII585vHSmAzwAAAAJrJyyE",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10387664004",
      "actor": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": "cc3de0e3833fb83398229a0557e10164fd00ecd5",
      "commit_url": "https://api.github.com/repos/sipa/bitcoin/commits/cc3de0e3833fb83398229a0557e10164fd00ecd5",
      "created_at": "2023-09-15T21:37:39Z"
    },
    {
      "event": "labeled",
      "id": 10387666176,
      "node_id": "LE_lADOABII585vHSmAzwAAAAJrJzUA",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10387666176",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-09-15T21:38:03Z",
      "label": {
        "name": "CI failed",
        "color": "cccccc"
      }
    },
    {
      "event": "head_ref_force_pushed",
      "id": 10407979186,
      "node_id": "HRFPE_lADOABII585vHSmAzwAAAAJsXSiy",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10407979186",
      "actor": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": "9f92c4406874730c3b788efc1a5a242f6f18564e",
      "commit_url": "https://api.github.com/repos/sipa/bitcoin/commits/9f92c4406874730c3b788efc1a5a242f6f18564e",
      "created_at": "2023-09-19T09:21:38Z"
    },
    {
      "event": "commented",
      "id": 1725138119,
      "node_id": "IC_kwDOABII585m04TH",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1725138119",
      "actor": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-09-19T09:21:51Z",
      "updated_at": "2023-09-19T09:21:51Z",
      "author_association": "MEMBER",
      "body": "Rebased to retrigger CI.",
      "user": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28331#issuecomment-1725138119",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/28331"
    },
    {
      "event": "reviewed",
      "id": 1632814911,
      "node_id": "PRR_kwDOABII585hUsc_",
      "url": null,
      "actor": null,
      "commit_id": "9f92c4406874730c3b788efc1a5a242f6f18564e",
      "commit_url": null,
      "created_at": null,
      "author_association": "CONTRIBUTOR",
      "body": "Statistical data reporting nit: apparently the garbage data is accounted for the sender side as empty type (`\"\"`) in `\"bytessent_per_msg\"`, while for the receiver side (`\"bytesrecv_per_msg\"`) it's not, e.g.:\r\n```\r\n./src/bitcoin-cli getpeerinfo\r\n[\r\n  {\r\n    \"bytessent_per_msg\": {                                          \r\n      \"\": 3623,       \r\n      \"feefilter\": 29,\r\n      \"getaddr\": 33,\r\n      ...\r\n    },\r\n    \"bytesrecv_per_msg\": {\r\n      \"addrv2\": 16621,\r\n      \"block\": 60014267,\r\n      ...\r\n    },\r\n  }\r\n]\r\n```\r\n(seeing this for both in- and outbound connections)\r\n\r\nLeft a few other nits below. I've been running this PR for several days now with several in- and outbound peers and everything seems to work just fine AFAICT. Currently also running an IBD with a single BIP324 peer (the only one that @Sjors' DNS seed `x809.seed.bitcoin.sprovoost.nl` returned, which was recently added to bitcoin-seeder, see https://github.com/sipa/bitcoin-seeder/pull/102).\r\n\r\n@jonatack:\r\n>> Would be nice to have the transport type and session id also show in the GUI's peer info page\r\n>\r\n> Am updating -netinfo for bip324 / v2 p2p as well.\r\n\r\nLooking very much forward to that :rocket:",
      "user": {
        "login": "theStack",
        "id": 91535,
        "node_id": "MDQ6VXNlcjkxNTM1",
        "avatar_url": "https://avatars.githubusercontent.com/u/91535?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theStack",
        "html_url": "https://github.com/theStack",
        "followers_url": "https://api.github.com/users/theStack/followers",
        "following_url": "https://api.github.com/users/theStack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theStack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theStack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theStack/subscriptions",
        "organizations_url": "https://api.github.com/users/theStack/orgs",
        "repos_url": "https://api.github.com/users/theStack/repos",
        "events_url": "https://api.github.com/users/theStack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theStack/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28331#pullrequestreview-1632814911",
      "submitted_at": "2023-09-19T10:19:55Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28331"
    },
    {
      "event": "unlabeled",
      "id": 10409246753,
      "node_id": "UNLE_lADOABII585vHSmAzwAAAAJscIAh",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10409246753",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-09-19T11:26:41Z",
      "label": {
        "name": "CI failed",
        "color": "cccccc"
      }
    },
    {
      "event": "head_ref_force_pushed",
      "id": 10425656777,
      "node_id": "HRFPE_lADOABII585vHSmAzwAAAAJtauXJ",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10425656777",
      "actor": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": "d8fc8d4cd91fca1af5a4f2bbe999c1df77608102",
      "commit_url": "https://api.github.com/repos/sipa/bitcoin/commits/d8fc8d4cd91fca1af5a4f2bbe999c1df77608102",
      "created_at": "2023-09-20T16:49:42Z"
    },
    {
      "event": "labeled",
      "id": 10433571705,
      "node_id": "LE_lADOABII585vHSmAzwAAAAJt46t5",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10433571705",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-09-21T10:43:33Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "head_ref_force_pushed",
      "id": 10445921283,
      "node_id": "HRFPE_lADOABII585vHSmAzwAAAAJuoBwD",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10445921283",
      "actor": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": "b019c15aac6b0108c47d11abe2a0bf006dd90aff",
      "commit_url": "https://api.github.com/repos/sipa/bitcoin/commits/b019c15aac6b0108c47d11abe2a0bf006dd90aff",
      "created_at": "2023-09-22T10:38:40Z"
    },
    {
      "event": "commented",
      "id": 1731202211,
      "node_id": "IC_kwDOABII585nMAyj",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1731202211",
      "actor": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-09-22T10:41:55Z",
      "updated_at": "2023-09-22T10:41:55Z",
      "author_association": "MEMBER",
      "body": "Rebased.\r\n\r\n@theStack I guess the fact that the handshake bytes are reported in the send statistics but not in the receive statistics is inconsistent. There is a simple solution, I think, namely adding a \"message\" in the `ReceivedMessageComplete` sense to be retrieved to transition from `VERSION` to `APP` state (but one with no payload, and `reject = true`), to communicate the handshake bytes to the net layer. I prefer doing this in a follow-up, though, as there may be a wider question about how to report the various types of bytes (maybe we want to classify garbage/key/version separately, and maybe we want to support reporting decoy data too).",
      "user": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28331#issuecomment-1731202211",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/28331"
    },
    {
      "event": "mentioned",
      "id": 10445948847,
      "node_id": "MEE_lADOABII585vHSmAzwAAAAJuoIev",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10445948847",
      "actor": {
        "login": "theStack",
        "id": 91535,
        "node_id": "MDQ6VXNlcjkxNTM1",
        "avatar_url": "https://avatars.githubusercontent.com/u/91535?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theStack",
        "html_url": "https://github.com/theStack",
        "followers_url": "https://api.github.com/users/theStack/followers",
        "following_url": "https://api.github.com/users/theStack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theStack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theStack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theStack/subscriptions",
        "organizations_url": "https://api.github.com/users/theStack/orgs",
        "repos_url": "https://api.github.com/users/theStack/repos",
        "events_url": "https://api.github.com/users/theStack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theStack/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-09-22T10:41:55Z"
    },
    {
      "event": "subscribed",
      "id": 10445948864,
      "node_id": "SE_lADOABII585vHSmAzwAAAAJuoIfA",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10445948864",
      "actor": {
        "login": "theStack",
        "id": 91535,
        "node_id": "MDQ6VXNlcjkxNTM1",
        "avatar_url": "https://avatars.githubusercontent.com/u/91535?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theStack",
        "html_url": "https://github.com/theStack",
        "followers_url": "https://api.github.com/users/theStack/followers",
        "following_url": "https://api.github.com/users/theStack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theStack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theStack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theStack/subscriptions",
        "organizations_url": "https://api.github.com/users/theStack/orgs",
        "repos_url": "https://api.github.com/users/theStack/repos",
        "events_url": "https://api.github.com/users/theStack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theStack/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-09-22T10:41:55Z"
    },
    {
      "event": "unlabeled",
      "id": 10446692403,
      "node_id": "UNLE_lADOABII585vHSmAzwAAAAJuq-Az",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10446692403",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-09-22T12:08:42Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "labeled",
      "id": 10447035675,
      "node_id": "LE_lADOABII585vHSmAzwAAAAJusR0b",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10447035675",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-09-22T12:46:33Z",
      "label": {
        "name": "CI failed",
        "color": "cccccc"
      }
    },
    {
      "event": "head_ref_force_pushed",
      "id": 10447429751,
      "node_id": "HRFPE_lADOABII585vHSmAzwAAAAJutyB3",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10447429751",
      "actor": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": "964a8b88ef69643181e11475f03f94cc2780772e",
      "commit_url": "https://api.github.com/repos/sipa/bitcoin/commits/964a8b88ef69643181e11475f03f94cc2780772e",
      "created_at": "2023-09-22T13:24:14Z"
    },
    {
      "event": "unlabeled",
      "id": 10448435874,
      "node_id": "UNLE_lADOABII585vHSmAzwAAAAJuxnqi",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10448435874",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-09-22T14:59:16Z",
      "label": {
        "name": "CI failed",
        "color": "cccccc"
      }
    },
    {
      "event": "labeled",
      "id": 10454111535,
      "node_id": "LE_lADOABII585vHSmAzwAAAAJvHRUv",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10454111535",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-09-23T22:11:53Z",
      "label": {
        "name": "CI failed",
        "color": "cccccc"
      }
    },
    {
      "event": "reviewed",
      "id": 1640956878,
      "node_id": "PRR_kwDOABII585hzwPO",
      "url": null,
      "actor": null,
      "commit_id": "964a8b88ef69643181e11475f03f94cc2780772e",
      "commit_url": null,
      "created_at": null,
      "author_association": "CONTRIBUTOR",
      "body": "Light ACK 964a8b88ef69643181e11475f03f94cc2780772e\r\n(still planning to look deeper at 58ba59f39c217f6835e7839c391dd680ee9d62f2 and its implications w.r.t. the discussion https://github.com/bitcoin/bitcoin/pull/28331#discussion_r1327790459)\r\n\r\nTested more intensly over for the last few days with some more in- and outbound connections and everything was working fine. Unexpected disconnects and other seemingly weird behaviour patterns turned out to be wrong alarms not related to any of the new p2p v2 code, presumably the connection was just bad for outbound connection tests on my laptop (unstable/slow wifi at conferences...). Will keep testing over the following days.\r\n\r\n> @theStack I guess the fact that the handshake bytes are reported in the send statistics but not in the receive statistics is inconsistent. There is a simple solution, I think, namely adding a \"message\" in the `ReceivedMessageComplete` sense to be retrieved to transition from `VERSION` to `APP` state (but one with no payload, and `reject = true`), to communicate the handshake bytes to the net layer. I prefer doing this in a follow-up, though, as there may be a wider question about how to report the various types of bytes (maybe we want to classify garbage/key/version separately, and maybe we want to support reporting decoy data too).\r\n\r\nSounds good to me. Another easy alternative to get rid of the inconsistency would be to simply report the handshake bytes in neither side for now until we figure out how we want to report the different types of bytes. E.g.:\r\n```diff\r\nindex 73dbb090bc..0bd7d68e96 100644\r\n--- a/src/net.cpp\r\n+++ b/src/net.cpp\r\n@@ -1699,7 +1699,9 @@ std::pair<size_t, bool> CConnman::SocketSendData(CNode& node) const\r\n             // Notify transport that bytes have been processed.\r\n             node.m_transport->MarkBytesSent(nBytes);\r\n             // Update statistics per message type.\r\n-            node.AccountForSentBytes(msg_type, nBytes);\r\n+            if (!msg_type.empty()) { // don't report v2 handshake bytes for now\r\n+                node.AccountForSentBytes(msg_type, nBytes);\r\n+            }\r\n             nSentSize += nBytes;\r\n             if ((size_t)nBytes != data.size()) {\r\n                 // could not send full message; stop sending more\r\n```\r\n(as far as I'm aware, this wouldn't change the statistics for v1 peers as we haven't used the empty string as reporting type anywhere before)",
      "user": {
        "login": "theStack",
        "id": 91535,
        "node_id": "MDQ6VXNlcjkxNTM1",
        "avatar_url": "https://avatars.githubusercontent.com/u/91535?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theStack",
        "html_url": "https://github.com/theStack",
        "followers_url": "https://api.github.com/users/theStack/followers",
        "following_url": "https://api.github.com/users/theStack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theStack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theStack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theStack/subscriptions",
        "organizations_url": "https://api.github.com/users/theStack/orgs",
        "repos_url": "https://api.github.com/users/theStack/repos",
        "events_url": "https://api.github.com/users/theStack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theStack/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28331#pullrequestreview-1640956878",
      "submitted_at": "2023-09-23T23:39:04Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28331"
    },
    {
      "event": "unlabeled",
      "id": 10460859605,
      "node_id": "UNLE_lADOABII585vHSmAzwAAAAJvhAzV",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10460859605",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-09-25T10:41:39Z",
      "label": {
        "name": "CI failed",
        "color": "cccccc"
      }
    },
    {
      "event": "reviewed",
      "id": 1641976091,
      "node_id": "PRR_kwDOABII585h3pEb",
      "url": null,
      "actor": null,
      "commit_id": "964a8b88ef69643181e11475f03f94cc2780772e",
      "commit_url": null,
      "created_at": null,
      "author_association": "CONTRIBUTOR",
      "body": "Code review ACK 964a8b88ef69643181e11475f03f94cc2780772e\r\n\r\nLGTM on the assumption all the prior implementation is also good",
      "user": {
        "login": "ajtowns",
        "id": 127186,
        "node_id": "MDQ6VXNlcjEyNzE4Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/127186?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ajtowns",
        "html_url": "https://github.com/ajtowns",
        "followers_url": "https://api.github.com/users/ajtowns/followers",
        "following_url": "https://api.github.com/users/ajtowns/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ajtowns/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ajtowns/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ajtowns/subscriptions",
        "organizations_url": "https://api.github.com/users/ajtowns/orgs",
        "repos_url": "https://api.github.com/users/ajtowns/repos",
        "events_url": "https://api.github.com/users/ajtowns/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ajtowns/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28331#pullrequestreview-1641976091",
      "submitted_at": "2023-09-25T16:22:08Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28331"
    },
    {
      "event": "reviewed",
      "id": 1642480842,
      "node_id": "PRR_kwDOABII585h5kTK",
      "url": null,
      "actor": null,
      "commit_id": "964a8b88ef69643181e11475f03f94cc2780772e",
      "commit_url": null,
      "created_at": null,
      "author_association": "CONTRIBUTOR",
      "body": "ACK 964a8b88ef69643181e11475f03f94cc2780772e (comments are mostly nits)\r\n\r\nReviewed the code, and also did some manual testing for the downgrade mechanism.\r\nI have tested this on mainnet for more than a week now and not encountered any problems (one v2 peer has been connected for 11 days).",
      "user": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28331#pullrequestreview-1642480842",
      "submitted_at": "2023-09-25T19:50:04Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28331"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 10486946166,
      "node_id": "HRFPE_lADOABII585vHSmAzwAAAAJxEhl2",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10486946166",
      "actor": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": "1cf0c5552cc6308c77be877f249b21fc90433ed2",
      "commit_url": "https://api.github.com/repos/sipa/bitcoin/commits/1cf0c5552cc6308c77be877f249b21fc90433ed2",
      "created_at": "2023-09-27T12:38:08Z"
    },
    {
      "event": "commented",
      "id": 1737331315,
      "node_id": "IC_kwDOABII585njZJz",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1737331315",
      "actor": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-09-27T12:48:11Z",
      "updated_at": "2023-09-27T20:47:36Z",
      "author_association": "MEMBER",
      "body": "@theStack I've included your patch to not include v2 handshake bytes in the per-message-type send byte statistics, as a separate commit. I've also mentioned the idea as a potential follow-up in #27634.\r\n\r\n@real-or-random I've added a commit to mention BIP324 in `doc/bips.md`.",
      "user": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28331#issuecomment-1737331315",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/28331"
    },
    {
      "event": "mentioned",
      "id": 10487076456,
      "node_id": "MEE_lADOABII585vHSmAzwAAAAJxFBZo",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10487076456",
      "actor": {
        "login": "theStack",
        "id": 91535,
        "node_id": "MDQ6VXNlcjkxNTM1",
        "avatar_url": "https://avatars.githubusercontent.com/u/91535?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theStack",
        "html_url": "https://github.com/theStack",
        "followers_url": "https://api.github.com/users/theStack/followers",
        "following_url": "https://api.github.com/users/theStack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theStack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theStack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theStack/subscriptions",
        "organizations_url": "https://api.github.com/users/theStack/orgs",
        "repos_url": "https://api.github.com/users/theStack/repos",
        "events_url": "https://api.github.com/users/theStack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theStack/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-09-27T12:48:11Z"
    },
    {
      "event": "subscribed",
      "id": 10487076483,
      "node_id": "SE_lADOABII585vHSmAzwAAAAJxFBaD",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10487076483",
      "actor": {
        "login": "theStack",
        "id": 91535,
        "node_id": "MDQ6VXNlcjkxNTM1",
        "avatar_url": "https://avatars.githubusercontent.com/u/91535?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theStack",
        "html_url": "https://github.com/theStack",
        "followers_url": "https://api.github.com/users/theStack/followers",
        "following_url": "https://api.github.com/users/theStack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theStack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theStack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theStack/subscriptions",
        "organizations_url": "https://api.github.com/users/theStack/orgs",
        "repos_url": "https://api.github.com/users/theStack/repos",
        "events_url": "https://api.github.com/users/theStack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theStack/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-09-27T12:48:11Z"
    },
    {
      "event": "mentioned",
      "id": 10487076501,
      "node_id": "MEE_lADOABII585vHSmAzwAAAAJxFBaV",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10487076501",
      "actor": {
        "login": "real-or-random",
        "id": 1071625,
        "node_id": "MDQ6VXNlcjEwNzE2MjU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1071625?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/real-or-random",
        "html_url": "https://github.com/real-or-random",
        "followers_url": "https://api.github.com/users/real-or-random/followers",
        "following_url": "https://api.github.com/users/real-or-random/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/real-or-random/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/real-or-random/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/real-or-random/subscriptions",
        "organizations_url": "https://api.github.com/users/real-or-random/orgs",
        "repos_url": "https://api.github.com/users/real-or-random/repos",
        "events_url": "https://api.github.com/users/real-or-random/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/real-or-random/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-09-27T12:48:11Z"
    },
    {
      "event": "subscribed",
      "id": 10487076522,
      "node_id": "SE_lADOABII585vHSmAzwAAAAJxFBaq",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10487076522",
      "actor": {
        "login": "real-or-random",
        "id": 1071625,
        "node_id": "MDQ6VXNlcjEwNzE2MjU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1071625?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/real-or-random",
        "html_url": "https://github.com/real-or-random",
        "followers_url": "https://api.github.com/users/real-or-random/followers",
        "following_url": "https://api.github.com/users/real-or-random/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/real-or-random/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/real-or-random/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/real-or-random/subscriptions",
        "organizations_url": "https://api.github.com/users/real-or-random/orgs",
        "repos_url": "https://api.github.com/users/real-or-random/repos",
        "events_url": "https://api.github.com/users/real-or-random/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/real-or-random/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-09-27T12:48:11Z"
    },
    {
      "event": "labeled",
      "id": 10488174533,
      "node_id": "LE_lADOABII585vHSmAzwAAAAJxJNfF",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10488174533",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-09-27T14:13:09Z",
      "label": {
        "name": "CI failed",
        "color": "cccccc"
      }
    },
    {
      "event": "subscribed",
      "id": 10488892653,
      "node_id": "SE_lADOABII585vHSmAzwAAAAJxL8zt",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10488892653",
      "actor": {
        "login": "0xf0xx0",
        "id": 33764485,
        "node_id": "MDQ6VXNlcjMzNzY0NDg1",
        "avatar_url": "https://avatars.githubusercontent.com/u/33764485?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/0xf0xx0",
        "html_url": "https://github.com/0xf0xx0",
        "followers_url": "https://api.github.com/users/0xf0xx0/followers",
        "following_url": "https://api.github.com/users/0xf0xx0/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/0xf0xx0/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/0xf0xx0/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/0xf0xx0/subscriptions",
        "organizations_url": "https://api.github.com/users/0xf0xx0/orgs",
        "repos_url": "https://api.github.com/users/0xf0xx0/repos",
        "events_url": "https://api.github.com/users/0xf0xx0/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/0xf0xx0/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-09-27T15:03:56Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 10490971397,
      "node_id": "HRFPE_lADOABII585vHSmAzwAAAAJxT4UF",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10490971397",
      "actor": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": "830b23ab80ac089c15e232d1b1e6bbd781ddc749",
      "commit_url": "https://api.github.com/repos/sipa/bitcoin/commits/830b23ab80ac089c15e232d1b1e6bbd781ddc749",
      "created_at": "2023-09-27T18:37:02Z"
    },
    {
      "event": "reviewed",
      "id": 1647589660,
      "node_id": "PRR_kwDOABII585iNDkc",
      "url": null,
      "actor": null,
      "commit_id": "830b23ab80ac089c15e232d1b1e6bbd781ddc749",
      "commit_url": null,
      "created_at": null,
      "author_association": "CONTRIBUTOR",
      "body": "ACK 830b23ab80ac089c15e232d1b1e6bbd781ddc749 :three::two::four:\r\n\r\nI think we also want to mention BIP324 in the release notes, even though it's default-off? (doesn't necessarily have to be in this PR though).",
      "user": {
        "login": "theStack",
        "id": 91535,
        "node_id": "MDQ6VXNlcjkxNTM1",
        "avatar_url": "https://avatars.githubusercontent.com/u/91535?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theStack",
        "html_url": "https://github.com/theStack",
        "followers_url": "https://api.github.com/users/theStack/followers",
        "following_url": "https://api.github.com/users/theStack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theStack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theStack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theStack/subscriptions",
        "organizations_url": "https://api.github.com/users/theStack/orgs",
        "repos_url": "https://api.github.com/users/theStack/repos",
        "events_url": "https://api.github.com/users/theStack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theStack/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28331#pullrequestreview-1647589660",
      "submitted_at": "2023-09-27T21:25:40Z",
      "state": "APPROVED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28331"
    },
    {
      "event": "review_requested",
      "id": 10492382408,
      "node_id": "RRE_lADOABII585vHSmAzwAAAAJxZQzI",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10492382408",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-09-27T21:25:45Z",
      "requested_reviewer": {
        "login": "ajtowns",
        "id": 127186,
        "node_id": "MDQ6VXNlcjEyNzE4Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/127186?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ajtowns",
        "html_url": "https://github.com/ajtowns",
        "followers_url": "https://api.github.com/users/ajtowns/followers",
        "following_url": "https://api.github.com/users/ajtowns/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ajtowns/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ajtowns/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ajtowns/subscriptions",
        "organizations_url": "https://api.github.com/users/ajtowns/orgs",
        "repos_url": "https://api.github.com/users/ajtowns/repos",
        "events_url": "https://api.github.com/users/ajtowns/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ajtowns/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "review_requester": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      }
    },
    {
      "event": "review_requested",
      "id": 10492382497,
      "node_id": "RRE_lADOABII585vHSmAzwAAAAJxZQ0h",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10492382497",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-09-27T21:25:46Z",
      "requested_reviewer": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "review_requester": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      }
    },
    {
      "event": "unlabeled",
      "id": 10493098978,
      "node_id": "UNLE_lADOABII585vHSmAzwAAAAJxb_vi",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10493098978",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-09-27T23:34:35Z",
      "label": {
        "name": "CI failed",
        "color": "cccccc"
      }
    },
    {
      "event": "reviewed",
      "id": 1648656534,
      "node_id": "PRR_kwDOABII585iRICW",
      "url": null,
      "actor": null,
      "commit_id": "830b23ab80ac089c15e232d1b1e6bbd781ddc749",
      "commit_url": null,
      "created_at": null,
      "author_association": "CONTRIBUTOR",
      "body": "ACK 830b23ab80ac089c15e232d1b1e6bbd781ddc749",
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28331#pullrequestreview-1648656534",
      "submitted_at": "2023-09-28T13:27:53Z",
      "state": "APPROVED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28331"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 10502177668,
      "node_id": "HRFPE_lADOABII585vHSmAzwAAAAJx-oOE",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10502177668",
      "actor": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": "0282b360c6f1822d0a9107234c9d0babec6bff07",
      "commit_url": "https://api.github.com/repos/sipa/bitcoin/commits/0282b360c6f1822d0a9107234c9d0babec6bff07",
      "created_at": "2023-09-28T17:10:02Z"
    },
    {
      "event": "labeled",
      "id": 10502868483,
      "node_id": "LE_lADOABII585vHSmAzwAAAAJyBQ4D",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10502868483",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-09-28T18:22:17Z",
      "label": {
        "name": "CI failed",
        "color": "cccccc"
      }
    },
    {
      "event": "head_ref_force_pushed",
      "id": 10503175197,
      "node_id": "HRFPE_lADOABII585vHSmAzwAAAAJyCbwd",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10503175197",
      "actor": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": "0ab1ce8c56e889d548e45768f65ab718a0764ddf",
      "commit_url": "https://api.github.com/repos/sipa/bitcoin/commits/0ab1ce8c56e889d548e45768f65ab718a0764ddf",
      "created_at": "2023-09-28T18:56:03Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 10504060802,
      "node_id": "HRFPE_lADOABII585vHSmAzwAAAAJyFz-C",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10504060802",
      "actor": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": "c3226da9c3dc31207298fccd08d5bccedeb77051",
      "commit_url": "https://api.github.com/repos/sipa/bitcoin/commits/c3226da9c3dc31207298fccd08d5bccedeb77051",
      "created_at": "2023-09-28T20:37:05Z"
    },
    {
      "event": "commented",
      "id": 1739971226,
      "node_id": "IC_kwDOABII585ntdqa",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1739971226",
      "actor": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-09-28T20:38:25Z",
      "updated_at": "2023-09-28T22:02:19Z",
      "author_association": "MEMBER",
      "body": "Rebased on top of #28525 as I don't think we should merge this PR without the BIP change, and this makes testing of the combined result easier.\r\n\r\nNote that this is a breaking change: earlier versions of this PR won't be able to establish v2 connections with the new version.",
      "user": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28331#issuecomment-1739971226",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/28331"
    },
    {
      "event": "unlabeled",
      "id": 10504680584,
      "node_id": "UNLE_lADOABII585vHSmAzwAAAAJyILSI",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10504680584",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-09-28T22:03:22Z",
      "label": {
        "name": "CI failed",
        "color": "cccccc"
      }
    },
    {
      "event": "head_ref_force_pushed",
      "id": 10504738941,
      "node_id": "HRFPE_lADOABII585vHSmAzwAAAAJyIZh9",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10504738941",
      "actor": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": "e69f990618e489b9576cd50c312afa0f99db2c10",
      "commit_url": "https://api.github.com/repos/sipa/bitcoin/commits/e69f990618e489b9576cd50c312afa0f99db2c10",
      "created_at": "2023-09-28T22:12:50Z"
    },
    {
      "event": "commented",
      "id": 1740452851,
      "node_id": "IC_kwDOABII585nvTPz",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1740452851",
      "actor": {
        "login": "Sjors",
        "id": 10217,
        "node_id": "MDQ6VXNlcjEwMjE3",
        "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Sjors",
        "html_url": "https://github.com/Sjors",
        "followers_url": "https://api.github.com/users/Sjors/followers",
        "following_url": "https://api.github.com/users/Sjors/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Sjors/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Sjors/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
        "organizations_url": "https://api.github.com/users/Sjors/orgs",
        "repos_url": "https://api.github.com/users/Sjors/repos",
        "events_url": "https://api.github.com/users/Sjors/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Sjors/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-09-29T07:41:45Z",
      "updated_at": "2023-09-29T07:41:45Z",
      "author_association": "MEMBER",
      "body": "Running e69f990...",
      "user": {
        "login": "Sjors",
        "id": 10217,
        "node_id": "MDQ6VXNlcjEwMjE3",
        "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Sjors",
        "html_url": "https://github.com/Sjors",
        "followers_url": "https://api.github.com/users/Sjors/followers",
        "following_url": "https://api.github.com/users/Sjors/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Sjors/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Sjors/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
        "organizations_url": "https://api.github.com/users/Sjors/orgs",
        "repos_url": "https://api.github.com/users/Sjors/repos",
        "events_url": "https://api.github.com/users/Sjors/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Sjors/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28331#issuecomment-1740452851",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/28331"
    },
    {
      "event": "reviewed",
      "id": 1650591208,
      "node_id": "PRR_kwDOABII585iYgXo",
      "url": null,
      "actor": null,
      "commit_id": "ee80555c30eb18bec8fc30ba4679f55464878074",
      "commit_url": null,
      "created_at": null,
      "author_association": "CONTRIBUTOR",
      "body": "ACK e69f990618e489b9576cd50c312afa0f99db2c10",
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28331#pullrequestreview-1650591208",
      "submitted_at": "2023-09-29T11:25:59Z",
      "state": "APPROVED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28331"
    },
    {
      "event": "review_requested",
      "id": 10510300998,
      "node_id": "RRE_lADOABII585vHSmAzwAAAAJydndG",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10510300998",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-09-29T11:26:05Z",
      "requested_reviewer": {
        "login": "theStack",
        "id": 91535,
        "node_id": "MDQ6VXNlcjkxNTM1",
        "avatar_url": "https://avatars.githubusercontent.com/u/91535?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theStack",
        "html_url": "https://github.com/theStack",
        "followers_url": "https://api.github.com/users/theStack/followers",
        "following_url": "https://api.github.com/users/theStack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theStack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theStack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theStack/subscriptions",
        "organizations_url": "https://api.github.com/users/theStack/orgs",
        "repos_url": "https://api.github.com/users/theStack/repos",
        "events_url": "https://api.github.com/users/theStack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theStack/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "review_requester": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      }
    },
    {
      "event": "head_ref_force_pushed",
      "id": 10511887445,
      "node_id": "HRFPE_lADOABII585vHSmAzwAAAAJyjqxV",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10511887445",
      "actor": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": "ee80555c30eb18bec8fc30ba4679f55464878074",
      "commit_url": "https://api.github.com/repos/sipa/bitcoin/commits/ee80555c30eb18bec8fc30ba4679f55464878074",
      "created_at": "2023-09-29T14:08:01Z"
    },
    {
      "event": "reviewed",
      "id": 1650718473,
      "node_id": "PRR_kwDOABII585iY_cJ",
      "url": null,
      "actor": null,
      "commit_id": "ee80555c30eb18bec8fc30ba4679f55464878074",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "body": "Reviewed down to 7ad356c3e1d7319af7f9c96a1bfa30b997c6adde.",
      "user": {
        "login": "Sjors",
        "id": 10217,
        "node_id": "MDQ6VXNlcjEwMjE3",
        "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Sjors",
        "html_url": "https://github.com/Sjors",
        "followers_url": "https://api.github.com/users/Sjors/followers",
        "following_url": "https://api.github.com/users/Sjors/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Sjors/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Sjors/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
        "organizations_url": "https://api.github.com/users/Sjors/orgs",
        "repos_url": "https://api.github.com/users/Sjors/repos",
        "events_url": "https://api.github.com/users/Sjors/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Sjors/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28331#pullrequestreview-1650718473",
      "submitted_at": "2023-09-29T16:31:06Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28331"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 10514230944,
      "node_id": "HRFPE_lADOABII585vHSmAzwAAAAJysm6g",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10514230944",
      "actor": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": "f573c52c4f926b4996c5da417e481f8be7ef1f8b",
      "commit_url": "https://api.github.com/repos/sipa/bitcoin/commits/f573c52c4f926b4996c5da417e481f8be7ef1f8b",
      "created_at": "2023-09-29T18:19:24Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 10514496438,
      "node_id": "HRFPE_lADOABII585vHSmAzwAAAAJytnu2",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10514496438",
      "actor": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": "bc591d42d00b91482989bbbb07f2c03c8e2bbb52",
      "commit_url": "https://api.github.com/repos/sipa/bitcoin/commits/bc591d42d00b91482989bbbb07f2c03c8e2bbb52",
      "created_at": "2023-09-29T18:56:59Z"
    },
    {
      "event": "labeled",
      "id": 10514497191,
      "node_id": "LE_lADOABII585vHSmAzwAAAAJytn6n",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10514497191",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-09-29T18:57:06Z",
      "label": {
        "name": "CI failed",
        "color": "cccccc"
      }
    },
    {
      "event": "unlabeled",
      "id": 10515406691,
      "node_id": "UNLE_lADOABII585vHSmAzwAAAAJyxF9j",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10515406691",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-09-29T21:13:06Z",
      "label": {
        "name": "CI failed",
        "color": "cccccc"
      }
    },
    {
      "event": "head_ref_force_pushed",
      "id": 10517332905,
      "node_id": "HRFPE_lADOABII585vHSmAzwAAAAJy4cOp",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10517332905",
      "actor": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": "e4decda0804c8000dee07591f00456da5a42c8c8",
      "commit_url": "https://api.github.com/repos/sipa/bitcoin/commits/e4decda0804c8000dee07591f00456da5a42c8c8",
      "created_at": "2023-09-30T13:11:48Z"
    },
    {
      "event": "commented",
      "id": 1741764258,
      "node_id": "IC_kwDOABII585n0Tai",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1741764258",
      "actor": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-09-30T13:14:06Z",
      "updated_at": "2023-09-30T13:14:06Z",
      "author_association": "MEMBER",
      "body": "I've added a `use_v2transport` argument to `OpenNetworkConnection` and `ConnectNode`, rather than looking at the `addrConnect.nServices` (as not all call sites use `addrConnect`):\r\n\r\n```diff\r\ndiff --git a/src/net.cpp b/src/net.cpp\r\nindex 8bd4aebbae..7e70a0586a 100644\r\n--- a/src/net.cpp\r\n+++ b/src/net.cpp\r\n@@ -439,7 +439,7 @@ static CAddress GetBindAddress(const Sock& sock)\r\n     return addr_bind;\r\n }\r\n \r\n-CNode* CConnman::ConnectNode(CAddress addrConnect, const char *pszDest, bool fCountFailure, ConnectionType conn_type)\r\n+CNode* CConnman::ConnectNode(CAddress addrConnect, const char *pszDest, bool fCountFailure, ConnectionType conn_type, bool use_v2transport)\r\n {\r\n     AssertLockNotHeld(m_unused_i2p_sessions_mutex);\r\n     assert(conn_type != ConnectionType::INBOUND);\r\n@@ -457,9 +457,6 @@ CNode* CConnman::ConnectNode(CAddress addrConnect, const char *pszDest, bool fCo\r\n         }\r\n     }\r\n \r\n-    // Use v2 transport when both us and them signal NODE_P2P_V2.\r\n-    const bool use_v2transport(addrConnect.nServices & GetLocalServices() & NODE_P2P_V2);\r\n-\r\n     LogPrintLevel(BCLog::NET, BCLog::Level::Debug, \"trying %s connection %s lastseen=%.1fhrs\\n\",\r\n         use_v2transport ? \"v2\" : \"v1\",\r\n         pszDest ? pszDest : addrConnect.ToStringAddrPort(),\r\n@@ -572,7 +569,6 @@ CNode* CConnman::ConnectNode(CAddress addrConnect, const char *pszDest, bool fCo\r\n     if (!addr_bind.IsValid()) {\r\n         addr_bind = GetBindAddress(*sock);\r\n     }\r\n-\r\n     CNode* pnode = new CNode(id,\r\n                              std::move(sock),\r\n                              addrConnect,\r\n@@ -1920,7 +1916,7 @@ bool CConnman::AddConnection(const std::string& address, ConnectionType conn_typ\r\n     CSemaphoreGrant grant(*semOutbound, true);\r\n     if (!grant) return false;\r\n \r\n-    OpenNetworkConnection(CAddress(), false, std::move(grant), address.c_str(), conn_type);\r\n+    OpenNetworkConnection(CAddress(), false, std::move(grant), address.c_str(), conn_type, /*use_v2transport=*/false);\r\n     return true;\r\n }\r\n \r\n@@ -1958,8 +1954,7 @@ void CConnman::DisconnectNodes()\r\n                 // and we don't want to hold up the socket handler thread for that long.\r\n                 if (pnode->m_transport->ShouldReconnectV1()) {\r\n                     reconnections_to_add.push_back({\r\n-                        // Removing NODE_P2P_V2 here ensures we reconnect using V1.\r\n-                        .addr_connect = CAddress{pnode->addr, ServiceFlags{pnode->addr.nServices & ~NODE_P2P_V2}},\r\n+                        .addr_connect = pnode->addr,\r\n                         .count_failure = pnode->m_count_failure_after_reconnect,\r\n                         .grant = std::move(pnode->grantOutbound),\r\n                         .destination = pnode->m_dest,\r\n@@ -2378,7 +2373,7 @@ void CConnman::ProcessAddrFetch()\r\n     CAddress addr;\r\n     CSemaphoreGrant grant(*semOutbound, /*fTry=*/true);\r\n     if (grant) {\r\n-        OpenNetworkConnection(addr, false, std::move(grant), strDest.c_str(), ConnectionType::ADDR_FETCH);\r\n+        OpenNetworkConnection(addr, false, std::move(grant), strDest.c_str(), ConnectionType::ADDR_FETCH, /*use_v2transport=*/false);\r\n     }\r\n }\r\n \r\n@@ -2481,7 +2476,7 @@ void CConnman::ThreadOpenConnections(const std::vector<std::string> connect)\r\n             for (const std::string& strAddr : connect)\r\n             {\r\n                 CAddress addr(CService(), NODE_NONE);\r\n-                OpenNetworkConnection(addr, false, {}, strAddr.c_str(), ConnectionType::MANUAL);\r\n+                OpenNetworkConnection(addr, false, {}, strAddr.c_str(), ConnectionType::MANUAL, /*use_v2transport=*/false);\r\n                 for (int i = 0; i < 10 && i < nLoop; i++)\r\n                 {\r\n                     if (!interruptNet.sleep_for(std::chrono::milliseconds(500)))\r\n@@ -2786,7 +2781,9 @@ void CConnman::ThreadOpenConnections(const std::vector<std::string> connect)\r\n             // Don't record addrman failure attempts when node is offline. This can be identified since all local\r\n             // network connections (if any) belong in the same netgroup, and the size of `outbound_ipv46_peer_netgroups` would only be 1.\r\n             const bool count_failures{((int)outbound_ipv46_peer_netgroups.size() + outbound_privacy_network_peers) >= std::min(nMaxConnections - 1, 2)};\r\n-            OpenNetworkConnection(addrConnect, count_failures, std::move(grant), /*strDest=*/nullptr, conn_type);\r\n+            // Use BIP324 transport when both us and them have NODE_V2_P2P set.\r\n+            const bool use_v2transport(addrConnect.nServices & GetLocalServices() & NODE_P2P_V2);\r\n+            OpenNetworkConnection(addrConnect, count_failures, std::move(grant), /*strDest=*/nullptr, conn_type, use_v2transport);\r\n         }\r\n     }\r\n }\r\n@@ -2876,12 +2873,7 @@ void CConnman::ThreadOpenAddedConnections()\r\n                 }\r\n                 tried = true;\r\n                 CAddress addr(CService(), NODE_NONE);\r\n-\r\n-                if (info.m_params.m_use_v2transport) {\r\n-                    addr.nServices = ServiceFlags(addr.nServices | NODE_P2P_V2);\r\n-                }\r\n-\r\n-                OpenNetworkConnection(addr, false, std::move(grant), info.m_params.m_added_node.c_str(), ConnectionType::MANUAL);\r\n+                OpenNetworkConnection(addr, false, std::move(grant), info.m_params.m_added_node.c_str(), ConnectionType::MANUAL, info.m_params.m_use_v2transport);\r\n                 if (!interruptNet.sleep_for(std::chrono::milliseconds(500)))\r\n                     return;\r\n             }\r\n@@ -2895,7 +2887,7 @@ void CConnman::ThreadOpenAddedConnections()\r\n }\r\n \r\n // if successful, this moves the passed grant to the constructed node\r\n-void CConnman::OpenNetworkConnection(const CAddress& addrConnect, bool fCountFailure, CSemaphoreGrant&& grant_outbound, const char *pszDest, ConnectionType conn_type)\r\n+void CConnman::OpenNetworkConnection(const CAddress& addrConnect, bool fCountFailure, CSemaphoreGrant&& grant_outbound, const char *pszDest, ConnectionType conn_type, bool use_v2transport)\r\n {\r\n     AssertLockNotHeld(m_unused_i2p_sessions_mutex);\r\n     assert(conn_type != ConnectionType::INBOUND);\r\n@@ -2917,7 +2909,7 @@ void CConnman::OpenNetworkConnection(const CAddress& addrConnect, bool fCountFai\r\n     } else if (FindNode(std::string(pszDest)))\r\n         return;\r\n \r\n-    CNode* pnode = ConnectNode(addrConnect, pszDest, fCountFailure, conn_type);\r\n+    CNode* pnode = ConnectNode(addrConnect, pszDest, fCountFailure, conn_type, use_v2transport);\r\n \r\n     if (!pnode)\r\n         return;\r\n@@ -3854,7 +3846,8 @@ void CConnman::PerformReconnections()\r\n                               item.count_failure,\r\n                               std::move(item.grant),\r\n                               item.destination.empty() ? nullptr : item.destination.c_str(),\r\n-                              item.conn_type);\r\n+                              item.conn_type,\r\n+                              /*use_v2transport=*/false);\r\n     }\r\n }\r\n \r\ndiff --git a/src/net.h b/src/net.h\r\nindex c9a0afdd97..25a9814f63 100644\r\n--- a/src/net.h\r\n+++ b/src/net.h\r\n@@ -1139,7 +1139,7 @@ public:\r\n     bool GetNetworkActive() const { return fNetworkActive; };\r\n     bool GetUseAddrmanOutgoing() const { return m_use_addrman_outgoing; };\r\n     void SetNetworkActive(bool active);\r\n-    void OpenNetworkConnection(const CAddress& addrConnect, bool fCountFailure, CSemaphoreGrant&& grant_outbound, const char* strDest, ConnectionType conn_type) EXCLUSIVE_LOCKS_REQUIRED(!m_unused_i2p_sessions_mutex);\r\n+    void OpenNetworkConnection(const CAddress& addrConnect, bool fCountFailure, CSemaphoreGrant&& grant_outbound, const char* strDest, ConnectionType conn_type, bool use_v2transport) EXCLUSIVE_LOCKS_REQUIRED(!m_unused_i2p_sessions_mutex);\r\n     bool CheckIncomingNonce(uint64_t nonce);\r\n \r\n     // alias for thread safety annotations only, not defined\r\n@@ -1355,7 +1355,7 @@ private:\r\n     bool AlreadyConnectedToAddress(const CAddress& addr);\r\n \r\n     bool AttemptToEvictConnection();\r\n-    CNode* ConnectNode(CAddress addrConnect, const char *pszDest, bool fCountFailure, ConnectionType conn_type) EXCLUSIVE_LOCKS_REQUIRED(!m_unused_i2p_sessions_mutex);\r\n+    CNode* ConnectNode(CAddress addrConnect, const char *pszDest, bool fCountFailure, ConnectionType conn_type, bool use_v2transport) EXCLUSIVE_LOCKS_REQUIRED(!m_unused_i2p_sessions_mutex);\r\n     void AddWhitelistPermissionFlags(NetPermissionFlags& flags, const CNetAddr &addr) const;\r\n \r\n     void DeleteNode(CNode* pnode);\r\ndiff --git a/src/rpc/net.cpp b/src/rpc/net.cpp\r\nindex 8f6ec29813..8d796b8e9b 100644\r\n--- a/src/rpc/net.cpp\r\n+++ b/src/rpc/net.cpp\r\n@@ -299,7 +299,7 @@ static RPCHelpMan addnode()\r\n                 {\r\n                     {\"node\", RPCArg::Type::STR, RPCArg::Optional::NO, \"The address of the peer to connect to\"},\r\n                     {\"command\", RPCArg::Type::STR, RPCArg::Optional::NO, \"'add' to add a node to the list, 'remove' to remove a node from the list, 'onetry' to try a connection to the node once\"},\r\n-                    {\"v2transport\", RPCArg::Type::BOOL, RPCArg::Default{false}, \"Attempt to connect using BIP324 v2 transport protocol\"},\r\n+                    {\"v2transport\", RPCArg::Type::BOOL, RPCArg::Default{false}, \"Attempt to connect using BIP324 v2 transport protocol (ignored for 'remove' command)\"},\r\n                 },\r\n                 RPCResult{RPCResult::Type::NONE, \"\", \"\"},\r\n                 RPCExamples{\r\n@@ -327,10 +327,7 @@ static RPCHelpMan addnode()\r\n     if (command == \"onetry\")\r\n     {\r\n         CAddress addr;\r\n-        if (use_v2transport) {\r\n-            addr.nServices = ServiceFlags(addr.nServices | NODE_P2P_V2);\r\n-        }\r\n-        connman.OpenNetworkConnection(addr, /*fCountFailure=*/false, /*grant_outbound=*/{}, node_arg.c_str(), ConnectionType::MANUAL);\r\n+        connman.OpenNetworkConnection(addr, /*fCountFailure=*/false, /*grant_outbound=*/{}, node_arg.c_str(), ConnectionType::MANUAL, use_v2transport);\r\n         return UniValue::VNULL;\r\n     }\r\n ```",
      "user": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28331#issuecomment-1741764258",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/28331"
    },
    {
      "event": "reviewed",
      "id": 1651952488,
      "node_id": "PRR_kwDOABII585idsto",
      "url": null,
      "actor": null,
      "commit_id": "d5c8b42a1612e84e7bb5cea6bbc98247ce52128c",
      "commit_url": null,
      "created_at": null,
      "author_association": "CONTRIBUTOR",
      "user": {
        "login": "theStack",
        "id": 91535,
        "node_id": "MDQ6VXNlcjkxNTM1",
        "avatar_url": "https://avatars.githubusercontent.com/u/91535?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theStack",
        "html_url": "https://github.com/theStack",
        "followers_url": "https://api.github.com/users/theStack/followers",
        "following_url": "https://api.github.com/users/theStack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theStack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theStack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theStack/subscriptions",
        "organizations_url": "https://api.github.com/users/theStack/orgs",
        "repos_url": "https://api.github.com/users/theStack/repos",
        "events_url": "https://api.github.com/users/theStack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theStack/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28331#pullrequestreview-1651952488",
      "submitted_at": "2023-10-01T19:38:48Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28331"
    },
    {
      "event": "reviewed",
      "id": 1652029682,
      "node_id": "PRR_kwDOABII585id_jy",
      "url": null,
      "actor": null,
      "commit_id": "e4decda0804c8000dee07591f00456da5a42c8c8",
      "commit_url": null,
      "created_at": null,
      "author_association": "CONTRIBUTOR",
      "body": "",
      "user": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28331#pullrequestreview-1652029682",
      "submitted_at": "2023-10-02T02:14:16Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28331"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 10521517393,
      "node_id": "HRFPE_lADOABII585vHSmAzwAAAAJzIZ1R",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10521517393",
      "actor": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": "cd5e72d6fb82c580dbf693b14e842d6204327311",
      "commit_url": "https://api.github.com/repos/sipa/bitcoin/commits/cd5e72d6fb82c580dbf693b14e842d6204327311",
      "created_at": "2023-10-02T03:08:36Z"
    },
    {
      "event": "commented",
      "id": 1742345114,
      "node_id": "IC_kwDOABII585n2hOa",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1742345114",
      "actor": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-10-02T03:10:32Z",
      "updated_at": "2023-10-02T03:10:32Z",
      "author_association": "MEMBER",
      "body": "Changes to address the comments by @mzumsande and @theStack above:\r\n\r\n```diff\r\ndiff --git a/src/net.cpp b/src/net.cpp\r\nindex 7e70a0586a..a17c215a2c 100644\r\n--- a/src/net.cpp\r\n+++ b/src/net.cpp\r\n@@ -1603,10 +1603,10 @@ Transport::Info V2Transport::GetInfo() const noexcept\r\n \r\n     Transport::Info info;\r\n \r\n-    // Do not report v2 and session ID until the garbage authentication packet has been received\r\n+    // Do not report v2 and session ID until the version packet has been received\r\n     // and verified (confirming that the other side very likely has the same keys as us).\r\n     if (m_recv_state != RecvState::KEY_MAYBE_V1 && m_recv_state != RecvState::KEY &&\r\n-        m_recv_state != RecvState::GARB_GARBTERM) {\r\n+        m_recv_state != RecvState::GARB_GARBTERM && m_recv_state != RecvState::VERSION) {\r\n         info.transport_type = TransportProtocolType::V2;\r\n         info.session_id = uint256(MakeUCharSpan(m_cipher.GetSessionID()));\r\n     } else {\r\n@@ -2861,11 +2861,12 @@ void CConnman::ThreadOpenAddedConnections()\r\n     AssertLockNotHeld(m_reconnections_mutex);\r\n     while (true)\r\n     {\r\n+        CSemaphoreGrant grant(*semAddnode);\r\n         std::vector<AddedNodeInfo> vInfo = GetAddedNodeInfo();\r\n         bool tried = false;\r\n         for (const AddedNodeInfo& info : vInfo) {\r\n             if (!info.fConnected) {\r\n-                CSemaphoreGrant grant(*semAddnode, /*fTry=*/true);\r\n+                if (!grant) grant = CSemaphoreGrant(*semAddnode, /*fTry=*/true);\r\n                 if (!grant) {\r\n                     // If we've used up our semaphore and need a new one, let's not wait here since while we are waiting\r\n                     // the addednodeinfo state might change.\r\n```",
      "user": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28331#issuecomment-1742345114",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/28331"
    },
    {
      "event": "mentioned",
      "id": 10521525604,
      "node_id": "MEE_lADOABII585vHSmAzwAAAAJzIb1k",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10521525604",
      "actor": {
        "login": "theStack",
        "id": 91535,
        "node_id": "MDQ6VXNlcjkxNTM1",
        "avatar_url": "https://avatars.githubusercontent.com/u/91535?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theStack",
        "html_url": "https://github.com/theStack",
        "followers_url": "https://api.github.com/users/theStack/followers",
        "following_url": "https://api.github.com/users/theStack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theStack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theStack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theStack/subscriptions",
        "organizations_url": "https://api.github.com/users/theStack/orgs",
        "repos_url": "https://api.github.com/users/theStack/repos",
        "events_url": "https://api.github.com/users/theStack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theStack/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-10-02T03:10:32Z"
    },
    {
      "event": "subscribed",
      "id": 10521525608,
      "node_id": "SE_lADOABII585vHSmAzwAAAAJzIb1o",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10521525608",
      "actor": {
        "login": "theStack",
        "id": 91535,
        "node_id": "MDQ6VXNlcjkxNTM1",
        "avatar_url": "https://avatars.githubusercontent.com/u/91535?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theStack",
        "html_url": "https://github.com/theStack",
        "followers_url": "https://api.github.com/users/theStack/followers",
        "following_url": "https://api.github.com/users/theStack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theStack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theStack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theStack/subscriptions",
        "organizations_url": "https://api.github.com/users/theStack/orgs",
        "repos_url": "https://api.github.com/users/theStack/repos",
        "events_url": "https://api.github.com/users/theStack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theStack/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-10-02T03:10:33Z"
    },
    {
      "event": "mentioned",
      "id": 10521525616,
      "node_id": "MEE_lADOABII585vHSmAzwAAAAJzIb1w",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10521525616",
      "actor": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-10-02T03:10:33Z"
    },
    {
      "event": "subscribed",
      "id": 10521525624,
      "node_id": "SE_lADOABII585vHSmAzwAAAAJzIb14",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10521525624",
      "actor": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-10-02T03:10:33Z"
    },
    {
      "event": "labeled",
      "id": 10521853130,
      "node_id": "LE_lADOABII585vHSmAzwAAAAJzJrzK",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10521853130",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-10-02T04:38:20Z",
      "label": {
        "name": "CI failed",
        "color": "cccccc"
      }
    },
    {
      "event": "commented",
      "id": 1742669269,
      "node_id": "IC_kwDOABII585n3wXV",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1742669269",
      "actor": {
        "login": "fanquake",
        "id": 863730,
        "node_id": "MDQ6VXNlcjg2MzczMA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/863730?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fanquake",
        "html_url": "https://github.com/fanquake",
        "followers_url": "https://api.github.com/users/fanquake/followers",
        "following_url": "https://api.github.com/users/fanquake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fanquake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fanquake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fanquake/subscriptions",
        "organizations_url": "https://api.github.com/users/fanquake/orgs",
        "repos_url": "https://api.github.com/users/fanquake/repos",
        "events_url": "https://api.github.com/users/fanquake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fanquake/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-10-02T09:15:14Z",
      "updated_at": "2023-10-02T09:15:14Z",
      "author_association": "MEMBER",
      "body": "From clang-tidy (https://github.com/bitcoin/bitcoin/pull/28331/checks?check_run_id=17301328580):\r\n```bash\r\nclang-tidy-16 -p=/ci_container_base/ci/scratch/build/bitcoin-x86_64-pc-linux-gnu -quiet -load=/tidy-build/libbitcoin-tidy.so /ci_container_base/ci/scratch/build/bitcoin-x86_64-pc-linux-gnu/src/net.cpp\r\nnet.cpp:2869:22: error: 'grant' used after it was moved [bugprone-use-after-move,-warnings-as-errors]\r\n                if (!grant) grant = CSemaphoreGrant(*semAddnode, /*fTry=*/true);\r\n                     ^\r\nnet.cpp:2877:17: note: move occurred here\r\n                OpenNetworkConnection(addr, false, std::move(grant), info.m_params.m_added_node.c_str(), ConnectionType::MANUAL, info.m_params.m_use_v2transport);\r\n                ^\r\n--\r\n```",
      "user": {
        "login": "fanquake",
        "id": 863730,
        "node_id": "MDQ6VXNlcjg2MzczMA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/863730?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fanquake",
        "html_url": "https://github.com/fanquake",
        "followers_url": "https://api.github.com/users/fanquake/followers",
        "following_url": "https://api.github.com/users/fanquake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fanquake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fanquake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fanquake/subscriptions",
        "organizations_url": "https://api.github.com/users/fanquake/orgs",
        "repos_url": "https://api.github.com/users/fanquake/repos",
        "events_url": "https://api.github.com/users/fanquake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fanquake/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28331#issuecomment-1742669269",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/28331"
    },
    {
      "event": "reviewed",
      "id": 1652460362,
      "node_id": "PRR_kwDOABII585ifotK",
      "url": null,
      "actor": null,
      "commit_id": "cd5e72d6fb82c580dbf693b14e842d6204327311",
      "commit_url": null,
      "created_at": null,
      "author_association": "CONTRIBUTOR",
      "body": "ACK cd5e72d6fb82c580dbf693b14e842d6204327311 modulo the use-after-move which I think is benign but should be silenced regardless. This should resolve it (untested):\r\n\r\n```diff\r\n                 OpenNetworkConnection(addr, false, std::move(grant), info.m_params.m_added_node.c_str(), ConnectionTyp\r\n+                grant = CSemaphoreGrant{};\r\n                 if (!interruptNet.sleep_for(std::chrono::milliseconds(500)))\r\n```",
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28331#pullrequestreview-1652460362",
      "submitted_at": "2023-10-02T10:12:05Z",
      "state": "APPROVED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28331"
    },
    {
      "event": "review_requested",
      "id": 10524316769,
      "node_id": "RRE_lADOABII585vHSmAzwAAAAJzTFRh",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10524316769",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-10-02T10:12:13Z",
      "requested_reviewer": {
        "login": "theStack",
        "id": 91535,
        "node_id": "MDQ6VXNlcjkxNTM1",
        "avatar_url": "https://avatars.githubusercontent.com/u/91535?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theStack",
        "html_url": "https://github.com/theStack",
        "followers_url": "https://api.github.com/users/theStack/followers",
        "following_url": "https://api.github.com/users/theStack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theStack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theStack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theStack/subscriptions",
        "organizations_url": "https://api.github.com/users/theStack/orgs",
        "repos_url": "https://api.github.com/users/theStack/repos",
        "events_url": "https://api.github.com/users/theStack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theStack/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "review_requester": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      }
    },
    {
      "event": "review_requested",
      "id": 10524316917,
      "node_id": "RRE_lADOABII585vHSmAzwAAAAJzTFT1",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10524316917",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-10-02T10:12:13Z",
      "requested_reviewer": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "review_requester": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      }
    },
    {
      "event": "reviewed",
      "id": 1652554967,
      "node_id": "PRR_kwDOABII585if_zX",
      "url": null,
      "actor": null,
      "commit_id": "cd5e72d6fb82c580dbf693b14e842d6204327311",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "body": "Tested and mostly happy with cd5e72d6fb82c580dbf693b14e842d6204327311.",
      "user": {
        "login": "Sjors",
        "id": 10217,
        "node_id": "MDQ6VXNlcjEwMjE3",
        "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Sjors",
        "html_url": "https://github.com/Sjors",
        "followers_url": "https://api.github.com/users/Sjors/followers",
        "following_url": "https://api.github.com/users/Sjors/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Sjors/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Sjors/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
        "organizations_url": "https://api.github.com/users/Sjors/orgs",
        "repos_url": "https://api.github.com/users/Sjors/repos",
        "events_url": "https://api.github.com/users/Sjors/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Sjors/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28331#pullrequestreview-1652554967",
      "submitted_at": "2023-10-02T11:50:12Z",
      "state": "APPROVED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28331"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 10526011374,
      "node_id": "HRFPE_lADOABII585vHSmAzwAAAAJzZi_u",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10526011374",
      "actor": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": "7b255b56698392019dd575c3bb73f6d8b1334f4b",
      "commit_url": "https://api.github.com/repos/sipa/bitcoin/commits/7b255b56698392019dd575c3bb73f6d8b1334f4b",
      "created_at": "2023-10-02T13:19:09Z"
    },
    {
      "event": "commented",
      "id": 1743003932,
      "node_id": "IC_kwDOABII585n5CEc",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1743003932",
      "actor": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-10-02T13:19:21Z",
      "updated_at": "2023-10-02T13:35:09Z",
      "author_association": "MEMBER",
      "body": "Addressed comments by @Sjors, and (hopefully for real) fixed the semaphore move issue.\r\n\r\n```diff\r\ndiff --git a/src/net.cpp b/src/net.cpp\r\nindex a17c215a2c..c4c2d55c77 100644\r\n--- a/src/net.cpp\r\n+++ b/src/net.cpp\r\n@@ -582,7 +582,6 @@ CNode* CConnman::ConnectNode(CAddress addrConnect, const char *pszDest, bool fCo\r\n                                  .i2p_sam_session = std::move(i2p_transient_session),\r\n                                  .recv_flood_size = nReceiveFloodSize,\r\n                                  .use_v2transport = use_v2transport,\r\n-                                 .count_failure_after_reconnect = fCountFailure,\r\n                              });\r\n     pnode->AddRef();\r\n \r\n@@ -1925,6 +1924,8 @@ void CConnman::DisconnectNodes()\r\n     AssertLockNotHeld(m_nodes_mutex);\r\n     AssertLockNotHeld(m_reconnections_mutex);\r\n \r\n+    // Use a temporary variable to accumulate desired reconnections, so we don't need\r\n+    // m_reconnections_mutex while holding m_nodes_mutex.\r\n     decltype(m_reconnections) reconnections_to_add;\r\n \r\n     {\r\n@@ -1955,10 +1956,10 @@ void CConnman::DisconnectNodes()\r\n                 if (pnode->m_transport->ShouldReconnectV1()) {\r\n                     reconnections_to_add.push_back({\r\n                         .addr_connect = pnode->addr,\r\n-                        .count_failure = pnode->m_count_failure_after_reconnect,\r\n                         .grant = std::move(pnode->grantOutbound),\r\n                         .destination = pnode->m_dest,\r\n-                        .conn_type = pnode->m_conn_type});\r\n+                        .conn_type = pnode->m_conn_type,\r\n+                        .use_v2transport = false});\r\n                     LogPrint(BCLog::NET, \"retrying with v1 transport protocol for peer=%d\\n\", pnode->GetId());\r\n                 }\r\n \r\n@@ -2866,7 +2867,6 @@ void CConnman::ThreadOpenAddedConnections()\r\n         bool tried = false;\r\n         for (const AddedNodeInfo& info : vInfo) {\r\n             if (!info.fConnected) {\r\n-                if (!grant) grant = CSemaphoreGrant(*semAddnode, /*fTry=*/true);\r\n                 if (!grant) {\r\n                     // If we've used up our semaphore and need a new one, let's not wait here since while we are waiting\r\n                     // the addednodeinfo state might change.\r\n@@ -2875,8 +2875,8 @@ void CConnman::ThreadOpenAddedConnections()\r\n                 tried = true;\r\n                 CAddress addr(CService(), NODE_NONE);\r\n                 OpenNetworkConnection(addr, false, std::move(grant), info.m_params.m_added_node.c_str(), ConnectionType::MANUAL, info.m_params.m_use_v2transport);\r\n-                if (!interruptNet.sleep_for(std::chrono::milliseconds(500)))\r\n-                    return;\r\n+                if (!interruptNet.sleep_for(std::chrono::milliseconds(500))) return;\r\n+                grant = CSemaphoreGrant(*semAddnode, /*fTry=*/true);\r\n             }\r\n         }\r\n         // Retry every 60 seconds if a connection was attempted, otherwise two seconds\r\n@@ -3699,7 +3699,6 @@ CNode::CNode(NodeId idIn,\r\n       m_addr_name{addrNameIn.empty() ? addr.ToStringAddrPort() : addrNameIn},\r\n       m_dest(addrNameIn),\r\n       m_inbound_onion{inbound_onion},\r\n-      m_count_failure_after_reconnect{node_opts.count_failure_after_reconnect},\r\n       m_prefer_evict{node_opts.prefer_evict},\r\n       nKeyedNetGroup{nKeyedNetGroupIn},\r\n       m_conn_type{conn_type_in},\r\n@@ -3844,11 +3843,15 @@ void CConnman::PerformReconnections()\r\n \r\n         auto& item = *todo.begin();\r\n         OpenNetworkConnection(item.addr_connect,\r\n-                              item.count_failure,\r\n+                              // We only reconnect if the first attempt to connect succeeded at\r\n+                              // connection time, but then failed after the CNode object was\r\n+                              // created. Since we already know connecting is possible, do not\r\n+                              // count failure to reconnect.\r\n+                              /*fCountFailure=*/false,\r\n                               std::move(item.grant),\r\n                               item.destination.empty() ? nullptr : item.destination.c_str(),\r\n                               item.conn_type,\r\n-                              /*use_v2transport=*/false);\r\n+                              item.use_v2transport);\r\n     }\r\n }\r\n \r\ndiff --git a/src/net.h b/src/net.h\r\nindex 25a9814f63..2f7b832fba 100644\r\n--- a/src/net.h\r\n+++ b/src/net.h\r\n@@ -689,7 +689,6 @@ struct CNodeOptions\r\n     bool prefer_evict = false;\r\n     size_t recv_flood_size{DEFAULT_MAXRECEIVEBUFFER * 1000};\r\n     bool use_v2transport = false;\r\n-    bool count_failure_after_reconnect = false;\r\n };\r\n \r\n /** Information about a peer */\r\n@@ -738,8 +737,6 @@ public:\r\n     const std::string m_dest;\r\n     //! Whether this peer is an inbound onion, i.e. connected via our Tor onion service.\r\n     const bool m_inbound_onion;\r\n-    //! Whether (reconnections of) connections to this peer should count as failure.\r\n-    const bool m_count_failure_after_reconnect;\r\n     std::atomic<int> nVersion{0};\r\n     Mutex m_subver_mutex;\r\n     /**\r\n@@ -1578,10 +1575,10 @@ private:\r\n     struct ReconnectionInfo\r\n     {\r\n         CAddress addr_connect;\r\n-        bool count_failure;\r\n         CSemaphoreGrant grant;\r\n         std::string destination;\r\n         ConnectionType conn_type;\r\n+        bool use_v2transport;\r\n     };\r\n \r\n     /**\r\n```\r\n",
      "user": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28331#issuecomment-1743003932",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/28331"
    },
    {
      "event": "mentioned",
      "id": 10526013901,
      "node_id": "MEE_lADOABII585vHSmAzwAAAAJzZjnN",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10526013901",
      "actor": {
        "login": "Sjors",
        "id": 10217,
        "node_id": "MDQ6VXNlcjEwMjE3",
        "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Sjors",
        "html_url": "https://github.com/Sjors",
        "followers_url": "https://api.github.com/users/Sjors/followers",
        "following_url": "https://api.github.com/users/Sjors/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Sjors/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Sjors/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
        "organizations_url": "https://api.github.com/users/Sjors/orgs",
        "repos_url": "https://api.github.com/users/Sjors/repos",
        "events_url": "https://api.github.com/users/Sjors/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Sjors/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-10-02T13:19:22Z"
    },
    {
      "event": "subscribed",
      "id": 10526013922,
      "node_id": "SE_lADOABII585vHSmAzwAAAAJzZjni",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10526013922",
      "actor": {
        "login": "Sjors",
        "id": 10217,
        "node_id": "MDQ6VXNlcjEwMjE3",
        "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Sjors",
        "html_url": "https://github.com/Sjors",
        "followers_url": "https://api.github.com/users/Sjors/followers",
        "following_url": "https://api.github.com/users/Sjors/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Sjors/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Sjors/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
        "organizations_url": "https://api.github.com/users/Sjors/orgs",
        "repos_url": "https://api.github.com/users/Sjors/repos",
        "events_url": "https://api.github.com/users/Sjors/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Sjors/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-10-02T13:19:22Z"
    },
    {
      "event": "commented",
      "id": 1743028933,
      "node_id": "IC_kwDOABII585n5ILF",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1743028933",
      "actor": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-10-02T13:34:46Z",
      "updated_at": "2023-10-02T13:34:46Z",
      "author_association": "MEMBER",
      "body": "@vasild I've switched to a slightly different approach to avoid the use-after-move (see diff above).",
      "user": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28331#issuecomment-1743028933",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/28331"
    },
    {
      "event": "mentioned",
      "id": 10526196314,
      "node_id": "MEE_lADOABII585vHSmAzwAAAAJzaQJa",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10526196314",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-10-02T13:34:47Z"
    },
    {
      "event": "subscribed",
      "id": 10526196332,
      "node_id": "SE_lADOABII585vHSmAzwAAAAJzaQJs",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10526196332",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-10-02T13:34:47Z"
    },
    {
      "event": "reviewed",
      "id": 1653050182,
      "node_id": "PRR_kwDOABII585ih4tG",
      "url": null,
      "actor": null,
      "commit_id": "2e0f8a6d39a15ecac60b9d463606e16ba5707bb5",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "user": {
        "login": "Sjors",
        "id": 10217,
        "node_id": "MDQ6VXNlcjEwMjE3",
        "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Sjors",
        "html_url": "https://github.com/Sjors",
        "followers_url": "https://api.github.com/users/Sjors/followers",
        "following_url": "https://api.github.com/users/Sjors/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Sjors/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Sjors/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
        "organizations_url": "https://api.github.com/users/Sjors/orgs",
        "repos_url": "https://api.github.com/users/Sjors/repos",
        "events_url": "https://api.github.com/users/Sjors/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Sjors/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28331#pullrequestreview-1653050182",
      "submitted_at": "2023-10-02T15:56:50Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28331"
    },
    {
      "event": "commented",
      "id": 1743369372,
      "node_id": "IC_kwDOABII585n6bSc",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1743369372",
      "actor": {
        "login": "Sjors",
        "id": 10217,
        "node_id": "MDQ6VXNlcjEwMjE3",
        "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Sjors",
        "html_url": "https://github.com/Sjors",
        "followers_url": "https://api.github.com/users/Sjors/followers",
        "following_url": "https://api.github.com/users/Sjors/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Sjors/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Sjors/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
        "organizations_url": "https://api.github.com/users/Sjors/orgs",
        "repos_url": "https://api.github.com/users/Sjors/repos",
        "events_url": "https://api.github.com/users/Sjors/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Sjors/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-10-02T16:46:18Z",
      "updated_at": "2023-10-02T16:46:18Z",
      "author_association": "MEMBER",
      "body": "tACK 7b255b56698392019dd575c3bb73f6d8b1334f4b",
      "user": {
        "login": "Sjors",
        "id": 10217,
        "node_id": "MDQ6VXNlcjEwMjE3",
        "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Sjors",
        "html_url": "https://github.com/Sjors",
        "followers_url": "https://api.github.com/users/Sjors/followers",
        "following_url": "https://api.github.com/users/Sjors/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Sjors/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Sjors/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
        "organizations_url": "https://api.github.com/users/Sjors/orgs",
        "repos_url": "https://api.github.com/users/Sjors/repos",
        "events_url": "https://api.github.com/users/Sjors/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Sjors/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28331#issuecomment-1743369372",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/28331"
    },
    {
      "event": "review_requested",
      "id": 10528344465,
      "node_id": "RRE_lADOABII585vHSmAzwAAAAJzicmR",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10528344465",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-10-02T16:46:26Z",
      "requested_reviewer": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "review_requester": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      }
    },
    {
      "event": "unlabeled",
      "id": 10528936174,
      "node_id": "UNLE_lADOABII585vHSmAzwAAAAJzktDu",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10528936174",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-10-02T17:56:47Z",
      "label": {
        "name": "CI failed",
        "color": "cccccc"
      }
    },
    {
      "event": "reviewed",
      "id": 1653503507,
      "node_id": "PRR_kwDOABII585ijnYT",
      "url": null,
      "actor": null,
      "commit_id": "7b255b56698392019dd575c3bb73f6d8b1334f4b",
      "commit_url": null,
      "created_at": null,
      "author_association": "CONTRIBUTOR",
      "body": "ACK 7b255b56698392019dd575c3bb73f6d8b1334f4b",
      "user": {
        "login": "theStack",
        "id": 91535,
        "node_id": "MDQ6VXNlcjkxNTM1",
        "avatar_url": "https://avatars.githubusercontent.com/u/91535?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theStack",
        "html_url": "https://github.com/theStack",
        "followers_url": "https://api.github.com/users/theStack/followers",
        "following_url": "https://api.github.com/users/theStack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theStack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theStack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theStack/subscriptions",
        "organizations_url": "https://api.github.com/users/theStack/orgs",
        "repos_url": "https://api.github.com/users/theStack/repos",
        "events_url": "https://api.github.com/users/theStack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theStack/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28331#pullrequestreview-1653503507",
      "submitted_at": "2023-10-02T20:58:03Z",
      "state": "APPROVED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28331"
    },
    {
      "event": "reviewed",
      "id": 1653525921,
      "node_id": "PRR_kwDOABII585ijs2h",
      "url": null,
      "actor": null,
      "commit_id": "7b255b56698392019dd575c3bb73f6d8b1334f4b",
      "commit_url": null,
      "created_at": null,
      "author_association": "CONTRIBUTOR",
      "body": "ACK 7b255b56698392019dd575c3bb73f6d8b1334f4b",
      "user": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28331#pullrequestreview-1653525921",
      "submitted_at": "2023-10-02T21:41:19Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28331"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKGFiZjM0M2IzMjAyNmMzZjgyNDZmOThjNDE2ZTJjNmNmNWI2NmFhMzg",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/abf343b32026c3f8246f98c416e2c6cf5b66aa38",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/abf343b32026c3f8246f98c416e2c6cf5b66aa38",
      "tree": {
        "sha": "a9adcafb56ee287487780fcfcea8780e308bebaf",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/a9adcafb56ee287487780fcfcea8780e308bebaf"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/e7b0004b375be25096fbaf3d5f6980095a90fc0c",
          "sha": "e7b0004b375be25096fbaf3d5f6980095a90fc0c",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/e7b0004b375be25096fbaf3d5f6980095a90fc0c"
        }
      ],
      "message": "net: advertise NODE_P2P_V2 if CLI arg -v2transport is on\n\nCo-authored-by: Dhruv Mehta <856960+dhruv@users.noreply.github.com>",
      "committer": {
        "name": "Pieter Wuille",
        "email": "pieter@wuille.net",
        "date": "2023-10-02T22:09:53Z"
      },
      "author": {
        "name": "Pieter Wuille",
        "email": "pieter@wuille.net",
        "date": "2023-08-22T21:50:59Z"
      },
      "sha": "abf343b32026c3f8246f98c416e2c6cf5b66aa38"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKGE0NzA2YmM4Nzc1MDQwNTdlODUyMmM5MjljYzA3MDRkM2VhYTczMDI",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/a4706bc877504057e8522c929cc0704d3eaa7302",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/a4706bc877504057e8522c929cc0704d3eaa7302",
      "tree": {
        "sha": "9de2ac46f58890a0ce845ae0a101c6280178c86b",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/9de2ac46f58890a0ce845ae0a101c6280178c86b"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/abf343b32026c3f8246f98c416e2c6cf5b66aa38",
          "sha": "abf343b32026c3f8246f98c416e2c6cf5b66aa38",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/abf343b32026c3f8246f98c416e2c6cf5b66aa38"
        }
      ],
      "message": "rpc: don't report v2 handshake bytes in the per-type sent byte statistics\n\nThis matches the behavior for per-type received bytes.",
      "committer": {
        "name": "Pieter Wuille",
        "email": "pieter@wuille.net",
        "date": "2023-10-02T22:09:53Z"
      },
      "author": {
        "name": "Sebastian Falbesoner",
        "email": "sebastian.falbesoner@gmail.com",
        "date": "2023-09-26T22:07:36Z"
      },
      "sha": "a4706bc877504057e8522c929cc0704d3eaa7302"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDYyZDIxZWUwOTc0YjU4MmE2YTMyYWE5N2VlMzVlZjUxYzk3N2VhNGI",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/62d21ee0974b582a6a32aa97ee35ef51c977ea4b",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/62d21ee0974b582a6a32aa97ee35ef51c977ea4b",
      "tree": {
        "sha": "2ba15baa14d626ce9573fd9d175ded0dfe3b322d",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/2ba15baa14d626ce9573fd9d175ded0dfe3b322d"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/a4706bc877504057e8522c929cc0704d3eaa7302",
          "sha": "a4706bc877504057e8522c929cc0704d3eaa7302",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/a4706bc877504057e8522c929cc0704d3eaa7302"
        }
      ],
      "message": "net: use V2Transport when NODE_P2P_V2 service flag is present\n\nCo-authored-by: Dhruv Mehta <856960+dhruv@users.noreply.github.com>",
      "committer": {
        "name": "Pieter Wuille",
        "email": "pieter@wuille.net",
        "date": "2023-10-02T22:09:53Z"
      },
      "author": {
        "name": "Pieter Wuille",
        "email": "pieter@wuille.net",
        "date": "2023-08-21T20:55:47Z"
      },
      "sha": "62d21ee0974b582a6a32aa97ee35ef51c977ea4b"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKGM3M2NkNDIzNjM2ZTA2ZGY0Njc0MmY1NzM2NDBjYTc3M2IyODFmZmM",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/c73cd423636e06df46742f573640ca773b281ffc",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/c73cd423636e06df46742f573640ca773b281ffc",
      "tree": {
        "sha": "5170a212e21a9886b9d6975d417af76e5da6cf9e",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/5170a212e21a9886b9d6975d417af76e5da6cf9e"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/62d21ee0974b582a6a32aa97ee35ef51c977ea4b",
          "sha": "62d21ee0974b582a6a32aa97ee35ef51c977ea4b",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/62d21ee0974b582a6a32aa97ee35ef51c977ea4b"
        }
      ],
      "message": "rpc: addnode arg to use BIP324 v2 p2p\n\nCo-authored-by: Pieter Wuille <bitcoin-dev@wuille.net>",
      "committer": {
        "name": "Pieter Wuille",
        "email": "pieter@wuille.net",
        "date": "2023-10-02T22:10:30Z"
      },
      "author": {
        "name": "dhruv",
        "email": "856960+dhruv@users.noreply.github.com",
        "date": "2021-12-28T21:26:20Z"
      },
      "sha": "c73cd423636e06df46742f573640ca773b281ffc"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDRkMjY1ZDAzNDJhZTdlOTJkZjA3YmE1MWU4MzU1ZGI1N2M0NGY4MTE",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/4d265d0342ae7e92df07ba51e8355db57c44f811",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/4d265d0342ae7e92df07ba51e8355db57c44f811",
      "tree": {
        "sha": "bf7a39144549b675da278630417c673c38fac7d6",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/bf7a39144549b675da278630417c673c38fac7d6"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/c73cd423636e06df46742f573640ca773b281ffc",
          "sha": "c73cd423636e06df46742f573640ca773b281ffc",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/c73cd423636e06df46742f573640ca773b281ffc"
        }
      ],
      "message": "sync: modernize CSemaphore / CSemaphoreGrant",
      "committer": {
        "name": "Pieter Wuille",
        "email": "pieter@wuille.net",
        "date": "2023-10-02T22:11:11Z"
      },
      "author": {
        "name": "Pieter Wuille",
        "email": "pieter@wuille.net",
        "date": "2023-08-21T22:14:52Z"
      },
      "sha": "4d265d0342ae7e92df07ba51e8355db57c44f811"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDQzMmE2MmM0ZGNlOTA4NzI5YzYyZWRjZmFlYmMzZGE2Mzg3YzNhZmU",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/432a62c4dce908729c62edcfaebc3da6387c3afe",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/432a62c4dce908729c62edcfaebc3da6387c3afe",
      "tree": {
        "sha": "4fdb72096bdc965a2128e2b533b0c88848c95335",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/4fdb72096bdc965a2128e2b533b0c88848c95335"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/4d265d0342ae7e92df07ba51e8355db57c44f811",
          "sha": "4d265d0342ae7e92df07ba51e8355db57c44f811",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/4d265d0342ae7e92df07ba51e8355db57c44f811"
        }
      ],
      "message": "net: reconnect with V1Transport under certain conditions\n\nWhen an outbound v2 connection is disconnected without receiving anything, but at\nleast 24 bytes of our pubkey were sent out (enough to constitute an invalid v1\nheader), add them to a queue of reconnections to be tried.\n\nThe reconnections are in a queue rather than performed immediately, because we should\nnot block the socket handler thread with connection creation (a blocking operation\nthat can take multiple seconds).",
      "committer": {
        "name": "Pieter Wuille",
        "email": "pieter@wuille.net",
        "date": "2023-10-02T22:11:11Z"
      },
      "author": {
        "name": "Pieter Wuille",
        "email": "pieter@wuille.net",
        "date": "2023-08-23T00:42:24Z"
      },
      "sha": "432a62c4dce908729c62edcfaebc3da6387c3afe"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKGI4MTVjY2U1MGU0YmZhMGVmZWE4ZWEwMjY1OWI3MDQyYzhmYjE4YmU",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/b815cce50e4bfa0efea8ea02659b7042c8fb18be",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/b815cce50e4bfa0efea8ea02659b7042c8fb18be",
      "tree": {
        "sha": "afa56cd1e5d44347a65b9cdd7f6470842cb2cfa2",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/afa56cd1e5d44347a65b9cdd7f6470842cb2cfa2"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/432a62c4dce908729c62edcfaebc3da6387c3afe",
          "sha": "432a62c4dce908729c62edcfaebc3da6387c3afe",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/432a62c4dce908729c62edcfaebc3da6387c3afe"
        }
      ],
      "message": "net: expose transport types/session IDs of connections in RPC and logs\n\nCo-authored-by: Dhruv Mehta <856960+dhruv@users.noreply.github.com>",
      "committer": {
        "name": "Pieter Wuille",
        "email": "pieter@wuille.net",
        "date": "2023-10-02T22:11:11Z"
      },
      "author": {
        "name": "Pieter Wuille",
        "email": "pieter@wuille.net",
        "date": "2023-07-31T03:26:04Z"
      },
      "sha": "b815cce50e4bfa0efea8ea02659b7042c8fb18be"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDA1ZDE5ZmJjYzEwZjI2YzdmMWUzYTlhZmM2NjBlYjdmYTcxYjFkOGM",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/05d19fbcc10f26c7f1e3a9afc660eb7fa71b1d8c",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/05d19fbcc10f26c7f1e3a9afc660eb7fa71b1d8c",
      "tree": {
        "sha": "52a785ca14387b862ed7fc17be9b7e2536dc5648",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/52a785ca14387b862ed7fc17be9b7e2536dc5648"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/b815cce50e4bfa0efea8ea02659b7042c8fb18be",
          "sha": "b815cce50e4bfa0efea8ea02659b7042c8fb18be",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/b815cce50e4bfa0efea8ea02659b7042c8fb18be"
        }
      ],
      "message": "test: Functional test for opportunistic encryption\n\nCo-authored-by: Pieter Wuille <bitcoin-dev@wuille.net>",
      "committer": {
        "name": "Pieter Wuille",
        "email": "pieter@wuille.net",
        "date": "2023-10-02T22:11:11Z"
      },
      "author": {
        "name": "dhruv",
        "email": "856960+dhruv@users.noreply.github.com",
        "date": "2022-09-07T22:59:49Z"
      },
      "sha": "05d19fbcc10f26c7f1e3a9afc660eb7fa71b1d8c"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDY0Y2E3MjEwZjA1YzQwMDMyMjhmNGNiMGIxNjBkODY5ZTE1ZjQ3ZDI",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/64ca7210f05c4003228f4cb0b160d869e15f47d2",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/64ca7210f05c4003228f4cb0b160d869e15f47d2",
      "tree": {
        "sha": "2e22e781eeeef9429b6486e0fc8c45045969ef67",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/2e22e781eeeef9429b6486e0fc8c45045969ef67"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/05d19fbcc10f26c7f1e3a9afc660eb7fa71b1d8c",
          "sha": "05d19fbcc10f26c7f1e3a9afc660eb7fa71b1d8c",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/05d19fbcc10f26c7f1e3a9afc660eb7fa71b1d8c"
        }
      ],
      "message": "test: enable v2 transport between nodes in some functional tests",
      "committer": {
        "name": "Pieter Wuille",
        "email": "pieter@wuille.net",
        "date": "2023-10-02T22:11:11Z"
      },
      "author": {
        "name": "Pieter Wuille",
        "email": "pieter@wuille.net",
        "date": "2023-09-10T01:20:17Z"
      },
      "sha": "64ca7210f05c4003228f4cb0b160d869e15f47d2"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDc1YTMyOTEwMzUwNTczNmFjYjkwMzYyMjRkYTJkZmE4YWIwMzhjNDM",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/75a329103505736acb9036224da2dfa8ab038c43",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/75a329103505736acb9036224da2dfa8ab038c43",
      "tree": {
        "sha": "ead95c4708835234fbdec10a7a25cbc80cfccef5",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/ead95c4708835234fbdec10a7a25cbc80cfccef5"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/64ca7210f05c4003228f4cb0b160d869e15f47d2",
          "sha": "64ca7210f05c4003228f4cb0b160d869e15f47d2",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/64ca7210f05c4003228f4cb0b160d869e15f47d2"
        }
      ],
      "message": "doc: mention BIP324 support in bips.md",
      "committer": {
        "name": "Pieter Wuille",
        "email": "pieter@wuille.net",
        "date": "2023-10-02T22:11:11Z"
      },
      "author": {
        "name": "Pieter Wuille",
        "email": "pieter@wuille.net",
        "date": "2023-09-27T12:47:16Z"
      },
      "sha": "75a329103505736acb9036224da2dfa8ab038c43"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 10531207976,
      "node_id": "HRFPE_lADOABII585vHSmAzwAAAAJztXso",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10531207976",
      "actor": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": "75a329103505736acb9036224da2dfa8ab038c43",
      "commit_url": "https://api.github.com/repos/sipa/bitcoin/commits/75a329103505736acb9036224da2dfa8ab038c43",
      "created_at": "2023-10-02T22:26:16Z"
    },
    {
      "event": "commented",
      "id": 1743858843,
      "node_id": "IC_kwDOABII585n8Syb",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1743858843",
      "actor": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-10-02T22:29:07Z",
      "updated_at": "2023-10-02T22:29:07Z",
      "author_association": "MEMBER",
      "body": "Addressed nits by @mzumsande and @theStack:\r\n\r\n```diff\r\ndiff --git a/doc/bips.md b/doc/bips.md\r\nindex 87b5918c72..952d289daa 100644\r\n--- a/doc/bips.md\r\n+++ b/doc/bips.md\r\n@@ -49,7 +49,7 @@ BIPs that are implemented by Bitcoin Core:\r\n * [`BIP 173`](https://github.com/bitcoin/bips/blob/master/bip-0173.mediawiki): Bech32 addresses for native Segregated Witness outputs are supported as of **v0.16.0** ([PR 11167](https://github.com/bitcoin/bitcoin/pull/11167)). Bech32 addresses are generated by default as of **v0.20.0** ([PR 16884](https://github.com/bitcoin/bitcoin/pull/16884)).\r\n * [`BIP 174`](https://github.com/bitcoin/bips/blob/master/bip-0174.mediawiki): RPCs to operate on Partially Signed Bitcoin Transactions (PSBT) are present as of **v0.17.0** ([PR 13557](https://github.com/bitcoin/bitcoin/pull/13557)).\r\n * [`BIP 176`](https://github.com/bitcoin/bips/blob/master/bip-0176.mediawiki): Bits Denomination [QT only] is supported as of **v0.16.0** ([PR 12035](https://github.com/bitcoin/bitcoin/pull/12035)).\r\n-* [`BIP 324`](https://github.com/bitcoin/bips/blob/master/bip-0324.mediawiki): Support for the BIP324 v2 transport protocol and the associated `NODE_P2P_V2` service bit is supported as of **v26.0**, but off by default ([PR 28331](https://github.com/bitcoin/bitcoin/pull/28331)).\r\n+* [`BIP 324`](https://github.com/bitcoin/bips/blob/master/bip-0324.mediawiki): The v2 transport protocol specified by BIP324 and the associated `NODE_P2P_V2` service bit are supported as of **v26.0**, but off by default ([PR 28331](https://github.com/bitcoin/bitcoin/pull/28331)).\r\n * [`BIP 325`](https://github.com/bitcoin/bips/blob/master/bip-0325.mediawiki): Signet test network is supported as of **v0.21.0** ([PR 18267](https://github.com/bitcoin/bitcoin/pull/18267)).\r\n * [`BIP 339`](https://github.com/bitcoin/bips/blob/master/bip-0339.mediawiki): Relay of transactions by wtxid is supported as of **v0.21.0** ([PR 18044](https://github.com/bitcoin/bitcoin/pull/18044)).\r\n * [`BIP 340`](https://github.com/bitcoin/bips/blob/master/bip-0340.mediawiki)\r\ndiff --git a/src/net.cpp b/src/net.cpp\r\nindex c4c2d55c77..6b2ef5f43d 100644\r\n--- a/src/net.cpp\r\n+++ b/src/net.cpp\r\n@@ -469,7 +469,7 @@ CNode* CConnman::ConnectNode(CAddress addrConnect, const char *pszDest, bool fCo\r\n         const std::vector<CService> resolved{Lookup(pszDest, default_port, fNameLookup && !HaveNameProxy(), 256)};\r\n         if (!resolved.empty()) {\r\n             const CService& rnd{resolved[GetRand(resolved.size())]};\r\n-            addrConnect = CAddress{MaybeFlipIPv6toCJDNS(rnd), addrConnect.nServices};\r\n+            addrConnect = CAddress{MaybeFlipIPv6toCJDNS(rnd), NODE_NONE};\r\n             if (!addrConnect.IsValid()) {\r\n                 LogPrint(BCLog::NET, \"Resolver returned invalid address %s for %s\\n\", addrConnect.ToStringAddrPort(), pszDest);\r\n                 return nullptr;\r\n```\r\n",
      "user": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28331#issuecomment-1743858843",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/28331"
    },
    {
      "event": "mentioned",
      "id": 10531224532,
      "node_id": "MEE_lADOABII585vHSmAzwAAAAJztbvU",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10531224532",
      "actor": {
        "login": "theStack",
        "id": 91535,
        "node_id": "MDQ6VXNlcjkxNTM1",
        "avatar_url": "https://avatars.githubusercontent.com/u/91535?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theStack",
        "html_url": "https://github.com/theStack",
        "followers_url": "https://api.github.com/users/theStack/followers",
        "following_url": "https://api.github.com/users/theStack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theStack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theStack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theStack/subscriptions",
        "organizations_url": "https://api.github.com/users/theStack/orgs",
        "repos_url": "https://api.github.com/users/theStack/repos",
        "events_url": "https://api.github.com/users/theStack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theStack/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-10-02T22:29:08Z"
    },
    {
      "event": "subscribed",
      "id": 10531224543,
      "node_id": "SE_lADOABII585vHSmAzwAAAAJztbvf",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10531224543",
      "actor": {
        "login": "theStack",
        "id": 91535,
        "node_id": "MDQ6VXNlcjkxNTM1",
        "avatar_url": "https://avatars.githubusercontent.com/u/91535?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theStack",
        "html_url": "https://github.com/theStack",
        "followers_url": "https://api.github.com/users/theStack/followers",
        "following_url": "https://api.github.com/users/theStack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theStack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theStack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theStack/subscriptions",
        "organizations_url": "https://api.github.com/users/theStack/orgs",
        "repos_url": "https://api.github.com/users/theStack/repos",
        "events_url": "https://api.github.com/users/theStack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theStack/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-10-02T22:29:08Z"
    },
    {
      "event": "mentioned",
      "id": 10531224551,
      "node_id": "MEE_lADOABII585vHSmAzwAAAAJztbvn",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10531224551",
      "actor": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-10-02T22:29:08Z"
    },
    {
      "event": "subscribed",
      "id": 10531224556,
      "node_id": "SE_lADOABII585vHSmAzwAAAAJztbvs",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10531224556",
      "actor": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-10-02T22:29:08Z"
    },
    {
      "event": "reviewed",
      "id": 1653679049,
      "node_id": "PRR_kwDOABII585ikSPJ",
      "url": null,
      "actor": null,
      "commit_id": "75a329103505736acb9036224da2dfa8ab038c43",
      "commit_url": null,
      "created_at": null,
      "author_association": "CONTRIBUTOR",
      "body": "re-ACK 75a329103505736acb9036224da2dfa8ab038c43",
      "user": {
        "login": "theStack",
        "id": 91535,
        "node_id": "MDQ6VXNlcjkxNTM1",
        "avatar_url": "https://avatars.githubusercontent.com/u/91535?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theStack",
        "html_url": "https://github.com/theStack",
        "followers_url": "https://api.github.com/users/theStack/followers",
        "following_url": "https://api.github.com/users/theStack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theStack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theStack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theStack/subscriptions",
        "organizations_url": "https://api.github.com/users/theStack/orgs",
        "repos_url": "https://api.github.com/users/theStack/repos",
        "events_url": "https://api.github.com/users/theStack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theStack/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28331#pullrequestreview-1653679049",
      "submitted_at": "2023-10-02T23:28:27Z",
      "state": "APPROVED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28331"
    },
    {
      "event": "review_requested",
      "id": 10531548173,
      "node_id": "RRE_lADOABII585vHSmAzwAAAAJzuqwN",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10531548173",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-10-02T23:28:34Z",
      "requested_reviewer": {
        "login": "Sjors",
        "id": 10217,
        "node_id": "MDQ6VXNlcjEwMjE3",
        "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Sjors",
        "html_url": "https://github.com/Sjors",
        "followers_url": "https://api.github.com/users/Sjors/followers",
        "following_url": "https://api.github.com/users/Sjors/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Sjors/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Sjors/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
        "organizations_url": "https://api.github.com/users/Sjors/orgs",
        "repos_url": "https://api.github.com/users/Sjors/repos",
        "events_url": "https://api.github.com/users/Sjors/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Sjors/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "review_requester": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      }
    },
    {
      "event": "review_requested",
      "id": 10531548226,
      "node_id": "RRE_lADOABII585vHSmAzwAAAAJzuqxC",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10531548226",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-10-02T23:28:35Z",
      "requested_reviewer": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "review_requester": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      }
    },
    {
      "event": "commented",
      "id": 1743939613,
      "node_id": "IC_kwDOABII585n8mgd",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1743939613",
      "actor": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-10-02T23:59:15Z",
      "updated_at": "2023-10-02T23:59:15Z",
      "author_association": "CONTRIBUTOR",
      "body": "re-ACK 75a329103505736acb9036224da2dfa8ab038c43",
      "user": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28331#issuecomment-1743939613",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/28331"
    },
    {
      "event": "review_request_removed",
      "id": 10531689810,
      "node_id": "RRRE_lADOABII585vHSmAzwAAAAJzvNVS",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10531689810",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-10-02T23:59:21Z",
      "requested_reviewer": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "review_requester": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      }
    },
    {
      "event": "commented",
      "id": 1744557221,
      "node_id": "IC_kwDOABII585n-9Sl",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1744557221",
      "actor": {
        "login": "Sjors",
        "id": 10217,
        "node_id": "MDQ6VXNlcjEwMjE3",
        "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Sjors",
        "html_url": "https://github.com/Sjors",
        "followers_url": "https://api.github.com/users/Sjors/followers",
        "following_url": "https://api.github.com/users/Sjors/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Sjors/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Sjors/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
        "organizations_url": "https://api.github.com/users/Sjors/orgs",
        "repos_url": "https://api.github.com/users/Sjors/repos",
        "events_url": "https://api.github.com/users/Sjors/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Sjors/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-10-03T09:12:40Z",
      "updated_at": "2023-10-03T09:12:40Z",
      "author_association": "MEMBER",
      "body": "re-ACK 75a329103505736acb9036224da2dfa8ab038c43",
      "user": {
        "login": "Sjors",
        "id": 10217,
        "node_id": "MDQ6VXNlcjEwMjE3",
        "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Sjors",
        "html_url": "https://github.com/Sjors",
        "followers_url": "https://api.github.com/users/Sjors/followers",
        "following_url": "https://api.github.com/users/Sjors/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Sjors/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Sjors/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
        "organizations_url": "https://api.github.com/users/Sjors/orgs",
        "repos_url": "https://api.github.com/users/Sjors/repos",
        "events_url": "https://api.github.com/users/Sjors/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Sjors/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28331#issuecomment-1744557221",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/28331"
    },
    {
      "event": "review_request_removed",
      "id": 10535594925,
      "node_id": "RRRE_lADOABII585vHSmAzwAAAAJz-Gut",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10535594925",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-10-03T09:12:47Z",
      "requested_reviewer": {
        "login": "Sjors",
        "id": 10217,
        "node_id": "MDQ6VXNlcjEwMjE3",
        "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Sjors",
        "html_url": "https://github.com/Sjors",
        "followers_url": "https://api.github.com/users/Sjors/followers",
        "following_url": "https://api.github.com/users/Sjors/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Sjors/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Sjors/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
        "organizations_url": "https://api.github.com/users/Sjors/orgs",
        "repos_url": "https://api.github.com/users/Sjors/repos",
        "events_url": "https://api.github.com/users/Sjors/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Sjors/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "review_requester": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      }
    },
    {
      "event": "merged",
      "id": 10535599397,
      "node_id": "ME_lADOABII585vHSmAzwAAAAJz-H0l",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10535599397",
      "actor": {
        "login": "fanquake",
        "id": 863730,
        "node_id": "MDQ6VXNlcjg2MzczMA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/863730?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fanquake",
        "html_url": "https://github.com/fanquake",
        "followers_url": "https://api.github.com/users/fanquake/followers",
        "following_url": "https://api.github.com/users/fanquake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fanquake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fanquake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fanquake/subscriptions",
        "organizations_url": "https://api.github.com/users/fanquake/orgs",
        "repos_url": "https://api.github.com/users/fanquake/repos",
        "events_url": "https://api.github.com/users/fanquake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fanquake/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": "6f882e6f8689af1f188b687c2128524880815cef",
      "commit_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/6f882e6f8689af1f188b687c2128524880815cef",
      "created_at": "2023-10-03T09:13:13Z"
    },
    {
      "event": "closed",
      "id": 10535599432,
      "node_id": "CE_lADOABII585vHSmAzwAAAAJz-H1I",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10535599432",
      "actor": {
        "login": "fanquake",
        "id": 863730,
        "node_id": "MDQ6VXNlcjg2MzczMA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/863730?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fanquake",
        "html_url": "https://github.com/fanquake",
        "followers_url": "https://api.github.com/users/fanquake/followers",
        "following_url": "https://api.github.com/users/fanquake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fanquake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fanquake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fanquake/subscriptions",
        "organizations_url": "https://api.github.com/users/fanquake/orgs",
        "repos_url": "https://api.github.com/users/fanquake/repos",
        "events_url": "https://api.github.com/users/fanquake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fanquake/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-10-03T09:13:14Z"
    },
    {
      "event": "commented",
      "id": 1744598085,
      "node_id": "IC_kwDOABII585n_HRF",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1744598085",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-10-03T09:36:47Z",
      "updated_at": "2023-10-03T09:36:47Z",
      "author_association": "CONTRIBUTOR",
      "body": "ACK 75a329103505736acb9036224da2dfa8ab038c43",
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28331#issuecomment-1744598085",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/28331"
    },
    {
      "event": "commented",
      "id": 1746363314,
      "node_id": "IC_kwDOABII585oF2Oy",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1746363314",
      "actor": {
        "login": "rsantacroce",
        "id": 112706229,
        "node_id": "U_kgDOBrfCtQ",
        "avatar_url": "https://avatars.githubusercontent.com/u/112706229?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/rsantacroce",
        "html_url": "https://github.com/rsantacroce",
        "followers_url": "https://api.github.com/users/rsantacroce/followers",
        "following_url": "https://api.github.com/users/rsantacroce/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/rsantacroce/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/rsantacroce/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/rsantacroce/subscriptions",
        "organizations_url": "https://api.github.com/users/rsantacroce/orgs",
        "repos_url": "https://api.github.com/users/rsantacroce/repos",
        "events_url": "https://api.github.com/users/rsantacroce/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/rsantacroce/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-10-04T08:13:17Z",
      "updated_at": "2023-10-04T08:13:17Z",
      "author_association": "NONE",
      "body": "any clear reason why noise protocol hasn't been considered here ? ",
      "user": {
        "login": "rsantacroce",
        "id": 112706229,
        "node_id": "U_kgDOBrfCtQ",
        "avatar_url": "https://avatars.githubusercontent.com/u/112706229?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/rsantacroce",
        "html_url": "https://github.com/rsantacroce",
        "followers_url": "https://api.github.com/users/rsantacroce/followers",
        "following_url": "https://api.github.com/users/rsantacroce/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/rsantacroce/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/rsantacroce/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/rsantacroce/subscriptions",
        "organizations_url": "https://api.github.com/users/rsantacroce/orgs",
        "repos_url": "https://api.github.com/users/rsantacroce/repos",
        "events_url": "https://api.github.com/users/rsantacroce/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/rsantacroce/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28331#issuecomment-1746363314",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/28331"
    },
    {
      "event": "commented",
      "id": 1746377459,
      "node_id": "IC_kwDOABII585oF5rz",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1746377459",
      "actor": {
        "login": "Sjors",
        "id": 10217,
        "node_id": "MDQ6VXNlcjEwMjE3",
        "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Sjors",
        "html_url": "https://github.com/Sjors",
        "followers_url": "https://api.github.com/users/Sjors/followers",
        "following_url": "https://api.github.com/users/Sjors/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Sjors/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Sjors/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
        "organizations_url": "https://api.github.com/users/Sjors/orgs",
        "repos_url": "https://api.github.com/users/Sjors/repos",
        "events_url": "https://api.github.com/users/Sjors/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Sjors/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-10-04T08:22:16Z",
      "updated_at": "2023-10-04T08:22:16Z",
      "author_association": "MEMBER",
      "body": "@rsantacroce the BIP explains this under \"Why not use a general-purpose transport encryption protocol?\": https://github.com/bitcoin/bips/blob/master/bip-0324.mediawiki",
      "user": {
        "login": "Sjors",
        "id": 10217,
        "node_id": "MDQ6VXNlcjEwMjE3",
        "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Sjors",
        "html_url": "https://github.com/Sjors",
        "followers_url": "https://api.github.com/users/Sjors/followers",
        "following_url": "https://api.github.com/users/Sjors/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Sjors/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Sjors/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
        "organizations_url": "https://api.github.com/users/Sjors/orgs",
        "repos_url": "https://api.github.com/users/Sjors/repos",
        "events_url": "https://api.github.com/users/Sjors/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Sjors/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28331#issuecomment-1746377459",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/28331"
    },
    {
      "event": "mentioned",
      "id": 10547708099,
      "node_id": "MEE_lADOABII585vHSmAzwAAAAJ0sUDD",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10547708099",
      "actor": {
        "login": "rsantacroce",
        "id": 112706229,
        "node_id": "U_kgDOBrfCtQ",
        "avatar_url": "https://avatars.githubusercontent.com/u/112706229?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/rsantacroce",
        "html_url": "https://github.com/rsantacroce",
        "followers_url": "https://api.github.com/users/rsantacroce/followers",
        "following_url": "https://api.github.com/users/rsantacroce/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/rsantacroce/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/rsantacroce/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/rsantacroce/subscriptions",
        "organizations_url": "https://api.github.com/users/rsantacroce/orgs",
        "repos_url": "https://api.github.com/users/rsantacroce/repos",
        "events_url": "https://api.github.com/users/rsantacroce/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/rsantacroce/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-10-04T08:22:17Z"
    },
    {
      "event": "subscribed",
      "id": 10547708117,
      "node_id": "SE_lADOABII585vHSmAzwAAAAJ0sUDV",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10547708117",
      "actor": {
        "login": "rsantacroce",
        "id": 112706229,
        "node_id": "U_kgDOBrfCtQ",
        "avatar_url": "https://avatars.githubusercontent.com/u/112706229?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/rsantacroce",
        "html_url": "https://github.com/rsantacroce",
        "followers_url": "https://api.github.com/users/rsantacroce/followers",
        "following_url": "https://api.github.com/users/rsantacroce/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/rsantacroce/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/rsantacroce/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/rsantacroce/subscriptions",
        "organizations_url": "https://api.github.com/users/rsantacroce/orgs",
        "repos_url": "https://api.github.com/users/rsantacroce/repos",
        "events_url": "https://api.github.com/users/rsantacroce/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/rsantacroce/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-10-04T08:22:17Z"
    },
    {
      "event": "commented",
      "id": 1746398804,
      "node_id": "IC_kwDOABII585oF-5U",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1746398804",
      "actor": {
        "login": "rsantacroce",
        "id": 112706229,
        "node_id": "U_kgDOBrfCtQ",
        "avatar_url": "https://avatars.githubusercontent.com/u/112706229?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/rsantacroce",
        "html_url": "https://github.com/rsantacroce",
        "followers_url": "https://api.github.com/users/rsantacroce/followers",
        "following_url": "https://api.github.com/users/rsantacroce/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/rsantacroce/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/rsantacroce/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/rsantacroce/subscriptions",
        "organizations_url": "https://api.github.com/users/rsantacroce/orgs",
        "repos_url": "https://api.github.com/users/rsantacroce/repos",
        "events_url": "https://api.github.com/users/rsantacroce/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/rsantacroce/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-10-04T08:35:20Z",
      "updated_at": "2023-10-04T08:36:45Z",
      "author_association": "NONE",
      "body": "Thank you, i missed that one! very good explanation now it's the other way around why we don't use it on stratumv2 .... this is for the other repo. thank you and thank you for the great work.",
      "user": {
        "login": "rsantacroce",
        "id": 112706229,
        "node_id": "U_kgDOBrfCtQ",
        "avatar_url": "https://avatars.githubusercontent.com/u/112706229?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/rsantacroce",
        "html_url": "https://github.com/rsantacroce",
        "followers_url": "https://api.github.com/users/rsantacroce/followers",
        "following_url": "https://api.github.com/users/rsantacroce/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/rsantacroce/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/rsantacroce/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/rsantacroce/subscriptions",
        "organizations_url": "https://api.github.com/users/rsantacroce/orgs",
        "repos_url": "https://api.github.com/users/rsantacroce/repos",
        "events_url": "https://api.github.com/users/rsantacroce/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/rsantacroce/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28331#issuecomment-1746398804",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/28331"
    },
    {
      "event": "unsubscribed",
      "id": 10552333413,
      "node_id": "UE_lADOABII585vHSmAzwAAAAJ099Rl",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10552333413",
      "actor": {
        "login": "0xf0xx0",
        "id": 33764485,
        "node_id": "MDQ6VXNlcjMzNzY0NDg1",
        "avatar_url": "https://avatars.githubusercontent.com/u/33764485?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/0xf0xx0",
        "html_url": "https://github.com/0xf0xx0",
        "followers_url": "https://api.github.com/users/0xf0xx0/followers",
        "following_url": "https://api.github.com/users/0xf0xx0/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/0xf0xx0/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/0xf0xx0/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/0xf0xx0/subscriptions",
        "organizations_url": "https://api.github.com/users/0xf0xx0/orgs",
        "repos_url": "https://api.github.com/users/0xf0xx0/repos",
        "events_url": "https://api.github.com/users/0xf0xx0/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/0xf0xx0/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-10-04T15:01:26Z"
    },
    {
      "event": "subscribed",
      "id": 10552333957,
      "node_id": "SE_lADOABII585vHSmAzwAAAAJ099aF",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10552333957",
      "actor": {
        "login": "0xf0xx0",
        "id": 33764485,
        "node_id": "MDQ6VXNlcjMzNzY0NDg1",
        "avatar_url": "https://avatars.githubusercontent.com/u/33764485?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/0xf0xx0",
        "html_url": "https://github.com/0xf0xx0",
        "followers_url": "https://api.github.com/users/0xf0xx0/followers",
        "following_url": "https://api.github.com/users/0xf0xx0/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/0xf0xx0/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/0xf0xx0/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/0xf0xx0/subscriptions",
        "organizations_url": "https://api.github.com/users/0xf0xx0/orgs",
        "repos_url": "https://api.github.com/users/0xf0xx0/repos",
        "events_url": "https://api.github.com/users/0xf0xx0/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/0xf0xx0/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-10-04T15:01:28Z"
    },
    {
      "event": "unsubscribed",
      "id": 10552343854,
      "node_id": "UE_lADOABII585vHSmAzwAAAAJ09_0u",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10552343854",
      "actor": {
        "login": "0xf0xx0",
        "id": 33764485,
        "node_id": "MDQ6VXNlcjMzNzY0NDg1",
        "avatar_url": "https://avatars.githubusercontent.com/u/33764485?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/0xf0xx0",
        "html_url": "https://github.com/0xf0xx0",
        "followers_url": "https://api.github.com/users/0xf0xx0/followers",
        "following_url": "https://api.github.com/users/0xf0xx0/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/0xf0xx0/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/0xf0xx0/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/0xf0xx0/subscriptions",
        "organizations_url": "https://api.github.com/users/0xf0xx0/orgs",
        "repos_url": "https://api.github.com/users/0xf0xx0/repos",
        "events_url": "https://api.github.com/users/0xf0xx0/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/0xf0xx0/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-10-04T15:02:08Z"
    },
    {
      "event": "labeled",
      "id": 10555382190,
      "node_id": "LE_lADOABII585vHSmAzwAAAAJ1Jlmu",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10555382190",
      "actor": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-10-04T20:18:18Z",
      "label": {
        "name": "Needs release note",
        "color": "d2db6d"
      }
    },
    {
      "event": "referenced",
      "id": 10559462535,
      "node_id": "REFE_lADOABII585vHSmAzwAAAAJ1ZJyH",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10559462535",
      "actor": {
        "login": "hebasto",
        "id": 32963518,
        "node_id": "MDQ6VXNlcjMyOTYzNTE4",
        "avatar_url": "https://avatars.githubusercontent.com/u/32963518?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/hebasto",
        "html_url": "https://github.com/hebasto",
        "followers_url": "https://api.github.com/users/hebasto/followers",
        "following_url": "https://api.github.com/users/hebasto/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/hebasto/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/hebasto/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/hebasto/subscriptions",
        "organizations_url": "https://api.github.com/users/hebasto/orgs",
        "repos_url": "https://api.github.com/users/hebasto/repos",
        "events_url": "https://api.github.com/users/hebasto/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/hebasto/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": "0e3de3b83e99c29d4e84ae92894e3a9fedfe7bea",
      "commit_url": "https://api.github.com/repos/bitcoin-core/gui/commits/0e3de3b83e99c29d4e84ae92894e3a9fedfe7bea",
      "created_at": "2023-10-05T07:37:49Z"
    },
    {
      "event": "referenced",
      "id": 10646524478,
      "node_id": "REFE_lADOABII585vHSmAzwAAAAJ6lRI-",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10646524478",
      "actor": {
        "login": "Frank-GER",
        "id": 87550788,
        "node_id": "MDQ6VXNlcjg3NTUwNzg4",
        "avatar_url": "https://avatars.githubusercontent.com/u/87550788?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Frank-GER",
        "html_url": "https://github.com/Frank-GER",
        "followers_url": "https://api.github.com/users/Frank-GER/followers",
        "following_url": "https://api.github.com/users/Frank-GER/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Frank-GER/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Frank-GER/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Frank-GER/subscriptions",
        "organizations_url": "https://api.github.com/users/Frank-GER/orgs",
        "repos_url": "https://api.github.com/users/Frank-GER/repos",
        "events_url": "https://api.github.com/users/Frank-GER/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Frank-GER/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": "95e4527ea076dc56958a3359b29b18106cb31166",
      "commit_url": "https://api.github.com/repos/syscoin/syscoin/commits/95e4527ea076dc56958a3359b29b18106cb31166",
      "created_at": "2023-10-13T17:03:33Z"
    },
    {
      "event": "reviewed",
      "id": 1725109880,
      "node_id": "PRR_kwDOABII585m0xZ4",
      "url": null,
      "actor": null,
      "commit_id": "05d19fbcc10f26c7f1e3a9afc660eb7fa71b1d8c",
      "commit_url": null,
      "created_at": null,
      "author_association": "CONTRIBUTOR",
      "user": {
        "login": "kashifs",
        "id": 1489460,
        "node_id": "MDQ6VXNlcjE0ODk0NjA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1489460?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/kashifs",
        "html_url": "https://github.com/kashifs",
        "followers_url": "https://api.github.com/users/kashifs/followers",
        "following_url": "https://api.github.com/users/kashifs/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/kashifs/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/kashifs/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/kashifs/subscriptions",
        "organizations_url": "https://api.github.com/users/kashifs/orgs",
        "repos_url": "https://api.github.com/users/kashifs/repos",
        "events_url": "https://api.github.com/users/kashifs/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/kashifs/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28331#pullrequestreview-1725109880",
      "submitted_at": "2023-11-10T16:04:29Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28331"
    },
    {
      "event": "referenced",
      "id": 11087755893,
      "node_id": "REFE_lADOABII585vHSmAzwAAAAKU4bp1",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/11087755893",
      "actor": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": "30a055782908702c012bdd5f6a6d41458bf22dfa",
      "commit_url": "https://api.github.com/repos/bitcoin-core/gui/commits/30a055782908702c012bdd5f6a6d41458bf22dfa",
      "created_at": "2023-11-28T19:17:41Z"
    },
    {
      "event": "unlabeled",
      "id": 11181950934,
      "node_id": "UNLE_lADOABII585vHSmAzwAAAAKafwfW",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/11181950934",
      "actor": {
        "login": "fanquake",
        "id": 863730,
        "node_id": "MDQ6VXNlcjg2MzczMA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/863730?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fanquake",
        "html_url": "https://github.com/fanquake",
        "followers_url": "https://api.github.com/users/fanquake/followers",
        "following_url": "https://api.github.com/users/fanquake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fanquake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fanquake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fanquake/subscriptions",
        "organizations_url": "https://api.github.com/users/fanquake/orgs",
        "repos_url": "https://api.github.com/users/fanquake/repos",
        "events_url": "https://api.github.com/users/fanquake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fanquake/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-12-07T13:22:08Z",
      "label": {
        "name": "Needs release note",
        "color": "d2db6d"
      }
    },
    {
      "event": "commented",
      "id": 1845335825,
      "node_id": "IC_kwDOABII585t_ZcR",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1845335825",
      "actor": {
        "login": "fanquake",
        "id": 863730,
        "node_id": "MDQ6VXNlcjg2MzczMA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/863730?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fanquake",
        "html_url": "https://github.com/fanquake",
        "followers_url": "https://api.github.com/users/fanquake/followers",
        "following_url": "https://api.github.com/users/fanquake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fanquake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fanquake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fanquake/subscriptions",
        "organizations_url": "https://api.github.com/users/fanquake/orgs",
        "repos_url": "https://api.github.com/users/fanquake/repos",
        "events_url": "https://api.github.com/users/fanquake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fanquake/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-12-07T13:22:20Z",
      "updated_at": "2023-12-07T13:22:20Z",
      "author_association": "MEMBER",
      "body": "Removing label, as this got a release note.",
      "user": {
        "login": "fanquake",
        "id": 863730,
        "node_id": "MDQ6VXNlcjg2MzczMA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/863730?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fanquake",
        "html_url": "https://github.com/fanquake",
        "followers_url": "https://api.github.com/users/fanquake/followers",
        "following_url": "https://api.github.com/users/fanquake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fanquake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fanquake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fanquake/subscriptions",
        "organizations_url": "https://api.github.com/users/fanquake/orgs",
        "repos_url": "https://api.github.com/users/fanquake/repos",
        "events_url": "https://api.github.com/users/fanquake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fanquake/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28331#issuecomment-1845335825",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/28331"
    },
    {
      "event": "referenced",
      "id": 14575491620,
      "node_id": "REFE_lADOABII585vHSmAzwAAAANkxFok",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/14575491620",
      "actor": {
        "login": "kwvg",
        "id": 63189531,
        "node_id": "MDQ6VXNlcjYzMTg5NTMx",
        "avatar_url": "https://avatars.githubusercontent.com/u/63189531?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/kwvg",
        "html_url": "https://github.com/kwvg",
        "followers_url": "https://api.github.com/users/kwvg/followers",
        "following_url": "https://api.github.com/users/kwvg/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/kwvg/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/kwvg/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/kwvg/subscriptions",
        "organizations_url": "https://api.github.com/users/kwvg/orgs",
        "repos_url": "https://api.github.com/users/kwvg/repos",
        "events_url": "https://api.github.com/users/kwvg/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/kwvg/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": "4917be4905408dad92cccb794b17755fc3e8f162",
      "commit_url": "https://api.github.com/repos/kwvg/dash/commits/4917be4905408dad92cccb794b17755fc3e8f162",
      "created_at": "2024-10-09T15:52:45Z"
    },
    {
      "event": "referenced",
      "id": 14646770064,
      "node_id": "REFE_lADOABII585vHSmAzwAAAANpA_mQ",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/14646770064",
      "actor": {
        "login": "kwvg",
        "id": 63189531,
        "node_id": "MDQ6VXNlcjYzMTg5NTMx",
        "avatar_url": "https://avatars.githubusercontent.com/u/63189531?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/kwvg",
        "html_url": "https://github.com/kwvg",
        "followers_url": "https://api.github.com/users/kwvg/followers",
        "following_url": "https://api.github.com/users/kwvg/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/kwvg/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/kwvg/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/kwvg/subscriptions",
        "organizations_url": "https://api.github.com/users/kwvg/orgs",
        "repos_url": "https://api.github.com/users/kwvg/repos",
        "events_url": "https://api.github.com/users/kwvg/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/kwvg/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": "bb75a29041233070771bc9abdd8dadbb8c8a88a5",
      "commit_url": "https://api.github.com/repos/kwvg/dash/commits/bb75a29041233070771bc9abdd8dadbb8c8a88a5",
      "created_at": "2024-10-14T22:04:05Z"
    },
    {
      "event": "referenced",
      "id": 14655728159,
      "node_id": "REFE_lADOABII585vHSmAzwAAAANpjKof",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/14655728159",
      "actor": {
        "login": "kwvg",
        "id": 63189531,
        "node_id": "MDQ6VXNlcjYzMTg5NTMx",
        "avatar_url": "https://avatars.githubusercontent.com/u/63189531?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/kwvg",
        "html_url": "https://github.com/kwvg",
        "followers_url": "https://api.github.com/users/kwvg/followers",
        "following_url": "https://api.github.com/users/kwvg/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/kwvg/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/kwvg/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/kwvg/subscriptions",
        "organizations_url": "https://api.github.com/users/kwvg/orgs",
        "repos_url": "https://api.github.com/users/kwvg/repos",
        "events_url": "https://api.github.com/users/kwvg/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/kwvg/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": "a4dcbee18cf09047c4fdccbc8037761450db1caf",
      "commit_url": "https://api.github.com/repos/kwvg/dash/commits/a4dcbee18cf09047c4fdccbc8037761450db1caf",
      "created_at": "2024-10-15T11:24:15Z"
    },
    {
      "event": "referenced",
      "id": 14660024317,
      "node_id": "REFE_lADOABII585vHSmAzwAAAANpzjf9",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/14660024317",
      "actor": {
        "login": "kwvg",
        "id": 63189531,
        "node_id": "MDQ6VXNlcjYzMTg5NTMx",
        "avatar_url": "https://avatars.githubusercontent.com/u/63189531?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/kwvg",
        "html_url": "https://github.com/kwvg",
        "followers_url": "https://api.github.com/users/kwvg/followers",
        "following_url": "https://api.github.com/users/kwvg/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/kwvg/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/kwvg/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/kwvg/subscriptions",
        "organizations_url": "https://api.github.com/users/kwvg/orgs",
        "repos_url": "https://api.github.com/users/kwvg/repos",
        "events_url": "https://api.github.com/users/kwvg/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/kwvg/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": "ff92d1adaeba7f334502e9b3df806bbce52bc487",
      "commit_url": "https://api.github.com/repos/kwvg/dash/commits/ff92d1adaeba7f334502e9b3df806bbce52bc487",
      "created_at": "2024-10-15T15:34:27Z"
    },
    {
      "event": "referenced",
      "id": 14684592748,
      "node_id": "REFE_lADOABII585vHSmAzwAAAANrRRps",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/14684592748",
      "actor": {
        "login": "PastaPastaPasta",
        "id": 6443210,
        "node_id": "MDQ6VXNlcjY0NDMyMTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6443210?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/PastaPastaPasta",
        "html_url": "https://github.com/PastaPastaPasta",
        "followers_url": "https://api.github.com/users/PastaPastaPasta/followers",
        "following_url": "https://api.github.com/users/PastaPastaPasta/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/PastaPastaPasta/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/PastaPastaPasta/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/PastaPastaPasta/subscriptions",
        "organizations_url": "https://api.github.com/users/PastaPastaPasta/orgs",
        "repos_url": "https://api.github.com/users/PastaPastaPasta/repos",
        "events_url": "https://api.github.com/users/PastaPastaPasta/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/PastaPastaPasta/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": "5903fb7898db99130da53a0c5dde264e12c22ab1",
      "commit_url": "https://api.github.com/repos/dashpay/dash/commits/5903fb7898db99130da53a0c5dde264e12c22ab1",
      "created_at": "2024-10-16T16:49:00Z"
    },
    {
      "event": "referenced",
      "id": 15773060760,
      "node_id": "REFE_lADOABII585vHSmAzwAAAAOsJc6Y",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/15773060760",
      "actor": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": "f95fb793726b67becd55599553bd2bb35eeee70b",
      "commit_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/f95fb793726b67becd55599553bd2bb35eeee70b",
      "created_at": "2024-12-27T14:09:37Z"
    },
    {
      "event": "locked",
      "id": 17746620550,
      "node_id": "LOE_lADOABII585vHSmAzwAAAAQhx_CG",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/17746620550",
      "actor": {
        "login": "bitcoin",
        "id": 528860,
        "node_id": "MDEyOk9yZ2FuaXphdGlvbjUyODg2MA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/528860?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/bitcoin",
        "html_url": "https://github.com/bitcoin",
        "followers_url": "https://api.github.com/users/bitcoin/followers",
        "following_url": "https://api.github.com/users/bitcoin/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/bitcoin/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/bitcoin/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/bitcoin/subscriptions",
        "organizations_url": "https://api.github.com/users/bitcoin/orgs",
        "repos_url": "https://api.github.com/users/bitcoin/repos",
        "events_url": "https://api.github.com/users/bitcoin/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/bitcoin/received_events",
        "type": "Organization",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-05-21T06:09:20Z"
    }
  ],
  "comments": [
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1321845616",
      "pull_request_review_id": 1620466774,
      "id": 1321845616,
      "node_id": "PRRC_kwDOABII585OycNw",
      "diff_hunk": "@@ -291,6 +291,9 @@ enum ServiceFlags : uint64_t {\n     // See BIP159 for details on how this is implemented.\n     NODE_NETWORK_LIMITED = (1 << 10),\n \n+    // NODE_P2P_V2 means the node supports BIP324 transport\n+    NODE_P2P_V2 = (1 << 11),",
      "path": "src/protocol.h",
      "position": 5,
      "original_position": 5,
      "commit_id": "75a329103505736acb9036224da2dfa8ab038c43",
      "original_commit_id": "1768aff56d6feedcb22b21df12e8926924fdac6a",
      "in_reply_to_id": null,
      "user": {
        "login": "theStack",
        "id": 91535,
        "node_id": "MDQ6VXNlcjkxNTM1",
        "avatar_url": "https://avatars.githubusercontent.com/u/91535?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theStack",
        "html_url": "https://github.com/theStack",
        "followers_url": "https://api.github.com/users/theStack/followers",
        "following_url": "https://api.github.com/users/theStack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theStack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theStack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theStack/subscriptions",
        "organizations_url": "https://api.github.com/users/theStack/orgs",
        "repos_url": "https://api.github.com/users/theStack/repos",
        "events_url": "https://api.github.com/users/theStack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theStack/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "in commit 1768aff56d6feedcb22b21df12e8926924fdac6a: this flag should also be added to the `ALL_SERVICE_FLAGS` array in `test/util/net.h`, I guess (used by fuzz tests):\r\nhttps://github.com/bitcoin/bitcoin/blob/8f7b9eb8711fdb32e8bdb59d2a7462a46c7a8086/src/test/util/net.h#L61-L68",
      "created_at": "2023-09-11T17:12:07Z",
      "updated_at": "2023-09-11T17:21:08Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28331#discussion_r1321845616",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1321845616"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28331"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 295,
      "original_line": 295,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1321852444",
      "pull_request_review_id": 1620466774,
      "id": 1321852444,
      "node_id": "PRRC_kwDOABII585Oyd4c",
      "diff_hunk": "@@ -0,0 +1,91 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2022 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"\n+Test BIP324 v2 transport\n+\"\"\"\n+\n+from test_framework.test_framework import BitcoinTestFramework\n+from test_framework.util import assert_equal\n+\n+class P2PV2Test(BitcoinTestFramework):\n+    def set_test_params(self):\n+        self.setup_clean_chain = True\n+        self.num_nodes = 5\n+        self.extra_args = [[\"-v2transport=1\"], [\"-v2transport=1\"], [\"-v2transport=0\"], [\"-v2transport=0\"], [\"-v2transport=0\"]]\n+\n+    def run_test(self):\n+        sending_handshake = \"start sending v2 handshake to peer\"\n+        downgrading_to_v1 = \"retrying with v1 transport protocol for peer\"\n+        self.disconnect_nodes(0, 1)\n+        self.disconnect_nodes(1, 2)\n+        self.disconnect_nodes(2, 3)\n+        self.disconnect_nodes(3, 4)\n+\n+        # V2 nodes can sync with V2 nodes\n+        assert_equal(self.nodes[0].getblockcount(), 0)\n+        assert_equal(self.nodes[1].getblockcount(), 0)\n+        self.nodes[0].generatetoaddress(5, \"bcrt1q0yq2azut8gn2xu3y2g0xucf8pny6w8uxmyf220\", invalid_call=False)\n+        assert_equal(self.nodes[0].getblockcount(), 5)\n+        assert_equal(self.nodes[1].getblockcount(), 0)\n+        with self.nodes[0].assert_debug_log(expected_msgs=[sending_handshake],\n+                                            unexpected_msgs=[downgrading_to_v1]):\n+            self.connect_nodes(0, 1, True)\n+        # sync_all() verifies that the block tips match\n+        self.sync_all(self.nodes[0:2])",
      "path": "test/functional/p2p_v2.py",
      "position": null,
      "original_position": 36,
      "commit_id": "75a329103505736acb9036224da2dfa8ab038c43",
      "original_commit_id": "be8a5dcddd36be8a5f137baf3ebd32d590a0747d",
      "in_reply_to_id": null,
      "user": {
        "login": "theStack",
        "id": 91535,
        "node_id": "MDQ6VXNlcjkxNTM1",
        "avatar_url": "https://avatars.githubusercontent.com/u/91535?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theStack",
        "html_url": "https://github.com/theStack",
        "followers_url": "https://api.github.com/users/theStack/followers",
        "following_url": "https://api.github.com/users/theStack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theStack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theStack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theStack/subscriptions",
        "organizations_url": "https://api.github.com/users/theStack/orgs",
        "repos_url": "https://api.github.com/users/theStack/repos",
        "events_url": "https://api.github.com/users/theStack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theStack/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "in commit be8a5dcddd36be8a5f137baf3ebd32d590a0747d: Somewhere around here it might make sense to verify that v2 is indeed used by checking the new `getpeerinfo` fields (\"transport_protocol_type\" and \"session_id\") for nodes 0 and 1.",
      "created_at": "2023-09-11T17:19:13Z",
      "updated_at": "2023-09-11T17:21:08Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28331#discussion_r1321852444",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1321852444"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28331"
        }
      },
      "start_line": null,
      "original_start_line": 35,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 36,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1322583238",
      "pull_request_review_id": 1621530741,
      "id": 1322583238,
      "node_id": "PRRC_kwDOABII585O1QTG",
      "diff_hunk": "@@ -309,17 +320,21 @@ static RPCHelpMan addnode()\n     CConnman& connman = EnsureConnman(node);\n \n     std::string strNode = request.params[0].get_str();\n+    bool use_p2p_v2 = !request.params[2].isNull() && request.params[2].get_bool();",
      "path": "src/rpc/net.cpp",
      "position": null,
      "original_position": 50,
      "commit_id": "75a329103505736acb9036224da2dfa8ab038c43",
      "original_commit_id": "2aabbdf4de01ef1a3fb0c1bb86ef163c9fba587b",
      "in_reply_to_id": null,
      "user": {
        "login": "maflcko",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/maflcko",
        "html_url": "https://github.com/maflcko",
        "followers_url": "https://api.github.com/users/maflcko/followers",
        "following_url": "https://api.github.com/users/maflcko/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/maflcko/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/maflcko/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/maflcko/subscriptions",
        "organizations_url": "https://api.github.com/users/maflcko/orgs",
        "repos_url": "https://api.github.com/users/maflcko/repos",
        "events_url": "https://api.github.com/users/maflcko/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/maflcko/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "nit: Not really a fan of hard-coding default value in the code syntax. If the default was changed, this would require changing the code syntax. It would be better to hard-code the default value itself. Even best would be to not hard-code anything anywhere, which should be possible with `self.Arg<bool>(2)`, or similar.",
      "created_at": "2023-09-12T07:39:36Z",
      "updated_at": "2023-09-12T08:02:43Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28331#discussion_r1322583238",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1322583238"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28331"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 323,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1322591734",
      "pull_request_review_id": 1621530741,
      "id": 1322591734,
      "node_id": "PRRC_kwDOABII585O1SX2",
      "diff_hunk": "@@ -465,7 +465,11 @@ CNode* CConnman::ConnectNode(CAddress addrConnect, const char *pszDest, bool fCo\n         }\n     }\n \n-    LogPrintLevel(BCLog::NET, BCLog::Level::Debug, \"trying connection %s lastseen=%.1fhrs\\n\",\n+    // Use v2 transport when both us and them signal NODE_P2P_V2.\n+    const bool use_p2p_v2 = !!(addrConnect.nServices & GetLocalServices() & NODE_P2P_V2);",
      "path": "src/net.cpp",
      "position": null,
      "original_position": 6,
      "commit_id": "75a329103505736acb9036224da2dfa8ab038c43",
      "original_commit_id": "2aabbdf4de01ef1a3fb0c1bb86ef163c9fba587b",
      "in_reply_to_id": null,
      "user": {
        "login": "maflcko",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/maflcko",
        "html_url": "https://github.com/maflcko",
        "followers_url": "https://api.github.com/users/maflcko/followers",
        "following_url": "https://api.github.com/users/maflcko/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/maflcko/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/maflcko/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/maflcko/subscriptions",
        "organizations_url": "https://api.github.com/users/maflcko/orgs",
        "repos_url": "https://api.github.com/users/maflcko/repos",
        "events_url": "https://api.github.com/users/maflcko/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/maflcko/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "```suggestion\r\n    const bool use_p2p_v2(addrConnect.nServices & GetLocalServices() & NODE_P2P_V2);\r\n```\r\n\r\nnit: Can be written shorter",
      "created_at": "2023-09-12T07:46:51Z",
      "updated_at": "2023-09-12T08:02:43Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28331#discussion_r1322591734",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1322591734"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28331"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 469,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1322592221",
      "pull_request_review_id": 1621530741,
      "id": 1322592221,
      "node_id": "PRRC_kwDOABII585O1Sfd",
      "diff_hunk": "@@ -1822,6 +1894,10 @@ void CConnman::CreateNodeFromAcceptedSocket(std::unique_ptr<Sock>&& sock,\n     }\n \n     const bool inbound_onion = std::find(m_onion_binds.begin(), m_onion_binds.end(), addr_bind) != m_onion_binds.end();\n+    // The V2Transport transparently falls back to V1 behavior when an incoming V1 connection is\n+    // detected, so use it whenever we signal NODE_P2P_V2.\n+    const bool use_p2p_v2 = !!(nodeServices & NODE_P2P_V2);",
      "path": "src/net.cpp",
      "position": null,
      "original_position": 198,
      "commit_id": "75a329103505736acb9036224da2dfa8ab038c43",
      "original_commit_id": "2aabbdf4de01ef1a3fb0c1bb86ef163c9fba587b",
      "in_reply_to_id": null,
      "user": {
        "login": "maflcko",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/maflcko",
        "html_url": "https://github.com/maflcko",
        "followers_url": "https://api.github.com/users/maflcko/followers",
        "following_url": "https://api.github.com/users/maflcko/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/maflcko/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/maflcko/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/maflcko/subscriptions",
        "organizations_url": "https://api.github.com/users/maflcko/orgs",
        "repos_url": "https://api.github.com/users/maflcko/repos",
        "events_url": "https://api.github.com/users/maflcko/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/maflcko/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "Same",
      "created_at": "2023-09-12T07:47:13Z",
      "updated_at": "2023-09-12T08:02:43Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28331#discussion_r1322592221",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1322592221"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28331"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1899,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1322606364",
      "pull_request_review_id": 1621530741,
      "id": 1322606364,
      "node_id": "PRRC_kwDOABII585O1V8c",
      "diff_hunk": "@@ -581,26 +586,50 @@ def restart_node(self, i, extra_args=None):\n     def wait_for_node_exit(self, i, timeout):\n         self.nodes[i].process.wait(timeout)\n \n-    def connect_nodes(self, a, b):\n+    def connect_nodes(self, a, b, peer_advertises_v2=None):\n         from_connection = self.nodes[a]\n         to_connection = self.nodes[b]\n         from_num_peers = 1 + len(from_connection.getpeerinfo())\n         to_num_peers = 1 + len(to_connection.getpeerinfo())\n         ip_port = \"127.0.0.1:\" + str(p2p_port(b))\n-        from_connection.addnode(ip_port, \"onetry\")\n+\n+        if peer_advertises_v2 is None:\n+            peer_advertises_v2 = self.options.v2transport\n+\n+        if peer_advertises_v2:\n+            from_connection.addnode(ip_port, \"onetry\", True)\n+        else:\n+            # skip the optional third argument (default false) for\n+            # compatibility with older clients\n+            from_connection.addnode(ip_port, \"onetry\")\n+\n+        min_verack_msg_bytes = 21 if peer_advertises_v2 else 24\n         # poll until version handshake complete to avoid race conditions\n         # with transaction relaying\n         # See comments in net_processing:\n         # * Must have a version message before anything else\n         # * Must have a verack message before anything else\n-        self.wait_until(lambda: sum(peer['version'] != 0 for peer in from_connection.getpeerinfo()) == from_num_peers)\n-        self.wait_until(lambda: sum(peer['version'] != 0 for peer in to_connection.getpeerinfo()) == to_num_peers)\n-        self.wait_until(lambda: sum(peer['bytesrecv_per_msg'].pop('verack', 0) == 24 for peer in from_connection.getpeerinfo()) == from_num_peers)\n-        self.wait_until(lambda: sum(peer['bytesrecv_per_msg'].pop('verack', 0) == 24 for peer in to_connection.getpeerinfo()) == to_num_peers)\n-        # The message bytes are counted before processing the message, so make\n-        # sure it was fully processed by waiting for a ping.\n-        self.wait_until(lambda: sum(peer[\"bytesrecv_per_msg\"].pop(\"pong\", 0) >= 32 for peer in from_connection.getpeerinfo()) == from_num_peers)\n-        self.wait_until(lambda: sum(peer[\"bytesrecv_per_msg\"].pop(\"pong\", 0) >= 32 for peer in to_connection.getpeerinfo()) == to_num_peers)\n+        # * The message bytes are counted before processing the message, so make\n+        #   sure it was fully processed by waiting for a ping.\n+\n+        def check_initiator_handshake():\n+            peerinfo = from_connection.getpeerinfo()\n+            if len(peerinfo) != from_num_peers:\n+                return False\n+\n+            responder = list(filter(lambda x: x[\"addr\"] == ip_port, peerinfo))[0]\n+            return responder['version'] != 0 and responder['bytesrecv_per_msg'].pop('verack', 0) >= min_verack_msg_bytes and responder['bytesrecv_per_msg'].pop(\"pong\", 0) >= 29\n+\n+        def check_responder_handshake():\n+            peerinfo = to_connection.getpeerinfo()\n+            if len(peerinfo) != to_num_peers:\n+                return False\n+\n+            initiator = list(filter(lambda x: x[\"addrbind\"] == ip_port, peerinfo))[0]\n+            return initiator['version'] != 0 and initiator['bytesrecv_per_msg'].pop('verack', 0) >= min_verack_msg_bytes and initiator['bytesrecv_per_msg'].pop(\"pong\", 0) >= 29\n+\n+        self.wait_until(check_initiator_handshake)\n+        self.wait_until(check_responder_handshake)",
      "path": "test/functional/test_framework/test_framework.py",
      "position": null,
      "original_position": 85,
      "commit_id": "75a329103505736acb9036224da2dfa8ab038c43",
      "original_commit_id": "2aabbdf4de01ef1a3fb0c1bb86ef163c9fba587b",
      "in_reply_to_id": null,
      "user": {
        "login": "maflcko",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/maflcko",
        "html_url": "https://github.com/maflcko",
        "followers_url": "https://api.github.com/users/maflcko/followers",
        "following_url": "https://api.github.com/users/maflcko/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/maflcko/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/maflcko/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/maflcko/subscriptions",
        "organizations_url": "https://api.github.com/users/maflcko/orgs",
        "repos_url": "https://api.github.com/users/maflcko/repos",
        "events_url": "https://api.github.com/users/maflcko/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/maflcko/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "q in be8a5dcddd36be8a5f137baf3ebd32d590a0747d: Is it required to re-write the logic here? Seems a smaller diff would be to  replace `24` and `32`?",
      "created_at": "2023-09-12T07:55:29Z",
      "updated_at": "2023-09-12T08:02:43Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28331#discussion_r1322606364",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1322606364"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28331"
        }
      },
      "start_line": null,
      "original_start_line": 612,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 632,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1322610190",
      "pull_request_review_id": 1621530741,
      "id": 1322610190,
      "node_id": "PRRC_kwDOABII585O1W4O",
      "diff_hunk": "@@ -0,0 +1,32 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2021 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"\n+Test v2 transport\n+\"\"\"\n+\n+from test_framework.messages import NODE_P2P_V2\n+from test_framework.test_framework import BitcoinTestFramework\n+from test_framework.util import assert_equal\n+\n+class V2TransportTest(BitcoinTestFramework):\n+    def set_test_params(self):\n+        self.setup_clean_chain=True\n+        self.num_nodes = 1\n+        self.extra_args = [[\"-v2transport=0\"]]\n+\n+    def run_test(self):\n+        network_info = self.nodes[0].getnetworkinfo()\n+        assert_equal(int(network_info[\"localservices\"], 16) & NODE_P2P_V2, 0)\n+        if \"P2P_V2\" in network_info[\"localservicesnames\"]:\n+            raise AssertionError(\"Did not expect P2P_V2 to be signaled for a v1 node\")",
      "path": "test/functional/p2p_v2_transport.py",
      "position": null,
      "original_position": 23,
      "commit_id": "75a329103505736acb9036224da2dfa8ab038c43",
      "original_commit_id": "2aabbdf4de01ef1a3fb0c1bb86ef163c9fba587b",
      "in_reply_to_id": null,
      "user": {
        "login": "maflcko",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/maflcko",
        "html_url": "https://github.com/maflcko",
        "followers_url": "https://api.github.com/users/maflcko/followers",
        "following_url": "https://api.github.com/users/maflcko/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/maflcko/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/maflcko/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/maflcko/subscriptions",
        "organizations_url": "https://api.github.com/users/maflcko/orgs",
        "repos_url": "https://api.github.com/users/maflcko/repos",
        "events_url": "https://api.github.com/users/maflcko/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/maflcko/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "```suggestion\r\n        assert \"P2P_V2\" in network_info[\"localservicesnames\"]\r\n            \r\n```\r\n\r\nnit: Can be written shorter? Also, the full test can be removed and the two checks can be added to the p2p_v2.py test? This avoids having to spin up a node twice to call a single RPC each time.",
      "created_at": "2023-09-12T07:58:42Z",
      "updated_at": "2023-09-12T08:02:43Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28331#discussion_r1322610190",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1322610190"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28331"
        }
      },
      "start_line": null,
      "original_start_line": 22,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 23,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1322611559",
      "pull_request_review_id": 1621530741,
      "id": 1322611559,
      "node_id": "PRRC_kwDOABII585O1XNn",
      "diff_hunk": "@@ -0,0 +1,91 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2022 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"\n+Test BIP324 v2 transport\n+\"\"\"\n+\n+from test_framework.test_framework import BitcoinTestFramework\n+from test_framework.util import assert_equal\n+\n+class P2PV2Test(BitcoinTestFramework):\n+    def set_test_params(self):\n+        self.setup_clean_chain = True\n+        self.num_nodes = 5\n+        self.extra_args = [[\"-v2transport=1\"], [\"-v2transport=1\"], [\"-v2transport=0\"], [\"-v2transport=0\"], [\"-v2transport=0\"]]\n+\n+    def run_test(self):\n+        sending_handshake = \"start sending v2 handshake to peer\"\n+        downgrading_to_v1 = \"retrying with v1 transport protocol for peer\"\n+        self.disconnect_nodes(0, 1)\n+        self.disconnect_nodes(1, 2)\n+        self.disconnect_nodes(2, 3)\n+        self.disconnect_nodes(3, 4)\n+\n+        # V2 nodes can sync with V2 nodes\n+        assert_equal(self.nodes[0].getblockcount(), 0)\n+        assert_equal(self.nodes[1].getblockcount(), 0)\n+        self.nodes[0].generatetoaddress(5, \"bcrt1q0yq2azut8gn2xu3y2g0xucf8pny6w8uxmyf220\", invalid_call=False)\n+        assert_equal(self.nodes[0].getblockcount(), 5)\n+        assert_equal(self.nodes[1].getblockcount(), 0)\n+        with self.nodes[0].assert_debug_log(expected_msgs=[sending_handshake],\n+                                            unexpected_msgs=[downgrading_to_v1]):\n+            self.connect_nodes(0, 1, True)\n+        # sync_all() verifies that the block tips match\n+        self.sync_all(self.nodes[0:2])\n+        assert_equal(self.nodes[1].getblockcount(), 5)\n+\n+        # V1 nodes can sync with each other\n+        assert_equal(self.nodes[2].getblockcount(), 0)\n+        assert_equal(self.nodes[3].getblockcount(), 0)\n+        self.nodes[2].generatetoaddress(8, \"bcrt1qyr5lnc2g8aa3qa9c4th9d46n5uu4y0m9nvq2cv\", invalid_call=False)\n+        assert_equal(self.nodes[2].getblockcount(), 8)\n+        assert_equal(self.nodes[3].getblockcount(), 0)\n+        with self.nodes[2].assert_debug_log(expected_msgs=[],\n+                                            unexpected_msgs=[sending_handshake, downgrading_to_v1]):\n+            self.connect_nodes(2, 3, False)\n+        self.sync_all(self.nodes[2:4])\n+        assert_equal(self.nodes[3].getblockcount(), 8)\n+        assert self.nodes[0].getbestblockhash() != self.nodes[2].getbestblockhash()\n+\n+        # V1 nodes can sync with V2 nodes\n+        self.disconnect_nodes(0, 1)\n+        self.disconnect_nodes(2, 3)\n+        with self.nodes[2].assert_debug_log(expected_msgs=[],\n+                                            unexpected_msgs=[sending_handshake, downgrading_to_v1]):\n+            self.connect_nodes(2, 1, True)\n+        self.sync_all(self.nodes[1:3])\n+        assert_equal(self.nodes[1].getblockcount(), 8)\n+        assert self.nodes[0].getbestblockhash() != self.nodes[1].getbestblockhash()\n+\n+        # V2 nodes can sync with V1 nodes\n+        self.disconnect_nodes(1, 2)\n+        with self.nodes[0].assert_debug_log(expected_msgs=[],\n+                                            unexpected_msgs=[sending_handshake, downgrading_to_v1]):\n+            self.connect_nodes(0, 3, False)\n+        self.sync_all([self.nodes[0], self.nodes[3]])\n+        assert_equal(self.nodes[0].getblockcount(), 8)\n+\n+        # V2 node mines another block and everyone gets it\n+        self.connect_nodes(0, 1, True)\n+        self.connect_nodes(1, 2, False)\n+        self.nodes[1].generatetoaddress(1, \"bcrt1q3zsxn3qx0cqyyxgv90k7j6786mpe543wc4vy2v\", invalid_call=False)\n+        self.sync_all(self.nodes[0:4])\n+        assert_equal(self.nodes[0].getblockcount(), 9) # sync_all() verifies tip hashes match\n+\n+        # V1 node mines another block and everyone gets it\n+        self.nodes[3].generatetoaddress(2, \"bcrt1q3zsxn3qx0cqyyxgv90k7j6786mpe543wc4vy2v\", invalid_call=False)",
      "path": "test/functional/p2p_v2.py",
      "position": null,
      "original_position": 78,
      "commit_id": "75a329103505736acb9036224da2dfa8ab038c43",
      "original_commit_id": "2aabbdf4de01ef1a3fb0c1bb86ef163c9fba587b",
      "in_reply_to_id": null,
      "user": {
        "login": "maflcko",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/maflcko",
        "html_url": "https://github.com/maflcko",
        "followers_url": "https://api.github.com/users/maflcko/followers",
        "following_url": "https://api.github.com/users/maflcko/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/maflcko/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/maflcko/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/maflcko/subscriptions",
        "organizations_url": "https://api.github.com/users/maflcko/orgs",
        "repos_url": "https://api.github.com/users/maflcko/repos",
        "events_url": "https://api.github.com/users/maflcko/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/maflcko/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "nit: The call is \"invalid\". `self.generate...` would be more valid.",
      "created_at": "2023-09-12T07:59:52Z",
      "updated_at": "2023-09-12T08:04:24Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28331#discussion_r1322611559",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1322611559"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28331"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 78,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1322613818",
      "pull_request_review_id": 1621530741,
      "id": 1322613818,
      "node_id": "PRRC_kwDOABII585O1Xw6",
      "diff_hunk": "@@ -581,26 +586,50 @@ def restart_node(self, i, extra_args=None):\n     def wait_for_node_exit(self, i, timeout):\n         self.nodes[i].process.wait(timeout)\n \n-    def connect_nodes(self, a, b):\n+    def connect_nodes(self, a, b, peer_advertises_v2=None):",
      "path": "test/functional/test_framework/test_framework.py",
      "position": null,
      "original_position": 33,
      "commit_id": "75a329103505736acb9036224da2dfa8ab038c43",
      "original_commit_id": "2aabbdf4de01ef1a3fb0c1bb86ef163c9fba587b",
      "in_reply_to_id": null,
      "user": {
        "login": "maflcko",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/maflcko",
        "html_url": "https://github.com/maflcko",
        "followers_url": "https://api.github.com/users/maflcko/followers",
        "following_url": "https://api.github.com/users/maflcko/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/maflcko/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/maflcko/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/maflcko/subscriptions",
        "organizations_url": "https://api.github.com/users/maflcko/orgs",
        "repos_url": "https://api.github.com/users/maflcko/repos",
        "events_url": "https://api.github.com/users/maflcko/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/maflcko/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "```suggestion\r\n    def connect_nodes(self, a, b, *, peer_advertises_v2=None):\r\n```\r\n\r\noptional integral types should use named arguments",
      "created_at": "2023-09-12T08:01:44Z",
      "updated_at": "2023-09-12T08:02:43Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28331#discussion_r1322613818",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1322613818"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28331"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 589,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1324997532",
      "pull_request_review_id": 1625319787,
      "id": 1324997532,
      "node_id": "PRRC_kwDOABII585O-duc",
      "diff_hunk": "@@ -1077,7 +1081,11 @@ class CConnman\n         vWhitelistedRange = connOptions.vWhitelistedRange;\n         {\n             LOCK(m_added_nodes_mutex);\n-            m_added_nodes = connOptions.m_added_nodes;\n+\n+            for (const std::string& strAddedNode : connOptions.m_added_nodes) {\n+                // -addnode cli arg does not currently have a way to signal BIP324 support",
      "path": "src/net.h",
      "position": 121,
      "original_position": 24,
      "commit_id": "75a329103505736acb9036224da2dfa8ab038c43",
      "original_commit_id": "1fa8efaff73bda19b7e8f2e27d24b08ccf0de764",
      "in_reply_to_id": null,
      "user": {
        "login": "Sjors",
        "id": 10217,
        "node_id": "MDQ6VXNlcjEwMjE3",
        "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Sjors",
        "html_url": "https://github.com/Sjors",
        "followers_url": "https://api.github.com/users/Sjors/followers",
        "following_url": "https://api.github.com/users/Sjors/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Sjors/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Sjors/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
        "organizations_url": "https://api.github.com/users/Sjors/orgs",
        "repos_url": "https://api.github.com/users/Sjors/repos",
        "events_url": "https://api.github.com/users/Sjors/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Sjors/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "1fa8efaff73bda19b7e8f2e27d24b08ccf0de764: we could add something like a `-addnodev2` cli arg and then use `.m_added_v2_nodes`?\r\n\r\nAlternatively can we look the node up in our known addresses and use whatever the service flag says?",
      "created_at": "2023-09-13T19:44:39Z",
      "updated_at": "2023-09-13T20:12:55Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28331#discussion_r1324997532",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1324997532"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28331"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 1113,
      "original_line": 1113,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1325007449",
      "pull_request_review_id": 1625319787,
      "id": 1325007449,
      "node_id": "PRRC_kwDOABII585O-gJZ",
      "diff_hunk": "@@ -309,25 +309,33 @@ class CSemaphore\n     int value;\n \n public:\n-    explicit CSemaphore(int init) : value(init) {}\n+    explicit CSemaphore(int init) noexcept : value(init) {}",
      "path": "src/sync.h",
      "position": 16,
      "original_position": 5,
      "commit_id": "75a329103505736acb9036224da2dfa8ab038c43",
      "original_commit_id": "8672b854fb7a81a400150ef09e99a06c829b68f8",
      "in_reply_to_id": null,
      "user": {
        "login": "Sjors",
        "id": 10217,
        "node_id": "MDQ6VXNlcjEwMjE3",
        "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Sjors",
        "html_url": "https://github.com/Sjors",
        "followers_url": "https://api.github.com/users/Sjors/followers",
        "following_url": "https://api.github.com/users/Sjors/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Sjors/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Sjors/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
        "organizations_url": "https://api.github.com/users/Sjors/orgs",
        "repos_url": "https://api.github.com/users/Sjors/repos",
        "events_url": "https://api.github.com/users/Sjors/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Sjors/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "8672b854fb7a81a400150ef09e99a06c829b68f8: can you add some documentation for what this class is?",
      "created_at": "2023-09-13T19:49:59Z",
      "updated_at": "2023-09-13T20:12:55Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28331#discussion_r1325007449",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1325007449"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28331"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 316,
      "original_line": 316,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1325029773",
      "pull_request_review_id": 1625319787,
      "id": 1325029773,
      "node_id": "PRRC_kwDOABII585O-lmN",
      "diff_hunk": "@@ -189,6 +189,8 @@ def parse_args(self):\n         parser.add_argument(\"--randomseed\", type=int,\n                             help=\"set a random seed for deterministically reproducing a previous test run\")\n         parser.add_argument(\"--timeout-factor\", dest=\"timeout_factor\", type=float, help=\"adjust test timeouts by a factor. Setting it to 0 disables all timeouts\")\n+        parser.add_argument(\"--v2transport\", dest=\"v2transport\", default=False, action=\"store_true\",",
      "path": "test/functional/test_framework/test_framework.py",
      "position": 4,
      "original_position": 4,
      "commit_id": "75a329103505736acb9036224da2dfa8ab038c43",
      "original_commit_id": "2aabbdf4de01ef1a3fb0c1bb86ef163c9fba587b",
      "in_reply_to_id": null,
      "user": {
        "login": "Sjors",
        "id": 10217,
        "node_id": "MDQ6VXNlcjEwMjE3",
        "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Sjors",
        "html_url": "https://github.com/Sjors",
        "followers_url": "https://api.github.com/users/Sjors/followers",
        "following_url": "https://api.github.com/users/Sjors/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Sjors/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Sjors/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
        "organizations_url": "https://api.github.com/users/Sjors/orgs",
        "repos_url": "https://api.github.com/users/Sjors/repos",
        "events_url": "https://api.github.com/users/Sjors/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Sjors/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "2aabbdf4de01ef1a3fb0c1bb86ef163c9fba587b Nice! Only three tests fail when I enable this for _all_ tests:\r\n* p2p_node_network_limited.py\r\n* p2p_timeouts.py\r\n* rpc_net.py",
      "created_at": "2023-09-13T20:12:04Z",
      "updated_at": "2023-09-13T20:12:55Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28331#discussion_r1325029773",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1325029773"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28331"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 192,
      "original_line": 192,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1325042158",
      "pull_request_review_id": 1625394283,
      "id": 1325042158,
      "node_id": "PRRC_kwDOABII585O-onu",
      "diff_hunk": "@@ -3392,22 +3504,22 @@ std::vector<CAddress> CConnman::GetAddresses(CNode& requestor, size_t max_addres\n     return cache_entry.m_addrs_response_cache;\n }\n \n-bool CConnman::AddNode(const std::string& strNode)\n+bool CConnman::AddNode(const AddedNodeParams& added_node_params)\n {\n     LOCK(m_added_nodes_mutex);\n-    for (const std::string& it : m_added_nodes) {\n-        if (strNode == it) return false;\n+    for (const auto& it : m_added_nodes) {\n+        if (added_node_params.m_added_node == it.m_added_node) return false;\n     }\n \n-    m_added_nodes.push_back(strNode);\n+    m_added_nodes.push_back(added_node_params);",
      "path": "src/net.cpp",
      "position": null,
      "original_position": 361,
      "commit_id": "75a329103505736acb9036224da2dfa8ab038c43",
      "original_commit_id": "2aabbdf4de01ef1a3fb0c1bb86ef163c9fba587b",
      "in_reply_to_id": null,
      "user": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "Note that both the `AddNode()` and `RemoveAddedNode()` methods become one-liners with the change in [`7caaa9e` (#28248)](https://github.com/bitcoin/bitcoin/pull/28248/commits/7caaa9ecf4444116a0ef34f4b6e7f67b2f0f477c), if you'd like to pull it in before this change.",
      "created_at": "2023-09-13T20:25:35Z",
      "updated_at": "2023-09-13T20:30:11Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28331#discussion_r1325042158",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1325042158"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28331"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 3509,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1325141603",
      "pull_request_review_id": 1625548981,
      "id": 1325141603,
      "node_id": "PRRC_kwDOABII585O_A5j",
      "diff_hunk": "@@ -291,6 +291,9 @@ enum ServiceFlags : uint64_t {\n     // See BIP159 for details on how this is implemented.\n     NODE_NETWORK_LIMITED = (1 << 10),\n \n+    // NODE_P2P_V2 means the node supports BIP324 transport\n+    NODE_P2P_V2 = (1 << 11),",
      "path": "src/protocol.h",
      "position": 5,
      "original_position": 5,
      "commit_id": "75a329103505736acb9036224da2dfa8ab038c43",
      "original_commit_id": "1768aff56d6feedcb22b21df12e8926924fdac6a",
      "in_reply_to_id": 1321845616,
      "user": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "Done.",
      "created_at": "2023-09-13T22:37:33Z",
      "updated_at": "2023-09-13T22:37:33Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28331#discussion_r1325141603",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1325141603"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28331"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 295,
      "original_line": 295,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1325141643",
      "pull_request_review_id": 1625549037,
      "id": 1325141643,
      "node_id": "PRRC_kwDOABII585O_A6L",
      "diff_hunk": "@@ -0,0 +1,91 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2022 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"\n+Test BIP324 v2 transport\n+\"\"\"\n+\n+from test_framework.test_framework import BitcoinTestFramework\n+from test_framework.util import assert_equal\n+\n+class P2PV2Test(BitcoinTestFramework):\n+    def set_test_params(self):\n+        self.setup_clean_chain = True\n+        self.num_nodes = 5\n+        self.extra_args = [[\"-v2transport=1\"], [\"-v2transport=1\"], [\"-v2transport=0\"], [\"-v2transport=0\"], [\"-v2transport=0\"]]\n+\n+    def run_test(self):\n+        sending_handshake = \"start sending v2 handshake to peer\"\n+        downgrading_to_v1 = \"retrying with v1 transport protocol for peer\"\n+        self.disconnect_nodes(0, 1)\n+        self.disconnect_nodes(1, 2)\n+        self.disconnect_nodes(2, 3)\n+        self.disconnect_nodes(3, 4)\n+\n+        # V2 nodes can sync with V2 nodes\n+        assert_equal(self.nodes[0].getblockcount(), 0)\n+        assert_equal(self.nodes[1].getblockcount(), 0)\n+        self.nodes[0].generatetoaddress(5, \"bcrt1q0yq2azut8gn2xu3y2g0xucf8pny6w8uxmyf220\", invalid_call=False)\n+        assert_equal(self.nodes[0].getblockcount(), 5)\n+        assert_equal(self.nodes[1].getblockcount(), 0)\n+        with self.nodes[0].assert_debug_log(expected_msgs=[sending_handshake],\n+                                            unexpected_msgs=[downgrading_to_v1]):\n+            self.connect_nodes(0, 1, True)\n+        # sync_all() verifies that the block tips match\n+        self.sync_all(self.nodes[0:2])",
      "path": "test/functional/p2p_v2.py",
      "position": null,
      "original_position": 36,
      "commit_id": "75a329103505736acb9036224da2dfa8ab038c43",
      "original_commit_id": "be8a5dcddd36be8a5f137baf3ebd32d590a0747d",
      "in_reply_to_id": 1321852444,
      "user": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "Done.",
      "created_at": "2023-09-13T22:37:39Z",
      "updated_at": "2023-09-13T22:37:39Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28331#discussion_r1325141643",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1325141643"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28331"
        }
      },
      "start_line": null,
      "original_start_line": 35,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 36,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1325141793",
      "pull_request_review_id": 1625549246,
      "id": 1325141793,
      "node_id": "PRRC_kwDOABII585O_A8h",
      "diff_hunk": "@@ -309,17 +320,21 @@ static RPCHelpMan addnode()\n     CConnman& connman = EnsureConnman(node);\n \n     std::string strNode = request.params[0].get_str();\n+    bool use_p2p_v2 = !request.params[2].isNull() && request.params[2].get_bool();",
      "path": "src/rpc/net.cpp",
      "position": null,
      "original_position": 50,
      "commit_id": "75a329103505736acb9036224da2dfa8ab038c43",
      "original_commit_id": "2aabbdf4de01ef1a3fb0c1bb86ef163c9fba587b",
      "in_reply_to_id": 1322583238,
      "user": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "Done, used `self.Arg<bool>(2)` (which needed adding an instantiation for).",
      "created_at": "2023-09-13T22:37:59Z",
      "updated_at": "2023-09-13T22:37:59Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28331#discussion_r1325141793",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1325141793"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28331"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 323,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1325141840",
      "pull_request_review_id": 1625549311,
      "id": 1325141840,
      "node_id": "PRRC_kwDOABII585O_A9Q",
      "diff_hunk": "@@ -465,7 +465,11 @@ CNode* CConnman::ConnectNode(CAddress addrConnect, const char *pszDest, bool fCo\n         }\n     }\n \n-    LogPrintLevel(BCLog::NET, BCLog::Level::Debug, \"trying connection %s lastseen=%.1fhrs\\n\",\n+    // Use v2 transport when both us and them signal NODE_P2P_V2.\n+    const bool use_p2p_v2 = !!(addrConnect.nServices & GetLocalServices() & NODE_P2P_V2);",
      "path": "src/net.cpp",
      "position": null,
      "original_position": 6,
      "commit_id": "75a329103505736acb9036224da2dfa8ab038c43",
      "original_commit_id": "2aabbdf4de01ef1a3fb0c1bb86ef163c9fba587b",
      "in_reply_to_id": 1322591734,
      "user": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "Done.",
      "created_at": "2023-09-13T22:38:05Z",
      "updated_at": "2023-09-13T22:38:05Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28331#discussion_r1325141840",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1325141840"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28331"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 469,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1325141884",
      "pull_request_review_id": 1625549372,
      "id": 1325141884,
      "node_id": "PRRC_kwDOABII585O_A98",
      "diff_hunk": "@@ -1822,6 +1894,10 @@ void CConnman::CreateNodeFromAcceptedSocket(std::unique_ptr<Sock>&& sock,\n     }\n \n     const bool inbound_onion = std::find(m_onion_binds.begin(), m_onion_binds.end(), addr_bind) != m_onion_binds.end();\n+    // The V2Transport transparently falls back to V1 behavior when an incoming V1 connection is\n+    // detected, so use it whenever we signal NODE_P2P_V2.\n+    const bool use_p2p_v2 = !!(nodeServices & NODE_P2P_V2);",
      "path": "src/net.cpp",
      "position": null,
      "original_position": 198,
      "commit_id": "75a329103505736acb9036224da2dfa8ab038c43",
      "original_commit_id": "2aabbdf4de01ef1a3fb0c1bb86ef163c9fba587b",
      "in_reply_to_id": 1322592221,
      "user": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "Done.",
      "created_at": "2023-09-13T22:38:10Z",
      "updated_at": "2023-09-13T22:38:10Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28331#discussion_r1325141884",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1325141884"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28331"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1899,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1325142059",
      "pull_request_review_id": 1625549580,
      "id": 1325142059,
      "node_id": "PRRC_kwDOABII585O_BAr",
      "diff_hunk": "@@ -581,26 +586,50 @@ def restart_node(self, i, extra_args=None):\n     def wait_for_node_exit(self, i, timeout):\n         self.nodes[i].process.wait(timeout)\n \n-    def connect_nodes(self, a, b):\n+    def connect_nodes(self, a, b, peer_advertises_v2=None):\n         from_connection = self.nodes[a]\n         to_connection = self.nodes[b]\n         from_num_peers = 1 + len(from_connection.getpeerinfo())\n         to_num_peers = 1 + len(to_connection.getpeerinfo())\n         ip_port = \"127.0.0.1:\" + str(p2p_port(b))\n-        from_connection.addnode(ip_port, \"onetry\")\n+\n+        if peer_advertises_v2 is None:\n+            peer_advertises_v2 = self.options.v2transport\n+\n+        if peer_advertises_v2:\n+            from_connection.addnode(ip_port, \"onetry\", True)\n+        else:\n+            # skip the optional third argument (default false) for\n+            # compatibility with older clients\n+            from_connection.addnode(ip_port, \"onetry\")\n+\n+        min_verack_msg_bytes = 21 if peer_advertises_v2 else 24\n         # poll until version handshake complete to avoid race conditions\n         # with transaction relaying\n         # See comments in net_processing:\n         # * Must have a version message before anything else\n         # * Must have a verack message before anything else\n-        self.wait_until(lambda: sum(peer['version'] != 0 for peer in from_connection.getpeerinfo()) == from_num_peers)\n-        self.wait_until(lambda: sum(peer['version'] != 0 for peer in to_connection.getpeerinfo()) == to_num_peers)\n-        self.wait_until(lambda: sum(peer['bytesrecv_per_msg'].pop('verack', 0) == 24 for peer in from_connection.getpeerinfo()) == from_num_peers)\n-        self.wait_until(lambda: sum(peer['bytesrecv_per_msg'].pop('verack', 0) == 24 for peer in to_connection.getpeerinfo()) == to_num_peers)\n-        # The message bytes are counted before processing the message, so make\n-        # sure it was fully processed by waiting for a ping.\n-        self.wait_until(lambda: sum(peer[\"bytesrecv_per_msg\"].pop(\"pong\", 0) >= 32 for peer in from_connection.getpeerinfo()) == from_num_peers)\n-        self.wait_until(lambda: sum(peer[\"bytesrecv_per_msg\"].pop(\"pong\", 0) >= 32 for peer in to_connection.getpeerinfo()) == to_num_peers)\n+        # * The message bytes are counted before processing the message, so make\n+        #   sure it was fully processed by waiting for a ping.\n+\n+        def check_initiator_handshake():\n+            peerinfo = from_connection.getpeerinfo()\n+            if len(peerinfo) != from_num_peers:\n+                return False\n+\n+            responder = list(filter(lambda x: x[\"addr\"] == ip_port, peerinfo))[0]\n+            return responder['version'] != 0 and responder['bytesrecv_per_msg'].pop('verack', 0) >= min_verack_msg_bytes and responder['bytesrecv_per_msg'].pop(\"pong\", 0) >= 29\n+\n+        def check_responder_handshake():\n+            peerinfo = to_connection.getpeerinfo()\n+            if len(peerinfo) != to_num_peers:\n+                return False\n+\n+            initiator = list(filter(lambda x: x[\"addrbind\"] == ip_port, peerinfo))[0]\n+            return initiator['version'] != 0 and initiator['bytesrecv_per_msg'].pop('verack', 0) >= min_verack_msg_bytes and initiator['bytesrecv_per_msg'].pop(\"pong\", 0) >= 29\n+\n+        self.wait_until(check_initiator_handshake)\n+        self.wait_until(check_responder_handshake)",
      "path": "test/functional/test_framework/test_framework.py",
      "position": null,
      "original_position": 85,
      "commit_id": "75a329103505736acb9036224da2dfa8ab038c43",
      "original_commit_id": "2aabbdf4de01ef1a3fb0c1bb86ef163c9fba587b",
      "in_reply_to_id": 1322606364,
      "user": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "Apparently not needed, done.",
      "created_at": "2023-09-13T22:38:29Z",
      "updated_at": "2023-09-13T22:38:30Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28331#discussion_r1325142059",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1325142059"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28331"
        }
      },
      "start_line": null,
      "original_start_line": 612,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 632,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1325142165",
      "pull_request_review_id": 1625549712,
      "id": 1325142165,
      "node_id": "PRRC_kwDOABII585O_BCV",
      "diff_hunk": "@@ -0,0 +1,32 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2021 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"\n+Test v2 transport\n+\"\"\"\n+\n+from test_framework.messages import NODE_P2P_V2\n+from test_framework.test_framework import BitcoinTestFramework\n+from test_framework.util import assert_equal\n+\n+class V2TransportTest(BitcoinTestFramework):\n+    def set_test_params(self):\n+        self.setup_clean_chain=True\n+        self.num_nodes = 1\n+        self.extra_args = [[\"-v2transport=0\"]]\n+\n+    def run_test(self):\n+        network_info = self.nodes[0].getnetworkinfo()\n+        assert_equal(int(network_info[\"localservices\"], 16) & NODE_P2P_V2, 0)\n+        if \"P2P_V2\" in network_info[\"localservicesnames\"]:\n+            raise AssertionError(\"Did not expect P2P_V2 to be signaled for a v1 node\")",
      "path": "test/functional/p2p_v2_transport.py",
      "position": null,
      "original_position": 23,
      "commit_id": "75a329103505736acb9036224da2dfa8ab038c43",
      "original_commit_id": "2aabbdf4de01ef1a3fb0c1bb86ef163c9fba587b",
      "in_reply_to_id": 1322610190,
      "user": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "Done, and done.",
      "created_at": "2023-09-13T22:38:40Z",
      "updated_at": "2023-09-13T22:38:40Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28331#discussion_r1325142165",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1325142165"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28331"
        }
      },
      "start_line": null,
      "original_start_line": 22,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 23,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1325142520",
      "pull_request_review_id": 1625550211,
      "id": 1325142520,
      "node_id": "PRRC_kwDOABII585O_BH4",
      "diff_hunk": "@@ -0,0 +1,91 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2022 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"\n+Test BIP324 v2 transport\n+\"\"\"\n+\n+from test_framework.test_framework import BitcoinTestFramework\n+from test_framework.util import assert_equal\n+\n+class P2PV2Test(BitcoinTestFramework):\n+    def set_test_params(self):\n+        self.setup_clean_chain = True\n+        self.num_nodes = 5\n+        self.extra_args = [[\"-v2transport=1\"], [\"-v2transport=1\"], [\"-v2transport=0\"], [\"-v2transport=0\"], [\"-v2transport=0\"]]\n+\n+    def run_test(self):\n+        sending_handshake = \"start sending v2 handshake to peer\"\n+        downgrading_to_v1 = \"retrying with v1 transport protocol for peer\"\n+        self.disconnect_nodes(0, 1)\n+        self.disconnect_nodes(1, 2)\n+        self.disconnect_nodes(2, 3)\n+        self.disconnect_nodes(3, 4)\n+\n+        # V2 nodes can sync with V2 nodes\n+        assert_equal(self.nodes[0].getblockcount(), 0)\n+        assert_equal(self.nodes[1].getblockcount(), 0)\n+        self.nodes[0].generatetoaddress(5, \"bcrt1q0yq2azut8gn2xu3y2g0xucf8pny6w8uxmyf220\", invalid_call=False)\n+        assert_equal(self.nodes[0].getblockcount(), 5)\n+        assert_equal(self.nodes[1].getblockcount(), 0)\n+        with self.nodes[0].assert_debug_log(expected_msgs=[sending_handshake],\n+                                            unexpected_msgs=[downgrading_to_v1]):\n+            self.connect_nodes(0, 1, True)\n+        # sync_all() verifies that the block tips match\n+        self.sync_all(self.nodes[0:2])\n+        assert_equal(self.nodes[1].getblockcount(), 5)\n+\n+        # V1 nodes can sync with each other\n+        assert_equal(self.nodes[2].getblockcount(), 0)\n+        assert_equal(self.nodes[3].getblockcount(), 0)\n+        self.nodes[2].generatetoaddress(8, \"bcrt1qyr5lnc2g8aa3qa9c4th9d46n5uu4y0m9nvq2cv\", invalid_call=False)\n+        assert_equal(self.nodes[2].getblockcount(), 8)\n+        assert_equal(self.nodes[3].getblockcount(), 0)\n+        with self.nodes[2].assert_debug_log(expected_msgs=[],\n+                                            unexpected_msgs=[sending_handshake, downgrading_to_v1]):\n+            self.connect_nodes(2, 3, False)\n+        self.sync_all(self.nodes[2:4])\n+        assert_equal(self.nodes[3].getblockcount(), 8)\n+        assert self.nodes[0].getbestblockhash() != self.nodes[2].getbestblockhash()\n+\n+        # V1 nodes can sync with V2 nodes\n+        self.disconnect_nodes(0, 1)\n+        self.disconnect_nodes(2, 3)\n+        with self.nodes[2].assert_debug_log(expected_msgs=[],\n+                                            unexpected_msgs=[sending_handshake, downgrading_to_v1]):\n+            self.connect_nodes(2, 1, True)\n+        self.sync_all(self.nodes[1:3])\n+        assert_equal(self.nodes[1].getblockcount(), 8)\n+        assert self.nodes[0].getbestblockhash() != self.nodes[1].getbestblockhash()\n+\n+        # V2 nodes can sync with V1 nodes\n+        self.disconnect_nodes(1, 2)\n+        with self.nodes[0].assert_debug_log(expected_msgs=[],\n+                                            unexpected_msgs=[sending_handshake, downgrading_to_v1]):\n+            self.connect_nodes(0, 3, False)\n+        self.sync_all([self.nodes[0], self.nodes[3]])\n+        assert_equal(self.nodes[0].getblockcount(), 8)\n+\n+        # V2 node mines another block and everyone gets it\n+        self.connect_nodes(0, 1, True)\n+        self.connect_nodes(1, 2, False)\n+        self.nodes[1].generatetoaddress(1, \"bcrt1q3zsxn3qx0cqyyxgv90k7j6786mpe543wc4vy2v\", invalid_call=False)\n+        self.sync_all(self.nodes[0:4])\n+        assert_equal(self.nodes[0].getblockcount(), 9) # sync_all() verifies tip hashes match\n+\n+        # V1 node mines another block and everyone gets it\n+        self.nodes[3].generatetoaddress(2, \"bcrt1q3zsxn3qx0cqyyxgv90k7j6786mpe543wc4vy2v\", invalid_call=False)",
      "path": "test/functional/p2p_v2.py",
      "position": null,
      "original_position": 78,
      "commit_id": "75a329103505736acb9036224da2dfa8ab038c43",
      "original_commit_id": "2aabbdf4de01ef1a3fb0c1bb86ef163c9fba587b",
      "in_reply_to_id": 1322611559,
      "user": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "I've stuck to `self.nodes[3].generate(2)` (and similarly elsewhere) because the synchronization is explicit and separate in the lines that follow.",
      "created_at": "2023-09-13T22:39:21Z",
      "updated_at": "2023-09-13T22:39:22Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28331#discussion_r1325142520",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1325142520"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28331"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 78,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1325142582",
      "pull_request_review_id": 1625550291,
      "id": 1325142582,
      "node_id": "PRRC_kwDOABII585O_BI2",
      "diff_hunk": "@@ -581,26 +586,50 @@ def restart_node(self, i, extra_args=None):\n     def wait_for_node_exit(self, i, timeout):\n         self.nodes[i].process.wait(timeout)\n \n-    def connect_nodes(self, a, b):\n+    def connect_nodes(self, a, b, peer_advertises_v2=None):",
      "path": "test/functional/test_framework/test_framework.py",
      "position": null,
      "original_position": 33,
      "commit_id": "75a329103505736acb9036224da2dfa8ab038c43",
      "original_commit_id": "2aabbdf4de01ef1a3fb0c1bb86ef163c9fba587b",
      "in_reply_to_id": 1322613818,
      "user": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "Fixed.",
      "created_at": "2023-09-13T22:39:28Z",
      "updated_at": "2023-09-13T22:39:28Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28331#discussion_r1325142582",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1325142582"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28331"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 589,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1325143334",
      "pull_request_review_id": 1625551374,
      "id": 1325143334,
      "node_id": "PRRC_kwDOABII585O_BUm",
      "diff_hunk": "@@ -1077,7 +1081,11 @@ class CConnman\n         vWhitelistedRange = connOptions.vWhitelistedRange;\n         {\n             LOCK(m_added_nodes_mutex);\n-            m_added_nodes = connOptions.m_added_nodes;\n+\n+            for (const std::string& strAddedNode : connOptions.m_added_nodes) {\n+                // -addnode cli arg does not currently have a way to signal BIP324 support",
      "path": "src/net.h",
      "position": 121,
      "original_position": 24,
      "commit_id": "75a329103505736acb9036224da2dfa8ab038c43",
      "original_commit_id": "1fa8efaff73bda19b7e8f2e27d24b08ccf0de764",
      "in_reply_to_id": 1324997532,
      "user": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "Possibly, but at this stage my goal is to get enough code in for basic tests and experimentation, and for that, an RPC suffices. Further on, we'll certainly want more convenient ways of interacting with this (perhaps we can treat it as a whitelist permission or so, too, but I don't want to bikeshed about that here).",
      "created_at": "2023-09-13T22:40:56Z",
      "updated_at": "2023-09-13T22:40:56Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28331#discussion_r1325143334",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1325143334"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28331"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 1113,
      "original_line": 1113,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1325143444",
      "pull_request_review_id": 1625551523,
      "id": 1325143444,
      "node_id": "PRRC_kwDOABII585O_BWU",
      "diff_hunk": "@@ -309,25 +309,33 @@ class CSemaphore\n     int value;\n \n public:\n-    explicit CSemaphore(int init) : value(init) {}\n+    explicit CSemaphore(int init) noexcept : value(init) {}",
      "path": "src/sync.h",
      "position": 16,
      "original_position": 5,
      "commit_id": "75a329103505736acb9036224da2dfa8ab038c43",
      "original_commit_id": "8672b854fb7a81a400150ef09e99a06c829b68f8",
      "in_reply_to_id": 1325007449,
      "user": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "I've linked to the Wikipedia article about it.",
      "created_at": "2023-09-13T22:41:08Z",
      "updated_at": "2023-09-13T22:41:08Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28331#discussion_r1325143444",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1325143444"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28331"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 316,
      "original_line": 316,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1325160737",
      "pull_request_review_id": 1625577178,
      "id": 1325160737,
      "node_id": "PRRC_kwDOABII585O_Fkh",
      "diff_hunk": "@@ -1077,7 +1081,11 @@ class CConnman\n         vWhitelistedRange = connOptions.vWhitelistedRange;\n         {\n             LOCK(m_added_nodes_mutex);\n-            m_added_nodes = connOptions.m_added_nodes;\n+\n+            for (const std::string& strAddedNode : connOptions.m_added_nodes) {\n+                // -addnode cli arg does not currently have a way to signal BIP324 support",
      "path": "src/net.h",
      "position": 121,
      "original_position": 24,
      "commit_id": "75a329103505736acb9036224da2dfa8ab038c43",
      "original_commit_id": "1fa8efaff73bda19b7e8f2e27d24b08ccf0de764",
      "in_reply_to_id": 1324997532,
      "user": {
        "login": "Sjors",
        "id": 10217,
        "node_id": "MDQ6VXNlcjEwMjE3",
        "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Sjors",
        "html_url": "https://github.com/Sjors",
        "followers_url": "https://api.github.com/users/Sjors/followers",
        "following_url": "https://api.github.com/users/Sjors/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Sjors/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Sjors/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
        "organizations_url": "https://api.github.com/users/Sjors/orgs",
        "repos_url": "https://api.github.com/users/Sjors/repos",
        "events_url": "https://api.github.com/users/Sjors/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Sjors/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "It can wait indeed. It's just that I have some nodes that I'd like to connect by default.",
      "created_at": "2023-09-13T23:15:32Z",
      "updated_at": "2023-09-13T23:15:32Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28331#discussion_r1325160737",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1325160737"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28331"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 1113,
      "original_line": 1113,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1325161965",
      "pull_request_review_id": 1625578789,
      "id": 1325161965,
      "node_id": "PRRC_kwDOABII585O_F3t",
      "diff_hunk": "@@ -2834,6 +2883,8 @@ void CConnman::ThreadOpenAddedConnections()\n         // Retry every 60 seconds if a connection was attempted, otherwise two seconds\n         if (!interruptNet.sleep_for(std::chrono::seconds(tried ? 60 : 2)))\n             return;\n+        // See if any reconnections are desired.\n+        PerformReconnections();",
      "path": "src/net.cpp",
      "position": 327,
      "original_position": 117,
      "commit_id": "75a329103505736acb9036224da2dfa8ab038c43",
      "original_commit_id": "f2048453190df06282e515977cd805db709c7e60",
      "in_reply_to_id": null,
      "user": {
        "login": "Sjors",
        "id": 10217,
        "node_id": "MDQ6VXNlcjEwMjE3",
        "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Sjors",
        "html_url": "https://github.com/Sjors",
        "followers_url": "https://api.github.com/users/Sjors/followers",
        "following_url": "https://api.github.com/users/Sjors/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Sjors/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Sjors/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
        "organizations_url": "https://api.github.com/users/Sjors/orgs",
        "repos_url": "https://api.github.com/users/Sjors/repos",
        "events_url": "https://api.github.com/users/Sjors/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Sjors/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "Wouldn't this wait for 60 seconds? (context: https://github.com/bitcoin/bitcoin/pull/28331#issuecomment-1718407366)",
      "created_at": "2023-09-13T23:18:00Z",
      "updated_at": "2023-09-13T23:18:01Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28331#discussion_r1325161965",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1325161965"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28331"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 2886,
      "original_line": 2886,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1325403945",
      "pull_request_review_id": 1625946910,
      "id": 1325403945,
      "node_id": "PRRC_kwDOABII585PAA8p",
      "diff_hunk": "@@ -0,0 +1,136 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2021 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"\n+Test v2 transport\n+\"\"\"\n+\n+from test_framework.messages import NODE_P2P_V2\n+from test_framework.test_framework import BitcoinTestFramework\n+from test_framework.util import assert_equal\n+\n+class V2TransportTest(BitcoinTestFramework):\n+    def set_test_params(self):\n+        self.setup_clean_chain = True\n+        self.num_nodes = 5\n+        self.extra_args = [[\"-v2transport=1\"], [\"-v2transport=1\"], [\"-v2transport=0\"], [\"-v2transport=0\"], [\"-v2transport=0\"]]\n+\n+    def run_test(self):\n+        sending_handshake = \"start sending v2 handshake to peer\"\n+        downgrading_to_v1 = \"retrying with v1 transport protocol for peer\"\n+        self.disconnect_nodes(0, 1)\n+        self.disconnect_nodes(1, 2)\n+        self.disconnect_nodes(2, 3)\n+        self.disconnect_nodes(3, 4)\n+\n+        # verify local services\n+        network_info = self.nodes[2].getnetworkinfo()\n+        assert_equal(int(network_info[\"localservices\"], 16) & NODE_P2P_V2, 0)\n+        assert \"P2P_V2\" not in network_info[\"localservicesnames\"]\n+        network_info = self.nodes[1].getnetworkinfo()\n+        assert_equal(int(network_info[\"localservices\"], 16) & NODE_P2P_V2, NODE_P2P_V2)\n+        assert \"P2P_V2\" in network_info[\"localservicesnames\"]\n+\n+        # V2 nodes can sync with V2 nodes\n+        assert_equal(self.nodes[0].getblockcount(), 0)\n+        assert_equal(self.nodes[1].getblockcount(), 0)\n+        self.nodes[0].generate(5, invalid_call=False)\n+        assert_equal(self.nodes[0].getblockcount(), 5)\n+        assert_equal(self.nodes[1].getblockcount(), 0)\n+        with self.nodes[0].assert_debug_log(expected_msgs=[sending_handshake],\n+                                            unexpected_msgs=[downgrading_to_v1]):\n+            self.connect_nodes(0, 1, peer_advertises_v2=True)\n+        # sync_all() verifies that the block tips match\n+        self.sync_all(self.nodes[0:2])\n+        assert_equal(self.nodes[1].getblockcount(), 5)\n+        # verify there is a v2 connection between node 0 and 1\n+        node_0_info = self.nodes[0].getpeerinfo()\n+        node_1_info = self.nodes[0].getpeerinfo()\n+        assert_equal(len(node_0_info), 1)\n+        assert_equal(len(node_1_info), 1)\n+        assert_equal(node_0_info[0][\"transport_protocol_type\"], \"v2\")\n+        assert_equal(node_1_info[0][\"transport_protocol_type\"], \"v2\")\n+        assert_equal(len(node_0_info[0][\"session_id\"]), 64)\n+        assert_equal(len(node_1_info[0][\"session_id\"]), 64)\n+        assert_equal(node_0_info[0][\"session_id\"], node_1_info[0][\"session_id\"])\n+\n+        # V1 nodes can sync with each other\n+        assert_equal(self.nodes[2].getblockcount(), 0)\n+        assert_equal(self.nodes[3].getblockcount(), 0)\n+        self.nodes[2].generate(8, invalid_call=False)\n+        assert_equal(self.nodes[2].getblockcount(), 8)\n+        assert_equal(self.nodes[3].getblockcount(), 0)\n+        with self.nodes[2].assert_debug_log(expected_msgs=[],\n+                                            unexpected_msgs=[sending_handshake, downgrading_to_v1]):\n+            self.connect_nodes(2, 3, peer_advertises_v2=False)\n+        self.sync_all(self.nodes[2:4])\n+        assert_equal(self.nodes[3].getblockcount(), 8)\n+        assert self.nodes[0].getbestblockhash() != self.nodes[2].getbestblockhash()\n+        # verify there is a v1 connection between node 2 and 3\n+        node_2_info = self.nodes[2].getpeerinfo()\n+        node_3_info = self.nodes[3].getpeerinfo()\n+        assert_equal(len(node_2_info), 1)\n+        assert_equal(len(node_3_info), 1)\n+        assert_equal(node_2_info[0][\"transport_protocol_type\"], \"v1\")\n+        assert_equal(node_3_info[0][\"transport_protocol_type\"], \"v1\")\n+        assert_equal(len(node_2_info[0][\"session_id\"]), 0)\n+        assert_equal(len(node_3_info[0][\"session_id\"]), 0)\n+\n+        # V1 nodes can sync with V2 nodes\n+        self.disconnect_nodes(0, 1)\n+        self.disconnect_nodes(2, 3)\n+        with self.nodes[2].assert_debug_log(expected_msgs=[],\n+                                            unexpected_msgs=[sending_handshake, downgrading_to_v1]):\n+            self.connect_nodes(2, 1, peer_advertises_v2=True)\n+        self.sync_all(self.nodes[1:3])\n+        assert_equal(self.nodes[1].getblockcount(), 8)\n+        assert self.nodes[0].getbestblockhash() != self.nodes[1].getbestblockhash()\n+        # verify there is a v1 connection between node 1 and 2\n+        node_1_info = self.nodes[1].getpeerinfo()\n+        node_2_info = self.nodes[2].getpeerinfo()\n+        assert_equal(len(node_1_info), 1)\n+        assert_equal(len(node_2_info), 1)\n+        assert_equal(node_1_info[0][\"transport_protocol_type\"], \"v1\")\n+        assert_equal(node_2_info[0][\"transport_protocol_type\"], \"v1\")\n+        assert_equal(len(node_1_info[0][\"session_id\"]), 0)\n+        assert_equal(len(node_2_info[0][\"session_id\"]), 0)\n+\n+        # V2 nodes can sync with V1 nodes\n+        self.disconnect_nodes(1, 2)\n+        with self.nodes[0].assert_debug_log(expected_msgs=[],\n+                                            unexpected_msgs=[sending_handshake, downgrading_to_v1]):\n+            self.connect_nodes(0, 3, peer_advertises_v2=False)\n+        self.sync_all([self.nodes[0], self.nodes[3]])\n+        assert_equal(self.nodes[0].getblockcount(), 8)\n+        # verify there is a v1 connection between node 0 and 3\n+        node_0_info = self.nodes[0].getpeerinfo()\n+        node_3_info = self.nodes[3].getpeerinfo()\n+        assert_equal(len(node_0_info), 1)\n+        assert_equal(len(node_3_info), 1)\n+        assert_equal(node_0_info[0][\"transport_protocol_type\"], \"v1\")\n+        assert_equal(node_3_info[0][\"transport_protocol_type\"], \"v1\")\n+        assert_equal(len(node_0_info[0][\"session_id\"]), 0)\n+        assert_equal(len(node_3_info[0][\"session_id\"]), 0)\n+\n+        # V2 node mines another block and everyone gets it\n+        self.connect_nodes(0, 1, peer_advertises_v2=True)\n+        self.connect_nodes(1, 2, peer_advertises_v2=False)\n+        self.nodes[1].generate(1, invalid_call=False)\n+        self.sync_all(self.nodes[0:4])\n+        assert_equal(self.nodes[0].getblockcount(), 9) # sync_all() verifies tip hashes match\n+\n+        # V1 node mines another block and everyone gets it\n+        self.nodes[3].generate(2, invalid_call=False)",
      "path": "test/functional/p2p_v2_transport.py",
      "position": null,
      "original_position": 124,
      "commit_id": "75a329103505736acb9036224da2dfa8ab038c43",
      "original_commit_id": "018594ef44dc57e828a9a38c9643f85fb6c2a1e4",
      "in_reply_to_id": null,
      "user": {
        "login": "maflcko",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/maflcko",
        "html_url": "https://github.com/maflcko",
        "followers_url": "https://api.github.com/users/maflcko/followers",
        "following_url": "https://api.github.com/users/maflcko/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/maflcko/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/maflcko/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/maflcko/subscriptions",
        "organizations_url": "https://api.github.com/users/maflcko/orgs",
        "repos_url": "https://api.github.com/users/maflcko/repos",
        "events_url": "https://api.github.com/users/maflcko/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/maflcko/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "```suggestion\r\n        self.generate(self.nodes[3], 2, sync_fun=lambda: self.sync_all(self.nodes[0:4]))\r\n```\r\n\r\nnit: Can be written shorter by combining the call with the line below.\r\n\r\nThe general idea is that for each call to `generate` the dev is forced to specify which nodes are expected to be synced after the call, to make intermittent races/errors less common and assumptions easier to follow.\r\n\r\n(Same above)\r\n\r\n(My idea was to force devs to type `invalid_call`, which would make them realize that the call is considered \"invalid\", but maybe that doesn't work :sweat_smile:)",
      "created_at": "2023-09-14T06:10:02Z",
      "updated_at": "2023-09-14T06:15:33Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28331#discussion_r1325403945",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1325403945"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28331"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 124,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1325406995",
      "pull_request_review_id": 1625946910,
      "id": 1325406995,
      "node_id": "PRRC_kwDOABII585PABsT",
      "diff_hunk": "@@ -0,0 +1,136 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2021 The Bitcoin Core developers",
      "path": "test/functional/p2p_v2_transport.py",
      "position": null,
      "original_position": 2,
      "commit_id": "75a329103505736acb9036224da2dfa8ab038c43",
      "original_commit_id": "018594ef44dc57e828a9a38c9643f85fb6c2a1e4",
      "in_reply_to_id": null,
      "user": {
        "login": "maflcko",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/maflcko",
        "html_url": "https://github.com/maflcko",
        "followers_url": "https://api.github.com/users/maflcko/followers",
        "following_url": "https://api.github.com/users/maflcko/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/maflcko/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/maflcko/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/maflcko/subscriptions",
        "organizations_url": "https://api.github.com/users/maflcko/orgs",
        "repos_url": "https://api.github.com/users/maflcko/repos",
        "events_url": "https://api.github.com/users/maflcko/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/maflcko/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "```suggestion\r\n# Copyright (c) 2021-present The Bitcoin Core developers\r\n```\r\n\r\nnit: To avoid having to ever touch this file again, for new code, could use `-present`, or drop the years?",
      "created_at": "2023-09-14T06:14:05Z",
      "updated_at": "2023-09-14T06:15:33Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28331#discussion_r1325406995",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1325406995"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28331"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 2,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1325850948",
      "pull_request_review_id": 1626730527,
      "id": 1325850948,
      "node_id": "PRRC_kwDOABII585PBuFE",
      "diff_hunk": "@@ -2834,6 +2883,8 @@ void CConnman::ThreadOpenAddedConnections()\n         // Retry every 60 seconds if a connection was attempted, otherwise two seconds\n         if (!interruptNet.sleep_for(std::chrono::seconds(tried ? 60 : 2)))\n             return;\n+        // See if any reconnections are desired.\n+        PerformReconnections();",
      "path": "src/net.cpp",
      "position": 327,
      "original_position": 117,
      "commit_id": "75a329103505736acb9036224da2dfa8ab038c43",
      "original_commit_id": "f2048453190df06282e515977cd805db709c7e60",
      "in_reply_to_id": 1325161965,
      "user": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "If you only have a `ThreadOpenAddedConnections` and no `ThreadOpenConnections`, indeed - though I think that only happens if you have a `-connect=` option.",
      "created_at": "2023-09-14T12:08:33Z",
      "updated_at": "2023-09-14T12:08:34Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28331#discussion_r1325850948",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1325850948"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28331"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 2886,
      "original_line": 2886,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1325864392",
      "pull_request_review_id": 1626751755,
      "id": 1325864392,
      "node_id": "PRRC_kwDOABII585PBxXI",
      "diff_hunk": "@@ -0,0 +1,136 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2021 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"\n+Test v2 transport\n+\"\"\"\n+\n+from test_framework.messages import NODE_P2P_V2\n+from test_framework.test_framework import BitcoinTestFramework\n+from test_framework.util import assert_equal\n+\n+class V2TransportTest(BitcoinTestFramework):\n+    def set_test_params(self):\n+        self.setup_clean_chain = True\n+        self.num_nodes = 5\n+        self.extra_args = [[\"-v2transport=1\"], [\"-v2transport=1\"], [\"-v2transport=0\"], [\"-v2transport=0\"], [\"-v2transport=0\"]]\n+\n+    def run_test(self):\n+        sending_handshake = \"start sending v2 handshake to peer\"\n+        downgrading_to_v1 = \"retrying with v1 transport protocol for peer\"\n+        self.disconnect_nodes(0, 1)\n+        self.disconnect_nodes(1, 2)\n+        self.disconnect_nodes(2, 3)\n+        self.disconnect_nodes(3, 4)\n+\n+        # verify local services\n+        network_info = self.nodes[2].getnetworkinfo()\n+        assert_equal(int(network_info[\"localservices\"], 16) & NODE_P2P_V2, 0)\n+        assert \"P2P_V2\" not in network_info[\"localservicesnames\"]\n+        network_info = self.nodes[1].getnetworkinfo()\n+        assert_equal(int(network_info[\"localservices\"], 16) & NODE_P2P_V2, NODE_P2P_V2)\n+        assert \"P2P_V2\" in network_info[\"localservicesnames\"]\n+\n+        # V2 nodes can sync with V2 nodes\n+        assert_equal(self.nodes[0].getblockcount(), 0)\n+        assert_equal(self.nodes[1].getblockcount(), 0)\n+        self.nodes[0].generate(5, invalid_call=False)\n+        assert_equal(self.nodes[0].getblockcount(), 5)\n+        assert_equal(self.nodes[1].getblockcount(), 0)\n+        with self.nodes[0].assert_debug_log(expected_msgs=[sending_handshake],\n+                                            unexpected_msgs=[downgrading_to_v1]):\n+            self.connect_nodes(0, 1, peer_advertises_v2=True)\n+        # sync_all() verifies that the block tips match\n+        self.sync_all(self.nodes[0:2])\n+        assert_equal(self.nodes[1].getblockcount(), 5)\n+        # verify there is a v2 connection between node 0 and 1\n+        node_0_info = self.nodes[0].getpeerinfo()\n+        node_1_info = self.nodes[0].getpeerinfo()\n+        assert_equal(len(node_0_info), 1)\n+        assert_equal(len(node_1_info), 1)\n+        assert_equal(node_0_info[0][\"transport_protocol_type\"], \"v2\")\n+        assert_equal(node_1_info[0][\"transport_protocol_type\"], \"v2\")\n+        assert_equal(len(node_0_info[0][\"session_id\"]), 64)\n+        assert_equal(len(node_1_info[0][\"session_id\"]), 64)\n+        assert_equal(node_0_info[0][\"session_id\"], node_1_info[0][\"session_id\"])\n+\n+        # V1 nodes can sync with each other\n+        assert_equal(self.nodes[2].getblockcount(), 0)\n+        assert_equal(self.nodes[3].getblockcount(), 0)\n+        self.nodes[2].generate(8, invalid_call=False)\n+        assert_equal(self.nodes[2].getblockcount(), 8)\n+        assert_equal(self.nodes[3].getblockcount(), 0)\n+        with self.nodes[2].assert_debug_log(expected_msgs=[],\n+                                            unexpected_msgs=[sending_handshake, downgrading_to_v1]):\n+            self.connect_nodes(2, 3, peer_advertises_v2=False)\n+        self.sync_all(self.nodes[2:4])\n+        assert_equal(self.nodes[3].getblockcount(), 8)\n+        assert self.nodes[0].getbestblockhash() != self.nodes[2].getbestblockhash()\n+        # verify there is a v1 connection between node 2 and 3\n+        node_2_info = self.nodes[2].getpeerinfo()\n+        node_3_info = self.nodes[3].getpeerinfo()\n+        assert_equal(len(node_2_info), 1)\n+        assert_equal(len(node_3_info), 1)\n+        assert_equal(node_2_info[0][\"transport_protocol_type\"], \"v1\")\n+        assert_equal(node_3_info[0][\"transport_protocol_type\"], \"v1\")\n+        assert_equal(len(node_2_info[0][\"session_id\"]), 0)\n+        assert_equal(len(node_3_info[0][\"session_id\"]), 0)\n+\n+        # V1 nodes can sync with V2 nodes\n+        self.disconnect_nodes(0, 1)\n+        self.disconnect_nodes(2, 3)\n+        with self.nodes[2].assert_debug_log(expected_msgs=[],\n+                                            unexpected_msgs=[sending_handshake, downgrading_to_v1]):\n+            self.connect_nodes(2, 1, peer_advertises_v2=True)\n+        self.sync_all(self.nodes[1:3])\n+        assert_equal(self.nodes[1].getblockcount(), 8)\n+        assert self.nodes[0].getbestblockhash() != self.nodes[1].getbestblockhash()\n+        # verify there is a v1 connection between node 1 and 2\n+        node_1_info = self.nodes[1].getpeerinfo()\n+        node_2_info = self.nodes[2].getpeerinfo()\n+        assert_equal(len(node_1_info), 1)\n+        assert_equal(len(node_2_info), 1)\n+        assert_equal(node_1_info[0][\"transport_protocol_type\"], \"v1\")\n+        assert_equal(node_2_info[0][\"transport_protocol_type\"], \"v1\")\n+        assert_equal(len(node_1_info[0][\"session_id\"]), 0)\n+        assert_equal(len(node_2_info[0][\"session_id\"]), 0)\n+\n+        # V2 nodes can sync with V1 nodes\n+        self.disconnect_nodes(1, 2)\n+        with self.nodes[0].assert_debug_log(expected_msgs=[],\n+                                            unexpected_msgs=[sending_handshake, downgrading_to_v1]):\n+            self.connect_nodes(0, 3, peer_advertises_v2=False)\n+        self.sync_all([self.nodes[0], self.nodes[3]])\n+        assert_equal(self.nodes[0].getblockcount(), 8)\n+        # verify there is a v1 connection between node 0 and 3\n+        node_0_info = self.nodes[0].getpeerinfo()\n+        node_3_info = self.nodes[3].getpeerinfo()\n+        assert_equal(len(node_0_info), 1)\n+        assert_equal(len(node_3_info), 1)\n+        assert_equal(node_0_info[0][\"transport_protocol_type\"], \"v1\")\n+        assert_equal(node_3_info[0][\"transport_protocol_type\"], \"v1\")\n+        assert_equal(len(node_0_info[0][\"session_id\"]), 0)\n+        assert_equal(len(node_3_info[0][\"session_id\"]), 0)\n+\n+        # V2 node mines another block and everyone gets it\n+        self.connect_nodes(0, 1, peer_advertises_v2=True)\n+        self.connect_nodes(1, 2, peer_advertises_v2=False)\n+        self.nodes[1].generate(1, invalid_call=False)\n+        self.sync_all(self.nodes[0:4])\n+        assert_equal(self.nodes[0].getblockcount(), 9) # sync_all() verifies tip hashes match\n+\n+        # V1 node mines another block and everyone gets it\n+        self.nodes[3].generate(2, invalid_call=False)",
      "path": "test/functional/p2p_v2_transport.py",
      "position": null,
      "original_position": 124,
      "commit_id": "75a329103505736acb9036224da2dfa8ab038c43",
      "original_commit_id": "018594ef44dc57e828a9a38c9643f85fb6c2a1e4",
      "in_reply_to_id": 1325403945,
      "user": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "Ooh! I interpreted it as \"don't expect an exception to be thrown\" or so. Done.\r\n\r\nPerhaps it should be called `i_know_test_framework_generate_exists_but_dont_want_to_use_it=True` instead of `invalid_call=False`.",
      "created_at": "2023-09-14T12:20:02Z",
      "updated_at": "2023-09-14T12:57:04Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28331#discussion_r1325864392",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1325864392"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28331"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 124,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1325910272",
      "pull_request_review_id": 1626825784,
      "id": 1325910272,
      "node_id": "PRRC_kwDOABII585PB8kA",
      "diff_hunk": "@@ -0,0 +1,136 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2021 The Bitcoin Core developers",
      "path": "test/functional/p2p_v2_transport.py",
      "position": null,
      "original_position": 2,
      "commit_id": "75a329103505736acb9036224da2dfa8ab038c43",
      "original_commit_id": "018594ef44dc57e828a9a38c9643f85fb6c2a1e4",
      "in_reply_to_id": 1325406995,
      "user": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "Done.",
      "created_at": "2023-09-14T12:56:37Z",
      "updated_at": "2023-09-14T12:56:37Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28331#discussion_r1325910272",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1325910272"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28331"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 2,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1326453411",
      "pull_request_review_id": 1627653998,
      "id": 1326453411,
      "node_id": "PRRC_kwDOABII585PEBKj",
      "diff_hunk": "@@ -1077,7 +1081,11 @@ class CConnman\n         vWhitelistedRange = connOptions.vWhitelistedRange;\n         {\n             LOCK(m_added_nodes_mutex);\n-            m_added_nodes = connOptions.m_added_nodes;\n+\n+            for (const std::string& strAddedNode : connOptions.m_added_nodes) {\n+                // -addnode cli arg does not currently have a way to signal BIP324 support",
      "path": "src/net.h",
      "position": 121,
      "original_position": 24,
      "commit_id": "75a329103505736acb9036224da2dfa8ab038c43",
      "original_commit_id": "1fa8efaff73bda19b7e8f2e27d24b08ccf0de764",
      "in_reply_to_id": 1324997532,
      "user": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "There are also other means of making outbound connections based on user input, like `-connect` or `-seednode` for which at some later point a decision must be made (make configurable / keep default at v1 / switch to v2 ).",
      "created_at": "2023-09-14T19:58:23Z",
      "updated_at": "2023-09-14T19:58:23Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28331#discussion_r1326453411",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1326453411"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28331"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 1113,
      "original_line": 1113,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1326464080",
      "pull_request_review_id": 1627671406,
      "id": 1326464080,
      "node_id": "PRRC_kwDOABII585PEDxQ",
      "diff_hunk": "@@ -1077,7 +1081,11 @@ class CConnman\n         vWhitelistedRange = connOptions.vWhitelistedRange;\n         {\n             LOCK(m_added_nodes_mutex);\n-            m_added_nodes = connOptions.m_added_nodes;\n+\n+            for (const std::string& strAddedNode : connOptions.m_added_nodes) {\n+                // -addnode cli arg does not currently have a way to signal BIP324 support",
      "path": "src/net.h",
      "position": 121,
      "original_position": 24,
      "commit_id": "75a329103505736acb9036224da2dfa8ab038c43",
      "original_commit_id": "1fa8efaff73bda19b7e8f2e27d24b08ccf0de764",
      "in_reply_to_id": 1324997532,
      "user": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "There is also the possibility of extending the reconnection mechanism to switch to V2 when you connect using V1 to a node and they tell you they support V2.",
      "created_at": "2023-09-14T20:10:45Z",
      "updated_at": "2023-09-14T20:10:45Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28331#discussion_r1326464080",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1326464080"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28331"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 1113,
      "original_line": 1113,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1326488045",
      "pull_request_review_id": 1627710444,
      "id": 1326488045,
      "node_id": "PRRC_kwDOABII585PEJnt",
      "diff_hunk": "@@ -309,17 +310,21 @@ static RPCHelpMan addnode()\n     CConnman& connman = EnsureConnman(node);\n \n     std::string strNode = request.params[0].get_str();\n+    bool use_v2transport = self.Arg<bool>(2);\n \n     if (strCommand == \"onetry\")\n     {\n         CAddress addr;\n+        if (use_v2transport) {",
      "path": "src/rpc/net.cpp",
      "position": null,
      "original_position": 24,
      "commit_id": "75a329103505736acb9036224da2dfa8ab038c43",
      "original_commit_id": "eb05c921194010e2d93c9b756440a313fd5e45d8",
      "in_reply_to_id": null,
      "user": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "could return an error if we explicitely set the bool with the RPC command but don't have activated `-v2transport` ourselves (instead of silently downgrading to v1).",
      "created_at": "2023-09-14T20:34:13Z",
      "updated_at": "2023-09-15T15:34:28Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28331#discussion_r1326488045",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1326488045"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28331"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 330,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1326714164",
      "pull_request_review_id": 1628106395,
      "id": 1326714164,
      "node_id": "PRRC_kwDOABII585PFA00",
      "diff_hunk": "@@ -189,6 +189,8 @@ def parse_args(self):\n         parser.add_argument(\"--randomseed\", type=int,\n                             help=\"set a random seed for deterministically reproducing a previous test run\")\n         parser.add_argument(\"--timeout-factor\", dest=\"timeout_factor\", type=float, help=\"adjust test timeouts by a factor. Setting it to 0 disables all timeouts\")\n+        parser.add_argument(\"--v2transport\", dest=\"v2transport\", default=False, action=\"store_true\",",
      "path": "test/functional/test_framework/test_framework.py",
      "position": 4,
      "original_position": 4,
      "commit_id": "75a329103505736acb9036224da2dfa8ab038c43",
      "original_commit_id": "2aabbdf4de01ef1a3fb0c1bb86ef163c9fba587b",
      "in_reply_to_id": 1325029773,
      "user": {
        "login": "theStack",
        "id": 91535,
        "node_id": "MDQ6VXNlcjkxNTM1",
        "avatar_url": "https://avatars.githubusercontent.com/u/91535?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theStack",
        "html_url": "https://github.com/theStack",
        "followers_url": "https://api.github.com/users/theStack/followers",
        "following_url": "https://api.github.com/users/theStack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theStack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theStack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theStack/subscriptions",
        "organizations_url": "https://api.github.com/users/theStack/orgs",
        "repos_url": "https://api.github.com/users/theStack/repos",
        "events_url": "https://api.github.com/users/theStack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theStack/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "FWIW, I've started to adapt those tests for `--v2transport` support, and at least for p2p_node_network_limited.py and rpc_net.py there weren't too many changes needed (see https://github.com/theStack/bitcoin/commits/enable_v2_transport_for_more_tests).",
      "created_at": "2023-09-15T02:32:52Z",
      "updated_at": "2023-09-15T02:32:53Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28331#discussion_r1326714164",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1326714164"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28331"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 192,
      "original_line": 192,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1327456191",
      "pull_request_review_id": 1627710444,
      "id": 1327456191,
      "node_id": "PRRC_kwDOABII585PH1-_",
      "diff_hunk": "@@ -3779,6 +3832,24 @@ uint64_t CConnman::CalculateKeyedNetGroup(const CAddress& address) const\n     return GetDeterministicRandomizer(RANDOMIZER_ID_NETGROUP).Write(vchNetGroup).Finalize();\n }\n \n+void CConnman::PerformReconnections()\n+{\n+    AssertLockNotHeld(m_reconnections_mutex);\n+    AssertLockNotHeld(m_unused_i2p_sessions_mutex);\n+    while (true) {\n+        // Move first element of m_reconnections to todo (avoiding an allocation inside the lock).\n+        decltype(m_reconnections) todo;\n+        {\n+            LOCK(m_reconnections_mutex);\n+            if (m_reconnections.empty()) break;\n+            todo.splice(todo.end(), m_reconnections, m_reconnections.begin());\n+        }\n+\n+        auto& [addr_connect, count_failure, grant, dest, conn_type] = *todo.begin();\n+        OpenNetworkConnection(addr_connect, count_failure, &grant, dest.empty() ? nullptr : dest.c_str(), conn_type);",
      "path": "src/net.cpp",
      "position": null,
      "original_position": 149,
      "commit_id": "75a329103505736acb9036224da2dfa8ab038c43",
      "original_commit_id": "7d2bf51b9e3b5cd14d42614cb0fbe58ff9597f1b",
      "in_reply_to_id": null,
      "user": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "I think this means that reconnections for added nodes can be made from `ThreadOpenConnections`, and reconnections for automatic connections can be performed by `ThreadOpenAddedConnections` - which seems really weird, although I don't think it breaks anything. I wonder if it makes sense to perform the respective reconnection attempts only by their designated threads.",
      "created_at": "2023-09-15T15:25:06Z",
      "updated_at": "2023-09-15T15:36:04Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28331#discussion_r1327456191",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1327456191"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28331"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 3878,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1327778467",
      "pull_request_review_id": 1629711581,
      "id": 1327778467,
      "node_id": "PRRC_kwDOABII585PJEqj",
      "diff_hunk": "@@ -309,17 +310,21 @@ static RPCHelpMan addnode()\n     CConnman& connman = EnsureConnman(node);\n \n     std::string strNode = request.params[0].get_str();\n+    bool use_v2transport = self.Arg<bool>(2);\n \n     if (strCommand == \"onetry\")\n     {\n         CAddress addr;\n+        if (use_v2transport) {",
      "path": "src/rpc/net.cpp",
      "position": null,
      "original_position": 24,
      "commit_id": "75a329103505736acb9036224da2dfa8ab038c43",
      "original_commit_id": "eb05c921194010e2d93c9b756440a313fd5e45d8",
      "in_reply_to_id": 1326488045,
      "user": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "Added.",
      "created_at": "2023-09-15T20:51:51Z",
      "updated_at": "2023-09-15T20:51:52Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28331#discussion_r1327778467",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1327778467"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28331"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 330,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1327790459",
      "pull_request_review_id": 1629728031,
      "id": 1327790459,
      "node_id": "PRRC_kwDOABII585PJHl7",
      "diff_hunk": "@@ -3779,6 +3832,24 @@ uint64_t CConnman::CalculateKeyedNetGroup(const CAddress& address) const\n     return GetDeterministicRandomizer(RANDOMIZER_ID_NETGROUP).Write(vchNetGroup).Finalize();\n }\n \n+void CConnman::PerformReconnections()\n+{\n+    AssertLockNotHeld(m_reconnections_mutex);\n+    AssertLockNotHeld(m_unused_i2p_sessions_mutex);\n+    while (true) {\n+        // Move first element of m_reconnections to todo (avoiding an allocation inside the lock).\n+        decltype(m_reconnections) todo;\n+        {\n+            LOCK(m_reconnections_mutex);\n+            if (m_reconnections.empty()) break;\n+            todo.splice(todo.end(), m_reconnections, m_reconnections.begin());\n+        }\n+\n+        auto& [addr_connect, count_failure, grant, dest, conn_type] = *todo.begin();\n+        OpenNetworkConnection(addr_connect, count_failure, &grant, dest.empty() ? nullptr : dest.c_str(), conn_type);",
      "path": "src/net.cpp",
      "position": null,
      "original_position": 149,
      "commit_id": "75a329103505736acb9036224da2dfa8ab038c43",
      "original_commit_id": "7d2bf51b9e3b5cd14d42614cb0fbe58ff9597f1b",
      "in_reply_to_id": 1327456191,
      "user": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "I agree it's somewhat strange, but I'm not convinced that splitting them up is better.\r\n\r\nPro current approach:\r\n* Slightly lower latency for reconnections with 2 threads considering them.\r\n* Simpler implementation.\r\n* Not entirely clear what to do with connections not created by either thread (like `addnode oneshot`, unsure if there are others). I guess they can go in the addnode thread too.\r\n\r\nPro split:\r\n* No interference between the two types. For example, if you'd configure lots of addnodes errorneously as V2, with the currently approach they'll end up slowing down normal (random) peer connection establishment.\r\n",
      "created_at": "2023-09-15T21:08:32Z",
      "updated_at": "2023-09-15T21:08:33Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28331#discussion_r1327790459",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1327790459"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28331"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 3878,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1329835602",
      "pull_request_review_id": 1632814911,
      "id": 1329835602,
      "node_id": "PRRC_kwDOABII585PQ65S",
      "diff_hunk": "@@ -3606,6 +3617,15 @@ ServiceFlags CConnman::GetLocalServices() const\n     return nLocalServices;\n }\n \n+static std::unique_ptr<Transport> MakeTransport(NodeId id, bool use_v2transport, bool inbound) noexcept\n+{\n+    if (use_v2transport) {\n+        return std::make_unique<V2Transport>(id, !inbound, SER_NETWORK, INIT_PROTO_VERSION);",
      "path": "src/net.cpp",
      "position": null,
      "original_position": 55,
      "commit_id": "75a329103505736acb9036224da2dfa8ab038c43",
      "original_commit_id": "54544ace5e4efc40bf248c1c4de6063c104cd549",
      "in_reply_to_id": null,
      "user": {
        "login": "theStack",
        "id": 91535,
        "node_id": "MDQ6VXNlcjkxNTM1",
        "avatar_url": "https://avatars.githubusercontent.com/u/91535?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theStack",
        "html_url": "https://github.com/theStack",
        "followers_url": "https://api.github.com/users/theStack/followers",
        "following_url": "https://api.github.com/users/theStack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theStack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theStack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theStack/subscriptions",
        "organizations_url": "https://api.github.com/users/theStack/orgs",
        "repos_url": "https://api.github.com/users/theStack/repos",
        "events_url": "https://api.github.com/users/theStack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theStack/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "named argument nit:\r\n```suggestion\r\n        return std::make_unique<V2Transport>(id, /*initiating=*/!inbound, SER_NETWORK, INIT_PROTO_VERSION);\r\n```",
      "created_at": "2023-09-19T09:26:00Z",
      "updated_at": "2023-09-19T10:19:55Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28331#discussion_r1329835602",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1329835602"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28331"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 3623,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1329843899",
      "pull_request_review_id": 1632814911,
      "id": 1329843899,
      "node_id": "PRRC_kwDOABII585PQ867",
      "diff_hunk": "@@ -79,4 +79,14 @@ enum class ConnectionType {\n /** Convert ConnectionType enum to a string value */\n std::string ConnectionTypeAsString(ConnectionType conn_type);\n \n+/** Transport layer version */\n+enum class TransportProtocolType {\n+    DETECTING, //!< Incoming connection; peer could be v1 or v2",
      "path": "src/node/connection_types.h",
      "position": null,
      "original_position": 6,
      "commit_id": "75a329103505736acb9036224da2dfa8ab038c43",
      "original_commit_id": "0c345514b8bb0c246bebaea8d2484a205a2ae72b",
      "in_reply_to_id": null,
      "user": {
        "login": "theStack",
        "id": 91535,
        "node_id": "MDQ6VXNlcjkxNTM1",
        "avatar_url": "https://avatars.githubusercontent.com/u/91535?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theStack",
        "html_url": "https://github.com/theStack",
        "followers_url": "https://api.github.com/users/theStack/followers",
        "following_url": "https://api.github.com/users/theStack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theStack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theStack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theStack/subscriptions",
        "organizations_url": "https://api.github.com/users/theStack/orgs",
        "repos_url": "https://api.github.com/users/theStack/repos",
        "events_url": "https://api.github.com/users/theStack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theStack/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "```suggestion\r\n    DETECTING, //!< peer could be v1 or v2\r\n```\r\nsince the latest change in `V2Transport::GetInfo` (introduced in https://github.com/bitcoin/bitcoin/pull/28331#issuecomment-1721167073) the DETECTING state is now used both for in- and outbound connections",
      "created_at": "2023-09-19T09:32:56Z",
      "updated_at": "2023-09-19T10:19:55Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28331#discussion_r1329843899",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1329843899"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28331"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 84,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1329845422",
      "pull_request_review_id": 1632814911,
      "id": 1329845422,
      "node_id": "PRRC_kwDOABII585PQ9Su",
      "diff_hunk": "@@ -270,6 +274,20 @@ class Transport {\n public:\n     virtual ~Transport() {}\n \n+    struct Info\n+    {\n+        TransportProtocolType transport_type;\n+        std::optional<uint256> session_id;\n+\n+        friend bool operator==(const Info& a, const Info& b) noexcept\n+        {\n+            return std::tie(a.transport_type, a.session_id) == std::tie(b.transport_type, b.session_id);\n+        }",
      "path": "src/net.h",
      "position": null,
      "original_position": 23,
      "commit_id": "75a329103505736acb9036224da2dfa8ab038c43",
      "original_commit_id": "0c345514b8bb0c246bebaea8d2484a205a2ae72b",
      "in_reply_to_id": null,
      "user": {
        "login": "theStack",
        "id": 91535,
        "node_id": "MDQ6VXNlcjkxNTM1",
        "avatar_url": "https://avatars.githubusercontent.com/u/91535?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theStack",
        "html_url": "https://github.com/theStack",
        "followers_url": "https://api.github.com/users/theStack/followers",
        "following_url": "https://api.github.com/users/theStack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theStack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theStack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theStack/subscriptions",
        "organizations_url": "https://api.github.com/users/theStack/orgs",
        "repos_url": "https://api.github.com/users/theStack/repos",
        "events_url": "https://api.github.com/users/theStack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theStack/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "nit: this operator seems to be not used anywhere",
      "created_at": "2023-09-19T09:34:17Z",
      "updated_at": "2023-09-19T10:19:55Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28331#discussion_r1329845422",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1329845422"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28331"
        }
      },
      "start_line": null,
      "original_start_line": 282,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 285,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1329847746",
      "pull_request_review_id": 1632814911,
      "id": 1329847746,
      "node_id": "PRRC_kwDOABII585PQ93C",
      "diff_hunk": "@@ -581,26 +581,33 @@ def restart_node(self, i, extra_args=None):\n     def wait_for_node_exit(self, i, timeout):\n         self.nodes[i].process.wait(timeout)\n \n-    def connect_nodes(self, a, b):\n+    def connect_nodes(self, a, b, *, peer_advertises_v2=False):\n         from_connection = self.nodes[a]\n         to_connection = self.nodes[b]\n         from_num_peers = 1 + len(from_connection.getpeerinfo())\n         to_num_peers = 1 + len(to_connection.getpeerinfo())\n         ip_port = \"127.0.0.1:\" + str(p2p_port(b))\n-        from_connection.addnode(ip_port, \"onetry\")\n+\n+        if peer_advertises_v2:\n+            from_connection.addnode(ip_port, \"onetry\", True)",
      "path": "test/functional/test_framework/test_framework.py",
      "position": null,
      "original_position": 14,
      "commit_id": "75a329103505736acb9036224da2dfa8ab038c43",
      "original_commit_id": "4a363e9754ccf2b8ab3895b081fb201cb468c48e",
      "in_reply_to_id": null,
      "user": {
        "login": "theStack",
        "id": 91535,
        "node_id": "MDQ6VXNlcjkxNTM1",
        "avatar_url": "https://avatars.githubusercontent.com/u/91535?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theStack",
        "html_url": "https://github.com/theStack",
        "followers_url": "https://api.github.com/users/theStack/followers",
        "following_url": "https://api.github.com/users/theStack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theStack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theStack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theStack/subscriptions",
        "organizations_url": "https://api.github.com/users/theStack/orgs",
        "repos_url": "https://api.github.com/users/theStack/repos",
        "events_url": "https://api.github.com/users/theStack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theStack/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "nit: could use named arguments here and below\r\n```suggestion\r\n            from_connection.addnode(node=ip_port, command=\"onetry\", v2transport=True)\r\n```",
      "created_at": "2023-09-19T09:36:08Z",
      "updated_at": "2023-09-19T10:19:55Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28331#discussion_r1329847746",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1329847746"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28331"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 592,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1331928327",
      "pull_request_review_id": 1636110869,
      "id": 1331928327,
      "node_id": "PRRC_kwDOABII585PY50H",
      "diff_hunk": "@@ -581,26 +581,33 @@ def restart_node(self, i, extra_args=None):\n     def wait_for_node_exit(self, i, timeout):\n         self.nodes[i].process.wait(timeout)\n \n-    def connect_nodes(self, a, b):\n+    def connect_nodes(self, a, b, *, peer_advertises_v2=False):\n         from_connection = self.nodes[a]\n         to_connection = self.nodes[b]\n         from_num_peers = 1 + len(from_connection.getpeerinfo())\n         to_num_peers = 1 + len(to_connection.getpeerinfo())\n         ip_port = \"127.0.0.1:\" + str(p2p_port(b))\n-        from_connection.addnode(ip_port, \"onetry\")\n+\n+        if peer_advertises_v2:\n+            from_connection.addnode(ip_port, \"onetry\", True)",
      "path": "test/functional/test_framework/test_framework.py",
      "position": null,
      "original_position": 14,
      "commit_id": "75a329103505736acb9036224da2dfa8ab038c43",
      "original_commit_id": "4a363e9754ccf2b8ab3895b081fb201cb468c48e",
      "in_reply_to_id": 1329847746,
      "user": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "Done.",
      "created_at": "2023-09-20T16:49:44Z",
      "updated_at": "2023-09-20T16:49:44Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28331#discussion_r1331928327",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1331928327"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28331"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 592,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1331928692",
      "pull_request_review_id": 1636111365,
      "id": 1331928692,
      "node_id": "PRRC_kwDOABII585PY550",
      "diff_hunk": "@@ -270,6 +274,20 @@ class Transport {\n public:\n     virtual ~Transport() {}\n \n+    struct Info\n+    {\n+        TransportProtocolType transport_type;\n+        std::optional<uint256> session_id;\n+\n+        friend bool operator==(const Info& a, const Info& b) noexcept\n+        {\n+            return std::tie(a.transport_type, a.session_id) == std::tie(b.transport_type, b.session_id);\n+        }",
      "path": "src/net.h",
      "position": null,
      "original_position": 23,
      "commit_id": "75a329103505736acb9036224da2dfa8ab038c43",
      "original_commit_id": "0c345514b8bb0c246bebaea8d2484a205a2ae72b",
      "in_reply_to_id": 1329845422,
      "user": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "Gone.",
      "created_at": "2023-09-20T16:50:02Z",
      "updated_at": "2023-09-20T16:50:03Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28331#discussion_r1331928692",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1331928692"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28331"
        }
      },
      "start_line": null,
      "original_start_line": 282,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 285,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1331928965",
      "pull_request_review_id": 1636111846,
      "id": 1331928965,
      "node_id": "PRRC_kwDOABII585PY5-F",
      "diff_hunk": "@@ -79,4 +79,14 @@ enum class ConnectionType {\n /** Convert ConnectionType enum to a string value */\n std::string ConnectionTypeAsString(ConnectionType conn_type);\n \n+/** Transport layer version */\n+enum class TransportProtocolType {\n+    DETECTING, //!< Incoming connection; peer could be v1 or v2",
      "path": "src/node/connection_types.h",
      "position": null,
      "original_position": 6,
      "commit_id": "75a329103505736acb9036224da2dfa8ab038c43",
      "original_commit_id": "0c345514b8bb0c246bebaea8d2484a205a2ae72b",
      "in_reply_to_id": 1329843899,
      "user": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "Done.",
      "created_at": "2023-09-20T16:50:21Z",
      "updated_at": "2023-09-20T16:50:22Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28331#discussion_r1331928965",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1331928965"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28331"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 84,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1331929144",
      "pull_request_review_id": 1636112105,
      "id": 1331929144,
      "node_id": "PRRC_kwDOABII585PY6A4",
      "diff_hunk": "@@ -3606,6 +3617,15 @@ ServiceFlags CConnman::GetLocalServices() const\n     return nLocalServices;\n }\n \n+static std::unique_ptr<Transport> MakeTransport(NodeId id, bool use_v2transport, bool inbound) noexcept\n+{\n+    if (use_v2transport) {\n+        return std::make_unique<V2Transport>(id, !inbound, SER_NETWORK, INIT_PROTO_VERSION);",
      "path": "src/net.cpp",
      "position": null,
      "original_position": 55,
      "commit_id": "75a329103505736acb9036224da2dfa8ab038c43",
      "original_commit_id": "54544ace5e4efc40bf248c1c4de6063c104cd549",
      "in_reply_to_id": 1329835602,
      "user": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "Done.",
      "created_at": "2023-09-20T16:50:32Z",
      "updated_at": "2023-09-20T16:50:32Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28331#discussion_r1331929144",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1331929144"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28331"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 3623,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1335786208",
      "pull_request_review_id": 1641976091,
      "id": 1335786208,
      "node_id": "PRRC_kwDOABII585Pnnrg",
      "diff_hunk": "@@ -1542,6 +1558,25 @@ class CConnman\n      */\n     std::queue<std::unique_ptr<i2p::sam::Session>> m_unused_i2p_sessions GUARDED_BY(m_unused_i2p_sessions_mutex);\n \n+    /**\n+     * Mutex protecting m_reconnections.\n+     */\n+    Mutex m_reconnections_mutex;\n+\n+    /**\n+     * List of reconnections we have to make.\n+     */\n+    std::list<std::tuple<\n+        CAddress /*addr_connect*/,\n+        bool /*count_failure*/,\n+        CSemaphoreGrant /*grant*/,\n+        std::string /*dest*/,\n+        ConnectionType /*conn_type*/\n+    >> m_reconnections GUARDED_BY(m_reconnections_mutex);",
      "path": "src/net.h",
      "position": null,
      "original_position": 109,
      "commit_id": "75a329103505736acb9036224da2dfa8ab038c43",
      "original_commit_id": "5917b6b5d798b18daa949f03de7c37b6038011fd",
      "in_reply_to_id": null,
      "user": {
        "login": "ajtowns",
        "id": 127186,
        "node_id": "MDQ6VXNlcjEyNzE4Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/127186?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ajtowns",
        "html_url": "https://github.com/ajtowns",
        "followers_url": "https://api.github.com/users/ajtowns/followers",
        "following_url": "https://api.github.com/users/ajtowns/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ajtowns/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ajtowns/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ajtowns/subscriptions",
        "organizations_url": "https://api.github.com/users/ajtowns/orgs",
        "repos_url": "https://api.github.com/users/ajtowns/repos",
        "events_url": "https://api.github.com/users/ajtowns/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ajtowns/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "`struct ReconnectionInfo { ... }; std::list<ReconnectionInfo> m_reconnections;` ? If you're going to comment names for the entries, might as well actually give them names.",
      "created_at": "2023-09-25T12:01:09Z",
      "updated_at": "2023-09-25T16:22:09Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28331#discussion_r1335786208",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1335786208"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28331"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1575,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1335820022",
      "pull_request_review_id": 1641976091,
      "id": 1335820022,
      "node_id": "PRRC_kwDOABII585Pnv72",
      "diff_hunk": "@@ -2459,6 +2505,8 @@ void CConnman::ThreadOpenConnections(const std::vector<std::string> connect)\n         if (!interruptNet.sleep_for(std::chrono::milliseconds(500)))\n             return;\n \n+        PerformReconnections();",
      "path": "src/net.cpp",
      "position": 233,
      "original_position": 99,
      "commit_id": "75a329103505736acb9036224da2dfa8ab038c43",
      "original_commit_id": "5917b6b5d798b18daa949f03de7c37b6038011fd",
      "in_reply_to_id": null,
      "user": {
        "login": "ajtowns",
        "id": 127186,
        "node_id": "MDQ6VXNlcjEyNzE4Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/127186?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ajtowns",
        "html_url": "https://github.com/ajtowns",
        "followers_url": "https://api.github.com/users/ajtowns/followers",
        "following_url": "https://api.github.com/users/ajtowns/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ajtowns/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ajtowns/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ajtowns/subscriptions",
        "organizations_url": "https://api.github.com/users/ajtowns/orgs",
        "repos_url": "https://api.github.com/users/ajtowns/repos",
        "events_url": "https://api.github.com/users/ajtowns/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ajtowns/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "This seems a little bit complex/brittle doesn't it?\r\n\r\nThe issue I'm thinking of is that `ThreadOpenConnections` will block on `CSemaphoreGrant grant(*semOutbound)` waiting for one to disconnect and release its grant, but the peer wanting a reconnection attempt doesn't release its grant, so the thread here won't be woken up. That's okay normally though: there's slots for 8 outbounds, 2 block relay connections and a feeler/extra block relay; so usually there will be a spare slot, so the code will continue through and arrive back to the 500ms wait, then handle reconnections again. And even if they are all used up, every minute, `ThreadOpenAddedConnections` will help out, unless all the slots there are also used up.\r\n\r\nI don't think that's super problematic -- at worst I think it just performs a bit poorly, by delaying a reconnect for a minute or until your feeler/extra block relay peer gets disconnected. But mostly it feels like gating this through semaphores is just a bit too simple for what we're trying to achieve.\r\n\r\nI guess I think it would be better to drop the semaphore approach and just have a queue of \"open connection\" work, one or two (or n) threads that attempt to open connections, and then they just wake up via a condition variable to see what work there is to do (outbound, block relay, addnode, or reconnection) and do it.",
      "created_at": "2023-09-25T12:29:58Z",
      "updated_at": "2023-09-25T16:22:09Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28331#discussion_r1335820022",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1335820022"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28331"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 2514,
      "original_line": 2514,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1335876277",
      "pull_request_review_id": 1641976091,
      "id": 1335876277,
      "node_id": "PRRC_kwDOABII585Pn9q1",
      "diff_hunk": "@@ -1917,6 +1944,19 @@ void CConnman::DisconnectNodes()\n                 // remove from m_nodes\n                 m_nodes.erase(remove(m_nodes.begin(), m_nodes.end(), pnode), m_nodes.end());\n \n+                // Add to reconnection list if appropriate. We don't reconnect right here, because\n+                // the creation of a connection is a blocking operation (up to several seconds),\n+                // and we don't want to hold up the socket handler thread for that long.\n+                if (pnode->m_transport->ShouldReconnectV1()) {\n+                    reconnections_to_add.emplace_back(\n+                        /*addr_connect=*/CAddress{pnode->addr, ServiceFlags{pnode->addr.nServices & ~NODE_P2P_V2}},\n+                        /*count_failure=*/pnode->m_count_failure_after_reconnect,\n+                        /*grant=*/std::move(pnode->grantOutbound),\n+                        /*dest=*/pnode->m_dest,\n+                        /*conn_type=*/pnode->m_conn_type);",
      "path": "src/net.cpp",
      "position": null,
      "original_position": 68,
      "commit_id": "75a329103505736acb9036224da2dfa8ab038c43",
      "original_commit_id": "5917b6b5d798b18daa949f03de7c37b6038011fd",
      "in_reply_to_id": null,
      "user": {
        "login": "ajtowns",
        "id": 127186,
        "node_id": "MDQ6VXNlcjEyNzE4Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/127186?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ajtowns",
        "html_url": "https://github.com/ajtowns",
        "followers_url": "https://api.github.com/users/ajtowns/followers",
        "following_url": "https://api.github.com/users/ajtowns/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ajtowns/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ajtowns/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ajtowns/subscriptions",
        "organizations_url": "https://api.github.com/users/ajtowns/orgs",
        "repos_url": "https://api.github.com/users/ajtowns/repos",
        "events_url": "https://api.github.com/users/ajtowns/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ajtowns/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "Did you consider an approach where the `CNode` object is preserved across the reconnection attempt? I guess that would involve an annoying amount of messing with `ConnectNode`. It would be nice if the peer id didn't change between the v2 and v1 connection attempts though - it's a bit awkward to correlate the two attempts when you can't just grep for `peer=nnn`",
      "created_at": "2023-09-25T13:16:43Z",
      "updated_at": "2023-09-25T16:22:09Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28331#discussion_r1335876277",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1335876277"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28331"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1956,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1336025006",
      "pull_request_review_id": 1641976091,
      "id": 1336025006,
      "node_id": "PRRC_kwDOABII585Poh-u",
      "diff_hunk": "@@ -52,6 +52,7 @@\n NODE_WITNESS = (1 << 3)\n NODE_COMPACT_FILTERS = (1 << 6)\n NODE_NETWORK_LIMITED = (1 << 10)\n+NODE_P2P_V2 = (1 << 11)",
      "path": "test/functional/test_framework/messages.py",
      "position": 4,
      "original_position": 4,
      "commit_id": "75a329103505736acb9036224da2dfa8ab038c43",
      "original_commit_id": "4988d8ef0c4073c8df4214261138817345a32d6d",
      "in_reply_to_id": null,
      "user": {
        "login": "ajtowns",
        "id": 127186,
        "node_id": "MDQ6VXNlcjEyNzE4Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/127186?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ajtowns",
        "html_url": "https://github.com/ajtowns",
        "followers_url": "https://api.github.com/users/ajtowns/followers",
        "following_url": "https://api.github.com/users/ajtowns/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ajtowns/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ajtowns/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ajtowns/subscriptions",
        "organizations_url": "https://api.github.com/users/ajtowns/orgs",
        "repos_url": "https://api.github.com/users/ajtowns/repos",
        "events_url": "https://api.github.com/users/ajtowns/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ajtowns/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "This seems to be an okay way of getting addresses to try:\r\n\r\n`bitcoin-cli getnodeaddresses 10000 | jq -r '.[] | select(.services >= 2047 and .services < 4096 and .network == \"ipv4\" and .port == 8333) | .address'`\r\n\r\nGives lots of false positives though (ie, nodes that don't actually support v2, or addresses that aren't actually accepting connections).",
      "created_at": "2023-09-25T15:04:25Z",
      "updated_at": "2023-09-25T16:22:09Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28331#discussion_r1336025006",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1336025006"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28331"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 55,
      "original_line": 55,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1336030845",
      "pull_request_review_id": 1641976091,
      "id": 1336030845,
      "node_id": "PRRC_kwDOABII585PojZ9",
      "diff_hunk": "@@ -3602,6 +3613,15 @@ ServiceFlags CConnman::GetLocalServices() const\n     return nLocalServices;\n }\n \n+static std::unique_ptr<Transport> MakeTransport(NodeId id, bool use_v2transport, bool inbound) noexcept\n+{\n+    if (use_v2transport) {\n+        return std::make_unique<V2Transport>(id, /*initiating=*/!inbound, SER_NETWORK, INIT_PROTO_VERSION);\n+    } else {\n+        return std::make_unique<V1Transport>(id, SER_NETWORK, INIT_PROTO_VERSION);",
      "path": "src/net.cpp",
      "position": 392,
      "original_position": 57,
      "commit_id": "75a329103505736acb9036224da2dfa8ab038c43",
      "original_commit_id": "bcde50035e02dc0b04693423bc89a029b3468ca4",
      "in_reply_to_id": null,
      "user": {
        "login": "ajtowns",
        "id": 127186,
        "node_id": "MDQ6VXNlcjEyNzE4Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/127186?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ajtowns",
        "html_url": "https://github.com/ajtowns",
        "followers_url": "https://api.github.com/users/ajtowns/followers",
        "following_url": "https://api.github.com/users/ajtowns/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ajtowns/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ajtowns/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ajtowns/subscriptions",
        "organizations_url": "https://api.github.com/users/ajtowns/orgs",
        "repos_url": "https://api.github.com/users/ajtowns/repos",
        "events_url": "https://api.github.com/users/ajtowns/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ajtowns/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "I wonder how much sense it really makes to have the `Transport` virtual class -- every `V2Transport` has a `V1Transport m_v1_fallback` member, so could just use `V2Transport` everywhere, and set `m_recv_state` and `m_send_state` to `V1` when we want v1, instead of allocating a different structure.",
      "created_at": "2023-09-25T15:08:59Z",
      "updated_at": "2023-09-25T16:22:09Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28331#discussion_r1336030845",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1336030845"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28331"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 3679,
      "original_line": 3679,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1336037214",
      "pull_request_review_id": 1641976091,
      "id": 1336037214,
      "node_id": "PRRC_kwDOABII585Pok9e",
      "diff_hunk": "@@ -1575,13 +1576,34 @@ void V2Transport::MarkBytesSent(size_t bytes_sent) noexcept\n \n     m_send_pos += bytes_sent;\n     Assume(m_send_pos <= m_send_buffer.size());\n+    if (m_send_pos >= CMessageHeader::HEADER_SIZE) {\n+        m_sent_v1_header_worth = true;\n+    }\n     // Wipe the buffer when everything is sent.\n     if (m_send_pos == m_send_buffer.size()) {\n         m_send_pos = 0;\n         ClearShrink(m_send_buffer);\n     }\n }\n \n+bool V2Transport::ShouldReconnectV1() const noexcept\n+{\n+    AssertLockNotHeld(m_send_mutex);\n+    AssertLockNotHeld(m_recv_mutex);\n+    // Only outgoing connections need reconnection.\n+    if (!m_initiating) return false;\n+\n+    LOCK(m_recv_mutex);\n+    // Only in the very first state (where m_recv_buffer.empty() means nothing received) do\n+    // we reconnect.\n+    if (m_recv_state != RecvState::KEY) return false;\n+    // Only when nothing has been received do we reconnect.\n+    if (!m_recv_buffer.empty()) return false;\n+    // Check if we've sent enough for the other side to disconnect us (if it was V1).\n+    LOCK(m_send_mutex);",
      "path": "src/net.cpp",
      "position": 82,
      "original_position": 36,
      "commit_id": "75a329103505736acb9036224da2dfa8ab038c43",
      "original_commit_id": "5917b6b5d798b18daa949f03de7c37b6038011fd",
      "in_reply_to_id": null,
      "user": {
        "login": "ajtowns",
        "id": 127186,
        "node_id": "MDQ6VXNlcjEyNzE4Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/127186?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ajtowns",
        "html_url": "https://github.com/ajtowns",
        "followers_url": "https://api.github.com/users/ajtowns/followers",
        "following_url": "https://api.github.com/users/ajtowns/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ajtowns/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ajtowns/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ajtowns/subscriptions",
        "organizations_url": "https://api.github.com/users/ajtowns/orgs",
        "repos_url": "https://api.github.com/users/ajtowns/repos",
        "events_url": "https://api.github.com/users/ajtowns/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ajtowns/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "Should you release the `m_recv_mutex` lock before taking the `m_send_mutex` lock? Presumably it shouldn't possibly matter by the time you're worrying about reconnecting, though.",
      "created_at": "2023-09-25T15:14:00Z",
      "updated_at": "2023-09-25T16:22:09Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28331#discussion_r1336037214",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1336037214"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28331"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 1584,
      "original_line": 1584,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1336044983",
      "pull_request_review_id": 1641976091,
      "id": 1336044983,
      "node_id": "PRRC_kwDOABII585Pom23",
      "diff_hunk": "@@ -1917,6 +1944,19 @@ void CConnman::DisconnectNodes()\n                 // remove from m_nodes\n                 m_nodes.erase(remove(m_nodes.begin(), m_nodes.end(), pnode), m_nodes.end());\n \n+                // Add to reconnection list if appropriate. We don't reconnect right here, because\n+                // the creation of a connection is a blocking operation (up to several seconds),\n+                // and we don't want to hold up the socket handler thread for that long.\n+                if (pnode->m_transport->ShouldReconnectV1()) {\n+                    reconnections_to_add.emplace_back(\n+                        /*addr_connect=*/CAddress{pnode->addr, ServiceFlags{pnode->addr.nServices & ~NODE_P2P_V2}},",
      "path": "src/net.cpp",
      "position": null,
      "original_position": 64,
      "commit_id": "75a329103505736acb9036224da2dfa8ab038c43",
      "original_commit_id": "5917b6b5d798b18daa949f03de7c37b6038011fd",
      "in_reply_to_id": null,
      "user": {
        "login": "ajtowns",
        "id": 127186,
        "node_id": "MDQ6VXNlcjEyNzE4Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/127186?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ajtowns",
        "html_url": "https://github.com/ajtowns",
        "followers_url": "https://api.github.com/users/ajtowns/followers",
        "following_url": "https://api.github.com/users/ajtowns/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ajtowns/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ajtowns/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ajtowns/subscriptions",
        "organizations_url": "https://api.github.com/users/ajtowns/orgs",
        "repos_url": "https://api.github.com/users/ajtowns/repos",
        "events_url": "https://api.github.com/users/ajtowns/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ajtowns/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "Is it worth adding a comment that removing `NODE_P2P_V2` here is what ensures it's retried as a v1 connection in `ConnectNode` ?",
      "created_at": "2023-09-25T15:19:50Z",
      "updated_at": "2023-09-25T16:22:09Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28331#discussion_r1336044983",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1336044983"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28331"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1952,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1336075612",
      "pull_request_review_id": 1642480842,
      "id": 1336075612,
      "node_id": "PRRC_kwDOABII585PouVc",
      "diff_hunk": "@@ -289,11 +289,12 @@ static RPCHelpMan addnode()\n                 {\n                     {\"node\", RPCArg::Type::STR, RPCArg::Optional::NO, \"The address of the peer to connect to\"},\n                     {\"command\", RPCArg::Type::STR, RPCArg::Optional::NO, \"'add' to add a node to the list, 'remove' to remove a node from the list, 'onetry' to try a connection to the node once\"},\n+                    {\"v2transport\", RPCArg::Type::BOOL, RPCArg::Default{false}, \"Peer supports BIP324 v2 transport protocol\"},",
      "path": "src/rpc/net.cpp",
      "position": null,
      "original_position": 4,
      "commit_id": "75a329103505736acb9036224da2dfa8ab038c43",
      "original_commit_id": "1ca110830801bcb0bd14b35c01d8ba6420cd3816",
      "in_reply_to_id": null,
      "user": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "nit: would prefer \"Attempt to connect with BIP324 v2 transport protocol\" or something similar, we usually don't know for sure if the peer actually supports it (and will downgrade if they don't).",
      "created_at": "2023-09-25T15:43:18Z",
      "updated_at": "2023-09-25T19:50:24Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28331#discussion_r1336075612",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1336075612"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28331"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 292,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1336152800",
      "pull_request_review_id": 1642480842,
      "id": 1336152800,
      "node_id": "PRRC_kwDOABII585PpBLg",
      "diff_hunk": "@@ -1392,7 +1400,10 @@ class CConnman\n     const NetGroupManager& m_netgroupman;\n     std::deque<std::string> m_addr_fetches GUARDED_BY(m_addr_fetches_mutex);\n     Mutex m_addr_fetches_mutex;\n-    std::vector<std::string> m_added_nodes GUARDED_BY(m_added_nodes_mutex);\n+\n+    // connection string and whether to use v2 p2p\n+    std::vector<AddedNodeParams> m_added_nodes GUARDED_BY(m_added_nodes_mutex);",
      "path": "src/net.h",
      "position": null,
      "original_position": 46,
      "commit_id": "75a329103505736acb9036224da2dfa8ab038c43",
      "original_commit_id": "1ca110830801bcb0bd14b35c01d8ba6420cd3816",
      "in_reply_to_id": null,
      "user": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "nit: maybe call it `m_added_node_params`? The naming becomes a bit confusing, e.g. when we loop over `m_added_nodes` to access the `m_added_node` member.",
      "created_at": "2023-09-25T16:46:50Z",
      "updated_at": "2023-09-25T19:50:04Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28331#discussion_r1336152800",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1336152800"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28331"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1405,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1336265284",
      "pull_request_review_id": 1642480842,
      "id": 1336265284,
      "node_id": "PRRC_kwDOABII585PpcpE",
      "diff_hunk": "@@ -1917,6 +1944,19 @@ void CConnman::DisconnectNodes()\n                 // remove from m_nodes\n                 m_nodes.erase(remove(m_nodes.begin(), m_nodes.end(), pnode), m_nodes.end());\n \n+                // Add to reconnection list if appropriate. We don't reconnect right here, because\n+                // the creation of a connection is a blocking operation (up to several seconds),\n+                // and we don't want to hold up the socket handler thread for that long.\n+                if (pnode->m_transport->ShouldReconnectV1()) {\n+                    reconnections_to_add.emplace_back(\n+                        /*addr_connect=*/CAddress{pnode->addr, ServiceFlags{pnode->addr.nServices & ~NODE_P2P_V2}},\n+                        /*count_failure=*/pnode->m_count_failure_after_reconnect,\n+                        /*grant=*/std::move(pnode->grantOutbound),\n+                        /*dest=*/pnode->m_dest,\n+                        /*conn_type=*/pnode->m_conn_type);",
      "path": "src/net.cpp",
      "position": null,
      "original_position": 68,
      "commit_id": "75a329103505736acb9036224da2dfa8ab038c43",
      "original_commit_id": "5917b6b5d798b18daa949f03de7c37b6038011fd",
      "in_reply_to_id": 1335876277,
      "user": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "also, I think that this might lead to (temporary) overshoots in the number of connection subtypes that share `semOutbound`, for example:\r\n1) Make 8th full-relay connection using v2, get disconnected and add to `m_reconnections`.\r\n2) Make another outbound from `ThreadOpenConnections()`\r\n3) call `PerformReconnections()` and make a 9th full outbound\r\n\r\nAlthough this shouldn't be too bad since `EvictExtraOutboundPeers` should deal with this and disconnect one of the extra connections both for block-relay and full outbound case.",
      "created_at": "2023-09-25T18:44:36Z",
      "updated_at": "2023-09-25T19:50:04Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28331#discussion_r1336265284",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1336265284"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28331"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1956,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1336305486",
      "pull_request_review_id": 1642480842,
      "id": 1336305486,
      "node_id": "PRRC_kwDOABII585PpmdO",
      "diff_hunk": "@@ -3779,6 +3832,24 @@ uint64_t CConnman::CalculateKeyedNetGroup(const CAddress& address) const\n     return GetDeterministicRandomizer(RANDOMIZER_ID_NETGROUP).Write(vchNetGroup).Finalize();\n }\n \n+void CConnman::PerformReconnections()\n+{\n+    AssertLockNotHeld(m_reconnections_mutex);\n+    AssertLockNotHeld(m_unused_i2p_sessions_mutex);\n+    while (true) {\n+        // Move first element of m_reconnections to todo (avoiding an allocation inside the lock).\n+        decltype(m_reconnections) todo;\n+        {\n+            LOCK(m_reconnections_mutex);\n+            if (m_reconnections.empty()) break;\n+            todo.splice(todo.end(), m_reconnections, m_reconnections.begin());\n+        }\n+\n+        auto& [addr_connect, count_failure, grant, dest, conn_type] = *todo.begin();\n+        OpenNetworkConnection(addr_connect, count_failure, &grant, dest.empty() ? nullptr : dest.c_str(), conn_type);",
      "path": "src/net.cpp",
      "position": null,
      "original_position": 149,
      "commit_id": "75a329103505736acb9036224da2dfa8ab038c43",
      "original_commit_id": "7d2bf51b9e3b5cd14d42614cb0fbe58ff9597f1b",
      "in_reply_to_id": 1327456191,
      "user": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "Ok - as pointed out below it could also help resolve problems with a blocking semaphore to have another thread trying as well.",
      "created_at": "2023-09-25T19:28:15Z",
      "updated_at": "2023-09-25T19:50:04Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28331#discussion_r1336305486",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1336305486"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28331"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 3878,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1337847714",
      "pull_request_review_id": 1645302945,
      "id": 1337847714,
      "node_id": "PRRC_kwDOABII585Pve-i",
      "diff_hunk": "@@ -2459,6 +2505,8 @@ void CConnman::ThreadOpenConnections(const std::vector<std::string> connect)\n         if (!interruptNet.sleep_for(std::chrono::milliseconds(500)))\n             return;\n \n+        PerformReconnections();",
      "path": "src/net.cpp",
      "position": 233,
      "original_position": 99,
      "commit_id": "75a329103505736acb9036224da2dfa8ab038c43",
      "original_commit_id": "5917b6b5d798b18daa949f03de7c37b6038011fd",
      "in_reply_to_id": 1335820022,
      "user": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "@ajtowns I agree it would be a better to have a more integrated design for managing the creation of open connections. Do you think the code changes for that are simple enough to do something like that in this PR, or should we keep it for a follow-up improvement?",
      "created_at": "2023-09-26T22:36:12Z",
      "updated_at": "2023-09-26T22:36:12Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28331#discussion_r1337847714",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1337847714"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28331"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 2514,
      "original_line": 2514,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1337874217",
      "pull_request_review_id": 1645340954,
      "id": 1337874217,
      "node_id": "PRRC_kwDOABII585Pvlcp",
      "diff_hunk": "@@ -1917,6 +1944,19 @@ void CConnman::DisconnectNodes()\n                 // remove from m_nodes\n                 m_nodes.erase(remove(m_nodes.begin(), m_nodes.end(), pnode), m_nodes.end());\n \n+                // Add to reconnection list if appropriate. We don't reconnect right here, because\n+                // the creation of a connection is a blocking operation (up to several seconds),\n+                // and we don't want to hold up the socket handler thread for that long.\n+                if (pnode->m_transport->ShouldReconnectV1()) {\n+                    reconnections_to_add.emplace_back(\n+                        /*addr_connect=*/CAddress{pnode->addr, ServiceFlags{pnode->addr.nServices & ~NODE_P2P_V2}},\n+                        /*count_failure=*/pnode->m_count_failure_after_reconnect,\n+                        /*grant=*/std::move(pnode->grantOutbound),\n+                        /*dest=*/pnode->m_dest,\n+                        /*conn_type=*/pnode->m_conn_type);",
      "path": "src/net.cpp",
      "position": null,
      "original_position": 68,
      "commit_id": "75a329103505736acb9036224da2dfa8ab038c43",
      "original_commit_id": "5917b6b5d798b18daa949f03de7c37b6038011fd",
      "in_reply_to_id": 1335876277,
      "user": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "I did consider reusing the `CNode` object, but it seems hard to do, because in general we only construct a `CNode` object after the connection is established. I guess it would be possible to instead leave to-be-reconnected nodes in the nodes array, but it would need more substantial changes (factoring out initialization logic from the `CNode` constructor, figuring out the interaction with various special states, dealing with any code that assumes any node in the array is active, ...). This would however solve both of the mentioned issues (node id numbers changing on reconnect, and accounting of connection subtypes).\r\n\r\nJust making the `NodeId` be reused would be a much smaller change, though I'm not convinced there is no code somewhere that assumes that distinct objects use distinct ids (and it seems possible in theory that the old object survives in `m_nodes_disconnected` actually while the new one is already created?).\r\n\r\nIf possible, I'd prefer to keep this for a follow-up.",
      "created_at": "2023-09-26T23:28:05Z",
      "updated_at": "2023-09-26T23:28:05Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28331#discussion_r1337874217",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1337874217"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28331"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1956,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1338017975",
      "pull_request_review_id": 1645552137,
      "id": 1338017975,
      "node_id": "PRRC_kwDOABII585PwIi3",
      "diff_hunk": "@@ -2459,6 +2505,8 @@ void CConnman::ThreadOpenConnections(const std::vector<std::string> connect)\n         if (!interruptNet.sleep_for(std::chrono::milliseconds(500)))\n             return;\n \n+        PerformReconnections();",
      "path": "src/net.cpp",
      "position": 233,
      "original_position": 99,
      "commit_id": "75a329103505736acb9036224da2dfa8ab038c43",
      "original_commit_id": "5917b6b5d798b18daa949f03de7c37b6038011fd",
      "in_reply_to_id": 1335820022,
      "user": {
        "login": "ajtowns",
        "id": 127186,
        "node_id": "MDQ6VXNlcjEyNzE4Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/127186?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ajtowns",
        "html_url": "https://github.com/ajtowns",
        "followers_url": "https://api.github.com/users/ajtowns/followers",
        "following_url": "https://api.github.com/users/ajtowns/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ajtowns/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ajtowns/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ajtowns/subscriptions",
        "organizations_url": "https://api.github.com/users/ajtowns/orgs",
        "repos_url": "https://api.github.com/users/ajtowns/repos",
        "events_url": "https://api.github.com/users/ajtowns/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ajtowns/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "Seems better as a follow-up to me; even if the code changes ended up being simple, thinking through all the possible edge cases seems complex enough to justify its own PR.",
      "created_at": "2023-09-27T04:07:57Z",
      "updated_at": "2023-09-27T04:07:57Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28331#discussion_r1338017975",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1338017975"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28331"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 2514,
      "original_line": 2514,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1338082701",
      "pull_request_review_id": 1645660932,
      "id": 1338082701,
      "node_id": "PRRC_kwDOABII585PwYWN",
      "diff_hunk": "@@ -1917,6 +1944,19 @@ void CConnman::DisconnectNodes()\n                 // remove from m_nodes\n                 m_nodes.erase(remove(m_nodes.begin(), m_nodes.end(), pnode), m_nodes.end());\n \n+                // Add to reconnection list if appropriate. We don't reconnect right here, because\n+                // the creation of a connection is a blocking operation (up to several seconds),\n+                // and we don't want to hold up the socket handler thread for that long.\n+                if (pnode->m_transport->ShouldReconnectV1()) {\n+                    reconnections_to_add.emplace_back(\n+                        /*addr_connect=*/CAddress{pnode->addr, ServiceFlags{pnode->addr.nServices & ~NODE_P2P_V2}},\n+                        /*count_failure=*/pnode->m_count_failure_after_reconnect,\n+                        /*grant=*/std::move(pnode->grantOutbound),\n+                        /*dest=*/pnode->m_dest,\n+                        /*conn_type=*/pnode->m_conn_type);",
      "path": "src/net.cpp",
      "position": null,
      "original_position": 68,
      "commit_id": "75a329103505736acb9036224da2dfa8ab038c43",
      "original_commit_id": "5917b6b5d798b18daa949f03de7c37b6038011fd",
      "in_reply_to_id": 1335876277,
      "user": {
        "login": "ajtowns",
        "id": 127186,
        "node_id": "MDQ6VXNlcjEyNzE4Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/127186?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ajtowns",
        "html_url": "https://github.com/ajtowns",
        "followers_url": "https://api.github.com/users/ajtowns/followers",
        "following_url": "https://api.github.com/users/ajtowns/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ajtowns/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ajtowns/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ajtowns/subscriptions",
        "organizations_url": "https://api.github.com/users/ajtowns/orgs",
        "repos_url": "https://api.github.com/users/ajtowns/repos",
        "events_url": "https://api.github.com/users/ajtowns/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ajtowns/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "Certainly fine as a follow-up, if it's changed at all. I was thinking something along the lines of https://github.com/ajtowns/bitcoin/commits/202309-reconnect-same-cnode might be workable:\r\n\r\n```\r\n2023-09-27T06:01:39Z [net:debug] trying v2 connection XXX lastseen=0.0hrs\r\n2023-09-27T06:01:39Z [net] Added connection peer=1\r\n2023-09-27T06:01:39Z [net] sending version (103 bytes) peer=1\r\n2023-09-27T06:01:39Z [net] send version message: version 70016, blocks=162396, txrelay=1, peer=1\r\n2023-09-27T06:01:39Z [net] start sending v2 handshake to peer=1\r\n2023-09-27T06:01:39Z [net] socket closed for peer=1\r\n2023-09-27T06:01:39Z [net] disconnecting peer=1\r\n2023-09-27T06:01:39Z [net] will retry with v1 transport protocol for peer=1\r\n2023-09-27T06:01:41Z [net] reconnected with v1 transport protocol for peer=1\r\n2023-09-27T06:01:41Z [net] received: version (103 bytes) peer=1\r\n2023-09-27T06:01:41Z [net] sending wtxidrelay (0 bytes) peer=1\r\n```",
      "created_at": "2023-09-27T06:04:17Z",
      "updated_at": "2023-09-27T06:04:17Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28331#discussion_r1338082701",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1338082701"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28331"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1956,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1338518276",
      "pull_request_review_id": 1646326936,
      "id": 1338518276,
      "node_id": "PRRC_kwDOABII585PyCsE",
      "diff_hunk": "@@ -3602,6 +3613,15 @@ ServiceFlags CConnman::GetLocalServices() const\n     return nLocalServices;\n }\n \n+static std::unique_ptr<Transport> MakeTransport(NodeId id, bool use_v2transport, bool inbound) noexcept\n+{\n+    if (use_v2transport) {\n+        return std::make_unique<V2Transport>(id, /*initiating=*/!inbound, SER_NETWORK, INIT_PROTO_VERSION);\n+    } else {\n+        return std::make_unique<V1Transport>(id, SER_NETWORK, INIT_PROTO_VERSION);",
      "path": "src/net.cpp",
      "position": 392,
      "original_position": 57,
      "commit_id": "75a329103505736acb9036224da2dfa8ab038c43",
      "original_commit_id": "bcde50035e02dc0b04693423bc89a029b3468ca4",
      "in_reply_to_id": 1336030845,
      "user": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "Fair point, when starting off with this approach I think we were assuming that downgrade from V2 to V1 would happen at the `CNode` level rather than inside the transports.\r\n\r\nIt's pretty easy to address this: add a `start_v1` parameter to the `V2Transport` constructors, and change the `std::unique_ptr<Transport>` to `V2Transport`. Even if they keep deriving from `Transport`, the fact that they're `final` classes means no virtual function call overhead.\r\n\r\nStill, as long as we don't enable `-v2transport` by default though, the virtual class approach makes sure that no `V2Transport` code is active unless enabled, though at the cost of virtual function calls. I think that's fine, but it's also easy to change.",
      "created_at": "2023-09-27T12:19:47Z",
      "updated_at": "2023-09-27T12:19:58Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28331#discussion_r1338518276",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1338518276"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28331"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 3679,
      "original_line": 3679,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1338523567",
      "pull_request_review_id": 1646336242,
      "id": 1338523567,
      "node_id": "PRRC_kwDOABII585PyD-v",
      "diff_hunk": "@@ -1575,13 +1576,34 @@ void V2Transport::MarkBytesSent(size_t bytes_sent) noexcept\n \n     m_send_pos += bytes_sent;\n     Assume(m_send_pos <= m_send_buffer.size());\n+    if (m_send_pos >= CMessageHeader::HEADER_SIZE) {\n+        m_sent_v1_header_worth = true;\n+    }\n     // Wipe the buffer when everything is sent.\n     if (m_send_pos == m_send_buffer.size()) {\n         m_send_pos = 0;\n         ClearShrink(m_send_buffer);\n     }\n }\n \n+bool V2Transport::ShouldReconnectV1() const noexcept\n+{\n+    AssertLockNotHeld(m_send_mutex);\n+    AssertLockNotHeld(m_recv_mutex);\n+    // Only outgoing connections need reconnection.\n+    if (!m_initiating) return false;\n+\n+    LOCK(m_recv_mutex);\n+    // Only in the very first state (where m_recv_buffer.empty() means nothing received) do\n+    // we reconnect.\n+    if (m_recv_state != RecvState::KEY) return false;\n+    // Only when nothing has been received do we reconnect.\n+    if (!m_recv_buffer.empty()) return false;\n+    // Check if we've sent enough for the other side to disconnect us (if it was V1).\n+    LOCK(m_send_mutex);",
      "path": "src/net.cpp",
      "position": 82,
      "original_position": 36,
      "commit_id": "75a329103505736acb9036224da2dfa8ab038c43",
      "original_commit_id": "5917b6b5d798b18daa949f03de7c37b6038011fd",
      "in_reply_to_id": 1336037214,
      "user": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "I don't think this matters; the connection is already closed here, so nothing except `V2Transport::ShouldReconnectV1` should be accessing these locks anymore anyway. And if `m_recv_mutex` is released before, an overly keen code reviewer may wonder if the receive state couldn't change in between the release and the grab of `m_send_mutex`.",
      "created_at": "2023-09-27T12:24:15Z",
      "updated_at": "2023-09-27T12:24:15Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28331#discussion_r1338523567",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1338523567"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28331"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 1584,
      "original_line": 1584,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1338542657",
      "pull_request_review_id": 1646369871,
      "id": 1338542657,
      "node_id": "PRRC_kwDOABII585PyIpB",
      "diff_hunk": "@@ -1542,6 +1558,25 @@ class CConnman\n      */\n     std::queue<std::unique_ptr<i2p::sam::Session>> m_unused_i2p_sessions GUARDED_BY(m_unused_i2p_sessions_mutex);\n \n+    /**\n+     * Mutex protecting m_reconnections.\n+     */\n+    Mutex m_reconnections_mutex;\n+\n+    /**\n+     * List of reconnections we have to make.\n+     */\n+    std::list<std::tuple<\n+        CAddress /*addr_connect*/,\n+        bool /*count_failure*/,\n+        CSemaphoreGrant /*grant*/,\n+        std::string /*dest*/,\n+        ConnectionType /*conn_type*/\n+    >> m_reconnections GUARDED_BY(m_reconnections_mutex);",
      "path": "src/net.h",
      "position": null,
      "original_position": 109,
      "commit_id": "75a329103505736acb9036224da2dfa8ab038c43",
      "original_commit_id": "5917b6b5d798b18daa949f03de7c37b6038011fd",
      "in_reply_to_id": 1335786208,
      "user": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "Done.",
      "created_at": "2023-09-27T12:38:15Z",
      "updated_at": "2023-09-27T12:38:15Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28331#discussion_r1338542657",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1338542657"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28331"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1575,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1338547173",
      "pull_request_review_id": 1646377317,
      "id": 1338547173,
      "node_id": "PRRC_kwDOABII585PyJvl",
      "diff_hunk": "@@ -2459,6 +2505,8 @@ void CConnman::ThreadOpenConnections(const std::vector<std::string> connect)\n         if (!interruptNet.sleep_for(std::chrono::milliseconds(500)))\n             return;\n \n+        PerformReconnections();",
      "path": "src/net.cpp",
      "position": 233,
      "original_position": 99,
      "commit_id": "75a329103505736acb9036224da2dfa8ab038c43",
      "original_commit_id": "5917b6b5d798b18daa949f03de7c37b6038011fd",
      "in_reply_to_id": 1335820022,
      "user": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "Listed as a potential follow-up in #27634",
      "created_at": "2023-09-27T12:41:47Z",
      "updated_at": "2023-09-27T12:41:47Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28331#discussion_r1338547173",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1338547173"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28331"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 2514,
      "original_line": 2514,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1338547506",
      "pull_request_review_id": 1646377931,
      "id": 1338547506,
      "node_id": "PRRC_kwDOABII585PyJ0y",
      "diff_hunk": "@@ -1917,6 +1944,19 @@ void CConnman::DisconnectNodes()\n                 // remove from m_nodes\n                 m_nodes.erase(remove(m_nodes.begin(), m_nodes.end(), pnode), m_nodes.end());\n \n+                // Add to reconnection list if appropriate. We don't reconnect right here, because\n+                // the creation of a connection is a blocking operation (up to several seconds),\n+                // and we don't want to hold up the socket handler thread for that long.\n+                if (pnode->m_transport->ShouldReconnectV1()) {\n+                    reconnections_to_add.emplace_back(\n+                        /*addr_connect=*/CAddress{pnode->addr, ServiceFlags{pnode->addr.nServices & ~NODE_P2P_V2}},\n+                        /*count_failure=*/pnode->m_count_failure_after_reconnect,\n+                        /*grant=*/std::move(pnode->grantOutbound),\n+                        /*dest=*/pnode->m_dest,\n+                        /*conn_type=*/pnode->m_conn_type);",
      "path": "src/net.cpp",
      "position": null,
      "original_position": 68,
      "commit_id": "75a329103505736acb9036224da2dfa8ab038c43",
      "original_commit_id": "5917b6b5d798b18daa949f03de7c37b6038011fd",
      "in_reply_to_id": 1335876277,
      "user": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "Listed as a potential follow-up in #27634",
      "created_at": "2023-09-27T12:42:05Z",
      "updated_at": "2023-09-27T12:42:05Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28331#discussion_r1338547506",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1338547506"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28331"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1956,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1338547782",
      "pull_request_review_id": 1646378356,
      "id": 1338547782,
      "node_id": "PRRC_kwDOABII585PyJ5G",
      "diff_hunk": "@@ -1917,6 +1944,19 @@ void CConnman::DisconnectNodes()\n                 // remove from m_nodes\n                 m_nodes.erase(remove(m_nodes.begin(), m_nodes.end(), pnode), m_nodes.end());\n \n+                // Add to reconnection list if appropriate. We don't reconnect right here, because\n+                // the creation of a connection is a blocking operation (up to several seconds),\n+                // and we don't want to hold up the socket handler thread for that long.\n+                if (pnode->m_transport->ShouldReconnectV1()) {\n+                    reconnections_to_add.emplace_back(\n+                        /*addr_connect=*/CAddress{pnode->addr, ServiceFlags{pnode->addr.nServices & ~NODE_P2P_V2}},",
      "path": "src/net.cpp",
      "position": null,
      "original_position": 64,
      "commit_id": "75a329103505736acb9036224da2dfa8ab038c43",
      "original_commit_id": "5917b6b5d798b18daa949f03de7c37b6038011fd",
      "in_reply_to_id": 1336044983,
      "user": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "Done.",
      "created_at": "2023-09-27T12:42:18Z",
      "updated_at": "2023-09-27T12:42:18Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28331#discussion_r1338547782",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1338547782"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28331"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1952,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1338548046",
      "pull_request_review_id": 1646378816,
      "id": 1338548046,
      "node_id": "PRRC_kwDOABII585PyJ9O",
      "diff_hunk": "@@ -3602,6 +3613,15 @@ ServiceFlags CConnman::GetLocalServices() const\n     return nLocalServices;\n }\n \n+static std::unique_ptr<Transport> MakeTransport(NodeId id, bool use_v2transport, bool inbound) noexcept\n+{\n+    if (use_v2transport) {\n+        return std::make_unique<V2Transport>(id, /*initiating=*/!inbound, SER_NETWORK, INIT_PROTO_VERSION);\n+    } else {\n+        return std::make_unique<V1Transport>(id, SER_NETWORK, INIT_PROTO_VERSION);",
      "path": "src/net.cpp",
      "position": 392,
      "original_position": 57,
      "commit_id": "75a329103505736acb9036224da2dfa8ab038c43",
      "original_commit_id": "bcde50035e02dc0b04693423bc89a029b3468ca4",
      "in_reply_to_id": 1336030845,
      "user": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "Listed as a potential follow-up in #27634",
      "created_at": "2023-09-27T12:42:32Z",
      "updated_at": "2023-09-27T12:42:32Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28331#discussion_r1338548046",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1338548046"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28331"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 3679,
      "original_line": 3679,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1338548242",
      "pull_request_review_id": 1646379155,
      "id": 1338548242,
      "node_id": "PRRC_kwDOABII585PyKAS",
      "diff_hunk": "@@ -289,11 +289,12 @@ static RPCHelpMan addnode()\n                 {\n                     {\"node\", RPCArg::Type::STR, RPCArg::Optional::NO, \"The address of the peer to connect to\"},\n                     {\"command\", RPCArg::Type::STR, RPCArg::Optional::NO, \"'add' to add a node to the list, 'remove' to remove a node from the list, 'onetry' to try a connection to the node once\"},\n+                    {\"v2transport\", RPCArg::Type::BOOL, RPCArg::Default{false}, \"Peer supports BIP324 v2 transport protocol\"},",
      "path": "src/rpc/net.cpp",
      "position": null,
      "original_position": 4,
      "commit_id": "75a329103505736acb9036224da2dfa8ab038c43",
      "original_commit_id": "1ca110830801bcb0bd14b35c01d8ba6420cd3816",
      "in_reply_to_id": 1336075612,
      "user": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "Done.",
      "created_at": "2023-09-27T12:42:44Z",
      "updated_at": "2023-09-27T12:42:44Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28331#discussion_r1338548242",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1338548242"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28331"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 292,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1338548596",
      "pull_request_review_id": 1646379716,
      "id": 1338548596,
      "node_id": "PRRC_kwDOABII585PyKF0",
      "diff_hunk": "@@ -1392,7 +1400,10 @@ class CConnman\n     const NetGroupManager& m_netgroupman;\n     std::deque<std::string> m_addr_fetches GUARDED_BY(m_addr_fetches_mutex);\n     Mutex m_addr_fetches_mutex;\n-    std::vector<std::string> m_added_nodes GUARDED_BY(m_added_nodes_mutex);\n+\n+    // connection string and whether to use v2 p2p\n+    std::vector<AddedNodeParams> m_added_nodes GUARDED_BY(m_added_nodes_mutex);",
      "path": "src/net.h",
      "position": null,
      "original_position": 46,
      "commit_id": "75a329103505736acb9036224da2dfa8ab038c43",
      "original_commit_id": "1ca110830801bcb0bd14b35c01d8ba6420cd3816",
      "in_reply_to_id": 1336152800,
      "user": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "Renamed, and also renamed some related variables in other places to avoid name collisions.",
      "created_at": "2023-09-27T12:43:01Z",
      "updated_at": "2023-09-27T12:43:10Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28331#discussion_r1338548596",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1338548596"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28331"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1405,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1340031401",
      "pull_request_review_id": 1648656534,
      "id": 1340031401,
      "node_id": "PRRC_kwDOABII585P30Gp",
      "diff_hunk": "@@ -1567,15 +1582,40 @@ void V2Transport::MarkBytesSent(size_t bytes_sent) noexcept\n     LOCK(m_send_mutex);\n     if (m_send_state == SendState::V1) return m_v1_fallback.MarkBytesSent(bytes_sent);\n \n+    if (m_send_state == SendState::AWAITING_KEY && m_send_pos == 0 && bytes_sent > 0) {\n+        LogPrint(BCLog::NET, \"start sending v2 handshake to peer=%d\\n\", m_nodeid);\n+    }\n+\n     m_send_pos += bytes_sent;\n     Assume(m_send_pos <= m_send_buffer.size());\n+    if (m_send_pos >= CMessageHeader::HEADER_SIZE) {\n+        m_sent_v1_header_worth = true;\n+    }\n     // Wipe the buffer when everything is sent.\n     if (m_send_pos == m_send_buffer.size()) {\n         m_send_pos = 0;\n         ClearShrink(m_send_buffer);\n     }\n }\n \n+bool V2Transport::ShouldReconnectV1() const noexcept\n+{\n+    AssertLockNotHeld(m_send_mutex);\n+    AssertLockNotHeld(m_recv_mutex);\n+    // Only outgoing connections need reconnection.\n+    if (!m_initiating) return false;\n+\n+    LOCK(m_recv_mutex);\n+    // Only in the very first state (where m_recv_buffer.empty() means nothing received) do\n+    // we reconnect.\n+    if (m_recv_state != RecvState::KEY) return false;\n+    // Only when nothing has been received do we reconnect.\n+    if (!m_recv_buffer.empty()) return false;",
      "path": "src/net.cpp",
      "position": null,
      "original_position": 93,
      "commit_id": "75a329103505736acb9036224da2dfa8ab038c43",
      "original_commit_id": "830b23ab80ac089c15e232d1b1e6bbd781ddc749",
      "in_reply_to_id": null,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "The two comments don't quite match the two conditions - the first comment mentions `m_recv_buffer.empty()` which is checked in the second condition. Maybe move `(where m_recv_buffer.empty() means nothing received)` from the first comment to the second.",
      "created_at": "2023-09-28T12:09:20Z",
      "updated_at": "2023-09-28T13:27:53Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28331#discussion_r1340031401",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1340031401"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28331"
        }
      },
      "start_line": null,
      "original_start_line": 1609,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 1582,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1340038726",
      "pull_request_review_id": 1648656534,
      "id": 1340038726,
      "node_id": "PRRC_kwDOABII585P315G",
      "diff_hunk": "@@ -1567,15 +1582,40 @@ void V2Transport::MarkBytesSent(size_t bytes_sent) noexcept\n     LOCK(m_send_mutex);\n     if (m_send_state == SendState::V1) return m_v1_fallback.MarkBytesSent(bytes_sent);\n \n+    if (m_send_state == SendState::AWAITING_KEY && m_send_pos == 0 && bytes_sent > 0) {\n+        LogPrint(BCLog::NET, \"start sending v2 handshake to peer=%d\\n\", m_nodeid);\n+    }\n+\n     m_send_pos += bytes_sent;\n     Assume(m_send_pos <= m_send_buffer.size());\n+    if (m_send_pos >= CMessageHeader::HEADER_SIZE) {\n+        m_sent_v1_header_worth = true;\n+    }\n     // Wipe the buffer when everything is sent.\n     if (m_send_pos == m_send_buffer.size()) {\n         m_send_pos = 0;\n         ClearShrink(m_send_buffer);\n     }\n }\n \n+bool V2Transport::ShouldReconnectV1() const noexcept",
      "path": "src/net.cpp",
      "position": 69,
      "original_position": 81,
      "commit_id": "75a329103505736acb9036224da2dfa8ab038c43",
      "original_commit_id": "830b23ab80ac089c15e232d1b1e6bbd781ddc749",
      "in_reply_to_id": null,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "Commit 75c02891b1 `net: use V2Transport when NODE_P2P_V2 service flag is present` is somewhat broken in isolation because it would try to connect using V2 without a fallback to V1. This is later amended in commit d22f715331 `net: reconnect with V1Transport under certain conditions`. Maybe squash both into one commit?",
      "created_at": "2023-09-28T12:14:02Z",
      "updated_at": "2023-09-28T13:27:53Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28331#discussion_r1340038726",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1340038726"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28331"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 1571,
      "original_line": 1571,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1340069761",
      "pull_request_review_id": 1648656534,
      "id": 1340069761,
      "node_id": "PRRC_kwDOABII585P39eB",
      "diff_hunk": "@@ -345,53 +357,70 @@ class CSemaphoreGrant\n     bool fHaveGrant;\n \n public:\n-    void Acquire()\n+    void Acquire() noexcept\n     {\n-        if (fHaveGrant)\n+        if (fHaveGrant) {\n             return;\n+        }\n         sem->wait();\n         fHaveGrant = true;\n     }\n \n-    void Release()\n+    void Release() noexcept\n     {\n-        if (!fHaveGrant)\n+        if (!fHaveGrant) {\n             return;\n+        }\n         sem->post();\n         fHaveGrant = false;\n     }\n \n-    bool TryAcquire()\n+    bool TryAcquire() noexcept\n     {\n-        if (!fHaveGrant && sem->try_wait())\n+        if (!fHaveGrant && sem->try_wait()) {\n             fHaveGrant = true;\n+        }\n         return fHaveGrant;\n     }\n \n-    void MoveTo(CSemaphoreGrant& grant)\n+    // Disallow copy.\n+    CSemaphoreGrant(const CSemaphoreGrant&) = delete;\n+    CSemaphoreGrant& operator=(const CSemaphoreGrant&) = delete;\n+\n+    // Allow move.\n+    CSemaphoreGrant(CSemaphoreGrant&& other) noexcept\n+    {\n+        sem = other.sem;\n+        fHaveGrant = other.fHaveGrant;\n+        other.fHaveGrant = false;\n+    }",
      "path": "src/sync.h",
      "position": null,
      "original_position": 97,
      "commit_id": "75a329103505736acb9036224da2dfa8ab038c43",
      "original_commit_id": "830b23ab80ac089c15e232d1b1e6bbd781ddc749",
      "in_reply_to_id": null,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "Might as well set `other.sem = nullptr;`.",
      "created_at": "2023-09-28T12:29:33Z",
      "updated_at": "2023-09-28T13:27:53Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28331#discussion_r1340069761",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1340069761"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28331"
        }
      },
      "start_line": null,
      "original_start_line": 391,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 397,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1340093132",
      "pull_request_review_id": 1648656534,
      "id": 1340093132,
      "node_id": "PRRC_kwDOABII585P4DLM",
      "diff_hunk": "@@ -1906,6 +1979,20 @@ void CConnman::DisconnectNodes()\n                 // remove from m_nodes\n                 m_nodes.erase(remove(m_nodes.begin(), m_nodes.end(), pnode), m_nodes.end());\n \n+                // Add to reconnection list if appropriate. We don't reconnect right here, because\n+                // the creation of a connection is a blocking operation (up to several seconds),\n+                // and we don't want to hold up the socket handler thread for that long.\n+                if (pnode->m_transport->ShouldReconnectV1()) {\n+                    reconnections_to_add.emplace_back(ReconnectionInfo{\n+                        // Removing NODE_P2P_V2 here ensures we reconnect using V1.\n+                        .addr_connect = CAddress{pnode->addr, ServiceFlags{pnode->addr.nServices & ~NODE_P2P_V2}},\n+                        .count_failure = pnode->m_count_failure_after_reconnect,\n+                        .grant = std::move(pnode->grantOutbound),\n+                        .destination = pnode->m_dest,\n+                        .conn_type = pnode->m_conn_type});",
      "path": "src/net.cpp",
      "position": null,
      "original_position": 186,
      "commit_id": "75a329103505736acb9036224da2dfa8ab038c43",
      "original_commit_id": "830b23ab80ac089c15e232d1b1e6bbd781ddc749",
      "in_reply_to_id": null,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "This will create a temporary object of type `ReconnectionInfo`, and will move-construct a new element in `reconnections_to_add` from the temporary. This defeats the purpose of `emplace_back()`, might as well use `push_back()`, or drop `ReconnectionInfo{`.",
      "created_at": "2023-09-28T12:45:26Z",
      "updated_at": "2023-09-28T13:27:53Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28331#discussion_r1340093132",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1340093132"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28331"
        }
      },
      "start_line": null,
      "original_start_line": 1986,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 1961,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1340123892",
      "pull_request_review_id": 1648656534,
      "id": 1340123892,
      "node_id": "PRRC_kwDOABII585P4Kr0",
      "diff_hunk": "@@ -704,8 +739,12 @@ class CNode\n     // Bind address of our side of the connection\n     const CAddress addrBind;\n     const std::string m_addr_name;\n+    /** The pszDest argument provided ConnectNode(). Only used for reconnections. */",
      "path": "src/net.h",
      "position": null,
      "original_position": 110,
      "commit_id": "75a329103505736acb9036224da2dfa8ab038c43",
      "original_commit_id": "830b23ab80ac089c15e232d1b1e6bbd781ddc749",
      "in_reply_to_id": null,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "```suggestion\r\n    /** The pszDest argument provided to ConnectNode(). Only used for reconnections. */\r\n```",
      "created_at": "2023-09-28T13:06:20Z",
      "updated_at": "2023-09-28T13:27:53Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28331#discussion_r1340123892",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1340123892"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28331"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 742,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1340130617",
      "pull_request_review_id": 1648656534,
      "id": 1340130617,
      "node_id": "PRRC_kwDOABII585P4MU5",
      "diff_hunk": "@@ -1906,6 +1979,20 @@ void CConnman::DisconnectNodes()\n                 // remove from m_nodes\n                 m_nodes.erase(remove(m_nodes.begin(), m_nodes.end(), pnode), m_nodes.end());\n \n+                // Add to reconnection list if appropriate. We don't reconnect right here, because\n+                // the creation of a connection is a blocking operation (up to several seconds),\n+                // and we don't want to hold up the socket handler thread for that long.\n+                if (pnode->m_transport->ShouldReconnectV1()) {",
      "path": "src/net.cpp",
      "position": 175,
      "original_position": 179,
      "commit_id": "75a329103505736acb9036224da2dfa8ab038c43",
      "original_commit_id": "830b23ab80ac089c15e232d1b1e6bbd781ddc749",
      "in_reply_to_id": null,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "When we fail to connect using V2 and succeed to connect using V1, should we bother removing `NODE_P2P_V2` for that node from addrman?",
      "created_at": "2023-09-28T13:10:04Z",
      "updated_at": "2023-09-28T13:27:54Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28331#discussion_r1340130617",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1340130617"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28331"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 1956,
      "original_line": 1956,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1340150936",
      "pull_request_review_id": 1648656534,
      "id": 1340150936,
      "node_id": "PRRC_kwDOABII585P4RSY",
      "diff_hunk": "@@ -79,4 +79,14 @@ enum class ConnectionType {\n /** Convert ConnectionType enum to a string value */\n std::string ConnectionTypeAsString(ConnectionType conn_type);\n \n+/** Transport layer version */\n+enum class TransportProtocolType {\n+    DETECTING, //!< Peer could be v1 or v2\n+    V1, //!< Unencrypted, plaintext protocol\n+    V2, //!< BIP324 protocol\n+};",
      "path": "src/node/connection_types.h",
      "position": null,
      "original_position": 9,
      "commit_id": "75a329103505736acb9036224da2dfa8ab038c43",
      "original_commit_id": "830b23ab80ac089c15e232d1b1e6bbd781ddc749",
      "in_reply_to_id": null,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "I don't know why I don't see this warning when compiling, but only inside youcompleteme. Both should be using the same flags. Anyway, mentioning it here:\r\n\r\n> src/node/connection_types.h|17 col 12 error| Enum 'ConnectionType' uses a larger base type ('int', size: 4 bytes) than necessary for its value set, consider using 'std::uint8_t' (1 byte) as the base type to reduce its size [performance-  enum-size]    ",
      "created_at": "2023-09-28T13:22:36Z",
      "updated_at": "2023-09-28T13:27:54Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28331#discussion_r1340150936",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1340150936"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28331"
        }
      },
      "start_line": null,
      "original_start_line": 83,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 88,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1340405559",
      "pull_request_review_id": 1649267468,
      "id": 1340405559,
      "node_id": "PRRC_kwDOABII585P5Pc3",
      "diff_hunk": "@@ -1567,15 +1582,40 @@ void V2Transport::MarkBytesSent(size_t bytes_sent) noexcept\n     LOCK(m_send_mutex);\n     if (m_send_state == SendState::V1) return m_v1_fallback.MarkBytesSent(bytes_sent);\n \n+    if (m_send_state == SendState::AWAITING_KEY && m_send_pos == 0 && bytes_sent > 0) {\n+        LogPrint(BCLog::NET, \"start sending v2 handshake to peer=%d\\n\", m_nodeid);\n+    }\n+\n     m_send_pos += bytes_sent;\n     Assume(m_send_pos <= m_send_buffer.size());\n+    if (m_send_pos >= CMessageHeader::HEADER_SIZE) {\n+        m_sent_v1_header_worth = true;\n+    }\n     // Wipe the buffer when everything is sent.\n     if (m_send_pos == m_send_buffer.size()) {\n         m_send_pos = 0;\n         ClearShrink(m_send_buffer);\n     }\n }\n \n+bool V2Transport::ShouldReconnectV1() const noexcept",
      "path": "src/net.cpp",
      "position": 69,
      "original_position": 81,
      "commit_id": "75a329103505736acb9036224da2dfa8ab038c43",
      "original_commit_id": "830b23ab80ac089c15e232d1b1e6bbd781ddc749",
      "in_reply_to_id": 1340038726,
      "user": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "I feel they're sufficiently distinct aspects that having them in separate commits is helpful for review. Sure, the first commit on its own may not result in exactly ideal behavior, but I also don't think it's broken.",
      "created_at": "2023-09-28T16:29:46Z",
      "updated_at": "2023-09-28T16:29:46Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28331#discussion_r1340405559",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1340405559"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28331"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 1571,
      "original_line": 1571,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1340409803",
      "pull_request_review_id": 1649276560,
      "id": 1340409803,
      "node_id": "PRRC_kwDOABII585P5QfL",
      "diff_hunk": "@@ -1906,6 +1979,20 @@ void CConnman::DisconnectNodes()\n                 // remove from m_nodes\n                 m_nodes.erase(remove(m_nodes.begin(), m_nodes.end(), pnode), m_nodes.end());\n \n+                // Add to reconnection list if appropriate. We don't reconnect right here, because\n+                // the creation of a connection is a blocking operation (up to several seconds),\n+                // and we don't want to hold up the socket handler thread for that long.\n+                if (pnode->m_transport->ShouldReconnectV1()) {",
      "path": "src/net.cpp",
      "position": 175,
      "original_position": 179,
      "commit_id": "75a329103505736acb9036224da2dfa8ab038c43",
      "original_commit_id": "830b23ab80ac089c15e232d1b1e6bbd781ddc749",
      "in_reply_to_id": 1340130617,
      "user": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "That already happens; whenever an outbound peer's services are received from them, we overwrite their entry in addrman (see `m_addrman.SetServices(pfrom.addr, nServices);` line in net_processing). It's not dependent on the actual transport used for the current connection, but I don't think that incorporating that is helpful. If a peer lies about their supported services, they only hurt their own ability of being connected to.",
      "created_at": "2023-09-28T16:32:23Z",
      "updated_at": "2023-09-28T16:32:23Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28331#discussion_r1340409803",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1340409803"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28331"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 1956,
      "original_line": 1956,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1340452505",
      "pull_request_review_id": 1649354743,
      "id": 1340452505,
      "node_id": "PRRC_kwDOABII585P5a6Z",
      "diff_hunk": "@@ -1567,15 +1582,40 @@ void V2Transport::MarkBytesSent(size_t bytes_sent) noexcept\n     LOCK(m_send_mutex);\n     if (m_send_state == SendState::V1) return m_v1_fallback.MarkBytesSent(bytes_sent);\n \n+    if (m_send_state == SendState::AWAITING_KEY && m_send_pos == 0 && bytes_sent > 0) {\n+        LogPrint(BCLog::NET, \"start sending v2 handshake to peer=%d\\n\", m_nodeid);\n+    }\n+\n     m_send_pos += bytes_sent;\n     Assume(m_send_pos <= m_send_buffer.size());\n+    if (m_send_pos >= CMessageHeader::HEADER_SIZE) {\n+        m_sent_v1_header_worth = true;\n+    }\n     // Wipe the buffer when everything is sent.\n     if (m_send_pos == m_send_buffer.size()) {\n         m_send_pos = 0;\n         ClearShrink(m_send_buffer);\n     }\n }\n \n+bool V2Transport::ShouldReconnectV1() const noexcept\n+{\n+    AssertLockNotHeld(m_send_mutex);\n+    AssertLockNotHeld(m_recv_mutex);\n+    // Only outgoing connections need reconnection.\n+    if (!m_initiating) return false;\n+\n+    LOCK(m_recv_mutex);\n+    // Only in the very first state (where m_recv_buffer.empty() means nothing received) do\n+    // we reconnect.\n+    if (m_recv_state != RecvState::KEY) return false;\n+    // Only when nothing has been received do we reconnect.\n+    if (!m_recv_buffer.empty()) return false;",
      "path": "src/net.cpp",
      "position": null,
      "original_position": 93,
      "commit_id": "75a329103505736acb9036224da2dfa8ab038c43",
      "original_commit_id": "830b23ab80ac089c15e232d1b1e6bbd781ddc749",
      "in_reply_to_id": 1340031401,
      "user": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "I've rewritten the comments (and merged them into one).",
      "created_at": "2023-09-28T17:10:13Z",
      "updated_at": "2023-09-28T17:10:14Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28331#discussion_r1340452505",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1340452505"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28331"
        }
      },
      "start_line": null,
      "original_start_line": 1609,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 1582,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1340452828",
      "pull_request_review_id": 1649355304,
      "id": 1340452828,
      "node_id": "PRRC_kwDOABII585P5a_c",
      "diff_hunk": "@@ -345,53 +357,70 @@ class CSemaphoreGrant\n     bool fHaveGrant;\n \n public:\n-    void Acquire()\n+    void Acquire() noexcept\n     {\n-        if (fHaveGrant)\n+        if (fHaveGrant) {\n             return;\n+        }\n         sem->wait();\n         fHaveGrant = true;\n     }\n \n-    void Release()\n+    void Release() noexcept\n     {\n-        if (!fHaveGrant)\n+        if (!fHaveGrant) {\n             return;\n+        }\n         sem->post();\n         fHaveGrant = false;\n     }\n \n-    bool TryAcquire()\n+    bool TryAcquire() noexcept\n     {\n-        if (!fHaveGrant && sem->try_wait())\n+        if (!fHaveGrant && sem->try_wait()) {\n             fHaveGrant = true;\n+        }\n         return fHaveGrant;\n     }\n \n-    void MoveTo(CSemaphoreGrant& grant)\n+    // Disallow copy.\n+    CSemaphoreGrant(const CSemaphoreGrant&) = delete;\n+    CSemaphoreGrant& operator=(const CSemaphoreGrant&) = delete;\n+\n+    // Allow move.\n+    CSemaphoreGrant(CSemaphoreGrant&& other) noexcept\n+    {\n+        sem = other.sem;\n+        fHaveGrant = other.fHaveGrant;\n+        other.fHaveGrant = false;\n+    }",
      "path": "src/sync.h",
      "position": null,
      "original_position": 97,
      "commit_id": "75a329103505736acb9036224da2dfa8ab038c43",
      "original_commit_id": "830b23ab80ac089c15e232d1b1e6bbd781ddc749",
      "in_reply_to_id": 1340069761,
      "user": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "~~Done.~~\r\n\r\nEDIT: reverted. Apparently the (existing) semantics related moving of semaphore *grants* is that the grant moves, but the associated semaphore remains.",
      "created_at": "2023-09-28T17:10:36Z",
      "updated_at": "2023-09-28T22:16:58Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28331#discussion_r1340452828",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1340452828"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28331"
        }
      },
      "start_line": null,
      "original_start_line": 391,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 397,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1340453104",
      "pull_request_review_id": 1649355698,
      "id": 1340453104,
      "node_id": "PRRC_kwDOABII585P5bDw",
      "diff_hunk": "@@ -1906,6 +1979,20 @@ void CConnman::DisconnectNodes()\n                 // remove from m_nodes\n                 m_nodes.erase(remove(m_nodes.begin(), m_nodes.end(), pnode), m_nodes.end());\n \n+                // Add to reconnection list if appropriate. We don't reconnect right here, because\n+                // the creation of a connection is a blocking operation (up to several seconds),\n+                // and we don't want to hold up the socket handler thread for that long.\n+                if (pnode->m_transport->ShouldReconnectV1()) {\n+                    reconnections_to_add.emplace_back(ReconnectionInfo{\n+                        // Removing NODE_P2P_V2 here ensures we reconnect using V1.\n+                        .addr_connect = CAddress{pnode->addr, ServiceFlags{pnode->addr.nServices & ~NODE_P2P_V2}},\n+                        .count_failure = pnode->m_count_failure_after_reconnect,\n+                        .grant = std::move(pnode->grantOutbound),\n+                        .destination = pnode->m_dest,\n+                        .conn_type = pnode->m_conn_type});",
      "path": "src/net.cpp",
      "position": null,
      "original_position": 186,
      "commit_id": "75a329103505736acb9036224da2dfa8ab038c43",
      "original_commit_id": "830b23ab80ac089c15e232d1b1e6bbd781ddc749",
      "in_reply_to_id": 1340093132,
      "user": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "Switched to `push_back` and dropped `ReconnectionInfo{`.",
      "created_at": "2023-09-28T17:10:52Z",
      "updated_at": "2023-09-28T17:10:53Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28331#discussion_r1340453104",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1340453104"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28331"
        }
      },
      "start_line": null,
      "original_start_line": 1986,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 1961,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1340453199",
      "pull_request_review_id": 1649355862,
      "id": 1340453199,
      "node_id": "PRRC_kwDOABII585P5bFP",
      "diff_hunk": "@@ -704,8 +739,12 @@ class CNode\n     // Bind address of our side of the connection\n     const CAddress addrBind;\n     const std::string m_addr_name;\n+    /** The pszDest argument provided ConnectNode(). Only used for reconnections. */",
      "path": "src/net.h",
      "position": null,
      "original_position": 110,
      "commit_id": "75a329103505736acb9036224da2dfa8ab038c43",
      "original_commit_id": "830b23ab80ac089c15e232d1b1e6bbd781ddc749",
      "in_reply_to_id": 1340123892,
      "user": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "Done.",
      "created_at": "2023-09-28T17:10:59Z",
      "updated_at": "2023-09-28T17:10:59Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28331#discussion_r1340453199",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1340453199"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28331"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 742,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1340453612",
      "pull_request_review_id": 1649356498,
      "id": 1340453612,
      "node_id": "PRRC_kwDOABII585P5bLs",
      "diff_hunk": "@@ -79,4 +79,14 @@ enum class ConnectionType {\n /** Convert ConnectionType enum to a string value */\n std::string ConnectionTypeAsString(ConnectionType conn_type);\n \n+/** Transport layer version */\n+enum class TransportProtocolType {\n+    DETECTING, //!< Peer could be v1 or v2\n+    V1, //!< Unencrypted, plaintext protocol\n+    V2, //!< BIP324 protocol\n+};",
      "path": "src/node/connection_types.h",
      "position": null,
      "original_position": 9,
      "commit_id": "75a329103505736acb9036224da2dfa8ab038c43",
      "original_commit_id": "830b23ab80ac089c15e232d1b1e6bbd781ddc749",
      "in_reply_to_id": 1340150936,
      "user": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "Done.",
      "created_at": "2023-09-28T17:11:25Z",
      "updated_at": "2023-09-28T17:11:26Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28331#discussion_r1340453612",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1340453612"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28331"
        }
      },
      "start_line": null,
      "original_start_line": 83,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 88,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1341152648",
      "pull_request_review_id": 1650446579,
      "id": 1341152648,
      "node_id": "PRRC_kwDOABII585P8F2I",
      "diff_hunk": "@@ -345,53 +357,70 @@ class CSemaphoreGrant\n     bool fHaveGrant;\n \n public:\n-    void Acquire()\n+    void Acquire() noexcept\n     {\n-        if (fHaveGrant)\n+        if (fHaveGrant) {\n             return;\n+        }\n         sem->wait();\n         fHaveGrant = true;\n     }\n \n-    void Release()\n+    void Release() noexcept\n     {\n-        if (!fHaveGrant)\n+        if (!fHaveGrant) {\n             return;\n+        }\n         sem->post();\n         fHaveGrant = false;\n     }\n \n-    bool TryAcquire()\n+    bool TryAcquire() noexcept\n     {\n-        if (!fHaveGrant && sem->try_wait())\n+        if (!fHaveGrant && sem->try_wait()) {\n             fHaveGrant = true;\n+        }\n         return fHaveGrant;\n     }\n \n-    void MoveTo(CSemaphoreGrant& grant)\n+    // Disallow copy.\n+    CSemaphoreGrant(const CSemaphoreGrant&) = delete;\n+    CSemaphoreGrant& operator=(const CSemaphoreGrant&) = delete;\n+\n+    // Allow move.\n+    CSemaphoreGrant(CSemaphoreGrant&& other) noexcept\n+    {\n+        sem = other.sem;\n+        fHaveGrant = other.fHaveGrant;\n+        other.fHaveGrant = false;\n+    }",
      "path": "src/sync.h",
      "position": null,
      "original_position": 97,
      "commit_id": "75a329103505736acb9036224da2dfa8ab038c43",
      "original_commit_id": "830b23ab80ac089c15e232d1b1e6bbd781ddc749",
      "in_reply_to_id": 1340069761,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "Is that necessary? I find it unexpected to leave the semaphore. Usually moved-from objects remain in some empty but valid state, e.g. as if default constructed. A semaphore grant that has a semaphore in it is not that. Did something break when you set `other.sem = nullptr`? I tried this patch:\r\n\r\n```diff\r\n@@ -390,20 +390,22 @@ public:\r\n     // Allow move.\r\n     CSemaphoreGrant(CSemaphoreGrant&& other) noexcept\r\n     {   \r\n         sem = other.sem;\r\n         fHaveGrant = other.fHaveGrant;\r\n         other.fHaveGrant = false;\r\n+        other.sem = nullptr;\r\n     }\r\n     \r\n     CSemaphoreGrant& operator=(CSemaphoreGrant&& other) noexcept\r\n     {   \r\n         Release();\r\n         sem = other.sem;\r\n         fHaveGrant = other.fHaveGrant;\r\n         other.fHaveGrant = false;\r\n+        other.sem = nullptr;\r\n         return *this;\r\n     }\r\n```\r\n\r\nand both unit tests and functional tests passed. I think the moved-from semaphore grant is not used after the move and is destroyed shortly afterwards.",
      "created_at": "2023-09-29T09:52:33Z",
      "updated_at": "2023-09-29T09:52:33Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28331#discussion_r1341152648",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1341152648"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28331"
        }
      },
      "start_line": null,
      "original_start_line": 391,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 397,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1341260059",
      "pull_request_review_id": 1650609000,
      "id": 1341260059,
      "node_id": "PRRC_kwDOABII585P8gEb",
      "diff_hunk": "@@ -345,53 +357,70 @@ class CSemaphoreGrant\n     bool fHaveGrant;\n \n public:\n-    void Acquire()\n+    void Acquire() noexcept\n     {\n-        if (fHaveGrant)\n+        if (fHaveGrant) {\n             return;\n+        }\n         sem->wait();\n         fHaveGrant = true;\n     }\n \n-    void Release()\n+    void Release() noexcept\n     {\n-        if (!fHaveGrant)\n+        if (!fHaveGrant) {\n             return;\n+        }\n         sem->post();\n         fHaveGrant = false;\n     }\n \n-    bool TryAcquire()\n+    bool TryAcquire() noexcept\n     {\n-        if (!fHaveGrant && sem->try_wait())\n+        if (!fHaveGrant && sem->try_wait()) {\n             fHaveGrant = true;\n+        }\n         return fHaveGrant;\n     }\n \n-    void MoveTo(CSemaphoreGrant& grant)\n+    // Disallow copy.\n+    CSemaphoreGrant(const CSemaphoreGrant&) = delete;\n+    CSemaphoreGrant& operator=(const CSemaphoreGrant&) = delete;\n+\n+    // Allow move.\n+    CSemaphoreGrant(CSemaphoreGrant&& other) noexcept\n+    {\n+        sem = other.sem;\n+        fHaveGrant = other.fHaveGrant;\n+        other.fHaveGrant = false;\n+    }",
      "path": "src/sync.h",
      "position": null,
      "original_position": 97,
      "commit_id": "75a329103505736acb9036224da2dfa8ab038c43",
      "original_commit_id": "830b23ab80ac089c15e232d1b1e6bbd781ddc749",
      "in_reply_to_id": 1340069761,
      "user": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "It very quickly crashes on normal mainnet for me with this patch, possibly because it's related to automatic connections which aren't used in the functional test framework.\n\nI do want to investigate more what's actually necessary here, because I agree that relying on the state of a moved-from object is strange.",
      "created_at": "2023-09-29T11:39:10Z",
      "updated_at": "2023-09-29T11:39:10Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28331#discussion_r1341260059",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1341260059"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28331"
        }
      },
      "start_line": null,
      "original_start_line": 391,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 397,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1341327680",
      "pull_request_review_id": 1650718473,
      "id": 1341327680,
      "node_id": "PRRC_kwDOABII585P8wlA",
      "diff_hunk": "@@ -0,0 +1,30 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2021-present The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"\n+Test v2 transport\n+\"\"\"\n+\n+from test_framework.messages import NODE_P2P_V2\n+from test_framework.test_framework import BitcoinTestFramework\n+from test_framework.util import assert_equal\n+\n+class V2TransportTest(BitcoinTestFramework):",
      "path": "test/functional/p2p_v2_transport.py",
      "position": 13,
      "original_position": 13,
      "commit_id": "75a329103505736acb9036224da2dfa8ab038c43",
      "original_commit_id": "e07a6bff37d4cbad8266117492ed544c4727ef96",
      "in_reply_to_id": null,
      "user": {
        "login": "Sjors",
        "id": 10217,
        "node_id": "MDQ6VXNlcjEwMjE3",
        "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Sjors",
        "html_url": "https://github.com/Sjors",
        "followers_url": "https://api.github.com/users/Sjors/followers",
        "following_url": "https://api.github.com/users/Sjors/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Sjors/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Sjors/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
        "organizations_url": "https://api.github.com/users/Sjors/orgs",
        "repos_url": "https://api.github.com/users/Sjors/repos",
        "events_url": "https://api.github.com/users/Sjors/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Sjors/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "af8a90d0c27c3b0787b66094e7db6662596bed71 test seems unrelated to this commit and probably could have been introduced earlier in 9b378d3093a3c7ae3c944e469faf5bea67459b07.",
      "created_at": "2023-09-29T12:52:32Z",
      "updated_at": "2023-09-29T16:31:06Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28331#discussion_r1341327680",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1341327680"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28331"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 13,
      "original_line": 13,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1341336060",
      "pull_request_review_id": 1650718473,
      "id": 1341336060,
      "node_id": "PRRC_kwDOABII585P8yn8",
      "diff_hunk": "@@ -472,7 +472,7 @@ CNode* CConnman::ConnectNode(CAddress addrConnect, const char *pszDest, bool fCo\n         const std::vector<CService> resolved{Lookup(pszDest, default_port, fNameLookup && !HaveNameProxy(), 256)};\n         if (!resolved.empty()) {\n             const CService& rnd{resolved[GetRand(resolved.size())]};\n-            addrConnect = CAddress{MaybeFlipIPv6toCJDNS(rnd), NODE_NONE};\n+            addrConnect = CAddress{MaybeFlipIPv6toCJDNS(rnd), addrConnect.nServices};",
      "path": "src/net.cpp",
      "position": null,
      "original_position": 5,
      "commit_id": "75a329103505736acb9036224da2dfa8ab038c43",
      "original_commit_id": "e07a6bff37d4cbad8266117492ed544c4727ef96",
      "in_reply_to_id": null,
      "user": {
        "login": "Sjors",
        "id": 10217,
        "node_id": "MDQ6VXNlcjEwMjE3",
        "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Sjors",
        "html_url": "https://github.com/Sjors",
        "followers_url": "https://api.github.com/users/Sjors/followers",
        "following_url": "https://api.github.com/users/Sjors/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Sjors/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Sjors/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
        "organizations_url": "https://api.github.com/users/Sjors/orgs",
        "repos_url": "https://api.github.com/users/Sjors/repos",
        "events_url": "https://api.github.com/users/Sjors/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Sjors/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "af8a90d0c27c3b0787b66094e7db6662596bed71: isn't it usually (always?) the case that either `addrConnect` _or_ `pszDest` is provided by the caller? In which case this wouldn't do anything, but it's not harmful.\r\n\r\ncc @vasild who added this in #23077.",
      "created_at": "2023-09-29T13:00:47Z",
      "updated_at": "2023-09-29T16:31:06Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28331#discussion_r1341336060",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1341336060"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28331"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 472,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1341578475",
      "pull_request_review_id": 1650718473,
      "id": 1341578475,
      "node_id": "PRRC_kwDOABII585P9tzr",
      "diff_hunk": "@@ -345,53 +357,70 @@ class CSemaphoreGrant\n     bool fHaveGrant;\n \n public:\n-    void Acquire()\n+    void Acquire() noexcept\n     {\n-        if (fHaveGrant)\n+        if (fHaveGrant) {\n             return;\n+        }\n         sem->wait();\n         fHaveGrant = true;\n     }\n \n-    void Release()\n+    void Release() noexcept\n     {\n-        if (!fHaveGrant)\n+        if (!fHaveGrant) {\n             return;\n+        }\n         sem->post();\n         fHaveGrant = false;\n     }\n \n-    bool TryAcquire()\n+    bool TryAcquire() noexcept\n     {\n-        if (!fHaveGrant && sem->try_wait())\n+        if (!fHaveGrant && sem->try_wait()) {\n             fHaveGrant = true;\n+        }\n         return fHaveGrant;\n     }\n \n-    void MoveTo(CSemaphoreGrant& grant)\n+    // Disallow copy.\n+    CSemaphoreGrant(const CSemaphoreGrant&) = delete;\n+    CSemaphoreGrant& operator=(const CSemaphoreGrant&) = delete;\n+\n+    // Allow move.\n+    CSemaphoreGrant(CSemaphoreGrant&& other) noexcept\n+    {\n+        sem = other.sem;\n+        fHaveGrant = other.fHaveGrant;\n+        other.fHaveGrant = false;\n+    }",
      "path": "src/sync.h",
      "position": null,
      "original_position": 97,
      "commit_id": "75a329103505736acb9036224da2dfa8ab038c43",
      "original_commit_id": "830b23ab80ac089c15e232d1b1e6bbd781ddc749",
      "in_reply_to_id": 1340069761,
      "user": {
        "login": "Sjors",
        "id": 10217,
        "node_id": "MDQ6VXNlcjEwMjE3",
        "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Sjors",
        "html_url": "https://github.com/Sjors",
        "followers_url": "https://api.github.com/users/Sjors/followers",
        "following_url": "https://api.github.com/users/Sjors/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Sjors/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Sjors/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
        "organizations_url": "https://api.github.com/users/Sjors/orgs",
        "repos_url": "https://api.github.com/users/Sjors/repos",
        "events_url": "https://api.github.com/users/Sjors/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Sjors/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "`ThreadOpenAddedConnections` creates a `CSemaphoreGrant` before it loops over `vInfo`. Maybe that causes problems for a subsequent item? This function seems to relate to manually added connections.\r\n\r\nMost functional tests use the `onetry` command when they call `addnode`, which calls `OpenNetworkConnection` directly. Except for `rpc_net.py` which uses `add`, but it's never trying more than 1 node at a time.\r\n\r\nI'm able to illustrate the crash by modifying the above test to add a second peer connection: https://github.com/Sjors/bitcoin/commit/0079c5143a4efc50a016e970bcedbbf6eca79007 (and lowering the wait in `ThreadOpenAddedConnections` and having the test wait a bit)",
      "created_at": "2023-09-29T16:29:12Z",
      "updated_at": "2023-09-29T16:32:41Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28331#discussion_r1341578475",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1341578475"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28331"
        }
      },
      "start_line": null,
      "original_start_line": 391,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 397,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1341590904",
      "pull_request_review_id": 1651149686,
      "id": 1341590904,
      "node_id": "PRRC_kwDOABII585P9w14",
      "diff_hunk": "@@ -472,7 +472,7 @@ CNode* CConnman::ConnectNode(CAddress addrConnect, const char *pszDest, bool fCo\n         const std::vector<CService> resolved{Lookup(pszDest, default_port, fNameLookup && !HaveNameProxy(), 256)};\n         if (!resolved.empty()) {\n             const CService& rnd{resolved[GetRand(resolved.size())]};\n-            addrConnect = CAddress{MaybeFlipIPv6toCJDNS(rnd), NODE_NONE};\n+            addrConnect = CAddress{MaybeFlipIPv6toCJDNS(rnd), addrConnect.nServices};",
      "path": "src/net.cpp",
      "position": null,
      "original_position": 5,
      "commit_id": "75a329103505736acb9036224da2dfa8ab038c43",
      "original_commit_id": "e07a6bff37d4cbad8266117492ed544c4727ef96",
      "in_reply_to_id": 1341336060,
      "user": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "\"in which case this wouldn't do anything\" -> what is the \"this\" referring to?",
      "created_at": "2023-09-29T16:42:55Z",
      "updated_at": "2023-09-29T16:42:56Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28331#discussion_r1341590904",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1341590904"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28331"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 472,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1341603742",
      "pull_request_review_id": 1651170038,
      "id": 1341603742,
      "node_id": "PRRC_kwDOABII585P9z-e",
      "diff_hunk": "@@ -472,7 +472,7 @@ CNode* CConnman::ConnectNode(CAddress addrConnect, const char *pszDest, bool fCo\n         const std::vector<CService> resolved{Lookup(pszDest, default_port, fNameLookup && !HaveNameProxy(), 256)};\n         if (!resolved.empty()) {\n             const CService& rnd{resolved[GetRand(resolved.size())]};\n-            addrConnect = CAddress{MaybeFlipIPv6toCJDNS(rnd), NODE_NONE};\n+            addrConnect = CAddress{MaybeFlipIPv6toCJDNS(rnd), addrConnect.nServices};",
      "path": "src/net.cpp",
      "position": null,
      "original_position": 5,
      "commit_id": "75a329103505736acb9036224da2dfa8ab038c43",
      "original_commit_id": "e07a6bff37d4cbad8266117492ed544c4727ef96",
      "in_reply_to_id": 1341336060,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "> either addrConnect or pszDest is provided by the caller\r\n\r\nThat used to be the case before this PR. This PR changes that to pass information via both params. I do not like this as I find it confusing but I did not bother mentioning it as too minor and subjective and I did not see a clear better way. Now that this has been raised already:\r\n\r\nThis PR uses `addrConnect` to pass the service flags even if the address to connect to is in `pszDest`. Can this be improved? Maybe instead of `pzsDest` pass `struct X { const char* dest, ServiceFlags services}`? And then pass `std::variant` of either `CAddress` or `X` (one argument instead of two).",
      "created_at": "2023-09-29T16:58:05Z",
      "updated_at": "2023-09-29T16:58:06Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28331#discussion_r1341603742",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1341603742"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28331"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 472,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1341621796",
      "pull_request_review_id": 1651198103,
      "id": 1341621796,
      "node_id": "PRRC_kwDOABII585P94Yk",
      "diff_hunk": "@@ -345,53 +357,70 @@ class CSemaphoreGrant\n     bool fHaveGrant;\n \n public:\n-    void Acquire()\n+    void Acquire() noexcept\n     {\n-        if (fHaveGrant)\n+        if (fHaveGrant) {\n             return;\n+        }\n         sem->wait();\n         fHaveGrant = true;\n     }\n \n-    void Release()\n+    void Release() noexcept\n     {\n-        if (!fHaveGrant)\n+        if (!fHaveGrant) {\n             return;\n+        }\n         sem->post();\n         fHaveGrant = false;\n     }\n \n-    bool TryAcquire()\n+    bool TryAcquire() noexcept\n     {\n-        if (!fHaveGrant && sem->try_wait())\n+        if (!fHaveGrant && sem->try_wait()) {\n             fHaveGrant = true;\n+        }\n         return fHaveGrant;\n     }\n \n-    void MoveTo(CSemaphoreGrant& grant)\n+    // Disallow copy.\n+    CSemaphoreGrant(const CSemaphoreGrant&) = delete;\n+    CSemaphoreGrant& operator=(const CSemaphoreGrant&) = delete;\n+\n+    // Allow move.\n+    CSemaphoreGrant(CSemaphoreGrant&& other) noexcept\n+    {\n+        sem = other.sem;\n+        fHaveGrant = other.fHaveGrant;\n+        other.fHaveGrant = false;\n+    }",
      "path": "src/sync.h",
      "position": null,
      "original_position": 97,
      "commit_id": "75a329103505736acb9036224da2dfa8ab038c43",
      "original_commit_id": "830b23ab80ac089c15e232d1b1e6bbd781ddc749",
      "in_reply_to_id": 1340069761,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "Hmm, so the code in `CConnman::ThreadOpenAddedConnections()` acquires the grant once and then opens connections to all entries in `vInfo`. Is this intended? Looks like a bug to me. It might as well exceed `MAX_ADDNODE_CONNECTIONS`. Unrelated to this PR, but should it acquire the grant inside the `for (const AddedNodeInfo& info : vInfo) {` loop?",
      "created_at": "2023-09-29T17:10:39Z",
      "updated_at": "2023-09-29T17:10:40Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28331#discussion_r1341621796",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1341621796"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28331"
        }
      },
      "start_line": null,
      "original_start_line": 391,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 397,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1341628661",
      "pull_request_review_id": 1651209365,
      "id": 1341628661,
      "node_id": "PRRC_kwDOABII585P96D1",
      "diff_hunk": "@@ -345,53 +357,70 @@ class CSemaphoreGrant\n     bool fHaveGrant;\n \n public:\n-    void Acquire()\n+    void Acquire() noexcept\n     {\n-        if (fHaveGrant)\n+        if (fHaveGrant) {\n             return;\n+        }\n         sem->wait();\n         fHaveGrant = true;\n     }\n \n-    void Release()\n+    void Release() noexcept\n     {\n-        if (!fHaveGrant)\n+        if (!fHaveGrant) {\n             return;\n+        }\n         sem->post();\n         fHaveGrant = false;\n     }\n \n-    bool TryAcquire()\n+    bool TryAcquire() noexcept\n     {\n-        if (!fHaveGrant && sem->try_wait())\n+        if (!fHaveGrant && sem->try_wait()) {\n             fHaveGrant = true;\n+        }\n         return fHaveGrant;\n     }\n \n-    void MoveTo(CSemaphoreGrant& grant)\n+    // Disallow copy.\n+    CSemaphoreGrant(const CSemaphoreGrant&) = delete;\n+    CSemaphoreGrant& operator=(const CSemaphoreGrant&) = delete;\n+\n+    // Allow move.\n+    CSemaphoreGrant(CSemaphoreGrant&& other) noexcept\n+    {\n+        sem = other.sem;\n+        fHaveGrant = other.fHaveGrant;\n+        other.fHaveGrant = false;\n+    }",
      "path": "src/sync.h",
      "position": null,
      "original_position": 97,
      "commit_id": "75a329103505736acb9036224da2dfa8ab038c43",
      "original_commit_id": "830b23ab80ac089c15e232d1b1e6bbd781ddc749",
      "in_reply_to_id": 1340069761,
      "user": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "Wouldn't [`grant.TryAcquire()`](https://github.com/sipa/bitcoin/blob/ee80555c30eb18bec8fc30ba4679f55464878074/src/net.cpp#L2872) inside the for loop fail and `break` once we reach `MAX_ADDNODE_CONNECTIONS`?",
      "created_at": "2023-09-29T17:19:15Z",
      "updated_at": "2023-09-29T17:19:15Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28331#discussion_r1341628661",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1341628661"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28331"
        }
      },
      "start_line": null,
      "original_start_line": 391,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 397,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1341635479",
      "pull_request_review_id": 1651219657,
      "id": 1341635479,
      "node_id": "PRRC_kwDOABII585P97uX",
      "diff_hunk": "@@ -345,53 +357,70 @@ class CSemaphoreGrant\n     bool fHaveGrant;\n \n public:\n-    void Acquire()\n+    void Acquire() noexcept\n     {\n-        if (fHaveGrant)\n+        if (fHaveGrant) {\n             return;\n+        }\n         sem->wait();\n         fHaveGrant = true;\n     }\n \n-    void Release()\n+    void Release() noexcept\n     {\n-        if (!fHaveGrant)\n+        if (!fHaveGrant) {\n             return;\n+        }\n         sem->post();\n         fHaveGrant = false;\n     }\n \n-    bool TryAcquire()\n+    bool TryAcquire() noexcept\n     {\n-        if (!fHaveGrant && sem->try_wait())\n+        if (!fHaveGrant && sem->try_wait()) {\n             fHaveGrant = true;\n+        }\n         return fHaveGrant;\n     }\n \n-    void MoveTo(CSemaphoreGrant& grant)\n+    // Disallow copy.\n+    CSemaphoreGrant(const CSemaphoreGrant&) = delete;\n+    CSemaphoreGrant& operator=(const CSemaphoreGrant&) = delete;\n+\n+    // Allow move.\n+    CSemaphoreGrant(CSemaphoreGrant&& other) noexcept\n+    {\n+        sem = other.sem;\n+        fHaveGrant = other.fHaveGrant;\n+        other.fHaveGrant = false;\n+    }",
      "path": "src/sync.h",
      "position": null,
      "original_position": 97,
      "commit_id": "75a329103505736acb9036224da2dfa8ab038c43",
      "original_commit_id": "830b23ab80ac089c15e232d1b1e6bbd781ddc749",
      "in_reply_to_id": 1340069761,
      "user": {
        "login": "ajtowns",
        "id": 127186,
        "node_id": "MDQ6VXNlcjEyNzE4Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/127186?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ajtowns",
        "html_url": "https://github.com/ajtowns",
        "followers_url": "https://api.github.com/users/ajtowns/followers",
        "following_url": "https://api.github.com/users/ajtowns/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ajtowns/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ajtowns/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ajtowns/subscriptions",
        "organizations_url": "https://api.github.com/users/ajtowns/orgs",
        "repos_url": "https://api.github.com/users/ajtowns/repos",
        "events_url": "https://api.github.com/users/ajtowns/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ajtowns/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "@vasild Agree. The code is fine at the moment, because passing `&grant` into `OpenNetworkConnections` at most only releases our grant, without invalidating it. Changing it to invalidate the grant makes our next addnode attempt fail due to reusing an invalid object.\r\n\r\n(There's no bug here I think -- if we hid max addnode connections, the `grant.TryAcquire()` will fail and we'll break out of the loop. Moving it into the loop as `CSemaphoreGrant grant(*semAddNode, /*fTry=*/tried);` would work, I think)",
      "created_at": "2023-09-29T17:26:47Z",
      "updated_at": "2023-09-29T17:29:04Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28331#discussion_r1341635479",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1341635479"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28331"
        }
      },
      "start_line": null,
      "original_start_line": 391,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 397,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1341652305",
      "pull_request_review_id": 1651247280,
      "id": 1341652305,
      "node_id": "PRRC_kwDOABII585P9_1R",
      "diff_hunk": "@@ -345,53 +357,70 @@ class CSemaphoreGrant\n     bool fHaveGrant;\n \n public:\n-    void Acquire()\n+    void Acquire() noexcept\n     {\n-        if (fHaveGrant)\n+        if (fHaveGrant) {\n             return;\n+        }\n         sem->wait();\n         fHaveGrant = true;\n     }\n \n-    void Release()\n+    void Release() noexcept\n     {\n-        if (!fHaveGrant)\n+        if (!fHaveGrant) {\n             return;\n+        }\n         sem->post();\n         fHaveGrant = false;\n     }\n \n-    bool TryAcquire()\n+    bool TryAcquire() noexcept\n     {\n-        if (!fHaveGrant && sem->try_wait())\n+        if (!fHaveGrant && sem->try_wait()) {\n             fHaveGrant = true;\n+        }\n         return fHaveGrant;\n     }\n \n-    void MoveTo(CSemaphoreGrant& grant)\n+    // Disallow copy.\n+    CSemaphoreGrant(const CSemaphoreGrant&) = delete;\n+    CSemaphoreGrant& operator=(const CSemaphoreGrant&) = delete;\n+\n+    // Allow move.\n+    CSemaphoreGrant(CSemaphoreGrant&& other) noexcept\n+    {\n+        sem = other.sem;\n+        fHaveGrant = other.fHaveGrant;\n+        other.fHaveGrant = false;\n+    }",
      "path": "src/sync.h",
      "position": null,
      "original_position": 97,
      "commit_id": "75a329103505736acb9036224da2dfa8ab038c43",
      "original_commit_id": "830b23ab80ac089c15e232d1b1e6bbd781ddc749",
      "in_reply_to_id": 1340069761,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "Right, I did not see the `TryAcquire()` call :facepalm:, no bug in master.\r\n\r\nNow the question that is relevant to this PR: what about moving the grant creation inside the `for` loop:\r\n\r\n```diff\r\n--- i/src/net.cpp\r\n+++ w/src/net.cpp\r\n@@ -2861,18 +2861,18 @@ std::vector<AddedNodeInfo> CConnman::GetAddedNodeInfo() const\r\n void CConnman::ThreadOpenAddedConnections()\r\n {   \r\n     AssertLockNotHeld(m_unused_i2p_sessions_mutex);\r\n     AssertLockNotHeld(m_reconnections_mutex);\r\n     while (true)\r\n     {\r\n-        CSemaphoreGrant grant(*semAddnode);\r\n         std::vector<AddedNodeInfo> vInfo = GetAddedNodeInfo();\r\n         bool tried = false;\r\n         for (const AddedNodeInfo& info : vInfo) {\r\n             if (!info.fConnected) {\r\n-                if (!grant.TryAcquire()) {\r\n+                CSemaphoreGrant grant(*semAddnode, /*fTry=*/true);\r\n+                if (!grant) {\r\n                     // If we've used up our semaphore and need a new one, let's not wait here since while we are waiti\r\n                     // the addednodeinfo state might change.\r\n                     break;\r\n                 }\r\n```\r\n\r\nand having the move semantic (more naturally) leave the moved-from object in a default-constructed state (have grant=false, sem=null)?",
      "created_at": "2023-09-29T17:48:08Z",
      "updated_at": "2023-09-29T17:48:08Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28331#discussion_r1341652305",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1341652305"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28331"
        }
      },
      "start_line": null,
      "original_start_line": 391,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 397,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1341677408",
      "pull_request_review_id": 1651289304,
      "id": 1341677408,
      "node_id": "PRRC_kwDOABII585P-F9g",
      "diff_hunk": "@@ -345,53 +357,70 @@ class CSemaphoreGrant\n     bool fHaveGrant;\n \n public:\n-    void Acquire()\n+    void Acquire() noexcept\n     {\n-        if (fHaveGrant)\n+        if (fHaveGrant) {\n             return;\n+        }\n         sem->wait();\n         fHaveGrant = true;\n     }\n \n-    void Release()\n+    void Release() noexcept\n     {\n-        if (!fHaveGrant)\n+        if (!fHaveGrant) {\n             return;\n+        }\n         sem->post();\n         fHaveGrant = false;\n     }\n \n-    bool TryAcquire()\n+    bool TryAcquire() noexcept\n     {\n-        if (!fHaveGrant && sem->try_wait())\n+        if (!fHaveGrant && sem->try_wait()) {\n             fHaveGrant = true;\n+        }\n         return fHaveGrant;\n     }\n \n-    void MoveTo(CSemaphoreGrant& grant)\n+    // Disallow copy.\n+    CSemaphoreGrant(const CSemaphoreGrant&) = delete;\n+    CSemaphoreGrant& operator=(const CSemaphoreGrant&) = delete;\n+\n+    // Allow move.\n+    CSemaphoreGrant(CSemaphoreGrant&& other) noexcept\n+    {\n+        sem = other.sem;\n+        fHaveGrant = other.fHaveGrant;\n+        other.fHaveGrant = false;\n+    }",
      "path": "src/sync.h",
      "position": null,
      "original_position": 97,
      "commit_id": "75a329103505736acb9036224da2dfa8ab038c43",
      "original_commit_id": "830b23ab80ac089c15e232d1b1e6bbd781ddc749",
      "in_reply_to_id": 1340069761,
      "user": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "I've re-introduced the `other.sem = nullptr;` statements in the move constructor/assignment, and made the corresponding fix in `ThreadOpenAddedConnections` too. I've also refactored the semaphore modernization commit a bit more to get rid of the pointers and use rvalue reference instead when moving is intended (to make it clearer when a variable shouldn't be used anymore).",
      "created_at": "2023-09-29T18:21:12Z",
      "updated_at": "2023-09-29T18:21:13Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28331#discussion_r1341677408",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1341677408"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28331"
        }
      },
      "start_line": null,
      "original_start_line": 391,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 397,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1341678508",
      "pull_request_review_id": 1651291013,
      "id": 1341678508,
      "node_id": "PRRC_kwDOABII585P-GOs",
      "diff_hunk": "@@ -345,53 +357,70 @@ class CSemaphoreGrant\n     bool fHaveGrant;\n \n public:\n-    void Acquire()\n+    void Acquire() noexcept\n     {\n-        if (fHaveGrant)\n+        if (fHaveGrant) {\n             return;\n+        }\n         sem->wait();\n         fHaveGrant = true;\n     }\n \n-    void Release()\n+    void Release() noexcept\n     {\n-        if (!fHaveGrant)\n+        if (!fHaveGrant) {\n             return;\n+        }\n         sem->post();\n         fHaveGrant = false;\n     }\n \n-    bool TryAcquire()\n+    bool TryAcquire() noexcept\n     {\n-        if (!fHaveGrant && sem->try_wait())\n+        if (!fHaveGrant && sem->try_wait()) {\n             fHaveGrant = true;\n+        }\n         return fHaveGrant;\n     }\n \n-    void MoveTo(CSemaphoreGrant& grant)\n+    // Disallow copy.\n+    CSemaphoreGrant(const CSemaphoreGrant&) = delete;\n+    CSemaphoreGrant& operator=(const CSemaphoreGrant&) = delete;\n+\n+    // Allow move.\n+    CSemaphoreGrant(CSemaphoreGrant&& other) noexcept\n+    {\n+        sem = other.sem;\n+        fHaveGrant = other.fHaveGrant;\n+        other.fHaveGrant = false;\n+    }",
      "path": "src/sync.h",
      "position": null,
      "original_position": 97,
      "commit_id": "75a329103505736acb9036224da2dfa8ab038c43",
      "original_commit_id": "830b23ab80ac089c15e232d1b1e6bbd781ddc749",
      "in_reply_to_id": 1340069761,
      "user": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "@Sjors Thanks a lot for reproducing the error. It helped locate the issue, and I used it to confirm the code I just pushed fixes the problem. Would you mind adding the test as a separate PR, if possible?",
      "created_at": "2023-09-29T18:22:31Z",
      "updated_at": "2023-09-29T18:22:31Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28331#discussion_r1341678508",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1341678508"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28331"
        }
      },
      "start_line": null,
      "original_start_line": 391,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 397,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1341678891",
      "pull_request_review_id": 1651291635,
      "id": 1341678891,
      "node_id": "PRRC_kwDOABII585P-GUr",
      "diff_hunk": "@@ -0,0 +1,30 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2021-present The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"\n+Test v2 transport\n+\"\"\"\n+\n+from test_framework.messages import NODE_P2P_V2\n+from test_framework.test_framework import BitcoinTestFramework\n+from test_framework.util import assert_equal\n+\n+class V2TransportTest(BitcoinTestFramework):",
      "path": "test/functional/p2p_v2_transport.py",
      "position": 13,
      "original_position": 13,
      "commit_id": "75a329103505736acb9036224da2dfa8ab038c43",
      "original_commit_id": "e07a6bff37d4cbad8266117492ed544c4727ef96",
      "in_reply_to_id": 1341327680,
      "user": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "Good point, done.",
      "created_at": "2023-09-29T18:22:54Z",
      "updated_at": "2023-09-29T18:22:55Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28331#discussion_r1341678891",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1341678891"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28331"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 13,
      "original_line": 13,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1341683278",
      "pull_request_review_id": 1651298244,
      "id": 1341683278,
      "node_id": "PRRC_kwDOABII585P-HZO",
      "diff_hunk": "@@ -472,7 +472,7 @@ CNode* CConnman::ConnectNode(CAddress addrConnect, const char *pszDest, bool fCo\n         const std::vector<CService> resolved{Lookup(pszDest, default_port, fNameLookup && !HaveNameProxy(), 256)};\n         if (!resolved.empty()) {\n             const CService& rnd{resolved[GetRand(resolved.size())]};\n-            addrConnect = CAddress{MaybeFlipIPv6toCJDNS(rnd), NODE_NONE};\n+            addrConnect = CAddress{MaybeFlipIPv6toCJDNS(rnd), addrConnect.nServices};",
      "path": "src/net.cpp",
      "position": null,
      "original_position": 5,
      "commit_id": "75a329103505736acb9036224da2dfa8ab038c43",
      "original_commit_id": "e07a6bff37d4cbad8266117492ed544c4727ef96",
      "in_reply_to_id": 1341336060,
      "user": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "I agree with making a change like this, but I fear the scope of that could easily grow too large for this PR. There are several other places in the network code where this \"string name or CAddress\" variant concept exist, and if we're going to introduce a variant type or something similar for that, I'd prefer for it to be done everywhere. It is also relevant for #28155 (@sr-gi) I think.\r\n\r\nIf you feel the mixing of the two argument is a problem in this PR, what about the more narrow change of adding a `use_v2transport` boolean argument to `ConnectNode` and `OpenNetworkConnection` instead, and ignoring the `addrConnect.nServices` field?",
      "created_at": "2023-09-29T18:27:59Z",
      "updated_at": "2023-09-29T19:17:47Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28331#discussion_r1341683278",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1341683278"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28331"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 472,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1341919793",
      "pull_request_review_id": 1651649221,
      "id": 1341919793,
      "node_id": "PRRC_kwDOABII585P_BIx",
      "diff_hunk": "@@ -472,7 +472,7 @@ CNode* CConnman::ConnectNode(CAddress addrConnect, const char *pszDest, bool fCo\n         const std::vector<CService> resolved{Lookup(pszDest, default_port, fNameLookup && !HaveNameProxy(), 256)};\n         if (!resolved.empty()) {\n             const CService& rnd{resolved[GetRand(resolved.size())]};\n-            addrConnect = CAddress{MaybeFlipIPv6toCJDNS(rnd), NODE_NONE};\n+            addrConnect = CAddress{MaybeFlipIPv6toCJDNS(rnd), addrConnect.nServices};",
      "path": "src/net.cpp",
      "position": null,
      "original_position": 5,
      "commit_id": "75a329103505736acb9036224da2dfa8ab038c43",
      "original_commit_id": "e07a6bff37d4cbad8266117492ed544c4727ef96",
      "in_reply_to_id": 1341336060,
      "user": {
        "login": "Sjors",
        "id": 10217,
        "node_id": "MDQ6VXNlcjEwMjE3",
        "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Sjors",
        "html_url": "https://github.com/Sjors",
        "followers_url": "https://api.github.com/users/Sjors/followers",
        "following_url": "https://api.github.com/users/Sjors/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Sjors/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Sjors/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
        "organizations_url": "https://api.github.com/users/Sjors/orgs",
        "repos_url": "https://api.github.com/users/Sjors/repos",
        "events_url": "https://api.github.com/users/Sjors/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Sjors/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": ">  what is the \"this\" referring to?\r\n\r\nSetting it to `addrConnect.nServices` instead of leaving the default initialized `NODE_NONE`.\r\n\r\n> This PR changes that to pass information via both params. I do not like this\r\n\r\nAh, I didn't notice that. No strong opinion but in that case I think we should document the `pszDest` and `addrConnect ` arguments of `ConnectNode` and `OpenNetworkConnection`.\r\n\r\n> adding a `use_v2transport` boolean argument to `ConnectNode` and `OpenNetworkConnection` instead\r\n\r\nThat sounds good.",
      "created_at": "2023-09-30T06:49:25Z",
      "updated_at": "2023-09-30T06:49:25Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28331#discussion_r1341919793",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1341919793"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28331"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 472,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1341920164",
      "pull_request_review_id": 1651649556,
      "id": 1341920164,
      "node_id": "PRRC_kwDOABII585P_BOk",
      "diff_hunk": "@@ -345,53 +357,70 @@ class CSemaphoreGrant\n     bool fHaveGrant;\n \n public:\n-    void Acquire()\n+    void Acquire() noexcept\n     {\n-        if (fHaveGrant)\n+        if (fHaveGrant) {\n             return;\n+        }\n         sem->wait();\n         fHaveGrant = true;\n     }\n \n-    void Release()\n+    void Release() noexcept\n     {\n-        if (!fHaveGrant)\n+        if (!fHaveGrant) {\n             return;\n+        }\n         sem->post();\n         fHaveGrant = false;\n     }\n \n-    bool TryAcquire()\n+    bool TryAcquire() noexcept\n     {\n-        if (!fHaveGrant && sem->try_wait())\n+        if (!fHaveGrant && sem->try_wait()) {\n             fHaveGrant = true;\n+        }\n         return fHaveGrant;\n     }\n \n-    void MoveTo(CSemaphoreGrant& grant)\n+    // Disallow copy.\n+    CSemaphoreGrant(const CSemaphoreGrant&) = delete;\n+    CSemaphoreGrant& operator=(const CSemaphoreGrant&) = delete;\n+\n+    // Allow move.\n+    CSemaphoreGrant(CSemaphoreGrant&& other) noexcept\n+    {\n+        sem = other.sem;\n+        fHaveGrant = other.fHaveGrant;\n+        other.fHaveGrant = false;\n+    }",
      "path": "src/sync.h",
      "position": null,
      "original_position": 97,
      "commit_id": "75a329103505736acb9036224da2dfa8ab038c43",
      "original_commit_id": "830b23ab80ac089c15e232d1b1e6bbd781ddc749",
      "in_reply_to_id": 1340069761,
      "user": {
        "login": "Sjors",
        "id": 10217,
        "node_id": "MDQ6VXNlcjEwMjE3",
        "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Sjors",
        "html_url": "https://github.com/Sjors",
        "followers_url": "https://api.github.com/users/Sjors/followers",
        "following_url": "https://api.github.com/users/Sjors/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Sjors/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Sjors/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
        "organizations_url": "https://api.github.com/users/Sjors/orgs",
        "repos_url": "https://api.github.com/users/Sjors/repos",
        "events_url": "https://api.github.com/users/Sjors/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Sjors/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "Nice! I don't think my test is usable other than for manual testing. We currently can't mock the 60 second delay involved. We also can't configure the maximum connection count so it would need 10 test nodes, though that's doable. I'll open an issue.\r\n\r\nSee also #28464 for some related changes.",
      "created_at": "2023-09-30T06:53:00Z",
      "updated_at": "2023-09-30T06:54:52Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28331#discussion_r1341920164",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1341920164"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28331"
        }
      },
      "start_line": null,
      "original_start_line": 391,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 397,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1341960742",
      "pull_request_review_id": 1651695840,
      "id": 1341960742,
      "node_id": "PRRC_kwDOABII585P_LIm",
      "diff_hunk": "@@ -472,7 +472,7 @@ CNode* CConnman::ConnectNode(CAddress addrConnect, const char *pszDest, bool fCo\n         const std::vector<CService> resolved{Lookup(pszDest, default_port, fNameLookup && !HaveNameProxy(), 256)};\n         if (!resolved.empty()) {\n             const CService& rnd{resolved[GetRand(resolved.size())]};\n-            addrConnect = CAddress{MaybeFlipIPv6toCJDNS(rnd), NODE_NONE};\n+            addrConnect = CAddress{MaybeFlipIPv6toCJDNS(rnd), addrConnect.nServices};",
      "path": "src/net.cpp",
      "position": null,
      "original_position": 5,
      "commit_id": "75a329103505736acb9036224da2dfa8ab038c43",
      "original_commit_id": "e07a6bff37d4cbad8266117492ed544c4727ef96",
      "in_reply_to_id": 1341336060,
      "user": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "I've pushed again with this approach.",
      "created_at": "2023-09-30T13:12:25Z",
      "updated_at": "2023-09-30T13:12:25Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28331#discussion_r1341960742",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1341960742"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28331"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 472,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1342179199",
      "pull_request_review_id": 1651952488,
      "id": 1342179199,
      "node_id": "PRRC_kwDOABII585QAAd_",
      "diff_hunk": "@@ -1583,6 +1591,27 @@ size_t V2Transport::GetSendMemoryUsage() const noexcept\n     return sizeof(m_send_buffer) + memusage::DynamicUsage(m_send_buffer);\n }\n \n+Transport::Info V2Transport::GetInfo() const noexcept\n+{\n+    AssertLockNotHeld(m_recv_mutex);\n+    LOCK(m_recv_mutex);\n+    if (m_recv_state == RecvState::V1) return m_v1_fallback.GetInfo();\n+\n+    Transport::Info info;\n+\n+    // Do not report v2 and session ID until the garbage authentication packet has been received\n+    // and verified (confirming that the other side very likely has the same keys as us).\n+    if (m_recv_state != RecvState::KEY_MAYBE_V1 && m_recv_state != RecvState::KEY &&\n+        m_recv_state != RecvState::GARB_GARBTERM) {",
      "path": "src/net.cpp",
      "position": null,
      "original_position": 37,
      "commit_id": "75a329103505736acb9036224da2dfa8ab038c43",
      "original_commit_id": "d5c8b42a1612e84e7bb5cea6bbc98247ce52128c",
      "in_reply_to_id": null,
      "user": {
        "login": "theStack",
        "id": 91535,
        "node_id": "MDQ6VXNlcjkxNTM1",
        "avatar_url": "https://avatars.githubusercontent.com/u/91535?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theStack",
        "html_url": "https://github.com/theStack",
        "followers_url": "https://api.github.com/users/theStack/followers",
        "following_url": "https://api.github.com/users/theStack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theStack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theStack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theStack/subscriptions",
        "organizations_url": "https://api.github.com/users/theStack/orgs",
        "repos_url": "https://api.github.com/users/theStack/repos",
        "events_url": "https://api.github.com/users/theStack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theStack/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "I've intentionally tested connecting to a node running a version that still uses the garbage authentication packet (i.e. it doesn't have the recent BIP324 change included yet: https://github.com/bitcoin/bitcoin/pull/28525) and noticed that we report v2 and the session id too early, before the garbage authentication (now included in VERSION) is received. I think that's fixed by the following patch:\r\n```suggestion\r\n        m_recv_state != RecvState::GARB_GARBTERM && m_recv_state != RecvState::VERSION) {\r\n```",
      "created_at": "2023-10-01T19:38:47Z",
      "updated_at": "2023-10-01T19:41:45Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28331#discussion_r1342179199",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1342179199"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28331"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1605,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1342233509",
      "pull_request_review_id": 1652029682,
      "id": 1342233509,
      "node_id": "PRRC_kwDOABII585QANul",
      "diff_hunk": "@@ -2780,19 +2780,19 @@ void CConnman::ThreadOpenAddedConnections()\n     AssertLockNotHeld(m_unused_i2p_sessions_mutex);\n     while (true)\n     {\n-        CSemaphoreGrant grant(*semAddnode);",
      "path": "src/net.cpp",
      "position": 302,
      "original_position": 43,
      "commit_id": "75a329103505736acb9036224da2dfa8ab038c43",
      "original_commit_id": "5784e825b7d06fef9d86b56a462fa4e42c23eaf7",
      "in_reply_to_id": null,
      "user": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "I think that this is a small change in behavior (fyi @vasild because of https://github.com/bitcoin/bitcoin/pull/28331#discussion_r1341652305):\r\nOn master, the thread will block here if all addnode slots are taken because we call `Acquire()` (and not `TryAcquire()`) so there won't be any `sleep_for` and no continuous calls to `GetAddedNodeInfo()` in this situation (until the grant is released because one of the existing added nodes has disconnected).\r\nWith this PR removing non-fTry acquiry of the grant, it means that we will now continuously cycle through the while loop, calling `GetAddedNodeInfo()` and sleeping for 2 seconds in the same situation where all addnode slots are taken.\r\nIs this change intended / better than the behavior on master? On first glance, repeated calls to `GetAddedNodeInfo()` seem unnecessary when we don't have a grant anyway, so the behavior on master seems more natural.\r\n ",
      "created_at": "2023-10-02T02:00:14Z",
      "updated_at": "2023-10-02T02:14:16Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28331#discussion_r1342233509",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1342233509"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28331"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 2772,
      "original_line": 2772,
      "side": "LEFT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1342251395",
      "pull_request_review_id": 1652058557,
      "id": 1342251395,
      "node_id": "PRRC_kwDOABII585QASGD",
      "diff_hunk": "@@ -1583,6 +1591,27 @@ size_t V2Transport::GetSendMemoryUsage() const noexcept\n     return sizeof(m_send_buffer) + memusage::DynamicUsage(m_send_buffer);\n }\n \n+Transport::Info V2Transport::GetInfo() const noexcept\n+{\n+    AssertLockNotHeld(m_recv_mutex);\n+    LOCK(m_recv_mutex);\n+    if (m_recv_state == RecvState::V1) return m_v1_fallback.GetInfo();\n+\n+    Transport::Info info;\n+\n+    // Do not report v2 and session ID until the garbage authentication packet has been received\n+    // and verified (confirming that the other side very likely has the same keys as us).\n+    if (m_recv_state != RecvState::KEY_MAYBE_V1 && m_recv_state != RecvState::KEY &&\n+        m_recv_state != RecvState::GARB_GARBTERM) {",
      "path": "src/net.cpp",
      "position": null,
      "original_position": 37,
      "commit_id": "75a329103505736acb9036224da2dfa8ab038c43",
      "original_commit_id": "d5c8b42a1612e84e7bb5cea6bbc98247ce52128c",
      "in_reply_to_id": 1342179199,
      "user": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "Nice catch. Since the version packet now takes on the role of garbage authentication, we need to wait for the version packet before deciding it's confirmed to be a v2 peer.",
      "created_at": "2023-10-02T03:09:10Z",
      "updated_at": "2023-10-02T03:09:10Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28331#discussion_r1342251395",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1342251395"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28331"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1605,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1342251633",
      "pull_request_review_id": 1652058967,
      "id": 1342251633,
      "node_id": "PRRC_kwDOABII585QASJx",
      "diff_hunk": "@@ -2780,19 +2780,19 @@ void CConnman::ThreadOpenAddedConnections()\n     AssertLockNotHeld(m_unused_i2p_sessions_mutex);\n     while (true)\n     {\n-        CSemaphoreGrant grant(*semAddnode);",
      "path": "src/net.cpp",
      "position": 302,
      "original_position": 43,
      "commit_id": "75a329103505736acb9036224da2dfa8ab038c43",
      "original_commit_id": "5784e825b7d06fef9d86b56a462fa4e42c23eaf7",
      "in_reply_to_id": 1342233509,
      "user": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "Nice find. I've adapted the code to match the old behavior (I hope; please have a look); even if we decide different behavior is desirable, this isn't the PR to introduce it.",
      "created_at": "2023-10-02T03:10:13Z",
      "updated_at": "2023-10-02T03:10:13Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28331#discussion_r1342251633",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1342251633"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28331"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 2772,
      "original_line": 2772,
      "side": "LEFT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1342450439",
      "pull_request_review_id": 1652375193,
      "id": 1342450439,
      "node_id": "PRRC_kwDOABII585QBCsH",
      "diff_hunk": "@@ -345,53 +357,70 @@ class CSemaphoreGrant\n     bool fHaveGrant;\n \n public:\n-    void Acquire()\n+    void Acquire() noexcept\n     {\n-        if (fHaveGrant)\n+        if (fHaveGrant) {\n             return;\n+        }\n         sem->wait();\n         fHaveGrant = true;\n     }\n \n-    void Release()\n+    void Release() noexcept\n     {\n-        if (!fHaveGrant)\n+        if (!fHaveGrant) {\n             return;\n+        }\n         sem->post();\n         fHaveGrant = false;\n     }\n \n-    bool TryAcquire()\n+    bool TryAcquire() noexcept\n     {\n-        if (!fHaveGrant && sem->try_wait())\n+        if (!fHaveGrant && sem->try_wait()) {\n             fHaveGrant = true;\n+        }\n         return fHaveGrant;\n     }\n \n-    void MoveTo(CSemaphoreGrant& grant)\n+    // Disallow copy.\n+    CSemaphoreGrant(const CSemaphoreGrant&) = delete;\n+    CSemaphoreGrant& operator=(const CSemaphoreGrant&) = delete;\n+\n+    // Allow move.\n+    CSemaphoreGrant(CSemaphoreGrant&& other) noexcept\n+    {\n+        sem = other.sem;\n+        fHaveGrant = other.fHaveGrant;\n+        other.fHaveGrant = false;\n+    }",
      "path": "src/sync.h",
      "position": null,
      "original_position": 97,
      "commit_id": "75a329103505736acb9036224da2dfa8ab038c43",
      "original_commit_id": "830b23ab80ac089c15e232d1b1e6bbd781ddc749",
      "in_reply_to_id": 1340069761,
      "user": {
        "login": "Sjors",
        "id": 10217,
        "node_id": "MDQ6VXNlcjEwMjE3",
        "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Sjors",
        "html_url": "https://github.com/Sjors",
        "followers_url": "https://api.github.com/users/Sjors/followers",
        "following_url": "https://api.github.com/users/Sjors/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Sjors/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Sjors/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
        "organizations_url": "https://api.github.com/users/Sjors/orgs",
        "repos_url": "https://api.github.com/users/Sjors/repos",
        "events_url": "https://api.github.com/users/Sjors/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Sjors/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "Updated test that demonstrates the crash issue has been fixed: https://github.com/Sjors/bitcoin/commit/bc3995c66300fb3139c5360e8f6ee807b02ea86e",
      "created_at": "2023-10-02T09:10:54Z",
      "updated_at": "2023-10-02T09:11:24Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28331#discussion_r1342450439",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1342450439"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28331"
        }
      },
      "start_line": null,
      "original_start_line": 391,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 397,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1342506186",
      "pull_request_review_id": 1652460362,
      "id": 1342506186,
      "node_id": "PRRC_kwDOABII585QBQTK",
      "diff_hunk": "@@ -289,11 +299,12 @@ static RPCHelpMan addnode()\n                 {\n                     {\"node\", RPCArg::Type::STR, RPCArg::Optional::NO, \"The address of the peer to connect to\"},\n                     {\"command\", RPCArg::Type::STR, RPCArg::Optional::NO, \"'add' to add a node to the list, 'remove' to remove a node from the list, 'onetry' to try a connection to the node once\"},\n+                    {\"v2transport\", RPCArg::Type::BOOL, RPCArg::Default{false}, \"Attempt to connect using BIP324 v2 transport protocol (ignored for 'remove' command)\"},\n                 },\n                 RPCResult{RPCResult::Type::NONE, \"\", \"\"},\n                 RPCExamples{\n-                    HelpExampleCli(\"addnode\", \"\\\"192.168.0.6:8333\\\" \\\"onetry\\\"\")\n-            + HelpExampleRpc(\"addnode\", \"\\\"192.168.0.6:8333\\\", \\\"onetry\\\"\")\n+                    HelpExampleCli(\"addnode\", \"\\\"192.168.0.6:8333\\\" \\\"onetry\\\" true\")",
      "path": "src/rpc/net.cpp",
      "position": 41,
      "original_position": 41,
      "commit_id": "75a329103505736acb9036224da2dfa8ab038c43",
      "original_commit_id": "cd5e72d6fb82c580dbf693b14e842d6204327311",
      "in_reply_to_id": null,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "This adds a way to specify a v2 peer to `addnode`. What about something similar for `-connect=` peers? Right now there is no way to specify \"use v2\" for addresses provided to `-connect=`. What about if `-v2transport=1` then always try v2 first (and on failure v1) for all `addnode` and `connect` peers? Then this extra argument to `addnode` is not needed.",
      "created_at": "2023-10-02T10:09:36Z",
      "updated_at": "2023-10-02T10:12:05Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28331#discussion_r1342506186",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1342506186"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28331"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 306,
      "original_line": 306,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1342562148",
      "pull_request_review_id": 1652547217,
      "id": 1342562148,
      "node_id": "PRRC_kwDOABII585QBd9k",
      "diff_hunk": "@@ -1906,6 +1979,20 @@ void CConnman::DisconnectNodes()\n                 // remove from m_nodes\n                 m_nodes.erase(remove(m_nodes.begin(), m_nodes.end(), pnode), m_nodes.end());\n \n+                // Add to reconnection list if appropriate. We don't reconnect right here, because\n+                // the creation of a connection is a blocking operation (up to several seconds),\n+                // and we don't want to hold up the socket handler thread for that long.\n+                if (pnode->m_transport->ShouldReconnectV1()) {",
      "path": "src/net.cpp",
      "position": 175,
      "original_position": 179,
      "commit_id": "75a329103505736acb9036224da2dfa8ab038c43",
      "original_commit_id": "830b23ab80ac089c15e232d1b1e6bbd781ddc749",
      "in_reply_to_id": 1340130617,
      "user": {
        "login": "Sjors",
        "id": 10217,
        "node_id": "MDQ6VXNlcjEwMjE3",
        "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Sjors",
        "html_url": "https://github.com/Sjors",
        "followers_url": "https://api.github.com/users/Sjors/followers",
        "following_url": "https://api.github.com/users/Sjors/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Sjors/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Sjors/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
        "organizations_url": "https://api.github.com/users/Sjors/orgs",
        "repos_url": "https://api.github.com/users/Sjors/repos",
        "events_url": "https://api.github.com/users/Sjors/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Sjors/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "> If a peer lies about their supported services, they only hurt their own ability of being connected to\r\n\r\nPeers could lie about each-other in gossip. But it doesn't matter here, as you say.",
      "created_at": "2023-10-02T11:17:50Z",
      "updated_at": "2023-10-02T11:17:50Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28331#discussion_r1342562148",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1342562148"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28331"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 1956,
      "original_line": 1956,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1342567406",
      "pull_request_review_id": 1652554967,
      "id": 1342567406,
      "node_id": "PRRC_kwDOABII585QBfPu",
      "diff_hunk": "@@ -1868,6 +1889,11 @@ bool CConnman::AddConnection(const std::string& address, ConnectionType conn_typ\n \n void CConnman::DisconnectNodes()\n {\n+    AssertLockNotHeld(m_nodes_mutex);\n+    AssertLockNotHeld(m_reconnections_mutex);\n+\n+    decltype(m_reconnections) reconnections_to_add;",
      "path": "src/net.cpp",
      "position": 163,
      "original_position": 49,
      "commit_id": "75a329103505736acb9036224da2dfa8ab038c43",
      "original_commit_id": "6a2dbed1209b18d923da64b019f6f378d3c30695",
      "in_reply_to_id": null,
      "user": {
        "login": "Sjors",
        "id": 10217,
        "node_id": "MDQ6VXNlcjEwMjE3",
        "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Sjors",
        "html_url": "https://github.com/Sjors",
        "followers_url": "https://api.github.com/users/Sjors/followers",
        "following_url": "https://api.github.com/users/Sjors/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Sjors/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Sjors/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
        "organizations_url": "https://api.github.com/users/Sjors/orgs",
        "repos_url": "https://api.github.com/users/Sjors/repos",
        "events_url": "https://api.github.com/users/Sjors/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Sjors/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "6a2dbed1209b18d923da64b019f6f378d3c30695: could a comment here that we `// Use temporary variable to track new reconnection candidates, because m_reconnections_mutex may be blocked [also for several seconds??? or much shorter but still don't want that]` (supplementing the comment below why we don't do the reconnect itself here either).",
      "created_at": "2023-10-02T11:23:14Z",
      "updated_at": "2023-10-02T11:50:12Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28331#discussion_r1342567406",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1342567406"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28331"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 1929,
      "original_line": 1929,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1342572783",
      "pull_request_review_id": 1652554967,
      "id": 1342572783,
      "node_id": "PRRC_kwDOABII585QBgjv",
      "diff_hunk": "@@ -3744,6 +3796,29 @@ uint64_t CConnman::CalculateKeyedNetGroup(const CAddress& address) const\n     return GetDeterministicRandomizer(RANDOMIZER_ID_NETGROUP).Write(vchNetGroup).Finalize();\n }\n \n+void CConnman::PerformReconnections()\n+{\n+    AssertLockNotHeld(m_reconnections_mutex);\n+    AssertLockNotHeld(m_unused_i2p_sessions_mutex);\n+    while (true) {\n+        // Move first element of m_reconnections to todo (avoiding an allocation inside the lock).\n+        decltype(m_reconnections) todo;\n+        {\n+            LOCK(m_reconnections_mutex);\n+            if (m_reconnections.empty()) break;\n+            todo.splice(todo.end(), m_reconnections, m_reconnections.begin());\n+        }\n+\n+        auto& item = *todo.begin();\n+        OpenNetworkConnection(item.addr_connect,\n+                              item.count_failure,\n+                              std::move(item.grant),\n+                              item.destination.empty() ? nullptr : item.destination.c_str(),\n+                              item.conn_type,\n+                              /*use_v2transport=*/false);",
      "path": "src/net.cpp",
      "position": null,
      "original_position": 153,
      "commit_id": "75a329103505736acb9036224da2dfa8ab038c43",
      "original_commit_id": "6a2dbed1209b18d923da64b019f6f378d3c30695",
      "in_reply_to_id": null,
      "user": {
        "login": "Sjors",
        "id": 10217,
        "node_id": "MDQ6VXNlcjEwMjE3",
        "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Sjors",
        "html_url": "https://github.com/Sjors",
        "followers_url": "https://api.github.com/users/Sjors/followers",
        "following_url": "https://api.github.com/users/Sjors/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Sjors/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Sjors/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
        "organizations_url": "https://api.github.com/users/Sjors/orgs",
        "repos_url": "https://api.github.com/users/Sjors/repos",
        "events_url": "https://api.github.com/users/Sjors/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Sjors/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "6a2dbed1209b18d923da64b019f6f378d3c30695 `ReconnectionInfo` could specify `use_v2transport` so that `PerformReconnections` can be used more broadly than just `v2` -> `v1` downgrades. Can always be done later of course.",
      "created_at": "2023-10-02T11:30:18Z",
      "updated_at": "2023-10-02T11:50:12Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28331#discussion_r1342572783",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1342572783"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28331"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 3818,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1342573672",
      "pull_request_review_id": 1652554967,
      "id": 1342573672,
      "node_id": "PRRC_kwDOABII585QBgxo",
      "diff_hunk": "@@ -361,6 +361,11 @@ class Transport {\n \n     /** Return the memory usage of this transport attributable to buffered data to send. */\n     virtual size_t GetSendMemoryUsage() const noexcept = 0;\n+\n+    // 3. Miscellaneous functions.\n+\n+    /** Whether upon disconnections, a reconnect with V1 is warranted. */\n+    virtual bool ShouldReconnectV1() const noexcept = 0;",
      "path": "src/net.h",
      "position": 56,
      "original_position": 8,
      "commit_id": "75a329103505736acb9036224da2dfa8ab038c43",
      "original_commit_id": "6a2dbed1209b18d923da64b019f6f378d3c30695",
      "in_reply_to_id": null,
      "user": {
        "login": "Sjors",
        "id": 10217,
        "node_id": "MDQ6VXNlcjEwMjE3",
        "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Sjors",
        "html_url": "https://github.com/Sjors",
        "followers_url": "https://api.github.com/users/Sjors/followers",
        "following_url": "https://api.github.com/users/Sjors/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Sjors/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Sjors/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
        "organizations_url": "https://api.github.com/users/Sjors/orgs",
        "repos_url": "https://api.github.com/users/Sjors/repos",
        "events_url": "https://api.github.com/users/Sjors/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Sjors/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "6a2dbed1209b18d923da64b019f6f378d3c30695 could make this more generic `ShouldReconnect()` (see comment above).",
      "created_at": "2023-10-02T11:31:25Z",
      "updated_at": "2023-10-02T11:50:12Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28331#discussion_r1342573672",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1342573672"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28331"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 381,
      "original_line": 381,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1342584337",
      "pull_request_review_id": 1652554967,
      "id": 1342584337,
      "node_id": "PRRC_kwDOABII585QBjYR",
      "diff_hunk": "@@ -1890,6 +1916,19 @@ void CConnman::DisconnectNodes()\n                 // remove from m_nodes\n                 m_nodes.erase(remove(m_nodes.begin(), m_nodes.end(), pnode), m_nodes.end());\n \n+                // Add to reconnection list if appropriate. We don't reconnect right here, because\n+                // the creation of a connection is a blocking operation (up to several seconds),\n+                // and we don't want to hold up the socket handler thread for that long.\n+                if (pnode->m_transport->ShouldReconnectV1()) {\n+                    reconnections_to_add.push_back({\n+                        .addr_connect = pnode->addr,\n+                        .count_failure = pnode->m_count_failure_after_reconnect,",
      "path": "src/net.cpp",
      "position": null,
      "original_position": 64,
      "commit_id": "75a329103505736acb9036224da2dfa8ab038c43",
      "original_commit_id": "6a2dbed1209b18d923da64b019f6f378d3c30695",
      "in_reply_to_id": null,
      "user": {
        "login": "Sjors",
        "id": 10217,
        "node_id": "MDQ6VXNlcjEwMjE3",
        "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Sjors",
        "html_url": "https://github.com/Sjors",
        "followers_url": "https://api.github.com/users/Sjors/followers",
        "following_url": "https://api.github.com/users/Sjors/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Sjors/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Sjors/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
        "organizations_url": "https://api.github.com/users/Sjors/orgs",
        "repos_url": "https://api.github.com/users/Sjors/repos",
        "events_url": "https://api.github.com/users/Sjors/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Sjors/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "6a2dbed1209b18d923da64b019f6f378d3c30695 I'm confused about the intention of `count_failure` / `m_count_failure_after_reconnect`. If this is set to `true` then `AddrManImpl` marks the most recent failed attempt and bumps `info.nAttempts`.\r\n\r\nThe latter suggests that we should set this to `false` if we'r trying a `v2` -> `v1` downgrade, otherwise we'd be counting double. Even better: we should not count the failed `v2` attempt if we intend to try again with `v1`. ",
      "created_at": "2023-10-02T11:45:01Z",
      "updated_at": "2023-10-02T11:50:12Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28331#discussion_r1342584337",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1342584337"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28331"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1925,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1342586915",
      "pull_request_review_id": 1652554967,
      "id": 1342586915,
      "node_id": "PRRC_kwDOABII585QBkAj",
      "diff_hunk": "@@ -662,6 +673,7 @@ struct CNodeOptions\n     bool prefer_evict = false;\n     size_t recv_flood_size{DEFAULT_MAXRECEIVEBUFFER * 1000};\n     bool use_v2transport = false;\n+    bool count_failure_after_reconnect = false;",
      "path": "src/net.h",
      "position": null,
      "original_position": 43,
      "commit_id": "75a329103505736acb9036224da2dfa8ab038c43",
      "original_commit_id": "6a2dbed1209b18d923da64b019f6f378d3c30695",
      "in_reply_to_id": null,
      "user": {
        "login": "Sjors",
        "id": 10217,
        "node_id": "MDQ6VXNlcjEwMjE3",
        "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Sjors",
        "html_url": "https://github.com/Sjors",
        "followers_url": "https://api.github.com/users/Sjors/followers",
        "following_url": "https://api.github.com/users/Sjors/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Sjors/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Sjors/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
        "organizations_url": "https://api.github.com/users/Sjors/orgs",
        "repos_url": "https://api.github.com/users/Sjors/repos",
        "events_url": "https://api.github.com/users/Sjors/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Sjors/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "6a2dbed1209b18d923da64b019f6f378d3c30695: The word `count` is ambigous here, because `AddrManImpl` literally counts failures, but I think the meaning here is \"it counts / we care about it\".\r\n\r\nSee also my above comment. Depending how this is intended to work, maybe I can think of a better name.",
      "created_at": "2023-10-02T11:47:49Z",
      "updated_at": "2023-10-02T11:50:12Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28331#discussion_r1342586915",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1342586915"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28331"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 676,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1342617148",
      "pull_request_review_id": 1652631446,
      "id": 1342617148,
      "node_id": "PRRC_kwDOABII585QBrY8",
      "diff_hunk": "@@ -1906,6 +1979,20 @@ void CConnman::DisconnectNodes()\n                 // remove from m_nodes\n                 m_nodes.erase(remove(m_nodes.begin(), m_nodes.end(), pnode), m_nodes.end());\n \n+                // Add to reconnection list if appropriate. We don't reconnect right here, because\n+                // the creation of a connection is a blocking operation (up to several seconds),\n+                // and we don't want to hold up the socket handler thread for that long.\n+                if (pnode->m_transport->ShouldReconnectV1()) {",
      "path": "src/net.cpp",
      "position": 175,
      "original_position": 179,
      "commit_id": "75a329103505736acb9036224da2dfa8ab038c43",
      "original_commit_id": "830b23ab80ac089c15e232d1b1e6bbd781ddc749",
      "in_reply_to_id": 1340130617,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "Worth noting here is that if an address is already in addrman and we receive it via gossip we update its services, but in a cumulative manner - only add new services, without removing existent services from addrman:\r\n\r\nhttps://github.com/bitcoin/bitcoin/blob/dcf6230f92d491f46d2bf6cfc096ab5874e385c9/src/addrman.cpp#L572\r\n\r\n",
      "created_at": "2023-10-02T12:21:20Z",
      "updated_at": "2023-10-02T12:21:20Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28331#discussion_r1342617148",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1342617148"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28331"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 1956,
      "original_line": 1956,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1342690792",
      "pull_request_review_id": 1652746189,
      "id": 1342690792,
      "node_id": "PRRC_kwDOABII585QB9Xo",
      "diff_hunk": "@@ -289,11 +299,12 @@ static RPCHelpMan addnode()\n                 {\n                     {\"node\", RPCArg::Type::STR, RPCArg::Optional::NO, \"The address of the peer to connect to\"},\n                     {\"command\", RPCArg::Type::STR, RPCArg::Optional::NO, \"'add' to add a node to the list, 'remove' to remove a node from the list, 'onetry' to try a connection to the node once\"},\n+                    {\"v2transport\", RPCArg::Type::BOOL, RPCArg::Default{false}, \"Attempt to connect using BIP324 v2 transport protocol (ignored for 'remove' command)\"},\n                 },\n                 RPCResult{RPCResult::Type::NONE, \"\", \"\"},\n                 RPCExamples{\n-                    HelpExampleCli(\"addnode\", \"\\\"192.168.0.6:8333\\\" \\\"onetry\\\"\")\n-            + HelpExampleRpc(\"addnode\", \"\\\"192.168.0.6:8333\\\", \\\"onetry\\\"\")\n+                    HelpExampleCli(\"addnode\", \"\\\"192.168.0.6:8333\\\" \\\"onetry\\\" true\")",
      "path": "src/rpc/net.cpp",
      "position": 41,
      "original_position": 41,
      "commit_id": "75a329103505736acb9036224da2dfa8ab038c43",
      "original_commit_id": "cd5e72d6fb82c580dbf693b14e842d6204327311",
      "in_reply_to_id": 1342506186,
      "user": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "There have been several comments related to this before. The situation is certainly incomplete w.r.t. the ability to specify v1/v2 for manual connections (e.g. also the `-addnode` / `-seednode` options lacks that), but my goal with this PR is getting the minimal in to support testing. Making things convenient for wider adoption I think needs some more UX discussion (e.g. do we permit specifying IP address/ranges to be V2, or do we use a network permission, or some special suffix `-addnode=IP@v2`; also how does this interact with a potential future where peer pubkeys can be specified, ...), which I think is better done separately.\r\n\r\nRegarding automatically assuming v2 for all addnode... that would (for now) mean 2 connection attempts for every manual peer; I'm not sure that's an acceptable tradeoff right now.",
      "created_at": "2023-10-02T13:24:09Z",
      "updated_at": "2023-10-02T13:24:09Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28331#discussion_r1342690792",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1342690792"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28331"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 306,
      "original_line": 306,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1342691501",
      "pull_request_review_id": 1652747385,
      "id": 1342691501,
      "node_id": "PRRC_kwDOABII585QB9it",
      "diff_hunk": "@@ -1868,6 +1889,11 @@ bool CConnman::AddConnection(const std::string& address, ConnectionType conn_typ\n \n void CConnman::DisconnectNodes()\n {\n+    AssertLockNotHeld(m_nodes_mutex);\n+    AssertLockNotHeld(m_reconnections_mutex);\n+\n+    decltype(m_reconnections) reconnections_to_add;",
      "path": "src/net.cpp",
      "position": 163,
      "original_position": 49,
      "commit_id": "75a329103505736acb9036224da2dfa8ab038c43",
      "original_commit_id": "6a2dbed1209b18d923da64b019f6f378d3c30695",
      "in_reply_to_id": 1342567406,
      "user": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "It's to avoid a lock dependency between `m_nodes_mutex` and `m_reconnections_mutex`. I've added a comment.",
      "created_at": "2023-10-02T13:24:48Z",
      "updated_at": "2023-10-02T13:24:49Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28331#discussion_r1342691501",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1342691501"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28331"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 1929,
      "original_line": 1929,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1342691666",
      "pull_request_review_id": 1652747666,
      "id": 1342691666,
      "node_id": "PRRC_kwDOABII585QB9lS",
      "diff_hunk": "@@ -3744,6 +3796,29 @@ uint64_t CConnman::CalculateKeyedNetGroup(const CAddress& address) const\n     return GetDeterministicRandomizer(RANDOMIZER_ID_NETGROUP).Write(vchNetGroup).Finalize();\n }\n \n+void CConnman::PerformReconnections()\n+{\n+    AssertLockNotHeld(m_reconnections_mutex);\n+    AssertLockNotHeld(m_unused_i2p_sessions_mutex);\n+    while (true) {\n+        // Move first element of m_reconnections to todo (avoiding an allocation inside the lock).\n+        decltype(m_reconnections) todo;\n+        {\n+            LOCK(m_reconnections_mutex);\n+            if (m_reconnections.empty()) break;\n+            todo.splice(todo.end(), m_reconnections, m_reconnections.begin());\n+        }\n+\n+        auto& item = *todo.begin();\n+        OpenNetworkConnection(item.addr_connect,\n+                              item.count_failure,\n+                              std::move(item.grant),\n+                              item.destination.empty() ? nullptr : item.destination.c_str(),\n+                              item.conn_type,\n+                              /*use_v2transport=*/false);",
      "path": "src/net.cpp",
      "position": null,
      "original_position": 153,
      "commit_id": "75a329103505736acb9036224da2dfa8ab038c43",
      "original_commit_id": "6a2dbed1209b18d923da64b019f6f378d3c30695",
      "in_reply_to_id": 1342572783,
      "user": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "Good idea, done.",
      "created_at": "2023-10-02T13:24:57Z",
      "updated_at": "2023-10-02T13:24:58Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28331#discussion_r1342691666",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1342691666"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28331"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 3818,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1342692419",
      "pull_request_review_id": 1652748923,
      "id": 1342692419,
      "node_id": "PRRC_kwDOABII585QB9xD",
      "diff_hunk": "@@ -361,6 +361,11 @@ class Transport {\n \n     /** Return the memory usage of this transport attributable to buffered data to send. */\n     virtual size_t GetSendMemoryUsage() const noexcept = 0;\n+\n+    // 3. Miscellaneous functions.\n+\n+    /** Whether upon disconnections, a reconnect with V1 is warranted. */\n+    virtual bool ShouldReconnectV1() const noexcept = 0;",
      "path": "src/net.h",
      "position": 56,
      "original_position": 8,
      "commit_id": "75a329103505736acb9036224da2dfa8ab038c43",
      "original_commit_id": "6a2dbed1209b18d923da64b019f6f378d3c30695",
      "in_reply_to_id": 1342573672,
      "user": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "I don't think that works, because even while `ReconnectionInfo` can be generic for any kind of reconnection attempt, this function and its call site are very much specific to a V2 connection downgrading to a V1.",
      "created_at": "2023-10-02T13:25:39Z",
      "updated_at": "2023-10-02T13:25:40Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28331#discussion_r1342692419",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1342692419"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28331"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 381,
      "original_line": 381,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1342695574",
      "pull_request_review_id": 1652754021,
      "id": 1342695574,
      "node_id": "PRRC_kwDOABII585QB-iW",
      "diff_hunk": "@@ -1890,6 +1916,19 @@ void CConnman::DisconnectNodes()\n                 // remove from m_nodes\n                 m_nodes.erase(remove(m_nodes.begin(), m_nodes.end(), pnode), m_nodes.end());\n \n+                // Add to reconnection list if appropriate. We don't reconnect right here, because\n+                // the creation of a connection is a blocking operation (up to several seconds),\n+                // and we don't want to hold up the socket handler thread for that long.\n+                if (pnode->m_transport->ShouldReconnectV1()) {\n+                    reconnections_to_add.push_back({\n+                        .addr_connect = pnode->addr,\n+                        .count_failure = pnode->m_count_failure_after_reconnect,",
      "path": "src/net.cpp",
      "position": null,
      "original_position": 64,
      "commit_id": "75a329103505736acb9036224da2dfa8ab038c43",
      "original_commit_id": "6a2dbed1209b18d923da64b019f6f378d3c30695",
      "in_reply_to_id": 1342584337,
      "user": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "Nice catch. I was clearly confused when writing this.\r\n\r\nThe situation is even simpler, because the `fCountFailure` argument to `OpenNetworkConnection` is only related to *connection* failure (i.e., TCP/IP failing to establish a connection) and not related to failures that happen after that point (perhaps it should, but that seems out of scope for this PR). We only ever attempt a V1 reconnection if the establishment of the V2 connection succeeded before that point, so by the time we reconnect, we already *know* the peer can be reached (in a TCP/IP sense), and there is no need to keep track of failure counting after that.\r\n\r\nI've changed it to set `fCountFailure` always to `false` on reconnect.",
      "created_at": "2023-10-02T13:28:21Z",
      "updated_at": "2023-10-02T13:28:21Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28331#discussion_r1342695574",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1342695574"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28331"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1925,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1342695789",
      "pull_request_review_id": 1652754389,
      "id": 1342695789,
      "node_id": "PRRC_kwDOABII585QB-lt",
      "diff_hunk": "@@ -662,6 +673,7 @@ struct CNodeOptions\n     bool prefer_evict = false;\n     size_t recv_flood_size{DEFAULT_MAXRECEIVEBUFFER * 1000};\n     bool use_v2transport = false;\n+    bool count_failure_after_reconnect = false;",
      "path": "src/net.h",
      "position": null,
      "original_position": 43,
      "commit_id": "75a329103505736acb9036224da2dfa8ab038c43",
      "original_commit_id": "6a2dbed1209b18d923da64b019f6f378d3c30695",
      "in_reply_to_id": 1342586915,
      "user": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "This code is gone.",
      "created_at": "2023-10-02T13:28:33Z",
      "updated_at": "2023-10-02T13:28:33Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28331#discussion_r1342695789",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1342695789"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28331"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 676,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1342700659",
      "pull_request_review_id": 1652762407,
      "id": 1342700659,
      "node_id": "PRRC_kwDOABII585QB_xz",
      "diff_hunk": "@@ -1906,6 +1979,20 @@ void CConnman::DisconnectNodes()\n                 // remove from m_nodes\n                 m_nodes.erase(remove(m_nodes.begin(), m_nodes.end(), pnode), m_nodes.end());\n \n+                // Add to reconnection list if appropriate. We don't reconnect right here, because\n+                // the creation of a connection is a blocking operation (up to several seconds),\n+                // and we don't want to hold up the socket handler thread for that long.\n+                if (pnode->m_transport->ShouldReconnectV1()) {",
      "path": "src/net.cpp",
      "position": 175,
      "original_position": 179,
      "commit_id": "75a329103505736acb9036224da2dfa8ab038c43",
      "original_commit_id": "830b23ab80ac089c15e232d1b1e6bbd781ddc749",
      "in_reply_to_id": 1340130617,
      "user": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "@vasild FWIW, that's the primary reason why we really need a v1-reconnect concept when v2 connections fail; otherwise it'd be trivial for attackers to inject the `NODE_P2P_V2` flag in all addresses they relay and cause widespread inability to connect.",
      "created_at": "2023-10-02T13:32:49Z",
      "updated_at": "2023-10-02T13:32:49Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28331#discussion_r1342700659",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1342700659"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28331"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 1956,
      "original_line": 1956,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1342881393",
      "pull_request_review_id": 1653050182,
      "id": 1342881393,
      "node_id": "PRRC_kwDOABII585QCr5x",
      "diff_hunk": "@@ -2785,16 +2785,16 @@ void CConnman::ThreadOpenAddedConnections()\n         bool tried = false;\n         for (const AddedNodeInfo& info : vInfo) {\n             if (!info.fConnected) {\n-                if (!grant.TryAcquire()) {\n+                if (!grant) {",
      "path": "src/net.cpp",
      "position": 308,
      "original_position": 44,
      "commit_id": "75a329103505736acb9036224da2dfa8ab038c43",
      "original_commit_id": "2e0f8a6d39a15ecac60b9d463606e16ba5707bb5",
      "in_reply_to_id": null,
      "user": {
        "login": "Sjors",
        "id": 10217,
        "node_id": "MDQ6VXNlcjEwMjE3",
        "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Sjors",
        "html_url": "https://github.com/Sjors",
        "followers_url": "https://api.github.com/users/Sjors/followers",
        "following_url": "https://api.github.com/users/Sjors/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Sjors/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Sjors/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
        "organizations_url": "https://api.github.com/users/Sjors/orgs",
        "repos_url": "https://api.github.com/users/Sjors/repos",
        "events_url": "https://api.github.com/users/Sjors/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Sjors/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "2e0f8a6d39a15ecac60b9d463606e16ba5707bb5: I'm confused by this change. I see `!fgrant` calls the `bool()` operator which checks `fHaveGrant`. But if that returns false we now break out of the `for` loop. Wheveras we used to call `TryAcquire()` and continue if that worked.",
      "created_at": "2023-10-02T15:56:50Z",
      "updated_at": "2023-10-02T15:56:50Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28331#discussion_r1342881393",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1342881393"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28331"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 2870,
      "original_line": 2870,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1342882636",
      "pull_request_review_id": 1653052187,
      "id": 1342882636,
      "node_id": "PRRC_kwDOABII585QCsNM",
      "diff_hunk": "@@ -2785,16 +2785,16 @@ void CConnman::ThreadOpenAddedConnections()\n         bool tried = false;\n         for (const AddedNodeInfo& info : vInfo) {\n             if (!info.fConnected) {\n-                if (!grant.TryAcquire()) {\n+                if (!grant) {",
      "path": "src/net.cpp",
      "position": 308,
      "original_position": 44,
      "commit_id": "75a329103505736acb9036224da2dfa8ab038c43",
      "original_commit_id": "2e0f8a6d39a15ecac60b9d463606e16ba5707bb5",
      "in_reply_to_id": 1342881393,
      "user": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "We try acquire at the end of the previous loop iteration, or before entering the loop.",
      "created_at": "2023-10-02T15:58:03Z",
      "updated_at": "2023-10-02T15:58:03Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28331#discussion_r1342882636",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1342882636"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28331"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 2870,
      "original_line": 2870,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1342894361",
      "pull_request_review_id": 1653071468,
      "id": 1342894361,
      "node_id": "PRRC_kwDOABII585QCvEZ",
      "diff_hunk": "@@ -2785,16 +2785,16 @@ void CConnman::ThreadOpenAddedConnections()\n         bool tried = false;\n         for (const AddedNodeInfo& info : vInfo) {\n             if (!info.fConnected) {\n-                if (!grant.TryAcquire()) {\n+                if (!grant) {",
      "path": "src/net.cpp",
      "position": 308,
      "original_position": 44,
      "commit_id": "75a329103505736acb9036224da2dfa8ab038c43",
      "original_commit_id": "2e0f8a6d39a15ecac60b9d463606e16ba5707bb5",
      "in_reply_to_id": 1342881393,
      "user": {
        "login": "Sjors",
        "id": 10217,
        "node_id": "MDQ6VXNlcjEwMjE3",
        "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Sjors",
        "html_url": "https://github.com/Sjors",
        "followers_url": "https://api.github.com/users/Sjors/followers",
        "following_url": "https://api.github.com/users/Sjors/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Sjors/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Sjors/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
        "organizations_url": "https://api.github.com/users/Sjors/orgs",
        "repos_url": "https://api.github.com/users/Sjors/repos",
        "events_url": "https://api.github.com/users/Sjors/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Sjors/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "> before entering the loop\r\n\r\nOh I see. The `CSemaphoreGrant grant(*semAddnode)` constructor before the loop doesn't `fTry`, but uses `Acquire()`, which waits (unchanged behavior) and always sets `grant` to `true`.\r\n\r\nAt the end of the first iteration we set `fTry`, so we either get a grant for the next iteration or we don't.\r\n\r\nThe first time we don't get a grant we bail out of the loop. This is effectively the same as before, it's just that we did `TryAquire()` at the start of each iteration (which also always would have succeed in the first iteration). ",
      "created_at": "2023-10-02T16:09:51Z",
      "updated_at": "2023-10-02T16:09:51Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28331#discussion_r1342894361",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1342894361"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28331"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 2870,
      "original_line": 2870,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1343157537",
      "pull_request_review_id": 1653503507,
      "id": 1343157537,
      "node_id": "PRRC_kwDOABII585QDvUh",
      "diff_hunk": "@@ -49,6 +49,7 @@ BIPs that are implemented by Bitcoin Core:\n * [`BIP 173`](https://github.com/bitcoin/bips/blob/master/bip-0173.mediawiki): Bech32 addresses for native Segregated Witness outputs are supported as of **v0.16.0** ([PR 11167](https://github.com/bitcoin/bitcoin/pull/11167)). Bech32 addresses are generated by default as of **v0.20.0** ([PR 16884](https://github.com/bitcoin/bitcoin/pull/16884)).\n * [`BIP 174`](https://github.com/bitcoin/bips/blob/master/bip-0174.mediawiki): RPCs to operate on Partially Signed Bitcoin Transactions (PSBT) are present as of **v0.17.0** ([PR 13557](https://github.com/bitcoin/bitcoin/pull/13557)).\n * [`BIP 176`](https://github.com/bitcoin/bips/blob/master/bip-0176.mediawiki): Bits Denomination [QT only] is supported as of **v0.16.0** ([PR 12035](https://github.com/bitcoin/bitcoin/pull/12035)).\n+* [`BIP 324`](https://github.com/bitcoin/bips/blob/master/bip-0324.mediawiki): Support for the BIP324 v2 transport protocol and the associated `NODE_P2P_V2` service bit is supported as of **v26.0**, but off by default ([PR 28331](https://github.com/bitcoin/bitcoin/pull/28331)).",
      "path": "doc/bips.md",
      "position": null,
      "original_position": 4,
      "commit_id": "75a329103505736acb9036224da2dfa8ab038c43",
      "original_commit_id": "7b255b56698392019dd575c3bb73f6d8b1334f4b",
      "in_reply_to_id": null,
      "user": {
        "login": "theStack",
        "id": 91535,
        "node_id": "MDQ6VXNlcjkxNTM1",
        "avatar_url": "https://avatars.githubusercontent.com/u/91535?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theStack",
        "html_url": "https://github.com/theStack",
        "followers_url": "https://api.github.com/users/theStack/followers",
        "following_url": "https://api.github.com/users/theStack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theStack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theStack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theStack/subscriptions",
        "organizations_url": "https://api.github.com/users/theStack/orgs",
        "repos_url": "https://api.github.com/users/theStack/repos",
        "events_url": "https://api.github.com/users/theStack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theStack/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "pedantic nit to avoid the \"support for ... is supported\" repetition:\r\n```suggestion\r\n* [`BIP 324`](https://github.com/bitcoin/bips/blob/master/bip-0324.mediawiki): The BIP324 v2 transport protocol and the associated `NODE_P2P_V2` service bit is supported as of **v26.0**, but off by default ([PR 28331](https://github.com/bitcoin/bitcoin/pull/28331)).\r\n```",
      "created_at": "2023-10-02T20:57:29Z",
      "updated_at": "2023-10-02T20:58:03Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28331#discussion_r1343157537",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1343157537"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28331"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 52,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1343171523",
      "pull_request_review_id": 1653525921,
      "id": 1343171523,
      "node_id": "PRRC_kwDOABII585QDyvD",
      "diff_hunk": "@@ -469,7 +469,7 @@ CNode* CConnman::ConnectNode(CAddress addrConnect, const char *pszDest, bool fCo\n         const std::vector<CService> resolved{Lookup(pszDest, default_port, fNameLookup && !HaveNameProxy(), 256)};\n         if (!resolved.empty()) {\n             const CService& rnd{resolved[GetRand(resolved.size())]};\n-            addrConnect = CAddress{MaybeFlipIPv6toCJDNS(rnd), NODE_NONE};\n+            addrConnect = CAddress{MaybeFlipIPv6toCJDNS(rnd), addrConnect.nServices};",
      "path": "src/net.cpp",
      "position": null,
      "original_position": 5,
      "commit_id": "75a329103505736acb9036224da2dfa8ab038c43",
      "original_commit_id": "4aaf81533010939cc9ea5a1e299c46a43527a6ae",
      "in_reply_to_id": null,
      "user": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "I think that changing this line is no longer necessary after adding the `use_v2transport` bool.",
      "created_at": "2023-10-02T21:15:17Z",
      "updated_at": "2023-10-02T21:41:19Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28331#discussion_r1343171523",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1343171523"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28331"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 472,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1343193200",
      "pull_request_review_id": 1653525921,
      "id": 1343193200,
      "node_id": "PRRC_kwDOABII585QD4Bw",
      "diff_hunk": "@@ -2780,19 +2780,19 @@ void CConnman::ThreadOpenAddedConnections()\n     AssertLockNotHeld(m_unused_i2p_sessions_mutex);\n     while (true)\n     {\n-        CSemaphoreGrant grant(*semAddnode);",
      "path": "src/net.cpp",
      "position": 302,
      "original_position": 43,
      "commit_id": "75a329103505736acb9036224da2dfa8ab038c43",
      "original_commit_id": "5784e825b7d06fef9d86b56a462fa4e42c23eaf7",
      "in_reply_to_id": 1342233509,
      "user": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "Looks good, I tested that the behavior doesn't change anymore.",
      "created_at": "2023-10-02T21:40:54Z",
      "updated_at": "2023-10-02T21:41:19Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28331#discussion_r1343193200",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1343193200"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28331"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 2772,
      "original_line": 2772,
      "side": "LEFT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1343223966",
      "pull_request_review_id": 1653608319,
      "id": 1343223966,
      "node_id": "PRRC_kwDOABII585QD_ie",
      "diff_hunk": "@@ -469,7 +469,7 @@ CNode* CConnman::ConnectNode(CAddress addrConnect, const char *pszDest, bool fCo\n         const std::vector<CService> resolved{Lookup(pszDest, default_port, fNameLookup && !HaveNameProxy(), 256)};\n         if (!resolved.empty()) {\n             const CService& rnd{resolved[GetRand(resolved.size())]};\n-            addrConnect = CAddress{MaybeFlipIPv6toCJDNS(rnd), NODE_NONE};\n+            addrConnect = CAddress{MaybeFlipIPv6toCJDNS(rnd), addrConnect.nServices};",
      "path": "src/net.cpp",
      "position": null,
      "original_position": 5,
      "commit_id": "75a329103505736acb9036224da2dfa8ab038c43",
      "original_commit_id": "4aaf81533010939cc9ea5a1e299c46a43527a6ae",
      "in_reply_to_id": 1343171523,
      "user": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "Done.",
      "created_at": "2023-10-02T22:29:21Z",
      "updated_at": "2023-10-02T22:29:21Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28331#discussion_r1343223966",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1343223966"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28331"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 472,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1343224142",
      "pull_request_review_id": 1653608536,
      "id": 1343224142,
      "node_id": "PRRC_kwDOABII585QD_lO",
      "diff_hunk": "@@ -49,6 +49,7 @@ BIPs that are implemented by Bitcoin Core:\n * [`BIP 173`](https://github.com/bitcoin/bips/blob/master/bip-0173.mediawiki): Bech32 addresses for native Segregated Witness outputs are supported as of **v0.16.0** ([PR 11167](https://github.com/bitcoin/bitcoin/pull/11167)). Bech32 addresses are generated by default as of **v0.20.0** ([PR 16884](https://github.com/bitcoin/bitcoin/pull/16884)).\n * [`BIP 174`](https://github.com/bitcoin/bips/blob/master/bip-0174.mediawiki): RPCs to operate on Partially Signed Bitcoin Transactions (PSBT) are present as of **v0.17.0** ([PR 13557](https://github.com/bitcoin/bitcoin/pull/13557)).\n * [`BIP 176`](https://github.com/bitcoin/bips/blob/master/bip-0176.mediawiki): Bits Denomination [QT only] is supported as of **v0.16.0** ([PR 12035](https://github.com/bitcoin/bitcoin/pull/12035)).\n+* [`BIP 324`](https://github.com/bitcoin/bips/blob/master/bip-0324.mediawiki): Support for the BIP324 v2 transport protocol and the associated `NODE_P2P_V2` service bit is supported as of **v26.0**, but off by default ([PR 28331](https://github.com/bitcoin/bitcoin/pull/28331)).",
      "path": "doc/bips.md",
      "position": null,
      "original_position": 4,
      "commit_id": "75a329103505736acb9036224da2dfa8ab038c43",
      "original_commit_id": "7b255b56698392019dd575c3bb73f6d8b1334f4b",
      "in_reply_to_id": 1343157537,
      "user": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "Done (made some more editorial changes to this sentence).",
      "created_at": "2023-10-02T22:29:39Z",
      "updated_at": "2023-10-02T22:29:39Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28331#discussion_r1343224142",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1343224142"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28331"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 52,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1354481455",
      "pull_request_review_id": 1670484720,
      "id": 1354481455,
      "node_id": "PRRC_kwDOABII585Qu78v",
      "diff_hunk": "@@ -345,53 +357,70 @@ class CSemaphoreGrant\n     bool fHaveGrant;\n \n public:\n-    void Acquire()\n+    void Acquire() noexcept\n     {\n-        if (fHaveGrant)\n+        if (fHaveGrant) {\n             return;\n+        }\n         sem->wait();\n         fHaveGrant = true;\n     }\n \n-    void Release()\n+    void Release() noexcept\n     {\n-        if (!fHaveGrant)\n+        if (!fHaveGrant) {\n             return;\n+        }\n         sem->post();\n         fHaveGrant = false;\n     }\n \n-    bool TryAcquire()\n+    bool TryAcquire() noexcept\n     {\n-        if (!fHaveGrant && sem->try_wait())\n+        if (!fHaveGrant && sem->try_wait()) {\n             fHaveGrant = true;\n+        }\n         return fHaveGrant;\n     }\n \n-    void MoveTo(CSemaphoreGrant& grant)\n+    // Disallow copy.\n+    CSemaphoreGrant(const CSemaphoreGrant&) = delete;\n+    CSemaphoreGrant& operator=(const CSemaphoreGrant&) = delete;\n+\n+    // Allow move.\n+    CSemaphoreGrant(CSemaphoreGrant&& other) noexcept\n+    {\n+        sem = other.sem;\n+        fHaveGrant = other.fHaveGrant;\n+        other.fHaveGrant = false;\n+    }",
      "path": "src/sync.h",
      "position": null,
      "original_position": 97,
      "commit_id": "75a329103505736acb9036224da2dfa8ab038c43",
      "original_commit_id": "830b23ab80ac089c15e232d1b1e6bbd781ddc749",
      "in_reply_to_id": 1340069761,
      "user": {
        "login": "Sjors",
        "id": 10217,
        "node_id": "MDQ6VXNlcjEwMjE3",
        "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Sjors",
        "html_url": "https://github.com/Sjors",
        "followers_url": "https://api.github.com/users/Sjors/followers",
        "following_url": "https://api.github.com/users/Sjors/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Sjors/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Sjors/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
        "organizations_url": "https://api.github.com/users/Sjors/orgs",
        "repos_url": "https://api.github.com/users/Sjors/repos",
        "events_url": "https://api.github.com/users/Sjors/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Sjors/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "Issue to add a test: #28635",
      "created_at": "2023-10-11T08:57:21Z",
      "updated_at": "2023-10-11T08:57:21Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28331#discussion_r1354481455",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1354481455"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28331"
        }
      },
      "start_line": null,
      "original_start_line": 391,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 397,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1389597811",
      "pull_request_review_id": 1725109880,
      "id": 1389597811,
      "node_id": "PRRC_kwDOABII585S05Rz",
      "diff_hunk": "@@ -12,19 +12,116 @@\n \n class V2TransportTest(BitcoinTestFramework):\n     def set_test_params(self):\n-        self.setup_clean_chain=True\n-        self.num_nodes = 1\n-        self.extra_args = [[\"-v2transport=0\"]]\n+        self.setup_clean_chain = True\n+        self.num_nodes = 5\n+        self.extra_args = [[\"-v2transport=1\"], [\"-v2transport=1\"], [\"-v2transport=0\"], [\"-v2transport=0\"], [\"-v2transport=0\"]]\n \n     def run_test(self):\n-        network_info = self.nodes[0].getnetworkinfo()\n+        sending_handshake = \"start sending v2 handshake to peer\"\n+        downgrading_to_v1 = \"retrying with v1 transport protocol for peer\"\n+        self.disconnect_nodes(0, 1)\n+        self.disconnect_nodes(1, 2)\n+        self.disconnect_nodes(2, 3)\n+        self.disconnect_nodes(3, 4)\n+\n+        # verify local services\n+        network_info = self.nodes[2].getnetworkinfo()\n         assert_equal(int(network_info[\"localservices\"], 16) & NODE_P2P_V2, 0)\n         assert \"P2P_V2\" not in network_info[\"localservicesnames\"]\n-\n-        self.restart_node(0, [\"-v2transport=1\"])\n-        network_info = self.nodes[0].getnetworkinfo()\n+        network_info = self.nodes[1].getnetworkinfo()\n         assert_equal(int(network_info[\"localservices\"], 16) & NODE_P2P_V2, NODE_P2P_V2)\n         assert \"P2P_V2\" in network_info[\"localservicesnames\"]\n \n+        # V2 nodes can sync with V2 nodes\n+        assert_equal(self.nodes[0].getblockcount(), 0)\n+        assert_equal(self.nodes[1].getblockcount(), 0)\n+        with self.nodes[0].assert_debug_log(expected_msgs=[sending_handshake],\n+                                            unexpected_msgs=[downgrading_to_v1]):\n+            self.connect_nodes(0, 1, peer_advertises_v2=True)\n+        self.generate(self.nodes[0], 5, sync_fun=lambda: self.sync_all(self.nodes[0:2]))\n+        assert_equal(self.nodes[1].getblockcount(), 5)\n+        # verify there is a v2 connection between node 0 and 1\n+        node_0_info = self.nodes[0].getpeerinfo()\n+        node_1_info = self.nodes[0].getpeerinfo()",
      "path": "test/functional/p2p_v2_transport.py",
      "position": 45,
      "original_position": 41,
      "commit_id": "75a329103505736acb9036224da2dfa8ab038c43",
      "original_commit_id": "05d19fbcc10f26c7f1e3a9afc660eb7fa71b1d8c",
      "in_reply_to_id": null,
      "user": {
        "login": "kashifs",
        "id": 1489460,
        "node_id": "MDQ6VXNlcjE0ODk0NjA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1489460?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/kashifs",
        "html_url": "https://github.com/kashifs",
        "followers_url": "https://api.github.com/users/kashifs/followers",
        "following_url": "https://api.github.com/users/kashifs/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/kashifs/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/kashifs/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/kashifs/subscriptions",
        "organizations_url": "https://api.github.com/users/kashifs/orgs",
        "repos_url": "https://api.github.com/users/kashifs/repos",
        "events_url": "https://api.github.com/users/kashifs/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/kashifs/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "@sipa, am I missing something or should this line read:\r\n\r\n`node_1_info = self.nodes[1].getpeerinfo()`",
      "created_at": "2023-11-10T16:04:29Z",
      "updated_at": "2023-11-10T16:04:29Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28331#discussion_r1389597811",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1389597811"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28331"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 45,
      "original_line": 45,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1389608289",
      "pull_request_review_id": 1725126851,
      "id": 1389608289,
      "node_id": "PRRC_kwDOABII585S071h",
      "diff_hunk": "@@ -12,19 +12,116 @@\n \n class V2TransportTest(BitcoinTestFramework):\n     def set_test_params(self):\n-        self.setup_clean_chain=True\n-        self.num_nodes = 1\n-        self.extra_args = [[\"-v2transport=0\"]]\n+        self.setup_clean_chain = True\n+        self.num_nodes = 5\n+        self.extra_args = [[\"-v2transport=1\"], [\"-v2transport=1\"], [\"-v2transport=0\"], [\"-v2transport=0\"], [\"-v2transport=0\"]]\n \n     def run_test(self):\n-        network_info = self.nodes[0].getnetworkinfo()\n+        sending_handshake = \"start sending v2 handshake to peer\"\n+        downgrading_to_v1 = \"retrying with v1 transport protocol for peer\"\n+        self.disconnect_nodes(0, 1)\n+        self.disconnect_nodes(1, 2)\n+        self.disconnect_nodes(2, 3)\n+        self.disconnect_nodes(3, 4)\n+\n+        # verify local services\n+        network_info = self.nodes[2].getnetworkinfo()\n         assert_equal(int(network_info[\"localservices\"], 16) & NODE_P2P_V2, 0)\n         assert \"P2P_V2\" not in network_info[\"localservicesnames\"]\n-\n-        self.restart_node(0, [\"-v2transport=1\"])\n-        network_info = self.nodes[0].getnetworkinfo()\n+        network_info = self.nodes[1].getnetworkinfo()\n         assert_equal(int(network_info[\"localservices\"], 16) & NODE_P2P_V2, NODE_P2P_V2)\n         assert \"P2P_V2\" in network_info[\"localservicesnames\"]\n \n+        # V2 nodes can sync with V2 nodes\n+        assert_equal(self.nodes[0].getblockcount(), 0)\n+        assert_equal(self.nodes[1].getblockcount(), 0)\n+        with self.nodes[0].assert_debug_log(expected_msgs=[sending_handshake],\n+                                            unexpected_msgs=[downgrading_to_v1]):\n+            self.connect_nodes(0, 1, peer_advertises_v2=True)\n+        self.generate(self.nodes[0], 5, sync_fun=lambda: self.sync_all(self.nodes[0:2]))\n+        assert_equal(self.nodes[1].getblockcount(), 5)\n+        # verify there is a v2 connection between node 0 and 1\n+        node_0_info = self.nodes[0].getpeerinfo()\n+        node_1_info = self.nodes[0].getpeerinfo()",
      "path": "test/functional/p2p_v2_transport.py",
      "position": 45,
      "original_position": 41,
      "commit_id": "75a329103505736acb9036224da2dfa8ab038c43",
      "original_commit_id": "05d19fbcc10f26c7f1e3a9afc660eb7fa71b1d8c",
      "in_reply_to_id": 1389597811,
      "user": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "This indeed looks like a bug.",
      "created_at": "2023-11-10T16:13:50Z",
      "updated_at": "2023-11-10T16:13:50Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28331#discussion_r1389608289",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1389608289"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28331"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 45,
      "original_line": 45,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1389692101",
      "pull_request_review_id": 1725258154,
      "id": 1389692101,
      "node_id": "PRRC_kwDOABII585S1QTF",
      "diff_hunk": "@@ -12,19 +12,116 @@\n \n class V2TransportTest(BitcoinTestFramework):\n     def set_test_params(self):\n-        self.setup_clean_chain=True\n-        self.num_nodes = 1\n-        self.extra_args = [[\"-v2transport=0\"]]\n+        self.setup_clean_chain = True\n+        self.num_nodes = 5\n+        self.extra_args = [[\"-v2transport=1\"], [\"-v2transport=1\"], [\"-v2transport=0\"], [\"-v2transport=0\"], [\"-v2transport=0\"]]\n \n     def run_test(self):\n-        network_info = self.nodes[0].getnetworkinfo()\n+        sending_handshake = \"start sending v2 handshake to peer\"\n+        downgrading_to_v1 = \"retrying with v1 transport protocol for peer\"\n+        self.disconnect_nodes(0, 1)\n+        self.disconnect_nodes(1, 2)\n+        self.disconnect_nodes(2, 3)\n+        self.disconnect_nodes(3, 4)\n+\n+        # verify local services\n+        network_info = self.nodes[2].getnetworkinfo()\n         assert_equal(int(network_info[\"localservices\"], 16) & NODE_P2P_V2, 0)\n         assert \"P2P_V2\" not in network_info[\"localservicesnames\"]\n-\n-        self.restart_node(0, [\"-v2transport=1\"])\n-        network_info = self.nodes[0].getnetworkinfo()\n+        network_info = self.nodes[1].getnetworkinfo()\n         assert_equal(int(network_info[\"localservices\"], 16) & NODE_P2P_V2, NODE_P2P_V2)\n         assert \"P2P_V2\" in network_info[\"localservicesnames\"]\n \n+        # V2 nodes can sync with V2 nodes\n+        assert_equal(self.nodes[0].getblockcount(), 0)\n+        assert_equal(self.nodes[1].getblockcount(), 0)\n+        with self.nodes[0].assert_debug_log(expected_msgs=[sending_handshake],\n+                                            unexpected_msgs=[downgrading_to_v1]):\n+            self.connect_nodes(0, 1, peer_advertises_v2=True)\n+        self.generate(self.nodes[0], 5, sync_fun=lambda: self.sync_all(self.nodes[0:2]))\n+        assert_equal(self.nodes[1].getblockcount(), 5)\n+        # verify there is a v2 connection between node 0 and 1\n+        node_0_info = self.nodes[0].getpeerinfo()\n+        node_1_info = self.nodes[0].getpeerinfo()",
      "path": "test/functional/p2p_v2_transport.py",
      "position": 45,
      "original_position": 41,
      "commit_id": "75a329103505736acb9036224da2dfa8ab038c43",
      "original_commit_id": "05d19fbcc10f26c7f1e3a9afc660eb7fa71b1d8c",
      "in_reply_to_id": 1389597811,
      "user": {
        "login": "fanquake",
        "id": 863730,
        "node_id": "MDQ6VXNlcjg2MzczMA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/863730?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fanquake",
        "html_url": "https://github.com/fanquake",
        "followers_url": "https://api.github.com/users/fanquake/followers",
        "following_url": "https://api.github.com/users/fanquake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fanquake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fanquake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fanquake/subscriptions",
        "organizations_url": "https://api.github.com/users/fanquake/orgs",
        "repos_url": "https://api.github.com/users/fanquake/repos",
        "events_url": "https://api.github.com/users/fanquake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fanquake/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "cc @theStack ",
      "created_at": "2023-11-10T17:35:13Z",
      "updated_at": "2023-11-10T17:35:14Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28331#discussion_r1389692101",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1389692101"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28331"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 45,
      "original_line": 45,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1389710284",
      "pull_request_review_id": 1725286239,
      "id": 1389710284,
      "node_id": "PRRC_kwDOABII585S1UvM",
      "diff_hunk": "@@ -12,19 +12,116 @@\n \n class V2TransportTest(BitcoinTestFramework):\n     def set_test_params(self):\n-        self.setup_clean_chain=True\n-        self.num_nodes = 1\n-        self.extra_args = [[\"-v2transport=0\"]]\n+        self.setup_clean_chain = True\n+        self.num_nodes = 5\n+        self.extra_args = [[\"-v2transport=1\"], [\"-v2transport=1\"], [\"-v2transport=0\"], [\"-v2transport=0\"], [\"-v2transport=0\"]]\n \n     def run_test(self):\n-        network_info = self.nodes[0].getnetworkinfo()\n+        sending_handshake = \"start sending v2 handshake to peer\"\n+        downgrading_to_v1 = \"retrying with v1 transport protocol for peer\"\n+        self.disconnect_nodes(0, 1)\n+        self.disconnect_nodes(1, 2)\n+        self.disconnect_nodes(2, 3)\n+        self.disconnect_nodes(3, 4)\n+\n+        # verify local services\n+        network_info = self.nodes[2].getnetworkinfo()\n         assert_equal(int(network_info[\"localservices\"], 16) & NODE_P2P_V2, 0)\n         assert \"P2P_V2\" not in network_info[\"localservicesnames\"]\n-\n-        self.restart_node(0, [\"-v2transport=1\"])\n-        network_info = self.nodes[0].getnetworkinfo()\n+        network_info = self.nodes[1].getnetworkinfo()\n         assert_equal(int(network_info[\"localservices\"], 16) & NODE_P2P_V2, NODE_P2P_V2)\n         assert \"P2P_V2\" in network_info[\"localservicesnames\"]\n \n+        # V2 nodes can sync with V2 nodes\n+        assert_equal(self.nodes[0].getblockcount(), 0)\n+        assert_equal(self.nodes[1].getblockcount(), 0)\n+        with self.nodes[0].assert_debug_log(expected_msgs=[sending_handshake],\n+                                            unexpected_msgs=[downgrading_to_v1]):\n+            self.connect_nodes(0, 1, peer_advertises_v2=True)\n+        self.generate(self.nodes[0], 5, sync_fun=lambda: self.sync_all(self.nodes[0:2]))\n+        assert_equal(self.nodes[1].getblockcount(), 5)\n+        # verify there is a v2 connection between node 0 and 1\n+        node_0_info = self.nodes[0].getpeerinfo()\n+        node_1_info = self.nodes[0].getpeerinfo()",
      "path": "test/functional/p2p_v2_transport.py",
      "position": 45,
      "original_position": 41,
      "commit_id": "75a329103505736acb9036224da2dfa8ab038c43",
      "original_commit_id": "05d19fbcc10f26c7f1e3a9afc660eb7fa71b1d8c",
      "in_reply_to_id": 1389597811,
      "user": {
        "login": "theStack",
        "id": 91535,
        "node_id": "MDQ6VXNlcjkxNTM1",
        "avatar_url": "https://avatars.githubusercontent.com/u/91535?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theStack",
        "html_url": "https://github.com/theStack",
        "followers_url": "https://api.github.com/users/theStack/followers",
        "following_url": "https://api.github.com/users/theStack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theStack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theStack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theStack/subscriptions",
        "organizations_url": "https://api.github.com/users/theStack/orgs",
        "repos_url": "https://api.github.com/users/theStack/repos",
        "events_url": "https://api.github.com/users/theStack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theStack/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "Good catch @kashifs. Do you want to open a PR for the fix? If not (for whatever reason), I'm happy to do it and add the commit with your authorship.",
      "created_at": "2023-11-10T17:54:51Z",
      "updated_at": "2023-11-10T17:54:51Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28331#discussion_r1389710284",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1389710284"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28331"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 45,
      "original_line": 45,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1389939970",
      "pull_request_review_id": 1725670432,
      "id": 1389939970,
      "node_id": "PRRC_kwDOABII585S2M0C",
      "diff_hunk": "@@ -12,19 +12,116 @@\n \n class V2TransportTest(BitcoinTestFramework):\n     def set_test_params(self):\n-        self.setup_clean_chain=True\n-        self.num_nodes = 1\n-        self.extra_args = [[\"-v2transport=0\"]]\n+        self.setup_clean_chain = True\n+        self.num_nodes = 5\n+        self.extra_args = [[\"-v2transport=1\"], [\"-v2transport=1\"], [\"-v2transport=0\"], [\"-v2transport=0\"], [\"-v2transport=0\"]]\n \n     def run_test(self):\n-        network_info = self.nodes[0].getnetworkinfo()\n+        sending_handshake = \"start sending v2 handshake to peer\"\n+        downgrading_to_v1 = \"retrying with v1 transport protocol for peer\"\n+        self.disconnect_nodes(0, 1)\n+        self.disconnect_nodes(1, 2)\n+        self.disconnect_nodes(2, 3)\n+        self.disconnect_nodes(3, 4)\n+\n+        # verify local services\n+        network_info = self.nodes[2].getnetworkinfo()\n         assert_equal(int(network_info[\"localservices\"], 16) & NODE_P2P_V2, 0)\n         assert \"P2P_V2\" not in network_info[\"localservicesnames\"]\n-\n-        self.restart_node(0, [\"-v2transport=1\"])\n-        network_info = self.nodes[0].getnetworkinfo()\n+        network_info = self.nodes[1].getnetworkinfo()\n         assert_equal(int(network_info[\"localservices\"], 16) & NODE_P2P_V2, NODE_P2P_V2)\n         assert \"P2P_V2\" in network_info[\"localservicesnames\"]\n \n+        # V2 nodes can sync with V2 nodes\n+        assert_equal(self.nodes[0].getblockcount(), 0)\n+        assert_equal(self.nodes[1].getblockcount(), 0)\n+        with self.nodes[0].assert_debug_log(expected_msgs=[sending_handshake],\n+                                            unexpected_msgs=[downgrading_to_v1]):\n+            self.connect_nodes(0, 1, peer_advertises_v2=True)\n+        self.generate(self.nodes[0], 5, sync_fun=lambda: self.sync_all(self.nodes[0:2]))\n+        assert_equal(self.nodes[1].getblockcount(), 5)\n+        # verify there is a v2 connection between node 0 and 1\n+        node_0_info = self.nodes[0].getpeerinfo()\n+        node_1_info = self.nodes[0].getpeerinfo()",
      "path": "test/functional/p2p_v2_transport.py",
      "position": 45,
      "original_position": 41,
      "commit_id": "75a329103505736acb9036224da2dfa8ab038c43",
      "original_commit_id": "05d19fbcc10f26c7f1e3a9afc660eb7fa71b1d8c",
      "in_reply_to_id": 1389597811,
      "user": {
        "login": "kashifs",
        "id": 1489460,
        "node_id": "MDQ6VXNlcjE0ODk0NjA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1489460?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/kashifs",
        "html_url": "https://github.com/kashifs",
        "followers_url": "https://api.github.com/users/kashifs/followers",
        "following_url": "https://api.github.com/users/kashifs/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/kashifs/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/kashifs/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/kashifs/subscriptions",
        "organizations_url": "https://api.github.com/users/kashifs/orgs",
        "repos_url": "https://api.github.com/users/kashifs/repos",
        "events_url": "https://api.github.com/users/kashifs/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/kashifs/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "I've opened a PR [here](https://github.com/bitcoin/bitcoin/pull/28849). Please let me know if it's done correctly and if there is more that I should do.",
      "created_at": "2023-11-10T21:28:55Z",
      "updated_at": "2023-11-10T21:30:43Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28331#discussion_r1389939970",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1389939970"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28331"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 45,
      "original_line": 45,
      "side": "RIGHT"
    }
  ]
}
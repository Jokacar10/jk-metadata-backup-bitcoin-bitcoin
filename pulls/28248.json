{
  "type": "pull",
  "pull": {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28248",
    "id": 1469278636,
    "node_id": "PR_kwDOABII585Xk2ms",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/28248",
    "diff_url": "https://github.com/bitcoin/bitcoin/pull/28248.diff",
    "patch_url": "https://github.com/bitcoin/bitcoin/pull/28248.patch",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/28248",
    "commits_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28248/commits",
    "review_comments_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28248/comments",
    "review_comment_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments%7B/number%7D",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/28248/comments",
    "statuses_url": "https://api.github.com/repos/bitcoin/bitcoin/statuses/4238b6f0a7553ebc5cee6f7c77d3813193f7a322",
    "number": 28248,
    "state": "closed",
    "locked": true,
    "maintainer_can_modify": false,
    "title": "p2p: peer connection bug fixes",
    "user": {
      "login": "jonatack",
      "id": 2415484,
      "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jonatack",
      "html_url": "https://github.com/jonatack",
      "followers_url": "https://api.github.com/users/jonatack/followers",
      "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
      "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
      "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
      "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
      "organizations_url": "https://api.github.com/users/jonatack/orgs",
      "repos_url": "https://api.github.com/users/jonatack/repos",
      "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
      "received_events_url": "https://api.github.com/users/jonatack/received_events",
      "type": "User",
      "site_admin": false,
      "patch_url": null
    },
    "body": "This pull fixes several peer connection bugs in our p2p code, along with the logging that uncovered them:\r\n\r\n1. Fix detection of inbound peer connections in `GetAddedNodeInfo`.\r\n\r\n2. Fix addnode CJDNS peers not detected in `GetAddedNodeInfo`, causing `ThreadOpenAddedConnections` to continually retry to connect to them and RPC `getaddednodeinfo` incorrectly showing them as not connected.\r\n\r\n3. Fix `ThreadOpenConnections` not detecting inbound CJDNS connections and making automatic outbound connections to them.\r\n\r\n4. Fix detection of already connected peers in `AlreadyConnectedToAddress()`.\r\n\r\n5. Fix detection of already connected peers when making outbound connections in `ConnectNode`.\r\n\r\n6. Do not accept inbound connections in `CreateNodeFromAcceptedSocket` from I2P peers we're already connected to, as building I2P tunnels is expensive.\r\n\r\n7. Fix making automatic outbound connections in `ThreadOpenConnections` to addnode peers, in order not to allocate our limited outbound slots to them and to ensure addnode connections benefit from their intended protections. Our addnode logic usually connects the addnode peers before the automatic outbound logic does, but not always, as a connection race can occur (see the commit message for further details and mainnet examples). When an addnode peer is connected as an automatic outbound peer and is the only connection we have to a network, it can be protected by our new outbound network-specific eviction logic and persist in the \"wrong role\". Fix these issues by checking if the selected address is an addnode peer in our automatic outbound connection logic.\r\n\r\nUpdate the p2p logging with the improvements that allowed seeing/understanding/debugging the current behavior. Please see the commit messages for details.\r\n\r\nSimplify `MaybePickPreferredNetwork` to return `std::optional`, make it a const class method, and add Clang thread-safety analysis annotation and related assertions.\r\n",
    "labels": [
      {
        "id": 98298007,
        "node_id": "MDU6TGFiZWw5ODI5ODAwNw==",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/P2P",
        "name": "P2P",
        "color": "006b75",
        "default": false
      },
      {
        "id": 955867938,
        "node_id": "MDU6TGFiZWw5NTU4Njc5Mzg=",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Needs%20rebase",
        "name": "Needs rebase",
        "description": "",
        "color": "cccccc",
        "default": false
      },
      {
        "id": 5334691551,
        "node_id": "LA_kwDOABII588AAAABPfju3w",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/CI%20failed",
        "name": "CI failed",
        "description": "",
        "color": "cccccc",
        "default": false
      }
    ],
    "created_at": "2023-08-09T20:46:20Z",
    "updated_at": "2025-05-16T06:07:54Z",
    "closed_at": "2024-04-08T16:19:54Z",
    "mergeable": false,
    "mergeable_state": "dirty",
    "merged": false,
    "merge_commit_sha": "78bcd55e1e734f9a5073127453e9e52240a5fa73",
    "assignees": [],
    "requested_reviewers": [],
    "requested_teams": [],
    "rebaseable": false,
    "head": {
      "label": "jonatack:2023-08-network-diversity",
      "ref": "2023-08-network-diversity",
      "sha": "4238b6f0a7553ebc5cee6f7c77d3813193f7a322",
      "user": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "repo": {
        "id": 173103842,
        "node_id": "MDEwOlJlcG9zaXRvcnkxNzMxMDM4NDI=",
        "name": "bitcoin",
        "full_name": "jonatack/bitcoin",
        "owner": {
          "login": "jonatack",
          "id": 2415484,
          "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
          "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
          "gravatar_id": "",
          "url": "https://api.github.com/users/jonatack",
          "html_url": "https://github.com/jonatack",
          "followers_url": "https://api.github.com/users/jonatack/followers",
          "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
          "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
          "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
          "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
          "organizations_url": "https://api.github.com/users/jonatack/orgs",
          "repos_url": "https://api.github.com/users/jonatack/repos",
          "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
          "received_events_url": "https://api.github.com/users/jonatack/received_events",
          "type": "User",
          "site_admin": false,
          "patch_url": null
        },
        "private": false,
        "html_url": "https://github.com/jonatack/bitcoin",
        "description": "Bitcoin Core integration/staging tree",
        "fork": true,
        "url": "https://api.github.com/repos/jonatack/bitcoin",
        "archive_url": "https://api.github.com/repos/jonatack/bitcoin/%7Barchive_format%7D%7B/ref%7D",
        "assignees_url": "https://api.github.com/repos/jonatack/bitcoin/assignees%7B/user%7D",
        "blobs_url": "https://api.github.com/repos/jonatack/bitcoin/git/blobs%7B/sha%7D",
        "branches_url": "https://api.github.com/repos/jonatack/bitcoin/branches%7B/branch%7D",
        "collaborators_url": "https://api.github.com/repos/jonatack/bitcoin/collaborators%7B/collaborator%7D",
        "comments_url": "https://api.github.com/repos/jonatack/bitcoin/comments%7B/number%7D",
        "commits_url": "https://api.github.com/repos/jonatack/bitcoin/commits%7B/sha%7D",
        "compare_url": "https://api.github.com/repos/jonatack/bitcoin/compare/%7Bbase%7D...%7Bhead%7D",
        "contents_url": "https://api.github.com/repos/jonatack/bitcoin/contents/%7B+path%7D",
        "contributors_url": "https://api.github.com/repos/jonatack/bitcoin/contributors",
        "deployments_url": "https://api.github.com/repos/jonatack/bitcoin/deployments",
        "downloads_url": "https://api.github.com/repos/jonatack/bitcoin/downloads",
        "events_url": "https://api.github.com/repos/jonatack/bitcoin/events",
        "forks_url": "https://api.github.com/repos/jonatack/bitcoin/forks",
        "git_commits_url": "https://api.github.com/repos/jonatack/bitcoin/git/commits%7B/sha%7D",
        "git_refs_url": "https://api.github.com/repos/jonatack/bitcoin/git/refs%7B/sha%7D",
        "git_tags_url": "https://api.github.com/repos/jonatack/bitcoin/git/tags%7B/sha%7D",
        "git_url": "git://github.com/jonatack/bitcoin.git",
        "issue_comment_url": "https://api.github.com/repos/jonatack/bitcoin/issues/comments%7B/number%7D",
        "issue_events_url": "https://api.github.com/repos/jonatack/bitcoin/issues/events%7B/number%7D",
        "issues_url": "https://api.github.com/repos/jonatack/bitcoin/issues%7B/number%7D",
        "keys_url": "https://api.github.com/repos/jonatack/bitcoin/keys%7B/key_id%7D",
        "labels_url": "https://api.github.com/repos/jonatack/bitcoin/labels%7B/name%7D",
        "languages_url": "https://api.github.com/repos/jonatack/bitcoin/languages",
        "merges_url": "https://api.github.com/repos/jonatack/bitcoin/merges",
        "milestones_url": "https://api.github.com/repos/jonatack/bitcoin/milestones%7B/number%7D",
        "notifications_url": "https://api.github.com/repos/jonatack/bitcoin/notifications%7B?since,all,participating}",
        "pulls_url": "https://api.github.com/repos/jonatack/bitcoin/pulls%7B/number%7D",
        "releases_url": "https://api.github.com/repos/jonatack/bitcoin/releases%7B/id%7D",
        "ssh_url": "git@github.com:jonatack/bitcoin.git",
        "stargazers_url": "https://api.github.com/repos/jonatack/bitcoin/stargazers",
        "statuses_url": "https://api.github.com/repos/jonatack/bitcoin/statuses/%7Bsha%7D",
        "subscribers_url": "https://api.github.com/repos/jonatack/bitcoin/subscribers",
        "subscription_url": "https://api.github.com/repos/jonatack/bitcoin/subscription",
        "tags_url": "https://api.github.com/repos/jonatack/bitcoin/tags",
        "teams_url": "https://api.github.com/repos/jonatack/bitcoin/teams",
        "trees_url": "https://api.github.com/repos/jonatack/bitcoin/git/trees%7B/sha%7D",
        "clone_url": "https://github.com/jonatack/bitcoin.git",
        "hooks_url": "https://api.github.com/repos/jonatack/bitcoin/hooks",
        "svn_url": "https://github.com/jonatack/bitcoin",
        "homepage": "https://bitcoincore.org/en/download",
        "language": "C++",
        "forks_count": 1,
        "stargazers_count": 4,
        "watchers_count": 4,
        "size": 260342,
        "default_branch": "master",
        "open_issues_count": 0,
        "is_template": false,
        "topics": [],
        "has_issues": false,
        "has_projects": true,
        "has_wiki": false,
        "has_pages": false,
        "has_downloads": false,
        "archived": false,
        "disabled": false,
        "visibility": "public",
        "pushed_at": "2025-04-19T19:38:25Z",
        "created_at": "2019-02-28T11:57:18Z",
        "updated_at": "2024-09-23T23:32:53Z",
        "allow_forking": true,
        "license": {
          "key": "mit",
          "name": "MIT License",
          "node_id": "MDc6TGljZW5zZTEz",
          "spdx_id": "MIT",
          "url": "https://api.github.com/licenses/mit",
          "html_url": null,
          "description": null,
          "implementation": null,
          "permissions": null,
          "conditions": null,
          "limitations": null,
          "body": null,
          "featured": null
        }
      }
    },
    "base": {
      "label": "bitcoin:master",
      "ref": "master",
      "sha": "43704827b4c9c178f3651a005e26c09103cd4189",
      "user": {
        "login": "bitcoin",
        "id": 528860,
        "node_id": "MDEyOk9yZ2FuaXphdGlvbjUyODg2MA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/528860?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/bitcoin",
        "html_url": "https://github.com/bitcoin",
        "followers_url": "https://api.github.com/users/bitcoin/followers",
        "following_url": "https://api.github.com/users/bitcoin/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/bitcoin/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/bitcoin/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/bitcoin/subscriptions",
        "organizations_url": "https://api.github.com/users/bitcoin/orgs",
        "repos_url": "https://api.github.com/users/bitcoin/repos",
        "events_url": "https://api.github.com/users/bitcoin/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/bitcoin/received_events",
        "type": "Organization",
        "site_admin": false,
        "patch_url": null
      },
      "repo": {
        "id": 1181927,
        "node_id": "MDEwOlJlcG9zaXRvcnkxMTgxOTI3",
        "name": "bitcoin",
        "full_name": "bitcoin/bitcoin",
        "owner": {
          "login": "bitcoin",
          "id": 528860,
          "node_id": "MDEyOk9yZ2FuaXphdGlvbjUyODg2MA==",
          "avatar_url": "https://avatars.githubusercontent.com/u/528860?v=4",
          "gravatar_id": "",
          "url": "https://api.github.com/users/bitcoin",
          "html_url": "https://github.com/bitcoin",
          "followers_url": "https://api.github.com/users/bitcoin/followers",
          "following_url": "https://api.github.com/users/bitcoin/following%7B/other_user%7D",
          "gists_url": "https://api.github.com/users/bitcoin/gists%7B/gist_id%7D",
          "starred_url": "https://api.github.com/users/bitcoin/starred%7B/owner%7D%7B/repo%7D",
          "subscriptions_url": "https://api.github.com/users/bitcoin/subscriptions",
          "organizations_url": "https://api.github.com/users/bitcoin/orgs",
          "repos_url": "https://api.github.com/users/bitcoin/repos",
          "events_url": "https://api.github.com/users/bitcoin/events%7B/privacy%7D",
          "received_events_url": "https://api.github.com/users/bitcoin/received_events",
          "type": "Organization",
          "site_admin": false,
          "patch_url": null
        },
        "private": false,
        "html_url": "https://github.com/bitcoin/bitcoin",
        "description": "Bitcoin Core integration/staging tree",
        "fork": false,
        "url": "https://api.github.com/repos/bitcoin/bitcoin",
        "archive_url": "https://api.github.com/repos/bitcoin/bitcoin/%7Barchive_format%7D%7B/ref%7D",
        "assignees_url": "https://api.github.com/repos/bitcoin/bitcoin/assignees%7B/user%7D",
        "blobs_url": "https://api.github.com/repos/bitcoin/bitcoin/git/blobs%7B/sha%7D",
        "branches_url": "https://api.github.com/repos/bitcoin/bitcoin/branches%7B/branch%7D",
        "collaborators_url": "https://api.github.com/repos/bitcoin/bitcoin/collaborators%7B/collaborator%7D",
        "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/comments%7B/number%7D",
        "commits_url": "https://api.github.com/repos/bitcoin/bitcoin/commits%7B/sha%7D",
        "compare_url": "https://api.github.com/repos/bitcoin/bitcoin/compare/%7Bbase%7D...%7Bhead%7D",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/%7B+path%7D",
        "contributors_url": "https://api.github.com/repos/bitcoin/bitcoin/contributors",
        "deployments_url": "https://api.github.com/repos/bitcoin/bitcoin/deployments",
        "downloads_url": "https://api.github.com/repos/bitcoin/bitcoin/downloads",
        "events_url": "https://api.github.com/repos/bitcoin/bitcoin/events",
        "forks_url": "https://api.github.com/repos/bitcoin/bitcoin/forks",
        "git_commits_url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits%7B/sha%7D",
        "git_refs_url": "https://api.github.com/repos/bitcoin/bitcoin/git/refs%7B/sha%7D",
        "git_tags_url": "https://api.github.com/repos/bitcoin/bitcoin/git/tags%7B/sha%7D",
        "git_url": "git://github.com/bitcoin/bitcoin.git",
        "issue_comment_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments%7B/number%7D",
        "issue_events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events%7B/number%7D",
        "issues_url": "https://api.github.com/repos/bitcoin/bitcoin/issues%7B/number%7D",
        "keys_url": "https://api.github.com/repos/bitcoin/bitcoin/keys%7B/key_id%7D",
        "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/labels%7B/name%7D",
        "languages_url": "https://api.github.com/repos/bitcoin/bitcoin/languages",
        "merges_url": "https://api.github.com/repos/bitcoin/bitcoin/merges",
        "milestones_url": "https://api.github.com/repos/bitcoin/bitcoin/milestones%7B/number%7D",
        "notifications_url": "https://api.github.com/repos/bitcoin/bitcoin/notifications%7B?since,all,participating}",
        "pulls_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls%7B/number%7D",
        "releases_url": "https://api.github.com/repos/bitcoin/bitcoin/releases%7B/id%7D",
        "ssh_url": "git@github.com:bitcoin/bitcoin.git",
        "stargazers_url": "https://api.github.com/repos/bitcoin/bitcoin/stargazers",
        "statuses_url": "https://api.github.com/repos/bitcoin/bitcoin/statuses/%7Bsha%7D",
        "subscribers_url": "https://api.github.com/repos/bitcoin/bitcoin/subscribers",
        "subscription_url": "https://api.github.com/repos/bitcoin/bitcoin/subscription",
        "tags_url": "https://api.github.com/repos/bitcoin/bitcoin/tags",
        "teams_url": "https://api.github.com/repos/bitcoin/bitcoin/teams",
        "trees_url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees%7B/sha%7D",
        "clone_url": "https://github.com/bitcoin/bitcoin.git",
        "hooks_url": "https://api.github.com/repos/bitcoin/bitcoin/hooks",
        "svn_url": "https://github.com/bitcoin/bitcoin",
        "homepage": "https://bitcoincore.org/en/download",
        "language": "C++",
        "forks_count": 37224,
        "stargazers_count": 83600,
        "watchers_count": 83600,
        "size": 281975,
        "default_branch": "master",
        "open_issues_count": 732,
        "is_template": false,
        "topics": [
          "bitcoin",
          "c-plus-plus",
          "cryptocurrency",
          "cryptography",
          "p2p"
        ],
        "has_issues": true,
        "has_projects": true,
        "has_wiki": false,
        "has_pages": false,
        "has_downloads": false,
        "archived": false,
        "disabled": false,
        "visibility": "public",
        "pushed_at": "2025-05-15T15:58:39Z",
        "created_at": "2010-12-19T15:16:43Z",
        "updated_at": "2025-05-16T06:23:52Z",
        "allow_forking": true,
        "license": {
          "key": "mit",
          "name": "MIT License",
          "node_id": "MDc6TGljZW5zZTEz",
          "spdx_id": "MIT",
          "url": "https://api.github.com/licenses/mit",
          "html_url": null,
          "description": null,
          "implementation": null,
          "permissions": null,
          "conditions": null,
          "limitations": null,
          "body": null,
          "featured": null
        }
      }
    },
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28248"
      }
    },
    "author_association": "MEMBER",
    "draft": true,
    "additions": 200,
    "deletions": 88,
    "changed_files": 8,
    "commits": 15,
    "review_comments": 71,
    "comments": 30
  },
  "events": [
    {
      "event": "commented",
      "id": 1672125136,
      "node_id": "IC_kwDOABII585jqprQ",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1672125136",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-08-09T20:46:24Z",
      "updated_at": "2023-10-31T11:49:37Z",
      "author_association": "CONTRIBUTOR",
      "body": "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--006a51241073e994b41acfe9ec718e94-->\n### Code Coverage\nFor detailed information about the code coverage, see the [test coverage report](https://corecheck.dev/bitcoin/bitcoin/pulls/28248).\n<!--021abf342d371248e50ceaed478a90ca-->\n### Reviews\nSee [the guideline](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#code-review) for information on the review process.\n| Type | Reviewers |\n| ---- | --------- |\n| Concept ACK | [brunoerg](https://github.com/bitcoin/bitcoin/pull/28248#issuecomment-1777344970) |\n| Stale ACK | [vasild](https://github.com/bitcoin/bitcoin/pull/28248#pullrequestreview-1695032063) |\n\nIf your review is incorrectly listed, please react with 👎 to this comment and the bot will ignore it on the next update.\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* [#28155](https://github.com/bitcoin/bitcoin/pull/28155) (net: improves addnode / m_added_nodes logic by sr-gi)\n* [#27114](https://github.com/bitcoin/bitcoin/pull/27114) (p2p: Allow whitelisting outgoing connections by brunoerg)\n* [#27052](https://github.com/bitcoin/bitcoin/pull/27052) (test: rpc: add last block announcement time to getpeerinfo result by LarryRuane)\n* [#26859](https://github.com/bitcoin/bitcoin/pull/26859) (fuzz: extend ConsumeNetAddr() to return I2P and CJDNS addresses by vasild)\n* [#25832](https://github.com/bitcoin/bitcoin/pull/25832) (tracing: network connection tracepoints by 0xB10C)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.\n",
      "user": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28248#issuecomment-1672125136",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/28248"
    },
    {
      "event": "labeled",
      "id": 10052074961,
      "node_id": "LE_lADOABII585t6QbyzwAAAAJXJn3R",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10052074961",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-08-09T20:46:26Z",
      "label": {
        "name": "P2P",
        "color": "006b75"
      }
    },
    {
      "event": "ready_for_review",
      "id": 10053521088,
      "node_id": "RFRE_lADOABII585t6QbyzwAAAAJXPI7A",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10053521088",
      "actor": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-08-10T00:56:27Z"
    },
    {
      "event": "commented",
      "id": 1672930044,
      "node_id": "IC_kwDOABII585jtuL8",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1672930044",
      "actor": {
        "login": "dergoegge",
        "id": 8077169,
        "node_id": "MDQ6VXNlcjgwNzcxNjk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8077169?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dergoegge",
        "html_url": "https://github.com/dergoegge",
        "followers_url": "https://api.github.com/users/dergoegge/followers",
        "following_url": "https://api.github.com/users/dergoegge/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dergoegge/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dergoegge/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dergoegge/subscriptions",
        "organizations_url": "https://api.github.com/users/dergoegge/orgs",
        "repos_url": "https://api.github.com/users/dergoegge/repos",
        "events_url": "https://api.github.com/users/dergoegge/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dergoegge/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-08-10T10:03:44Z",
      "updated_at": "2023-08-10T10:03:44Z",
      "author_association": "MEMBER",
      "body": "The title \"p2p: outbound network diversity improvements\" makes it sound like you are improving on the logic for making outbound connections but really you are refactoring and adding additional logging. Would you mind making the title more accurate?\r\n\r\n> Please see the commit messages for details.\r\n\r\nThe PR description is added to the merge commit, so in my opinion it makes sense to have at least a summary of what the PR does in the description.\r\n\r\nFrom our [docs](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#creating-the-pull-request):\r\n```\r\nThe body of the pull request should contain sufficient description of what the patch does, and even more importantly, why, with \r\njustification and reasoning. You should include references to any discussions (for example, other issues or mailing list\r\ndiscussions).\r\n```",
      "user": {
        "login": "dergoegge",
        "id": 8077169,
        "node_id": "MDQ6VXNlcjgwNzcxNjk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8077169?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dergoegge",
        "html_url": "https://github.com/dergoegge",
        "followers_url": "https://api.github.com/users/dergoegge/followers",
        "following_url": "https://api.github.com/users/dergoegge/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dergoegge/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dergoegge/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dergoegge/subscriptions",
        "organizations_url": "https://api.github.com/users/dergoegge/orgs",
        "repos_url": "https://api.github.com/users/dergoegge/repos",
        "events_url": "https://api.github.com/users/dergoegge/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dergoegge/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28248#issuecomment-1672930044",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/28248"
    },
    {
      "event": "renamed",
      "id": 10064305065,
      "node_id": "RTE_lADOABII585t6QbyzwAAAAJX4Rup",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10064305065",
      "actor": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-08-10T21:49:12Z",
      "rename": {
        "from": "p2p: outbound network diversity improvements",
        "to": "p2p: outbound network diversity refactoring and logging improvements"
      }
    },
    {
      "event": "commented",
      "id": 1673966621,
      "node_id": "IC_kwDOABII585jxrQd",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1673966621",
      "actor": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-08-10T21:52:33Z",
      "updated_at": "2023-08-10T21:52:33Z",
      "author_association": "MEMBER",
      "body": "@dergoegge updated",
      "user": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28248#issuecomment-1673966621",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/28248"
    },
    {
      "event": "mentioned",
      "id": 10064322432,
      "node_id": "MEE_lADOABII585t6QbyzwAAAAJX4V-A",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10064322432",
      "actor": {
        "login": "dergoegge",
        "id": 8077169,
        "node_id": "MDQ6VXNlcjgwNzcxNjk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8077169?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dergoegge",
        "html_url": "https://github.com/dergoegge",
        "followers_url": "https://api.github.com/users/dergoegge/followers",
        "following_url": "https://api.github.com/users/dergoegge/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dergoegge/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dergoegge/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dergoegge/subscriptions",
        "organizations_url": "https://api.github.com/users/dergoegge/orgs",
        "repos_url": "https://api.github.com/users/dergoegge/repos",
        "events_url": "https://api.github.com/users/dergoegge/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dergoegge/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-08-10T21:52:33Z"
    },
    {
      "event": "subscribed",
      "id": 10064322441,
      "node_id": "SE_lADOABII585t6QbyzwAAAAJX4V-J",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10064322441",
      "actor": {
        "login": "dergoegge",
        "id": 8077169,
        "node_id": "MDQ6VXNlcjgwNzcxNjk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8077169?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dergoegge",
        "html_url": "https://github.com/dergoegge",
        "followers_url": "https://api.github.com/users/dergoegge/followers",
        "following_url": "https://api.github.com/users/dergoegge/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dergoegge/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dergoegge/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dergoegge/subscriptions",
        "organizations_url": "https://api.github.com/users/dergoegge/orgs",
        "repos_url": "https://api.github.com/users/dergoegge/repos",
        "events_url": "https://api.github.com/users/dergoegge/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dergoegge/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-08-10T21:52:33Z"
    },
    {
      "event": "commented",
      "id": 1674241624,
      "node_id": "IC_kwDOABII585jyuZY",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1674241624",
      "actor": {
        "login": "ajtowns",
        "id": 127186,
        "node_id": "MDQ6VXNlcjEyNzE4Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/127186?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ajtowns",
        "html_url": "https://github.com/ajtowns",
        "followers_url": "https://api.github.com/users/ajtowns/followers",
        "following_url": "https://api.github.com/users/ajtowns/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ajtowns/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ajtowns/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ajtowns/subscriptions",
        "organizations_url": "https://api.github.com/users/ajtowns/orgs",
        "repos_url": "https://api.github.com/users/ajtowns/repos",
        "events_url": "https://api.github.com/users/ajtowns/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ajtowns/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-08-11T05:51:05Z",
      "updated_at": "2023-08-11T05:51:05Z",
      "author_association": "CONTRIBUTOR",
      "body": "This mostly seems like pointless refactoring (changing a `switch` to an `||` of two functions that themselves have switches). Doesn't seem worth the review effort to me.",
      "user": {
        "login": "ajtowns",
        "id": 127186,
        "node_id": "MDQ6VXNlcjEyNzE4Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/127186?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ajtowns",
        "html_url": "https://github.com/ajtowns",
        "followers_url": "https://api.github.com/users/ajtowns/followers",
        "following_url": "https://api.github.com/users/ajtowns/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ajtowns/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ajtowns/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ajtowns/subscriptions",
        "organizations_url": "https://api.github.com/users/ajtowns/orgs",
        "repos_url": "https://api.github.com/users/ajtowns/repos",
        "events_url": "https://api.github.com/users/ajtowns/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ajtowns/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28248#issuecomment-1674241624",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/28248"
    },
    {
      "event": "unsubscribed",
      "id": 10067581798,
      "node_id": "UE_lADOABII585t6QbyzwAAAAJYExtm",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10067581798",
      "actor": {
        "login": "joostjager",
        "id": 4638168,
        "node_id": "MDQ6VXNlcjQ2MzgxNjg=",
        "avatar_url": "https://avatars.githubusercontent.com/u/4638168?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/joostjager",
        "html_url": "https://github.com/joostjager",
        "followers_url": "https://api.github.com/users/joostjager/followers",
        "following_url": "https://api.github.com/users/joostjager/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/joostjager/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/joostjager/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/joostjager/subscriptions",
        "organizations_url": "https://api.github.com/users/joostjager/orgs",
        "repos_url": "https://api.github.com/users/joostjager/repos",
        "events_url": "https://api.github.com/users/joostjager/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/joostjager/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-08-11T09:15:28Z"
    },
    {
      "event": "renamed",
      "id": 10074674878,
      "node_id": "RTE_lADOABII585t6QbyzwAAAAJYf1a-",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10074674878",
      "actor": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-08-12T00:11:14Z",
      "rename": {
        "from": "p2p: outbound network diversity refactoring and logging improvements",
        "to": "p2p: outbound logic, logging and refactoring improvements"
      }
    },
    {
      "event": "head_ref_force_pushed",
      "id": 10074710430,
      "node_id": "HRFPE_lADOABII585t6QbyzwAAAAJYf-Ge",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10074710430",
      "actor": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": "21b08952ba7832900bbdd623299d0f633297079f",
      "commit_url": "https://api.github.com/repos/jonatack/bitcoin/commits/21b08952ba7832900bbdd623299d0f633297079f",
      "created_at": "2023-08-12T00:18:37Z"
    },
    {
      "event": "renamed",
      "id": 10080790763,
      "node_id": "RTE_lADOABII585t6QbyzwAAAAJY3Kjr",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10080790763",
      "actor": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-08-13T23:14:22Z",
      "rename": {
        "from": "p2p: outbound logic, logging and refactoring improvements",
        "to": "p2p: bugfixes, logic and logging improvements"
      }
    },
    {
      "event": "head_ref_force_pushed",
      "id": 10080809757,
      "node_id": "HRFPE_lADOABII585t6QbyzwAAAAJY3PMd",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10080809757",
      "actor": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": "428169f5fe2220b5ce425642325b4308b0846c45",
      "commit_url": "https://api.github.com/repos/jonatack/bitcoin/commits/428169f5fe2220b5ce425642325b4308b0846c45",
      "created_at": "2023-08-13T23:25:05Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 10080870828,
      "node_id": "HRFPE_lADOABII585t6QbyzwAAAAJY3eGs",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10080870828",
      "actor": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": "875d7b0754a1b6298f7297c6aafbd34040f30306",
      "commit_url": "https://api.github.com/repos/jonatack/bitcoin/commits/875d7b0754a1b6298f7297c6aafbd34040f30306",
      "created_at": "2023-08-14T00:03:53Z"
    },
    {
      "event": "commented",
      "id": 1676644423,
      "node_id": "IC_kwDOABII585j75BH",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1676644423",
      "actor": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-08-14T04:12:30Z",
      "updated_at": "2023-08-14T04:12:30Z",
      "author_association": "MEMBER",
      "body": "Updated to propose fixes for the issues observed with the improved logging.",
      "user": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28248#issuecomment-1676644423",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/28248"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 10081846362,
      "node_id": "HRFPE_lADOABII585t6QbyzwAAAAJY7MRa",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10081846362",
      "actor": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": "4b9774dd49359cc0a807f1dc57b96d182330a4a1",
      "commit_url": "https://api.github.com/repos/jonatack/bitcoin/commits/4b9774dd49359cc0a807f1dc57b96d182330a4a1",
      "created_at": "2023-08-14T04:18:40Z"
    },
    {
      "event": "reviewed",
      "id": 1576881142,
      "node_id": "PRR_kwDOABII585d_Uv2",
      "url": null,
      "actor": null,
      "commit_id": "4b9774dd49359cc0a807f1dc57b96d182330a4a1",
      "commit_url": null,
      "created_at": null,
      "author_association": "CONTRIBUTOR",
      "body": "",
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28248#pullrequestreview-1576881142",
      "submitted_at": "2023-08-14T13:58:38Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28248"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 10099580214,
      "node_id": "HRFPE_lADOABII585t6QbyzwAAAAJZ-102",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10099580214",
      "actor": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": "a411cb5a170098c99e7c64f508153613f5e377da",
      "commit_url": "https://api.github.com/repos/jonatack/bitcoin/commits/a411cb5a170098c99e7c64f508153613f5e377da",
      "created_at": "2023-08-15T17:27:13Z"
    },
    {
      "event": "commented",
      "id": 1679547504,
      "node_id": "IC_kwDOABII585kG9xw",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1679547504",
      "actor": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-08-15T20:16:18Z",
      "updated_at": "2023-08-15T20:16:18Z",
      "author_association": "MEMBER",
      "body": "Updated for @vasild's review feedback to change `m_added_nodes` from a vector to an unordered set (https://github.com/bitcoin/bitcoin/pull/28248/commits/3f4a1f0bc98159f86d910227fd57d05d10bb8889), which simplifies and speeds up the `AddNode()` and `RemoveAddedNode()` methods along with the commit that follows it, `p2p: do not make automatic outbound connections to addnode peers` (048e1af).",
      "user": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28248#issuecomment-1679547504",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/28248"
    },
    {
      "event": "mentioned",
      "id": 10101061269,
      "node_id": "MEE_lADOABII585t6QbyzwAAAAJaEfaV",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10101061269",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-08-15T20:16:18Z"
    },
    {
      "event": "subscribed",
      "id": 10101061276,
      "node_id": "SE_lADOABII585t6QbyzwAAAAJaEfac",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10101061276",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-08-15T20:16:18Z"
    },
    {
      "event": "labeled",
      "id": 10101709660,
      "node_id": "LE_lADOABII585t6QbyzwAAAAJaG9tc",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10101709660",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-08-15T21:41:47Z",
      "label": {
        "name": "CI failed",
        "color": "cccccc"
      }
    },
    {
      "event": "reviewed",
      "id": 1580868907,
      "node_id": "PRR_kwDOABII585eOiUr",
      "url": null,
      "actor": null,
      "commit_id": "a411cb5a170098c99e7c64f508153613f5e377da",
      "commit_url": null,
      "created_at": null,
      "author_association": "CONTRIBUTOR",
      "body": "",
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28248#pullrequestreview-1580868907",
      "submitted_at": "2023-08-16T15:58:54Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28248"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 10290438673,
      "node_id": "HRFPE_lADOABII585t6QbyzwAAAAJlW6IR",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10290438673",
      "actor": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": "abc25073a8621509ff63d5d0570b9d80c38e0399",
      "commit_url": "https://api.github.com/repos/jonatack/bitcoin/commits/abc25073a8621509ff63d5d0570b9d80c38e0399",
      "created_at": "2023-09-06T03:49:29Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 10291591959,
      "node_id": "HRFPE_lADOABII585t6QbyzwAAAAJlbTsX",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10291591959",
      "actor": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": "7019c23bfa8bf98b1b1b17a9505e48e6922b7be8",
      "commit_url": "https://api.github.com/repos/jonatack/bitcoin/commits/7019c23bfa8bf98b1b1b17a9505e48e6922b7be8",
      "created_at": "2023-09-06T06:20:18Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 10297773274,
      "node_id": "HRFPE_lADOABII585t6QbyzwAAAAJly4za",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10297773274",
      "actor": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": "7fd96eb005a951927d900973cec231abbf1867a5",
      "commit_url": "https://api.github.com/repos/jonatack/bitcoin/commits/7fd96eb005a951927d900973cec231abbf1867a5",
      "created_at": "2023-09-06T15:48:26Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 10297946297,
      "node_id": "HRFPE_lADOABII585t6QbyzwAAAAJlzjC5",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10297946297",
      "actor": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": "6422c112511a5198a678e9ea6f61a4b739b27e18",
      "commit_url": "https://api.github.com/repos/jonatack/bitcoin/commits/6422c112511a5198a678e9ea6f61a4b739b27e18",
      "created_at": "2023-09-06T16:04:54Z"
    },
    {
      "event": "commented",
      "id": 1708918026,
      "node_id": "IC_kwDOABII585l3AUK",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1708918026",
      "actor": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-09-06T18:51:57Z",
      "updated_at": "2023-09-06T18:51:57Z",
      "author_association": "MEMBER",
      "body": "Rebased, updated with improved logging, and fixes for additional issues (71828e0c, f126d041, a1b1a24) observed with the logging or suggested by @vasild (thanks!)",
      "user": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28248#issuecomment-1708918026",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/28248"
    },
    {
      "event": "mentioned",
      "id": 10299473703,
      "node_id": "MEE_lADOABII585t6QbyzwAAAAJl5X8n",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10299473703",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-09-06T18:51:57Z"
    },
    {
      "event": "subscribed",
      "id": 10299473712,
      "node_id": "SE_lADOABII585t6QbyzwAAAAJl5X8w",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10299473712",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-09-06T18:51:57Z"
    },
    {
      "event": "unlabeled",
      "id": 10301711711,
      "node_id": "UNLE_lADOABII585t6QbyzwAAAAJmB6Vf",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10301711711",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-09-07T00:57:21Z",
      "label": {
        "name": "CI failed",
        "color": "cccccc"
      }
    },
    {
      "event": "subscribed",
      "id": 10311085566,
      "node_id": "SE_lADOABII585t6QbyzwAAAAJmlq3-",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10311085566",
      "actor": {
        "login": "0xB10C",
        "id": 19157360,
        "node_id": "MDQ6VXNlcjE5MTU3MzYw",
        "avatar_url": "https://avatars.githubusercontent.com/u/19157360?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/0xB10C",
        "html_url": "https://github.com/0xB10C",
        "followers_url": "https://api.github.com/users/0xB10C/followers",
        "following_url": "https://api.github.com/users/0xB10C/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/0xB10C/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/0xB10C/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/0xB10C/subscriptions",
        "organizations_url": "https://api.github.com/users/0xB10C/orgs",
        "repos_url": "https://api.github.com/users/0xB10C/repos",
        "events_url": "https://api.github.com/users/0xB10C/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/0xB10C/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-09-07T19:37:39Z"
    },
    {
      "event": "renamed",
      "id": 10324365366,
      "node_id": "RTE_lADOABII585t6QbyzwAAAAJnYVA2",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10324365366",
      "actor": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-09-09T14:03:18Z",
      "rename": {
        "from": "p2p: bugfixes, logic and logging improvements",
        "to": "p2p: peer connection bug fixes, logic and logging improvements"
      }
    },
    {
      "event": "head_ref_force_pushed",
      "id": 10327942143,
      "node_id": "HRFPE_lADOABII585t6QbyzwAAAAJnl-P_",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10327942143",
      "actor": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": "a4887e4d7db8d247d118155360d435c34cb0adb9",
      "commit_url": "https://api.github.com/repos/jonatack/bitcoin/commits/a4887e4d7db8d247d118155360d435c34cb0adb9",
      "created_at": "2023-09-11T01:33:00Z"
    },
    {
      "event": "commented",
      "id": 1716403390,
      "node_id": "IC_kwDOABII585mTjy-",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1716403390",
      "actor": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-09-12T20:43:38Z",
      "updated_at": "2023-09-12T20:43:38Z",
      "author_association": "MEMBER",
      "body": "Updated with further logging improvements. The p2p peer connection bugfixes here are unchanged from the previous push. It may be a good idea to tag this for v26?",
      "user": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28248#issuecomment-1716403390",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/28248"
    },
    {
      "event": "reviewed",
      "id": 1623186191,
      "node_id": "PRR_kwDOABII585gv9sP",
      "url": null,
      "actor": null,
      "commit_id": "a4887e4d7db8d247d118155360d435c34cb0adb9",
      "commit_url": null,
      "created_at": null,
      "author_association": "CONTRIBUTOR",
      "body": "Just had a short look and some questions, will review properly in the next weeks.",
      "user": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28248#pullrequestreview-1623186191",
      "submitted_at": "2023-09-12T22:13:21Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28248"
    },
    {
      "event": "unsubscribed",
      "id": 10352868774,
      "node_id": "UE_lADOABII585t6QbyzwAAAAJpFD2m",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10352868774",
      "actor": {
        "login": "9cat",
        "id": 1379110,
        "node_id": "MDQ6VXNlcjEzNzkxMTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1379110?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/9cat",
        "html_url": "https://github.com/9cat",
        "followers_url": "https://api.github.com/users/9cat/followers",
        "following_url": "https://api.github.com/users/9cat/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/9cat/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/9cat/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/9cat/subscriptions",
        "organizations_url": "https://api.github.com/users/9cat/orgs",
        "repos_url": "https://api.github.com/users/9cat/repos",
        "events_url": "https://api.github.com/users/9cat/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/9cat/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-09-12T23:14:58Z"
    },
    {
      "event": "labeled",
      "id": 10370583833,
      "node_id": "LE_lADOABII585t6QbyzwAAAAJqIo0Z",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10370583833",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-09-14T10:38:34Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "commented",
      "id": 1719220940,
      "node_id": "IC_kwDOABII585meTrM",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1719220940",
      "actor": {
        "login": "dergoegge",
        "id": 8077169,
        "node_id": "MDQ6VXNlcjgwNzcxNjk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8077169?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dergoegge",
        "html_url": "https://github.com/dergoegge",
        "followers_url": "https://api.github.com/users/dergoegge/followers",
        "following_url": "https://api.github.com/users/dergoegge/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dergoegge/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dergoegge/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dergoegge/subscriptions",
        "organizations_url": "https://api.github.com/users/dergoegge/orgs",
        "repos_url": "https://api.github.com/users/dergoegge/repos",
        "events_url": "https://api.github.com/users/dergoegge/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dergoegge/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-09-14T10:50:47Z",
      "updated_at": "2023-09-14T10:50:47Z",
      "author_association": "MEMBER",
      "body": "If you're fixing bugs, it would be very beneficial to also add tests at the same time.",
      "user": {
        "login": "dergoegge",
        "id": 8077169,
        "node_id": "MDQ6VXNlcjgwNzcxNjk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8077169?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dergoegge",
        "html_url": "https://github.com/dergoegge",
        "followers_url": "https://api.github.com/users/dergoegge/followers",
        "following_url": "https://api.github.com/users/dergoegge/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dergoegge/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dergoegge/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dergoegge/subscriptions",
        "organizations_url": "https://api.github.com/users/dergoegge/orgs",
        "repos_url": "https://api.github.com/users/dergoegge/repos",
        "events_url": "https://api.github.com/users/dergoegge/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dergoegge/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28248#issuecomment-1719220940",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/28248"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 10612651020,
      "node_id": "HRFPE_lADOABII585t6QbyzwAAAAJ4kDQM",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10612651020",
      "actor": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": "2a9db3a16a93d497bfe496b7c35edac975ee81d2",
      "commit_url": "https://api.github.com/repos/jonatack/bitcoin/commits/2a9db3a16a93d497bfe496b7c35edac975ee81d2",
      "created_at": "2023-10-11T03:43:43Z"
    },
    {
      "event": "unlabeled",
      "id": 10613283710,
      "node_id": "UNLE_lADOABII585t6QbyzwAAAAJ4mdt-",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10613283710",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-10-11T05:33:46Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "reviewed",
      "id": 1673614690,
      "node_id": "PRR_kwDOABII585jwVVi",
      "url": null,
      "actor": null,
      "commit_id": "2a9db3a16a93d497bfe496b7c35edac975ee81d2",
      "commit_url": null,
      "created_at": null,
      "author_association": "CONTRIBUTOR",
      "body": "Reviewed as of 2a9db3a16a93d497bfe496b7c35edac975ee81d2. Good fixes! LGTM modulo the comments below.",
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28248#pullrequestreview-1673614690",
      "submitted_at": "2023-10-12T11:16:08Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28248"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 10672940338,
      "node_id": "HRFPE_lADOABII585t6QbyzwAAAAJ8KCUy",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10672940338",
      "actor": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": "0157d23355f15ef186430089c89044fc9a8d347e",
      "commit_url": "https://api.github.com/repos/jonatack/bitcoin/commits/0157d23355f15ef186430089c89044fc9a8d347e",
      "created_at": "2023-10-17T04:10:01Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 10673000323,
      "node_id": "HRFPE_lADOABII585t6QbyzwAAAAJ8KQ-D",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10673000323",
      "actor": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": "74c5c53071c04036bdf724c154ed60c37f0b09d5",
      "commit_url": "https://api.github.com/repos/jonatack/bitcoin/commits/74c5c53071c04036bdf724c154ed60c37f0b09d5",
      "created_at": "2023-10-17T04:21:23Z"
    },
    {
      "event": "labeled",
      "id": 10673001177,
      "node_id": "LE_lADOABII585t6QbyzwAAAAJ8KRLZ",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10673001177",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-10-17T04:21:33Z",
      "label": {
        "name": "CI failed",
        "color": "cccccc"
      }
    },
    {
      "event": "head_ref_force_pushed",
      "id": 10673086637,
      "node_id": "HRFPE_lADOABII585t6QbyzwAAAAJ8KmCt",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10673086637",
      "actor": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": "44ceac2ef9992c799dce22477a5884bd82ba9860",
      "commit_url": "https://api.github.com/repos/jonatack/bitcoin/commits/44ceac2ef9992c799dce22477a5884bd82ba9860",
      "created_at": "2023-10-17T04:39:00Z"
    },
    {
      "event": "commented",
      "id": 1765675944,
      "node_id": "IC_kwDOABII585pPhOo",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1765675944",
      "actor": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-10-17T05:07:12Z",
      "updated_at": "2023-10-17T05:07:12Z",
      "author_association": "MEMBER",
      "body": "Thank you, @vasild! I've pushed a WIP checkpoint update covering all your suggestions. Will return to it tomorrow and happy to take any further suggestions you may have.",
      "user": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28248#issuecomment-1765675944",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/28248"
    },
    {
      "event": "mentioned",
      "id": 10673243013,
      "node_id": "MEE_lADOABII585t6QbyzwAAAAJ8LMOF",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10673243013",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-10-17T05:07:12Z"
    },
    {
      "event": "subscribed",
      "id": 10673243029,
      "node_id": "SE_lADOABII585t6QbyzwAAAAJ8LMOV",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10673243029",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-10-17T05:07:12Z"
    },
    {
      "event": "unlabeled",
      "id": 10673605094,
      "node_id": "UNLE_lADOABII585t6QbyzwAAAAJ8Mknm",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10673605094",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-10-17T06:07:54Z",
      "label": {
        "name": "CI failed",
        "color": "cccccc"
      }
    },
    {
      "event": "reviewed",
      "id": 1682305820,
      "node_id": "PRR_kwDOABII585kRfMc",
      "url": null,
      "actor": null,
      "commit_id": "44ceac2ef9992c799dce22477a5884bd82ba9860",
      "commit_url": null,
      "created_at": null,
      "author_association": "CONTRIBUTOR",
      "body": "Looks good as of 44ceac2ef9 (the last commit needs to be dispersed).",
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28248#pullrequestreview-1682305820",
      "submitted_at": "2023-10-17T13:40:21Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28248"
    },
    {
      "event": "labeled",
      "id": 10715605934,
      "node_id": "LE_lADOABII585t6QbyzwAAAAJ-syuu",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10715605934",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-10-19T18:26:17Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "head_ref_force_pushed",
      "id": 10748810402,
      "node_id": "HRFPE_lADOABII585t6QbyzwAAAAKArdSi",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10748810402",
      "actor": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": "defcef5ed3081e95515d764c6d47c59bf7644bdb",
      "commit_url": "https://api.github.com/repos/jonatack/bitcoin/commits/defcef5ed3081e95515d764c6d47c59bf7644bdb",
      "created_at": "2023-10-24T03:44:43Z"
    },
    {
      "event": "commented",
      "id": 1776503589,
      "node_id": "IC_kwDOABII585p40sl",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1776503589",
      "actor": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-10-24T04:01:12Z",
      "updated_at": "2023-10-24T13:34:59Z",
      "author_association": "MEMBER",
      "body": "Rebased and updated to take the latest feedback from @vasild.",
      "user": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28248#issuecomment-1776503589",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/28248"
    },
    {
      "event": "mentioned",
      "id": 10748921814,
      "node_id": "MEE_lADOABII585t6QbyzwAAAAKAr4fW",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10748921814",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-10-24T04:01:12Z"
    },
    {
      "event": "subscribed",
      "id": 10748921820,
      "node_id": "SE_lADOABII585t6QbyzwAAAAKAr4fc",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10748921820",
      "actor": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-10-24T04:01:12Z"
    },
    {
      "event": "labeled",
      "id": 10749430560,
      "node_id": "LE_lADOABII585t6QbyzwAAAAKAt0sg",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10749430560",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-10-24T05:45:43Z",
      "label": {
        "name": "CI failed",
        "color": "cccccc"
      }
    },
    {
      "event": "unlabeled",
      "id": 10749430779,
      "node_id": "UNLE_lADOABII585t6QbyzwAAAAKAt0v7",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10749430779",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-10-24T05:45:45Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKGQ3NDYyMzE4MDk4MTRmNTI2OTVhMzc2YmQ3N2Y0ZDA2NjIyMjg5YTQ",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/d746231809814f52695a376bd77f4d06622289a4",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/d746231809814f52695a376bd77f4d06622289a4",
      "tree": {
        "sha": "505e5190c2563e082f8a45dd6bbfcc7b5cc24b2a",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/505e5190c2563e082f8a45dd6bbfcc7b5cc24b2a"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/004367dba8a3e8520b871f27945a0dad7820bb3a",
          "sha": "004367dba8a3e8520b871f27945a0dad7820bb3a",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/004367dba8a3e8520b871f27945a0dad7820bb3a"
        }
      ],
      "message": "p2p, bugfix: detect all inbound connections in GetAddedNodeInfo()\n\nDue to their potentially different port numbers, inbound peers can be overlooked\nin CConnman::GetAddedNodeInfo() when comparing CServices, i.e. both addr and port.\n\nFix this by comparing CNetAddr instances, i.e. addr only, for inbound peers.\n\nCo-authored-by: Jon Atack <jon@atack.com>",
      "committer": {
        "name": "Jon Atack",
        "email": "jon@atack.com",
        "date": "2023-10-24T13:02:18Z"
      },
      "author": {
        "name": "Vasil Dimov",
        "email": "vd@FreeBSD.org",
        "date": "2023-09-06T00:06:32Z"
      },
      "sha": "d746231809814f52695a376bd77f4d06622289a4"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDVmNTNlNmMwNzNkMDg5NTk4YTQ0NDQzNmQ3NGUxZjVjMTYxNTAzMGI",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/5f53e6c073d089598a444436d74e1f5c1615030b",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/5f53e6c073d089598a444436d74e1f5c1615030b",
      "tree": {
        "sha": "58c459cc6b922b48c46cc58b23a4bfa6eb66a461",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/58c459cc6b922b48c46cc58b23a4bfa6eb66a461"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/d746231809814f52695a376bd77f4d06622289a4",
          "sha": "d746231809814f52695a376bd77f4d06622289a4",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/d746231809814f52695a376bd77f4d06622289a4"
        }
      ],
      "message": "p2p, bugfix: detect addnode cjdns peers in GetAddedNodeInfo()\n\nAddnode (manual) peers connected to us via the cjdns network are currently not\ndetected by CConnman::GetAddedNodeInfo(), i.e. fConnected is always false.\n\nThis causes the following issues:\n\n- RPC `getaddednodeinfo` incorrectly shows them as not connected\n\n- CConnman::ThreadOpenAddedConnections() continually retries to connect them",
      "committer": {
        "name": "Jon Atack",
        "email": "jon@atack.com",
        "date": "2023-10-24T13:02:18Z"
      },
      "author": {
        "name": "Jon Atack",
        "email": "jon@atack.com",
        "date": "2023-08-11T22:12:42Z"
      },
      "sha": "5f53e6c073d089598a444436d74e1f5c1615030b"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDEyZmY4MDc3Y2U5ZWVkMTJmYjcxZWVkZmY0YjAxOGIwOWYyMjUyY2Q",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/12ff8077ce9eed12fb71eedff4b018b09f2252cd",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/12ff8077ce9eed12fb71eedff4b018b09f2252cd",
      "tree": {
        "sha": "89d2fe991700a00c13701c925d1731323bea01a4",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/89d2fe991700a00c13701c925d1731323bea01a4"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/5f53e6c073d089598a444436d74e1f5c1615030b",
          "sha": "5f53e6c073d089598a444436d74e1f5c1615030b",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/5f53e6c073d089598a444436d74e1f5c1615030b"
        }
      ],
      "message": "p2p, bugfix: detect inbound cjdns peers in AlreadyConnectedToAddress()\n\nCurrently ThreadOpenConnections() does not detect inbound cjdns peers that we\nare already connected to when it calls AlreadyConnectedToAddress().\n\nFix this by calling MaybeFlipIPv6toCJDNS before the search.",
      "committer": {
        "name": "Jon Atack",
        "email": "jon@atack.com",
        "date": "2023-10-24T13:02:18Z"
      },
      "author": {
        "name": "Jon Atack",
        "email": "jon@atack.com",
        "date": "2023-08-13T15:59:49Z"
      },
      "sha": "12ff8077ce9eed12fb71eedff4b018b09f2252cd"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDk1ZDhhZDNiOWEwYWI2MjE3NDNmMzI3ODNiNDBkMWQyM2QyNWJmMTg",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/95d8ad3b9a0ab621743f32783b40d1d23d25bf18",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/95d8ad3b9a0ab621743f32783b40d1d23d25bf18",
      "tree": {
        "sha": "8295c6d3865d00a6dc753259b0ca52ec3821410d",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/8295c6d3865d00a6dc753259b0ca52ec3821410d"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/12ff8077ce9eed12fb71eedff4b018b09f2252cd",
          "sha": "12ff8077ce9eed12fb71eedff4b018b09f2252cd",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/12ff8077ce9eed12fb71eedff4b018b09f2252cd"
        }
      ],
      "message": "refactor: move locks from CConnman::FindNode methods to their callers\n\nDereferencing the pointer result after FindNode* has released m_nodes_mutex is unsafe,\nso we currently have to add unneeded recursive locks before calling FindNode*.\n\nFix this by acquiring the mutex before calling FindNode* rather than inside them.\n\nCo-authored-by: Vasil Dimov <vd@FreeBSD.org>",
      "committer": {
        "name": "Jon Atack",
        "email": "jon@atack.com",
        "date": "2023-10-24T13:02:18Z"
      },
      "author": {
        "name": "Jon Atack",
        "email": "jon@atack.com",
        "date": "2023-10-23T21:50:03Z"
      },
      "sha": "95d8ad3b9a0ab621743f32783b40d1d23d25bf18"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDkxNzk2YWQyNzI2OTc4ODAxZmIzM2UyMGEyMTNlZmMxNmIyMmI5OWU",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/91796ad2726978801fb33e20a213efc16b22b99e",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/91796ad2726978801fb33e20a213efc16b22b99e",
      "tree": {
        "sha": "9a7dd56e71b82c5b461a68e44b7494e882f6df66",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/9a7dd56e71b82c5b461a68e44b7494e882f6df66"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/95d8ad3b9a0ab621743f32783b40d1d23d25bf18",
          "sha": "95d8ad3b9a0ab621743f32783b40d1d23d25bf18",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/95d8ad3b9a0ab621743f32783b40d1d23d25bf18"
        }
      ],
      "message": "refactor: allow CConnman::FindNode methods to filter by inbound status",
      "committer": {
        "name": "Jon Atack",
        "email": "jon@atack.com",
        "date": "2023-10-24T13:02:18Z"
      },
      "author": {
        "name": "Jon Atack",
        "email": "jon@atack.com",
        "date": "2023-10-23T22:05:55Z"
      },
      "sha": "91796ad2726978801fb33e20a213efc16b22b99e"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 10753708205,
      "node_id": "HRFPE_lADOABII585t6QbyzwAAAAKA-JCt",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10753708205",
      "actor": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": "f196b096f55f909e2bb63d5ff43bc3418c0ebbab",
      "commit_url": "https://api.github.com/repos/jonatack/bitcoin/commits/f196b096f55f909e2bb63d5ff43bc3418c0ebbab",
      "created_at": "2023-10-24T13:08:58Z"
    },
    {
      "event": "renamed",
      "id": 10753963555,
      "node_id": "RTE_lADOABII585t6QbyzwAAAAKA_HYj",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10753963555",
      "actor": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-10-24T13:30:53Z",
      "rename": {
        "from": "p2p: peer connection bug fixes, logic and logging improvements",
        "to": "p2p: peer connection bug fixes"
      }
    },
    {
      "event": "reviewed",
      "id": 1695032063,
      "node_id": "PRR_kwDOABII585lCCL_",
      "url": null,
      "actor": null,
      "commit_id": "f196b096f55f909e2bb63d5ff43bc3418c0ebbab",
      "commit_url": null,
      "created_at": null,
      "author_association": "CONTRIBUTOR",
      "body": "ACK f196b096f55f909e2bb63d5ff43bc3418c0ebbab",
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28248#pullrequestreview-1695032063",
      "submitted_at": "2023-10-24T14:23:35Z",
      "state": "APPROVED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28248"
    },
    {
      "event": "reviewed",
      "id": 1695037517,
      "node_id": "PRR_kwDOABII585lCDhN",
      "url": null,
      "actor": null,
      "commit_id": "2ec971326d3de33455a626b8189e0375fc88061f",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "user": {
        "login": "dergoegge",
        "id": 8077169,
        "node_id": "MDQ6VXNlcjgwNzcxNjk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8077169?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dergoegge",
        "html_url": "https://github.com/dergoegge",
        "followers_url": "https://api.github.com/users/dergoegge/followers",
        "following_url": "https://api.github.com/users/dergoegge/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dergoegge/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dergoegge/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dergoegge/subscriptions",
        "organizations_url": "https://api.github.com/users/dergoegge/orgs",
        "repos_url": "https://api.github.com/users/dergoegge/repos",
        "events_url": "https://api.github.com/users/dergoegge/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dergoegge/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28248#pullrequestreview-1695037517",
      "submitted_at": "2023-10-24T14:25:53Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28248"
    },
    {
      "event": "reviewed",
      "id": 1695050402,
      "node_id": "PRR_kwDOABII585lCGqi",
      "url": null,
      "actor": null,
      "commit_id": "f196b096f55f909e2bb63d5ff43bc3418c0ebbab",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "user": {
        "login": "fanquake",
        "id": 863730,
        "node_id": "MDQ6VXNlcjg2MzczMA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/863730?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fanquake",
        "html_url": "https://github.com/fanquake",
        "followers_url": "https://api.github.com/users/fanquake/followers",
        "following_url": "https://api.github.com/users/fanquake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fanquake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fanquake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fanquake/subscriptions",
        "organizations_url": "https://api.github.com/users/fanquake/orgs",
        "repos_url": "https://api.github.com/users/fanquake/repos",
        "events_url": "https://api.github.com/users/fanquake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fanquake/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28248#pullrequestreview-1695050402",
      "submitted_at": "2023-10-24T14:30:43Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28248"
    },
    {
      "event": "commented",
      "id": 1777344970,
      "node_id": "IC_kwDOABII585p8CHK",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1777344970",
      "actor": {
        "login": "brunoerg",
        "id": 19480819,
        "node_id": "MDQ6VXNlcjE5NDgwODE5",
        "avatar_url": "https://avatars.githubusercontent.com/u/19480819?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/brunoerg",
        "html_url": "https://github.com/brunoerg",
        "followers_url": "https://api.github.com/users/brunoerg/followers",
        "following_url": "https://api.github.com/users/brunoerg/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/brunoerg/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/brunoerg/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/brunoerg/subscriptions",
        "organizations_url": "https://api.github.com/users/brunoerg/orgs",
        "repos_url": "https://api.github.com/users/brunoerg/repos",
        "events_url": "https://api.github.com/users/brunoerg/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/brunoerg/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-10-24T14:31:22Z",
      "updated_at": "2023-10-24T14:32:11Z",
      "author_association": "CONTRIBUTOR",
      "body": "Concept ACK\r\n\r\ntests for the bug fixes would be helpful",
      "user": {
        "login": "brunoerg",
        "id": 19480819,
        "node_id": "MDQ6VXNlcjE5NDgwODE5",
        "avatar_url": "https://avatars.githubusercontent.com/u/19480819?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/brunoerg",
        "html_url": "https://github.com/brunoerg",
        "followers_url": "https://api.github.com/users/brunoerg/followers",
        "following_url": "https://api.github.com/users/brunoerg/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/brunoerg/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/brunoerg/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/brunoerg/subscriptions",
        "organizations_url": "https://api.github.com/users/brunoerg/orgs",
        "repos_url": "https://api.github.com/users/brunoerg/repos",
        "events_url": "https://api.github.com/users/brunoerg/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/brunoerg/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28248#issuecomment-1777344970",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/28248"
    },
    {
      "event": "reviewed",
      "id": 1695165495,
      "node_id": "PRR_kwDOABII585lCiw3",
      "url": null,
      "actor": null,
      "commit_id": "f196b096f55f909e2bb63d5ff43bc3418c0ebbab",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "user": {
        "login": "fanquake",
        "id": 863730,
        "node_id": "MDQ6VXNlcjg2MzczMA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/863730?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fanquake",
        "html_url": "https://github.com/fanquake",
        "followers_url": "https://api.github.com/users/fanquake/followers",
        "following_url": "https://api.github.com/users/fanquake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fanquake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fanquake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fanquake/subscriptions",
        "organizations_url": "https://api.github.com/users/fanquake/orgs",
        "repos_url": "https://api.github.com/users/fanquake/repos",
        "events_url": "https://api.github.com/users/fanquake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fanquake/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28248#pullrequestreview-1695165495",
      "submitted_at": "2023-10-24T15:04:20Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28248"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKGNiODJhOTI4NWNjYjU4YTFmOGZlZjQxYzRjZTY2NGM1ZmU0NmZjOTQ",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/cb82a9285ccb58a1f8fef41c4ce664c5fe46fc94",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/cb82a9285ccb58a1f8fef41c4ce664c5fe46fc94",
      "tree": {
        "sha": "a3131879907a43a13800f9d9ffd51c319bc178ab",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/a3131879907a43a13800f9d9ffd51c319bc178ab"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/91796ad2726978801fb33e20a213efc16b22b99e",
          "sha": "91796ad2726978801fb33e20a213efc16b22b99e",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/91796ad2726978801fb33e20a213efc16b22b99e"
        }
      ],
      "message": "p2p, bugfix: correctly detect connected peers in AlreadyConnectedToAddress()\n\nusing the following logic:\n\nIf we are about to open an outbound connection\n  - for all outbound connections, compare the peer's address and port\n  - for all inbound connections and provided we're not making a manual connection,\n    compare only the address and ignore the port\n\nIf we are about to accept an inbound connection\n  - for all connections, both inbound and outbound, compare only the address and\n    ignore the port\n\nFix the logging to be actually useful by stating which peer is already connected,\nand further improve it to provide full details for debugging purposes.\n\nCo-authored-by: Vasil Dimov <vd@FreeBSD.org>",
      "committer": {
        "name": "Jon Atack",
        "email": "jon@atack.com",
        "date": "2023-10-24T18:42:56Z"
      },
      "author": {
        "name": "Jon Atack",
        "email": "jon@atack.com",
        "date": "2023-10-23T22:21:04Z"
      },
      "sha": "cb82a9285ccb58a1f8fef41c4ce664c5fe46fc94"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKGMyZDMyMjY2NTNjMWZlZTNjMTA1NjI3ZjM4MmMwNzIwYjA0NTlkMjI",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/c2d3226653c1fee3c105627f382c0720b0459d22",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/c2d3226653c1fee3c105627f382c0720b0459d22",
      "tree": {
        "sha": "5d5548d6da6d1943b28491a370632e925145b87a",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/5d5548d6da6d1943b28491a370632e925145b87a"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/cb82a9285ccb58a1f8fef41c4ce664c5fe46fc94",
          "sha": "cb82a9285ccb58a1f8fef41c4ce664c5fe46fc94",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/cb82a9285ccb58a1f8fef41c4ce664c5fe46fc94"
        }
      ],
      "message": "p2p, bugfix: correctly detect already connected peers in ConnectNode()\n\nby upgrading the checks from FindNode() to AlreadyConnectedToAddress().",
      "committer": {
        "name": "Jon Atack",
        "email": "jon@atack.com",
        "date": "2023-10-24T18:43:10Z"
      },
      "author": {
        "name": "Jon Atack",
        "email": "jon@atack.com",
        "date": "2023-08-11T15:44:13Z"
      },
      "sha": "c2d3226653c1fee3c105627f382c0720b0459d22"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDIyNWI2Yzg2OGQxYzI1NjIzOTZlZmNjNDhmOTIwMDRhNDIwNzc3NWQ",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/225b6c868d1c2562396efcc48f92004a4207775d",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/225b6c868d1c2562396efcc48f92004a4207775d",
      "tree": {
        "sha": "962488bff053f2e58cafa5ffd0f8077fc67b6559",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/962488bff053f2e58cafa5ffd0f8077fc67b6559"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/c2d3226653c1fee3c105627f382c0720b0459d22",
          "sha": "c2d3226653c1fee3c105627f382c0720b0459d22",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/c2d3226653c1fee3c105627f382c0720b0459d22"
        }
      ],
      "message": "p2p: do not accept inbound connections from already connected I2P peers\n\nas creating I2P tunnels is expensive.\n\nThese duplicate connection requests come most frequently from inbound peers.\nThe other fixes in this PR may mitigate this behavior by our peers, but not for\nnodes running earlier versions of Bitcoin Core.\n\nExtend a related functional test.",
      "committer": {
        "name": "Jon Atack",
        "email": "jon@atack.com",
        "date": "2023-10-24T18:43:10Z"
      },
      "author": {
        "name": "Jon Atack",
        "email": "jon@atack.com",
        "date": "2023-09-06T00:41:05Z"
      },
      "sha": "225b6c868d1c2562396efcc48f92004a4207775d"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDY5MWUyZWY0OWRlMjc0MmIwOGIzZTYwNjQxMzdlMGYyOWMyZWU5ZDQ",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/691e2ef49de2742b08b3e6064137e0f29c2ee9d4",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/691e2ef49de2742b08b3e6064137e0f29c2ee9d4",
      "tree": {
        "sha": "ab9e53a5ffe8a895bd0e2c25aecd4fd93f1bafbe",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/ab9e53a5ffe8a895bd0e2c25aecd4fd93f1bafbe"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/225b6c868d1c2562396efcc48f92004a4207775d",
          "sha": "225b6c868d1c2562396efcc48f92004a4207775d",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/225b6c868d1c2562396efcc48f92004a4207775d"
        }
      ],
      "message": "refactor: pass AddedNodeParams to CConnman::RemoveAddedNode()\n\ninstead of a std::string (and rename its argument and that of\nCConnman::AddNode() to \"params\").\n\nPassing AddedNodeParams makes the two member functions AddNode and\nRemoveAddedNode consistent, and is needed in order to refactor\n`m_added_node_params` from a vector to an unordered set in the next commit.",
      "committer": {
        "name": "Jon Atack",
        "email": "jon@atack.com",
        "date": "2023-10-24T18:43:10Z"
      },
      "author": {
        "name": "Jon Atack",
        "email": "jon@atack.com",
        "date": "2023-10-10T21:40:01Z"
      },
      "sha": "691e2ef49de2742b08b3e6064137e0f29c2ee9d4"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKGU1ZTc1ZjZiZGY2NzE4YWU2ZmUyYzkyNzAwOTNlMTAzNjIxZDk0ODU",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/e5e75f6bdf6718ae6fe2c9270093e103621d9485",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/e5e75f6bdf6718ae6fe2c9270093e103621d9485",
      "tree": {
        "sha": "240bd3266606dee24ad428638eedbafddef58b7f",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/240bd3266606dee24ad428638eedbafddef58b7f"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/691e2ef49de2742b08b3e6064137e0f29c2ee9d4",
          "sha": "691e2ef49de2742b08b3e6064137e0f29c2ee9d4",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/691e2ef49de2742b08b3e6064137e0f29c2ee9d4"
        }
      ],
      "message": "refactor: change m_added_node_params from vector to unordered_set\n\nwhich simplifies and speeds up the AddNode() and RemoveAddedNode() methods,\nas well as the next commit, \"p2p: do not make automatic outbound connections\nto addnode peers\", which checks if an address is already in m_added_node_params.\n\nThis refactoring is covered by functional tests in rpc_net.py.\n\nCo-authored-by: Vasil Dimov <vd@FreeBSD.org>",
      "committer": {
        "name": "Jon Atack",
        "email": "jon@atack.com",
        "date": "2023-10-24T18:43:10Z"
      },
      "author": {
        "name": "Jon Atack",
        "email": "jon@atack.com",
        "date": "2023-08-15T15:33:24Z"
      },
      "sha": "e5e75f6bdf6718ae6fe2c9270093e103621d9485"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDIxZjg0MjZjODIzZmQ4M2M0MGZkODFmMDhmZjJiZjM5ZWM2YTQ1NzU",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/21f8426c823fd83c40fd81f08ff2bf39ec6a4575",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/21f8426c823fd83c40fd81f08ff2bf39ec6a4575",
      "tree": {
        "sha": "189fb306e4a5178cfa6db695550e23f248f4dd8d",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/189fb306e4a5178cfa6db695550e23f248f4dd8d"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/e5e75f6bdf6718ae6fe2c9270093e103621d9485",
          "sha": "e5e75f6bdf6718ae6fe2c9270093e103621d9485",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/e5e75f6bdf6718ae6fe2c9270093e103621d9485"
        }
      ],
      "message": "p2p, bugfix: do not make automatic outbound connections to addnode peers\n\nto allocate our limited outbound slots correctly, and to ensure addnode\nconnections benefit from their intended protections.\n\nOur addnode logic usually connects the addnode peers before the automatic\noutbound logic does, but not always, as a connection race can occur.\n\nFor instance, our internet connection or router (or the addnode peer) could be\ntemporarily offline, and then return online during the automatic outbound\nthread.  Or we could add a new manual peer using the `addnode` RPC at that time.\nThe race can be more apparent when our node doesn't know many peers, or with\nnetworks like cjdns that currently have few bitcoin peers.\n\nExamples on mainnet using logging added in the same pull request:\n\n2023-08-12T14:51:05.681743Z [opencon] [net.cpp:1949] [ThreadOpenConnections]\n[net:debug] Not making automatic network-specific outbound-full-relay connection\nto i2p peer selected for manual (addnode) connection: [geh...odq.b32.i2p]:0\n\n2023-08-13T03:59:28.050853Z [opencon] [net.cpp:1949] [ThreadOpenConnections]\n[net:debug] Not making automatic block-relay-only connection to onion peer\nselected for manual (addnode) connection: kpg...aid.onion:8333\n\n2023-08-13T16:21:26.979052Z [opencon] [net.cpp:1949] [ThreadOpenConnections]\n[net:debug] Not making automatic network-specific outbound-full-relay connection\nto cjdns peer selected for manual (addnode) connection: [fcc...8ce]:8333\n\n2023-08-14T20:43:53.401271Z [opencon] [net.cpp:1949] [ThreadOpenConnections]\n[net:debug] Not making automatic network-specific outbound-full-relay connection\nto cjdns peer selected for manual (addnode) connection: [fc7...59e]:8333\n\n2023-08-15T00:10:01.894147Z [opencon] [net.cpp:1949] [ThreadOpenConnections]\n[net:debug] Not making automatic feeler connection to i2p peer selected for\nmanual (addnode) connection: geh...odq.b32.i2p:8333\n\nWhen an addnode peer is connected as an automatic outbound peer and is the only\nconnection we have to a network, it can be protected by our new outbound\neviction logic and persist in the \"wrong role\".\n\nFinally, there does not seem to be a reason to make block-relay or short-lived\nfeeler connections to addnode peers, as the addnode logic will ensure we connect\nto them if they are up, within the addnode connection limit.\n\nFix these issues by checking if the address is an addnode peer in our automatic\noutbound connection logic.\n\nCo-authored-by: Vasil Dimov <vd@FreeBSD.org>",
      "committer": {
        "name": "Jon Atack",
        "email": "jon@atack.com",
        "date": "2023-10-24T18:43:10Z"
      },
      "author": {
        "name": "Jon Atack",
        "email": "jon@atack.com",
        "date": "2023-08-11T20:45:45Z"
      },
      "sha": "21f8426c823fd83c40fd81f08ff2bf39ec6a4575"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKGI4YjFkNTk5MmE2NTljODNlYTQ5OWVkNWVhYWQ1YTc0N2ZiZDhmYWY",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/b8b1d5992a659c83ea499ed5eaad5a747fbd8faf",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/b8b1d5992a659c83ea499ed5eaad5a747fbd8faf",
      "tree": {
        "sha": "80defd014e87b620f20d5ac6b5a6dcdcd53c7dcc",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/80defd014e87b620f20d5ac6b5a6dcdcd53c7dcc"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/21f8426c823fd83c40fd81f08ff2bf39ec6a4575",
          "sha": "21f8426c823fd83c40fd81f08ff2bf39ec6a4575",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/21f8426c823fd83c40fd81f08ff2bf39ec6a4575"
        }
      ],
      "message": "p2p: improve ConnectNode log, rm redundant ThreadOpenConnections log\n\nBy moving the \"Trying connection\" log entry in ConnectNode to after the address\nresolution, we can:\n\n- not needlessly log the attempt until after checking if we are already connected to it\n\n- know the network the peer connected through, i.e. for cjdns peers\n\n- add useful peer info to the log entry for debugging purposes\n\nThis change makes the feeler log entry in CConnman::ThreadOpenConnections()\nredundant...\n\n2023-09-06T01:11:42.614464Z Making feeler connection to dft...dyd.onion:8333\n2023-09-06T01:11:42.614722Z Trying feeler connection to net=onion, peeraddr=dft...dyd.onion:8333, lastseen=4.2hrs\n\n...so remove it.",
      "committer": {
        "name": "Jon Atack",
        "email": "jon@atack.com",
        "date": "2023-10-24T18:43:10Z"
      },
      "author": {
        "name": "Jon Atack",
        "email": "jon@atack.com",
        "date": "2023-09-05T23:49:42Z"
      },
      "sha": "b8b1d5992a659c83ea499ed5eaad5a747fbd8faf"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDA5MDMwYzZjYTI3ZGFkMjM0YzZjYTNmNWVmZjY2YzAzYzNjNDE4OWU",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/09030c6ca27dad234c6ca3f5eff66c03c3c4189e",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/09030c6ca27dad234c6ca3f5eff66c03c3c4189e",
      "tree": {
        "sha": "4e5b2c6bacd212905514d7c6d47fa31f018ca02c",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/4e5b2c6bacd212905514d7c6d47fa31f018ca02c"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/b8b1d5992a659c83ea499ed5eaad5a747fbd8faf",
          "sha": "b8b1d5992a659c83ea499ed5eaad5a747fbd8faf",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/b8b1d5992a659c83ea499ed5eaad5a747fbd8faf"
        }
      ],
      "message": "p2p: log when protecting last remaining network peer from eviction\n\nThis logging has been helpful for observing and debugging our peer connection\nand eviction behavior.\n\nAlso improve related log entries for\n- eviction of an inbound peer\n- protecting a peer from eviction for a bad or slow chain",
      "committer": {
        "name": "Jon Atack",
        "email": "jon@atack.com",
        "date": "2023-10-24T18:43:10Z"
      },
      "author": {
        "name": "Jon Atack",
        "email": "jon@atack.com",
        "date": "2023-08-09T16:55:05Z"
      },
      "sha": "09030c6ca27dad234c6ca3f5eff66c03c3c4189e"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDkzMWRmNWFlMTUzMzU3NmIyODk1YjJmYWI5YjhhODU2ODMzOWFjN2I",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/931df5ae1533576b2895b2fab9b8a8568339ac7b",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/931df5ae1533576b2895b2fab9b8a8568339ac7b",
      "tree": {
        "sha": "0a5cf058125ab4bec670ed4dbd67ed8a31691130",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/0a5cf058125ab4bec670ed4dbd67ed8a31691130"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/09030c6ca27dad234c6ca3f5eff66c03c3c4189e",
          "sha": "09030c6ca27dad234c6ca3f5eff66c03c3c4189e",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/09030c6ca27dad234c6ca3f5eff66c03c3c4189e"
        }
      ],
      "message": "p2p: improve inbound/outbound/anchor/network-specific log messages",
      "committer": {
        "name": "Jon Atack",
        "email": "jon@atack.com",
        "date": "2023-10-24T18:43:10Z"
      },
      "author": {
        "name": "Jon Atack",
        "email": "jon@atack.com",
        "date": "2023-08-11T15:52:47Z"
      },
      "sha": "931df5ae1533576b2895b2fab9b8a8568339ac7b"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDQyMzhiNmYwYTc1NTNlYmM1Y2VlNmY3Yzc3ZDM4MTMxOTNmN2EzMjI",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/4238b6f0a7553ebc5cee6f7c77d3813193f7a322",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/4238b6f0a7553ebc5cee6f7c77d3813193f7a322",
      "tree": {
        "sha": "a5dac8ba15b1cf11571c8c3a6a4db35242bbefda",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/a5dac8ba15b1cf11571c8c3a6a4db35242bbefda"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/931df5ae1533576b2895b2fab9b8a8568339ac7b",
          "sha": "931df5ae1533576b2895b2fab9b8a8568339ac7b",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/931df5ae1533576b2895b2fab9b8a8568339ac7b"
        }
      ],
      "message": "refactor: simplify MaybePickPreferredNetwork, drop out-param, return optional\n\nand make it a const class method, and add Clang thread-safety analysis annotation and\nrelated assertions.",
      "committer": {
        "name": "Jon Atack",
        "email": "jon@atack.com",
        "date": "2023-10-24T18:43:10Z"
      },
      "author": {
        "name": "Jon Atack",
        "email": "jon@atack.com",
        "date": "2023-08-07T20:23:50Z"
      },
      "sha": "4238b6f0a7553ebc5cee6f7c77d3813193f7a322"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 10758121963,
      "node_id": "HRFPE_lADOABII585t6QbyzwAAAAKBO-nr",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10758121963",
      "actor": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": "4238b6f0a7553ebc5cee6f7c77d3813193f7a322",
      "commit_url": "https://api.github.com/repos/jonatack/bitcoin/commits/4238b6f0a7553ebc5cee6f7c77d3813193f7a322",
      "created_at": "2023-10-24T18:55:34Z"
    },
    {
      "event": "reviewed",
      "id": 1695774761,
      "node_id": "PRR_kwDOABII585lE3gp",
      "url": null,
      "actor": null,
      "commit_id": "4238b6f0a7553ebc5cee6f7c77d3813193f7a322",
      "commit_url": null,
      "created_at": null,
      "author_association": "CONTRIBUTOR",
      "body": "",
      "user": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28248#pullrequestreview-1695774761",
      "submitted_at": "2023-10-24T20:53:02Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28248"
    },
    {
      "event": "commented",
      "id": 1789583586,
      "node_id": "IC_kwDOABII585qquDi",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1789583586",
      "actor": {
        "login": "maflcko",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/maflcko",
        "html_url": "https://github.com/maflcko",
        "followers_url": "https://api.github.com/users/maflcko/followers",
        "following_url": "https://api.github.com/users/maflcko/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/maflcko/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/maflcko/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/maflcko/subscriptions",
        "organizations_url": "https://api.github.com/users/maflcko/orgs",
        "repos_url": "https://api.github.com/users/maflcko/repos",
        "events_url": "https://api.github.com/users/maflcko/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/maflcko/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-11-01T19:56:31Z",
      "updated_at": "2023-11-01T19:56:31Z",
      "author_association": "MEMBER",
      "body": "Maybe mark as draft while CI is red?",
      "user": {
        "login": "maflcko",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/maflcko",
        "html_url": "https://github.com/maflcko",
        "followers_url": "https://api.github.com/users/maflcko/followers",
        "following_url": "https://api.github.com/users/maflcko/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/maflcko/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/maflcko/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/maflcko/subscriptions",
        "organizations_url": "https://api.github.com/users/maflcko/orgs",
        "repos_url": "https://api.github.com/users/maflcko/repos",
        "events_url": "https://api.github.com/users/maflcko/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/maflcko/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28248#issuecomment-1789583586",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/28248"
    },
    {
      "event": "commented",
      "id": 1789598397,
      "node_id": "IC_kwDOABII585qqxq9",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1789598397",
      "actor": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-11-01T20:07:31Z",
      "updated_at": "2023-11-01T20:07:31Z",
      "author_association": "MEMBER",
      "body": "Done. Note that only the latest push is red. I can push a version that is green, but have been rebasing on #28155 that I reckon will be merged soon, and adding missing test coverage. Concept ACKs on fixing the bugs would be encouraging 😃 ",
      "user": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28248#issuecomment-1789598397",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/28248"
    },
    {
      "event": "convert_to_draft",
      "id": 10836519468,
      "node_id": "CTDE_lADOABII585t6QbyzwAAAAKF6Cos",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10836519468",
      "actor": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-11-01T20:07:39Z"
    },
    {
      "event": "commented",
      "id": 1789612236,
      "node_id": "IC_kwDOABII585qq1DM",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1789612236",
      "actor": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-11-01T20:15:25Z",
      "updated_at": "2023-11-01T20:15:25Z",
      "author_association": "MEMBER",
      "body": "Note also, that item 7 in the PR description involves a regression in v26.x.",
      "user": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28248#issuecomment-1789612236",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/28248"
    },
    {
      "event": "commented",
      "id": 1789659513,
      "node_id": "IC_kwDOABII585qrAl5",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1789659513",
      "actor": {
        "login": "fanquake",
        "id": 863730,
        "node_id": "MDQ6VXNlcjg2MzczMA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/863730?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fanquake",
        "html_url": "https://github.com/fanquake",
        "followers_url": "https://api.github.com/users/fanquake/followers",
        "following_url": "https://api.github.com/users/fanquake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fanquake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fanquake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fanquake/subscriptions",
        "organizations_url": "https://api.github.com/users/fanquake/orgs",
        "repos_url": "https://api.github.com/users/fanquake/repos",
        "events_url": "https://api.github.com/users/fanquake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fanquake/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-11-01T20:48:37Z",
      "updated_at": "2023-11-01T20:48:37Z",
      "author_association": "MEMBER",
      "body": "> Note also, that item 7 in the PR description involves a regression in v26.x.\n\nWhat is the regression? Which change caused it?",
      "user": {
        "login": "fanquake",
        "id": 863730,
        "node_id": "MDQ6VXNlcjg2MzczMA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/863730?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fanquake",
        "html_url": "https://github.com/fanquake",
        "followers_url": "https://api.github.com/users/fanquake/followers",
        "following_url": "https://api.github.com/users/fanquake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fanquake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fanquake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fanquake/subscriptions",
        "organizations_url": "https://api.github.com/users/fanquake/orgs",
        "repos_url": "https://api.github.com/users/fanquake/repos",
        "events_url": "https://api.github.com/users/fanquake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fanquake/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28248#issuecomment-1789659513",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/28248"
    },
    {
      "event": "commented",
      "id": 1789702441,
      "node_id": "IC_kwDOABII585qrLEp",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1789702441",
      "actor": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-11-01T21:18:38Z",
      "updated_at": "2023-11-01T21:18:54Z",
      "author_association": "CONTRIBUTOR",
      "body": "> Concept ACKs on fixing the bugs would be encouraging 😃\r\n\r\nI think that some of the commits are straightforward (e.g. the missing `MaybeFlipIPv6toCJDNS` calls or the logging improvements), whereas others are fixing some non-ideal behavior in some cases, but have the risk of introducing new non-ideal behavior in other cases because the fix comes with downsides of its own.\r\n\r\nFor example, if it isn't possible to distinguish situations in which two connections involving the same IP are controlled by the same entity or different entities, any solution would be imperfect, either allowing duplicate connections or preventing legitimate behavior (that is possibly widely used in local setups). So it's unclear to me if the status quo on these is actually a bug or an intended best-effort solution / the result of a compromise.\r\n\r\nMaybe some of the straightforward bugfixes could be split out into another PR?",
      "user": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28248#issuecomment-1789702441",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/28248"
    },
    {
      "event": "commented",
      "id": 1789704725,
      "node_id": "IC_kwDOABII585qrLoV",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1789704725",
      "actor": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-11-01T21:20:02Z",
      "updated_at": "2023-11-01T21:20:02Z",
      "author_association": "MEMBER",
      "body": "Reported in https://github.com/bitcoin/bitcoin/pull/27213/files#r1291926369 and described in https://github.com/bitcoin/bitcoin/pull/28248/commits/21f8426c823fd83c40fd81f08ff2bf39ec6a4575, there is an interaction between the new network-specific automatic outbound logic and the addnode list: the former doesn't account for the latter.\r\n \r\n```markdown\r\nNotable changes\r\n===============\r\n\r\nP2P and network changes\r\n-----------------------\r\n\r\n- Nodes with multiple reachable networks will actively try to have at least one\r\n  outbound connection to each network. This improves individual resistance to\r\n  eclipse attacks and network level resistance to partition attacks. Users no\r\n  longer need to perform active measures to ensure being connected to multiple\r\n  enabled networks. (#27213)\r\n```\r\n\r\nNode operators running over multiple networks may be likely to use -addnode to ensure connection to each of them (I do). They would be the ones most likely to be affected by the change with their addnode peers being allotted to rare outbound slots instead.  It makes sense to exclude addnode peers from the automatic outbound logic, either in general or for the new network-specific one.",
      "user": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28248#issuecomment-1789704725",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/28248"
    },
    {
      "event": "commented",
      "id": 1789710867,
      "node_id": "IC_kwDOABII585qrNIT",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1789710867",
      "actor": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-11-01T21:25:26Z",
      "updated_at": "2023-11-01T21:25:26Z",
      "author_association": "MEMBER",
      "body": "> Maybe some of the straightforward bugfixes could be split out into another PR?\r\n\r\nYes -- looking at doing that, or dropping here for now any that aren't relatively clear.",
      "user": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28248#issuecomment-1789710867",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/28248"
    },
    {
      "event": "reviewed",
      "id": 1714022287,
      "node_id": "PRR_kwDOABII585mKeeP",
      "url": null,
      "actor": null,
      "commit_id": "4238b6f0a7553ebc5cee6f7c77d3813193f7a322",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "body": "",
      "user": {
        "login": "dergoegge",
        "id": 8077169,
        "node_id": "MDQ6VXNlcjgwNzcxNjk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8077169?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dergoegge",
        "html_url": "https://github.com/dergoegge",
        "followers_url": "https://api.github.com/users/dergoegge/followers",
        "following_url": "https://api.github.com/users/dergoegge/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dergoegge/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dergoegge/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dergoegge/subscriptions",
        "organizations_url": "https://api.github.com/users/dergoegge/orgs",
        "repos_url": "https://api.github.com/users/dergoegge/repos",
        "events_url": "https://api.github.com/users/dergoegge/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dergoegge/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28248#pullrequestreview-1714022287",
      "submitted_at": "2023-11-05T17:21:02Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28248"
    },
    {
      "event": "labeled",
      "id": 10900785423,
      "node_id": "LE_lADOABII585t6QbyzwAAAAKJvMkP",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10900785423",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-11-08T13:21:47Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "commented",
      "id": 1801881588,
      "node_id": "IC_kwDOABII585rZof0",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1801881588",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-11-08T13:21:48Z",
      "updated_at": "2023-11-08T13:21:48Z",
      "author_association": "CONTRIBUTOR",
      "body": "<!--cf906140f33d8803c4a75a2196329ecb-->\n🐙 This pull request conflicts with the target branch and [needs rebase](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#rebasing-changes).\n",
      "user": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28248#issuecomment-1801881588",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/28248"
    },
    {
      "event": "commented",
      "id": 1812702510,
      "node_id": "IC_kwDOABII585sC6Uu",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1812702510",
      "actor": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-11-15T15:02:52Z",
      "updated_at": "2023-11-15T15:06:05Z",
      "author_association": "CONTRIBUTOR",
      "body": "> Note also, that item 7 in the PR description involves a regression in v26.x.\r\n\r\nI don't think that this can be called a regression:\r\n* There is nothing new about the root problem (making automatic connections to addnode peers in rare cases) in v26.\r\n* It can happen that such a peer could now be protected as the only one of its network, but to determine if it's a regression this needs to be compared with the status before.\r\n* Before we did protection-by-network, we would only ever get into the situation with an extra-outbound peer if we had a stale tip (30 minutes). Unless we are eclipsed or something weird is going on, this happens naturally a few times per day on average.\r\n* If we are in that situation, it is not very probable that we'd evict the outbound peer that we'd rather have as an addnode peer. First of all, we'd usually just evict the new extra-peer (unless it provides a new block, which should happen very rarely, especially when we have other high-bandwidth OB peers at the same time). But even in the rare cases, we often would not evict the specific peer to solve the addnode problem, that peer might be one of the 4 protected peers, or we might just pick another one.\r\n\r\nI'd guess you could probably have waited for months to actually evict a mis-placed peer that way. So I'd say that the stale-tip eviction was never a functioning mechanism to resolve these kind of addnode problems (and never meant to be), and as a result, #27213 was not a regression - in practice, it might arguably be even an improvement instead of a regression, because in those cases where the peer in question is _not_ the only one from its network, we'll get into the situation where we have an extra peer to evict more frequently than before.",
      "user": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28248#issuecomment-1812702510",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/28248"
    },
    {
      "event": "commented",
      "id": 1812724875,
      "node_id": "IC_kwDOABII585sC_yL",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1812724875",
      "actor": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-11-15T15:15:17Z",
      "updated_at": "2023-11-15T15:15:17Z",
      "author_association": "MEMBER",
      "body": "@mzumsande The improved logging allows distinguishing when this is due to the new protection logic, and with occasional exceptions, it is.",
      "user": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28248#issuecomment-1812724875",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/28248"
    },
    {
      "event": "mentioned",
      "id": 10968719071,
      "node_id": "MEE_lADOABII585t6QbyzwAAAAKNyV7f",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10968719071",
      "actor": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-11-15T15:15:17Z"
    },
    {
      "event": "subscribed",
      "id": 10968719086,
      "node_id": "SE_lADOABII585t6QbyzwAAAAKNyV7u",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10968719086",
      "actor": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-11-15T15:15:18Z"
    },
    {
      "event": "commented",
      "id": 1812752979,
      "node_id": "IC_kwDOABII585sDGpT",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1812752979",
      "actor": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-11-15T15:31:00Z",
      "updated_at": "2023-11-15T15:31:00Z",
      "author_association": "CONTRIBUTOR",
      "body": "> @mzumsande The improved logging allows distinguishing when this is due to the new protection logic, and with occasional exceptions, it is.\r\n\r\nThat's not my point. My point (see above) is that in earlier versions, the extra-outbound eviction (which would only happen in the stale-tip case then) was not a working or reliable mechanism to evict these peers, so there is no regression. Or did I miss something in my above explanation / do you have logs that pre-26 the stale-tip outbound eviction could somehow resolve this problem reliably?",
      "user": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28248#issuecomment-1812752979",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/28248"
    },
    {
      "event": "mentioned",
      "id": 10968911650,
      "node_id": "MEE_lADOABII585t6QbyzwAAAAKNzE8i",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10968911650",
      "actor": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-11-15T15:31:00Z"
    },
    {
      "event": "subscribed",
      "id": 10968911683,
      "node_id": "SE_lADOABII585t6QbyzwAAAAKNzE9D",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10968911683",
      "actor": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-11-15T15:31:00Z"
    },
    {
      "event": "commented",
      "id": 1812773694,
      "node_id": "IC_kwDOABII585sDLs-",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1812773694",
      "actor": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-11-15T15:42:06Z",
      "updated_at": "2023-11-15T15:42:06Z",
      "author_association": "MEMBER",
      "body": "Empirically, the regression is that we're actively adding addnode peers as outbound ones, and keeping them there.  Since a couple of years I run a node with all three of our privacy networks and addnode entries for each, along with clearnet, and I didn't see my addnode peers being connected to as non-manual outbounds.  This is new behavior for my node.\r\n\r\nAside, I'm adding unit tests for each change right now, and these are finding additional issues.",
      "user": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28248#issuecomment-1812773694",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/28248"
    },
    {
      "event": "commented",
      "id": 1812859356,
      "node_id": "IC_kwDOABII585sDgnc",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1812859356",
      "actor": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-11-15T16:26:13Z",
      "updated_at": "2023-11-15T16:28:53Z",
      "author_association": "CONTRIBUTOR",
      "body": "> Empirically, the regression is that we're actively adding addnode peers as outbound ones, and keeping them there. \r\n\r\nOh, I thought you were talking about a race at startup - since the extra outbound should only kick in after 5 minutes, I think that should be enough to make connections to the addnode peers.\r\n\r\nI think what might be happening later is that an addnode peer disconnects us, and if it was the only one from its network then there could be a race between picking another network-related outbound peer (which could be the peer that just disconnected us if addrman would select it) and reconnecting to the peer that evicted us with addnode thread. Could that be what you are seeing?",
      "user": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28248#issuecomment-1812859356",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/28248"
    },
    {
      "event": "commented",
      "id": 1812965773,
      "node_id": "IC_kwDOABII585sD6mN",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1812965773",
      "actor": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-11-15T17:30:11Z",
      "updated_at": "2023-11-15T17:30:11Z",
      "author_association": "MEMBER",
      "body": "@mzumsande I think so, yes, along with the other races mentioned in the commit message https://github.com/bitcoin/bitcoin/pull/28248/commits/21f8426c823fd83c40fd81f08ff2bf39ec6a4575. I'll add the case you describe to it (thanks!)",
      "user": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28248#issuecomment-1812965773",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/28248"
    },
    {
      "event": "mentioned",
      "id": 10970271221,
      "node_id": "MEE_lADOABII585t6QbyzwAAAAKN4Q31",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10970271221",
      "actor": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-11-15T17:30:11Z"
    },
    {
      "event": "subscribed",
      "id": 10970271240,
      "node_id": "SE_lADOABII585t6QbyzwAAAAKN4Q4I",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/10970271240",
      "actor": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-11-15T17:30:12Z"
    },
    {
      "event": "commented",
      "id": 1812970597,
      "node_id": "IC_kwDOABII585sD7xl",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1812970597",
      "actor": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-11-15T17:33:41Z",
      "updated_at": "2023-11-15T17:40:20Z",
      "author_association": "MEMBER",
      "body": "I'd be interested to hear anyone's thoughts on this, from that commit message:\r\n\r\n*Finally, there does not seem to be a reason to make block-relay or short-lived feeler connections to addnode peers, as the addnode logic will ensure we connect to them if they are up, within the addnode connection limit.*\r\n\r\nThis may not be optimal if one were to add many addnode entries, i.e. more than 8 that are online. I don't know if people do that. Maybe it would be prudent to allow feelers to addnodes.",
      "user": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28248#issuecomment-1812970597",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/28248"
    },
    {
      "event": "commented",
      "id": 1813126001,
      "node_id": "IC_kwDOABII585sEhtx",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1813126001",
      "actor": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-11-15T19:25:20Z",
      "updated_at": "2023-11-15T19:25:20Z",
      "author_association": "CONTRIBUTOR",
      "body": "> Maybe it would be prudent to allow feelers to addnodes.\r\n\r\nI think it's fine to skip feelers for addnode peers. When we would skip these addresses for automatic connection, I don't see what making a feeler connection to them would achieve, considering that the point of feelers is to have better options for future automatic connections.",
      "user": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28248#issuecomment-1813126001",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/28248"
    },
    {
      "event": "commented",
      "id": 1940038811,
      "node_id": "IC_kwDOABII585zoqSb",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1940038811",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-02-13T01:16:38Z",
      "updated_at": "2024-02-13T01:16:38Z",
      "author_association": "CONTRIBUTOR",
      "body": "<!--13523179cfe9479db18ec6c5d236f789-->\n⌛ There hasn't been much activity lately and the patch still needs rebase. What is the status here?\n\n* Is it still relevant? ➡️ Please solve the conflicts to make it ready for review and to ensure the CI passes.\n* Is it no longer relevant? ➡️ Please close.\n* Did the author lose interest or time to work on this? ➡️ Please close it and mark it 'Up for grabs' with the label, so that it can be picked up in the future.\n",
      "user": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28248#issuecomment-1940038811",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/28248"
    },
    {
      "event": "commented",
      "id": 2043167695,
      "node_id": "IC_kwDOABII5855yEPP",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2043167695",
      "actor": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-04-08T16:19:52Z",
      "updated_at": "2024-04-08T16:19:52Z",
      "author_association": "MEMBER",
      "body": "Will continue work on these bugfixes. Closing to be able to re-open it.",
      "user": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28248#issuecomment-2043167695",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/28248"
    },
    {
      "event": "closed",
      "id": 12395606233,
      "node_id": "CE_lADOABII585t6QbyzwAAAALi1fDZ",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/12395606233",
      "actor": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-04-08T16:19:54Z"
    },
    {
      "event": "referenced",
      "id": 12826367458,
      "node_id": "REFE_lADOABII585t6QbyzwAAAAL8gtXi",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/12826367458",
      "actor": {
        "login": "fanquake",
        "id": 863730,
        "node_id": "MDQ6VXNlcjg2MzczMA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/863730?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fanquake",
        "html_url": "https://github.com/fanquake",
        "followers_url": "https://api.github.com/users/fanquake/followers",
        "following_url": "https://api.github.com/users/fanquake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fanquake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fanquake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fanquake/subscriptions",
        "organizations_url": "https://api.github.com/users/fanquake/orgs",
        "repos_url": "https://api.github.com/users/fanquake/repos",
        "events_url": "https://api.github.com/users/fanquake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fanquake/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": "dd42a5ddea6a72e1e9cad54f8352c76b0b701973",
      "commit_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/dd42a5ddea6a72e1e9cad54f8352c76b0b701973",
      "created_at": "2024-05-16T03:18:34Z"
    },
    {
      "event": "comment_deleted",
      "id": 12826855780,
      "node_id": "CDE_lADOABII585t6QbyzwAAAAL8iklk",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/12826855780",
      "actor": {
        "login": "bitcoin",
        "id": 528860,
        "node_id": "MDEyOk9yZ2FuaXphdGlvbjUyODg2MA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/528860?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/bitcoin",
        "html_url": "https://github.com/bitcoin",
        "followers_url": "https://api.github.com/users/bitcoin/followers",
        "following_url": "https://api.github.com/users/bitcoin/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/bitcoin/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/bitcoin/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/bitcoin/subscriptions",
        "organizations_url": "https://api.github.com/users/bitcoin/orgs",
        "repos_url": "https://api.github.com/users/bitcoin/repos",
        "events_url": "https://api.github.com/users/bitcoin/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/bitcoin/received_events",
        "type": "Organization",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-05-16T04:36:38Z"
    },
    {
      "event": "locked",
      "id": 17683190063,
      "node_id": "LOE_lADOABII585t6QbyzwAAAAQeABEv",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/17683190063",
      "actor": {
        "login": "bitcoin",
        "id": 528860,
        "node_id": "MDEyOk9yZ2FuaXphdGlvbjUyODg2MA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/528860?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/bitcoin",
        "html_url": "https://github.com/bitcoin",
        "followers_url": "https://api.github.com/users/bitcoin/followers",
        "following_url": "https://api.github.com/users/bitcoin/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/bitcoin/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/bitcoin/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/bitcoin/subscriptions",
        "organizations_url": "https://api.github.com/users/bitcoin/orgs",
        "repos_url": "https://api.github.com/users/bitcoin/repos",
        "events_url": "https://api.github.com/users/bitcoin/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/bitcoin/received_events",
        "type": "Organization",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-05-16T06:07:54Z"
    }
  ],
  "comments": [
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1293481061",
      "pull_request_review_id": 1576881142,
      "id": 1293481061,
      "node_id": "PRRC_kwDOABII585NGPRl",
      "diff_hunk": "@@ -1928,6 +1921,25 @@ void CConnman::ThreadOpenConnections(const std::vector<std::string> connect)\n                 continue;\n             }\n \n+            // Do not make automatic outbound connections to addnode peers, to\n+            // avoid using our limited outbound slots for them and to ensure\n+            // addnode connections benefit from their intended protections.\n+            {\n+                const auto str_addr{addr.ToStringAddr()};\n+                const auto str_addr_port{addr.ToStringAddrPort()};\n+\n+                LOCK(m_added_nodes_mutex);\n+                if (m_added_nodes.size() < 16 // bound the query to a reasonable limit\n+                    && std::any_of(m_added_nodes.cbegin(), m_added_nodes.cend(), [&](const auto& a) { return a == str_addr || a == str_addr_port; })) {",
      "path": "src/net.cpp",
      "position": null,
      "original_position": 121,
      "commit_id": "4238b6f0a7553ebc5cee6f7c77d3813193f7a322",
      "original_commit_id": "4b9774dd49359cc0a807f1dc57b96d182330a4a1",
      "in_reply_to_id": null,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "Good catch with this deficiency!\r\n\r\nIf `m_added_nodes` is changed to `std::unordered_set`, then this can be a simple `m_added_nodes.count() > 0` and `CConnman::AddNode()` and `CConnman::RemoveAddedNode()` could be simplified (and made faster since they are now `O(number of added nodes)` and will become `O(1)`, I guess performance is irrelevant in practice because of the small number of elements).\r\n\r\nMaybe this is worth a separate PR since it is distinct from other commits (one commit to change it to `std::unordered_set` and one to add this check).",
      "created_at": "2023-08-14T13:46:05Z",
      "updated_at": "2023-08-14T13:58:38Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28248#discussion_r1293481061",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1293481061"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28248"
        }
      },
      "start_line": null,
      "original_start_line": 1924,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 1933,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1294891951",
      "pull_request_review_id": 1579039581,
      "id": 1294891951,
      "node_id": "PRRC_kwDOABII585NLnuv",
      "diff_hunk": "@@ -1928,6 +1921,25 @@ void CConnman::ThreadOpenConnections(const std::vector<std::string> connect)\n                 continue;\n             }\n \n+            // Do not make automatic outbound connections to addnode peers, to\n+            // avoid using our limited outbound slots for them and to ensure\n+            // addnode connections benefit from their intended protections.\n+            {\n+                const auto str_addr{addr.ToStringAddr()};\n+                const auto str_addr_port{addr.ToStringAddrPort()};\n+\n+                LOCK(m_added_nodes_mutex);\n+                if (m_added_nodes.size() < 16 // bound the query to a reasonable limit\n+                    && std::any_of(m_added_nodes.cbegin(), m_added_nodes.cend(), [&](const auto& a) { return a == str_addr || a == str_addr_port; })) {",
      "path": "src/net.cpp",
      "position": null,
      "original_position": 121,
      "commit_id": "4238b6f0a7553ebc5cee6f7c77d3813193f7a322",
      "original_commit_id": "4b9774dd49359cc0a807f1dc57b96d182330a4a1",
      "in_reply_to_id": 1293481061,
      "user": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "Good idea, simpler and faster. Done (thanks!)",
      "created_at": "2023-08-15T17:13:01Z",
      "updated_at": "2023-08-15T17:13:02Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28248#discussion_r1294891951",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1294891951"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28248"
        }
      },
      "start_line": null,
      "original_start_line": 1924,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 1933,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1296069949",
      "pull_request_review_id": 1580868907,
      "id": 1296069949,
      "node_id": "PRRC_kwDOABII585NQHU9",
      "diff_hunk": "@@ -408,7 +397,8 @@ CNode* CConnman::FindNode(const CService& addr)\n \n bool CConnman::AlreadyConnectedToAddress(const CAddress& addr)\n {\n-    return FindNode(static_cast<CNetAddr>(addr)) || FindNode(addr.ToStringAddrPort());\n+    const CService service{MaybeFlipIPv6toCJDNS(addr)};\n+    return FindNode(service) || FindNode(service.ToStringAddrPort());",
      "path": "src/net.cpp",
      "position": null,
      "original_position": 33,
      "commit_id": "4238b6f0a7553ebc5cee6f7c77d3813193f7a322",
      "original_commit_id": "a411cb5a170098c99e7c64f508153613f5e377da",
      "in_reply_to_id": null,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "Before this it would compare just the address and after this change it would compare the address and the port. I think that is undesirable because for inbound connections we see the peer as e.g. `1.2.3.4:somerandomport` and when we try to connect to `1.2.3.4:8333` we should assume we are already connected to that peer.",
      "created_at": "2023-08-16T15:15:07Z",
      "updated_at": "2023-08-16T15:58:54Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28248#discussion_r1296069949",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1296069949"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28248"
        }
      },
      "start_line": null,
      "original_start_line": 398,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 401,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1296074743",
      "pull_request_review_id": 1580868907,
      "id": 1296074743,
      "node_id": "PRRC_kwDOABII585NQIf3",
      "diff_hunk": "@@ -1995,7 +2004,7 @@ std::vector<AddedNodeInfo> CConnman::GetAddedNodeInfo() const\n     }\n \n     for (const std::string& strAddNode : lAddresses) {\n-        CService service(LookupNumeric(strAddNode, Params().GetDefaultPort(strAddNode)));\n+        CService service{MaybeFlipIPv6toCJDNS(LookupNumeric(strAddNode, Params().GetDefaultPort(strAddNode)))};",
      "path": "src/net.cpp",
      "position": null,
      "original_position": 158,
      "commit_id": "4238b6f0a7553ebc5cee6f7c77d3813193f7a322",
      "original_commit_id": "a411cb5a170098c99e7c64f508153613f5e377da",
      "in_reply_to_id": null,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "The existent code in `master` seems to be comparing the ports. Is there another bug that an inbound connection from `1.2.3.4` would not be considered as \"we are connected to `1.2.3.4:8333`\"?",
      "created_at": "2023-08-16T15:18:50Z",
      "updated_at": "2023-08-16T15:58:54Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28248#discussion_r1296074743",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1296074743"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28248"
        }
      },
      "start_line": null,
      "original_start_line": 1998,
      "start_side": "LEFT",
      "line": null,
      "original_line": 2794,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1296106505",
      "pull_request_review_id": 1580868907,
      "id": 1296106505,
      "node_id": "PRRC_kwDOABII585NQQQJ",
      "diff_hunk": "@@ -2621,24 +2630,15 @@ std::vector<CAddress> CConnman::GetAddresses(CNode& requestor, size_t max_addres\n bool CConnman::AddNode(const std::string& strNode)\n {\n     LOCK(m_added_nodes_mutex);\n-    for (const std::string& it : m_added_nodes) {\n-        if (strNode == it) return false;\n-    }\n-\n-    m_added_nodes.push_back(strNode);\n+    if (m_added_nodes.count(strNode)) return false;\n+    m_added_nodes.insert(strNode);\n     return true;",
      "path": "src/net.cpp",
      "position": null,
      "original_position": 173,
      "commit_id": "4238b6f0a7553ebc5cee6f7c77d3813193f7a322",
      "original_commit_id": "a411cb5a170098c99e7c64f508153613f5e377da",
      "in_reply_to_id": null,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "Or this:\r\n\r\n```cpp\r\nreturn m_added_nodes.insert(strNode).second;\r\n```",
      "created_at": "2023-08-16T15:43:05Z",
      "updated_at": "2023-08-16T15:58:54Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28248#discussion_r1296106505",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1296106505"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28248"
        }
      },
      "start_line": null,
      "original_start_line": 2633,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 2635,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1296121513",
      "pull_request_review_id": 1580868907,
      "id": 1296121513,
      "node_id": "PRRC_kwDOABII585NQT6p",
      "diff_hunk": "@@ -437,6 +427,14 @@ static CAddress GetBindAddress(const Sock& sock)\n     return addr_bind;\n }\n \n+static void LogAlreadyConnected(CNode* pnode, ConnectionType conn_type)\n+{\n+    LogPrintfCategory(BCLog::NET, \"Failed to open new %s connection, already connected to peer=%d, net=%s%s (%s)\\n\",",
      "path": "src/net.cpp",
      "position": null,
      "original_position": 43,
      "commit_id": "4238b6f0a7553ebc5cee6f7c77d3813193f7a322",
      "original_commit_id": "a411cb5a170098c99e7c64f508153613f5e377da",
      "in_reply_to_id": null,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "Why not use `LogPrintLevel(BCLog::NET, BCLog::Level::Debug`?",
      "created_at": "2023-08-16T15:55:15Z",
      "updated_at": "2023-08-16T15:58:55Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28248#discussion_r1296121513",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1296121513"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28248"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 432,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1296393528",
      "pull_request_review_id": 1581366261,
      "id": 1296393528,
      "node_id": "PRRC_kwDOABII585NRWU4",
      "diff_hunk": "@@ -2621,24 +2630,15 @@ std::vector<CAddress> CConnman::GetAddresses(CNode& requestor, size_t max_addres\n bool CConnman::AddNode(const std::string& strNode)\n {\n     LOCK(m_added_nodes_mutex);\n-    for (const std::string& it : m_added_nodes) {\n-        if (strNode == it) return false;\n-    }\n-\n-    m_added_nodes.push_back(strNode);\n+    if (m_added_nodes.count(strNode)) return false;\n+    m_added_nodes.insert(strNode);\n     return true;",
      "path": "src/net.cpp",
      "position": null,
      "original_position": 173,
      "commit_id": "4238b6f0a7553ebc5cee6f7c77d3813193f7a322",
      "original_commit_id": "a411cb5a170098c99e7c64f508153613f5e377da",
      "in_reply_to_id": 1296106505,
      "user": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "Thank you, done.",
      "created_at": "2023-08-16T20:28:46Z",
      "updated_at": "2023-08-16T20:47:04Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28248#discussion_r1296393528",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1296393528"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28248"
        }
      },
      "start_line": null,
      "original_start_line": 2633,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 2635,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1296405960",
      "pull_request_review_id": 1581383931,
      "id": 1296405960,
      "node_id": "PRRC_kwDOABII585NRZXI",
      "diff_hunk": "@@ -437,6 +427,14 @@ static CAddress GetBindAddress(const Sock& sock)\n     return addr_bind;\n }\n \n+static void LogAlreadyConnected(CNode* pnode, ConnectionType conn_type)\n+{\n+    LogPrintfCategory(BCLog::NET, \"Failed to open new %s connection, already connected to peer=%d, net=%s%s (%s)\\n\",",
      "path": "src/net.cpp",
      "position": null,
      "original_position": 43,
      "commit_id": "4238b6f0a7553ebc5cee6f7c77d3813193f7a322",
      "original_commit_id": "a411cb5a170098c99e7c64f508153613f5e377da",
      "in_reply_to_id": 1296121513,
      "user": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "I didn't change the level from the current `LogPrintf` since 236618061a445d2cb11e722cfac5fdae5be26abb in 2017. Since this shouldn't normally occur, unconditionally logging seems helpful (the `net` category is currently much too busy to leave on and see this happen unless you proactively grep for it -- finishing the logging severity level upgrade should solve that. I personally test this branch with the added logging changed to unconditional).",
      "created_at": "2023-08-16T20:41:00Z",
      "updated_at": "2023-08-16T20:48:50Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28248#discussion_r1296405960",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1296405960"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28248"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 432,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1296427115",
      "pull_request_review_id": 1581416432,
      "id": 1296427115,
      "node_id": "PRRC_kwDOABII585NRehr",
      "diff_hunk": "@@ -1995,7 +2004,7 @@ std::vector<AddedNodeInfo> CConnman::GetAddedNodeInfo() const\n     }\n \n     for (const std::string& strAddNode : lAddresses) {\n-        CService service(LookupNumeric(strAddNode, Params().GetDefaultPort(strAddNode)));\n+        CService service{MaybeFlipIPv6toCJDNS(LookupNumeric(strAddNode, Params().GetDefaultPort(strAddNode)))};",
      "path": "src/net.cpp",
      "position": null,
      "original_position": 158,
      "commit_id": "4238b6f0a7553ebc5cee6f7c77d3813193f7a322",
      "original_commit_id": "a411cb5a170098c99e7c64f508153613f5e377da",
      "in_reply_to_id": 1296074743,
      "user": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "Yes, I think that is currently an issue as well.\r\n",
      "created_at": "2023-08-16T21:03:15Z",
      "updated_at": "2023-09-01T22:04:02Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28248#discussion_r1296427115",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1296427115"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28248"
        }
      },
      "start_line": null,
      "original_start_line": 1998,
      "start_side": "LEFT",
      "line": null,
      "original_line": 2794,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1296810743",
      "pull_request_review_id": 1581989659,
      "id": 1296810743,
      "node_id": "PRRC_kwDOABII585NS8L3",
      "diff_hunk": "@@ -1995,7 +2004,7 @@ std::vector<AddedNodeInfo> CConnman::GetAddedNodeInfo() const\n     }\n \n     for (const std::string& strAddNode : lAddresses) {\n-        CService service(LookupNumeric(strAddNode, Params().GetDefaultPort(strAddNode)));\n+        CService service{MaybeFlipIPv6toCJDNS(LookupNumeric(strAddNode, Params().GetDefaultPort(strAddNode)))};",
      "path": "src/net.cpp",
      "position": null,
      "original_position": 158,
      "commit_id": "4238b6f0a7553ebc5cee6f7c77d3813193f7a322",
      "original_commit_id": "a411cb5a170098c99e7c64f508153613f5e377da",
      "in_reply_to_id": 1296074743,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "I mean, if we already have an inbound connection from `1.2.3.4` (ie we are connected to `1.2.3.4:somerandomport`) and this code checks whether we are connected to `1.2.3.4:8333` it would wrongly assume that we are not and would open an outbound connection to that address.",
      "created_at": "2023-08-17T07:43:27Z",
      "updated_at": "2023-08-17T07:43:27Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28248#discussion_r1296810743",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1296810743"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28248"
        }
      },
      "start_line": null,
      "original_start_line": 1998,
      "start_side": "LEFT",
      "line": null,
      "original_line": 2794,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1313569401",
      "pull_request_review_id": 1607704196,
      "id": 1313569401,
      "node_id": "PRRC_kwDOABII585OS3p5",
      "diff_hunk": "@@ -1995,7 +2004,7 @@ std::vector<AddedNodeInfo> CConnman::GetAddedNodeInfo() const\n     }\n \n     for (const std::string& strAddNode : lAddresses) {\n-        CService service(LookupNumeric(strAddNode, Params().GetDefaultPort(strAddNode)));\n+        CService service{MaybeFlipIPv6toCJDNS(LookupNumeric(strAddNode, Params().GetDefaultPort(strAddNode)))};",
      "path": "src/net.cpp",
      "position": null,
      "original_position": 158,
      "commit_id": "4238b6f0a7553ebc5cee6f7c77d3813193f7a322",
      "original_commit_id": "a411cb5a170098c99e7c64f508153613f5e377da",
      "in_reply_to_id": 1296074743,
      "user": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "Good call. I've reproduced that bug and am looking at a fix.",
      "created_at": "2023-09-01T21:57:12Z",
      "updated_at": "2023-09-01T21:57:12Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28248#discussion_r1313569401",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1313569401"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28248"
        }
      },
      "start_line": null,
      "original_start_line": 1998,
      "start_side": "LEFT",
      "line": null,
      "original_line": 2794,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1313569449",
      "pull_request_review_id": 1607704224,
      "id": 1313569449,
      "node_id": "PRRC_kwDOABII585OS3qp",
      "diff_hunk": "@@ -408,7 +397,8 @@ CNode* CConnman::FindNode(const CService& addr)\n \n bool CConnman::AlreadyConnectedToAddress(const CAddress& addr)\n {\n-    return FindNode(static_cast<CNetAddr>(addr)) || FindNode(addr.ToStringAddrPort());\n+    const CService service{MaybeFlipIPv6toCJDNS(addr)};\n+    return FindNode(service) || FindNode(service.ToStringAddrPort());",
      "path": "src/net.cpp",
      "position": null,
      "original_position": 33,
      "commit_id": "4238b6f0a7553ebc5cee6f7c77d3813193f7a322",
      "original_commit_id": "a411cb5a170098c99e7c64f508153613f5e377da",
      "in_reply_to_id": 1296069949,
      "user": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "Changed `FindNode(service)` to `FindNode(static_cast<CNetAddr>(service))`.",
      "created_at": "2023-09-01T21:57:15Z",
      "updated_at": "2023-09-01T21:57:15Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28248#discussion_r1313569449",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1313569449"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28248"
        }
      },
      "start_line": null,
      "original_start_line": 398,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 401,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1313569577",
      "pull_request_review_id": 1607704324,
      "id": 1313569577,
      "node_id": "PRRC_kwDOABII585OS3sp",
      "diff_hunk": "@@ -437,6 +427,14 @@ static CAddress GetBindAddress(const Sock& sock)\n     return addr_bind;\n }\n \n+static void LogAlreadyConnected(CNode* pnode, ConnectionType conn_type)\n+{\n+    LogPrintfCategory(BCLog::NET, \"Failed to open new %s connection, already connected to peer=%d, net=%s%s (%s)\\n\",",
      "path": "src/net.cpp",
      "position": null,
      "original_position": 43,
      "commit_id": "4238b6f0a7553ebc5cee6f7c77d3813193f7a322",
      "original_commit_id": "a411cb5a170098c99e7c64f508153613f5e377da",
      "in_reply_to_id": 1296121513,
      "user": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "On second thought, taking your suggestion as the goal is to migrate to severity level logging. Thanks!",
      "created_at": "2023-09-01T21:57:25Z",
      "updated_at": "2023-10-24T14:27:48Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28248#discussion_r1313569577",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1313569577"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28248"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 432,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1316687977",
      "pull_request_review_id": 1612367872,
      "id": 1316687977,
      "node_id": "PRRC_kwDOABII585OexBp",
      "diff_hunk": "@@ -1995,7 +2004,7 @@ std::vector<AddedNodeInfo> CConnman::GetAddedNodeInfo() const\n     }\n \n     for (const std::string& strAddNode : lAddresses) {\n-        CService service(LookupNumeric(strAddNode, Params().GetDefaultPort(strAddNode)));\n+        CService service{MaybeFlipIPv6toCJDNS(LookupNumeric(strAddNode, Params().GetDefaultPort(strAddNode)))};",
      "path": "src/net.cpp",
      "position": null,
      "original_position": 158,
      "commit_id": "4238b6f0a7553ebc5cee6f7c77d3813193f7a322",
      "original_commit_id": "a411cb5a170098c99e7c64f508153613f5e377da",
      "in_reply_to_id": 1296074743,
      "user": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "Updated with a fix, along with several additional issues found and possibly fixed now while looking into this (thanks!)",
      "created_at": "2023-09-06T03:56:40Z",
      "updated_at": "2023-09-06T03:56:40Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28248#discussion_r1316687977",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1316687977"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28248"
        }
      },
      "start_line": null,
      "original_start_line": 1998,
      "start_side": "LEFT",
      "line": null,
      "original_line": 2794,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1323598562",
      "pull_request_review_id": 1623186191,
      "id": 1323598562,
      "node_id": "PRRC_kwDOABII585O5ILi",
      "diff_hunk": "@@ -2734,13 +2734,13 @@ std::vector<AddedNodeInfo> CConnman::GetAddedNodeInfo() const\n \n \n     // Build a map of all already connected addresses (by IP:port and by name) to inbound/outbound and resolved CService\n-    std::map<CService, bool> mapConnected;\n+    std::map<CNetAddr, bool> mapConnected;",
      "path": "src/net.cpp",
      "position": null,
      "original_position": 5,
      "commit_id": "4238b6f0a7553ebc5cee6f7c77d3813193f7a322",
      "original_commit_id": "54804cba858b614462b21e20dac088b2e7740e11",
      "in_reply_to_id": null,
      "user": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "Could this lead to disambiguities? Say if you want to addnode different localhost peers with different ports (but the same IP 127.0.0.1), would `getaddednode()` now say you are connected to all of them, even when you are only connected to 1 in reality? ",
      "created_at": "2023-09-12T21:28:33Z",
      "updated_at": "2023-09-12T22:13:22Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28248#discussion_r1323598562",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1323598562"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28248"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 2858,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1323646824",
      "pull_request_review_id": 1623186191,
      "id": 1323646824,
      "node_id": "PRRC_kwDOABII585O5T9o",
      "diff_hunk": "@@ -1814,6 +1814,16 @@ void CConnman::CreateNodeFromAcceptedSocket(std::unique_ptr<Sock>&& sock,\n     }\n \n     const bool inbound_onion = std::find(m_onion_binds.begin(), m_onion_binds.end(), addr_bind) != m_onion_binds.end();\n+\n+    // Don't accept inbound connections from peers already connected to us.\n+    // Skip this check for Tor, as their inbound/outbound addresses differ.\n+    if (!inbound_onion) {\n+        if (auto pnode = AlreadyConnectedToAddress(addr)) {",
      "path": "src/net.cpp",
      "position": null,
      "original_position": 8,
      "commit_id": "4238b6f0a7553ebc5cee6f7c77d3813193f7a322",
      "original_commit_id": "b97cfd18da8ad4e29319b8e3c84c3388cd75ff60",
      "in_reply_to_id": null,
      "user": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "Similar question here: Could this make some local network setups no longer viable? Probably no one should mainnet for those if it's just for testing, but possibly some setups with multiple nodes sharing the same IP exist?",
      "created_at": "2023-09-12T22:05:39Z",
      "updated_at": "2023-09-12T22:22:35Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28248#discussion_r1323646824",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1323646824"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28248"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1868,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1356400497",
      "pull_request_review_id": 1673481614,
      "id": 1356400497,
      "node_id": "PRRC_kwDOABII585Q2Qdx",
      "diff_hunk": "@@ -2734,13 +2734,13 @@ std::vector<AddedNodeInfo> CConnman::GetAddedNodeInfo() const\n \n \n     // Build a map of all already connected addresses (by IP:port and by name) to inbound/outbound and resolved CService\n-    std::map<CService, bool> mapConnected;\n+    std::map<CNetAddr, bool> mapConnected;",
      "path": "src/net.cpp",
      "position": null,
      "original_position": 5,
      "commit_id": "4238b6f0a7553ebc5cee6f7c77d3813193f7a322",
      "original_commit_id": "54804cba858b614462b21e20dac088b2e7740e11",
      "in_reply_to_id": 1323598562,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "Right. Comparing ports for incoming connections is problematic also. I think the right approach for determining if we are connected to `addr:port`, _for the purposes of making an outbound connection_:\r\n\r\n* For incoming connections, compare just `addr` and ignore `port`\r\n* For outgoing connections, compare both `addr` and `port`.\r\n\r\nThis can't be done with a single map of either `CService` or `CNetAddr`. I guess two containers are needed, as this:\r\n\r\n<details>\r\n<summary>[patch] compare differently inbound and outbound addresses</summary>\r\n\r\n```diff\r\ndiff --git i/src/net.cpp w/src/net.cpp\r\nindex 91282d927d..0eb0023112 100644\r\n--- i/src/net.cpp\r\n+++ w/src/net.cpp\r\n@@ -2809,41 +2809,49 @@ std::vector<AddedNodeInfo> CConnman::GetAddedNodeInfo() const\r\n         LOCK(m_added_nodes_mutex);\r\n         ret.reserve(m_added_node_params.size());\r\n         std::copy(m_added_node_params.cbegin(), m_added_node_params.cend(), std::back_inserter(lAddresses));\r\n     }\r\n \r\n \r\n-    // Build a map of all already connected addresses (by IP:port and by name) to inbound/outbound and resolved CService\r\n-    std::map<CNetAddr, bool> mapConnected;\r\n+    // Collect all addresses to which we are already connected.\r\n+    std::unordered_set<CNetAddr, CNetAddrHash> connected_to_inbound;\r\n+    std::unordered_set<CService, CServiceHash> connected_to_outbound;\r\n     std::map<std::string, std::pair<bool, CService>> mapConnectedByName;\r\n     {\r\n         LOCK(m_nodes_mutex);\r\n         for (const CNode* pnode : m_nodes) {\r\n             if (pnode->addr.IsValid()) {\r\n-                mapConnected[static_cast<CNetAddr>(pnode->addr)] = pnode->IsInboundConn();\r\n+                if (pnode->IsInboundConn()) {\r\n+                    connected_to_inbound.insert(pnode->addr);\r\n+                } else {\r\n+                    connected_to_outbound.insert(pnode->addr);\r\n+                }\r\n             }\r\n             std::string addrName{pnode->m_addr_name};\r\n             if (!addrName.empty()) {\r\n                 mapConnectedByName[std::move(addrName)] = std::make_pair(pnode->IsInboundConn(), static_cast<const CService&>(pnode->addr));\r\n             }\r\n         }\r\n     }\r\n \r\n     for (const auto& addr : lAddresses) {\r\n         CService service(LookupNumeric(addr.m_added_node, GetDefaultPort(addr.m_added_node)));\r\n         AddedNodeInfo addedNode{addr, CService(), false, false};\r\n         if (service.IsValid()) {\r\n-            // strAddNode is an IP:port\r\n-            auto it = mapConnected.find(static_cast<CNetAddr>(service));\r\n-            if (it != mapConnected.end()) {\r\n+            // addr.m_added_node is an addr:port\r\n+            if (connected_to_outbound.count(service) > 0) {\r\n+                addedNode.resolvedAddress = service;\r\n+                addedNode.fConnected = true;\r\n+                addedNode.fInbound = false;\r\n+            } else if (connected_to_inbound.count(service) > 0) {\r\n                 addedNode.resolvedAddress = service;\r\n                 addedNode.fConnected = true;\r\n-                addedNode.fInbound = it->second;\r\n+                addedNode.fInbound = true;\r\n             }\r\n         } else {\r\n-            // strAddNode is a name\r\n+            // addr.m_added_node is a name\r\n             auto it = mapConnectedByName.find(addr.m_added_node);\r\n             if (it != mapConnectedByName.end()) {\r\n                 addedNode.resolvedAddress = it->second.second;\r\n                 addedNode.fConnected = true;\r\n                 addedNode.fInbound = it->second.first;\r\n             }\r\ndiff --git i/src/netaddress.h w/src/netaddress.h\r\nindex ad09f16799..99a3b0fc22 100644\r\n--- i/src/netaddress.h\r\n+++ w/src/netaddress.h\r\n@@ -254,12 +254,13 @@ public:\r\n             UnserializeV2Stream(s);\r\n         } else {\r\n             UnserializeV1Stream(s);\r\n         }\r\n     }\r\n \r\n+    friend class CNetAddrHash;\r\n     friend class CSubNet;\r\n \r\n private:\r\n     /**\r\n      * Parse a Tor address and set this object to it.\r\n      * @param[in] addr Address to parse, must be a valid C string, for example\r\n@@ -473,12 +474,36 @@ private:\r\n         // will not be gossiped, but continue reading next addresses from the stream.\r\n         m_net = NET_IPV6;\r\n         m_addr.assign(ADDR_IPV6_SIZE, 0x0);\r\n     }\r\n };\r\n \r\n+class CNetAddrHash\r\n+{\r\n+public:\r\n+    CNetAddrHash()\r\n+        : m_salt_k0{GetRand<uint64_t>()},\r\n+          m_salt_k1{GetRand<uint64_t>()}\r\n+    {\r\n+    }\r\n+\r\n+    CNetAddrHash(uint64_t salt_k0, uint64_t salt_k1) : m_salt_k0{salt_k0}, m_salt_k1{salt_k1} {}\r\n+\r\n+    size_t operator()(const CNetAddr& a) const noexcept\r\n+    {\r\n+        CSipHasher hasher(m_salt_k0, m_salt_k1);\r\n+        hasher.Write(a.m_net);\r\n+        hasher.Write(a.m_addr);\r\n+        return static_cast<size_t>(hasher.Finalize());\r\n+    }\r\n+\r\n+private:\r\n+    const uint64_t m_salt_k0;\r\n+    const uint64_t m_salt_k1;\r\n+};\r\n+\r\n class CSubNet\r\n {\r\n protected:\r\n     /// Network (base) address\r\n     CNetAddr network;\r\n     /// Netmask, in network byte order\r\n```\r\n</details>",
      "created_at": "2023-10-12T07:39:25Z",
      "updated_at": "2023-10-12T10:05:13Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28248#discussion_r1356400497",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1356400497"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28248"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 2858,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1356484191",
      "pull_request_review_id": 1673614690,
      "id": 1356484191,
      "node_id": "PRRC_kwDOABII585Q2k5f",
      "diff_hunk": "@@ -408,9 +408,13 @@ CNode* CConnman::FindNode(const CService& addr)\n     return nullptr;\n }\n \n-bool CConnman::AlreadyConnectedToAddress(const CAddress& addr)\n+std::optional<CNode*> CConnman::AlreadyConnectedToAddress(const CAddress& addr)",
      "path": "src/net.cpp",
      "position": null,
      "original_position": 14,
      "commit_id": "4238b6f0a7553ebc5cee6f7c77d3813193f7a322",
      "original_commit_id": "2a9db3a16a93d497bfe496b7c35edac975ee81d2",
      "in_reply_to_id": null,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "Two concerns about this interface change:\r\n\r\n1. The pointer could become stale as soon as this method returns. It is good that this method is private which somewhat limits the danger that somebody will dereference a stale pointer, but does not eliminate it. `FindNode()` already has such an unsafe interface where it locks `m_nodes_mutex`, fetches a pointer to an element inside `m_nodes`, releases the mutex and returns the (possibly stale) pointer. In `master`, all places where `FindNode()` is called either only check if the returned pointer is null without dereferencing it (ok), or lock the mutex, call `FindNode()` (requiring the mutex to be recursive), dereference the pointer, unlock the mutex. But this PR in commit cb3f5a805caa2d42fdab57b42e6aee820ccd347d `p2p, bugfix: correctly detect already connected peers in ConnectNode()` adds calls where the pointer is dereferenced after releasing the mutex. I would rather have less such unsafe interfaces than more. Maybe log the message from inside `AlreadyConnectedToAddress()` or have it return the message as a string, to be optionally logged by the caller?\r\n\r\n2. (minor) `optional` from a pointer is redundant - if the pointer will never be null, then it can be reference. If the pointer can be null, then the `optional` can be dropped and null pointer to mean \"not connected\".",
      "created_at": "2023-10-12T08:37:47Z",
      "updated_at": "2023-10-12T11:16:08Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28248#discussion_r1356484191",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1356484191"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28248"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 411,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1356558158",
      "pull_request_review_id": 1673614690,
      "id": 1356558158,
      "node_id": "PRRC_kwDOABII585Q229O",
      "diff_hunk": "@@ -2902,7 +2944,7 @@ void CConnman::OpenNetworkConnection(const CAddress& addrConnect, bool fCountFai\n     }\n     if (!pszDest) {\n         bool banned_or_discouraged = m_banman && (m_banman->IsDiscouraged(addrConnect) || m_banman->IsBanned(addrConnect));\n-        if (IsLocal(addrConnect) || banned_or_discouraged || AlreadyConnectedToAddress(addrConnect)) {\n+        if (IsLocal(addrConnect) || banned_or_discouraged) {",
      "path": "src/net.cpp",
      "position": null,
      "original_position": 248,
      "commit_id": "4238b6f0a7553ebc5cee6f7c77d3813193f7a322",
      "original_commit_id": "2a9db3a16a93d497bfe496b7c35edac975ee81d2",
      "in_reply_to_id": null,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "cb3f5a805caa2d42fdab57b42e6aee820ccd347d `p2p, bugfix: correctly detect already connected peers in ConnectNode()`\r\n\r\n>    - Remove an AlreadyConnectedToAddress() check in CConnman::OpenNetworkConnection,\r\n      as it is now redundant to the checks added in this commit, and it is\r\n      preferable to log if it occurs.\r\n\r\nIt might happen that `CConnman::ConnectNode()` skips the call to `AlreadyConnectedToAddress()` and connects - if `pszDest` is null and `Lookup(pszDest` returns empty result. Then it will go here:\r\n\r\nhttps://github.com/bitcoin/bitcoin/blob/4a5aae9330780c3740e27cc511f7cba1fab745b9/src/net.cpp#L549-L558\r\n\r\nSo maybe keep the call to `AlreadyConnectedToAddress()` from `CConnman::OpenNetworkConnection()`.",
      "created_at": "2023-10-12T09:34:26Z",
      "updated_at": "2023-10-12T11:16:08Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28248#discussion_r1356558158",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1356558158"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28248"
        }
      },
      "start_line": null,
      "original_start_line": 2905,
      "start_side": "LEFT",
      "line": null,
      "original_line": 2947,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1356561796",
      "pull_request_review_id": 1673614690,
      "id": 1356561796,
      "node_id": "PRRC_kwDOABII585Q232E",
      "diff_hunk": "@@ -1847,6 +1861,16 @@ void CConnman::CreateNodeFromAcceptedSocket(std::unique_ptr<Sock>&& sock,\n     }\n \n     const bool inbound_onion = std::find(m_onion_binds.begin(), m_onion_binds.end(), addr_bind) != m_onion_binds.end();\n+\n+    // Don't accept inbound connections from peers already connected to us.\n+    // Skip this check for inbound Tor connections, as each IP will differ.",
      "path": "src/net.cpp",
      "position": null,
      "original_position": 106,
      "commit_id": "4238b6f0a7553ebc5cee6f7c77d3813193f7a322",
      "original_commit_id": "2a9db3a16a93d497bfe496b7c35edac975ee81d2",
      "in_reply_to_id": null,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "```suggestion\r\n    // Skip this check for inbound Tor connections because all of them seem to come from the IP address of the Tor router (usually 127.0.0.1).\r\n```",
      "created_at": "2023-10-12T09:37:33Z",
      "updated_at": "2023-10-12T11:16:08Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28248#discussion_r1356561796",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1356561796"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28248"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1866,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1356590348",
      "pull_request_review_id": 1673614690,
      "id": 1356590348,
      "node_id": "PRRC_kwDOABII585Q2-0M",
      "diff_hunk": "@@ -408,9 +408,13 @@ CNode* CConnman::FindNode(const CService& addr)\n     return nullptr;\n }\n \n-bool CConnman::AlreadyConnectedToAddress(const CAddress& addr)\n+std::optional<CNode*> CConnman::AlreadyConnectedToAddress(const CAddress& addr)\n {\n-    return FindNode(static_cast<CNetAddr>(addr)) || FindNode(addr.ToStringAddrPort());\n+    if (Params().IsTestChain()) return std::nullopt; // allow bilateral connections on test chains\n+    const CService service{MaybeFlipIPv6toCJDNS(addr)};\n+    if (auto pnode = FindNode(static_cast<CNetAddr>(service))) return pnode;\n+    if (auto pnode = FindNode(service.ToStringAddrPort())) return pnode;\n+    return std::nullopt;\n }",
      "path": "src/net.cpp",
      "position": null,
      "original_position": 22,
      "commit_id": "4238b6f0a7553ebc5cee6f7c77d3813193f7a322",
      "original_commit_id": "2a9db3a16a93d497bfe496b7c35edac975ee81d2",
      "in_reply_to_id": null,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "This needs to know whether to ignore the port or not in order to do the check properly:\r\n\r\n* if we are about to make an outbound connection and wonder whether we are already connected to the peer we intend to connect to\r\n  * for all existent outbound connections, compare the prospect's address and port and if both match, then we are already connected\r\n  * for all existent inbound connections, compare only the address and ignore the port, if a match is found, then we are already connected\r\n  * otherwise we are not connected\r\n* if we are accepting in inbound connection, for all existent inbound and outbound connections, compare only the address and if a match is found then we are already connected, otherwise we are not connected.",
      "created_at": "2023-10-12T10:02:13Z",
      "updated_at": "2023-10-12T11:16:08Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28248#discussion_r1356590348",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1356590348"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28248"
        }
      },
      "start_line": null,
      "original_start_line": 411,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 397,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1356598798",
      "pull_request_review_id": 1673614690,
      "id": 1356598798,
      "node_id": "PRRC_kwDOABII585Q3A4O",
      "diff_hunk": "@@ -101,6 +101,17 @@ typedef int64_t NodeId;\n struct AddedNodeParams {\n     std::string m_added_node;\n     bool m_use_v2transport;\n+    bool operator==(const AddedNodeParams& p) const\n+    {\n+        return m_added_node == p.m_added_node && m_use_v2transport == p.m_use_v2transport;\n+    }\n+};\n+\n+struct AddedNodeHasher {\n+    size_t operator()(const AddedNodeParams& p) const noexcept",
      "path": "src/net.h",
      "position": null,
      "original_position": 11,
      "commit_id": "4238b6f0a7553ebc5cee6f7c77d3813193f7a322",
      "original_commit_id": "2a9db3a16a93d497bfe496b7c35edac975ee81d2",
      "in_reply_to_id": null,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "nit, feel free to ignore: for consistency with `CServiceHash` this better end in `Hash`. Given that it operates on `AddedNodeParams` better use that name verbatim instead of shortening it to `AddedNode`. I.e. consider renaming this to `AddedNodeParamsHash`.",
      "created_at": "2023-10-12T10:10:07Z",
      "updated_at": "2023-10-12T11:16:08Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28248#discussion_r1356598798",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1356598798"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28248"
        }
      },
      "start_line": null,
      "original_start_line": 110,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 111,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1356610866",
      "pull_request_review_id": 1673614690,
      "id": 1356610866,
      "node_id": "PRRC_kwDOABII585Q3D0y",
      "diff_hunk": "@@ -101,6 +101,17 @@ typedef int64_t NodeId;\n struct AddedNodeParams {\n     std::string m_added_node;\n     bool m_use_v2transport;\n+    bool operator==(const AddedNodeParams& p) const\n+    {\n+        return m_added_node == p.m_added_node && m_use_v2transport == p.m_use_v2transport;\n+    }\n+};\n+\n+struct AddedNodeHasher {\n+    size_t operator()(const AddedNodeParams& p) const noexcept\n+    {\n+        return std::hash<std::string>()(p.m_added_node) ^ (std::hash<bool>()(p.m_use_v2transport) << 1);",
      "path": "src/net.h",
      "position": null,
      "original_position": 13,
      "commit_id": "4238b6f0a7553ebc5cee6f7c77d3813193f7a322",
      "original_commit_id": "2a9db3a16a93d497bfe496b7c35edac975ee81d2",
      "in_reply_to_id": null,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "Why `<< 1`?",
      "created_at": "2023-10-12T10:22:08Z",
      "updated_at": "2023-10-12T11:16:08Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28248#discussion_r1356610866",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1356610866"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28248"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 113,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1356628687",
      "pull_request_review_id": 1673614690,
      "id": 1356628687,
      "node_id": "PRRC_kwDOABII585Q3ILP",
      "diff_hunk": "@@ -2760,6 +2787,19 @@ void CConnman::ThreadOpenConnections(const std::vector<std::string> connect)\n                 continue;\n             }\n \n+            // Do not make automatic outbound connections to addnode peers,\n+            // to allocate our limited outbound slots correctly and to ensure\n+            // addnode connections benefit from their intended protections.\n+            // Expect BIP324 transport when both us and them have NODE_V2_P2P set.\n+            const bool v2_p2p(addr.nServices & GetLocalServices() & NODE_P2P_V2);\n+            if (WITH_LOCK(m_added_nodes_mutex, return m_added_node_params.count({addr.ToStringAddr(), v2_p2p}) || m_added_node_params.count({addr.ToStringAddrPort(), v2_p2p}))) {",
      "path": "src/net.cpp",
      "position": null,
      "original_position": 187,
      "commit_id": "4238b6f0a7553ebc5cee6f7c77d3813193f7a322",
      "original_commit_id": "2a9db3a16a93d497bfe496b7c35edac975ee81d2",
      "in_reply_to_id": null,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "If we have the address for manual connections (given to `addnode`) here we should ignore whether v1 or v2 is going to be used. It is the same peer after all, regardless of p2p encryption. I guess this better be something like:\r\n\r\n```cpp\r\nbool in_added_nodes;\r\n{\r\n    const std::string addr_str{addr.ToStringAddr()};\r\n    const std::string addr_port_str{addr.ToStringAddrPort()};\r\n    LOCK(m_added_nodes_mutex);\r\n    in_added_nodes =\r\n        m_added_node_params.count({addr_str, /*m_use_v2transport=*/true}) > 0 ||\r\n        m_added_node_params.count({addr_str, /*m_use_v2transport=*/false}) > 0 ||\r\n        m_added_node_params.count({addr_port_str, /*m_use_v2transport=*/true}) > 0 ||\r\n        m_added_node_params.count({addr_port_str, /*m_use_v2transport=*/false}) > 0;\r\n}\r\nif (in_added_nodes) {",
      "created_at": "2023-10-12T10:39:03Z",
      "updated_at": "2023-10-12T11:16:08Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28248#discussion_r1356628687",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1356628687"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28248"
        }
      },
      "start_line": null,
      "original_start_line": 2794,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 2795,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1356657006",
      "pull_request_review_id": 1673614690,
      "id": 1356657006,
      "node_id": "PRRC_kwDOABII585Q3PFu",
      "diff_hunk": "@@ -474,15 +483,18 @@ CNode* CConnman::ConnectNode(CAddress addrConnect, const char *pszDest, bool fCo\n             }\n             // It is possible that we already have a connection to the IP/port pszDest resolved to.\n             // In that case, drop the connection that was just created.\n-            LOCK(m_nodes_mutex);\n-            CNode* pnode = FindNode(static_cast<CService>(addrConnect));\n-            if (pnode) {\n-                LogPrintf(\"Failed to open new connection, already connected\\n\");\n+            if (auto pnode = AlreadyConnectedToAddress(addrConnect)) {\n+                LogPrintLevel(BCLog::NET, BCLog::Level::Info, \"%s\\n\", AlreadyConnected(pnode.value(), addrConnect, conn_type));\n                 return nullptr;\n             }\n         }\n     }\n \n+    LogPrintLevel(BCLog::NET, BCLog::Level::Debug, \"Trying v%i %s connection to net=%s%s, lastseen=%.1fhrs\\n\",",
      "path": "src/net.cpp",
      "position": null,
      "original_position": 81,
      "commit_id": "4238b6f0a7553ebc5cee6f7c77d3813193f7a322",
      "original_commit_id": "2a9db3a16a93d497bfe496b7c35edac975ee81d2",
      "in_reply_to_id": null,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "nit:\r\n```suggestion\r\n    LogPrintLevel(BCLog::NET, BCLog::Level::Debug, \"Trying v%i %s connection to net=%s%s, lastseen=%.1fh ago\\n\",\r\n```",
      "created_at": "2023-10-12T11:05:27Z",
      "updated_at": "2023-10-12T11:16:08Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28248#discussion_r1356657006",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1356657006"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28248"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 493,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1356660922",
      "pull_request_review_id": 1673614690,
      "id": 1356660922,
      "node_id": "PRRC_kwDOABII585Q3QC6",
      "diff_hunk": "@@ -1869,7 +1893,9 @@ void CConnman::CreateNodeFromAcceptedSocket(std::unique_ptr<Sock>&& sock,\n     pnode->AddRef();\n     m_msgproc->InitializeNode(*pnode, nodeServices);\n \n-    LogPrint(BCLog::NET, \"connection from %s accepted\\n\", addr.ToStringAddrPort());\n+    LogPrintLevel(BCLog::NET, BCLog::Level::Debug, \"New %s connection accepted from peer=%d, net=%s%s\\n\",",
      "path": "src/net.cpp",
      "position": null,
      "original_position": 122,
      "commit_id": "4238b6f0a7553ebc5cee6f7c77d3813193f7a322",
      "original_commit_id": "2a9db3a16a93d497bfe496b7c35edac975ee81d2",
      "in_reply_to_id": null,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "nit: I find \"...connection accepted from peer=5\"  a bit confusing. Maybe:\r\n```suggestion\r\n    LogPrintLevel(BCLog::NET, BCLog::Level::Debug, \"New %s connection accepted, peer=%d, net=%s%s\\n\",\r\n```",
      "created_at": "2023-10-12T11:09:23Z",
      "updated_at": "2023-10-12T11:16:08Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28248#discussion_r1356660922",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1356660922"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28248"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1896,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1361236879",
      "pull_request_review_id": 1680913596,
      "id": 1361236879,
      "node_id": "PRRC_kwDOABII585RItOP",
      "diff_hunk": "@@ -474,15 +483,18 @@ CNode* CConnman::ConnectNode(CAddress addrConnect, const char *pszDest, bool fCo\n             }\n             // It is possible that we already have a connection to the IP/port pszDest resolved to.\n             // In that case, drop the connection that was just created.\n-            LOCK(m_nodes_mutex);\n-            CNode* pnode = FindNode(static_cast<CService>(addrConnect));\n-            if (pnode) {\n-                LogPrintf(\"Failed to open new connection, already connected\\n\");\n+            if (auto pnode = AlreadyConnectedToAddress(addrConnect)) {\n+                LogPrintLevel(BCLog::NET, BCLog::Level::Info, \"%s\\n\", AlreadyConnected(pnode.value(), addrConnect, conn_type));\n                 return nullptr;\n             }\n         }\n     }\n \n+    LogPrintLevel(BCLog::NET, BCLog::Level::Debug, \"Trying v%i %s connection to net=%s%s, lastseen=%.1fhrs\\n\",",
      "path": "src/net.cpp",
      "position": null,
      "original_position": 81,
      "commit_id": "4238b6f0a7553ebc5cee6f7c77d3813193f7a322",
      "original_commit_id": "2a9db3a16a93d497bfe496b7c35edac975ee81d2",
      "in_reply_to_id": 1356657006,
      "user": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "Done",
      "created_at": "2023-10-16T20:34:38Z",
      "updated_at": "2023-10-16T20:34:38Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28248#discussion_r1361236879",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1361236879"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28248"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 493,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1361236968",
      "pull_request_review_id": 1680913719,
      "id": 1361236968,
      "node_id": "PRRC_kwDOABII585RItPo",
      "diff_hunk": "@@ -1869,7 +1893,9 @@ void CConnman::CreateNodeFromAcceptedSocket(std::unique_ptr<Sock>&& sock,\n     pnode->AddRef();\n     m_msgproc->InitializeNode(*pnode, nodeServices);\n \n-    LogPrint(BCLog::NET, \"connection from %s accepted\\n\", addr.ToStringAddrPort());\n+    LogPrintLevel(BCLog::NET, BCLog::Level::Debug, \"New %s connection accepted from peer=%d, net=%s%s\\n\",",
      "path": "src/net.cpp",
      "position": null,
      "original_position": 122,
      "commit_id": "4238b6f0a7553ebc5cee6f7c77d3813193f7a322",
      "original_commit_id": "2a9db3a16a93d497bfe496b7c35edac975ee81d2",
      "in_reply_to_id": 1356660922,
      "user": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "Done",
      "created_at": "2023-10-16T20:34:43Z",
      "updated_at": "2023-10-16T20:34:44Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28248#discussion_r1361236968",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1361236968"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28248"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1896,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1361237154",
      "pull_request_review_id": 1680913997,
      "id": 1361237154,
      "node_id": "PRRC_kwDOABII585RItSi",
      "diff_hunk": "@@ -101,6 +101,17 @@ typedef int64_t NodeId;\n struct AddedNodeParams {\n     std::string m_added_node;\n     bool m_use_v2transport;\n+    bool operator==(const AddedNodeParams& p) const\n+    {\n+        return m_added_node == p.m_added_node && m_use_v2transport == p.m_use_v2transport;\n+    }\n+};\n+\n+struct AddedNodeHasher {\n+    size_t operator()(const AddedNodeParams& p) const noexcept",
      "path": "src/net.h",
      "position": null,
      "original_position": 11,
      "commit_id": "4238b6f0a7553ebc5cee6f7c77d3813193f7a322",
      "original_commit_id": "2a9db3a16a93d497bfe496b7c35edac975ee81d2",
      "in_reply_to_id": 1356598798,
      "user": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "Done",
      "created_at": "2023-10-16T20:34:56Z",
      "updated_at": "2023-10-16T20:34:56Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28248#discussion_r1361237154",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1361237154"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28248"
        }
      },
      "start_line": null,
      "original_start_line": 110,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 111,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1361237294",
      "pull_request_review_id": 1680914186,
      "id": 1361237294,
      "node_id": "PRRC_kwDOABII585RItUu",
      "diff_hunk": "@@ -1847,6 +1861,16 @@ void CConnman::CreateNodeFromAcceptedSocket(std::unique_ptr<Sock>&& sock,\n     }\n \n     const bool inbound_onion = std::find(m_onion_binds.begin(), m_onion_binds.end(), addr_bind) != m_onion_binds.end();\n+\n+    // Don't accept inbound connections from peers already connected to us.\n+    // Skip this check for inbound Tor connections, as each IP will differ.",
      "path": "src/net.cpp",
      "position": null,
      "original_position": 106,
      "commit_id": "4238b6f0a7553ebc5cee6f7c77d3813193f7a322",
      "original_commit_id": "2a9db3a16a93d497bfe496b7c35edac975ee81d2",
      "in_reply_to_id": 1356561796,
      "user": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "Done.",
      "created_at": "2023-10-16T20:35:04Z",
      "updated_at": "2023-10-16T20:35:06Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28248#discussion_r1361237294",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1361237294"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28248"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1866,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1361245328",
      "pull_request_review_id": 1680928309,
      "id": 1361245328,
      "node_id": "PRRC_kwDOABII585RIvSQ",
      "diff_hunk": "@@ -2760,6 +2787,19 @@ void CConnman::ThreadOpenConnections(const std::vector<std::string> connect)\n                 continue;\n             }\n \n+            // Do not make automatic outbound connections to addnode peers,\n+            // to allocate our limited outbound slots correctly and to ensure\n+            // addnode connections benefit from their intended protections.\n+            // Expect BIP324 transport when both us and them have NODE_V2_P2P set.\n+            const bool v2_p2p(addr.nServices & GetLocalServices() & NODE_P2P_V2);\n+            if (WITH_LOCK(m_added_nodes_mutex, return m_added_node_params.count({addr.ToStringAddr(), v2_p2p}) || m_added_node_params.count({addr.ToStringAddrPort(), v2_p2p}))) {",
      "path": "src/net.cpp",
      "position": null,
      "original_position": 187,
      "commit_id": "4238b6f0a7553ebc5cee6f7c77d3813193f7a322",
      "original_commit_id": "2a9db3a16a93d497bfe496b7c35edac975ee81d2",
      "in_reply_to_id": 1356628687,
      "user": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "Thanks. I hesitated on this point. Done.",
      "created_at": "2023-10-16T20:45:14Z",
      "updated_at": "2023-10-16T20:45:14Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28248#discussion_r1361245328",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1361245328"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28248"
        }
      },
      "start_line": null,
      "original_start_line": 2794,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 2795,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1361303135",
      "pull_request_review_id": 1681020942,
      "id": 1361303135,
      "node_id": "PRRC_kwDOABII585RI9Zf",
      "diff_hunk": "@@ -2734,13 +2734,13 @@ std::vector<AddedNodeInfo> CConnman::GetAddedNodeInfo() const\n \n \n     // Build a map of all already connected addresses (by IP:port and by name) to inbound/outbound and resolved CService\n-    std::map<CService, bool> mapConnected;\n+    std::map<CNetAddr, bool> mapConnected;",
      "path": "src/net.cpp",
      "position": null,
      "original_position": 5,
      "commit_id": "4238b6f0a7553ebc5cee6f7c77d3813193f7a322",
      "original_commit_id": "54804cba858b614462b21e20dac088b2e7740e11",
      "in_reply_to_id": 1323598562,
      "user": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "@vasild Thanks! I agree with your bimodal approach and replaced 71528aeaba2fbb3141693b000f2ec7799074bfdf with your suggestion above credited to you.",
      "created_at": "2023-10-16T21:52:43Z",
      "updated_at": "2023-10-16T21:52:43Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28248#discussion_r1361303135",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1361303135"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28248"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 2858,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1361380390",
      "pull_request_review_id": 1681130735,
      "id": 1361380390,
      "node_id": "PRRC_kwDOABII585RJQQm",
      "diff_hunk": "@@ -408,9 +408,13 @@ CNode* CConnman::FindNode(const CService& addr)\n     return nullptr;\n }\n \n-bool CConnman::AlreadyConnectedToAddress(const CAddress& addr)\n+std::optional<CNode*> CConnman::AlreadyConnectedToAddress(const CAddress& addr)\n {\n-    return FindNode(static_cast<CNetAddr>(addr)) || FindNode(addr.ToStringAddrPort());\n+    if (Params().IsTestChain()) return std::nullopt; // allow bilateral connections on test chains\n+    const CService service{MaybeFlipIPv6toCJDNS(addr)};\n+    if (auto pnode = FindNode(static_cast<CNetAddr>(service))) return pnode;\n+    if (auto pnode = FindNode(service.ToStringAddrPort())) return pnode;\n+    return std::nullopt;\n }",
      "path": "src/net.cpp",
      "position": null,
      "original_position": 22,
      "commit_id": "4238b6f0a7553ebc5cee6f7c77d3813193f7a322",
      "original_commit_id": "2a9db3a16a93d497bfe496b7c35edac975ee81d2",
      "in_reply_to_id": 1356590348,
      "user": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "I think that makes sense. Done -- thanks!",
      "created_at": "2023-10-17T00:20:34Z",
      "updated_at": "2023-10-17T00:20:35Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28248#discussion_r1361380390",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1361380390"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28248"
        }
      },
      "start_line": null,
      "original_start_line": 411,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 397,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1361468438",
      "pull_request_review_id": 1681302157,
      "id": 1361468438,
      "node_id": "PRRC_kwDOABII585RJlwW",
      "diff_hunk": "@@ -408,9 +408,13 @@ CNode* CConnman::FindNode(const CService& addr)\n     return nullptr;\n }\n \n-bool CConnman::AlreadyConnectedToAddress(const CAddress& addr)\n+std::optional<CNode*> CConnman::AlreadyConnectedToAddress(const CAddress& addr)",
      "path": "src/net.cpp",
      "position": null,
      "original_position": 14,
      "commit_id": "4238b6f0a7553ebc5cee6f7c77d3813193f7a322",
      "original_commit_id": "2a9db3a16a93d497bfe496b7c35edac975ee81d2",
      "in_reply_to_id": 1356484191,
      "user": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "Good points. Changed `AlreadyConnectedToAddress()` back to return a `bool` and log the message from inside it.",
      "created_at": "2023-10-17T03:29:09Z",
      "updated_at": "2023-10-17T03:29:09Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28248#discussion_r1361468438",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1361468438"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28248"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 411,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1361473409",
      "pull_request_review_id": 1681309253,
      "id": 1361473409,
      "node_id": "PRRC_kwDOABII585RJm-B",
      "diff_hunk": "@@ -2902,7 +2944,7 @@ void CConnman::OpenNetworkConnection(const CAddress& addrConnect, bool fCountFai\n     }\n     if (!pszDest) {\n         bool banned_or_discouraged = m_banman && (m_banman->IsDiscouraged(addrConnect) || m_banman->IsBanned(addrConnect));\n-        if (IsLocal(addrConnect) || banned_or_discouraged || AlreadyConnectedToAddress(addrConnect)) {\n+        if (IsLocal(addrConnect) || banned_or_discouraged) {",
      "path": "src/net.cpp",
      "position": null,
      "original_position": 248,
      "commit_id": "4238b6f0a7553ebc5cee6f7c77d3813193f7a322",
      "original_commit_id": "2a9db3a16a93d497bfe496b7c35edac975ee81d2",
      "in_reply_to_id": 1356558158,
      "user": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "Keeping the call (thanks).",
      "created_at": "2023-10-17T03:41:05Z",
      "updated_at": "2023-10-17T03:41:06Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28248#discussion_r1361473409",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1361473409"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28248"
        }
      },
      "start_line": null,
      "original_start_line": 2905,
      "start_side": "LEFT",
      "line": null,
      "original_line": 2947,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1361490253",
      "pull_request_review_id": 1681333894,
      "id": 1361490253,
      "node_id": "PRRC_kwDOABII585RJrFN",
      "diff_hunk": "@@ -101,6 +101,17 @@ typedef int64_t NodeId;\n struct AddedNodeParams {\n     std::string m_added_node;\n     bool m_use_v2transport;\n+    bool operator==(const AddedNodeParams& p) const\n+    {\n+        return m_added_node == p.m_added_node && m_use_v2transport == p.m_use_v2transport;\n+    }\n+};\n+\n+struct AddedNodeHasher {\n+    size_t operator()(const AddedNodeParams& p) const noexcept\n+    {\n+        return std::hash<std::string>()(p.m_added_node) ^ (std::hash<bool>()(p.m_use_v2transport) << 1);",
      "path": "src/net.h",
      "position": null,
      "original_position": 13,
      "commit_id": "4238b6f0a7553ebc5cee6f7c77d3813193f7a322",
      "original_commit_id": "2a9db3a16a93d497bfe496b7c35edac975ee81d2",
      "in_reply_to_id": 1356610866,
      "user": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "It's adapted from the `struct MyHash` code example in https://en.cppreference.com/w/cpp/utility/hash, and I've updated it in the latest push to be more like that example.  I'd be very happy for advice on how to improve that hashing function or use our time-tested existing ones.\r\n\r\n```cpp\r\nstruct MyHash\r\n{\r\n    std::size_t operator()(const S& s) const noexcept\r\n    {\r\n        std::size_t h1 = std::hash<std::string>{}(s.first_name);\r\n        std::size_t h2 = std::hash<std::string>{}(s.last_name);\r\n        return h1 ^ (h2 << 1);\r\n    }\r\n};\r\n```\r\n",
      "created_at": "2023-10-17T04:19:16Z",
      "updated_at": "2023-10-17T04:19:16Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28248#discussion_r1361490253",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1361490253"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28248"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 113,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1361515079",
      "pull_request_review_id": 1681374558,
      "id": 1361515079,
      "node_id": "PRRC_kwDOABII585RJxJH",
      "diff_hunk": "@@ -1814,6 +1814,16 @@ void CConnman::CreateNodeFromAcceptedSocket(std::unique_ptr<Sock>&& sock,\n     }\n \n     const bool inbound_onion = std::find(m_onion_binds.begin(), m_onion_binds.end(), addr_bind) != m_onion_binds.end();\n+\n+    // Don't accept inbound connections from peers already connected to us.\n+    // Skip this check for Tor, as their inbound/outbound addresses differ.\n+    if (!inbound_onion) {\n+        if (auto pnode = AlreadyConnectedToAddress(addr)) {",
      "path": "src/net.cpp",
      "position": null,
      "original_position": 8,
      "commit_id": "4238b6f0a7553ebc5cee6f7c77d3813193f7a322",
      "original_commit_id": "b97cfd18da8ad4e29319b8e3c84c3388cd75ff60",
      "in_reply_to_id": 1323646824,
      "user": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "Good question.  I've rewritten `AlreadyConnectedToAddress()` with the suggestions in https://github.com/bitcoin/bitcoin/pull/28248#discussion_r1356590348. Do you think that resolves the possible issue you describe?",
      "created_at": "2023-10-17T05:09:29Z",
      "updated_at": "2023-10-17T05:09:30Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28248#discussion_r1361515079",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1361515079"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28248"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1868,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1362002965",
      "pull_request_review_id": 1682140589,
      "id": 1362002965,
      "node_id": "PRRC_kwDOABII585RLoQV",
      "diff_hunk": "@@ -101,6 +101,17 @@ typedef int64_t NodeId;\n struct AddedNodeParams {\n     std::string m_added_node;\n     bool m_use_v2transport;\n+    bool operator==(const AddedNodeParams& p) const\n+    {\n+        return m_added_node == p.m_added_node && m_use_v2transport == p.m_use_v2transport;\n+    }\n+};\n+\n+struct AddedNodeHasher {\n+    size_t operator()(const AddedNodeParams& p) const noexcept\n+    {\n+        return std::hash<std::string>()(p.m_added_node) ^ (std::hash<bool>()(p.m_use_v2transport) << 1);",
      "path": "src/net.h",
      "position": null,
      "original_position": 13,
      "commit_id": "4238b6f0a7553ebc5cee6f7c77d3813193f7a322",
      "original_commit_id": "2a9db3a16a93d497bfe496b7c35edac975ee81d2",
      "in_reply_to_id": 1356610866,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "I am not sure why they used `<< 1`. It seems to be useless and also it drops one bit from `h2`. Maybe to avoid returning `0` if first name and last name happen to be equal?\r\n\r\nI think for the purposes of hashing `m_added_node_params` this suffices:\r\n```cpp\r\n    size_t operator()(const AddedNodeParams& p) const noexcept\r\n    {\r\n        return std::hash<std::string>()(p.m_added_node) ^ p.m_use_v2transport;\r\n    }\r\n```\r\n\r\nHowever `std::hash` is not used anywhere in the code (modulo in some tests and benchmarks). `CServiceHash` uses `CSipHasher`, but there are security concerns with an outsider being able to fiddle with the hashing, maybe this is an overkill for `AddedNodeParams`. If that is to be used here, then it would look like:\r\n\r\n```cpp\r\n        CSipHasher hasher(m_salt_k0, m_salt_k1);\r\n        hasher.Write(MakeUCharSpan(p.m_added_node));\r\n        hasher.Write(p.m_use_v2transport);\r\n        return static_cast<size_t>(hasher.Finalize());\r\n```\r\n\r\nOr use some of the stateless `Hash*` functions from `src/hash.h`.\r\n\r\nI guess @sipa can give us an advice?",
      "created_at": "2023-10-17T12:01:57Z",
      "updated_at": "2023-10-17T12:01:57Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28248#discussion_r1362002965",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1362002965"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28248"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 113,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1362086687",
      "pull_request_review_id": 1682305820,
      "id": 1362086687,
      "node_id": "PRRC_kwDOABII585RL8sf",
      "diff_hunk": "@@ -408,9 +409,32 @@ CNode* CConnman::FindNode(const CService& addr)\n     return nullptr;\n }\n \n-bool CConnman::AlreadyConnectedToAddress(const CAddress& addr)\n+bool CConnman::AlreadyConnectedToAddress(const CAddress& addr, ConnectionType conn_type, bool log)\n {\n-    return FindNode(static_cast<CNetAddr>(addr)) || FindNode(addr.ToStringAddrPort());\n+    if (Params().IsTestChain()) return false; // allow bilateral connections on test chains\n+    const CService service{MaybeFlipIPv6toCJDNS(addr)};\n+    const bool inbound{conn_type == ConnectionType::INBOUND};\n+    CNode* pnode{nullptr};\n+    if (inbound) {\n+        // For accepting an inbound connection, check all existing connections by addr only.\n+        pnode = FindNode(static_cast<CNetAddr>(service));\n+    } else {\n+        // For making an outbound connection, check the existing outbound connections\n+        // by addr and port, and if none, then inbound connections by addr only.\n+        pnode = FindNode(service.ToStringAddrPort(), /*inbound=*/false);",
      "path": "src/net.cpp",
      "position": null,
      "original_position": 54,
      "commit_id": "4238b6f0a7553ebc5cee6f7c77d3813193f7a322",
      "original_commit_id": "44ceac2ef9992c799dce22477a5884bd82ba9860",
      "in_reply_to_id": null,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "Can use `CConnman::FindNode(const CService& addr)` here?\r\n```suggestion\r\n        pnode = FindNode(service, /*inbound=*/false);\r\n```\r\n\r\nbut then we will not be comparing against `CNode::m_addr_name`. I wonder if we should compare against both `CNode::addr` and `CNode::m_addr_name`?",
      "created_at": "2023-10-17T13:08:52Z",
      "updated_at": "2023-10-17T13:40:21Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28248#discussion_r1362086687",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1362086687"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28248"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 424,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1362096272",
      "pull_request_review_id": 1682305820,
      "id": 1362096272,
      "node_id": "PRRC_kwDOABII585RL_CQ",
      "diff_hunk": "@@ -408,9 +409,32 @@ CNode* CConnman::FindNode(const CService& addr)\n     return nullptr;\n }\n \n-bool CConnman::AlreadyConnectedToAddress(const CAddress& addr)\n+bool CConnman::AlreadyConnectedToAddress(const CAddress& addr, ConnectionType conn_type, bool log)\n {\n-    return FindNode(static_cast<CNetAddr>(addr)) || FindNode(addr.ToStringAddrPort());\n+    if (Params().IsTestChain()) return false; // allow bilateral connections on test chains\n+    const CService service{MaybeFlipIPv6toCJDNS(addr)};\n+    const bool inbound{conn_type == ConnectionType::INBOUND};\n+    CNode* pnode{nullptr};\n+    if (inbound) {\n+        // For accepting an inbound connection, check all existing connections by addr only.\n+        pnode = FindNode(static_cast<CNetAddr>(service));\n+    } else {\n+        // For making an outbound connection, check the existing outbound connections\n+        // by addr and port, and if none, then inbound connections by addr only.\n+        pnode = FindNode(service.ToStringAddrPort(), /*inbound=*/false);\n+        if (!pnode) pnode = FindNode(static_cast<CNetAddr>(service), /*inbound=*/true);\n+    }\n+    if (pnode && log) {\n+        LogPrintLevel(BCLog::NET, inbound ? BCLog::Level::Debug : BCLog::Level::Info,\n+                      \"Not %s new %s connection%s, already connected to %s %s %s peer=%d%s, version=%d, subver=%s\\n\",\n+                      inbound ? \"accepting\" : \"opening\", ConnectionTypeAsString(conn_type),\n+                      fLogIPs ? strprintf(\" %s %s\", inbound ? \"from\" : \"to\", addr.ToStringAddrPort()) : \"\",\n+                      TransportTypeAsString(pnode->m_transport->GetInfo().transport_type),\n+                      pnode->ConnectionTypeAsString(), GetNetworkName(pnode->ConnectedThroughNetwork()),",
      "path": "src/net.cpp",
      "position": null,
      "original_position": 63,
      "commit_id": "4238b6f0a7553ebc5cee6f7c77d3813193f7a322",
      "original_commit_id": "44ceac2ef9992c799dce22477a5884bd82ba9860",
      "in_reply_to_id": null,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "Dereferencing `pnode` after `FindNode()` has released `m_nodes_mutex` is not safe. I don't like adding recursive mutex calls, but without altering `FindNode()` we have to do that - this code has to acquire the mutex before any call to `FindNode()`, dereference the returned pointer and then release the mutex:\r\n\r\n```diff\r\n bool CConnman::AlreadyConnectedToAddress(const CAddress& addr, ConnectionType conn_type, bool log)\r\n {\r\n     if (Params().IsTestChain()) return false; // allow bilateral connections on test chains\r\n     const CService service{MaybeFlipIPv6toCJDNS(addr)};\r\n     const bool inbound{conn_type == ConnectionType::INBOUND};\r\n     CNode* pnode{nullptr};\r\n+    LOCK(m_nodes_mutex);\r\n     if (inbound) {\r\n         // For accepting an inbound connection, check all existing connections by addr only.\r\n         pnode = FindNode(static_cast<CNetAddr>(service));\r\n     } else {\r\n         // For making an outbound connection, check the existing outbound connections\r\n         // by addr and port, and if none, then inbound connections by addr only.\r\n         pnode = FindNode(service.ToStringAddrPort(), /*inbound=*/false);\r\n         if (!pnode) pnode = FindNode(static_cast<CNetAddr>(service), /*inbound=*/true);\r\n     }\r\n     if (pnode && log) {\r\n         LogPrintLevel(BCLog::NET, inbound ? BCLog::Level::Debug : BCLog::Level::Info,\r\n                       \"Not %s new %s connection%s, already connected to %s %s %s peer=%d%s, version=%d, subver=%s\\n\",\r\n                       inbound ? \"accepting\" : \"opening\", ConnectionTypeAsString(conn_type),\r\n                       fLogIPs ? strprintf(\" %s %s\", inbound ? \"from\" : \"to\", addr.ToStringAddrPort()) : \"\",\r\n                       TransportTypeAsString(pnode->m_transport->GetInfo().transport_type),\r\n                       pnode->ConnectionTypeAsString(), GetNetworkName(pnode->ConnectedThroughNetwork()),\r\n                       pnode->GetId(), fLogIPs ? strprintf(\", peeraddr=%s\", pnode->addr.ToStringAddrPort()) : \"\",\r\n                       pnode->nVersion.load(), WITH_LOCK(pnode->m_subver_mutex, return pnode->cleanSubVer));\r\n     }\r\n-    return pnode;\r\n+    return pnode != nullptr;\r\n }\r\n```",
      "created_at": "2023-10-17T13:15:55Z",
      "updated_at": "2023-10-17T13:40:21Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28248#discussion_r1362096272",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1362096272"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28248"
        }
      },
      "start_line": null,
      "original_start_line": 425,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 392,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1362126888",
      "pull_request_review_id": 1682305820,
      "id": 1362126888,
      "node_id": "PRRC_kwDOABII585RMGgo",
      "diff_hunk": "@@ -364,11 +365,11 @@ bool IsLocal(const CService& addr)\n     return mapLocalHost.count(addr) > 0;\n }\n \n-CNode* CConnman::FindNode(const CNetAddr& ip)\n+CNode* CConnman::FindNode(const CNetAddr& ip, std::optional<bool> inbound)\n {\n     LOCK(m_nodes_mutex);\n     for (CNode* pnode : m_nodes) {\n-      if (static_cast<CNetAddr>(pnode->addr) == ip) {\n+        if (static_cast<CNetAddr>(pnode->addr) == ip && (!inbound || pnode->IsInboundConn() == inbound)) {",
      "path": "src/net.cpp",
      "position": null,
      "original_position": 18,
      "commit_id": "4238b6f0a7553ebc5cee6f7c77d3813193f7a322",
      "original_commit_id": "44ceac2ef9992c799dce22477a5884bd82ba9860",
      "in_reply_to_id": null,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "Here and in the other `FindNode()` using `std::optional<bool>` as a boolean is a bit unclear whether we are checking if the optional has a value or whether the value is true. I find this more clear:\r\n\r\n```suggestion\r\n        if (static_cast<CNetAddr>(pnode->addr) == ip && (!inbound.has_value() || pnode->IsInboundConn() == inbound.value())) {\r\n```",
      "created_at": "2023-10-17T13:35:36Z",
      "updated_at": "2023-10-17T13:40:21Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28248#discussion_r1362126888",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1362126888"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28248"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 372,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1362144275",
      "pull_request_review_id": 1682415998,
      "id": 1362144275,
      "node_id": "PRRC_kwDOABII585RMKwT",
      "diff_hunk": "@@ -364,11 +365,11 @@ bool IsLocal(const CService& addr)\n     return mapLocalHost.count(addr) > 0;\n }\n \n-CNode* CConnman::FindNode(const CNetAddr& ip)\n+CNode* CConnman::FindNode(const CNetAddr& ip, std::optional<bool> inbound)\n {\n     LOCK(m_nodes_mutex);\n     for (CNode* pnode : m_nodes) {\n-      if (static_cast<CNetAddr>(pnode->addr) == ip) {\n+        if (static_cast<CNetAddr>(pnode->addr) == ip && (!inbound || pnode->IsInboundConn() == inbound)) {",
      "path": "src/net.cpp",
      "position": null,
      "original_position": 18,
      "commit_id": "4238b6f0a7553ebc5cee6f7c77d3813193f7a322",
      "original_commit_id": "44ceac2ef9992c799dce22477a5884bd82ba9860",
      "in_reply_to_id": 1362126888,
      "user": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "<strike>Added new `FindNode` methods with 2 params rather than modifying the existing ones.</strike>\r\n\r\nDone.",
      "created_at": "2023-10-17T13:44:54Z",
      "updated_at": "2023-10-18T03:32:09Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28248#discussion_r1362144275",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1362144275"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28248"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 372,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1362147437",
      "pull_request_review_id": 1682420261,
      "id": 1362147437,
      "node_id": "PRRC_kwDOABII585RMLht",
      "diff_hunk": "@@ -408,9 +409,32 @@ CNode* CConnman::FindNode(const CService& addr)\n     return nullptr;\n }\n \n-bool CConnman::AlreadyConnectedToAddress(const CAddress& addr)\n+bool CConnman::AlreadyConnectedToAddress(const CAddress& addr, ConnectionType conn_type, bool log)\n {\n-    return FindNode(static_cast<CNetAddr>(addr)) || FindNode(addr.ToStringAddrPort());\n+    if (Params().IsTestChain()) return false; // allow bilateral connections on test chains\n+    const CService service{MaybeFlipIPv6toCJDNS(addr)};\n+    const bool inbound{conn_type == ConnectionType::INBOUND};\n+    CNode* pnode{nullptr};\n+    if (inbound) {\n+        // For accepting an inbound connection, check all existing connections by addr only.\n+        pnode = FindNode(static_cast<CNetAddr>(service));\n+    } else {\n+        // For making an outbound connection, check the existing outbound connections\n+        // by addr and port, and if none, then inbound connections by addr only.\n+        pnode = FindNode(service.ToStringAddrPort(), /*inbound=*/false);\n+        if (!pnode) pnode = FindNode(static_cast<CNetAddr>(service), /*inbound=*/true);\n+    }\n+    if (pnode && log) {\n+        LogPrintLevel(BCLog::NET, inbound ? BCLog::Level::Debug : BCLog::Level::Info,\n+                      \"Not %s new %s connection%s, already connected to %s %s %s peer=%d%s, version=%d, subver=%s\\n\",\n+                      inbound ? \"accepting\" : \"opening\", ConnectionTypeAsString(conn_type),\n+                      fLogIPs ? strprintf(\" %s %s\", inbound ? \"from\" : \"to\", addr.ToStringAddrPort()) : \"\",\n+                      TransportTypeAsString(pnode->m_transport->GetInfo().transport_type),\n+                      pnode->ConnectionTypeAsString(), GetNetworkName(pnode->ConnectedThroughNetwork()),",
      "path": "src/net.cpp",
      "position": null,
      "original_position": 63,
      "commit_id": "4238b6f0a7553ebc5cee6f7c77d3813193f7a322",
      "original_commit_id": "44ceac2ef9992c799dce22477a5884bd82ba9860",
      "in_reply_to_id": 1362096272,
      "user": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "Good point. (Several times I've been tempted to move the locking inside the `FindNode` methods to their callers.)",
      "created_at": "2023-10-17T13:46:39Z",
      "updated_at": "2023-10-17T13:46:40Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28248#discussion_r1362147437",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1362147437"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28248"
        }
      },
      "start_line": null,
      "original_start_line": 425,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 392,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1362154109",
      "pull_request_review_id": 1682429054,
      "id": 1362154109,
      "node_id": "PRRC_kwDOABII585RMNJ9",
      "diff_hunk": "@@ -101,6 +101,17 @@ typedef int64_t NodeId;\n struct AddedNodeParams {\n     std::string m_added_node;\n     bool m_use_v2transport;\n+    bool operator==(const AddedNodeParams& p) const\n+    {\n+        return m_added_node == p.m_added_node && m_use_v2transport == p.m_use_v2transport;\n+    }\n+};\n+\n+struct AddedNodeHasher {\n+    size_t operator()(const AddedNodeParams& p) const noexcept\n+    {\n+        return std::hash<std::string>()(p.m_added_node) ^ (std::hash<bool>()(p.m_use_v2transport) << 1);",
      "path": "src/net.h",
      "position": null,
      "original_position": 13,
      "commit_id": "4238b6f0a7553ebc5cee6f7c77d3813193f7a322",
      "original_commit_id": "2a9db3a16a93d497bfe496b7c35edac975ee81d2",
      "in_reply_to_id": 1356610866,
      "user": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "> Maybe to avoid returning `0` if first name and last name happen to be equal?\r\n\r\nIndeed, makes sense.\r\n\r\n> I think for the purposes of hashing `m_added_node_params` this suffices:\r\n> \r\n> ```c++\r\n>         return std::hash<std::string>()(p.m_added_node) ^ p.m_use_v2transport;\r\n> ```\r\n\r\n👍 \r\n\r\n> However `std::hash` is not used anywhere in the code (modulo in some tests and benchmarks). `CServiceHash` uses `CSipHasher`. If that is to be used here, then it would look like:\r\n> \r\n> ```c++\r\n>         CSipHasher hasher(m_salt_k0, m_salt_k1);\r\n>         hasher.Write(MakeUCharSpan(p.m_added_node));\r\n>         hasher.Write(p.m_use_v2transport);\r\n>         return static_cast<size_t>(hasher.Finalize());\r\n> ```\r\n> \r\n> Or use some of the stateless `Hash*` functions from `src/hash.h`.\r\n\r\n👍 \r\n",
      "created_at": "2023-10-17T13:50:12Z",
      "updated_at": "2023-10-17T13:50:13Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28248#discussion_r1362154109",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1362154109"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28248"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 113,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1362269096",
      "pull_request_review_id": 1682593573,
      "id": 1362269096,
      "node_id": "PRRC_kwDOABII585RMpOo",
      "diff_hunk": "@@ -101,6 +101,17 @@ typedef int64_t NodeId;\n struct AddedNodeParams {\n     std::string m_added_node;\n     bool m_use_v2transport;\n+    bool operator==(const AddedNodeParams& p) const\n+    {\n+        return m_added_node == p.m_added_node && m_use_v2transport == p.m_use_v2transport;\n+    }\n+};\n+\n+struct AddedNodeHasher {\n+    size_t operator()(const AddedNodeParams& p) const noexcept\n+    {\n+        return std::hash<std::string>()(p.m_added_node) ^ (std::hash<bool>()(p.m_use_v2transport) << 1);",
      "path": "src/net.h",
      "position": null,
      "original_position": 13,
      "commit_id": "4238b6f0a7553ebc5cee6f7c77d3813193f7a322",
      "original_commit_id": "2a9db3a16a93d497bfe496b7c35edac975ee81d2",
      "in_reply_to_id": 1356610866,
      "user": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "<strike>Updated with the `CSipHasher` version (thanks!)</strike>\r\n\r\nEdit: the addnode test in `test/functional/rpc_net.py` failed with the `CSipHasher` version suggestion (implemented like `CServiceHash` or `CNetAddrHash`).\r\n\r\nUsing `return std::hash<std::string>()(p.m_added_node) ^ p.m_use_v2transport;` in the latest push.",
      "created_at": "2023-10-17T14:53:54Z",
      "updated_at": "2023-10-24T02:19:05Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28248#discussion_r1362269096",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1362269096"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28248"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 113,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1363082393",
      "pull_request_review_id": 1683867144,
      "id": 1363082393,
      "node_id": "PRRC_kwDOABII585RPvyZ",
      "diff_hunk": "@@ -408,9 +409,32 @@ CNode* CConnman::FindNode(const CService& addr)\n     return nullptr;\n }\n \n-bool CConnman::AlreadyConnectedToAddress(const CAddress& addr)\n+bool CConnman::AlreadyConnectedToAddress(const CAddress& addr, ConnectionType conn_type, bool log)\n {\n-    return FindNode(static_cast<CNetAddr>(addr)) || FindNode(addr.ToStringAddrPort());\n+    if (Params().IsTestChain()) return false; // allow bilateral connections on test chains\n+    const CService service{MaybeFlipIPv6toCJDNS(addr)};\n+    const bool inbound{conn_type == ConnectionType::INBOUND};\n+    CNode* pnode{nullptr};\n+    if (inbound) {\n+        // For accepting an inbound connection, check all existing connections by addr only.\n+        pnode = FindNode(static_cast<CNetAddr>(service));\n+    } else {\n+        // For making an outbound connection, check the existing outbound connections\n+        // by addr and port, and if none, then inbound connections by addr only.\n+        pnode = FindNode(service.ToStringAddrPort(), /*inbound=*/false);",
      "path": "src/net.cpp",
      "position": null,
      "original_position": 54,
      "commit_id": "4238b6f0a7553ebc5cee6f7c77d3813193f7a322",
      "original_commit_id": "44ceac2ef9992c799dce22477a5884bd82ba9860",
      "in_reply_to_id": 1362086687,
      "user": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "Proposed an implementation:\r\n\r\n```cpp\r\npnode = FindNode(service, /*inbound=*/false);\r\nif (!pnode || !pnode->addr.IsValid()) pnode = FindNode(service.ToStringAddrPort(), /*inbound=*/false);\r\nif (!pnode || !pnode->addr.IsValid()) pnode = FindNode(static_cast<CNetAddr>(service), /*inbound=*/true);\r\n```",
      "created_at": "2023-10-18T03:15:37Z",
      "updated_at": "2023-10-18T03:15:37Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28248#discussion_r1363082393",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1363082393"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28248"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 424,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1363491489",
      "pull_request_review_id": 1684470261,
      "id": 1363491489,
      "node_id": "PRRC_kwDOABII585RRTqh",
      "diff_hunk": "@@ -408,9 +409,32 @@ CNode* CConnman::FindNode(const CService& addr)\n     return nullptr;\n }\n \n-bool CConnman::AlreadyConnectedToAddress(const CAddress& addr)\n+bool CConnman::AlreadyConnectedToAddress(const CAddress& addr, ConnectionType conn_type, bool log)\n {\n-    return FindNode(static_cast<CNetAddr>(addr)) || FindNode(addr.ToStringAddrPort());\n+    if (Params().IsTestChain()) return false; // allow bilateral connections on test chains\n+    const CService service{MaybeFlipIPv6toCJDNS(addr)};\n+    const bool inbound{conn_type == ConnectionType::INBOUND};\n+    CNode* pnode{nullptr};\n+    if (inbound) {\n+        // For accepting an inbound connection, check all existing connections by addr only.\n+        pnode = FindNode(static_cast<CNetAddr>(service));\n+    } else {\n+        // For making an outbound connection, check the existing outbound connections\n+        // by addr and port, and if none, then inbound connections by addr only.\n+        pnode = FindNode(service.ToStringAddrPort(), /*inbound=*/false);",
      "path": "src/net.cpp",
      "position": null,
      "original_position": 54,
      "commit_id": "4238b6f0a7553ebc5cee6f7c77d3813193f7a322",
      "original_commit_id": "44ceac2ef9992c799dce22477a5884bd82ba9860",
      "in_reply_to_id": 1362086687,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "Looks good. Can `CNode::addr` ever be invalid?",
      "created_at": "2023-10-18T08:41:50Z",
      "updated_at": "2023-10-18T08:41:50Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28248#discussion_r1363491489",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1363491489"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28248"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 424,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1369594937",
      "pull_request_review_id": 1693979860,
      "id": 1369594937,
      "node_id": "PRRC_kwDOABII585Rolw5",
      "diff_hunk": "@@ -408,9 +409,32 @@ CNode* CConnman::FindNode(const CService& addr)\n     return nullptr;\n }\n \n-bool CConnman::AlreadyConnectedToAddress(const CAddress& addr)\n+bool CConnman::AlreadyConnectedToAddress(const CAddress& addr, ConnectionType conn_type, bool log)\n {\n-    return FindNode(static_cast<CNetAddr>(addr)) || FindNode(addr.ToStringAddrPort());\n+    if (Params().IsTestChain()) return false; // allow bilateral connections on test chains\n+    const CService service{MaybeFlipIPv6toCJDNS(addr)};\n+    const bool inbound{conn_type == ConnectionType::INBOUND};\n+    CNode* pnode{nullptr};\n+    if (inbound) {\n+        // For accepting an inbound connection, check all existing connections by addr only.\n+        pnode = FindNode(static_cast<CNetAddr>(service));\n+    } else {\n+        // For making an outbound connection, check the existing outbound connections\n+        // by addr and port, and if none, then inbound connections by addr only.\n+        pnode = FindNode(service.ToStringAddrPort(), /*inbound=*/false);",
      "path": "src/net.cpp",
      "position": null,
      "original_position": 54,
      "commit_id": "4238b6f0a7553ebc5cee6f7c77d3813193f7a322",
      "original_commit_id": "44ceac2ef9992c799dce22477a5884bd82ba9860",
      "in_reply_to_id": 1362086687,
      "user": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "Not sure, so keeping as belt and suspenders.",
      "created_at": "2023-10-24T03:45:13Z",
      "updated_at": "2023-10-24T03:45:13Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28248#discussion_r1369594937",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1369594937"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28248"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 424,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1369597289",
      "pull_request_review_id": 1693983561,
      "id": 1369597289,
      "node_id": "PRRC_kwDOABII585RomVp",
      "diff_hunk": "@@ -408,9 +409,32 @@ CNode* CConnman::FindNode(const CService& addr)\n     return nullptr;\n }\n \n-bool CConnman::AlreadyConnectedToAddress(const CAddress& addr)\n+bool CConnman::AlreadyConnectedToAddress(const CAddress& addr, ConnectionType conn_type, bool log)\n {\n-    return FindNode(static_cast<CNetAddr>(addr)) || FindNode(addr.ToStringAddrPort());\n+    if (Params().IsTestChain()) return false; // allow bilateral connections on test chains\n+    const CService service{MaybeFlipIPv6toCJDNS(addr)};\n+    const bool inbound{conn_type == ConnectionType::INBOUND};\n+    CNode* pnode{nullptr};\n+    if (inbound) {\n+        // For accepting an inbound connection, check all existing connections by addr only.\n+        pnode = FindNode(static_cast<CNetAddr>(service));\n+    } else {\n+        // For making an outbound connection, check the existing outbound connections\n+        // by addr and port, and if none, then inbound connections by addr only.\n+        pnode = FindNode(service.ToStringAddrPort(), /*inbound=*/false);\n+        if (!pnode) pnode = FindNode(static_cast<CNetAddr>(service), /*inbound=*/true);\n+    }\n+    if (pnode && log) {\n+        LogPrintLevel(BCLog::NET, inbound ? BCLog::Level::Debug : BCLog::Level::Info,\n+                      \"Not %s new %s connection%s, already connected to %s %s %s peer=%d%s, version=%d, subver=%s\\n\",\n+                      inbound ? \"accepting\" : \"opening\", ConnectionTypeAsString(conn_type),\n+                      fLogIPs ? strprintf(\" %s %s\", inbound ? \"from\" : \"to\", addr.ToStringAddrPort()) : \"\",\n+                      TransportTypeAsString(pnode->m_transport->GetInfo().transport_type),\n+                      pnode->ConnectionTypeAsString(), GetNetworkName(pnode->ConnectedThroughNetwork()),",
      "path": "src/net.cpp",
      "position": null,
      "original_position": 63,
      "commit_id": "4238b6f0a7553ebc5cee6f7c77d3813193f7a322",
      "original_commit_id": "44ceac2ef9992c799dce22477a5884bd82ba9860",
      "in_reply_to_id": 1362096272,
      "user": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "> Dereferencing `pnode` after `FindNode()` has released `m_nodes_mutex` is not safe. I don't like adding recursive mutex calls, but without altering `FindNode()` we have to do that.\r\n\r\nDone, and moved the locking from the FindNode* methods to their callers.",
      "created_at": "2023-10-24T03:46:50Z",
      "updated_at": "2023-10-24T03:46:50Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28248#discussion_r1369597289",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1369597289"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28248"
        }
      },
      "start_line": null,
      "original_start_line": 425,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 392,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1370281097",
      "pull_request_review_id": 1695037517,
      "id": 1370281097,
      "node_id": "PRRC_kwDOABII585RrNSJ",
      "diff_hunk": "@@ -1819,6 +1819,14 @@ void CConnman::CreateNodeFromAcceptedSocket(std::unique_ptr<Sock>&& sock,\n     }\n \n     const bool inbound_onion = std::find(m_onion_binds.begin(), m_onion_binds.end(), addr_bind) != m_onion_binds.end();\n+\n+    // Do not accept inbound connections from peers already connected to us.",
      "path": "src/net.cpp",
      "position": null,
      "original_position": 5,
      "commit_id": "4238b6f0a7553ebc5cee6f7c77d3813193f7a322",
      "original_commit_id": "2ec971326d3de33455a626b8189e0375fc88061f",
      "in_reply_to_id": null,
      "user": {
        "login": "dergoegge",
        "id": 8077169,
        "node_id": "MDQ6VXNlcjgwNzcxNjk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8077169?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dergoegge",
        "html_url": "https://github.com/dergoegge",
        "followers_url": "https://api.github.com/users/dergoegge/followers",
        "following_url": "https://api.github.com/users/dergoegge/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dergoegge/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dergoegge/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dergoegge/subscriptions",
        "organizations_url": "https://api.github.com/users/dergoegge/orgs",
        "repos_url": "https://api.github.com/users/dergoegge/repos",
        "events_url": "https://api.github.com/users/dergoegge/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dergoegge/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "Just because the connections come from the same IP does no mean it is the same peer, e.g. multiple peers could be connecting to you through the same Tor exit relay.\r\n\r\nThis does not seem like a bug fix and more like a behavior change. Our inbound eviction logic should handle stuff like this and it probably already does.",
      "created_at": "2023-10-24T14:25:53Z",
      "updated_at": "2023-10-24T14:25:54Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28248#discussion_r1370281097",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1370281097"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28248"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1823,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1370290642",
      "pull_request_review_id": 1695050402,
      "id": 1370290642,
      "node_id": "PRRC_kwDOABII585RrPnS",
      "diff_hunk": "@@ -328,42 +329,67 @@ bool IsLocal(const CService& addr)\n     return mapLocalHost.count(addr) > 0;\n }\n \n-CNode* CConnman::FindNode(const CNetAddr& ip)\n+CNode* CConnman::FindNode(const CNetAddr& addr, std::optional<bool> inbound)\n {\n-    LOCK(m_nodes_mutex);\n+    AssertLockHeld(m_nodes_mutex);\n     for (CNode* pnode : m_nodes) {\n-      if (static_cast<CNetAddr>(pnode->addr) == ip) {\n+        if (static_cast<CNetAddr>(pnode->addr) == addr && (!inbound.has_value() || pnode->IsInboundConn() == inbound.value())) {\n             return pnode;\n         }\n     }\n     return nullptr;\n }\n \n-CNode* CConnman::FindNode(const std::string& addrName)\n+CNode* CConnman::FindNode(const std::string& addr, std::optional<bool> inbound)\n {\n-    LOCK(m_nodes_mutex);\n+    AssertLockHeld(m_nodes_mutex);\n     for (CNode* pnode : m_nodes) {\n-        if (pnode->m_addr_name == addrName) {\n+        if (pnode->m_addr_name == addr && (!inbound.has_value() || pnode->IsInboundConn() == inbound.value())) {\n             return pnode;\n         }\n     }\n     return nullptr;\n }\n \n-CNode* CConnman::FindNode(const CService& addr)\n+CNode* CConnman::FindNode(const CService& addr, std::optional<bool> inbound)\n {\n-    LOCK(m_nodes_mutex);\n+    AssertLockHeld(m_nodes_mutex);\n     for (CNode* pnode : m_nodes) {\n-        if (static_cast<CService>(pnode->addr) == addr) {\n+        if (static_cast<CService>(pnode->addr) == addr && (!inbound.has_value() || pnode->IsInboundConn() == inbound.value())) {\n             return pnode;\n         }\n     }\n     return nullptr;\n }\n \n-bool CConnman::AlreadyConnectedToAddress(const CAddress& addr)\n+bool CConnman::AlreadyConnectedToAddress(const CAddress& addr, ConnectionType conn_type, bool log)\n {\n-    return FindNode(static_cast<CNetAddr>(addr)) || FindNode(addr.ToStringAddrPort());\n+    if (Params().IsTestChain()) return false; // allow bilateral connections on test chains",
      "path": "src/net.cpp",
      "position": null,
      "original_position": 58,
      "commit_id": "4238b6f0a7553ebc5cee6f7c77d3813193f7a322",
      "original_commit_id": "f196b096f55f909e2bb63d5ff43bc3418c0ebbab",
      "in_reply_to_id": null,
      "user": {
        "login": "fanquake",
        "id": 863730,
        "node_id": "MDQ6VXNlcjg2MzczMA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/863730?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fanquake",
        "html_url": "https://github.com/fanquake",
        "followers_url": "https://api.github.com/users/fanquake/followers",
        "following_url": "https://api.github.com/users/fanquake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fanquake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fanquake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fanquake/subscriptions",
        "organizations_url": "https://api.github.com/users/fanquake/orgs",
        "repos_url": "https://api.github.com/users/fanquake/repos",
        "events_url": "https://api.github.com/users/fanquake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fanquake/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "```cpp\r\n    if (Params().IsTestChain()) return false; // allow bilateral connections on test chains\r\n```\r\n\r\nThis seems very out of place to me, and would also prevent writing certain types of tests?",
      "created_at": "2023-10-24T14:30:42Z",
      "updated_at": "2023-10-24T14:30:43Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28248#discussion_r1370290642",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1370290642"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28248"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 367,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1370295096",
      "pull_request_review_id": 1695055890,
      "id": 1370295096,
      "node_id": "PRRC_kwDOABII585RrQs4",
      "diff_hunk": "@@ -1819,6 +1819,14 @@ void CConnman::CreateNodeFromAcceptedSocket(std::unique_ptr<Sock>&& sock,\n     }\n \n     const bool inbound_onion = std::find(m_onion_binds.begin(), m_onion_binds.end(), addr_bind) != m_onion_binds.end();\n+\n+    // Do not accept inbound connections from peers already connected to us.",
      "path": "src/net.cpp",
      "position": null,
      "original_position": 5,
      "commit_id": "4238b6f0a7553ebc5cee6f7c77d3813193f7a322",
      "original_commit_id": "2ec971326d3de33455a626b8189e0375fc88061f",
      "in_reply_to_id": 1370281097,
      "user": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "Inbound tor peers are exempted from this check.  I do see many such redundant connection attempts logged when running this branch. In the case of I2P peers, needlessly accepting to build these tunnels can be expensive. As mentioned in the commit message, the other fixes in this PR may mitigate this behavior by our peers, but not for nodes running earlier versions of Bitcoin Core.",
      "created_at": "2023-10-24T14:32:46Z",
      "updated_at": "2023-10-24T14:32:47Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28248#discussion_r1370295096",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1370295096"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28248"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1823,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1370296681",
      "pull_request_review_id": 1695058000,
      "id": 1370296681,
      "node_id": "PRRC_kwDOABII585RrRFp",
      "diff_hunk": "@@ -328,42 +329,67 @@ bool IsLocal(const CService& addr)\n     return mapLocalHost.count(addr) > 0;\n }\n \n-CNode* CConnman::FindNode(const CNetAddr& ip)\n+CNode* CConnman::FindNode(const CNetAddr& addr, std::optional<bool> inbound)\n {\n-    LOCK(m_nodes_mutex);\n+    AssertLockHeld(m_nodes_mutex);\n     for (CNode* pnode : m_nodes) {\n-      if (static_cast<CNetAddr>(pnode->addr) == ip) {\n+        if (static_cast<CNetAddr>(pnode->addr) == addr && (!inbound.has_value() || pnode->IsInboundConn() == inbound.value())) {\n             return pnode;\n         }\n     }\n     return nullptr;\n }\n \n-CNode* CConnman::FindNode(const std::string& addrName)\n+CNode* CConnman::FindNode(const std::string& addr, std::optional<bool> inbound)\n {\n-    LOCK(m_nodes_mutex);\n+    AssertLockHeld(m_nodes_mutex);\n     for (CNode* pnode : m_nodes) {\n-        if (pnode->m_addr_name == addrName) {\n+        if (pnode->m_addr_name == addr && (!inbound.has_value() || pnode->IsInboundConn() == inbound.value())) {\n             return pnode;\n         }\n     }\n     return nullptr;\n }\n \n-CNode* CConnman::FindNode(const CService& addr)\n+CNode* CConnman::FindNode(const CService& addr, std::optional<bool> inbound)\n {\n-    LOCK(m_nodes_mutex);\n+    AssertLockHeld(m_nodes_mutex);\n     for (CNode* pnode : m_nodes) {\n-        if (static_cast<CService>(pnode->addr) == addr) {\n+        if (static_cast<CService>(pnode->addr) == addr && (!inbound.has_value() || pnode->IsInboundConn() == inbound.value())) {\n             return pnode;\n         }\n     }\n     return nullptr;\n }\n \n-bool CConnman::AlreadyConnectedToAddress(const CAddress& addr)\n+bool CConnman::AlreadyConnectedToAddress(const CAddress& addr, ConnectionType conn_type, bool log)\n {\n-    return FindNode(static_cast<CNetAddr>(addr)) || FindNode(addr.ToStringAddrPort());\n+    if (Params().IsTestChain()) return false; // allow bilateral connections on test chains",
      "path": "src/net.cpp",
      "position": null,
      "original_position": 58,
      "commit_id": "4238b6f0a7553ebc5cee6f7c77d3813193f7a322",
      "original_commit_id": "f196b096f55f909e2bb63d5ff43bc3418c0ebbab",
      "in_reply_to_id": 1370290642,
      "user": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "This is required currently for several of our p2p functional tests. They would need to be updated not to make bilateral connections.",
      "created_at": "2023-10-24T14:33:33Z",
      "updated_at": "2023-10-24T14:34:47Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28248#discussion_r1370296681",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1370296681"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28248"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 367,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1370301459",
      "pull_request_review_id": 1695064681,
      "id": 1370301459,
      "node_id": "PRRC_kwDOABII585RrSQT",
      "diff_hunk": "@@ -328,42 +329,67 @@ bool IsLocal(const CService& addr)\n     return mapLocalHost.count(addr) > 0;\n }\n \n-CNode* CConnman::FindNode(const CNetAddr& ip)\n+CNode* CConnman::FindNode(const CNetAddr& addr, std::optional<bool> inbound)\n {\n-    LOCK(m_nodes_mutex);\n+    AssertLockHeld(m_nodes_mutex);\n     for (CNode* pnode : m_nodes) {\n-      if (static_cast<CNetAddr>(pnode->addr) == ip) {\n+        if (static_cast<CNetAddr>(pnode->addr) == addr && (!inbound.has_value() || pnode->IsInboundConn() == inbound.value())) {\n             return pnode;\n         }\n     }\n     return nullptr;\n }\n \n-CNode* CConnman::FindNode(const std::string& addrName)\n+CNode* CConnman::FindNode(const std::string& addr, std::optional<bool> inbound)\n {\n-    LOCK(m_nodes_mutex);\n+    AssertLockHeld(m_nodes_mutex);\n     for (CNode* pnode : m_nodes) {\n-        if (pnode->m_addr_name == addrName) {\n+        if (pnode->m_addr_name == addr && (!inbound.has_value() || pnode->IsInboundConn() == inbound.value())) {\n             return pnode;\n         }\n     }\n     return nullptr;\n }\n \n-CNode* CConnman::FindNode(const CService& addr)\n+CNode* CConnman::FindNode(const CService& addr, std::optional<bool> inbound)\n {\n-    LOCK(m_nodes_mutex);\n+    AssertLockHeld(m_nodes_mutex);\n     for (CNode* pnode : m_nodes) {\n-        if (static_cast<CService>(pnode->addr) == addr) {\n+        if (static_cast<CService>(pnode->addr) == addr && (!inbound.has_value() || pnode->IsInboundConn() == inbound.value())) {\n             return pnode;\n         }\n     }\n     return nullptr;\n }\n \n-bool CConnman::AlreadyConnectedToAddress(const CAddress& addr)\n+bool CConnman::AlreadyConnectedToAddress(const CAddress& addr, ConnectionType conn_type, bool log)\n {\n-    return FindNode(static_cast<CNetAddr>(addr)) || FindNode(addr.ToStringAddrPort());\n+    if (Params().IsTestChain()) return false; // allow bilateral connections on test chains",
      "path": "src/net.cpp",
      "position": null,
      "original_position": 58,
      "commit_id": "4238b6f0a7553ebc5cee6f7c77d3813193f7a322",
      "original_commit_id": "f196b096f55f909e2bb63d5ff43bc3418c0ebbab",
      "in_reply_to_id": 1370290642,
      "user": {
        "login": "fanquake",
        "id": 863730,
        "node_id": "MDQ6VXNlcjg2MzczMA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/863730?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fanquake",
        "html_url": "https://github.com/fanquake",
        "followers_url": "https://api.github.com/users/fanquake/followers",
        "following_url": "https://api.github.com/users/fanquake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fanquake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fanquake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fanquake/subscriptions",
        "organizations_url": "https://api.github.com/users/fanquake/orgs",
        "repos_url": "https://api.github.com/users/fanquake/repos",
        "events_url": "https://api.github.com/users/fanquake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fanquake/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "Which tests?",
      "created_at": "2023-10-24T14:35:21Z",
      "updated_at": "2023-10-24T14:35:22Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28248#discussion_r1370301459",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1370301459"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28248"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 367,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1370307319",
      "pull_request_review_id": 1695073724,
      "id": 1370307319,
      "node_id": "PRRC_kwDOABII585RrTr3",
      "diff_hunk": "@@ -1819,6 +1819,14 @@ void CConnman::CreateNodeFromAcceptedSocket(std::unique_ptr<Sock>&& sock,\n     }\n \n     const bool inbound_onion = std::find(m_onion_binds.begin(), m_onion_binds.end(), addr_bind) != m_onion_binds.end();\n+\n+    // Do not accept inbound connections from peers already connected to us.",
      "path": "src/net.cpp",
      "position": null,
      "original_position": 5,
      "commit_id": "4238b6f0a7553ebc5cee6f7c77d3813193f7a322",
      "original_commit_id": "2ec971326d3de33455a626b8189e0375fc88061f",
      "in_reply_to_id": 1370281097,
      "user": {
        "login": "dergoegge",
        "id": 8077169,
        "node_id": "MDQ6VXNlcjgwNzcxNjk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8077169?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dergoegge",
        "html_url": "https://github.com/dergoegge",
        "followers_url": "https://api.github.com/users/dergoegge/followers",
        "following_url": "https://api.github.com/users/dergoegge/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dergoegge/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dergoegge/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dergoegge/subscriptions",
        "organizations_url": "https://api.github.com/users/dergoegge/orgs",
        "repos_url": "https://api.github.com/users/dergoegge/repos",
        "events_url": "https://api.github.com/users/dergoegge/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dergoegge/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "> Inbound tor peers are exempted from this check.\r\n\r\nWe don't have logic for detecting if someone is using Tor as a proxy to connect to the IPv4 network. Our \"inbound Tor\" classification simply refers to someone connecting to our hidden service.\r\n\r\nAnother example would be multiple peers connecting to us through the same VPN provider.",
      "created_at": "2023-10-24T14:38:13Z",
      "updated_at": "2023-10-24T14:40:14Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28248#discussion_r1370307319",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1370307319"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28248"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1823,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1370312562",
      "pull_request_review_id": 1695079464,
      "id": 1370312562,
      "node_id": "PRRC_kwDOABII585RrU9y",
      "diff_hunk": "@@ -328,42 +329,67 @@ bool IsLocal(const CService& addr)\n     return mapLocalHost.count(addr) > 0;\n }\n \n-CNode* CConnman::FindNode(const CNetAddr& ip)\n+CNode* CConnman::FindNode(const CNetAddr& addr, std::optional<bool> inbound)\n {\n-    LOCK(m_nodes_mutex);\n+    AssertLockHeld(m_nodes_mutex);\n     for (CNode* pnode : m_nodes) {\n-      if (static_cast<CNetAddr>(pnode->addr) == ip) {\n+        if (static_cast<CNetAddr>(pnode->addr) == addr && (!inbound.has_value() || pnode->IsInboundConn() == inbound.value())) {\n             return pnode;\n         }\n     }\n     return nullptr;\n }\n \n-CNode* CConnman::FindNode(const std::string& addrName)\n+CNode* CConnman::FindNode(const std::string& addr, std::optional<bool> inbound)\n {\n-    LOCK(m_nodes_mutex);\n+    AssertLockHeld(m_nodes_mutex);\n     for (CNode* pnode : m_nodes) {\n-        if (pnode->m_addr_name == addrName) {\n+        if (pnode->m_addr_name == addr && (!inbound.has_value() || pnode->IsInboundConn() == inbound.value())) {\n             return pnode;\n         }\n     }\n     return nullptr;\n }\n \n-CNode* CConnman::FindNode(const CService& addr)\n+CNode* CConnman::FindNode(const CService& addr, std::optional<bool> inbound)\n {\n-    LOCK(m_nodes_mutex);\n+    AssertLockHeld(m_nodes_mutex);\n     for (CNode* pnode : m_nodes) {\n-        if (static_cast<CService>(pnode->addr) == addr) {\n+        if (static_cast<CService>(pnode->addr) == addr && (!inbound.has_value() || pnode->IsInboundConn() == inbound.value())) {\n             return pnode;\n         }\n     }\n     return nullptr;\n }\n \n-bool CConnman::AlreadyConnectedToAddress(const CAddress& addr)\n+bool CConnman::AlreadyConnectedToAddress(const CAddress& addr, ConnectionType conn_type, bool log)\n {\n-    return FindNode(static_cast<CNetAddr>(addr)) || FindNode(addr.ToStringAddrPort());\n+    if (Params().IsTestChain()) return false; // allow bilateral connections on test chains",
      "path": "src/net.cpp",
      "position": null,
      "original_position": 58,
      "commit_id": "4238b6f0a7553ebc5cee6f7c77d3813193f7a322",
      "original_commit_id": "f196b096f55f909e2bb63d5ff43bc3418c0ebbab",
      "in_reply_to_id": 1370290642,
      "user": {
        "login": "fanquake",
        "id": 863730,
        "node_id": "MDQ6VXNlcjg2MzczMA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/863730?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fanquake",
        "html_url": "https://github.com/fanquake",
        "followers_url": "https://api.github.com/users/fanquake/followers",
        "following_url": "https://api.github.com/users/fanquake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fanquake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fanquake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fanquake/subscriptions",
        "organizations_url": "https://api.github.com/users/fanquake/orgs",
        "repos_url": "https://api.github.com/users/fanquake/repos",
        "events_url": "https://api.github.com/users/fanquake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fanquake/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "> They would need to be updated not to make bilateral connections.\r\n\r\nI would suggest updating the tests to account for the behaviour you've changed (it may also help to make the bug fixes clearer for reviewers); rather than introducing per-chain, networking functionality. This seems generally dangerous, and mostly unintuitive.",
      "created_at": "2023-10-24T14:39:44Z",
      "updated_at": "2023-10-24T14:39:44Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28248#discussion_r1370312562",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1370312562"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28248"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 367,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1370338677",
      "pull_request_review_id": 1695117966,
      "id": 1370338677,
      "node_id": "PRRC_kwDOABII585RrbV1",
      "diff_hunk": "@@ -1819,6 +1819,14 @@ void CConnman::CreateNodeFromAcceptedSocket(std::unique_ptr<Sock>&& sock,\n     }\n \n     const bool inbound_onion = std::find(m_onion_binds.begin(), m_onion_binds.end(), addr_bind) != m_onion_binds.end();\n+\n+    // Do not accept inbound connections from peers already connected to us.",
      "path": "src/net.cpp",
      "position": null,
      "original_position": 5,
      "commit_id": "4238b6f0a7553ebc5cee6f7c77d3813193f7a322",
      "original_commit_id": "2ec971326d3de33455a626b8189e0375fc88061f",
      "in_reply_to_id": 1370281097,
      "user": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "Ok, this could be dropped and deferred until later, to see if the other fixes resolve the behavior seen from peers (I think it's likely).",
      "created_at": "2023-10-24T14:47:53Z",
      "updated_at": "2023-10-24T14:47:54Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28248#discussion_r1370338677",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1370338677"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28248"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1823,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1370365935",
      "pull_request_review_id": 1695165495,
      "id": 1370365935,
      "node_id": "PRRC_kwDOABII585Rrh_v",
      "diff_hunk": "@@ -2783,18 +2833,21 @@ std::vector<AddedNodeInfo> CConnman::GetAddedNodeInfo() const\n     }\n \n     for (const auto& addr : lAddresses) {\n-        CService service(LookupNumeric(addr.m_added_node, GetDefaultPort(addr.m_added_node)));\n+        CService service{MaybeFlipIPv6toCJDNS(LookupNumeric(addr.m_added_node, GetDefaultPort(addr.m_added_node)))};",
      "path": "src/net.cpp",
      "position": 291,
      "original_position": 288,
      "commit_id": "4238b6f0a7553ebc5cee6f7c77d3813193f7a322",
      "original_commit_id": "f196b096f55f909e2bb63d5ff43bc3418c0ebbab",
      "in_reply_to_id": null,
      "user": {
        "login": "fanquake",
        "id": 863730,
        "node_id": "MDQ6VXNlcjg2MzczMA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/863730?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fanquake",
        "html_url": "https://github.com/fanquake",
        "followers_url": "https://api.github.com/users/fanquake/followers",
        "following_url": "https://api.github.com/users/fanquake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fanquake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fanquake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fanquake/subscriptions",
        "organizations_url": "https://api.github.com/users/fanquake/orgs",
        "repos_url": "https://api.github.com/users/fanquake/repos",
        "events_url": "https://api.github.com/users/fanquake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fanquake/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "> MaybeFlipIPv6toCJDNS\r\n\r\nIs there any way to better encapsulate this `MaybeFlipIPv6toCJDNS()` usage? This seems to be a frequent pattern (a number of additional calls were added in #27071), and it seems like something that would be better handled at a lower level, rather than having to continually remember to wrap various networking-related calls.\r\n\r\nI guess this is also able to remain broken is various ways because we don't have any specific tests for this functionality?",
      "created_at": "2023-10-24T15:04:19Z",
      "updated_at": "2023-10-24T15:05:46Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28248#discussion_r1370365935",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1370365935"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28248"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 2839,
      "original_line": 2839,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1370710929",
      "pull_request_review_id": 1695714255,
      "id": 1370710929,
      "node_id": "PRRC_kwDOABII585Rs2OR",
      "diff_hunk": "@@ -328,42 +329,67 @@ bool IsLocal(const CService& addr)\n     return mapLocalHost.count(addr) > 0;\n }\n \n-CNode* CConnman::FindNode(const CNetAddr& ip)\n+CNode* CConnman::FindNode(const CNetAddr& addr, std::optional<bool> inbound)\n {\n-    LOCK(m_nodes_mutex);\n+    AssertLockHeld(m_nodes_mutex);\n     for (CNode* pnode : m_nodes) {\n-      if (static_cast<CNetAddr>(pnode->addr) == ip) {\n+        if (static_cast<CNetAddr>(pnode->addr) == addr && (!inbound.has_value() || pnode->IsInboundConn() == inbound.value())) {\n             return pnode;\n         }\n     }\n     return nullptr;\n }\n \n-CNode* CConnman::FindNode(const std::string& addrName)\n+CNode* CConnman::FindNode(const std::string& addr, std::optional<bool> inbound)\n {\n-    LOCK(m_nodes_mutex);\n+    AssertLockHeld(m_nodes_mutex);\n     for (CNode* pnode : m_nodes) {\n-        if (pnode->m_addr_name == addrName) {\n+        if (pnode->m_addr_name == addr && (!inbound.has_value() || pnode->IsInboundConn() == inbound.value())) {\n             return pnode;\n         }\n     }\n     return nullptr;\n }\n \n-CNode* CConnman::FindNode(const CService& addr)\n+CNode* CConnman::FindNode(const CService& addr, std::optional<bool> inbound)\n {\n-    LOCK(m_nodes_mutex);\n+    AssertLockHeld(m_nodes_mutex);\n     for (CNode* pnode : m_nodes) {\n-        if (static_cast<CService>(pnode->addr) == addr) {\n+        if (static_cast<CService>(pnode->addr) == addr && (!inbound.has_value() || pnode->IsInboundConn() == inbound.value())) {\n             return pnode;\n         }\n     }\n     return nullptr;\n }\n \n-bool CConnman::AlreadyConnectedToAddress(const CAddress& addr)\n+bool CConnman::AlreadyConnectedToAddress(const CAddress& addr, ConnectionType conn_type, bool log)\n {\n-    return FindNode(static_cast<CNetAddr>(addr)) || FindNode(addr.ToStringAddrPort());\n+    if (Params().IsTestChain()) return false; // allow bilateral connections on test chains",
      "path": "src/net.cpp",
      "position": null,
      "original_position": 58,
      "commit_id": "4238b6f0a7553ebc5cee6f7c77d3813193f7a322",
      "original_commit_id": "f196b096f55f909e2bb63d5ff43bc3418c0ebbab",
      "in_reply_to_id": 1370290642,
      "user": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "Good points. Tests like `rpc_net.py`, `p2p_blockfilters.py`, `wallet_groups` and others, are making bilateral connections using `connect_nodes()`. For instance, from `rpc_net.py`:\r\n\r\n```\r\n        # By default, the test framework sets up an addnode connection from\r\n        # node 1 --> node0. By connecting node0 --> node 1, we're left with\r\n        # the two nodes being connected both ways.\r\n        # Topology will look like: node0 <--> node1\r\n```\r\n\r\nBehind the scenes, the test framework is calling RPC `addnode \"onetry\"` for the `connect_nodes` calls.  Our peer detection looked like it was intended to find already connected inbound peers, but in practice it did not in some cases, and one is when we make addnode connections in our testing.  Perhaps it is an expected use case.\r\n\r\nFor now, I updated `AlreadyConnectedToAddress()` to <strike>explicitly allow bilateral connections for manual peers</strike> and dropped the `IsTestChain()` check.\r\n\r\nEdit: the `AlreadyConnectedToAddress()` commit is too strict, which accounts for some of the test issues. Am updating and adding test coverage.",
      "created_at": "2023-10-24T19:19:08Z",
      "updated_at": "2023-10-25T16:21:30Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28248#discussion_r1370710929",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1370710929"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28248"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 367,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1370713054",
      "pull_request_review_id": 1695717544,
      "id": 1370713054,
      "node_id": "PRRC_kwDOABII585Rs2ve",
      "diff_hunk": "@@ -1819,6 +1819,14 @@ void CConnman::CreateNodeFromAcceptedSocket(std::unique_ptr<Sock>&& sock,\n     }\n \n     const bool inbound_onion = std::find(m_onion_binds.begin(), m_onion_binds.end(), addr_bind) != m_onion_binds.end();\n+\n+    // Do not accept inbound connections from peers already connected to us.",
      "path": "src/net.cpp",
      "position": null,
      "original_position": 5,
      "commit_id": "4238b6f0a7553ebc5cee6f7c77d3813193f7a322",
      "original_commit_id": "2ec971326d3de33455a626b8189e0375fc88061f",
      "in_reply_to_id": 1370281097,
      "user": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "Updated to only apply this check to inbound I2P peers we're already connected to, due to the resource cost of creating new tunnels.",
      "created_at": "2023-10-24T19:21:19Z",
      "updated_at": "2023-10-24T19:21:19Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28248#discussion_r1370713054",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1370713054"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28248"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1823,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1370713902",
      "pull_request_review_id": 1695718958,
      "id": 1370713902,
      "node_id": "PRRC_kwDOABII585Rs28u",
      "diff_hunk": "@@ -1814,6 +1814,16 @@ void CConnman::CreateNodeFromAcceptedSocket(std::unique_ptr<Sock>&& sock,\n     }\n \n     const bool inbound_onion = std::find(m_onion_binds.begin(), m_onion_binds.end(), addr_bind) != m_onion_binds.end();\n+\n+    // Don't accept inbound connections from peers already connected to us.\n+    // Skip this check for Tor, as their inbound/outbound addresses differ.\n+    if (!inbound_onion) {\n+        if (auto pnode = AlreadyConnectedToAddress(addr)) {",
      "path": "src/net.cpp",
      "position": null,
      "original_position": 8,
      "commit_id": "4238b6f0a7553ebc5cee6f7c77d3813193f7a322",
      "original_commit_id": "b97cfd18da8ad4e29319b8e3c84c3388cd75ff60",
      "in_reply_to_id": 1323646824,
      "user": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "Updated to only apply this check to inbound I2P peers we're already connected to, due to the resource cost of creating new tunnels.",
      "created_at": "2023-10-24T19:22:19Z",
      "updated_at": "2023-10-24T19:22:19Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28248#discussion_r1370713902",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1370713902"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28248"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1868,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1370747413",
      "pull_request_review_id": 1695774761,
      "id": 1370747413,
      "node_id": "PRRC_kwDOABII585Rs_IV",
      "diff_hunk": "@@ -2765,15 +2765,19 @@ std::vector<AddedNodeInfo> CConnman::GetAddedNodeInfo() const\n         std::copy(m_added_node_params.cbegin(), m_added_node_params.cend(), std::back_inserter(lAddresses));\n     }\n \n-\n-    // Build a map of all already connected addresses (by IP:port and by name) to inbound/outbound and resolved CService\n-    std::map<CService, bool> mapConnected;\n+    // Collect all addresses to which we are already connected.\n+    std::unordered_set<CNetAddr, CNetAddrHash> connected_to_inbound;",
      "path": "src/net.cpp",
      "position": 270,
      "original_position": 8,
      "commit_id": "4238b6f0a7553ebc5cee6f7c77d3813193f7a322",
      "original_commit_id": "d746231809814f52695a376bd77f4d06622289a4",
      "in_reply_to_id": null,
      "user": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "commit d746231809814f52695a376bd77f4d06622289a4 (`p2p, bugfix: detect all inbound connections in GetAddedNodeInfo()`):\r\n\r\nI'm not sure if this fixes a bug - comparing on the level of `CNetAddr` seems rather strict to me.\r\nFor example, I think that in the current form, we will not attempt to make a manual connection to an `addnode` localhost peer `127.0.0.1:XXXX` if we have any inbound tor peer. \r\nOr we wouldn't be able to be part of a larger local network built from manual connections that has both incoming and outgoing connections to different local peers.\r\n\r\nMore generally speaking, I think that it is very hard (impossible?) to ensure that there are no bidirectional connections without restricting legitimate use cases - and maybe not really necessary after all?\r\n ",
      "created_at": "2023-10-24T19:56:43Z",
      "updated_at": "2023-10-24T20:53:35Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28248#discussion_r1370747413",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1370747413"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28248"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 2818,
      "original_line": 2769,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1370787972",
      "pull_request_review_id": 1695774761,
      "id": 1370787972,
      "node_id": "PRRC_kwDOABII585RtJCE",
      "diff_hunk": "@@ -361,11 +361,38 @@ CNode* CConnman::FindNode(const CService& addr, std::optional<bool> inbound)\n     return nullptr;\n }\n \n-bool CConnman::AlreadyConnectedToAddress(const CAddress& addr)\n+bool CConnman::AlreadyConnectedToAddress(const CAddress& addr, ConnectionType conn_type, bool log)",
      "path": "src/net.cpp",
      "position": 55,
      "original_position": 5,
      "commit_id": "4238b6f0a7553ebc5cee6f7c77d3813193f7a322",
      "original_commit_id": "cb82a9285ccb58a1f8fef41c4ce664c5fe46fc94",
      "in_reply_to_id": null,
      "user": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "commit: `p2p, bugfix: correctly detect connected peers in AlreadyConnectedToAddress()`\r\nCould you list some examples of scenarios that are not working correctly currently and are improved by this? I'm trying to understand the impact of this commit better.",
      "created_at": "2023-10-24T20:41:09Z",
      "updated_at": "2023-10-24T20:53:47Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28248#discussion_r1370787972",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1370787972"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28248"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 365,
      "original_line": 364,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1371998088",
      "pull_request_review_id": 1697741856,
      "id": 1371998088,
      "node_id": "PRRC_kwDOABII585RxweI",
      "diff_hunk": "@@ -2765,15 +2765,19 @@ std::vector<AddedNodeInfo> CConnman::GetAddedNodeInfo() const\n         std::copy(m_added_node_params.cbegin(), m_added_node_params.cend(), std::back_inserter(lAddresses));\n     }\n \n-\n-    // Build a map of all already connected addresses (by IP:port and by name) to inbound/outbound and resolved CService\n-    std::map<CService, bool> mapConnected;\n+    // Collect all addresses to which we are already connected.\n+    std::unordered_set<CNetAddr, CNetAddrHash> connected_to_inbound;",
      "path": "src/net.cpp",
      "position": 270,
      "original_position": 8,
      "commit_id": "4238b6f0a7553ebc5cee6f7c77d3813193f7a322",
      "original_commit_id": "d746231809814f52695a376bd77f4d06622289a4",
      "in_reply_to_id": 1370747413,
      "user": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "Thanks for your feedback. Yes, it's too strict -- am updating and working today on writing tests to demonstrate and specify our needs.\r\n\r\nhttps://github.com/bitcoin/bitcoin/commit/d746231809814f52695a376bd77f4d06622289a4 aims to resolve issues like RPC `getaddednodeinfo` not detecting inbound peers that have different port numbers from the same peer connected as an outbound.\r\n\r\nFor instance, a cjdns addnode peer already connected in our inbounds as\r\n\r\n```\r\n[fc70:704d:b268:cdbf:d622:ea9f:db12:859e]:45594\r\n```\r\n\r\nisn't detected as connected and returned as such by the `getaddednodeinfo` RPC\r\n\r\n```\r\n  {\r\n    \"addednode\": \"fc70:704d:b268:cdbf:d622:ea9f:db12:859e\",\r\n    \"connected\": false,\r\n    \"addresses\": [\r\n    ]\r\n  },\r\n```\r\n\r\nwhen we would expect it to return\r\n\r\n```\r\n  {\r\n    \"addednode\": \"fc70:704d:b268:cdbf:d622:ea9f:db12:859e\",\r\n    \"connected\": true,\r\n    \"addresses\": [\r\n      {\r\n        \"address\": \"[fc70:704d:b268:cdbf:d622:ea9f:db12:859e]:8333\",\r\n        \"connected\": \"inbound\"\r\n      }\r\n    ]\r\n  },\r\n```\r\n\r\nA case like that could also lead to our addednodes thread continually attempting to connect to the inbound peer without detecting that we're already connected to it.",
      "created_at": "2023-10-25T15:58:08Z",
      "updated_at": "2023-10-25T17:22:57Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28248#discussion_r1371998088",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1371998088"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28248"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 2818,
      "original_line": 2769,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1372002701",
      "pull_request_review_id": 1697749018,
      "id": 1372002701,
      "node_id": "PRRC_kwDOABII585RxxmN",
      "diff_hunk": "@@ -361,11 +361,38 @@ CNode* CConnman::FindNode(const CService& addr, std::optional<bool> inbound)\n     return nullptr;\n }\n \n-bool CConnman::AlreadyConnectedToAddress(const CAddress& addr)\n+bool CConnman::AlreadyConnectedToAddress(const CAddress& addr, ConnectionType conn_type, bool log)",
      "path": "src/net.cpp",
      "position": 55,
      "original_position": 5,
      "commit_id": "4238b6f0a7553ebc5cee6f7c77d3813193f7a322",
      "original_commit_id": "cb82a9285ccb58a1f8fef41c4ce664c5fe46fc94",
      "in_reply_to_id": 1370787972,
      "user": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "Agree, am updating this commit and writing tests to demonstrate and specify our needs.",
      "created_at": "2023-10-25T16:01:44Z",
      "updated_at": "2023-10-25T16:01:44Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28248#discussion_r1372002701",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1372002701"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28248"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 365,
      "original_line": 364,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1372014659",
      "pull_request_review_id": 1697767634,
      "id": 1372014659,
      "node_id": "PRRC_kwDOABII585Rx0hD",
      "diff_hunk": "@@ -2783,18 +2833,21 @@ std::vector<AddedNodeInfo> CConnman::GetAddedNodeInfo() const\n     }\n \n     for (const auto& addr : lAddresses) {\n-        CService service(LookupNumeric(addr.m_added_node, GetDefaultPort(addr.m_added_node)));\n+        CService service{MaybeFlipIPv6toCJDNS(LookupNumeric(addr.m_added_node, GetDefaultPort(addr.m_added_node)))};",
      "path": "src/net.cpp",
      "position": 291,
      "original_position": 288,
      "commit_id": "4238b6f0a7553ebc5cee6f7c77d3813193f7a322",
      "original_commit_id": "f196b096f55f909e2bb63d5ff43bc3418c0ebbab",
      "in_reply_to_id": 1370365935,
      "user": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "Yes, there are more than a dozen of these. Perhaps it can be part of a `CNetAddr` ctor after adding test coverage.",
      "created_at": "2023-10-25T16:11:17Z",
      "updated_at": "2023-10-25T16:11:17Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28248#discussion_r1372014659",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1372014659"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28248"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 2839,
      "original_line": 2839,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1376321703",
      "pull_request_review_id": 1704296850,
      "id": 1376321703,
      "node_id": "PRRC_kwDOABII585SCQCn",
      "diff_hunk": "@@ -1819,6 +1819,14 @@ void CConnman::CreateNodeFromAcceptedSocket(std::unique_ptr<Sock>&& sock,\n     }\n \n     const bool inbound_onion = std::find(m_onion_binds.begin(), m_onion_binds.end(), addr_bind) != m_onion_binds.end();\n+\n+    // Do not accept inbound connections from peers already connected to us.",
      "path": "src/net.cpp",
      "position": null,
      "original_position": 5,
      "commit_id": "4238b6f0a7553ebc5cee6f7c77d3813193f7a322",
      "original_commit_id": "2ec971326d3de33455a626b8189e0375fc88061f",
      "in_reply_to_id": 1370281097,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "Yes, different peers can be connecting to us through the same NAT box, Tor exit node, or VPN server. Or it might be the same peer indeed. I think that the pros of assuming it is the same peer out-weight the pros of assuming it is not. However, I can see how this can be arguable and without having some solid numbers to back either argument maybe best to keep this unchanged.",
      "created_at": "2023-10-30T14:33:27Z",
      "updated_at": "2023-10-30T14:33:28Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28248#discussion_r1376321703",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1376321703"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28248"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1823,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1379352136",
      "pull_request_review_id": 1709115294,
      "id": 1379352136,
      "node_id": "PRRC_kwDOABII585SNz5I",
      "diff_hunk": "@@ -1819,6 +1819,14 @@ void CConnman::CreateNodeFromAcceptedSocket(std::unique_ptr<Sock>&& sock,\n     }\n \n     const bool inbound_onion = std::find(m_onion_binds.begin(), m_onion_binds.end(), addr_bind) != m_onion_binds.end();\n+\n+    // Do not accept inbound connections from peers already connected to us.",
      "path": "src/net.cpp",
      "position": null,
      "original_position": 5,
      "commit_id": "4238b6f0a7553ebc5cee6f7c77d3813193f7a322",
      "original_commit_id": "2ec971326d3de33455a626b8189e0375fc88061f",
      "in_reply_to_id": 1370281097,
      "user": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "Yes, I've been running this branch with its logging on for several months, and grepping the log turns up dozens, sometimes hundreds, of connection attempts per day from one or two inbound I2P peers on a given day that are already connected. I'm not sure at the moment of writing whether the behavior is malicious or due to buggy outbound logic (which would only be fixed in future releases and not existing releases connecting to us, though).",
      "created_at": "2023-11-01T21:29:26Z",
      "updated_at": "2023-11-14T20:57:29Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28248#discussion_r1379352136",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1379352136"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28248"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1823,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1382611940",
      "pull_request_review_id": 1714022287,
      "id": 1382611940,
      "node_id": "PRRC_kwDOABII585SaPvk",
      "diff_hunk": "@@ -1823,6 +1823,13 @@ void CConnman::CreateNodeFromAcceptedSocket(std::unique_ptr<Sock>&& sock,\n     }\n \n     const bool inbound_onion = std::find(m_onion_binds.begin(), m_onion_binds.end(), addr_bind) != m_onion_binds.end();\n+\n+    // Do not accept inbound connections from I2P peers already connected to us,\n+    // as creating new tunnels is expensive.\n+    if (addr.IsI2P() && AlreadyConnectedToAddress(addr, ConnectionType::INBOUND)) {\n+        return;\n+    }",
      "path": "src/net.cpp",
      "position": 154,
      "original_position": 9,
      "commit_id": "4238b6f0a7553ebc5cee6f7c77d3813193f7a322",
      "original_commit_id": "225b6c868d1c2562396efcc48f92004a4207775d",
      "in_reply_to_id": null,
      "user": {
        "login": "dergoegge",
        "id": 8077169,
        "node_id": "MDQ6VXNlcjgwNzcxNjk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8077169?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dergoegge",
        "html_url": "https://github.com/dergoegge",
        "followers_url": "https://api.github.com/users/dergoegge/followers",
        "following_url": "https://api.github.com/users/dergoegge/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dergoegge/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dergoegge/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dergoegge/subscriptions",
        "organizations_url": "https://api.github.com/users/dergoegge/orgs",
        "repos_url": "https://api.github.com/users/dergoegge/repos",
        "events_url": "https://api.github.com/users/dergoegge/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dergoegge/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "Isn't the tunnel already created at this point? Afaik the tunnel creation is handled by the i2p gateway (e.g. i2pd) not on our side.\r\n\r\nI'm also not sure what we are protecting against here. Assuming tunnel creation is sufficiently DoSy (which it shouldn't be), this isn't enough to prevent attacks as an attacker could just not connect from the same address.",
      "created_at": "2023-11-05T17:12:00Z",
      "updated_at": "2023-11-05T17:21:02Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28248#discussion_r1382611940",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1382611940"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28248"
        }
      },
      "start_line": 1830,
      "original_start_line": 1827,
      "start_side": "RIGHT",
      "line": 1834,
      "original_line": 1831,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1394406381",
      "pull_request_review_id": 1732357605,
      "id": 1394406381,
      "node_id": "PRRC_kwDOABII585THPPt",
      "diff_hunk": "@@ -1823,6 +1823,13 @@ void CConnman::CreateNodeFromAcceptedSocket(std::unique_ptr<Sock>&& sock,\n     }\n \n     const bool inbound_onion = std::find(m_onion_binds.begin(), m_onion_binds.end(), addr_bind) != m_onion_binds.end();\n+\n+    // Do not accept inbound connections from I2P peers already connected to us,\n+    // as creating new tunnels is expensive.\n+    if (addr.IsI2P() && AlreadyConnectedToAddress(addr, ConnectionType::INBOUND)) {\n+        return;\n+    }",
      "path": "src/net.cpp",
      "position": 154,
      "original_position": 9,
      "commit_id": "4238b6f0a7553ebc5cee6f7c77d3813193f7a322",
      "original_commit_id": "225b6c868d1c2562396efcc48f92004a4207775d",
      "in_reply_to_id": 1382611940,
      "user": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "Yes, I'm going to punt on this commit for now.  Seeing dozens to hundreds of connection attempts per day from, say, 1-2 inbound I2P peers that are already connected. However, I'm not sure these peers are malicious, and the behavior might be due to other issues in our already connected detection or outbound logic addressed in this PR.",
      "created_at": "2023-11-15T15:54:20Z",
      "updated_at": "2023-11-15T15:54:20Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28248#discussion_r1394406381",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1394406381"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28248"
        }
      },
      "start_line": 1830,
      "original_start_line": 1827,
      "start_side": "RIGHT",
      "line": 1834,
      "original_line": 1831,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1394675893",
      "pull_request_review_id": 1732763225,
      "id": 1394675893,
      "node_id": "PRRC_kwDOABII585TIRC1",
      "diff_hunk": "@@ -2765,15 +2765,19 @@ std::vector<AddedNodeInfo> CConnman::GetAddedNodeInfo() const\n         std::copy(m_added_node_params.cbegin(), m_added_node_params.cend(), std::back_inserter(lAddresses));\n     }\n \n-\n-    // Build a map of all already connected addresses (by IP:port and by name) to inbound/outbound and resolved CService\n-    std::map<CService, bool> mapConnected;\n+    // Collect all addresses to which we are already connected.\n+    std::unordered_set<CNetAddr, CNetAddrHash> connected_to_inbound;",
      "path": "src/net.cpp",
      "position": 270,
      "original_position": 8,
      "commit_id": "4238b6f0a7553ebc5cee6f7c77d3813193f7a322",
      "original_commit_id": "d746231809814f52695a376bd77f4d06622289a4",
      "in_reply_to_id": 1370747413,
      "user": {
        "login": "jonatack",
        "id": 2415484,
        "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonatack",
        "html_url": "https://github.com/jonatack",
        "followers_url": "https://api.github.com/users/jonatack/followers",
        "following_url": "https://api.github.com/users/jonatack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonatack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonatack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
        "organizations_url": "https://api.github.com/users/jonatack/orgs",
        "repos_url": "https://api.github.com/users/jonatack/repos",
        "events_url": "https://api.github.com/users/jonatack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonatack/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "After adding unit tests, this `CNetAddr` logic seems needed not in `GetAddedNodeInfo()` but only in `AddNode()`, where it is simpler and may be sufficient to compare by `CNetAddr` for cjdns entries only, in order to handle them correctly.\r\n\r\n```diff\r\n bool CConnman::AddNode(const AddedNodeParams& add)\r\n {\r\n-    const CService resolved(LookupNumeric(add.m_added_node, GetDefaultPort(add.m_added_node)));\r\n+    const CService resolved{MaybeFlipIPv6toCJDNS(LookupNumeric(add.m_added_node, GetDefaultPort(add.m_added_node)))};\r\n     const bool resolved_is_valid{resolved.IsValid()};\r\n \r\n     LOCK(m_added_nodes_mutex);\r\n     for (const auto& it : m_added_node_params) {\r\n-        if (add.m_added_node == it.m_added_node || (resolved_is_valid && resolved == LookupNumeric(it.m_added_node, GetDefaultPort(it.m_added_node)))) return false;\r\n+        if (add.m_added_node == it.m_added_node) return false;\r\n+        if (!resolved_is_valid) continue;\r\n+        const CService service{MaybeFlipIPv6toCJDNS(LookupNumeric(it.m_added_node, GetDefaultPort(it.m_added_node)))};\r\n+        if (resolved == service) return false;\r\n+        if (resolved.IsCJDNS() && static_cast<CNetAddr>(resolved) == static_cast<CNetAddr>(service)) return false;\r\n     }\r\n```\r\n",
      "created_at": "2023-11-15T19:22:43Z",
      "updated_at": "2023-11-15T19:33:14Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/28248#discussion_r1394675893",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1394675893"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/28248"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 2818,
      "original_line": 2769,
      "side": "RIGHT"
    }
  ]
}
{
  "type": "pull",
  "pull": {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/32423",
    "id": 2501009601,
    "node_id": "PR_kwDOABII586VEmDB",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/32423",
    "diff_url": "https://github.com/bitcoin/bitcoin/pull/32423.diff",
    "patch_url": "https://github.com/bitcoin/bitcoin/pull/32423.patch",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/32423",
    "commits_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/32423/commits",
    "review_comments_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/32423/comments",
    "review_comment_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments%7B/number%7D",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/32423/comments",
    "statuses_url": "https://api.github.com/repos/bitcoin/bitcoin/statuses/e49a7274a2141dcb9e188bc4b45c2d7b928ccecd",
    "number": 32423,
    "state": "open",
    "locked": false,
    "maintainer_can_modify": false,
    "title": "rpc: Undeprecate rpcuser/rpcpassword, store all credentials hashed in memory",
    "user": {
      "login": "laanwj",
      "id": 126646,
      "node_id": "MDQ6VXNlcjEyNjY0Ng==",
      "avatar_url": "https://avatars.githubusercontent.com/u/126646?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/laanwj",
      "html_url": "https://github.com/laanwj",
      "followers_url": "https://api.github.com/users/laanwj/followers",
      "following_url": "https://api.github.com/users/laanwj/following%7B/other_user%7D",
      "gists_url": "https://api.github.com/users/laanwj/gists%7B/gist_id%7D",
      "starred_url": "https://api.github.com/users/laanwj/starred%7B/owner%7D%7B/repo%7D",
      "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
      "organizations_url": "https://api.github.com/users/laanwj/orgs",
      "repos_url": "https://api.github.com/users/laanwj/repos",
      "events_url": "https://api.github.com/users/laanwj/events%7B/privacy%7D",
      "received_events_url": "https://api.github.com/users/laanwj/received_events",
      "type": "User",
      "site_admin": false,
      "patch_url": null
    },
    "body": "This PR does two things:\r\n\r\n### Undeprecate rpcuser/rpcpassword, change message to security warning\r\n\r\nBack in 2015, in https://github.com/bitcoin/bitcoin/pull/7044, we added configuration option `rpcauth` for multiple RPC users. At the same time the old settings for single-user configuration `rpcuser` and `rpcpassword` were \"soon\" to be deprecated.\r\n\r\nThe main reason for this deprecation is that while `rpcpassword` stores the password in plain text, `rpcauth` stores a hash, so it doesn't appear in the configuration in plain text.\r\n\r\nAs the options are still in active use, actually removing them is expected to be a hassle to many, and it's not clear that is worth it. As for the security risk, in many kinds of setups (no wallet, containerized, single-user-single-application, local-only, etc) it is an unlikely point of escalation.\r\n\r\nIn the end, it is good to encourage secure practices, but it is the responsibility of the user. Log a clear warning but remove the deprecation notice (this is also the only place where the options appear as deprecated, they were never marked as such in the -help output).\r\n\r\n<hr>\r\n\r\n### Store all credentials hashed in memory\r\n\r\nThis gets rid of the special-casing of `strRPCUserColonPass` by hashing cookies as well as manually provided `-rpcuser`/`-rpcpassword` with a random salt before storing them.\r\n\r\nAlso take the opportunity to modernize the surrounding code a bit. There should be no end-user visible differences in behavior.\r\n\r\n<hr>\r\n\r\nCloses #29240.",
    "labels": [
      {
        "id": 98279177,
        "node_id": "MDU6TGFiZWw5ODI3OTE3Nw==",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/RPC/REST/ZMQ",
        "name": "RPC/REST/ZMQ",
        "color": "0052cc",
        "default": false
      }
    ],
    "created_at": "2025-05-06T09:31:45Z",
    "updated_at": "2025-05-09T15:07:40Z",
    "mergeable_state": "unknown",
    "merged": false,
    "merge_commit_sha": "62f78b5358898e5e78325c1e705f065b15d2f3de",
    "assignees": [],
    "requested_reviewers": [
      {
        "login": "Sjors",
        "id": 10217,
        "node_id": "MDQ6VXNlcjEwMjE3",
        "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Sjors",
        "html_url": "https://github.com/Sjors",
        "followers_url": "https://api.github.com/users/Sjors/followers",
        "following_url": "https://api.github.com/users/Sjors/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Sjors/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Sjors/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
        "organizations_url": "https://api.github.com/users/Sjors/orgs",
        "repos_url": "https://api.github.com/users/Sjors/repos",
        "events_url": "https://api.github.com/users/Sjors/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Sjors/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      }
    ],
    "requested_teams": [],
    "head": {
      "label": "laanwj:2025-05-remove-rpcpassword-deprecation",
      "ref": "2025-05-remove-rpcpassword-deprecation",
      "sha": "e49a7274a2141dcb9e188bc4b45c2d7b928ccecd",
      "user": {
        "login": "laanwj",
        "id": 126646,
        "node_id": "MDQ6VXNlcjEyNjY0Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/126646?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/laanwj",
        "html_url": "https://github.com/laanwj",
        "followers_url": "https://api.github.com/users/laanwj/followers",
        "following_url": "https://api.github.com/users/laanwj/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/laanwj/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/laanwj/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
        "organizations_url": "https://api.github.com/users/laanwj/orgs",
        "repos_url": "https://api.github.com/users/laanwj/repos",
        "events_url": "https://api.github.com/users/laanwj/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/laanwj/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "repo": {
        "id": 1750308,
        "node_id": "MDEwOlJlcG9zaXRvcnkxNzUwMzA4",
        "name": "bitcoin",
        "full_name": "laanwj/bitcoin",
        "owner": {
          "login": "laanwj",
          "id": 126646,
          "node_id": "MDQ6VXNlcjEyNjY0Ng==",
          "avatar_url": "https://avatars.githubusercontent.com/u/126646?v=4",
          "gravatar_id": "",
          "url": "https://api.github.com/users/laanwj",
          "html_url": "https://github.com/laanwj",
          "followers_url": "https://api.github.com/users/laanwj/followers",
          "following_url": "https://api.github.com/users/laanwj/following%7B/other_user%7D",
          "gists_url": "https://api.github.com/users/laanwj/gists%7B/gist_id%7D",
          "starred_url": "https://api.github.com/users/laanwj/starred%7B/owner%7D%7B/repo%7D",
          "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
          "organizations_url": "https://api.github.com/users/laanwj/orgs",
          "repos_url": "https://api.github.com/users/laanwj/repos",
          "events_url": "https://api.github.com/users/laanwj/events%7B/privacy%7D",
          "received_events_url": "https://api.github.com/users/laanwj/received_events",
          "type": "User",
          "site_admin": false,
          "patch_url": null
        },
        "private": false,
        "html_url": "https://github.com/laanwj/bitcoin",
        "description": "Laanwj's Bitcoin Core fork",
        "fork": true,
        "url": "https://api.github.com/repos/laanwj/bitcoin",
        "archive_url": "https://api.github.com/repos/laanwj/bitcoin/%7Barchive_format%7D%7B/ref%7D",
        "assignees_url": "https://api.github.com/repos/laanwj/bitcoin/assignees%7B/user%7D",
        "blobs_url": "https://api.github.com/repos/laanwj/bitcoin/git/blobs%7B/sha%7D",
        "branches_url": "https://api.github.com/repos/laanwj/bitcoin/branches%7B/branch%7D",
        "collaborators_url": "https://api.github.com/repos/laanwj/bitcoin/collaborators%7B/collaborator%7D",
        "comments_url": "https://api.github.com/repos/laanwj/bitcoin/comments%7B/number%7D",
        "commits_url": "https://api.github.com/repos/laanwj/bitcoin/commits%7B/sha%7D",
        "compare_url": "https://api.github.com/repos/laanwj/bitcoin/compare/%7Bbase%7D...%7Bhead%7D",
        "contents_url": "https://api.github.com/repos/laanwj/bitcoin/contents/%7B+path%7D",
        "contributors_url": "https://api.github.com/repos/laanwj/bitcoin/contributors",
        "deployments_url": "https://api.github.com/repos/laanwj/bitcoin/deployments",
        "downloads_url": "https://api.github.com/repos/laanwj/bitcoin/downloads",
        "events_url": "https://api.github.com/repos/laanwj/bitcoin/events",
        "forks_url": "https://api.github.com/repos/laanwj/bitcoin/forks",
        "git_commits_url": "https://api.github.com/repos/laanwj/bitcoin/git/commits%7B/sha%7D",
        "git_refs_url": "https://api.github.com/repos/laanwj/bitcoin/git/refs%7B/sha%7D",
        "git_tags_url": "https://api.github.com/repos/laanwj/bitcoin/git/tags%7B/sha%7D",
        "git_url": "git://github.com/laanwj/bitcoin.git",
        "issue_comment_url": "https://api.github.com/repos/laanwj/bitcoin/issues/comments%7B/number%7D",
        "issue_events_url": "https://api.github.com/repos/laanwj/bitcoin/issues/events%7B/number%7D",
        "issues_url": "https://api.github.com/repos/laanwj/bitcoin/issues%7B/number%7D",
        "keys_url": "https://api.github.com/repos/laanwj/bitcoin/keys%7B/key_id%7D",
        "labels_url": "https://api.github.com/repos/laanwj/bitcoin/labels%7B/name%7D",
        "languages_url": "https://api.github.com/repos/laanwj/bitcoin/languages",
        "merges_url": "https://api.github.com/repos/laanwj/bitcoin/merges",
        "milestones_url": "https://api.github.com/repos/laanwj/bitcoin/milestones%7B/number%7D",
        "notifications_url": "https://api.github.com/repos/laanwj/bitcoin/notifications%7B?since,all,participating}",
        "pulls_url": "https://api.github.com/repos/laanwj/bitcoin/pulls%7B/number%7D",
        "releases_url": "https://api.github.com/repos/laanwj/bitcoin/releases%7B/id%7D",
        "ssh_url": "git@github.com:laanwj/bitcoin.git",
        "stargazers_url": "https://api.github.com/repos/laanwj/bitcoin/stargazers",
        "statuses_url": "https://api.github.com/repos/laanwj/bitcoin/statuses/%7Bsha%7D",
        "subscribers_url": "https://api.github.com/repos/laanwj/bitcoin/subscribers",
        "subscription_url": "https://api.github.com/repos/laanwj/bitcoin/subscription",
        "tags_url": "https://api.github.com/repos/laanwj/bitcoin/tags",
        "teams_url": "https://api.github.com/repos/laanwj/bitcoin/teams",
        "trees_url": "https://api.github.com/repos/laanwj/bitcoin/git/trees%7B/sha%7D",
        "clone_url": "https://github.com/laanwj/bitcoin.git",
        "hooks_url": "https://api.github.com/repos/laanwj/bitcoin/hooks",
        "svn_url": "https://github.com/laanwj/bitcoin",
        "homepage": "",
        "forks_count": 14,
        "stargazers_count": 44,
        "watchers_count": 44,
        "size": 252285,
        "default_branch": "readme",
        "open_issues_count": 0,
        "is_template": false,
        "topics": [],
        "has_issues": false,
        "has_projects": true,
        "has_wiki": true,
        "has_pages": false,
        "has_downloads": false,
        "archived": false,
        "disabled": false,
        "visibility": "public",
        "pushed_at": "2025-05-09T15:07:39Z",
        "created_at": "2011-05-15T07:09:54Z",
        "updated_at": "2025-05-09T12:27:44Z",
        "allow_forking": true
      }
    },
    "base": {
      "label": "bitcoin:master",
      "ref": "master",
      "sha": "b070ce16966fe18eb68f886ab9ca02d1d05a2f2a",
      "user": {
        "login": "bitcoin",
        "id": 528860,
        "node_id": "MDEyOk9yZ2FuaXphdGlvbjUyODg2MA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/528860?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/bitcoin",
        "html_url": "https://github.com/bitcoin",
        "followers_url": "https://api.github.com/users/bitcoin/followers",
        "following_url": "https://api.github.com/users/bitcoin/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/bitcoin/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/bitcoin/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/bitcoin/subscriptions",
        "organizations_url": "https://api.github.com/users/bitcoin/orgs",
        "repos_url": "https://api.github.com/users/bitcoin/repos",
        "events_url": "https://api.github.com/users/bitcoin/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/bitcoin/received_events",
        "type": "Organization",
        "site_admin": false,
        "patch_url": null
      },
      "repo": {
        "id": 1181927,
        "node_id": "MDEwOlJlcG9zaXRvcnkxMTgxOTI3",
        "name": "bitcoin",
        "full_name": "bitcoin/bitcoin",
        "owner": {
          "login": "bitcoin",
          "id": 528860,
          "node_id": "MDEyOk9yZ2FuaXphdGlvbjUyODg2MA==",
          "avatar_url": "https://avatars.githubusercontent.com/u/528860?v=4",
          "gravatar_id": "",
          "url": "https://api.github.com/users/bitcoin",
          "html_url": "https://github.com/bitcoin",
          "followers_url": "https://api.github.com/users/bitcoin/followers",
          "following_url": "https://api.github.com/users/bitcoin/following%7B/other_user%7D",
          "gists_url": "https://api.github.com/users/bitcoin/gists%7B/gist_id%7D",
          "starred_url": "https://api.github.com/users/bitcoin/starred%7B/owner%7D%7B/repo%7D",
          "subscriptions_url": "https://api.github.com/users/bitcoin/subscriptions",
          "organizations_url": "https://api.github.com/users/bitcoin/orgs",
          "repos_url": "https://api.github.com/users/bitcoin/repos",
          "events_url": "https://api.github.com/users/bitcoin/events%7B/privacy%7D",
          "received_events_url": "https://api.github.com/users/bitcoin/received_events",
          "type": "Organization",
          "site_admin": false,
          "patch_url": null
        },
        "private": false,
        "html_url": "https://github.com/bitcoin/bitcoin",
        "description": "Bitcoin Core integration/staging tree",
        "fork": false,
        "url": "https://api.github.com/repos/bitcoin/bitcoin",
        "archive_url": "https://api.github.com/repos/bitcoin/bitcoin/%7Barchive_format%7D%7B/ref%7D",
        "assignees_url": "https://api.github.com/repos/bitcoin/bitcoin/assignees%7B/user%7D",
        "blobs_url": "https://api.github.com/repos/bitcoin/bitcoin/git/blobs%7B/sha%7D",
        "branches_url": "https://api.github.com/repos/bitcoin/bitcoin/branches%7B/branch%7D",
        "collaborators_url": "https://api.github.com/repos/bitcoin/bitcoin/collaborators%7B/collaborator%7D",
        "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/comments%7B/number%7D",
        "commits_url": "https://api.github.com/repos/bitcoin/bitcoin/commits%7B/sha%7D",
        "compare_url": "https://api.github.com/repos/bitcoin/bitcoin/compare/%7Bbase%7D...%7Bhead%7D",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/%7B+path%7D",
        "contributors_url": "https://api.github.com/repos/bitcoin/bitcoin/contributors",
        "deployments_url": "https://api.github.com/repos/bitcoin/bitcoin/deployments",
        "downloads_url": "https://api.github.com/repos/bitcoin/bitcoin/downloads",
        "events_url": "https://api.github.com/repos/bitcoin/bitcoin/events",
        "forks_url": "https://api.github.com/repos/bitcoin/bitcoin/forks",
        "git_commits_url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits%7B/sha%7D",
        "git_refs_url": "https://api.github.com/repos/bitcoin/bitcoin/git/refs%7B/sha%7D",
        "git_tags_url": "https://api.github.com/repos/bitcoin/bitcoin/git/tags%7B/sha%7D",
        "git_url": "git://github.com/bitcoin/bitcoin.git",
        "issue_comment_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments%7B/number%7D",
        "issue_events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events%7B/number%7D",
        "issues_url": "https://api.github.com/repos/bitcoin/bitcoin/issues%7B/number%7D",
        "keys_url": "https://api.github.com/repos/bitcoin/bitcoin/keys%7B/key_id%7D",
        "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/labels%7B/name%7D",
        "languages_url": "https://api.github.com/repos/bitcoin/bitcoin/languages",
        "merges_url": "https://api.github.com/repos/bitcoin/bitcoin/merges",
        "milestones_url": "https://api.github.com/repos/bitcoin/bitcoin/milestones%7B/number%7D",
        "notifications_url": "https://api.github.com/repos/bitcoin/bitcoin/notifications%7B?since,all,participating}",
        "pulls_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls%7B/number%7D",
        "releases_url": "https://api.github.com/repos/bitcoin/bitcoin/releases%7B/id%7D",
        "ssh_url": "git@github.com:bitcoin/bitcoin.git",
        "stargazers_url": "https://api.github.com/repos/bitcoin/bitcoin/stargazers",
        "statuses_url": "https://api.github.com/repos/bitcoin/bitcoin/statuses/%7Bsha%7D",
        "subscribers_url": "https://api.github.com/repos/bitcoin/bitcoin/subscribers",
        "subscription_url": "https://api.github.com/repos/bitcoin/bitcoin/subscription",
        "tags_url": "https://api.github.com/repos/bitcoin/bitcoin/tags",
        "teams_url": "https://api.github.com/repos/bitcoin/bitcoin/teams",
        "trees_url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees%7B/sha%7D",
        "clone_url": "https://github.com/bitcoin/bitcoin.git",
        "hooks_url": "https://api.github.com/repos/bitcoin/bitcoin/hooks",
        "svn_url": "https://github.com/bitcoin/bitcoin",
        "homepage": "https://bitcoincore.org/en/download",
        "language": "C++",
        "forks_count": 37189,
        "stargazers_count": 83466,
        "watchers_count": 83466,
        "size": 281530,
        "default_branch": "master",
        "open_issues_count": 718,
        "is_template": false,
        "topics": [
          "bitcoin",
          "c-plus-plus",
          "cryptocurrency",
          "cryptography",
          "p2p"
        ],
        "has_issues": true,
        "has_projects": true,
        "has_wiki": false,
        "has_pages": false,
        "has_downloads": false,
        "archived": false,
        "disabled": false,
        "visibility": "public",
        "pushed_at": "2025-05-09T15:48:01Z",
        "created_at": "2010-12-19T15:16:43Z",
        "updated_at": "2025-05-09T15:48:08Z",
        "allow_forking": true,
        "license": {
          "key": "mit",
          "name": "MIT License",
          "node_id": "MDc6TGljZW5zZTEz",
          "spdx_id": "MIT",
          "url": "https://api.github.com/licenses/mit",
          "html_url": null,
          "description": null,
          "implementation": null,
          "permissions": null,
          "conditions": null,
          "limitations": null,
          "body": null,
          "featured": null
        }
      }
    },
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/32423"
      }
    },
    "author_association": "MEMBER",
    "draft": false,
    "additions": 75,
    "deletions": 48,
    "changed_files": 3,
    "commits": 4,
    "review_comments": 16,
    "comments": 5
  },
  "events": [
    {
      "event": "labeled",
      "id": 17533834001,
      "node_id": "LE_lADOABII5861U8FWzwAAAAQVGRMR",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/17533834001",
      "actor": {
        "login": "laanwj",
        "id": 126646,
        "node_id": "MDQ6VXNlcjEyNjY0Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/126646?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/laanwj",
        "html_url": "https://github.com/laanwj",
        "followers_url": "https://api.github.com/users/laanwj/followers",
        "following_url": "https://api.github.com/users/laanwj/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/laanwj/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/laanwj/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
        "organizations_url": "https://api.github.com/users/laanwj/orgs",
        "repos_url": "https://api.github.com/users/laanwj/repos",
        "events_url": "https://api.github.com/users/laanwj/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/laanwj/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-05-06T09:31:45Z",
      "label": {
        "name": "RPC/REST/ZMQ",
        "color": "0052cc"
      }
    },
    {
      "event": "commented",
      "id": 2853883420,
      "node_id": "IC_kwDOABII586qGs4c",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2853883420",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-05-06T09:31:49Z",
      "updated_at": "2025-05-09T14:49:28Z",
      "author_association": "CONTRIBUTOR",
      "body": "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--006a51241073e994b41acfe9ec718e94-->\n### Code Coverage & Benchmarks\nFor details see: https://corecheck.dev/bitcoin/bitcoin/pulls/32423.\n<!--021abf342d371248e50ceaed478a90ca-->\n### Reviews\nSee [the guideline](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#code-review) for information on the review process.\n| Type | Reviewers |\n| ---- | --------- |\n| Concept ACK | [Sjors](https://github.com/bitcoin/bitcoin/pull/32423#issuecomment-2854351055) |\n| Stale ACK | [janb84](https://github.com/bitcoin/bitcoin/pull/32423#pullrequestreview-2824869529), [vasild](https://github.com/bitcoin/bitcoin/pull/32423#pullrequestreview-2828006168) |\n\nIf your review is incorrectly listed, please react with 👎 to this comment and the bot will ignore it on the next update.\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* [#29641](https://github.com/bitcoin/bitcoin/pull/29641) (scripted-diff: Use LogInfo over LogPrintf [WIP, NOMERGE, DRAFT] by maflcko)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.\n<!--5faf32d7da4f0f540f40219e4f7537a3-->",
      "user": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32423#issuecomment-2853883420",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/32423"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 17533910914,
      "node_id": "HRFPE_lADOABII5861U8FWzwAAAAQVGj-C",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/17533910914",
      "actor": {
        "login": "laanwj",
        "id": 126646,
        "node_id": "MDQ6VXNlcjEyNjY0Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/126646?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/laanwj",
        "html_url": "https://github.com/laanwj",
        "followers_url": "https://api.github.com/users/laanwj/followers",
        "following_url": "https://api.github.com/users/laanwj/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/laanwj/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/laanwj/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
        "organizations_url": "https://api.github.com/users/laanwj/orgs",
        "repos_url": "https://api.github.com/users/laanwj/repos",
        "events_url": "https://api.github.com/users/laanwj/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/laanwj/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": "2392b4324777e002dc5363bac7f85cc6f8586818",
      "commit_url": "https://api.github.com/repos/laanwj/bitcoin/commits/2392b4324777e002dc5363bac7f85cc6f8586818",
      "created_at": "2025-05-06T09:36:33Z"
    },
    {
      "event": "reviewed",
      "id": 2817605176,
      "node_id": "PRR_kwDOABII586n8T44",
      "url": null,
      "actor": null,
      "commit_id": "2392b4324777e002dc5363bac7f85cc6f8586818",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "body": "concept ack",
      "user": {
        "login": "maflcko",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/maflcko",
        "html_url": "https://github.com/maflcko",
        "followers_url": "https://api.github.com/users/maflcko/followers",
        "following_url": "https://api.github.com/users/maflcko/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/maflcko/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/maflcko/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/maflcko/subscriptions",
        "organizations_url": "https://api.github.com/users/maflcko/orgs",
        "repos_url": "https://api.github.com/users/maflcko/repos",
        "events_url": "https://api.github.com/users/maflcko/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/maflcko/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32423#pullrequestreview-2817605176",
      "submitted_at": "2025-05-06T09:56:20Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/32423"
    },
    {
      "event": "reviewed",
      "id": 2817701222,
      "node_id": "PRR_kwDOABII586n8rVm",
      "url": null,
      "actor": null,
      "commit_id": "2392b4324777e002dc5363bac7f85cc6f8586818",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "user": {
        "login": "laanwj",
        "id": 126646,
        "node_id": "MDQ6VXNlcjEyNjY0Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/126646?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/laanwj",
        "html_url": "https://github.com/laanwj",
        "followers_url": "https://api.github.com/users/laanwj/followers",
        "following_url": "https://api.github.com/users/laanwj/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/laanwj/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/laanwj/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
        "organizations_url": "https://api.github.com/users/laanwj/orgs",
        "repos_url": "https://api.github.com/users/laanwj/repos",
        "events_url": "https://api.github.com/users/laanwj/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/laanwj/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32423#pullrequestreview-2817701222",
      "submitted_at": "2025-05-06T10:14:34Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/32423"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 17534704832,
      "node_id": "HRFPE_lADOABII5861U8FWzwAAAAQVJlzA",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/17534704832",
      "actor": {
        "login": "laanwj",
        "id": 126646,
        "node_id": "MDQ6VXNlcjEyNjY0Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/126646?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/laanwj",
        "html_url": "https://github.com/laanwj",
        "followers_url": "https://api.github.com/users/laanwj/followers",
        "following_url": "https://api.github.com/users/laanwj/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/laanwj/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/laanwj/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
        "organizations_url": "https://api.github.com/users/laanwj/orgs",
        "repos_url": "https://api.github.com/users/laanwj/repos",
        "events_url": "https://api.github.com/users/laanwj/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/laanwj/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": "3b0366d1775d6c00844ff0c90542814bf641bb18",
      "commit_url": "https://api.github.com/repos/laanwj/bitcoin/commits/3b0366d1775d6c00844ff0c90542814bf641bb18",
      "created_at": "2025-05-06T10:26:23Z"
    },
    {
      "event": "commented",
      "id": 2854061161,
      "node_id": "IC_kwDOABII586qHYRp",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2854061161",
      "actor": {
        "login": "laanwj",
        "id": 126646,
        "node_id": "MDQ6VXNlcjEyNjY0Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/126646?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/laanwj",
        "html_url": "https://github.com/laanwj",
        "followers_url": "https://api.github.com/users/laanwj/followers",
        "following_url": "https://api.github.com/users/laanwj/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/laanwj/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/laanwj/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
        "organizations_url": "https://api.github.com/users/laanwj/orgs",
        "repos_url": "https://api.github.com/users/laanwj/repos",
        "events_url": "https://api.github.com/users/laanwj/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/laanwj/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-05-06T10:28:51Z",
      "updated_at": "2025-05-06T10:28:51Z",
      "author_association": "MEMBER",
      "body": "[2392b4324777e002dc5363bac7f85cc6f8586818 → 3b0366d1775d6c00844ff0c90542814bf641bb18](https://github.com/bitcoin/bitcoin/compare/2392b4324777e002dc5363bac7f85cc6f8586818..3b0366d1775d6c00844ff0c90542814bf641bb18)\r\nUse `UCharCast`, no newline on log message, pass in `std::string_view`, some `&` code formatting",
      "user": {
        "login": "laanwj",
        "id": 126646,
        "node_id": "MDQ6VXNlcjEyNjY0Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/126646?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/laanwj",
        "html_url": "https://github.com/laanwj",
        "followers_url": "https://api.github.com/users/laanwj/followers",
        "following_url": "https://api.github.com/users/laanwj/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/laanwj/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/laanwj/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
        "organizations_url": "https://api.github.com/users/laanwj/orgs",
        "repos_url": "https://api.github.com/users/laanwj/repos",
        "events_url": "https://api.github.com/users/laanwj/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/laanwj/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32423#issuecomment-2854061161",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/32423"
    },
    {
      "event": "reviewed",
      "id": 2817948280,
      "node_id": "PRR_kwDOABII586n9np4",
      "url": null,
      "actor": null,
      "commit_id": "3b0366d1775d6c00844ff0c90542814bf641bb18",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "user": {
        "login": "laanwj",
        "id": 126646,
        "node_id": "MDQ6VXNlcjEyNjY0Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/126646?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/laanwj",
        "html_url": "https://github.com/laanwj",
        "followers_url": "https://api.github.com/users/laanwj/followers",
        "following_url": "https://api.github.com/users/laanwj/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/laanwj/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/laanwj/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
        "organizations_url": "https://api.github.com/users/laanwj/orgs",
        "repos_url": "https://api.github.com/users/laanwj/repos",
        "events_url": "https://api.github.com/users/laanwj/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/laanwj/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32423#pullrequestreview-2817948280",
      "submitted_at": "2025-05-06T11:43:27Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/32423"
    },
    {
      "event": "commented",
      "id": 2854351055,
      "node_id": "IC_kwDOABII586qIfDP",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2854351055",
      "actor": {
        "login": "Sjors",
        "id": 10217,
        "node_id": "MDQ6VXNlcjEwMjE3",
        "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Sjors",
        "html_url": "https://github.com/Sjors",
        "followers_url": "https://api.github.com/users/Sjors/followers",
        "following_url": "https://api.github.com/users/Sjors/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Sjors/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Sjors/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
        "organizations_url": "https://api.github.com/users/Sjors/orgs",
        "repos_url": "https://api.github.com/users/Sjors/repos",
        "events_url": "https://api.github.com/users/Sjors/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Sjors/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-05-06T12:14:06Z",
      "updated_at": "2025-05-06T12:14:06Z",
      "author_association": "MEMBER",
      "body": "Hah, I was planning on doing this undeprecating this morning, but couldn't find the deprecation message, so I figured someone already did it.\r\n\r\nConcept ACK",
      "user": {
        "login": "Sjors",
        "id": 10217,
        "node_id": "MDQ6VXNlcjEwMjE3",
        "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Sjors",
        "html_url": "https://github.com/Sjors",
        "followers_url": "https://api.github.com/users/Sjors/followers",
        "following_url": "https://api.github.com/users/Sjors/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Sjors/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Sjors/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
        "organizations_url": "https://api.github.com/users/Sjors/orgs",
        "repos_url": "https://api.github.com/users/Sjors/repos",
        "events_url": "https://api.github.com/users/Sjors/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Sjors/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32423#issuecomment-2854351055",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/32423"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 17538195753,
      "node_id": "HRFPE_lADOABII5861U8FWzwAAAAQVW6Ep",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/17538195753",
      "actor": {
        "login": "laanwj",
        "id": 126646,
        "node_id": "MDQ6VXNlcjEyNjY0Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/126646?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/laanwj",
        "html_url": "https://github.com/laanwj",
        "followers_url": "https://api.github.com/users/laanwj/followers",
        "following_url": "https://api.github.com/users/laanwj/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/laanwj/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/laanwj/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
        "organizations_url": "https://api.github.com/users/laanwj/orgs",
        "repos_url": "https://api.github.com/users/laanwj/repos",
        "events_url": "https://api.github.com/users/laanwj/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/laanwj/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": "3acfc071c3445e943069b2778bbc5c74f702ef36",
      "commit_url": "https://api.github.com/repos/laanwj/bitcoin/commits/3acfc071c3445e943069b2778bbc5c74f702ef36",
      "created_at": "2025-05-06T14:00:43Z"
    },
    {
      "event": "commented",
      "id": 2855300344,
      "node_id": "IC_kwDOABII586qMGz4",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2855300344",
      "actor": {
        "login": "yancyribbens",
        "id": 817736,
        "node_id": "MDQ6VXNlcjgxNzczNg==",
        "avatar_url": "https://avatars.githubusercontent.com/u/817736?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/yancyribbens",
        "html_url": "https://github.com/yancyribbens",
        "followers_url": "https://api.github.com/users/yancyribbens/followers",
        "following_url": "https://api.github.com/users/yancyribbens/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/yancyribbens/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/yancyribbens/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/yancyribbens/subscriptions",
        "organizations_url": "https://api.github.com/users/yancyribbens/orgs",
        "repos_url": "https://api.github.com/users/yancyribbens/repos",
        "events_url": "https://api.github.com/users/yancyribbens/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/yancyribbens/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-05-06T16:59:11Z",
      "updated_at": "2025-05-06T16:59:11Z",
      "author_association": "CONTRIBUTOR",
      "body": "> As for the security risk, in many kinds of setups (no wallet, containerized, single-user-single-application, local-only, etc) it is an unlikely point of escalation\r\n\r\nThis probably applies to testnet and regtest too.",
      "user": {
        "login": "yancyribbens",
        "id": 817736,
        "node_id": "MDQ6VXNlcjgxNzczNg==",
        "avatar_url": "https://avatars.githubusercontent.com/u/817736?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/yancyribbens",
        "html_url": "https://github.com/yancyribbens",
        "followers_url": "https://api.github.com/users/yancyribbens/followers",
        "following_url": "https://api.github.com/users/yancyribbens/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/yancyribbens/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/yancyribbens/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/yancyribbens/subscriptions",
        "organizations_url": "https://api.github.com/users/yancyribbens/orgs",
        "repos_url": "https://api.github.com/users/yancyribbens/repos",
        "events_url": "https://api.github.com/users/yancyribbens/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/yancyribbens/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32423#issuecomment-2855300344",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/32423"
    },
    {
      "event": "commented",
      "id": 2862518703,
      "node_id": "IC_kwDOABII586qnpGv",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2862518703",
      "actor": {
        "login": "laanwj",
        "id": 126646,
        "node_id": "MDQ6VXNlcjEyNjY0Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/126646?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/laanwj",
        "html_url": "https://github.com/laanwj",
        "followers_url": "https://api.github.com/users/laanwj/followers",
        "following_url": "https://api.github.com/users/laanwj/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/laanwj/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/laanwj/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
        "organizations_url": "https://api.github.com/users/laanwj/orgs",
        "repos_url": "https://api.github.com/users/laanwj/repos",
        "events_url": "https://api.github.com/users/laanwj/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/laanwj/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-05-08T10:15:31Z",
      "updated_at": "2025-05-08T10:15:31Z",
      "author_association": "MEMBER",
      "body": "> This probably applies to testnet and regtest too.\r\n\r\nYes, for quick testing, not having to use an external script to create credentials is more convenient too. Usually cookie-based auth will suffice, but not always when dealing with external applications that need a username/password.",
      "user": {
        "login": "laanwj",
        "id": 126646,
        "node_id": "MDQ6VXNlcjEyNjY0Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/126646?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/laanwj",
        "html_url": "https://github.com/laanwj",
        "followers_url": "https://api.github.com/users/laanwj/followers",
        "following_url": "https://api.github.com/users/laanwj/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/laanwj/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/laanwj/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
        "organizations_url": "https://api.github.com/users/laanwj/orgs",
        "repos_url": "https://api.github.com/users/laanwj/repos",
        "events_url": "https://api.github.com/users/laanwj/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/laanwj/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32423#issuecomment-2862518703",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/32423"
    },
    {
      "event": "reviewed",
      "id": 2824869529,
      "node_id": "PRR_kwDOABII586oYBaZ",
      "url": null,
      "actor": null,
      "commit_id": "3acfc071c3445e943069b2778bbc5c74f702ef36",
      "commit_url": null,
      "created_at": null,
      "author_association": "CONTRIBUTOR",
      "body": "tACK [3acfc07](https://github.com/bitcoin/bitcoin/commits/3acfc071c3445e943069b2778bbc5c74f702ef36)\r\n\r\n- code review ✅\r\n- compiled, run all tests ✅\r\n- tested on regtest with user/pass & did remote curl call to test rpc user&pass func. ✅",
      "user": {
        "login": "janb84",
        "id": 608446,
        "node_id": "MDQ6VXNlcjYwODQ0Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/608446?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/janb84",
        "html_url": "https://github.com/janb84",
        "followers_url": "https://api.github.com/users/janb84/followers",
        "following_url": "https://api.github.com/users/janb84/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/janb84/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/janb84/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/janb84/subscriptions",
        "organizations_url": "https://api.github.com/users/janb84/orgs",
        "repos_url": "https://api.github.com/users/janb84/repos",
        "events_url": "https://api.github.com/users/janb84/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/janb84/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32423#pullrequestreview-2824869529",
      "submitted_at": "2025-05-08T11:48:43Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/32423"
    },
    {
      "event": "review_requested",
      "id": 17572635760,
      "node_id": "RRE_lADOABII5861U8FWzwAAAAQXaSRw",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/17572635760",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-05-08T11:48:47Z",
      "requested_reviewer": {
        "login": "Sjors",
        "id": 10217,
        "node_id": "MDQ6VXNlcjEwMjE3",
        "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Sjors",
        "html_url": "https://github.com/Sjors",
        "followers_url": "https://api.github.com/users/Sjors/followers",
        "following_url": "https://api.github.com/users/Sjors/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Sjors/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Sjors/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
        "organizations_url": "https://api.github.com/users/Sjors/orgs",
        "repos_url": "https://api.github.com/users/Sjors/repos",
        "events_url": "https://api.github.com/users/Sjors/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Sjors/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "review_requester": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      }
    },
    {
      "event": "reviewed",
      "id": 2828006168,
      "node_id": "PRR_kwDOABII586oj_MY",
      "url": null,
      "actor": null,
      "commit_id": "3acfc071c3445e943069b2778bbc5c74f702ef36",
      "commit_url": null,
      "created_at": null,
      "author_association": "CONTRIBUTOR",
      "body": "Almost ACK 3acfc071c3445e943069b2778bbc5c74f702ef36\r\n\r\nOnly unsure about `The configured rpcuser or rpcpassword cannot contain a \":\"`, see [the comment below](https://github.com/bitcoin/bitcoin/pull/32423#discussion_r2081681184).",
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32423#pullrequestreview-2828006168",
      "submitted_at": "2025-05-09T13:27:22Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/32423"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDRhYjliZWRlZTlkODZmZGVjYWE0YWZiYmY0MjE0Y2E2YzdkOWE5NGU",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/4ab9bedee9d86fdecaa4afbbf4214ca6c7d9a94e",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/4ab9bedee9d86fdecaa4afbbf4214ca6c7d9a94e",
      "tree": {
        "sha": "fa1b87e10817a4996ff0f10655b0408f2a1377f1",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/fa1b87e10817a4996ff0f10655b0408f2a1377f1"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/baa848b8d38187ce6b24a57cfadf1ea180209711",
          "sha": "baa848b8d38187ce6b24a57cfadf1ea180209711",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/baa848b8d38187ce6b24a57cfadf1ea180209711"
        }
      ],
      "message": "rpc: Undeprecate rpcuser/rpcpassword, change message to security warning\n\nBack in 2015, in #7044, we added configuration option `rpcauth` for\nmultiple RPC users. At the same time the old settings for single-user\nconfiguration `rpcuser` and `rpcpassword` were \"soon\" to be deprecated.\n\nThe main reason for this deprecation is that while `-rpcpassword` stores\nthe password in plain text, `-rpcauth` stores a hash, so it doesn't\nappear in the configuration in plain text.\n\nAs the options are still in active use, actually removing them is\nexpected to be a hassle to many, and it's not clear that is worth it. As\nfor the security risk, in many kinds of setups (no wallet,\ncontainerized, single-user-single-application, local-only, etc) it is an\nunlikely point of escalation.\n\nIn the end, it is good to encourage secure practices, but it is the\nresponsibility of the user. Log a clear warning but remove the\ndeprecation notice.\n\nCloses #29240.",
      "committer": {
        "name": "laanwj",
        "email": "126646+laanwj@users.noreply.github.com",
        "date": "2025-05-09T14:57:27Z"
      },
      "author": {
        "name": "laanwj",
        "email": "126646+laanwj@users.noreply.github.com",
        "date": "2025-05-06T07:19:41Z"
      },
      "sha": "4ab9bedee9d86fdecaa4afbbf4214ca6c7d9a94e"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDg3OWExN2JjYjFhNWVhYjJmZjE4NDFjZTVmMzc2MmRjY2NlY2IwYmE",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/879a17bcb1a5eab2ff1841ce5f3762dcccecb0ba",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/879a17bcb1a5eab2ff1841ce5f3762dcccecb0ba",
      "tree": {
        "sha": "bed2cd415046ac69eaeb2647bf05a2cd8af931b0",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/bed2cd415046ac69eaeb2647bf05a2cd8af931b0"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/4ab9bedee9d86fdecaa4afbbf4214ca6c7d9a94e",
          "sha": "4ab9bedee9d86fdecaa4afbbf4214ca6c7d9a94e",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/4ab9bedee9d86fdecaa4afbbf4214ca6c7d9a94e"
        }
      ],
      "message": "rpc: Store all credentials hashed in memory\n\nThis gets rid of the special-casing of `strRPCUserColonPass` by hashing\ncookies as well as manually provided `-rpcuser`/`-rpcpassword` with a\nrandom salt before storing them.\n\nAlso take the opportunity to modernize the surrounding code a bit. There\nshould be no end-user visible differences in behavior.",
      "committer": {
        "name": "laanwj",
        "email": "126646+laanwj@users.noreply.github.com",
        "date": "2025-05-09T14:58:06Z"
      },
      "author": {
        "name": "laanwj",
        "email": "126646+laanwj@users.noreply.github.com",
        "date": "2025-05-06T09:08:30Z"
      },
      "sha": "879a17bcb1a5eab2ff1841ce5f3762dcccecb0ba"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDk4ZmYzOGE2ZjFhOGExZTIxNGJkMzkwNWEyZGNhYzMxYWU2YzJmNTI",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/98ff38a6f1a8a1e214bd3905a2dcac31ae6c2f52",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/98ff38a6f1a8a1e214bd3905a2dcac31ae6c2f52",
      "tree": {
        "sha": "132b09331abf227e910196d12630e8298f486fdd",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/132b09331abf227e910196d12630e8298f486fdd"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/879a17bcb1a5eab2ff1841ce5f3762dcccecb0ba",
          "sha": "879a17bcb1a5eab2ff1841ce5f3762dcccecb0ba",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/879a17bcb1a5eab2ff1841ce5f3762dcccecb0ba"
        }
      ],
      "message": "rpc: Perform HTTP user:pass split once in `RPCAuthorized`",
      "committer": {
        "name": "laanwj",
        "email": "126646+laanwj@users.noreply.github.com",
        "date": "2025-05-09T14:58:08Z"
      },
      "author": {
        "name": "laanwj",
        "email": "126646+laanwj@users.noreply.github.com",
        "date": "2025-05-06T13:42:06Z"
      },
      "sha": "98ff38a6f1a8a1e214bd3905a2dcac31ae6c2f52"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 17592648122,
      "node_id": "HRFPE_lADOABII5861U8FWzwAAAAQYmoG6",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/17592648122",
      "actor": {
        "login": "laanwj",
        "id": 126646,
        "node_id": "MDQ6VXNlcjEyNjY0Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/126646?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/laanwj",
        "html_url": "https://github.com/laanwj",
        "followers_url": "https://api.github.com/users/laanwj/followers",
        "following_url": "https://api.github.com/users/laanwj/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/laanwj/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/laanwj/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
        "organizations_url": "https://api.github.com/users/laanwj/orgs",
        "repos_url": "https://api.github.com/users/laanwj/repos",
        "events_url": "https://api.github.com/users/laanwj/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/laanwj/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": "ab2c77315565daf2054b411debd338c89c03c26d",
      "commit_url": "https://api.github.com/repos/laanwj/bitcoin/commits/ab2c77315565daf2054b411debd338c89c03c26d",
      "created_at": "2025-05-09T14:59:24Z"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKGU0OWE3Mjc0YTIxNDFkY2I5ZTE4OGJjNGI0NWMyZDdiOTI4Y2NlY2Q",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/e49a7274a2141dcb9e188bc4b45c2d7b928ccecd",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/e49a7274a2141dcb9e188bc4b45c2d7b928ccecd",
      "tree": {
        "sha": "c73d6dc81dd16d15813642b83414c05699132933",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/c73d6dc81dd16d15813642b83414c05699132933"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/98ff38a6f1a8a1e214bd3905a2dcac31ae6c2f52",
          "sha": "98ff38a6f1a8a1e214bd3905a2dcac31ae6c2f52",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/98ff38a6f1a8a1e214bd3905a2dcac31ae6c2f52"
        }
      ],
      "message": "rpc: Avoid join-split roundtrip for user:pass for auth credentials",
      "committer": {
        "name": "laanwj",
        "email": "126646+laanwj@users.noreply.github.com",
        "date": "2025-05-09T15:07:28Z"
      },
      "author": {
        "name": "Vasil Dimov",
        "email": "vd@FreeBSD.org",
        "date": "2025-05-09T14:44:34Z"
      },
      "sha": "e49a7274a2141dcb9e188bc4b45c2d7b928ccecd"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 17592769598,
      "node_id": "HRFPE_lADOABII5861U8FWzwAAAAQYnFw-",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/17592769598",
      "actor": {
        "login": "laanwj",
        "id": 126646,
        "node_id": "MDQ6VXNlcjEyNjY0Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/126646?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/laanwj",
        "html_url": "https://github.com/laanwj",
        "followers_url": "https://api.github.com/users/laanwj/followers",
        "following_url": "https://api.github.com/users/laanwj/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/laanwj/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/laanwj/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
        "organizations_url": "https://api.github.com/users/laanwj/orgs",
        "repos_url": "https://api.github.com/users/laanwj/repos",
        "events_url": "https://api.github.com/users/laanwj/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/laanwj/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": "e49a7274a2141dcb9e188bc4b45c2d7b928ccecd",
      "commit_url": "https://api.github.com/repos/laanwj/bitcoin/commits/e49a7274a2141dcb9e188bc4b45c2d7b928ccecd",
      "created_at": "2025-05-09T15:07:40Z"
    }
  ],
  "comments": [
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2075115534",
      "pull_request_review_id": 2817605176,
      "id": 2075115534,
      "node_id": "PRRC_kwDOABII5857r8AO",
      "diff_hunk": "@@ -314,7 +314,8 @@ static bool InitRPCAuthentication()\n             LogInfo(\"Using random cookie authentication.\");\n         }\n     } else {\n-        LogPrintf(\"Config options rpcuser and rpcpassword will soon be deprecated. Locally-run instances may remove rpcuser to use cookie-based auth, or may be replaced with rpcauth. Please see share/rpcauth for rpcauth auth generation.\\n\");\n+        LogInfo(\"Using rpcuser/rpcpassword authentication.\");\n+        LogWarning(\"The use of rpcuser/rpcpassword is less secure, because credentials are configured in plain text. It is recommended that locally-run instances switch to cookie-based auth, or otherwise to use hashed rpcauth credentials. See share/rpcauth for more information.\\n\");",
      "path": "src/httprpc.cpp",
      "position": null,
      "original_position": 6,
      "commit_id": "e49a7274a2141dcb9e188bc4b45c2d7b928ccecd",
      "original_commit_id": "1b28314259952b70071eeeae11867e921729c4c7",
      "in_reply_to_id": null,
      "user": {
        "login": "maflcko",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/maflcko",
        "html_url": "https://github.com/maflcko",
        "followers_url": "https://api.github.com/users/maflcko/followers",
        "following_url": "https://api.github.com/users/maflcko/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/maflcko/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/maflcko/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/maflcko/subscriptions",
        "organizations_url": "https://api.github.com/users/maflcko/orgs",
        "repos_url": "https://api.github.com/users/maflcko/repos",
        "events_url": "https://api.github.com/users/maflcko/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/maflcko/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "nit in 1b28314259952b70071eeeae11867e921729c4c7: Can drop the trailing newline, if you retouch.",
      "created_at": "2025-05-06T09:46:32Z",
      "updated_at": "2025-05-06T09:56:20Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32423#discussion_r2075115534",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2075115534"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/32423"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 318,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2075124023",
      "pull_request_review_id": 2817605176,
      "id": 2075124023,
      "node_id": "PRRC_kwDOABII5857r-E3",
      "diff_hunk": "@@ -304,19 +295,41 @@ static bool InitRPCAuthentication()\n             cookie_perms = *perm_opt;\n         }\n \n-        assert(strRPCUserColonPass.empty()); // Only support initializing once\n-        if (!GenerateAuthCookie(&strRPCUserColonPass, cookie_perms)) {\n+        if (!GenerateAuthCookie(&user_colon_pass, cookie_perms)) {\n             return false;\n         }\n-        if (strRPCUserColonPass.empty()) {\n+        if (user_colon_pass.empty()) {\n             LogInfo(\"RPC authentication cookie file generation is disabled.\");\n         } else {\n             LogInfo(\"Using random cookie authentication.\");\n         }\n     } else {\n         LogInfo(\"Using rpcuser/rpcpassword authentication.\");\n         LogWarning(\"The use of rpcuser/rpcpassword is less secure, because credentials are configured in plain text. It is recommended that locally-run instances switch to cookie-based auth, or otherwise to use hashed rpcauth credentials. See share/rpcauth for more information.\\n\");\n-        strRPCUserColonPass = gArgs.GetArg(\"-rpcuser\", \"\") + \":\" + gArgs.GetArg(\"-rpcpassword\", \"\");\n+        user_colon_pass = gArgs.GetArg(\"-rpcuser\", \"\") + \":\" + gArgs.GetArg(\"-rpcpassword\", \"\");\n+    }\n+\n+    // If there is a plaintext credential, hash it with a random salt before storage.\n+    if (!user_colon_pass.empty()) {\n+        std::vector<std::string> fields{SplitString(user_colon_pass, ':')};\n+        if (fields.size() != 2) {\n+            LogError(\"Unable to parse RPC credentials. The configured rpcuser or rpcpassword cannot contain a \\\":\\\".\");\n+            return false;\n+        }\n+        const std::string &user = fields[0];\n+        const std::string &pass = fields[1];\n+\n+        // Generate a random 16 byte hex salt.\n+        std::array<unsigned char, 16> raw_salt;\n+        GetStrongRandBytes(raw_salt);\n+        std::string salt = HexStr(raw_salt);\n+\n+        // Compute HMAC.\n+        std::array<unsigned char,  CHMAC_SHA256::OUTPUT_SIZE> out;\n+        CHMAC_SHA256(reinterpret_cast<const unsigned char*>(salt.data()), salt.size()).Write(reinterpret_cast<const unsigned char*>(pass.data()), pass.size()).Finalize(out.data());",
      "path": "src/httprpc.cpp",
      "position": null,
      "original_position": 115,
      "commit_id": "e49a7274a2141dcb9e188bc4b45c2d7b928ccecd",
      "original_commit_id": "2392b4324777e002dc5363bac7f85cc6f8586818",
      "in_reply_to_id": null,
      "user": {
        "login": "maflcko",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/maflcko",
        "html_url": "https://github.com/maflcko",
        "followers_url": "https://api.github.com/users/maflcko/followers",
        "following_url": "https://api.github.com/users/maflcko/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/maflcko/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/maflcko/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/maflcko/subscriptions",
        "organizations_url": "https://api.github.com/users/maflcko/orgs",
        "repos_url": "https://api.github.com/users/maflcko/repos",
        "events_url": "https://api.github.com/users/maflcko/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/maflcko/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "nit in 2392b4324777e002dc5363bac7f85cc6f8586818: For new code, `UCharCast` may be better than a \"raw\" cast, but only if you re-touch.",
      "created_at": "2025-05-06T09:51:55Z",
      "updated_at": "2025-05-06T09:56:20Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32423#discussion_r2075124023",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2075124023"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/32423"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 329,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2075159204",
      "pull_request_review_id": 2817701222,
      "id": 2075159204,
      "node_id": "PRRC_kwDOABII5857sGqk",
      "diff_hunk": "@@ -101,31 +99,27 @@ static void JSONErrorReply(HTTPRequest* req, UniValue objError, const JSONRPCReq\n \n //This function checks username and password against -rpcauth\n //entries from config file.\n-static bool multiUserAuthorized(std::string strUserPass)\n+static bool CheckUserAuthorized(std::string user_pass)",
      "path": "src/httprpc.cpp",
      "position": null,
      "original_position": 14,
      "commit_id": "e49a7274a2141dcb9e188bc4b45c2d7b928ccecd",
      "original_commit_id": "2392b4324777e002dc5363bac7f85cc6f8586818",
      "in_reply_to_id": null,
      "user": {
        "login": "laanwj",
        "id": 126646,
        "node_id": "MDQ6VXNlcjEyNjY0Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/126646?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/laanwj",
        "html_url": "https://github.com/laanwj",
        "followers_url": "https://api.github.com/users/laanwj/followers",
        "following_url": "https://api.github.com/users/laanwj/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/laanwj/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/laanwj/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
        "organizations_url": "https://api.github.com/users/laanwj/orgs",
        "repos_url": "https://api.github.com/users/laanwj/repos",
        "events_url": "https://api.github.com/users/laanwj/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/laanwj/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "self-nit: This could be `std::string_view` as well. Or `const std::string&` at least.",
      "created_at": "2025-05-06T10:14:34Z",
      "updated_at": "2025-05-06T10:17:00Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32423#discussion_r2075159204",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2075159204"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/32423"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 102,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2075287790",
      "pull_request_review_id": 2817948280,
      "id": 2075287790,
      "node_id": "PRRC_kwDOABII5857smDu",
      "diff_hunk": "@@ -101,31 +99,27 @@ static void JSONErrorReply(HTTPRequest* req, UniValue objError, const JSONRPCReq\n \n //This function checks username and password against -rpcauth\n //entries from config file.\n-static bool multiUserAuthorized(std::string strUserPass)\n+static bool CheckUserAuthorized(std::string_view user_pass)\n {\n-    if (strUserPass.find(':') == std::string::npos) {\n+    if (user_pass.find(':') == std::string::npos) {",
      "path": "src/httprpc.cpp",
      "position": null,
      "original_position": 17,
      "commit_id": "e49a7274a2141dcb9e188bc4b45c2d7b928ccecd",
      "original_commit_id": "3b0366d1775d6c00844ff0c90542814bf641bb18",
      "in_reply_to_id": null,
      "user": {
        "login": "laanwj",
        "id": 126646,
        "node_id": "MDQ6VXNlcjEyNjY0Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/126646?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/laanwj",
        "html_url": "https://github.com/laanwj",
        "followers_url": "https://api.github.com/users/laanwj/followers",
        "following_url": "https://api.github.com/users/laanwj/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/laanwj/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/laanwj/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
        "organizations_url": "https://api.github.com/users/laanwj/orgs",
        "repos_url": "https://api.github.com/users/laanwj/repos",
        "events_url": "https://api.github.com/users/laanwj/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/laanwj/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "i intentionally kept this as-is (eg converting to use `Split` slightly changes semantics), but thinking of it, calling `user_pass.find(':')`three times in a row is maybe a bit much.\r\n\r\nEdit: heck, in the calling function it already does `user_pass.find(':')`, might as well do it there and pass in user and password seperately.",
      "created_at": "2025-05-06T11:43:27Z",
      "updated_at": "2025-05-06T13:11:08Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32423#discussion_r2075287790",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2075287790"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/32423"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 104,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2081503770",
      "pull_request_review_id": 2828006168,
      "id": 2081503770,
      "node_id": "PRRC_kwDOABII5858EToa",
      "diff_hunk": "@@ -304,18 +293,41 @@ static bool InitRPCAuthentication()\n             cookie_perms = *perm_opt;\n         }\n \n-        assert(strRPCUserColonPass.empty()); // Only support initializing once\n-        if (!GenerateAuthCookie(&strRPCUserColonPass, cookie_perms)) {\n+        if (!GenerateAuthCookie(&user_colon_pass, cookie_perms)) {\n             return false;\n         }\n-        if (strRPCUserColonPass.empty()) {\n+        if (user_colon_pass.empty()) {\n             LogInfo(\"RPC authentication cookie file generation is disabled.\");\n         } else {\n             LogInfo(\"Using random cookie authentication.\");\n         }\n     } else {\n-        LogPrintf(\"Config options rpcuser and rpcpassword will soon be deprecated. Locally-run instances may remove rpcuser to use cookie-based auth, or may be replaced with rpcauth. Please see share/rpcauth for rpcauth auth generation.\\n\");\n-        strRPCUserColonPass = gArgs.GetArg(\"-rpcuser\", \"\") + \":\" + gArgs.GetArg(\"-rpcpassword\", \"\");\n+        LogInfo(\"Using rpcuser/rpcpassword authentication.\");\n+        LogWarning(\"The use of rpcuser/rpcpassword is less secure, because credentials are configured in plain text. It is recommended that locally-run instances switch to cookie-based auth, or otherwise to use hashed rpcauth credentials. See share/rpcauth for more information.\");",
      "path": "src/httprpc.cpp",
      "position": null,
      "original_position": 101,
      "commit_id": "e49a7274a2141dcb9e188bc4b45c2d7b928ccecd",
      "original_commit_id": "3acfc071c3445e943069b2778bbc5c74f702ef36",
      "in_reply_to_id": null,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "It is like this in `master`, but the meaning of `share/rpcauth` may not be obvious. Especially considering that some distros may not install it in their packages. Is not installed by our `cmake --install BUILDDIR` either. Maybe change to \"See share/rpcauth in the source directory for more information\".",
      "created_at": "2025-05-09T11:47:02Z",
      "updated_at": "2025-05-09T13:27:22Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32423#discussion_r2081503770",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2081503770"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/32423"
        }
      },
      "start_line": null,
      "original_start_line": 317,
      "start_side": "LEFT",
      "line": null,
      "original_line": 306,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2081509904",
      "pull_request_review_id": 2828006168,
      "id": 2081509904,
      "node_id": "PRRC_kwDOABII5858EVIQ",
      "diff_hunk": "@@ -304,18 +293,41 @@ static bool InitRPCAuthentication()\n             cookie_perms = *perm_opt;\n         }\n \n-        assert(strRPCUserColonPass.empty()); // Only support initializing once\n-        if (!GenerateAuthCookie(&strRPCUserColonPass, cookie_perms)) {\n+        if (!GenerateAuthCookie(&user_colon_pass, cookie_perms)) {\n             return false;\n         }\n-        if (strRPCUserColonPass.empty()) {\n+        if (user_colon_pass.empty()) {\n             LogInfo(\"RPC authentication cookie file generation is disabled.\");\n         } else {\n             LogInfo(\"Using random cookie authentication.\");\n         }\n     } else {\n-        LogPrintf(\"Config options rpcuser and rpcpassword will soon be deprecated. Locally-run instances may remove rpcuser to use cookie-based auth, or may be replaced with rpcauth. Please see share/rpcauth for rpcauth auth generation.\\n\");\n-        strRPCUserColonPass = gArgs.GetArg(\"-rpcuser\", \"\") + \":\" + gArgs.GetArg(\"-rpcpassword\", \"\");\n+        LogInfo(\"Using rpcuser/rpcpassword authentication.\");\n+        LogWarning(\"The use of rpcuser/rpcpassword is less secure, because credentials are configured in plain text. It is recommended that locally-run instances switch to cookie-based auth, or otherwise to use hashed rpcauth credentials. See share/rpcauth for more information.\");",
      "path": "src/httprpc.cpp",
      "position": null,
      "original_position": 101,
      "commit_id": "e49a7274a2141dcb9e188bc4b45c2d7b928ccecd",
      "original_commit_id": "3acfc071c3445e943069b2778bbc5c74f702ef36",
      "in_reply_to_id": null,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "Maybe also worth adding the warning in the descriptions of `-rpcuser` and `-rpcpassword` in `init.cpp`:\r\n\r\nhttps://github.com/bitcoin/bitcoin/blob/5b8752198e979ea4987d8b6238f42f8ed9a38846/src/init.cpp#L668\r\n\r\nand\r\n\r\nhttps://github.com/bitcoin/bitcoin/blob/5b8752198e979ea4987d8b6238f42f8ed9a38846/src/init.cpp#L664",
      "created_at": "2025-05-09T11:51:39Z",
      "updated_at": "2025-05-09T13:27:22Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32423#discussion_r2081509904",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2081509904"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/32423"
        }
      },
      "start_line": null,
      "original_start_line": 317,
      "start_side": "LEFT",
      "line": null,
      "original_line": 306,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2081550947",
      "pull_request_review_id": 2828006168,
      "id": 2081550947,
      "node_id": "PRRC_kwDOABII5858EfJj",
      "diff_hunk": "@@ -304,18 +293,41 @@ static bool InitRPCAuthentication()\n             cookie_perms = *perm_opt;\n         }\n \n-        assert(strRPCUserColonPass.empty()); // Only support initializing once\n-        if (!GenerateAuthCookie(&strRPCUserColonPass, cookie_perms)) {\n+        if (!GenerateAuthCookie(&user_colon_pass, cookie_perms)) {\n             return false;\n         }\n-        if (strRPCUserColonPass.empty()) {\n+        if (user_colon_pass.empty()) {\n             LogInfo(\"RPC authentication cookie file generation is disabled.\");\n         } else {\n             LogInfo(\"Using random cookie authentication.\");\n         }\n     } else {\n-        LogPrintf(\"Config options rpcuser and rpcpassword will soon be deprecated. Locally-run instances may remove rpcuser to use cookie-based auth, or may be replaced with rpcauth. Please see share/rpcauth for rpcauth auth generation.\\n\");\n-        strRPCUserColonPass = gArgs.GetArg(\"-rpcuser\", \"\") + \":\" + gArgs.GetArg(\"-rpcpassword\", \"\");\n+        LogInfo(\"Using rpcuser/rpcpassword authentication.\");\n+        LogWarning(\"The use of rpcuser/rpcpassword is less secure, because credentials are configured in plain text. It is recommended that locally-run instances switch to cookie-based auth, or otherwise to use hashed rpcauth credentials. See share/rpcauth for more information.\");\n+        user_colon_pass = gArgs.GetArg(\"-rpcuser\", \"\") + \":\" + gArgs.GetArg(\"-rpcpassword\", \"\");\n+    }\n+\n+    // If there is a plaintext credential, hash it with a random salt before storage.\n+    if (!user_colon_pass.empty()) {\n+        std::vector<std::string> fields{SplitString(user_colon_pass, ':')};\n+        if (fields.size() != 2) {\n+            LogError(\"Unable to parse RPC credentials. The configured rpcuser or rpcpassword cannot contain a \\\":\\\".\");\n+            return false;\n+        }\n+        const std::string& user = fields[0];\n+        const std::string& pass = fields[1];\n+\n+        // Generate a random 16 byte hex salt.\n+        std::array<unsigned char, 16> raw_salt;\n+        GetStrongRandBytes(raw_salt);\n+        std::string salt = HexStr(raw_salt);\n+\n+        // Compute HMAC.\n+        std::array<unsigned char,  CHMAC_SHA256::OUTPUT_SIZE> out;",
      "path": "src/httprpc.cpp",
      "position": null,
      "original_position": 121,
      "commit_id": "e49a7274a2141dcb9e188bc4b45c2d7b928ccecd",
      "original_commit_id": "3acfc071c3445e943069b2778bbc5c74f702ef36",
      "in_reply_to_id": null,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "nit:\r\n```suggestion\r\n        std::array<unsigned char, CHMAC_SHA256::OUTPUT_SIZE> out;\r\n```",
      "created_at": "2025-05-09T12:19:04Z",
      "updated_at": "2025-05-09T13:27:22Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32423#discussion_r2081550947",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2081550947"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/32423"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 326,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2081564262",
      "pull_request_review_id": 2828006168,
      "id": 2081564262,
      "node_id": "PRRC_kwDOABII5858EiZm",
      "diff_hunk": "@@ -101,31 +99,21 @@ static void JSONErrorReply(HTTPRequest* req, UniValue objError, const JSONRPCReq\n \n //This function checks username and password against -rpcauth\n //entries from config file.\n-static bool multiUserAuthorized(std::string strUserPass)\n+static bool CheckUserAuthorized(std::string_view user, std::string_view pass)\n {\n-    if (strUserPass.find(':') == std::string::npos) {\n-        return false;\n-    }\n-    std::string strUser = strUserPass.substr(0, strUserPass.find(':'));\n-    std::string strPass = strUserPass.substr(strUserPass.find(':') + 1);\n-\n-    for (const auto& vFields : g_rpcauth) {\n-        std::string strName = vFields[0];\n-        if (!TimingResistantEqual(strName, strUser)) {\n+    for (const auto& fields : g_rpcauth) {",
      "path": "src/httprpc.cpp",
      "position": 25,
      "original_position": 25,
      "commit_id": "e49a7274a2141dcb9e188bc4b45c2d7b928ccecd",
      "original_commit_id": "3acfc071c3445e943069b2778bbc5c74f702ef36",
      "in_reply_to_id": null,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "Just noting: the way this works (unchanged by this PR) is that it allows duplicate usernames with different passwords (e.g. `joe:123` and `joe:456`) and would allow login with either password (`123` or `456`).\r\n\r\n(just a comment, feel free to resolve right away)",
      "created_at": "2025-05-09T12:26:17Z",
      "updated_at": "2025-05-09T13:27:22Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32423#discussion_r2081564262",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2081564262"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/32423"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 104,
      "original_line": 104,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2081596938",
      "pull_request_review_id": 2828006168,
      "id": 2081596938,
      "node_id": "PRRC_kwDOABII5858EqYK",
      "diff_hunk": "@@ -304,18 +293,41 @@ static bool InitRPCAuthentication()\n             cookie_perms = *perm_opt;\n         }\n \n-        assert(strRPCUserColonPass.empty()); // Only support initializing once\n-        if (!GenerateAuthCookie(&strRPCUserColonPass, cookie_perms)) {\n+        if (!GenerateAuthCookie(&user_colon_pass, cookie_perms)) {\n             return false;\n         }\n-        if (strRPCUserColonPass.empty()) {\n+        if (user_colon_pass.empty()) {\n             LogInfo(\"RPC authentication cookie file generation is disabled.\");\n         } else {\n             LogInfo(\"Using random cookie authentication.\");\n         }\n     } else {\n-        LogPrintf(\"Config options rpcuser and rpcpassword will soon be deprecated. Locally-run instances may remove rpcuser to use cookie-based auth, or may be replaced with rpcauth. Please see share/rpcauth for rpcauth auth generation.\\n\");\n-        strRPCUserColonPass = gArgs.GetArg(\"-rpcuser\", \"\") + \":\" + gArgs.GetArg(\"-rpcpassword\", \"\");",
      "path": "src/httprpc.cpp",
      "position": 104,
      "original_position": 99,
      "commit_id": "e49a7274a2141dcb9e188bc4b45c2d7b928ccecd",
      "original_commit_id": "3acfc071c3445e943069b2778bbc5c74f702ef36",
      "in_reply_to_id": null,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "I did not test to confirm this, just read the code, but before this PR if `-rpcuser=joe -rpcpassword=abc:def` was configured, it would have been possible to login with user `joe:abc` and password `def`.\r\n\r\n(just a comment, feel free to resolve right away)",
      "created_at": "2025-05-09T12:46:08Z",
      "updated_at": "2025-05-09T13:27:22Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32423#discussion_r2081596938",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2081596938"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/32423"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 318,
      "original_line": 318,
      "side": "LEFT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2081681184",
      "pull_request_review_id": 2828006168,
      "id": 2081681184,
      "node_id": "PRRC_kwDOABII5858E-8g",
      "diff_hunk": "@@ -304,18 +293,41 @@ static bool InitRPCAuthentication()\n             cookie_perms = *perm_opt;\n         }\n \n-        assert(strRPCUserColonPass.empty()); // Only support initializing once\n-        if (!GenerateAuthCookie(&strRPCUserColonPass, cookie_perms)) {\n+        if (!GenerateAuthCookie(&user_colon_pass, cookie_perms)) {\n             return false;\n         }\n-        if (strRPCUserColonPass.empty()) {\n+        if (user_colon_pass.empty()) {\n             LogInfo(\"RPC authentication cookie file generation is disabled.\");\n         } else {\n             LogInfo(\"Using random cookie authentication.\");\n         }\n     } else {\n-        LogPrintf(\"Config options rpcuser and rpcpassword will soon be deprecated. Locally-run instances may remove rpcuser to use cookie-based auth, or may be replaced with rpcauth. Please see share/rpcauth for rpcauth auth generation.\\n\");\n-        strRPCUserColonPass = gArgs.GetArg(\"-rpcuser\", \"\") + \":\" + gArgs.GetArg(\"-rpcpassword\", \"\");\n+        LogInfo(\"Using rpcuser/rpcpassword authentication.\");\n+        LogWarning(\"The use of rpcuser/rpcpassword is less secure, because credentials are configured in plain text. It is recommended that locally-run instances switch to cookie-based auth, or otherwise to use hashed rpcauth credentials. See share/rpcauth for more information.\");\n+        user_colon_pass = gArgs.GetArg(\"-rpcuser\", \"\") + \":\" + gArgs.GetArg(\"-rpcpassword\", \"\");\n+    }\n+\n+    // If there is a plaintext credential, hash it with a random salt before storage.\n+    if (!user_colon_pass.empty()) {\n+        std::vector<std::string> fields{SplitString(user_colon_pass, ':')};\n+        if (fields.size() != 2) {\n+            LogError(\"Unable to parse RPC credentials. The configured rpcuser or rpcpassword cannot contain a \\\":\\\".\");\n+            return false;\n+        }\n+        const std::string& user = fields[0];\n+        const std::string& pass = fields[1];",
      "path": "src/httprpc.cpp",
      "position": null,
      "original_position": 113,
      "commit_id": "e49a7274a2141dcb9e188bc4b45c2d7b928ccecd",
      "original_commit_id": "3acfc071c3445e943069b2778bbc5c74f702ef36",
      "in_reply_to_id": null,
      "user": {
        "login": "vasild",
        "id": 266751,
        "node_id": "MDQ6VXNlcjI2Njc1MQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vasild",
        "html_url": "https://github.com/vasild",
        "followers_url": "https://api.github.com/users/vasild/followers",
        "following_url": "https://api.github.com/users/vasild/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vasild/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vasild/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
        "organizations_url": "https://api.github.com/users/vasild/orgs",
        "repos_url": "https://api.github.com/users/vasild/repos",
        "events_url": "https://api.github.com/users/vasild/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vasild/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "This looks like a new restriction. Could it introduce a breakage for users that have `-rpcpassword=contains:colon`?\r\n\r\nIt is sub-optimal to join/craft the string \"user:pass\" and to split/parse it a few lines later. Better store the user and pass in separate variables, like this:\r\n\r\n<details>\r\n<summary>[patch] use separate variables for user and pass</summary>\r\n\r\n```diff\r\ndiff --git i/src/httprpc.cpp w/src/httprpc.cpp\r\nindex ed5a0253c6..493f1b0320 100644\r\n--- i/src/httprpc.cpp\r\n+++ w/src/httprpc.cpp\r\n@@ -275,13 +275,14 @@ static bool HTTPReq_JSONRPC(const std::any& context, HTTPRequest* req)\r\n     }\r\n     return true;\r\n }\r\n \r\n static bool InitRPCAuthentication()\r\n {\r\n-    std::string user_colon_pass;\r\n+    std::string user;\r\n+    std::string pass;\r\n \r\n     if (gArgs.GetArg(\"-rpcpassword\", \"\") == \"\")\r\n     {\r\n         std::optional<fs::perms> cookie_perms{std::nullopt};\r\n         auto cookie_perms_arg{gArgs.GetArg(\"-rpccookieperms\")};\r\n         if (cookie_perms_arg) {\r\n@@ -290,36 +291,31 @@ static bool InitRPCAuthentication()\r\n                 LogError(\"Invalid -rpccookieperms=%s; must be one of 'owner', 'group', or 'all'.\", *cookie_perms_arg);\r\n                 return false;\r\n             }\r\n             cookie_perms = *perm_opt;\r\n         }\r\n \r\n-        if (!GenerateAuthCookie(&user_colon_pass, cookie_perms)) {\r\n+        switch (GenerateAuthCookie(cookie_perms, user, pass)) {\r\n+        case GenerateAuthCookieResult::ERROR:\r\n             return false;\r\n-        }\r\n-        if (user_colon_pass.empty()) {\r\n+        case GenerateAuthCookieResult::DISABLED:\r\n             LogInfo(\"RPC authentication cookie file generation is disabled.\");\r\n-        } else {\r\n+            break;\r\n+        case GenerateAuthCookieResult::OK:\r\n             LogInfo(\"Using random cookie authentication.\");\r\n+            break;\r\n         }\r\n     } else {\r\n         LogInfo(\"Using rpcuser/rpcpassword authentication.\");\r\n         LogWarning(\"The use of rpcuser/rpcpassword is less secure, because credentials are configured in plain text. It is recommended that locally-run instances switch to cookie-based auth, or otherwise to use hashed rpcauth credentials. See share/rpcauth for more information.\");\r\n-        user_colon_pass = gArgs.GetArg(\"-rpcuser\", \"\") + \":\" + gArgs.GetArg(\"-rpcpassword\", \"\");\r\n+        user = gArgs.GetArg(\"-rpcuser\", \"\");\r\n+        pass = gArgs.GetArg(\"-rpcpassword\", \"\");\r\n     }\r\n \r\n     // If there is a plaintext credential, hash it with a random salt before storage.\r\n-    if (!user_colon_pass.empty()) {\r\n-        std::vector<std::string> fields{SplitString(user_colon_pass, ':')};\r\n-        if (fields.size() != 2) {\r\n-            LogError(\"Unable to parse RPC credentials. The configured rpcuser or rpcpassword cannot contain a \\\":\\\".\");\r\n-            return false;\r\n-        }\r\n-        const std::string& user = fields[0];\r\n-        const std::string& pass = fields[1];\r\n-\r\n+    if (!user.empty() || !pass.empty()) {\r\n         // Generate a random 16 byte hex salt.\r\n         std::array<unsigned char, 16> raw_salt;\r\n         GetStrongRandBytes(raw_salt);\r\n         std::string salt = HexStr(raw_salt);\r\n \r\n         // Compute HMAC.\r\ndiff --git i/src/rpc/request.cpp w/src/rpc/request.cpp\r\nindex 30f4a4f51b..249c6cb621 100644\r\n--- i/src/rpc/request.cpp\r\n+++ w/src/rpc/request.cpp\r\n@@ -94,56 +94,59 @@ static fs::path GetAuthCookieFile(bool temp=false)\r\n     }\r\n     return AbsPathForConfigVal(gArgs, arg);\r\n }\r\n \r\n static bool g_generated_cookie = false;\r\n \r\n-bool GenerateAuthCookie(std::string* cookie_out, std::optional<fs::perms> cookie_perms)\r\n+GenerateAuthCookieResult GenerateAuthCookie(const std::optional<fs::perms>& cookie_perms,\r\n+                                            std::string& user,\r\n+                                            std::string& pass)\r\n {\r\n     const size_t COOKIE_SIZE = 32;\r\n     unsigned char rand_pwd[COOKIE_SIZE];\r\n     GetRandBytes(rand_pwd);\r\n-    std::string cookie = COOKIEAUTH_USER + \":\" + HexStr(rand_pwd);\r\n+    const std::string rand_pwd_hex{HexStr(rand_pwd)};\r\n+    std::string cookie = COOKIEAUTH_USER + \":\" + rand_pwd_hex;\r\n \r\n     /** the umask determines what permissions are used to create this file -\r\n      * these are set to 0077 in common/system.cpp.\r\n      */\r\n     std::ofstream file;\r\n     fs::path filepath_tmp = GetAuthCookieFile(true);\r\n     if (filepath_tmp.empty()) {\r\n-        return true; // -norpccookiefile\r\n+        return GenerateAuthCookieResult::DISABLED; // -norpccookiefile\r\n     }\r\n     file.open(filepath_tmp);\r\n     if (!file.is_open()) {\r\n         LogWarning(\"Unable to open cookie authentication file %s for writing\", fs::PathToString(filepath_tmp));\r\n-        return false;\r\n+        return GenerateAuthCookieResult::ERROR;\r\n     }\r\n     file << cookie;\r\n     file.close();\r\n \r\n     fs::path filepath = GetAuthCookieFile(false);\r\n     if (!RenameOver(filepath_tmp, filepath)) {\r\n         LogWarning(\"Unable to rename cookie authentication file %s to %s\", fs::PathToString(filepath_tmp), fs::PathToString(filepath));\r\n-        return false;\r\n+        return GenerateAuthCookieResult::ERROR;\r\n     }\r\n     if (cookie_perms) {\r\n         std::error_code code;\r\n         fs::permissions(filepath, cookie_perms.value(), fs::perm_options::replace, code);\r\n         if (code) {\r\n             LogWarning(\"Unable to set permissions on cookie authentication file %s\", fs::PathToString(filepath));\r\n-            return false;\r\n+            return GenerateAuthCookieResult::ERROR;\r\n         }\r\n     }\r\n \r\n     g_generated_cookie = true;\r\n     LogInfo(\"Generated RPC authentication cookie %s\\n\", fs::PathToString(filepath));\r\n     LogInfo(\"Permissions used for cookie: %s\\n\", PermsToSymbolicString(fs::status(filepath).permissions()));\r\n \r\n-    if (cookie_out)\r\n-        *cookie_out = cookie;\r\n-    return true;\r\n+    user = COOKIEAUTH_USER;\r\n+    pass = rand_pwd_hex;\r\n+    return GenerateAuthCookieResult::OK;\r\n }\r\n \r\n bool GetAuthCookie(std::string *cookie_out)\r\n {\r\n     std::ifstream file;\r\n     std::string cookie;\r\ndiff --git i/src/rpc/request.h w/src/rpc/request.h\r\nindex 24887e8691..e93df02ba6 100644\r\n--- i/src/rpc/request.h\r\n+++ w/src/rpc/request.h\r\n@@ -20,14 +20,31 @@ enum class JSONRPCVersion {\r\n \r\n /** JSON-RPC 2.0 request, only used in bitcoin-cli **/\r\n UniValue JSONRPCRequestObj(const std::string& strMethod, const UniValue& params, const UniValue& id);\r\n UniValue JSONRPCReplyObj(UniValue result, UniValue error, std::optional<UniValue> id, JSONRPCVersion jsonrpc_version);\r\n UniValue JSONRPCError(int code, const std::string& message);\r\n \r\n-/** Generate a new RPC authentication cookie and write it to disk */\r\n-bool GenerateAuthCookie(std::string* cookie_out, std::optional<fs::perms> cookie_perms=std::nullopt);\r\n+enum class GenerateAuthCookieResult : uint8_t {\r\n+    DISABLED, // -norpccookiefile\r\n+    ERROR,\r\n+    OK,\r\n+};\r\n+\r\n+/**\r\n+ * Generate a new RPC authentication cookie and write it to disk\r\n+ * @param[in] cookie_perms Filesystem permissions to use for the cookie file.\r\n+ * @param[out] user Generated username, only set if `OK` is returned.\r\n+ * @param[out] pass Generated password, only set if `OK` is returned.\r\n+ * @retval GenerateAuthCookieResult::DISABLED Authentication via cookie is disabled.\r\n+ * @retval GenerateAuthCookieResult::ERROR Error occurred, auth data could not be saved to disk.\r\n+ * @retval GenerateAuthCookieResult::OK Auth data was generated, saved to disk and in `user` and `pass`.\r\n+ */\r\n+GenerateAuthCookieResult GenerateAuthCookie(const std::optional<fs::perms>& cookie_perms,\r\n+                                            std::string& user,\r\n+                                            std::string& pass);\r\n+\r\n /** Read the RPC authentication cookie from disk */\r\n bool GetAuthCookie(std::string *cookie_out);\r\n /** Delete RPC authentication cookie from disk */\r\n void DeleteAuthCookie();\r\n /** Parse JSON-RPC batch reply into a vector */\r\n std::vector<UniValue> JSONRPCProcessBatchReply(const UniValue& in);\r\n```\r\n</details>",
      "created_at": "2025-05-09T13:25:55Z",
      "updated_at": "2025-05-09T13:27:22Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32423#discussion_r2081681184",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2081681184"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/32423"
        }
      },
      "start_line": null,
      "original_start_line": 307,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 318,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2081798410",
      "pull_request_review_id": 2828551517,
      "id": 2081798410,
      "node_id": "PRRC_kwDOABII5858FbkK",
      "diff_hunk": "@@ -304,18 +293,41 @@ static bool InitRPCAuthentication()\n             cookie_perms = *perm_opt;\n         }\n \n-        assert(strRPCUserColonPass.empty()); // Only support initializing once\n-        if (!GenerateAuthCookie(&strRPCUserColonPass, cookie_perms)) {\n+        if (!GenerateAuthCookie(&user_colon_pass, cookie_perms)) {\n             return false;\n         }\n-        if (strRPCUserColonPass.empty()) {\n+        if (user_colon_pass.empty()) {\n             LogInfo(\"RPC authentication cookie file generation is disabled.\");\n         } else {\n             LogInfo(\"Using random cookie authentication.\");\n         }\n     } else {\n-        LogPrintf(\"Config options rpcuser and rpcpassword will soon be deprecated. Locally-run instances may remove rpcuser to use cookie-based auth, or may be replaced with rpcauth. Please see share/rpcauth for rpcauth auth generation.\\n\");\n-        strRPCUserColonPass = gArgs.GetArg(\"-rpcuser\", \"\") + \":\" + gArgs.GetArg(\"-rpcpassword\", \"\");\n+        LogInfo(\"Using rpcuser/rpcpassword authentication.\");\n+        LogWarning(\"The use of rpcuser/rpcpassword is less secure, because credentials are configured in plain text. It is recommended that locally-run instances switch to cookie-based auth, or otherwise to use hashed rpcauth credentials. See share/rpcauth for more information.\");",
      "path": "src/httprpc.cpp",
      "position": null,
      "original_position": 101,
      "commit_id": "e49a7274a2141dcb9e188bc4b45c2d7b928ccecd",
      "original_commit_id": "3acfc071c3445e943069b2778bbc5c74f702ef36",
      "in_reply_to_id": 2081509904,
      "user": {
        "login": "laanwj",
        "id": 126646,
        "node_id": "MDQ6VXNlcjEyNjY0Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/126646?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/laanwj",
        "html_url": "https://github.com/laanwj",
        "followers_url": "https://api.github.com/users/laanwj/followers",
        "following_url": "https://api.github.com/users/laanwj/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/laanwj/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/laanwj/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
        "organizations_url": "https://api.github.com/users/laanwj/orgs",
        "repos_url": "https://api.github.com/users/laanwj/repos",
        "events_url": "https://api.github.com/users/laanwj/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/laanwj/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "Maybe; we never added the deprecation notice there, so i'm not convinced i should touch that now.",
      "created_at": "2025-05-09T14:23:40Z",
      "updated_at": "2025-05-09T14:23:41Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32423#discussion_r2081798410",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2081798410"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/32423"
        }
      },
      "start_line": null,
      "original_start_line": 317,
      "start_side": "LEFT",
      "line": null,
      "original_line": 306,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2081801771",
      "pull_request_review_id": 2828556851,
      "id": 2081801771,
      "node_id": "PRRC_kwDOABII5858FcYr",
      "diff_hunk": "@@ -101,31 +99,21 @@ static void JSONErrorReply(HTTPRequest* req, UniValue objError, const JSONRPCReq\n \n //This function checks username and password against -rpcauth\n //entries from config file.\n-static bool multiUserAuthorized(std::string strUserPass)\n+static bool CheckUserAuthorized(std::string_view user, std::string_view pass)\n {\n-    if (strUserPass.find(':') == std::string::npos) {\n-        return false;\n-    }\n-    std::string strUser = strUserPass.substr(0, strUserPass.find(':'));\n-    std::string strPass = strUserPass.substr(strUserPass.find(':') + 1);\n-\n-    for (const auto& vFields : g_rpcauth) {\n-        std::string strName = vFields[0];\n-        if (!TimingResistantEqual(strName, strUser)) {\n+    for (const auto& fields : g_rpcauth) {",
      "path": "src/httprpc.cpp",
      "position": 25,
      "original_position": 25,
      "commit_id": "e49a7274a2141dcb9e188bc4b45c2d7b928ccecd",
      "original_commit_id": "3acfc071c3445e943069b2778bbc5c74f702ef36",
      "in_reply_to_id": 2081564262,
      "user": {
        "login": "laanwj",
        "id": 126646,
        "node_id": "MDQ6VXNlcjEyNjY0Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/126646?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/laanwj",
        "html_url": "https://github.com/laanwj",
        "followers_url": "https://api.github.com/users/laanwj/followers",
        "following_url": "https://api.github.com/users/laanwj/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/laanwj/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/laanwj/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
        "organizations_url": "https://api.github.com/users/laanwj/orgs",
        "repos_url": "https://api.github.com/users/laanwj/repos",
        "events_url": "https://api.github.com/users/laanwj/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/laanwj/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "Yes, this was and is still alllowed. Not sure it's a problem, if people want multiple passwords for one username they can do so, it doesn't open any security hole. In any case doesn't seem in scope of this change, which intentionally doesn't change user-visible behavior.",
      "created_at": "2025-05-09T14:25:22Z",
      "updated_at": "2025-05-09T14:25:22Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32423#discussion_r2081801771",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2081801771"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/32423"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 104,
      "original_line": 104,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2081803994",
      "pull_request_review_id": 2828560274,
      "id": 2081803994,
      "node_id": "PRRC_kwDOABII5858Fc7a",
      "diff_hunk": "@@ -304,18 +293,41 @@ static bool InitRPCAuthentication()\n             cookie_perms = *perm_opt;\n         }\n \n-        assert(strRPCUserColonPass.empty()); // Only support initializing once\n-        if (!GenerateAuthCookie(&strRPCUserColonPass, cookie_perms)) {\n+        if (!GenerateAuthCookie(&user_colon_pass, cookie_perms)) {\n             return false;\n         }\n-        if (strRPCUserColonPass.empty()) {\n+        if (user_colon_pass.empty()) {\n             LogInfo(\"RPC authentication cookie file generation is disabled.\");\n         } else {\n             LogInfo(\"Using random cookie authentication.\");\n         }\n     } else {\n-        LogPrintf(\"Config options rpcuser and rpcpassword will soon be deprecated. Locally-run instances may remove rpcuser to use cookie-based auth, or may be replaced with rpcauth. Please see share/rpcauth for rpcauth auth generation.\\n\");\n-        strRPCUserColonPass = gArgs.GetArg(\"-rpcuser\", \"\") + \":\" + gArgs.GetArg(\"-rpcpassword\", \"\");",
      "path": "src/httprpc.cpp",
      "position": 104,
      "original_position": 99,
      "commit_id": "e49a7274a2141dcb9e188bc4b45c2d7b928ccecd",
      "original_commit_id": "3acfc071c3445e943069b2778bbc5c74f702ef36",
      "in_reply_to_id": 2081596938,
      "user": {
        "login": "laanwj",
        "id": 126646,
        "node_id": "MDQ6VXNlcjEyNjY0Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/126646?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/laanwj",
        "html_url": "https://github.com/laanwj",
        "followers_url": "https://api.github.com/users/laanwj/followers",
        "following_url": "https://api.github.com/users/laanwj/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/laanwj/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/laanwj/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
        "organizations_url": "https://api.github.com/users/laanwj/orgs",
        "repos_url": "https://api.github.com/users/laanwj/repos",
        "events_url": "https://api.github.com/users/laanwj/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/laanwj/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "Agree, it's no longer possible to have `:` in `-rpcpassword` after this due to the choice to split them using `Split()`. I could change that code, though `:` in `-rpcuser` should really be invalid as the spec doesn't allow it.",
      "created_at": "2025-05-09T14:26:35Z",
      "updated_at": "2025-05-09T14:26:35Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32423#discussion_r2081803994",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2081803994"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/32423"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 318,
      "original_line": 318,
      "side": "LEFT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2081805880",
      "pull_request_review_id": 2828563405,
      "id": 2081805880,
      "node_id": "PRRC_kwDOABII5858FdY4",
      "diff_hunk": "@@ -304,18 +293,41 @@ static bool InitRPCAuthentication()\n             cookie_perms = *perm_opt;\n         }\n \n-        assert(strRPCUserColonPass.empty()); // Only support initializing once\n-        if (!GenerateAuthCookie(&strRPCUserColonPass, cookie_perms)) {\n+        if (!GenerateAuthCookie(&user_colon_pass, cookie_perms)) {\n             return false;\n         }\n-        if (strRPCUserColonPass.empty()) {\n+        if (user_colon_pass.empty()) {\n             LogInfo(\"RPC authentication cookie file generation is disabled.\");\n         } else {\n             LogInfo(\"Using random cookie authentication.\");\n         }\n     } else {\n-        LogPrintf(\"Config options rpcuser and rpcpassword will soon be deprecated. Locally-run instances may remove rpcuser to use cookie-based auth, or may be replaced with rpcauth. Please see share/rpcauth for rpcauth auth generation.\\n\");\n-        strRPCUserColonPass = gArgs.GetArg(\"-rpcuser\", \"\") + \":\" + gArgs.GetArg(\"-rpcpassword\", \"\");\n+        LogInfo(\"Using rpcuser/rpcpassword authentication.\");\n+        LogWarning(\"The use of rpcuser/rpcpassword is less secure, because credentials are configured in plain text. It is recommended that locally-run instances switch to cookie-based auth, or otherwise to use hashed rpcauth credentials. See share/rpcauth for more information.\");\n+        user_colon_pass = gArgs.GetArg(\"-rpcuser\", \"\") + \":\" + gArgs.GetArg(\"-rpcpassword\", \"\");\n+    }\n+\n+    // If there is a plaintext credential, hash it with a random salt before storage.\n+    if (!user_colon_pass.empty()) {\n+        std::vector<std::string> fields{SplitString(user_colon_pass, ':')};\n+        if (fields.size() != 2) {\n+            LogError(\"Unable to parse RPC credentials. The configured rpcuser or rpcpassword cannot contain a \\\":\\\".\");\n+            return false;\n+        }\n+        const std::string& user = fields[0];\n+        const std::string& pass = fields[1];",
      "path": "src/httprpc.cpp",
      "position": null,
      "original_position": 113,
      "commit_id": "e49a7274a2141dcb9e188bc4b45c2d7b928ccecd",
      "original_commit_id": "3acfc071c3445e943069b2778bbc5c74f702ef36",
      "in_reply_to_id": 2081681184,
      "user": {
        "login": "laanwj",
        "id": 126646,
        "node_id": "MDQ6VXNlcjEyNjY0Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/126646?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/laanwj",
        "html_url": "https://github.com/laanwj",
        "followers_url": "https://api.github.com/users/laanwj/followers",
        "following_url": "https://api.github.com/users/laanwj/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/laanwj/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/laanwj/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
        "organizations_url": "https://api.github.com/users/laanwj/orgs",
        "repos_url": "https://api.github.com/users/laanwj/repos",
        "events_url": "https://api.github.com/users/laanwj/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/laanwj/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": " i did that initially but it was a much larger change than i wanted. The current PR's behavior is easy to review. It seems this works fine, and keeps everything the same with the only exception the `:` in `rpcpassword` but that gives a clear error at least.",
      "created_at": "2025-05-09T14:27:45Z",
      "updated_at": "2025-05-09T14:35:33Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32423#discussion_r2081805880",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2081805880"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/32423"
        }
      },
      "start_line": null,
      "original_start_line": 307,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 318,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2081808045",
      "pull_request_review_id": 2828567856,
      "id": 2081808045,
      "node_id": "PRRC_kwDOABII5858Fd6t",
      "diff_hunk": "@@ -304,18 +293,41 @@ static bool InitRPCAuthentication()\n             cookie_perms = *perm_opt;\n         }\n \n-        assert(strRPCUserColonPass.empty()); // Only support initializing once\n-        if (!GenerateAuthCookie(&strRPCUserColonPass, cookie_perms)) {\n+        if (!GenerateAuthCookie(&user_colon_pass, cookie_perms)) {\n             return false;\n         }\n-        if (strRPCUserColonPass.empty()) {\n+        if (user_colon_pass.empty()) {\n             LogInfo(\"RPC authentication cookie file generation is disabled.\");\n         } else {\n             LogInfo(\"Using random cookie authentication.\");\n         }\n     } else {\n-        LogPrintf(\"Config options rpcuser and rpcpassword will soon be deprecated. Locally-run instances may remove rpcuser to use cookie-based auth, or may be replaced with rpcauth. Please see share/rpcauth for rpcauth auth generation.\\n\");\n-        strRPCUserColonPass = gArgs.GetArg(\"-rpcuser\", \"\") + \":\" + gArgs.GetArg(\"-rpcpassword\", \"\");\n+        LogInfo(\"Using rpcuser/rpcpassword authentication.\");\n+        LogWarning(\"The use of rpcuser/rpcpassword is less secure, because credentials are configured in plain text. It is recommended that locally-run instances switch to cookie-based auth, or otherwise to use hashed rpcauth credentials. See share/rpcauth for more information.\");",
      "path": "src/httprpc.cpp",
      "position": null,
      "original_position": 101,
      "commit_id": "e49a7274a2141dcb9e188bc4b45c2d7b928ccecd",
      "original_commit_id": "3acfc071c3445e943069b2778bbc5c74f702ef36",
      "in_reply_to_id": 2081503770,
      "user": {
        "login": "laanwj",
        "id": 126646,
        "node_id": "MDQ6VXNlcjEyNjY0Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/126646?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/laanwj",
        "html_url": "https://github.com/laanwj",
        "followers_url": "https://api.github.com/users/laanwj/followers",
        "following_url": "https://api.github.com/users/laanwj/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/laanwj/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/laanwj/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
        "organizations_url": "https://api.github.com/users/laanwj/orgs",
        "repos_url": "https://api.github.com/users/laanwj/repos",
        "events_url": "https://api.github.com/users/laanwj/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/laanwj/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "Agree.",
      "created_at": "2025-05-09T14:28:57Z",
      "updated_at": "2025-05-09T14:28:57Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32423#discussion_r2081808045",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2081808045"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/32423"
        }
      },
      "start_line": null,
      "original_start_line": 317,
      "start_side": "LEFT",
      "line": null,
      "original_line": 306,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2081831829",
      "pull_request_review_id": 2828611992,
      "id": 2081831829,
      "node_id": "PRRC_kwDOABII5858FjuV",
      "diff_hunk": "@@ -304,18 +293,41 @@ static bool InitRPCAuthentication()\n             cookie_perms = *perm_opt;\n         }\n \n-        assert(strRPCUserColonPass.empty()); // Only support initializing once\n-        if (!GenerateAuthCookie(&strRPCUserColonPass, cookie_perms)) {\n+        if (!GenerateAuthCookie(&user_colon_pass, cookie_perms)) {\n             return false;\n         }\n-        if (strRPCUserColonPass.empty()) {\n+        if (user_colon_pass.empty()) {\n             LogInfo(\"RPC authentication cookie file generation is disabled.\");\n         } else {\n             LogInfo(\"Using random cookie authentication.\");\n         }\n     } else {\n-        LogPrintf(\"Config options rpcuser and rpcpassword will soon be deprecated. Locally-run instances may remove rpcuser to use cookie-based auth, or may be replaced with rpcauth. Please see share/rpcauth for rpcauth auth generation.\\n\");\n-        strRPCUserColonPass = gArgs.GetArg(\"-rpcuser\", \"\") + \":\" + gArgs.GetArg(\"-rpcpassword\", \"\");\n+        LogInfo(\"Using rpcuser/rpcpassword authentication.\");\n+        LogWarning(\"The use of rpcuser/rpcpassword is less secure, because credentials are configured in plain text. It is recommended that locally-run instances switch to cookie-based auth, or otherwise to use hashed rpcauth credentials. See share/rpcauth for more information.\");\n+        user_colon_pass = gArgs.GetArg(\"-rpcuser\", \"\") + \":\" + gArgs.GetArg(\"-rpcpassword\", \"\");\n+    }\n+\n+    // If there is a plaintext credential, hash it with a random salt before storage.\n+    if (!user_colon_pass.empty()) {\n+        std::vector<std::string> fields{SplitString(user_colon_pass, ':')};\n+        if (fields.size() != 2) {\n+            LogError(\"Unable to parse RPC credentials. The configured rpcuser or rpcpassword cannot contain a \\\":\\\".\");\n+            return false;\n+        }\n+        const std::string& user = fields[0];\n+        const std::string& pass = fields[1];",
      "path": "src/httprpc.cpp",
      "position": null,
      "original_position": 113,
      "commit_id": "e49a7274a2141dcb9e188bc4b45c2d7b928ccecd",
      "original_commit_id": "3acfc071c3445e943069b2778bbc5c74f702ef36",
      "in_reply_to_id": 2081681184,
      "user": {
        "login": "laanwj",
        "id": 126646,
        "node_id": "MDQ6VXNlcjEyNjY0Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/126646?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/laanwj",
        "html_url": "https://github.com/laanwj",
        "followers_url": "https://api.github.com/users/laanwj/followers",
        "following_url": "https://api.github.com/users/laanwj/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/laanwj/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/laanwj/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
        "organizations_url": "https://api.github.com/users/laanwj/orgs",
        "repos_url": "https://api.github.com/users/laanwj/repos",
        "events_url": "https://api.github.com/users/laanwj/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/laanwj/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "Anyhow, i'll cherry-pick this, thanks, hope i won't get the opposite comment now that this is changing too much 😓 \r\n\r\nEdit: done\r\nSo after this, even `-rpcuser` can contain `:` again, although that makes it impossible to authenticate. This is disallowed by the spec so not an important edge case.",
      "created_at": "2025-05-09T14:40:52Z",
      "updated_at": "2025-05-09T15:03:22Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32423#discussion_r2081831829",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2081831829"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/32423"
        }
      },
      "start_line": null,
      "original_start_line": 307,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 318,
      "side": "RIGHT"
    }
  ]
}
{
  "type": "pull",
  "pull": {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31483",
    "id": 2231533853,
    "node_id": "PR_kwDOABII586FAoEd",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/31483",
    "diff_url": "https://github.com/bitcoin/bitcoin/pull/31483.diff",
    "patch_url": "https://github.com/bitcoin/bitcoin/pull/31483.patch",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/31483",
    "commits_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31483/commits",
    "review_comments_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31483/comments",
    "review_comment_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments%7B/number%7D",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/31483/comments",
    "statuses_url": "https://api.github.com/repos/bitcoin/bitcoin/statuses/2a92702bafca5c78b270a9502a22cb9deac02cfc",
    "number": 31483,
    "state": "open",
    "locked": false,
    "maintainer_can_modify": true,
    "title": "kernel: Move kernel-related cache constants to kernel cache",
    "user": {
      "login": "TheCharlatan",
      "id": 8421793,
      "node_id": "MDQ6VXNlcjg0MjE3OTM=",
      "avatar_url": "https://avatars.githubusercontent.com/u/8421793?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/TheCharlatan",
      "html_url": "https://github.com/TheCharlatan",
      "followers_url": "https://api.github.com/users/TheCharlatan/followers",
      "following_url": "https://api.github.com/users/TheCharlatan/following%7B/other_user%7D",
      "gists_url": "https://api.github.com/users/TheCharlatan/gists%7B/gist_id%7D",
      "starred_url": "https://api.github.com/users/TheCharlatan/starred%7B/owner%7D%7B/repo%7D",
      "subscriptions_url": "https://api.github.com/users/TheCharlatan/subscriptions",
      "organizations_url": "https://api.github.com/users/TheCharlatan/orgs",
      "repos_url": "https://api.github.com/users/TheCharlatan/repos",
      "events_url": "https://api.github.com/users/TheCharlatan/events%7B/privacy%7D",
      "received_events_url": "https://api.github.com/users/TheCharlatan/received_events",
      "type": "User",
      "site_admin": false,
      "patch_url": null
    },
    "body": "Carrying non-kernel related fields in the cache sizes for the indexes is confusing for kernel library users. The cache sizes are set currently with magic numbers in bitcoin-chainstate. The comments for the cache size calculations are not completely clear. The constants for the cache sizes are also currently in `txdb.h`, which is not an ideal place for holding all cache size related constants.\r\n\r\nSolve these things by moving the kernel-specific cache size fields to their own struct and moving the constants to either the node or the kernel cache sizes.\r\n\r\nThis slightly changes the way the cache is allocated if (and only if) the txindex and/or blockfilterindex is used. Since they are now given precedence over the block tree db cache, this results in a bit less cache being allocated to the block tree db, coinsdb and coins caches. The effect is negligible though, i.e. cache sizes with default dbcache reported through the logs are:\r\n\r\nmaster:\r\n```\r\nCache configuration:\r\n* Using 2.0 MiB for block index database\r\n* Using 56.0 MiB for transaction index database\r\n* Using 49.0 MiB for basic block filter index database\r\n* Using 8.0 MiB for chain state database\r\n* Using 335.0 MiB for in-memory UTXO set (plus up to 286.1 MiB of unused mempool space)\r\n```\r\n\r\nthis PR:\r\n```\r\nCache configuration:\r\n* Using 2.0 MiB for block index database\r\n* Using 56.2 MiB for transaction index database\r\n* Using 49.2 MiB for basic block filter index database\r\n* Using 8.0 MiB for chain state database\r\n* Using 334.5 MiB for in-memory UTXO set (plus up to 286.1 MiB of unused mempool space)\r\n```\r\n\r\n---\r\nThis PR is part of the [libbitcoinkernel project](https://github.com/bitcoin/bitcoin/issues/27587).",
    "labels": [
      {
        "id": 118379652,
        "node_id": "MDU6TGFiZWwxMTgzNzk2NTI=",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Validation",
        "name": "Validation",
        "color": "6060aa",
        "default": false
      }
    ],
    "created_at": "2024-12-12T12:17:56Z",
    "updated_at": "2025-01-15T15:43:05Z",
    "mergeable": true,
    "mergeable_state": "blocked",
    "merge_commit_sha": "8e6340f0125745dffb4ae2b06d5826435fe580ef",
    "assignees": [],
    "requested_reviewers": [
      {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      {
        "login": "hodlinator",
        "id": 172445034,
        "node_id": "U_kgDOCkdNag",
        "avatar_url": "https://avatars.githubusercontent.com/u/172445034?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/hodlinator",
        "html_url": "https://github.com/hodlinator",
        "followers_url": "https://api.github.com/users/hodlinator/followers",
        "following_url": "https://api.github.com/users/hodlinator/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/hodlinator/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/hodlinator/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/hodlinator/subscriptions",
        "organizations_url": "https://api.github.com/users/hodlinator/orgs",
        "repos_url": "https://api.github.com/users/hodlinator/repos",
        "events_url": "https://api.github.com/users/hodlinator/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/hodlinator/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      }
    ],
    "requested_teams": [],
    "rebaseable": true,
    "head": {
      "label": "TheCharlatan:kernel_cache_sizes",
      "ref": "kernel_cache_sizes",
      "sha": "2a92702bafca5c78b270a9502a22cb9deac02cfc",
      "user": {
        "login": "TheCharlatan",
        "id": 8421793,
        "node_id": "MDQ6VXNlcjg0MjE3OTM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8421793?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/TheCharlatan",
        "html_url": "https://github.com/TheCharlatan",
        "followers_url": "https://api.github.com/users/TheCharlatan/followers",
        "following_url": "https://api.github.com/users/TheCharlatan/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/TheCharlatan/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/TheCharlatan/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/TheCharlatan/subscriptions",
        "organizations_url": "https://api.github.com/users/TheCharlatan/orgs",
        "repos_url": "https://api.github.com/users/TheCharlatan/repos",
        "events_url": "https://api.github.com/users/TheCharlatan/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/TheCharlatan/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "repo": {
        "id": 94456368,
        "node_id": "MDEwOlJlcG9zaXRvcnk5NDQ1NjM2OA==",
        "name": "bitcoin",
        "full_name": "TheCharlatan/bitcoin",
        "owner": {
          "login": "TheCharlatan",
          "id": 8421793,
          "node_id": "MDQ6VXNlcjg0MjE3OTM=",
          "avatar_url": "https://avatars.githubusercontent.com/u/8421793?v=4",
          "gravatar_id": "",
          "url": "https://api.github.com/users/TheCharlatan",
          "html_url": "https://github.com/TheCharlatan",
          "followers_url": "https://api.github.com/users/TheCharlatan/followers",
          "following_url": "https://api.github.com/users/TheCharlatan/following%7B/other_user%7D",
          "gists_url": "https://api.github.com/users/TheCharlatan/gists%7B/gist_id%7D",
          "starred_url": "https://api.github.com/users/TheCharlatan/starred%7B/owner%7D%7B/repo%7D",
          "subscriptions_url": "https://api.github.com/users/TheCharlatan/subscriptions",
          "organizations_url": "https://api.github.com/users/TheCharlatan/orgs",
          "repos_url": "https://api.github.com/users/TheCharlatan/repos",
          "events_url": "https://api.github.com/users/TheCharlatan/events%7B/privacy%7D",
          "received_events_url": "https://api.github.com/users/TheCharlatan/received_events",
          "type": "User",
          "site_admin": false,
          "patch_url": null
        },
        "private": false,
        "html_url": "https://github.com/TheCharlatan/bitcoin",
        "description": "Bitcoin Core integration/staging tree",
        "fork": true,
        "url": "https://api.github.com/repos/TheCharlatan/bitcoin",
        "archive_url": "https://api.github.com/repos/TheCharlatan/bitcoin/%7Barchive_format%7D%7B/ref%7D",
        "assignees_url": "https://api.github.com/repos/TheCharlatan/bitcoin/assignees%7B/user%7D",
        "blobs_url": "https://api.github.com/repos/TheCharlatan/bitcoin/git/blobs%7B/sha%7D",
        "branches_url": "https://api.github.com/repos/TheCharlatan/bitcoin/branches%7B/branch%7D",
        "collaborators_url": "https://api.github.com/repos/TheCharlatan/bitcoin/collaborators%7B/collaborator%7D",
        "comments_url": "https://api.github.com/repos/TheCharlatan/bitcoin/comments%7B/number%7D",
        "commits_url": "https://api.github.com/repos/TheCharlatan/bitcoin/commits%7B/sha%7D",
        "compare_url": "https://api.github.com/repos/TheCharlatan/bitcoin/compare/%7Bbase%7D...%7Bhead%7D",
        "contents_url": "https://api.github.com/repos/TheCharlatan/bitcoin/contents/%7B+path%7D",
        "contributors_url": "https://api.github.com/repos/TheCharlatan/bitcoin/contributors",
        "deployments_url": "https://api.github.com/repos/TheCharlatan/bitcoin/deployments",
        "downloads_url": "https://api.github.com/repos/TheCharlatan/bitcoin/downloads",
        "events_url": "https://api.github.com/repos/TheCharlatan/bitcoin/events",
        "forks_url": "https://api.github.com/repos/TheCharlatan/bitcoin/forks",
        "git_commits_url": "https://api.github.com/repos/TheCharlatan/bitcoin/git/commits%7B/sha%7D",
        "git_refs_url": "https://api.github.com/repos/TheCharlatan/bitcoin/git/refs%7B/sha%7D",
        "git_tags_url": "https://api.github.com/repos/TheCharlatan/bitcoin/git/tags%7B/sha%7D",
        "git_url": "git://github.com/TheCharlatan/bitcoin.git",
        "issue_comment_url": "https://api.github.com/repos/TheCharlatan/bitcoin/issues/comments%7B/number%7D",
        "issue_events_url": "https://api.github.com/repos/TheCharlatan/bitcoin/issues/events%7B/number%7D",
        "issues_url": "https://api.github.com/repos/TheCharlatan/bitcoin/issues%7B/number%7D",
        "keys_url": "https://api.github.com/repos/TheCharlatan/bitcoin/keys%7B/key_id%7D",
        "labels_url": "https://api.github.com/repos/TheCharlatan/bitcoin/labels%7B/name%7D",
        "languages_url": "https://api.github.com/repos/TheCharlatan/bitcoin/languages",
        "merges_url": "https://api.github.com/repos/TheCharlatan/bitcoin/merges",
        "milestones_url": "https://api.github.com/repos/TheCharlatan/bitcoin/milestones%7B/number%7D",
        "notifications_url": "https://api.github.com/repos/TheCharlatan/bitcoin/notifications%7B?since,all,participating}",
        "pulls_url": "https://api.github.com/repos/TheCharlatan/bitcoin/pulls%7B/number%7D",
        "releases_url": "https://api.github.com/repos/TheCharlatan/bitcoin/releases%7B/id%7D",
        "ssh_url": "git@github.com:TheCharlatan/bitcoin.git",
        "stargazers_url": "https://api.github.com/repos/TheCharlatan/bitcoin/stargazers",
        "statuses_url": "https://api.github.com/repos/TheCharlatan/bitcoin/statuses/%7Bsha%7D",
        "subscribers_url": "https://api.github.com/repos/TheCharlatan/bitcoin/subscribers",
        "subscription_url": "https://api.github.com/repos/TheCharlatan/bitcoin/subscription",
        "tags_url": "https://api.github.com/repos/TheCharlatan/bitcoin/tags",
        "teams_url": "https://api.github.com/repos/TheCharlatan/bitcoin/teams",
        "trees_url": "https://api.github.com/repos/TheCharlatan/bitcoin/git/trees%7B/sha%7D",
        "clone_url": "https://github.com/TheCharlatan/bitcoin.git",
        "hooks_url": "https://api.github.com/repos/TheCharlatan/bitcoin/hooks",
        "svn_url": "https://github.com/TheCharlatan/bitcoin",
        "homepage": "https://bitcoin.org/en/download",
        "language": "C++",
        "forks_count": 0,
        "stargazers_count": 5,
        "watchers_count": 5,
        "size": 253652,
        "default_branch": "master",
        "open_issues_count": 1,
        "is_template": false,
        "topics": [],
        "has_issues": false,
        "has_projects": true,
        "has_wiki": false,
        "has_pages": false,
        "has_downloads": false,
        "archived": false,
        "disabled": false,
        "visibility": "public",
        "pushed_at": "2025-01-15T15:32:27Z",
        "created_at": "2017-06-15T16:03:35Z",
        "updated_at": "2025-01-05T17:06:40Z",
        "allow_forking": true,
        "license": {
          "key": "mit",
          "name": "MIT License",
          "node_id": "MDc6TGljZW5zZTEz",
          "spdx_id": "MIT",
          "url": "https://api.github.com/licenses/mit",
          "html_url": null,
          "description": null,
          "implementation": null,
          "permissions": null,
          "conditions": null,
          "limitations": null,
          "body": null,
          "featured": null
        }
      }
    },
    "base": {
      "label": "bitcoin:master",
      "ref": "master",
      "sha": "e7c479495509c068215b73f6df070af2d406ae15",
      "user": {
        "login": "bitcoin",
        "id": 528860,
        "node_id": "MDEyOk9yZ2FuaXphdGlvbjUyODg2MA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/528860?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/bitcoin",
        "html_url": "https://github.com/bitcoin",
        "followers_url": "https://api.github.com/users/bitcoin/followers",
        "following_url": "https://api.github.com/users/bitcoin/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/bitcoin/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/bitcoin/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/bitcoin/subscriptions",
        "organizations_url": "https://api.github.com/users/bitcoin/orgs",
        "repos_url": "https://api.github.com/users/bitcoin/repos",
        "events_url": "https://api.github.com/users/bitcoin/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/bitcoin/received_events",
        "type": "Organization",
        "site_admin": false,
        "patch_url": null
      },
      "repo": {
        "id": 1181927,
        "node_id": "MDEwOlJlcG9zaXRvcnkxMTgxOTI3",
        "name": "bitcoin",
        "full_name": "bitcoin/bitcoin",
        "owner": {
          "login": "bitcoin",
          "id": 528860,
          "node_id": "MDEyOk9yZ2FuaXphdGlvbjUyODg2MA==",
          "avatar_url": "https://avatars.githubusercontent.com/u/528860?v=4",
          "gravatar_id": "",
          "url": "https://api.github.com/users/bitcoin",
          "html_url": "https://github.com/bitcoin",
          "followers_url": "https://api.github.com/users/bitcoin/followers",
          "following_url": "https://api.github.com/users/bitcoin/following%7B/other_user%7D",
          "gists_url": "https://api.github.com/users/bitcoin/gists%7B/gist_id%7D",
          "starred_url": "https://api.github.com/users/bitcoin/starred%7B/owner%7D%7B/repo%7D",
          "subscriptions_url": "https://api.github.com/users/bitcoin/subscriptions",
          "organizations_url": "https://api.github.com/users/bitcoin/orgs",
          "repos_url": "https://api.github.com/users/bitcoin/repos",
          "events_url": "https://api.github.com/users/bitcoin/events%7B/privacy%7D",
          "received_events_url": "https://api.github.com/users/bitcoin/received_events",
          "type": "Organization",
          "site_admin": false,
          "patch_url": null
        },
        "private": false,
        "html_url": "https://github.com/bitcoin/bitcoin",
        "description": "Bitcoin Core integration/staging tree",
        "fork": false,
        "url": "https://api.github.com/repos/bitcoin/bitcoin",
        "archive_url": "https://api.github.com/repos/bitcoin/bitcoin/%7Barchive_format%7D%7B/ref%7D",
        "assignees_url": "https://api.github.com/repos/bitcoin/bitcoin/assignees%7B/user%7D",
        "blobs_url": "https://api.github.com/repos/bitcoin/bitcoin/git/blobs%7B/sha%7D",
        "branches_url": "https://api.github.com/repos/bitcoin/bitcoin/branches%7B/branch%7D",
        "collaborators_url": "https://api.github.com/repos/bitcoin/bitcoin/collaborators%7B/collaborator%7D",
        "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/comments%7B/number%7D",
        "commits_url": "https://api.github.com/repos/bitcoin/bitcoin/commits%7B/sha%7D",
        "compare_url": "https://api.github.com/repos/bitcoin/bitcoin/compare/%7Bbase%7D...%7Bhead%7D",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/%7B+path%7D",
        "contributors_url": "https://api.github.com/repos/bitcoin/bitcoin/contributors",
        "deployments_url": "https://api.github.com/repos/bitcoin/bitcoin/deployments",
        "downloads_url": "https://api.github.com/repos/bitcoin/bitcoin/downloads",
        "events_url": "https://api.github.com/repos/bitcoin/bitcoin/events",
        "forks_url": "https://api.github.com/repos/bitcoin/bitcoin/forks",
        "git_commits_url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits%7B/sha%7D",
        "git_refs_url": "https://api.github.com/repos/bitcoin/bitcoin/git/refs%7B/sha%7D",
        "git_tags_url": "https://api.github.com/repos/bitcoin/bitcoin/git/tags%7B/sha%7D",
        "git_url": "git://github.com/bitcoin/bitcoin.git",
        "issue_comment_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments%7B/number%7D",
        "issue_events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events%7B/number%7D",
        "issues_url": "https://api.github.com/repos/bitcoin/bitcoin/issues%7B/number%7D",
        "keys_url": "https://api.github.com/repos/bitcoin/bitcoin/keys%7B/key_id%7D",
        "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/labels%7B/name%7D",
        "languages_url": "https://api.github.com/repos/bitcoin/bitcoin/languages",
        "merges_url": "https://api.github.com/repos/bitcoin/bitcoin/merges",
        "milestones_url": "https://api.github.com/repos/bitcoin/bitcoin/milestones%7B/number%7D",
        "notifications_url": "https://api.github.com/repos/bitcoin/bitcoin/notifications%7B?since,all,participating}",
        "pulls_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls%7B/number%7D",
        "releases_url": "https://api.github.com/repos/bitcoin/bitcoin/releases%7B/id%7D",
        "ssh_url": "git@github.com:bitcoin/bitcoin.git",
        "stargazers_url": "https://api.github.com/repos/bitcoin/bitcoin/stargazers",
        "statuses_url": "https://api.github.com/repos/bitcoin/bitcoin/statuses/%7Bsha%7D",
        "subscribers_url": "https://api.github.com/repos/bitcoin/bitcoin/subscribers",
        "subscription_url": "https://api.github.com/repos/bitcoin/bitcoin/subscription",
        "tags_url": "https://api.github.com/repos/bitcoin/bitcoin/tags",
        "teams_url": "https://api.github.com/repos/bitcoin/bitcoin/teams",
        "trees_url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees%7B/sha%7D",
        "clone_url": "https://github.com/bitcoin/bitcoin.git",
        "hooks_url": "https://api.github.com/repos/bitcoin/bitcoin/hooks",
        "svn_url": "https://github.com/bitcoin/bitcoin",
        "homepage": "https://bitcoincore.org/en/download",
        "language": "C++",
        "forks_count": 36535,
        "stargazers_count": 81422,
        "watchers_count": 81422,
        "size": 274215,
        "default_branch": "master",
        "open_issues_count": 695,
        "is_template": false,
        "topics": [
          "bitcoin",
          "c-plus-plus",
          "cryptocurrency",
          "cryptography",
          "p2p"
        ],
        "has_issues": true,
        "has_projects": true,
        "has_wiki": false,
        "has_pages": false,
        "has_downloads": false,
        "archived": false,
        "disabled": false,
        "visibility": "public",
        "pushed_at": "2025-01-15T15:47:13Z",
        "created_at": "2010-12-19T15:16:43Z",
        "updated_at": "2025-01-15T15:47:18Z",
        "allow_forking": true,
        "license": {
          "key": "mit",
          "name": "MIT License",
          "node_id": "MDc6TGljZW5zZTEz",
          "spdx_id": "MIT",
          "url": "https://api.github.com/licenses/mit",
          "html_url": null,
          "description": null,
          "implementation": null,
          "permissions": null,
          "conditions": null,
          "limitations": null,
          "body": null,
          "featured": null
        }
      }
    },
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31483"
      }
    },
    "author_association": "CONTRIBUTOR",
    "draft": false,
    "additions": 321,
    "deletions": 75,
    "changed_files": 18,
    "commits": 8,
    "review_comments": 109,
    "comments": 22
  },
  "events": [
    {
      "event": "commented",
      "id": 2538749277,
      "node_id": "IC_kwDOABII586XUj1d",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2538749277",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-12-12T12:17:59Z",
      "updated_at": "2025-01-15T15:43:04Z",
      "author_association": "CONTRIBUTOR",
      "body": "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--006a51241073e994b41acfe9ec718e94-->\n### Code Coverage & Benchmarks\nFor details see: https://corecheck.dev/bitcoin/bitcoin/pulls/31483.\n<!--021abf342d371248e50ceaed478a90ca-->\n### Reviews\nSee [the guideline](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#code-review) for information on the review process.\n| Type | Reviewers |\n| ---- | --------- |\n| ACK | [stickies-v](https://github.com/bitcoin/bitcoin/pull/31483#issuecomment-2593266357) |\n| Stale ACK | [hodlinator](https://github.com/bitcoin/bitcoin/pull/31483#pullrequestreview-2545245484), [ryanofsky](https://github.com/bitcoin/bitcoin/pull/31483#pullrequestreview-2552875375) |\n\nIf your review is incorrectly listed, please react with 👎 to this comment and the bot will ignore it on the next update.\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* [#31645](https://github.com/bitcoin/bitcoin/pull/31645) (optimization: increase default LevelDB write batch size to 64 MiB by l0rinc)\n* [#30965](https://github.com/bitcoin/bitcoin/pull/30965) (kernel: Move block tree db open to block manager by TheCharlatan)\n* [#24539](https://github.com/bitcoin/bitcoin/pull/24539) (Add a \"tx output spender\" index by sstone)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.\n",
      "user": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31483#issuecomment-2538749277",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/31483"
    },
    {
      "event": "labeled",
      "id": 15633722647,
      "node_id": "LE_lADOABII586jEBuMzwAAAAOj160X",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/15633722647",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-12-12T12:18:02Z",
      "label": {
        "name": "Validation",
        "color": "6060aa"
      }
    },
    {
      "event": "reviewed",
      "id": 2499365306,
      "node_id": "PRR_kwDOABII586U-Um6",
      "url": null,
      "actor": null,
      "commit_id": "62da6a0b1ef99fc00357e967fe868ca3235cc4fb",
      "commit_url": null,
      "created_at": null,
      "author_association": "CONTRIBUTOR",
      "user": {
        "login": "ajtowns",
        "id": 127186,
        "node_id": "MDQ6VXNlcjEyNzE4Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/127186?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ajtowns",
        "html_url": "https://github.com/ajtowns",
        "followers_url": "https://api.github.com/users/ajtowns/followers",
        "following_url": "https://api.github.com/users/ajtowns/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ajtowns/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ajtowns/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ajtowns/subscriptions",
        "organizations_url": "https://api.github.com/users/ajtowns/orgs",
        "repos_url": "https://api.github.com/users/ajtowns/repos",
        "events_url": "https://api.github.com/users/ajtowns/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ajtowns/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31483#pullrequestreview-2499365306",
      "submitted_at": "2024-12-12T12:40:40Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31483"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 15634223112,
      "node_id": "HRFPE_lADOABII586jEBuMzwAAAAOj31AI",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/15634223112",
      "actor": {
        "login": "TheCharlatan",
        "id": 8421793,
        "node_id": "MDQ6VXNlcjg0MjE3OTM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8421793?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/TheCharlatan",
        "html_url": "https://github.com/TheCharlatan",
        "followers_url": "https://api.github.com/users/TheCharlatan/followers",
        "following_url": "https://api.github.com/users/TheCharlatan/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/TheCharlatan/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/TheCharlatan/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/TheCharlatan/subscriptions",
        "organizations_url": "https://api.github.com/users/TheCharlatan/orgs",
        "repos_url": "https://api.github.com/users/TheCharlatan/repos",
        "events_url": "https://api.github.com/users/TheCharlatan/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/TheCharlatan/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": "173477b5efad4723863b38fe51cd1156620d01df",
      "commit_url": "https://api.github.com/repos/TheCharlatan/bitcoin/commits/173477b5efad4723863b38fe51cd1156620d01df",
      "created_at": "2024-12-12T12:58:34Z"
    },
    {
      "event": "reviewed",
      "id": 2501686219,
      "node_id": "PRR_kwDOABII586VHLPL",
      "url": null,
      "actor": null,
      "commit_id": "173477b5efad4723863b38fe51cd1156620d01df",
      "commit_url": null,
      "created_at": null,
      "author_association": "CONTRIBUTOR",
      "body": "Concept ACK. Makes sense to separate this.",
      "user": {
        "login": "stickies-v",
        "id": 69010457,
        "node_id": "MDQ6VXNlcjY5MDEwNDU3",
        "avatar_url": "https://avatars.githubusercontent.com/u/69010457?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stickies-v",
        "html_url": "https://github.com/stickies-v",
        "followers_url": "https://api.github.com/users/stickies-v/followers",
        "following_url": "https://api.github.com/users/stickies-v/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stickies-v/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stickies-v/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stickies-v/subscriptions",
        "organizations_url": "https://api.github.com/users/stickies-v/orgs",
        "repos_url": "https://api.github.com/users/stickies-v/repos",
        "events_url": "https://api.github.com/users/stickies-v/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stickies-v/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31483#pullrequestreview-2501686219",
      "submitted_at": "2024-12-13T15:12:13Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31483"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 15656759866,
      "node_id": "HRFPE_lADOABII586jEBuMzwAAAAOlNzI6",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/15656759866",
      "actor": {
        "login": "TheCharlatan",
        "id": 8421793,
        "node_id": "MDQ6VXNlcjg0MjE3OTM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8421793?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/TheCharlatan",
        "html_url": "https://github.com/TheCharlatan",
        "followers_url": "https://api.github.com/users/TheCharlatan/followers",
        "following_url": "https://api.github.com/users/TheCharlatan/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/TheCharlatan/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/TheCharlatan/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/TheCharlatan/subscriptions",
        "organizations_url": "https://api.github.com/users/TheCharlatan/orgs",
        "repos_url": "https://api.github.com/users/TheCharlatan/repos",
        "events_url": "https://api.github.com/users/TheCharlatan/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/TheCharlatan/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": "f454987be6f140aca6c13ab3abf94c3afa183fdf",
      "commit_url": "https://api.github.com/repos/TheCharlatan/bitcoin/commits/f454987be6f140aca6c13ab3abf94c3afa183fdf",
      "created_at": "2024-12-14T10:10:06Z"
    },
    {
      "event": "commented",
      "id": 2543040080,
      "node_id": "IC_kwDOABII586Xk7ZQ",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2543040080",
      "actor": {
        "login": "TheCharlatan",
        "id": 8421793,
        "node_id": "MDQ6VXNlcjg0MjE3OTM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8421793?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/TheCharlatan",
        "html_url": "https://github.com/TheCharlatan",
        "followers_url": "https://api.github.com/users/TheCharlatan/followers",
        "following_url": "https://api.github.com/users/TheCharlatan/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/TheCharlatan/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/TheCharlatan/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/TheCharlatan/subscriptions",
        "organizations_url": "https://api.github.com/users/TheCharlatan/orgs",
        "repos_url": "https://api.github.com/users/TheCharlatan/repos",
        "events_url": "https://api.github.com/users/TheCharlatan/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/TheCharlatan/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-12-14T10:10:09Z",
      "updated_at": "2024-12-14T10:10:09Z",
      "author_association": "CONTRIBUTOR",
      "body": "Thanks for the review @stickies-v,\r\n\r\nUpdated 173477b5efad4723863b38fe51cd1156620d01df -> f454987be6f140aca6c13ab3abf94c3afa183fdf ([kernel_cache_sizes_0](https://github.com/TheCharlatan/bitcoin/tree/kernel_cache_sizes_0) -> [kernel_cache_sizes_1](https://github.com/TheCharlatan/bitcoin/tree/kernel_cache_sizes_1), [compare](https://github.com/TheCharlatan/bitcoin/compare/kernel_cache_sizes_0..kernel_cache_sizes_1))\r\n\r\n* Addressed @stickies-v's  [comment](https://github.com/bitcoin/bitcoin/pull/31483#discussion_r1884078251), removed unnecassary new index size member in the tests.\r\n* Addressed @stickies-v's [comment](https://github.com/bitcoin/bitcoin/pull/31483#discussion_r1883694847), fixed commit order for include addition and optionsmodel and removed the no longer needed txdb include.",
      "user": {
        "login": "TheCharlatan",
        "id": 8421793,
        "node_id": "MDQ6VXNlcjg0MjE3OTM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8421793?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/TheCharlatan",
        "html_url": "https://github.com/TheCharlatan",
        "followers_url": "https://api.github.com/users/TheCharlatan/followers",
        "following_url": "https://api.github.com/users/TheCharlatan/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/TheCharlatan/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/TheCharlatan/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/TheCharlatan/subscriptions",
        "organizations_url": "https://api.github.com/users/TheCharlatan/orgs",
        "repos_url": "https://api.github.com/users/TheCharlatan/repos",
        "events_url": "https://api.github.com/users/TheCharlatan/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/TheCharlatan/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31483#issuecomment-2543040080",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/31483"
    },
    {
      "event": "mentioned",
      "id": 15656759997,
      "node_id": "MEE_lADOABII586jEBuMzwAAAAOlNzK9",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/15656759997",
      "actor": {
        "login": "stickies-v",
        "id": 69010457,
        "node_id": "MDQ6VXNlcjY5MDEwNDU3",
        "avatar_url": "https://avatars.githubusercontent.com/u/69010457?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stickies-v",
        "html_url": "https://github.com/stickies-v",
        "followers_url": "https://api.github.com/users/stickies-v/followers",
        "following_url": "https://api.github.com/users/stickies-v/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stickies-v/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stickies-v/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stickies-v/subscriptions",
        "organizations_url": "https://api.github.com/users/stickies-v/orgs",
        "repos_url": "https://api.github.com/users/stickies-v/repos",
        "events_url": "https://api.github.com/users/stickies-v/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stickies-v/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-12-14T10:10:10Z"
    },
    {
      "event": "subscribed",
      "id": 15656759999,
      "node_id": "SE_lADOABII586jEBuMzwAAAAOlNzK_",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/15656759999",
      "actor": {
        "login": "stickies-v",
        "id": 69010457,
        "node_id": "MDQ6VXNlcjY5MDEwNDU3",
        "avatar_url": "https://avatars.githubusercontent.com/u/69010457?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stickies-v",
        "html_url": "https://github.com/stickies-v",
        "followers_url": "https://api.github.com/users/stickies-v/followers",
        "following_url": "https://api.github.com/users/stickies-v/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stickies-v/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stickies-v/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stickies-v/subscriptions",
        "organizations_url": "https://api.github.com/users/stickies-v/orgs",
        "repos_url": "https://api.github.com/users/stickies-v/repos",
        "events_url": "https://api.github.com/users/stickies-v/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stickies-v/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-12-14T10:10:10Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 15676732984,
      "node_id": "HRFPE_lADOABII586jEBuMzwAAAAOmZ_Y4",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/15676732984",
      "actor": {
        "login": "TheCharlatan",
        "id": 8421793,
        "node_id": "MDQ6VXNlcjg0MjE3OTM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8421793?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/TheCharlatan",
        "html_url": "https://github.com/TheCharlatan",
        "followers_url": "https://api.github.com/users/TheCharlatan/followers",
        "following_url": "https://api.github.com/users/TheCharlatan/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/TheCharlatan/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/TheCharlatan/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/TheCharlatan/subscriptions",
        "organizations_url": "https://api.github.com/users/TheCharlatan/orgs",
        "repos_url": "https://api.github.com/users/TheCharlatan/repos",
        "events_url": "https://api.github.com/users/TheCharlatan/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/TheCharlatan/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": "2c49e0bfd295dc0326d02cd0a80853d7dee885ac",
      "commit_url": "https://api.github.com/repos/TheCharlatan/bitcoin/commits/2c49e0bfd295dc0326d02cd0a80853d7dee885ac",
      "created_at": "2024-12-16T21:28:37Z"
    },
    {
      "event": "commented",
      "id": 2546835212,
      "node_id": "IC_kwDOABII586XzZ8M",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2546835212",
      "actor": {
        "login": "TheCharlatan",
        "id": 8421793,
        "node_id": "MDQ6VXNlcjg0MjE3OTM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8421793?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/TheCharlatan",
        "html_url": "https://github.com/TheCharlatan",
        "followers_url": "https://api.github.com/users/TheCharlatan/followers",
        "following_url": "https://api.github.com/users/TheCharlatan/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/TheCharlatan/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/TheCharlatan/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/TheCharlatan/subscriptions",
        "organizations_url": "https://api.github.com/users/TheCharlatan/orgs",
        "repos_url": "https://api.github.com/users/TheCharlatan/repos",
        "events_url": "https://api.github.com/users/TheCharlatan/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/TheCharlatan/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-12-16T21:28:45Z",
      "updated_at": "2024-12-16T21:28:45Z",
      "author_association": "CONTRIBUTOR",
      "body": "Thanks for the comments @stickies-v,\r\n\r\nUpdated f454987be6f140aca6c13ab3abf94c3afa183fdf -> 2c49e0bfd295dc0326d02cd0a80853d7dee885ac ([kernel_cache_sizes_1](https://github.com/TheCharlatan/bitcoin/tree/kernel_cache_sizes_1) -> [kernel_cache_sizes_2](https://github.com/TheCharlatan/bitcoin/tree/kernel_cache_sizes_2), [compare](https://github.com/TheCharlatan/bitcoin/compare/kernel_cache_sizes_1..kernel_cache_sizes_2))\r\n\r\n* Addressed @stickies-v's [comment](https://github.com/bitcoin/bitcoin/pull/31483#discussion_r1884061716), added a kernel-specific cache size constant and moved the minimum size out of the kernel.\r\n",
      "user": {
        "login": "TheCharlatan",
        "id": 8421793,
        "node_id": "MDQ6VXNlcjg0MjE3OTM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8421793?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/TheCharlatan",
        "html_url": "https://github.com/TheCharlatan",
        "followers_url": "https://api.github.com/users/TheCharlatan/followers",
        "following_url": "https://api.github.com/users/TheCharlatan/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/TheCharlatan/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/TheCharlatan/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/TheCharlatan/subscriptions",
        "organizations_url": "https://api.github.com/users/TheCharlatan/orgs",
        "repos_url": "https://api.github.com/users/TheCharlatan/repos",
        "events_url": "https://api.github.com/users/TheCharlatan/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/TheCharlatan/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31483#issuecomment-2546835212",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/31483"
    },
    {
      "event": "mentioned",
      "id": 15676735063,
      "node_id": "MEE_lADOABII586jEBuMzwAAAAOmZ_5X",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/15676735063",
      "actor": {
        "login": "stickies-v",
        "id": 69010457,
        "node_id": "MDQ6VXNlcjY5MDEwNDU3",
        "avatar_url": "https://avatars.githubusercontent.com/u/69010457?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stickies-v",
        "html_url": "https://github.com/stickies-v",
        "followers_url": "https://api.github.com/users/stickies-v/followers",
        "following_url": "https://api.github.com/users/stickies-v/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stickies-v/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stickies-v/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stickies-v/subscriptions",
        "organizations_url": "https://api.github.com/users/stickies-v/orgs",
        "repos_url": "https://api.github.com/users/stickies-v/repos",
        "events_url": "https://api.github.com/users/stickies-v/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stickies-v/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-12-16T21:28:46Z"
    },
    {
      "event": "subscribed",
      "id": 15676735081,
      "node_id": "SE_lADOABII586jEBuMzwAAAAOmZ_5p",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/15676735081",
      "actor": {
        "login": "stickies-v",
        "id": 69010457,
        "node_id": "MDQ6VXNlcjY5MDEwNDU3",
        "avatar_url": "https://avatars.githubusercontent.com/u/69010457?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stickies-v",
        "html_url": "https://github.com/stickies-v",
        "followers_url": "https://api.github.com/users/stickies-v/followers",
        "following_url": "https://api.github.com/users/stickies-v/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stickies-v/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stickies-v/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stickies-v/subscriptions",
        "organizations_url": "https://api.github.com/users/stickies-v/orgs",
        "repos_url": "https://api.github.com/users/stickies-v/repos",
        "events_url": "https://api.github.com/users/stickies-v/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stickies-v/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-12-16T21:28:46Z"
    },
    {
      "event": "reviewed",
      "id": 2508948359,
      "node_id": "PRR_kwDOABII586Vi4OH",
      "url": null,
      "actor": null,
      "commit_id": "2c49e0bfd295dc0326d02cd0a80853d7dee885ac",
      "commit_url": null,
      "created_at": null,
      "author_association": "CONTRIBUTOR",
      "body": "ACK 2c49e0bfd295dc0326d02cd0a80853d7dee885ac\r\n\r\nThe only behaviour change is a very slight difference in cache allocation by moving `block_tree_db` allocation after index allocation. Because `block_tree_db` is capped at 2MiB, the maximum impact this change can have is very limited. Even at the most extreme case with `-dbcache=4 -txindex -blockfilterindex=1`, the results are not meaningfully different:\r\n\r\nOn master:\r\n```\r\n2024-12-17T14:25:35Z Cache configuration:\r\n2024-12-17T14:25:35Z * Using 0.5 MiB for block index database\r\n2024-12-17T14:25:35Z * Using 0.4 MiB for transaction index database\r\n2024-12-17T14:25:35Z * Using 0.4 MiB for basic block filter index database\r\n2024-12-17T14:25:35Z * Using 1.3 MiB for chain state database\r\n2024-12-17T14:25:35Z * Using 1.3 MiB for in-memory UTXO set (plus up to 286.1 MiB of unused mempool space)\r\n```\r\n\r\nWith this PR:\r\n```\r\n2024-12-17T14:27:38Z Cache configuration:\r\n2024-12-17T14:27:38Z * Using 0.4 MiB for block index database\r\n2024-12-17T14:27:38Z * Using 0.5 MiB for transaction index database\r\n2024-12-17T14:27:38Z * Using 0.4 MiB for basic block filter index database\r\n2024-12-17T14:27:38Z * Using 1.3 MiB for chain state database\r\n2024-12-17T14:27:38Z * Using 1.3 MiB for in-memory UTXO set (plus up to 286.1 MiB of unused mempool space)\r\n```",
      "user": {
        "login": "stickies-v",
        "id": 69010457,
        "node_id": "MDQ6VXNlcjY5MDEwNDU3",
        "avatar_url": "https://avatars.githubusercontent.com/u/69010457?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stickies-v",
        "html_url": "https://github.com/stickies-v",
        "followers_url": "https://api.github.com/users/stickies-v/followers",
        "following_url": "https://api.github.com/users/stickies-v/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stickies-v/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stickies-v/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stickies-v/subscriptions",
        "organizations_url": "https://api.github.com/users/stickies-v/orgs",
        "repos_url": "https://api.github.com/users/stickies-v/repos",
        "events_url": "https://api.github.com/users/stickies-v/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stickies-v/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31483#pullrequestreview-2508948359",
      "submitted_at": "2024-12-17T14:31:11Z",
      "state": "APPROVED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31483"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 15688050928,
      "node_id": "HRFPE_lADOABII586jEBuMzwAAAAOnFKjw",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/15688050928",
      "actor": {
        "login": "TheCharlatan",
        "id": 8421793,
        "node_id": "MDQ6VXNlcjg0MjE3OTM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8421793?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/TheCharlatan",
        "html_url": "https://github.com/TheCharlatan",
        "followers_url": "https://api.github.com/users/TheCharlatan/followers",
        "following_url": "https://api.github.com/users/TheCharlatan/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/TheCharlatan/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/TheCharlatan/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/TheCharlatan/subscriptions",
        "organizations_url": "https://api.github.com/users/TheCharlatan/orgs",
        "repos_url": "https://api.github.com/users/TheCharlatan/repos",
        "events_url": "https://api.github.com/users/TheCharlatan/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/TheCharlatan/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": "8e929e343e14b0228f6f4841ecf2d85a73afda3b",
      "commit_url": "https://api.github.com/repos/TheCharlatan/bitcoin/commits/8e929e343e14b0228f6f4841ecf2d85a73afda3b",
      "created_at": "2024-12-17T15:37:32Z"
    },
    {
      "event": "commented",
      "id": 2548783892,
      "node_id": "IC_kwDOABII586X61sU",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2548783892",
      "actor": {
        "login": "TheCharlatan",
        "id": 8421793,
        "node_id": "MDQ6VXNlcjg0MjE3OTM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8421793?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/TheCharlatan",
        "html_url": "https://github.com/TheCharlatan",
        "followers_url": "https://api.github.com/users/TheCharlatan/followers",
        "following_url": "https://api.github.com/users/TheCharlatan/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/TheCharlatan/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/TheCharlatan/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/TheCharlatan/subscriptions",
        "organizations_url": "https://api.github.com/users/TheCharlatan/orgs",
        "repos_url": "https://api.github.com/users/TheCharlatan/repos",
        "events_url": "https://api.github.com/users/TheCharlatan/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/TheCharlatan/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-12-17T15:37:34Z",
      "updated_at": "2024-12-17T15:37:34Z",
      "author_association": "CONTRIBUTOR",
      "body": "Updated 2c49e0bfd295dc0326d02cd0a80853d7dee885ac -> 8e929e343e14b0228f6f4841ecf2d85a73afda3b ([kernel_cache_sizes_2](https://github.com/TheCharlatan/bitcoin/tree/kernel_cache_sizes_2) -> [kernel_cache_sizes_3](https://github.com/TheCharlatan/bitcoin/tree/kernel_cache_sizes_3), [compare](https://github.com/TheCharlatan/bitcoin/compare/kernel_cache_sizes_2..kernel_cache_sizes_3))\r\n\r\n* Addressed @stickies-v's [comment](https://github.com/bitcoin/bitcoin/pull/31483#discussion_r1888558172), removed redundant comment.",
      "user": {
        "login": "TheCharlatan",
        "id": 8421793,
        "node_id": "MDQ6VXNlcjg0MjE3OTM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8421793?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/TheCharlatan",
        "html_url": "https://github.com/TheCharlatan",
        "followers_url": "https://api.github.com/users/TheCharlatan/followers",
        "following_url": "https://api.github.com/users/TheCharlatan/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/TheCharlatan/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/TheCharlatan/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/TheCharlatan/subscriptions",
        "organizations_url": "https://api.github.com/users/TheCharlatan/orgs",
        "repos_url": "https://api.github.com/users/TheCharlatan/repos",
        "events_url": "https://api.github.com/users/TheCharlatan/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/TheCharlatan/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31483#issuecomment-2548783892",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/31483"
    },
    {
      "event": "mentioned",
      "id": 15688052299,
      "node_id": "MEE_lADOABII586jEBuMzwAAAAOnFK5L",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/15688052299",
      "actor": {
        "login": "stickies-v",
        "id": 69010457,
        "node_id": "MDQ6VXNlcjY5MDEwNDU3",
        "avatar_url": "https://avatars.githubusercontent.com/u/69010457?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stickies-v",
        "html_url": "https://github.com/stickies-v",
        "followers_url": "https://api.github.com/users/stickies-v/followers",
        "following_url": "https://api.github.com/users/stickies-v/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stickies-v/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stickies-v/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stickies-v/subscriptions",
        "organizations_url": "https://api.github.com/users/stickies-v/orgs",
        "repos_url": "https://api.github.com/users/stickies-v/repos",
        "events_url": "https://api.github.com/users/stickies-v/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stickies-v/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-12-17T15:37:37Z"
    },
    {
      "event": "subscribed",
      "id": 15688052350,
      "node_id": "SE_lADOABII586jEBuMzwAAAAOnFK5-",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/15688052350",
      "actor": {
        "login": "stickies-v",
        "id": 69010457,
        "node_id": "MDQ6VXNlcjY5MDEwNDU3",
        "avatar_url": "https://avatars.githubusercontent.com/u/69010457?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stickies-v",
        "html_url": "https://github.com/stickies-v",
        "followers_url": "https://api.github.com/users/stickies-v/followers",
        "following_url": "https://api.github.com/users/stickies-v/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stickies-v/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stickies-v/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stickies-v/subscriptions",
        "organizations_url": "https://api.github.com/users/stickies-v/orgs",
        "repos_url": "https://api.github.com/users/stickies-v/repos",
        "events_url": "https://api.github.com/users/stickies-v/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stickies-v/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-12-17T15:37:37Z"
    },
    {
      "event": "reviewed",
      "id": 2509607744,
      "node_id": "PRR_kwDOABII586VlZNA",
      "url": null,
      "actor": null,
      "commit_id": "8e929e343e14b0228f6f4841ecf2d85a73afda3b",
      "commit_url": null,
      "created_at": null,
      "author_association": "CONTRIBUTOR",
      "body": "re-ACK 8e929e343e14b0228f6f4841ecf2d85a73afda3b - just a small doc change.",
      "user": {
        "login": "stickies-v",
        "id": 69010457,
        "node_id": "MDQ6VXNlcjY5MDEwNDU3",
        "avatar_url": "https://avatars.githubusercontent.com/u/69010457?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stickies-v",
        "html_url": "https://github.com/stickies-v",
        "followers_url": "https://api.github.com/users/stickies-v/followers",
        "following_url": "https://api.github.com/users/stickies-v/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stickies-v/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stickies-v/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stickies-v/subscriptions",
        "organizations_url": "https://api.github.com/users/stickies-v/orgs",
        "repos_url": "https://api.github.com/users/stickies-v/repos",
        "events_url": "https://api.github.com/users/stickies-v/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stickies-v/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31483#pullrequestreview-2509607744",
      "submitted_at": "2024-12-17T17:34:43Z",
      "state": "APPROVED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31483"
    },
    {
      "event": "reviewed",
      "id": 2509692136,
      "node_id": "PRR_kwDOABII586Vltzo",
      "url": null,
      "actor": null,
      "commit_id": "8e929e343e14b0228f6f4841ecf2d85a73afda3b",
      "commit_url": null,
      "created_at": null,
      "author_association": "CONTRIBUTOR",
      "body": "Code review ACK 8e929e343e14b0228f6f4841ecf2d85a73afda3b. All these changes make sense and definitely make the kernel API nicer.\r\n\r\nI do also think it would be an improvement to change all the int64_t fields to size_t since they just get casted to size_t in the end anyway, and because size_t is more self-documenting and makes it clearer the sizes are in bytes.",
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31483#pullrequestreview-2509692136",
      "submitted_at": "2024-12-17T18:24:26Z",
      "state": "APPROVED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31483"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 15693181451,
      "node_id": "HRFPE_lADOABII586jEBuMzwAAAAOnYvIL",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/15693181451",
      "actor": {
        "login": "TheCharlatan",
        "id": 8421793,
        "node_id": "MDQ6VXNlcjg0MjE3OTM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8421793?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/TheCharlatan",
        "html_url": "https://github.com/TheCharlatan",
        "followers_url": "https://api.github.com/users/TheCharlatan/followers",
        "following_url": "https://api.github.com/users/TheCharlatan/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/TheCharlatan/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/TheCharlatan/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/TheCharlatan/subscriptions",
        "organizations_url": "https://api.github.com/users/TheCharlatan/orgs",
        "repos_url": "https://api.github.com/users/TheCharlatan/repos",
        "events_url": "https://api.github.com/users/TheCharlatan/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/TheCharlatan/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": "7517126d9fd2c3e50dc95ce831bac6895b950e24",
      "commit_url": "https://api.github.com/repos/TheCharlatan/bitcoin/commits/7517126d9fd2c3e50dc95ce831bac6895b950e24",
      "created_at": "2024-12-17T21:14:40Z"
    },
    {
      "event": "commented",
      "id": 2549645058,
      "node_id": "IC_kwDOABII586X-H8C",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2549645058",
      "actor": {
        "login": "TheCharlatan",
        "id": 8421793,
        "node_id": "MDQ6VXNlcjg0MjE3OTM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8421793?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/TheCharlatan",
        "html_url": "https://github.com/TheCharlatan",
        "followers_url": "https://api.github.com/users/TheCharlatan/followers",
        "following_url": "https://api.github.com/users/TheCharlatan/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/TheCharlatan/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/TheCharlatan/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/TheCharlatan/subscriptions",
        "organizations_url": "https://api.github.com/users/TheCharlatan/orgs",
        "repos_url": "https://api.github.com/users/TheCharlatan/repos",
        "events_url": "https://api.github.com/users/TheCharlatan/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/TheCharlatan/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-12-17T21:14:44Z",
      "updated_at": "2024-12-17T21:14:44Z",
      "author_association": "CONTRIBUTOR",
      "body": "Thanks for the review @ryanofsky!\r\nUpdated 8e929e343e14b0228f6f4841ecf2d85a73afda3b -> 7517126d9fd2c3e50dc95ce831bac6895b950e24 ([kernel_cache_sizes_3](https://github.com/TheCharlatan/bitcoin/tree/kernel_cache_sizes_3) -> [kernel_cache_sizes_4](https://github.com/TheCharlatan/bitcoin/tree/kernel_cache_sizes_4), [compare](https://github.com/TheCharlatan/bitcoin/compare/kernel_cache_sizes_3..kernel_cache_sizes_4))\r\n\r\n* Addressed @ryanofsky's [comment](https://github.com/bitcoin/bitcoin/pull/31483#discussion_r1888992732), removed (redundant?) logic from coins_db cache size calculation.\r\n* Took @ryanofsky's [suggestion](https://github.com/bitcoin/bitcoin/pull/31483#pullrequestreview-2509692136), made the cache fields `size_t`.",
      "user": {
        "login": "TheCharlatan",
        "id": 8421793,
        "node_id": "MDQ6VXNlcjg0MjE3OTM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8421793?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/TheCharlatan",
        "html_url": "https://github.com/TheCharlatan",
        "followers_url": "https://api.github.com/users/TheCharlatan/followers",
        "following_url": "https://api.github.com/users/TheCharlatan/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/TheCharlatan/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/TheCharlatan/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/TheCharlatan/subscriptions",
        "organizations_url": "https://api.github.com/users/TheCharlatan/orgs",
        "repos_url": "https://api.github.com/users/TheCharlatan/repos",
        "events_url": "https://api.github.com/users/TheCharlatan/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/TheCharlatan/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31483#issuecomment-2549645058",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/31483"
    },
    {
      "event": "mentioned",
      "id": 15693182227,
      "node_id": "MEE_lADOABII586jEBuMzwAAAAOnYvUT",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/15693182227",
      "actor": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-12-17T21:14:45Z"
    },
    {
      "event": "subscribed",
      "id": 15693182244,
      "node_id": "SE_lADOABII586jEBuMzwAAAAOnYvUk",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/15693182244",
      "actor": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-12-17T21:14:45Z"
    },
    {
      "event": "reviewed",
      "id": 2511656329,
      "node_id": "PRR_kwDOABII586VtNWJ",
      "url": null,
      "actor": null,
      "commit_id": "7517126d9fd2c3e50dc95ce831bac6895b950e24",
      "commit_url": null,
      "created_at": null,
      "author_association": "CONTRIBUTOR",
      "body": "re-ACK 7517126d9fd2c3e50dc95ce831bac6895b950e24\r\n\r\nI think c71fc6ac6e62e5eea96e8aa4e0f43260afc81723 is an absolute improvement, ~~but I'm [~0](https://github.com/bitcoin/bitcoin/pull/31483#discussion_r1890151750) on 7517126d9fd2c3e50dc95ce831bac6895b950e24~~. (edit: [resolved](https://github.com/bitcoin/bitcoin/pull/31483/files#r1890652637))",
      "user": {
        "login": "stickies-v",
        "id": 69010457,
        "node_id": "MDQ6VXNlcjY5MDEwNDU3",
        "avatar_url": "https://avatars.githubusercontent.com/u/69010457?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stickies-v",
        "html_url": "https://github.com/stickies-v",
        "followers_url": "https://api.github.com/users/stickies-v/followers",
        "following_url": "https://api.github.com/users/stickies-v/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stickies-v/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stickies-v/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stickies-v/subscriptions",
        "organizations_url": "https://api.github.com/users/stickies-v/orgs",
        "repos_url": "https://api.github.com/users/stickies-v/repos",
        "events_url": "https://api.github.com/users/stickies-v/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stickies-v/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31483#pullrequestreview-2511656329",
      "submitted_at": "2024-12-18T12:24:28Z",
      "state": "APPROVED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31483"
    },
    {
      "event": "review_requested",
      "id": 15702523424,
      "node_id": "RRE_lADOABII586jEBuMzwAAAAOn8X4g",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/15702523424",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-12-18T12:24:32Z",
      "requested_reviewer": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "review_requester": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      }
    },
    {
      "event": "reviewed",
      "id": 2512351049,
      "node_id": "PRR_kwDOABII586Vv29J",
      "url": null,
      "actor": null,
      "commit_id": "7517126d9fd2c3e50dc95ce831bac6895b950e24",
      "commit_url": null,
      "created_at": null,
      "author_association": "CONTRIBUTOR",
      "body": "Code review ACK 7517126d9fd2c3e50dc95ce831bac6895b950e24. Just added two new commits since last review simplifying coinsdb cache calculation and switching to size_t to avoid casts. Thanks for the updates!",
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31483#pullrequestreview-2512351049",
      "submitted_at": "2024-12-18T17:09:18Z",
      "state": "APPROVED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31483"
    },
    {
      "event": "reviewed",
      "id": 2518616838,
      "node_id": "PRR_kwDOABII586WHwsG",
      "url": null,
      "actor": null,
      "commit_id": "7517126d9fd2c3e50dc95ce831bac6895b950e24",
      "commit_url": null,
      "created_at": null,
      "author_association": "CONTRIBUTOR",
      "body": "Code review 7517126d9fd2c3e50dc95ce831bac6895b950e24\r\n\r\nSome concern over implicit narrowing on 32-bit platforms (see inline comments).\r\n\r\n*Rough* suggestions: https://github.com/TheCharlatan/bitcoin/compare/kernel_cache_sizes...hodlinator:bitcoin:pr/31483_suggestions\r\n\\+ Use of curly braces to catch narrowing.\r\n\\+ The above encourages asserts, leading to finding cases where truncation would eventually happen (increasing `DEFAULT_KERNEL_CACHE` by 10x triggers assert).\r\n\\- ~Not so happy about my strategy to avoid repeated asserts and casts, that part is definitely WIP.~ Edit: Ended up replacing user defined literal solution with simple free function ([previous fancy & ugly solution](https://github.com/TheCharlatan/bitcoin/compare/kernel_cache_sizes...d535c2fd447cd09d6e86f08e8b0c6ed9f16240f5)).",
      "user": {
        "login": "hodlinator",
        "id": 172445034,
        "node_id": "U_kgDOCkdNag",
        "avatar_url": "https://avatars.githubusercontent.com/u/172445034?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/hodlinator",
        "html_url": "https://github.com/hodlinator",
        "followers_url": "https://api.github.com/users/hodlinator/followers",
        "following_url": "https://api.github.com/users/hodlinator/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/hodlinator/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/hodlinator/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/hodlinator/subscriptions",
        "organizations_url": "https://api.github.com/users/hodlinator/orgs",
        "repos_url": "https://api.github.com/users/hodlinator/repos",
        "events_url": "https://api.github.com/users/hodlinator/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/hodlinator/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31483#pullrequestreview-2518616838",
      "submitted_at": "2024-12-21T22:25:25Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31483"
    },
    {
      "event": "commented",
      "id": 2558635023,
      "node_id": "IC_kwDOABII586YgawP",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2558635023",
      "actor": {
        "login": "TheCharlatan",
        "id": 8421793,
        "node_id": "MDQ6VXNlcjg0MjE3OTM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8421793?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/TheCharlatan",
        "html_url": "https://github.com/TheCharlatan",
        "followers_url": "https://api.github.com/users/TheCharlatan/followers",
        "following_url": "https://api.github.com/users/TheCharlatan/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/TheCharlatan/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/TheCharlatan/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/TheCharlatan/subscriptions",
        "organizations_url": "https://api.github.com/users/TheCharlatan/orgs",
        "repos_url": "https://api.github.com/users/TheCharlatan/repos",
        "events_url": "https://api.github.com/users/TheCharlatan/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/TheCharlatan/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-12-22T22:53:09Z",
      "updated_at": "2024-12-22T22:53:09Z",
      "author_association": "CONTRIBUTOR",
      "body": "Thank you for the suggestions @hodlinator, I appreciate the time you took for this. I was originally intent on tackling the 32bit case in a follow-up, mainly because I was thinking whether we should trap the max amount of cache at `numeric_limits<size_t>::max()`. That might be a bit friendlier than just running into an assert, some kind of allocation failure, or much less cache being allocated than requested. With your suggestions, I agree that this should be handled in this PR now.",
      "user": {
        "login": "TheCharlatan",
        "id": 8421793,
        "node_id": "MDQ6VXNlcjg0MjE3OTM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8421793?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/TheCharlatan",
        "html_url": "https://github.com/TheCharlatan",
        "followers_url": "https://api.github.com/users/TheCharlatan/followers",
        "following_url": "https://api.github.com/users/TheCharlatan/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/TheCharlatan/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/TheCharlatan/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/TheCharlatan/subscriptions",
        "organizations_url": "https://api.github.com/users/TheCharlatan/orgs",
        "repos_url": "https://api.github.com/users/TheCharlatan/repos",
        "events_url": "https://api.github.com/users/TheCharlatan/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/TheCharlatan/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31483#issuecomment-2558635023",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/31483"
    },
    {
      "event": "mentioned",
      "id": 15742515994,
      "node_id": "MEE_lADOABII586jEBuMzwAAAAOqU7sa",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/15742515994",
      "actor": {
        "login": "hodlinator",
        "id": 172445034,
        "node_id": "U_kgDOCkdNag",
        "avatar_url": "https://avatars.githubusercontent.com/u/172445034?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/hodlinator",
        "html_url": "https://github.com/hodlinator",
        "followers_url": "https://api.github.com/users/hodlinator/followers",
        "following_url": "https://api.github.com/users/hodlinator/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/hodlinator/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/hodlinator/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/hodlinator/subscriptions",
        "organizations_url": "https://api.github.com/users/hodlinator/orgs",
        "repos_url": "https://api.github.com/users/hodlinator/repos",
        "events_url": "https://api.github.com/users/hodlinator/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/hodlinator/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-12-22T22:53:10Z"
    },
    {
      "event": "subscribed",
      "id": 15742515997,
      "node_id": "SE_lADOABII586jEBuMzwAAAAOqU7sd",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/15742515997",
      "actor": {
        "login": "hodlinator",
        "id": 172445034,
        "node_id": "U_kgDOCkdNag",
        "avatar_url": "https://avatars.githubusercontent.com/u/172445034?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/hodlinator",
        "html_url": "https://github.com/hodlinator",
        "followers_url": "https://api.github.com/users/hodlinator/followers",
        "following_url": "https://api.github.com/users/hodlinator/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/hodlinator/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/hodlinator/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/hodlinator/subscriptions",
        "organizations_url": "https://api.github.com/users/hodlinator/orgs",
        "repos_url": "https://api.github.com/users/hodlinator/repos",
        "events_url": "https://api.github.com/users/hodlinator/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/hodlinator/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-12-22T22:53:10Z"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDVkYjdkNGQzZDI4YmQxMjY5YTA5OTU1YjQ2OTUxMzVjODZjNDgyN2Q",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/5db7d4d3d28bd1269a09955b4695135c86c4827d",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/5db7d4d3d28bd1269a09955b4695135c86c4827d",
      "tree": {
        "sha": "20ac54c8c9e9713453f98712a44b3825d65c22a6",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/20ac54c8c9e9713453f98712a44b3825d65c22a6"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree 20ac54c8c9e9713453f98712a44b3825d65c22a6\nparent 37e49c2c7ca5969124830d79b2cb31041c570755\nauthor TheCharlatan <seb.kung@gmail.com> 1733951722 +0100\ncommitter TheCharlatan <seb.kung@gmail.com> 1735924295 +0100\n\ndoc: Correct docstring describing max block tree db cache\n\nIt is always applied in the same way, no matter how the txindex is\nsetup. This was no longer accurate after 8181db8, where their\ninitialization was made independent.\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCgAdFiEE8s/Eq9C5nYN+67fQm3m0VpHbQXMFAmd4GyAACgkQm3m0VpHb\nQXP16RAAvpkRI4rgZB8Fk2liJoKXjjL88sGUCGPsfTJO2kZgt/eOiGRzRdr/HLta\nPu8E8p8KaTkG683lBqySfF6h52hEEszVn0Z9kKMVGiQKI1T53jRDJ7xkPCBRo+kn\n/rCcUg0Fzds+YkrI3G/BmCfi5nsgMUkAMqCo+WxU7rScibKZxBBpafnE/SC7Y/Ob\n/Abk3SXXyMJNVN1T+E7c/NqnwBN0p2yZ1GtLQSWszQ5DtHX15P0cPrd+gf82hOAj\nqQjNG/saaCSKsJr2IBEPGMpDOFPIGI28DhBsVwBoTAWZa4G17pXmVSfCbjtn59Oe\nbyufscmvdiH42rJJg+Q5nrv2x8LQpg5squvDJqxyzyMHWB4ktVbJflkgHik6klRy\nLmpKns1cvUu3cVpxju4q+9qy+tR8h4NAz+Ui9XfDzJKvVM/lnC4iINCg9qfJT+hl\npRGChzeXAhdBjXViQqTyatfgmg84aRzHuC/sN2EfZ4wwF8T2BW3LW/PsIJyYlZg7\nWBkN2IH85bTttPQjkdu4C7Ji5OggvXQ8ss+4TgQ9/n7XgHFbRXV2TtEImqzO94L+\nAAcQn20sYxV2FPrAZ8NzsxsuHfHphRKTdKtjNNa8qtqx2Eh0veCGx6gt77SlItyT\ntUxWbEmh/hk8go8xcz1ZmRrcnLFlDI7wcI/xvtiCmUbPw0FaUhg=\n=iSbO\n-----END PGP SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/37e49c2c7ca5969124830d79b2cb31041c570755",
          "sha": "37e49c2c7ca5969124830d79b2cb31041c570755",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/37e49c2c7ca5969124830d79b2cb31041c570755"
        }
      ],
      "message": "doc: Correct docstring describing max block tree db cache\n\nIt is always applied in the same way, no matter how the txindex is\nsetup. This was no longer accurate after 8181db8, where their\ninitialization was made independent.",
      "committer": {
        "name": "TheCharlatan",
        "email": "seb.kung@gmail.com",
        "date": "2025-01-03T17:11:35Z"
      },
      "author": {
        "name": "TheCharlatan",
        "email": "seb.kung@gmail.com",
        "date": "2024-12-11T21:15:22Z"
      },
      "sha": "5db7d4d3d28bd1269a09955b4695135c86c4827d"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 15809467706,
      "node_id": "HRFPE_lADOABII586jEBuMzwAAAAOuUVU6",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/15809467706",
      "actor": {
        "login": "TheCharlatan",
        "id": 8421793,
        "node_id": "MDQ6VXNlcjg0MjE3OTM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8421793?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/TheCharlatan",
        "html_url": "https://github.com/TheCharlatan",
        "followers_url": "https://api.github.com/users/TheCharlatan/followers",
        "following_url": "https://api.github.com/users/TheCharlatan/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/TheCharlatan/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/TheCharlatan/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/TheCharlatan/subscriptions",
        "organizations_url": "https://api.github.com/users/TheCharlatan/orgs",
        "repos_url": "https://api.github.com/users/TheCharlatan/repos",
        "events_url": "https://api.github.com/users/TheCharlatan/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/TheCharlatan/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": "ad80e410b3bf8814cb5b997715ee8cb28f2a2a66",
      "commit_url": "https://api.github.com/repos/TheCharlatan/bitcoin/commits/ad80e410b3bf8814cb5b997715ee8cb28f2a2a66",
      "created_at": "2025-01-03T17:18:52Z"
    },
    {
      "event": "commented",
      "id": 2569566280,
      "node_id": "IC_kwDOABII586ZKHhI",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2569566280",
      "actor": {
        "login": "TheCharlatan",
        "id": 8421793,
        "node_id": "MDQ6VXNlcjg0MjE3OTM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8421793?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/TheCharlatan",
        "html_url": "https://github.com/TheCharlatan",
        "followers_url": "https://api.github.com/users/TheCharlatan/followers",
        "following_url": "https://api.github.com/users/TheCharlatan/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/TheCharlatan/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/TheCharlatan/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/TheCharlatan/subscriptions",
        "organizations_url": "https://api.github.com/users/TheCharlatan/orgs",
        "repos_url": "https://api.github.com/users/TheCharlatan/repos",
        "events_url": "https://api.github.com/users/TheCharlatan/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/TheCharlatan/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-01-03T17:18:57Z",
      "updated_at": "2025-01-03T17:19:52Z",
      "author_association": "CONTRIBUTOR",
      "body": "Thank you for the review and code suggestions @hodlinator,\r\n\r\nUpdated 7517126d9fd2c3e50dc95ce831bac6895b950e24 -> ad80e410b3bf8814cb5b997715ee8cb28f2a2a66 ([kernel_cache_sizes_4](https://github.com/TheCharlatan/bitcoin/tree/kernel_cache_sizes_4) -> [kernel_cache_sizes_5](https://github.com/TheCharlatan/bitcoin/tree/kernel_cache_sizes_5), [compare](https://github.com/TheCharlatan/bitcoin/compare/kernel_cache_sizes_4..kernel_cache_sizes_5))\r\n\r\n* Add handling for dbcache sizes exceeding `size_t` size. Previously the value would just overflow if larger than 4096 on 32 bit platforms. Now it returns an error on startup. Add a release note for it, since it changes behaviour.\r\n* Addressed @hodlinator's [comment](https://github.com/bitcoin/bitcoin/pull/31483#discussion_r1894643334), made `total_cache` a `size_t` type.\r\n* Addressed @hodlinator's [comment](https://github.com/bitcoin/bitcoin/pull/31483#discussion_r1894591427) and @stickies-v's [comment](https://github.com/bitcoin/bitcoin/pull/31483#discussion_r1883535731), replacing `std::tuple` with a new struct.\r\n* Addressed @hodlinator's [comment](https://github.com/bitcoin/bitcoin/pull/31483#discussion_r1894597050), renaming `sizes` to `index_sizes` in `node/caches.cpp`.\r\n* Addressed @hodlinator's [comment](https://github.com/bitcoin/bitcoin/pull/31483#discussion_r1894643457), document unit for `MAX_TX_INDEX_CACHE`.\r\n* Addressed @hodlinator's [comment](https://github.com/bitcoin/bitcoin/pull/31483#pullrequestreview-2518616838), add the suggested `MiBToBytes` function.\r\n* Addressed @hodlinator's [comment](https://github.com/bitcoin/bitcoin/pull/31483#discussion_r1894593777), added a hint to the commit message on when the docstring describing the block tree db cache initialization became inaccurate. ",
      "user": {
        "login": "TheCharlatan",
        "id": 8421793,
        "node_id": "MDQ6VXNlcjg0MjE3OTM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8421793?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/TheCharlatan",
        "html_url": "https://github.com/TheCharlatan",
        "followers_url": "https://api.github.com/users/TheCharlatan/followers",
        "following_url": "https://api.github.com/users/TheCharlatan/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/TheCharlatan/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/TheCharlatan/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/TheCharlatan/subscriptions",
        "organizations_url": "https://api.github.com/users/TheCharlatan/orgs",
        "repos_url": "https://api.github.com/users/TheCharlatan/repos",
        "events_url": "https://api.github.com/users/TheCharlatan/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/TheCharlatan/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31483#issuecomment-2569566280",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/31483"
    },
    {
      "event": "mentioned",
      "id": 15809468605,
      "node_id": "MEE_lADOABII586jEBuMzwAAAAOuUVi9",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/15809468605",
      "actor": {
        "login": "hodlinator",
        "id": 172445034,
        "node_id": "U_kgDOCkdNag",
        "avatar_url": "https://avatars.githubusercontent.com/u/172445034?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/hodlinator",
        "html_url": "https://github.com/hodlinator",
        "followers_url": "https://api.github.com/users/hodlinator/followers",
        "following_url": "https://api.github.com/users/hodlinator/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/hodlinator/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/hodlinator/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/hodlinator/subscriptions",
        "organizations_url": "https://api.github.com/users/hodlinator/orgs",
        "repos_url": "https://api.github.com/users/hodlinator/repos",
        "events_url": "https://api.github.com/users/hodlinator/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/hodlinator/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-01-03T17:18:58Z"
    },
    {
      "event": "subscribed",
      "id": 15809468614,
      "node_id": "SE_lADOABII586jEBuMzwAAAAOuUVjG",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/15809468614",
      "actor": {
        "login": "hodlinator",
        "id": 172445034,
        "node_id": "U_kgDOCkdNag",
        "avatar_url": "https://avatars.githubusercontent.com/u/172445034?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/hodlinator",
        "html_url": "https://github.com/hodlinator",
        "followers_url": "https://api.github.com/users/hodlinator/followers",
        "following_url": "https://api.github.com/users/hodlinator/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/hodlinator/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/hodlinator/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/hodlinator/subscriptions",
        "organizations_url": "https://api.github.com/users/hodlinator/orgs",
        "repos_url": "https://api.github.com/users/hodlinator/repos",
        "events_url": "https://api.github.com/users/hodlinator/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/hodlinator/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-01-03T17:18:58Z"
    },
    {
      "event": "mentioned",
      "id": 15809477310,
      "node_id": "MEE_lADOABII586jEBuMzwAAAAOuUXq-",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/15809477310",
      "actor": {
        "login": "stickies-v",
        "id": 69010457,
        "node_id": "MDQ6VXNlcjY5MDEwNDU3",
        "avatar_url": "https://avatars.githubusercontent.com/u/69010457?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stickies-v",
        "html_url": "https://github.com/stickies-v",
        "followers_url": "https://api.github.com/users/stickies-v/followers",
        "following_url": "https://api.github.com/users/stickies-v/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stickies-v/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stickies-v/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stickies-v/subscriptions",
        "organizations_url": "https://api.github.com/users/stickies-v/orgs",
        "repos_url": "https://api.github.com/users/stickies-v/repos",
        "events_url": "https://api.github.com/users/stickies-v/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stickies-v/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-01-03T17:20:12Z"
    },
    {
      "event": "subscribed",
      "id": 15809477319,
      "node_id": "SE_lADOABII586jEBuMzwAAAAOuUXrH",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/15809477319",
      "actor": {
        "login": "stickies-v",
        "id": 69010457,
        "node_id": "MDQ6VXNlcjY5MDEwNDU3",
        "avatar_url": "https://avatars.githubusercontent.com/u/69010457?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stickies-v",
        "html_url": "https://github.com/stickies-v",
        "followers_url": "https://api.github.com/users/stickies-v/followers",
        "following_url": "https://api.github.com/users/stickies-v/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stickies-v/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stickies-v/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stickies-v/subscriptions",
        "organizations_url": "https://api.github.com/users/stickies-v/orgs",
        "repos_url": "https://api.github.com/users/stickies-v/repos",
        "events_url": "https://api.github.com/users/stickies-v/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stickies-v/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-01-03T17:20:12Z"
    },
    {
      "event": "reviewed",
      "id": 2531853195,
      "node_id": "PRR_kwDOABII586W6QOL",
      "url": null,
      "actor": null,
      "commit_id": "ad80e410b3bf8814cb5b997715ee8cb28f2a2a66",
      "commit_url": null,
      "created_at": null,
      "author_association": "CONTRIBUTOR",
      "body": "Code review ad80e410b3bf8814cb5b997715ee8cb28f2a2a66\r\n\r\nThanks for incorporating so much of my feedback!\r\n\r\nVerified that documented cache configuration output matches PR summary. (Also double-checked that allocated memory budget without `-txindex` and `-blockfilterindex=basic` is unchanged).\r\n\r\nBuilt for 32-bit (i686 centos).\r\n\r\n---\r\nad80e410b3bf8814cb5b997715ee8cb28f2a2a66 - commit message typo: s/not/note",
      "user": {
        "login": "hodlinator",
        "id": 172445034,
        "node_id": "U_kgDOCkdNag",
        "avatar_url": "https://avatars.githubusercontent.com/u/172445034?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/hodlinator",
        "html_url": "https://github.com/hodlinator",
        "followers_url": "https://api.github.com/users/hodlinator/followers",
        "following_url": "https://api.github.com/users/hodlinator/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/hodlinator/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/hodlinator/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/hodlinator/subscriptions",
        "organizations_url": "https://api.github.com/users/hodlinator/orgs",
        "repos_url": "https://api.github.com/users/hodlinator/repos",
        "events_url": "https://api.github.com/users/hodlinator/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/hodlinator/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31483#pullrequestreview-2531853195",
      "submitted_at": "2025-01-06T14:29:53Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31483"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 15828233460,
      "node_id": "HRFPE_lADOABII586jEBuMzwAAAAOvb6z0",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/15828233460",
      "actor": {
        "login": "TheCharlatan",
        "id": 8421793,
        "node_id": "MDQ6VXNlcjg0MjE3OTM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8421793?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/TheCharlatan",
        "html_url": "https://github.com/TheCharlatan",
        "followers_url": "https://api.github.com/users/TheCharlatan/followers",
        "following_url": "https://api.github.com/users/TheCharlatan/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/TheCharlatan/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/TheCharlatan/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/TheCharlatan/subscriptions",
        "organizations_url": "https://api.github.com/users/TheCharlatan/orgs",
        "repos_url": "https://api.github.com/users/TheCharlatan/repos",
        "events_url": "https://api.github.com/users/TheCharlatan/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/TheCharlatan/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": "54bdaaefbc683a61f3051dd90bbaf69de5d6cac5",
      "commit_url": "https://api.github.com/repos/TheCharlatan/bitcoin/commits/54bdaaefbc683a61f3051dd90bbaf69de5d6cac5",
      "created_at": "2025-01-06T16:25:03Z"
    },
    {
      "event": "commented",
      "id": 2573467782,
      "node_id": "IC_kwDOABII586ZZACG",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2573467782",
      "actor": {
        "login": "TheCharlatan",
        "id": 8421793,
        "node_id": "MDQ6VXNlcjg0MjE3OTM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8421793?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/TheCharlatan",
        "html_url": "https://github.com/TheCharlatan",
        "followers_url": "https://api.github.com/users/TheCharlatan/followers",
        "following_url": "https://api.github.com/users/TheCharlatan/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/TheCharlatan/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/TheCharlatan/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/TheCharlatan/subscriptions",
        "organizations_url": "https://api.github.com/users/TheCharlatan/orgs",
        "repos_url": "https://api.github.com/users/TheCharlatan/repos",
        "events_url": "https://api.github.com/users/TheCharlatan/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/TheCharlatan/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-01-06T16:31:04Z",
      "updated_at": "2025-01-06T16:31:04Z",
      "author_association": "CONTRIBUTOR",
      "body": "Updated ad80e410b3bf8814cb5b997715ee8cb28f2a2a66 -> 54bdaaefbc683a61f3051dd90bbaf69de5d6cac5 ([kernel_cache_sizes_5](https://github.com/TheCharlatan/bitcoin/tree/kernel_cache_sizes_5) -> [kernel_cache_sizes_6](https://github.com/TheCharlatan/bitcoin/tree/kernel_cache_sizes_6), [compare](https://github.com/TheCharlatan/bitcoin/compare/kernel_cache_sizes_5..kernel_cache_sizes_6))\r\n\r\n* Addressed @hodlinator's [comment](https://github.com/bitcoin/bitcoin/pull/31483#discussion_r1903999989), took suggested simplification for the number range check and dropped unneeded cast.\r\n* Addressed @hodlinator's [comment](https://github.com/bitcoin/bitcoin/pull/31483#discussion_r1904015194), added a brief comment describing the purpose of `MiBToBytes`.\r\n* Addressed @hodlinator's [comment](https://github.com/bitcoin/bitcoin/pull/31483#discussion_r1904134914), added a check for negative -dbcache values. They are now just converted to 0, which ends up not changing the current behaviour where negative values are permitted, but the minimum dbcache value is allocated.\r\n* Addressed @hodlinator's [comment](https://github.com/bitcoin/bitcoin/pull/31483#discussion_r1904193756), use `LogInfo()` where applicable.\r\n* Addressed @hodlinator's [comment](https://github.com/bitcoin/bitcoin/pull/31483#discussion_r1904214972), mention 4GiB instead of 4096MiB for easier reading in the release notes.",
      "user": {
        "login": "TheCharlatan",
        "id": 8421793,
        "node_id": "MDQ6VXNlcjg0MjE3OTM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8421793?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/TheCharlatan",
        "html_url": "https://github.com/TheCharlatan",
        "followers_url": "https://api.github.com/users/TheCharlatan/followers",
        "following_url": "https://api.github.com/users/TheCharlatan/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/TheCharlatan/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/TheCharlatan/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/TheCharlatan/subscriptions",
        "organizations_url": "https://api.github.com/users/TheCharlatan/orgs",
        "repos_url": "https://api.github.com/users/TheCharlatan/repos",
        "events_url": "https://api.github.com/users/TheCharlatan/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/TheCharlatan/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31483#issuecomment-2573467782",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/31483"
    },
    {
      "event": "mentioned",
      "id": 15828301911,
      "node_id": "MEE_lADOABII586jEBuMzwAAAAOvcLhX",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/15828301911",
      "actor": {
        "login": "hodlinator",
        "id": 172445034,
        "node_id": "U_kgDOCkdNag",
        "avatar_url": "https://avatars.githubusercontent.com/u/172445034?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/hodlinator",
        "html_url": "https://github.com/hodlinator",
        "followers_url": "https://api.github.com/users/hodlinator/followers",
        "following_url": "https://api.github.com/users/hodlinator/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/hodlinator/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/hodlinator/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/hodlinator/subscriptions",
        "organizations_url": "https://api.github.com/users/hodlinator/orgs",
        "repos_url": "https://api.github.com/users/hodlinator/repos",
        "events_url": "https://api.github.com/users/hodlinator/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/hodlinator/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-01-06T16:31:06Z"
    },
    {
      "event": "subscribed",
      "id": 15828301927,
      "node_id": "SE_lADOABII586jEBuMzwAAAAOvcLhn",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/15828301927",
      "actor": {
        "login": "hodlinator",
        "id": 172445034,
        "node_id": "U_kgDOCkdNag",
        "avatar_url": "https://avatars.githubusercontent.com/u/172445034?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/hodlinator",
        "html_url": "https://github.com/hodlinator",
        "followers_url": "https://api.github.com/users/hodlinator/followers",
        "following_url": "https://api.github.com/users/hodlinator/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/hodlinator/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/hodlinator/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/hodlinator/subscriptions",
        "organizations_url": "https://api.github.com/users/hodlinator/orgs",
        "repos_url": "https://api.github.com/users/hodlinator/repos",
        "events_url": "https://api.github.com/users/hodlinator/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/hodlinator/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-01-06T16:31:06Z"
    },
    {
      "event": "reviewed",
      "id": 2534107645,
      "node_id": "PRR_kwDOABII586XC2n9",
      "url": null,
      "actor": null,
      "commit_id": "54bdaaefbc683a61f3051dd90bbaf69de5d6cac5",
      "commit_url": null,
      "created_at": null,
      "author_association": "CONTRIBUTOR",
      "body": "crACK 54bdaaefbc683a61f3051dd90bbaf69de5d6cac5\r\n\r\nThanks again for incorporating my suggestions. Preserving previous behavior for negative `-dbcache` values seems good.\r\n\r\n3 nits remaining:\r\n\r\n54bdaaefbc683a61f3051dd90bbaf69de5d6cac5 still has \"not\"-typo in commit message:\r\n> Add a release not for the change in behaviour on 32-bit systems.",
      "user": {
        "login": "hodlinator",
        "id": 172445034,
        "node_id": "U_kgDOCkdNag",
        "avatar_url": "https://avatars.githubusercontent.com/u/172445034?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/hodlinator",
        "html_url": "https://github.com/hodlinator",
        "followers_url": "https://api.github.com/users/hodlinator/followers",
        "following_url": "https://api.github.com/users/hodlinator/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/hodlinator/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/hodlinator/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/hodlinator/subscriptions",
        "organizations_url": "https://api.github.com/users/hodlinator/orgs",
        "repos_url": "https://api.github.com/users/hodlinator/repos",
        "events_url": "https://api.github.com/users/hodlinator/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/hodlinator/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31483#pullrequestreview-2534107645",
      "submitted_at": "2025-01-07T11:43:14Z",
      "state": "APPROVED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31483"
    },
    {
      "event": "review_requested",
      "id": 15837741948,
      "node_id": "RRE_lADOABII586jEBuMzwAAAAOwAMN8",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/15837741948",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-01-07T11:43:18Z",
      "requested_reviewer": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "review_requester": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      }
    },
    {
      "event": "review_requested",
      "id": 15837742055,
      "node_id": "RRE_lADOABII586jEBuMzwAAAAOwAMPn",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/15837742055",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-01-07T11:43:19Z",
      "requested_reviewer": {
        "login": "stickies-v",
        "id": 69010457,
        "node_id": "MDQ6VXNlcjY5MDEwNDU3",
        "avatar_url": "https://avatars.githubusercontent.com/u/69010457?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stickies-v",
        "html_url": "https://github.com/stickies-v",
        "followers_url": "https://api.github.com/users/stickies-v/followers",
        "following_url": "https://api.github.com/users/stickies-v/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stickies-v/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stickies-v/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stickies-v/subscriptions",
        "organizations_url": "https://api.github.com/users/stickies-v/orgs",
        "repos_url": "https://api.github.com/users/stickies-v/repos",
        "events_url": "https://api.github.com/users/stickies-v/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stickies-v/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "review_requester": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      }
    },
    {
      "event": "head_ref_force_pushed",
      "id": 15838591806,
      "node_id": "HRFPE_lADOABII586jEBuMzwAAAAOwDbs-",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/15838591806",
      "actor": {
        "login": "TheCharlatan",
        "id": 8421793,
        "node_id": "MDQ6VXNlcjg0MjE3OTM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8421793?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/TheCharlatan",
        "html_url": "https://github.com/TheCharlatan",
        "followers_url": "https://api.github.com/users/TheCharlatan/followers",
        "following_url": "https://api.github.com/users/TheCharlatan/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/TheCharlatan/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/TheCharlatan/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/TheCharlatan/subscriptions",
        "organizations_url": "https://api.github.com/users/TheCharlatan/orgs",
        "repos_url": "https://api.github.com/users/TheCharlatan/repos",
        "events_url": "https://api.github.com/users/TheCharlatan/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/TheCharlatan/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": "224bfeb07f7561470451c95dc0df1db959bc187e",
      "commit_url": "https://api.github.com/repos/TheCharlatan/bitcoin/commits/224bfeb07f7561470451c95dc0df1db959bc187e",
      "created_at": "2025-01-07T12:59:05Z"
    },
    {
      "event": "commented",
      "id": 2575241273,
      "node_id": "IC_kwDOABII586ZfxA5",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2575241273",
      "actor": {
        "login": "TheCharlatan",
        "id": 8421793,
        "node_id": "MDQ6VXNlcjg0MjE3OTM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8421793?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/TheCharlatan",
        "html_url": "https://github.com/TheCharlatan",
        "followers_url": "https://api.github.com/users/TheCharlatan/followers",
        "following_url": "https://api.github.com/users/TheCharlatan/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/TheCharlatan/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/TheCharlatan/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/TheCharlatan/subscriptions",
        "organizations_url": "https://api.github.com/users/TheCharlatan/orgs",
        "repos_url": "https://api.github.com/users/TheCharlatan/repos",
        "events_url": "https://api.github.com/users/TheCharlatan/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/TheCharlatan/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-01-07T12:59:09Z",
      "updated_at": "2025-01-07T12:59:09Z",
      "author_association": "CONTRIBUTOR",
      "body": "Thanks for the reviews @hodlinator, just cleaning up your nits:\r\n\r\nUpdated 54bdaaefbc683a61f3051dd90bbaf69de5d6cac5 -> 224bfeb07f7561470451c95dc0df1db959bc187e ([kernel_cache_sizes_6](https://github.com/TheCharlatan/bitcoin/tree/kernel_cache_sizes_6) -> [kernel_cache_sizes_7](https://github.com/TheCharlatan/bitcoin/tree/kernel_cache_sizes_7), [compare](https://github.com/TheCharlatan/bitcoin/compare/kernel_cache_sizes_6..kernel_cache_sizes_7))\r\n\r\n* Addressed @hodlinator's [comment](https://github.com/bitcoin/bitcoin/pull/31483#discussion_r1905322706), calling the sign bit what it is.\r\n* Addressed @hodlinator's [comment](https://github.com/bitcoin/bitcoin/pull/31483#discussion_r1905324826), include `<limits>` in the correct commit.\r\n* Addressed @hodlinator's [comment](https://github.com/bitcoin/bitcoin/pull/31483#pullrequestreview-2534107645), fixed commit message typo.",
      "user": {
        "login": "TheCharlatan",
        "id": 8421793,
        "node_id": "MDQ6VXNlcjg0MjE3OTM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8421793?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/TheCharlatan",
        "html_url": "https://github.com/TheCharlatan",
        "followers_url": "https://api.github.com/users/TheCharlatan/followers",
        "following_url": "https://api.github.com/users/TheCharlatan/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/TheCharlatan/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/TheCharlatan/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/TheCharlatan/subscriptions",
        "organizations_url": "https://api.github.com/users/TheCharlatan/orgs",
        "repos_url": "https://api.github.com/users/TheCharlatan/repos",
        "events_url": "https://api.github.com/users/TheCharlatan/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/TheCharlatan/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31483#issuecomment-2575241273",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/31483"
    },
    {
      "event": "mentioned",
      "id": 15838593002,
      "node_id": "MEE_lADOABII586jEBuMzwAAAAOwDb_q",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/15838593002",
      "actor": {
        "login": "hodlinator",
        "id": 172445034,
        "node_id": "U_kgDOCkdNag",
        "avatar_url": "https://avatars.githubusercontent.com/u/172445034?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/hodlinator",
        "html_url": "https://github.com/hodlinator",
        "followers_url": "https://api.github.com/users/hodlinator/followers",
        "following_url": "https://api.github.com/users/hodlinator/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/hodlinator/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/hodlinator/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/hodlinator/subscriptions",
        "organizations_url": "https://api.github.com/users/hodlinator/orgs",
        "repos_url": "https://api.github.com/users/hodlinator/repos",
        "events_url": "https://api.github.com/users/hodlinator/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/hodlinator/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-01-07T12:59:12Z"
    },
    {
      "event": "subscribed",
      "id": 15838593023,
      "node_id": "SE_lADOABII586jEBuMzwAAAAOwDb__",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/15838593023",
      "actor": {
        "login": "hodlinator",
        "id": 172445034,
        "node_id": "U_kgDOCkdNag",
        "avatar_url": "https://avatars.githubusercontent.com/u/172445034?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/hodlinator",
        "html_url": "https://github.com/hodlinator",
        "followers_url": "https://api.github.com/users/hodlinator/followers",
        "following_url": "https://api.github.com/users/hodlinator/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/hodlinator/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/hodlinator/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/hodlinator/subscriptions",
        "organizations_url": "https://api.github.com/users/hodlinator/orgs",
        "repos_url": "https://api.github.com/users/hodlinator/repos",
        "events_url": "https://api.github.com/users/hodlinator/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/hodlinator/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-01-07T12:59:12Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 15840006122,
      "node_id": "HRFPE_lADOABII586jEBuMzwAAAAOwI0_q",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/15840006122",
      "actor": {
        "login": "TheCharlatan",
        "id": 8421793,
        "node_id": "MDQ6VXNlcjg0MjE3OTM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8421793?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/TheCharlatan",
        "html_url": "https://github.com/TheCharlatan",
        "followers_url": "https://api.github.com/users/TheCharlatan/followers",
        "following_url": "https://api.github.com/users/TheCharlatan/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/TheCharlatan/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/TheCharlatan/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/TheCharlatan/subscriptions",
        "organizations_url": "https://api.github.com/users/TheCharlatan/orgs",
        "repos_url": "https://api.github.com/users/TheCharlatan/repos",
        "events_url": "https://api.github.com/users/TheCharlatan/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/TheCharlatan/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": "9f61eb074438f85ed1a23fb3da94e4c68855d3fb",
      "commit_url": "https://api.github.com/repos/TheCharlatan/bitcoin/commits/9f61eb074438f85ed1a23fb3da94e4c68855d3fb",
      "created_at": "2025-01-07T14:52:10Z"
    },
    {
      "event": "commented",
      "id": 2575493948,
      "node_id": "IC_kwDOABII586Zgus8",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2575493948",
      "actor": {
        "login": "TheCharlatan",
        "id": 8421793,
        "node_id": "MDQ6VXNlcjg0MjE3OTM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8421793?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/TheCharlatan",
        "html_url": "https://github.com/TheCharlatan",
        "followers_url": "https://api.github.com/users/TheCharlatan/followers",
        "following_url": "https://api.github.com/users/TheCharlatan/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/TheCharlatan/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/TheCharlatan/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/TheCharlatan/subscriptions",
        "organizations_url": "https://api.github.com/users/TheCharlatan/orgs",
        "repos_url": "https://api.github.com/users/TheCharlatan/repos",
        "events_url": "https://api.github.com/users/TheCharlatan/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/TheCharlatan/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-01-07T14:52:26Z",
      "updated_at": "2025-01-07T14:52:26Z",
      "author_association": "CONTRIBUTOR",
      "body": "Updated 224bfeb07f7561470451c95dc0df1db959bc187e -> 9f61eb074438f85ed1a23fb3da94e4c68855d3fb ([kernel_cache_sizes_7](https://github.com/TheCharlatan/bitcoin/tree/kernel_cache_sizes_7) -> [kernel_cache_sizes_8](https://github.com/TheCharlatan/bitcoin/tree/kernel_cache_sizes_8), [compare](https://github.com/TheCharlatan/bitcoin/compare/kernel_cache_sizes_7..kernel_cache_sizes_8))\r\n\r\n* Fixed comment in the correct commit now.",
      "user": {
        "login": "TheCharlatan",
        "id": 8421793,
        "node_id": "MDQ6VXNlcjg0MjE3OTM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8421793?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/TheCharlatan",
        "html_url": "https://github.com/TheCharlatan",
        "followers_url": "https://api.github.com/users/TheCharlatan/followers",
        "following_url": "https://api.github.com/users/TheCharlatan/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/TheCharlatan/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/TheCharlatan/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/TheCharlatan/subscriptions",
        "organizations_url": "https://api.github.com/users/TheCharlatan/orgs",
        "repos_url": "https://api.github.com/users/TheCharlatan/repos",
        "events_url": "https://api.github.com/users/TheCharlatan/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/TheCharlatan/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31483#issuecomment-2575493948",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/31483"
    },
    {
      "event": "reviewed",
      "id": 2534616962,
      "node_id": "PRR_kwDOABII586XEy-C",
      "url": null,
      "actor": null,
      "commit_id": "9f61eb074438f85ed1a23fb3da94e4c68855d3fb",
      "commit_url": null,
      "created_at": null,
      "author_association": "CONTRIBUTOR",
      "body": "re-ACK 9f61eb074438f85ed1a23fb3da94e4c68855d3fb\r\n\r\nFixed all my remaining nits.\r\n\r\n### Tested a few `-dbcache` values\r\n\r\n```\r\n₿ build/src/bitcoind -dbcache=-1\r\n...\r\n2025-01-07T15:13:09Z Cache configuration:\r\n2025-01-07T15:13:09Z * Using 0.5 MiB for block index database\r\n2025-01-07T15:13:09Z * Using 1.8 MiB for chain state database\r\n2025-01-07T15:13:09Z * Using 1.8 MiB for in-memory UTXO set (plus up to 286.1 MiB of unused mempool space)\r\n```\r\nCorresponds to\r\n```C++\r\n//! min. -dbcache (MiB)\r\nstatic constexpr int64_t MIN_DB_CACHE{4};\r\n```\r\n\r\n---\r\n\r\n```\r\n₿ build/src/bitcoind \r\n...\r\n2025-01-07T15:14:48Z Cache configuration:\r\n2025-01-07T15:14:48Z * Using 2.0 MiB for block index database\r\n2025-01-07T15:14:48Z * Using 8.0 MiB for chain state database\r\n2025-01-07T15:14:48Z * Using 440.0 MiB for in-memory UTXO set (plus up to 286.1 MiB of unused mempool space)\r\n```\r\n\r\n---\r\n\r\n```\r\n₿ build/src/bitcoind -dbcache=8000 -txindex=1 -blockfilterindex=1\r\n...\r\n2025-01-07T15:18:09Z Cache configuration:\r\n2025-01-07T15:18:09Z * Using 2.0 MiB for block index database\r\n2025-01-07T15:18:09Z * Using 1000.0 MiB for transaction index database\r\n2025-01-07T15:18:09Z * Using 875.0 MiB for basic block filter index database\r\n2025-01-07T15:18:09Z * Using 8.0 MiB for chain state database\r\n2025-01-07T15:18:09Z * Using 6115.0 MiB for in-memory UTXO set (plus up to 286.1 MiB of unused mempool space)\r\n```\r\n\r\nShip it! :rocket:",
      "user": {
        "login": "hodlinator",
        "id": 172445034,
        "node_id": "U_kgDOCkdNag",
        "avatar_url": "https://avatars.githubusercontent.com/u/172445034?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/hodlinator",
        "html_url": "https://github.com/hodlinator",
        "followers_url": "https://api.github.com/users/hodlinator/followers",
        "following_url": "https://api.github.com/users/hodlinator/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/hodlinator/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/hodlinator/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/hodlinator/subscriptions",
        "organizations_url": "https://api.github.com/users/hodlinator/orgs",
        "repos_url": "https://api.github.com/users/hodlinator/repos",
        "events_url": "https://api.github.com/users/hodlinator/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/hodlinator/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31483#pullrequestreview-2534616962",
      "submitted_at": "2025-01-07T15:21:15Z",
      "state": "APPROVED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31483"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 15840865001,
      "node_id": "HRFPE_lADOABII586jEBuMzwAAAAOwMGrp",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/15840865001",
      "actor": {
        "login": "TheCharlatan",
        "id": 8421793,
        "node_id": "MDQ6VXNlcjg0MjE3OTM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8421793?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/TheCharlatan",
        "html_url": "https://github.com/TheCharlatan",
        "followers_url": "https://api.github.com/users/TheCharlatan/followers",
        "following_url": "https://api.github.com/users/TheCharlatan/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/TheCharlatan/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/TheCharlatan/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/TheCharlatan/subscriptions",
        "organizations_url": "https://api.github.com/users/TheCharlatan/orgs",
        "repos_url": "https://api.github.com/users/TheCharlatan/repos",
        "events_url": "https://api.github.com/users/TheCharlatan/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/TheCharlatan/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": "578654c686e394d08bac7c3bcddbfd90b46eaa62",
      "commit_url": "https://api.github.com/repos/TheCharlatan/bitcoin/commits/578654c686e394d08bac7c3bcddbfd90b46eaa62",
      "created_at": "2025-01-07T15:53:28Z"
    },
    {
      "event": "commented",
      "id": 2575638533,
      "node_id": "IC_kwDOABII586ZhSAF",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2575638533",
      "actor": {
        "login": "TheCharlatan",
        "id": 8421793,
        "node_id": "MDQ6VXNlcjg0MjE3OTM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8421793?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/TheCharlatan",
        "html_url": "https://github.com/TheCharlatan",
        "followers_url": "https://api.github.com/users/TheCharlatan/followers",
        "following_url": "https://api.github.com/users/TheCharlatan/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/TheCharlatan/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/TheCharlatan/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/TheCharlatan/subscriptions",
        "organizations_url": "https://api.github.com/users/TheCharlatan/orgs",
        "repos_url": "https://api.github.com/users/TheCharlatan/repos",
        "events_url": "https://api.github.com/users/TheCharlatan/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/TheCharlatan/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-01-07T15:53:35Z",
      "updated_at": "2025-01-07T15:53:35Z",
      "author_association": "CONTRIBUTOR",
      "body": "Sorry to invalidate the ACK again,\r\nUpdated 9f61eb074438f85ed1a23fb3da94e4c68855d3fb -> 578654c686e394d08bac7c3bcddbfd90b46eaa62 ([kernel_cache_sizes_8](https://github.com/TheCharlatan/bitcoin/tree/kernel_cache_sizes_8) -> [kernel_cache_sizes_9](https://github.com/TheCharlatan/bitcoin/tree/kernel_cache_sizes_9), [compare](https://github.com/TheCharlatan/bitcoin/compare/kernel_cache_sizes_8..kernel_cache_sizes_9))\r\n\r\n* Forgot to drop the newlines in `LogInfo`, again. Fixed that now. -_-",
      "user": {
        "login": "TheCharlatan",
        "id": 8421793,
        "node_id": "MDQ6VXNlcjg0MjE3OTM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8421793?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/TheCharlatan",
        "html_url": "https://github.com/TheCharlatan",
        "followers_url": "https://api.github.com/users/TheCharlatan/followers",
        "following_url": "https://api.github.com/users/TheCharlatan/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/TheCharlatan/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/TheCharlatan/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/TheCharlatan/subscriptions",
        "organizations_url": "https://api.github.com/users/TheCharlatan/orgs",
        "repos_url": "https://api.github.com/users/TheCharlatan/repos",
        "events_url": "https://api.github.com/users/TheCharlatan/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/TheCharlatan/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31483#issuecomment-2575638533",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/31483"
    },
    {
      "event": "reviewed",
      "id": 2534714225,
      "node_id": "PRR_kwDOABII586XFKtx",
      "url": null,
      "actor": null,
      "commit_id": "578654c686e394d08bac7c3bcddbfd90b46eaa62",
      "commit_url": null,
      "created_at": null,
      "author_association": "CONTRIBUTOR",
      "body": "re-ACK 578654c686e394d08bac7c3bcddbfd90b46eaa62",
      "user": {
        "login": "hodlinator",
        "id": 172445034,
        "node_id": "U_kgDOCkdNag",
        "avatar_url": "https://avatars.githubusercontent.com/u/172445034?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/hodlinator",
        "html_url": "https://github.com/hodlinator",
        "followers_url": "https://api.github.com/users/hodlinator/followers",
        "following_url": "https://api.github.com/users/hodlinator/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/hodlinator/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/hodlinator/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/hodlinator/subscriptions",
        "organizations_url": "https://api.github.com/users/hodlinator/orgs",
        "repos_url": "https://api.github.com/users/hodlinator/repos",
        "events_url": "https://api.github.com/users/hodlinator/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/hodlinator/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31483#pullrequestreview-2534714225",
      "submitted_at": "2025-01-07T15:56:29Z",
      "state": "APPROVED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31483"
    },
    {
      "event": "reviewed",
      "id": 2536926530,
      "node_id": "PRR_kwDOABII586XNm1C",
      "url": null,
      "actor": null,
      "commit_id": "578654c686e394d08bac7c3bcddbfd90b46eaa62",
      "commit_url": null,
      "created_at": null,
      "author_association": "CONTRIBUTOR",
      "body": "I like the increased checks for overflows on 32-bit (or other platforms), but I don't think we need the new `MiBToBytes()` helper function for that and some of the new logic seems buggy to me. More detail on both in the comments.",
      "user": {
        "login": "stickies-v",
        "id": 69010457,
        "node_id": "MDQ6VXNlcjY5MDEwNDU3",
        "avatar_url": "https://avatars.githubusercontent.com/u/69010457?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stickies-v",
        "html_url": "https://github.com/stickies-v",
        "followers_url": "https://api.github.com/users/stickies-v/followers",
        "following_url": "https://api.github.com/users/stickies-v/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stickies-v/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stickies-v/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stickies-v/subscriptions",
        "organizations_url": "https://api.github.com/users/stickies-v/orgs",
        "repos_url": "https://api.github.com/users/stickies-v/repos",
        "events_url": "https://api.github.com/users/stickies-v/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stickies-v/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31483#pullrequestreview-2536926530",
      "submitted_at": "2025-01-08T14:34:23Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31483"
    },
    {
      "event": "review_requested",
      "id": 15855127695,
      "node_id": "RRE_lADOABII586jEBuMzwAAAAOxCgyP",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/15855127695",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-01-08T14:34:26Z",
      "requested_reviewer": {
        "login": "stickies-v",
        "id": 69010457,
        "node_id": "MDQ6VXNlcjY5MDEwNDU3",
        "avatar_url": "https://avatars.githubusercontent.com/u/69010457?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stickies-v",
        "html_url": "https://github.com/stickies-v",
        "followers_url": "https://api.github.com/users/stickies-v/followers",
        "following_url": "https://api.github.com/users/stickies-v/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stickies-v/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stickies-v/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stickies-v/subscriptions",
        "organizations_url": "https://api.github.com/users/stickies-v/orgs",
        "repos_url": "https://api.github.com/users/stickies-v/repos",
        "events_url": "https://api.github.com/users/stickies-v/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stickies-v/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "review_requester": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      }
    },
    {
      "event": "reviewed",
      "id": 2537837742,
      "node_id": "PRR_kwDOABII586XRFSu",
      "url": null,
      "actor": null,
      "commit_id": "578654c686e394d08bac7c3bcddbfd90b46eaa62",
      "commit_url": null,
      "created_at": null,
      "author_association": "CONTRIBUTOR",
      "body": "Code review 578654c686e394d08bac7c3bcddbfd90b46eaa62. Looks pretty good, but there does appear to be a possible overflow bug https://github.com/bitcoin/bitcoin/pull/31483#discussion_r1907214794 found by stickies that should be fixed\r\n",
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31483#pullrequestreview-2537837742",
      "submitted_at": "2025-01-08T18:51:00Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31483"
    },
    {
      "event": "review_requested",
      "id": 15858329752,
      "node_id": "RRE_lADOABII586jEBuMzwAAAAOxOuiY",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/15858329752",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-01-08T18:51:04Z",
      "requested_reviewer": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "review_requester": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      }
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDhiZDVmOGEzOGNlOTAzYzA1NjA2ODQxZWJlZDE5MDIzOThjYjBiMTQ",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/8bd5f8a38ce903c05606841ebed1902398cb0b14",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/8bd5f8a38ce903c05606841ebed1902398cb0b14",
      "tree": {
        "sha": "9b0dd8496e3ccc67b7d6410b698411fe2d7d465b",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/9b0dd8496e3ccc67b7d6410b698411fe2d7d465b"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree 9b0dd8496e3ccc67b7d6410b698411fe2d7d465b\nparent 5db7d4d3d28bd1269a09955b4695135c86c4827d\nauthor TheCharlatan <seb.kung@gmail.com> 1734467636 +0100\ncommitter TheCharlatan <seb.kung@gmail.com> 1736414509 +0100\n\n[refactor] init: Simplify coinsdb cache calculation\n\n(total_cache / 4) + (1 << 23) is at least 8 MiB and nMaxCoinsDBCache is\nalso 8 MiB, so the minimum between the two will always be\nnMaxCoinsDBCache. This is just a simplification and not changing the\nresult of the calculation.\n\nCo-authored-by: Ryan Ofsky <ryan@ofsky.org>\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCgAdFiEE8s/Eq9C5nYN+67fQm3m0VpHbQXMFAmd/lUgACgkQm3m0VpHb\nQXPuchAAzDTPtEAsOK7yn/jkFn2unlwT3kHKhQ/Bl8ACE98dm0gh5pvTnURACPGf\nI9HEiej2mM5RYj+/ByUXr8DrarezI0C0cLPeU+wPJYlff63h1ILZMPhRnXIr6NEa\nz5wPf/IkIIhEVBswRgihPE934koJO9y27TLDxWeHrGnOKcL1gldGr8f8iKBKPeiy\nCNwtoqMnZXgrpB6NANhRPW4FwfJYymmaAINWgp35v7YpW/b/GE34/284ZaxLxCVP\nxP+2CqeVNxnH6tSoZWj36uvhaDKUxZ2btye5Le8HzAxvRJi+QYp+8SAEiyeha4qM\nyk3DP2FOsU4pDnfgnL7I45/lzKf/ZVWqwnUlkYBzmJ0zaVB129vTYhOIfyTgUnsj\niscbvrYVoyjswECo6QY5tLBeM4Gk8iyO64all3GPFTfzPNxeNPij7C3hyJq6GuC5\np9c5+EFcHNDp8oa59XBXqmgV4Qa1q/xDQOpIalifN32uCz6ZXFWURoWTwB34z+md\nH81Y6thOuJ8z66RUatoDJ/YvHwvRq8Qu4rCjbIaCnGYSAc4zLWhmsFB7fEwq1CPp\nfqQ2mqaLuMoMFJPruaajNMexpjmh0z1wsHA/Z9XlIaVhuU3iBi/w+Gn4X0VODT5D\nt1UiuMQElLDzGXpxbAPVn1n/DXTS6RZZS5WF02elcxLBGmcGgAg=\n=1AFz\n-----END PGP SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/5db7d4d3d28bd1269a09955b4695135c86c4827d",
          "sha": "5db7d4d3d28bd1269a09955b4695135c86c4827d",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/5db7d4d3d28bd1269a09955b4695135c86c4827d"
        }
      ],
      "message": "[refactor] init: Simplify coinsdb cache calculation\n\n(total_cache / 4) + (1 << 23) is at least 8 MiB and nMaxCoinsDBCache is\nalso 8 MiB, so the minimum between the two will always be\nnMaxCoinsDBCache. This is just a simplification and not changing the\nresult of the calculation.\n\nCo-authored-by: Ryan Ofsky <ryan@ofsky.org>",
      "committer": {
        "name": "TheCharlatan",
        "email": "seb.kung@gmail.com",
        "date": "2025-01-09T09:21:49Z"
      },
      "author": {
        "name": "TheCharlatan",
        "email": "seb.kung@gmail.com",
        "date": "2024-12-17T20:33:56Z"
      },
      "sha": "8bd5f8a38ce903c05606841ebed1902398cb0b14"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 15866080598,
      "node_id": "HRFPE_lADOABII586jEBuMzwAAAAOxsS1W",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/15866080598",
      "actor": {
        "login": "TheCharlatan",
        "id": 8421793,
        "node_id": "MDQ6VXNlcjg0MjE3OTM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8421793?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/TheCharlatan",
        "html_url": "https://github.com/TheCharlatan",
        "followers_url": "https://api.github.com/users/TheCharlatan/followers",
        "following_url": "https://api.github.com/users/TheCharlatan/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/TheCharlatan/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/TheCharlatan/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/TheCharlatan/subscriptions",
        "organizations_url": "https://api.github.com/users/TheCharlatan/orgs",
        "repos_url": "https://api.github.com/users/TheCharlatan/repos",
        "events_url": "https://api.github.com/users/TheCharlatan/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/TheCharlatan/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": "3d08e29d1f370c908900aacdf7a9a64a9a57781d",
      "commit_url": "https://api.github.com/repos/TheCharlatan/bitcoin/commits/3d08e29d1f370c908900aacdf7a9a64a9a57781d",
      "created_at": "2025-01-09T10:46:55Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 15866085577,
      "node_id": "HRFPE_lADOABII586jEBuMzwAAAAOxsUDJ",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/15866085577",
      "actor": {
        "login": "TheCharlatan",
        "id": 8421793,
        "node_id": "MDQ6VXNlcjg0MjE3OTM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8421793?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/TheCharlatan",
        "html_url": "https://github.com/TheCharlatan",
        "followers_url": "https://api.github.com/users/TheCharlatan/followers",
        "following_url": "https://api.github.com/users/TheCharlatan/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/TheCharlatan/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/TheCharlatan/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/TheCharlatan/subscriptions",
        "organizations_url": "https://api.github.com/users/TheCharlatan/orgs",
        "repos_url": "https://api.github.com/users/TheCharlatan/repos",
        "events_url": "https://api.github.com/users/TheCharlatan/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/TheCharlatan/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": "9dcbcfc8bbd021a7c9650f9a6b95259adbeab5b1",
      "commit_url": "https://api.github.com/repos/TheCharlatan/bitcoin/commits/9dcbcfc8bbd021a7c9650f9a6b95259adbeab5b1",
      "created_at": "2025-01-09T10:47:20Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 15866163645,
      "node_id": "HRFPE_lADOABII586jEBuMzwAAAAOxsnG9",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/15866163645",
      "actor": {
        "login": "TheCharlatan",
        "id": 8421793,
        "node_id": "MDQ6VXNlcjg0MjE3OTM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8421793?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/TheCharlatan",
        "html_url": "https://github.com/TheCharlatan",
        "followers_url": "https://api.github.com/users/TheCharlatan/followers",
        "following_url": "https://api.github.com/users/TheCharlatan/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/TheCharlatan/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/TheCharlatan/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/TheCharlatan/subscriptions",
        "organizations_url": "https://api.github.com/users/TheCharlatan/orgs",
        "repos_url": "https://api.github.com/users/TheCharlatan/repos",
        "events_url": "https://api.github.com/users/TheCharlatan/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/TheCharlatan/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": "44204e8783410715bd708944b97dbe51f7b45a4d",
      "commit_url": "https://api.github.com/repos/TheCharlatan/bitcoin/commits/44204e8783410715bd708944b97dbe51f7b45a4d",
      "created_at": "2025-01-09T10:53:14Z"
    },
    {
      "event": "convert_to_draft",
      "id": 15866237220,
      "node_id": "CTDE_lADOABII586jEBuMzwAAAAOxs5Ek",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/15866237220",
      "actor": {
        "login": "TheCharlatan",
        "id": 8421793,
        "node_id": "MDQ6VXNlcjg0MjE3OTM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8421793?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/TheCharlatan",
        "html_url": "https://github.com/TheCharlatan",
        "followers_url": "https://api.github.com/users/TheCharlatan/followers",
        "following_url": "https://api.github.com/users/TheCharlatan/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/TheCharlatan/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/TheCharlatan/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/TheCharlatan/subscriptions",
        "organizations_url": "https://api.github.com/users/TheCharlatan/orgs",
        "repos_url": "https://api.github.com/users/TheCharlatan/repos",
        "events_url": "https://api.github.com/users/TheCharlatan/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/TheCharlatan/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-01-09T10:58:04Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 15866554315,
      "node_id": "HRFPE_lADOABII586jEBuMzwAAAAOxuGfL",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/15866554315",
      "actor": {
        "login": "TheCharlatan",
        "id": 8421793,
        "node_id": "MDQ6VXNlcjg0MjE3OTM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8421793?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/TheCharlatan",
        "html_url": "https://github.com/TheCharlatan",
        "followers_url": "https://api.github.com/users/TheCharlatan/followers",
        "following_url": "https://api.github.com/users/TheCharlatan/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/TheCharlatan/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/TheCharlatan/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/TheCharlatan/subscriptions",
        "organizations_url": "https://api.github.com/users/TheCharlatan/orgs",
        "repos_url": "https://api.github.com/users/TheCharlatan/repos",
        "events_url": "https://api.github.com/users/TheCharlatan/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/TheCharlatan/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": "dbae9712028f2d05cc9ed9da87c424b785c9a630",
      "commit_url": "https://api.github.com/repos/TheCharlatan/bitcoin/commits/dbae9712028f2d05cc9ed9da87c424b785c9a630",
      "created_at": "2025-01-09T11:24:56Z"
    },
    {
      "event": "ready_for_review",
      "id": 15866554389,
      "node_id": "RFRE_lADOABII586jEBuMzwAAAAOxuGgV",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/15866554389",
      "actor": {
        "login": "TheCharlatan",
        "id": 8421793,
        "node_id": "MDQ6VXNlcjg0MjE3OTM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8421793?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/TheCharlatan",
        "html_url": "https://github.com/TheCharlatan",
        "followers_url": "https://api.github.com/users/TheCharlatan/followers",
        "following_url": "https://api.github.com/users/TheCharlatan/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/TheCharlatan/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/TheCharlatan/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/TheCharlatan/subscriptions",
        "organizations_url": "https://api.github.com/users/TheCharlatan/orgs",
        "repos_url": "https://api.github.com/users/TheCharlatan/repos",
        "events_url": "https://api.github.com/users/TheCharlatan/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/TheCharlatan/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-01-09T11:24:57Z"
    },
    {
      "event": "labeled",
      "id": 15866555206,
      "node_id": "LE_lADOABII586jEBuMzwAAAAOxuGtG",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/15866555206",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-01-09T11:25:01Z",
      "label": {
        "name": "CI failed",
        "color": "cccccc"
      }
    },
    {
      "event": "commented",
      "id": 2579905452,
      "node_id": "IC_kwDOABII586Zxjus",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2579905452",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-01-09T11:25:02Z",
      "updated_at": "2025-01-09T11:25:02Z",
      "author_association": "CONTRIBUTOR",
      "body": "<!--85328a0da195eb286784d51f73fa0af9-->\n🚧 At least one of the CI tasks failed.\n<sub>Debug: https://github.com/bitcoin/bitcoin/runs/35365058175</sub>\n\n<details><summary>Hints</summary>\n\nTry to run the tests locally, according to the documentation. However, a CI failure may still\nhappen due to a number of reasons, for example:\n\n* Possibly due to a silent merge conflict (the changes in this pull request being\nincompatible with the current code in the target branch). If so, make sure to rebase on the latest\ncommit of the target branch.\n\n* A sanitizer issue, which can only be found by compiling with the sanitizer and running the\n  affected test.\n\n* An intermittent issue.\n\nLeave a comment here, if you need help tracking down a confusing failure.\n\n</details>\n",
      "user": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31483#issuecomment-2579905452",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/31483"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 15866965767,
      "node_id": "HRFPE_lADOABII586jEBuMzwAAAAOxvq8H",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/15866965767",
      "actor": {
        "login": "TheCharlatan",
        "id": 8421793,
        "node_id": "MDQ6VXNlcjg0MjE3OTM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8421793?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/TheCharlatan",
        "html_url": "https://github.com/TheCharlatan",
        "followers_url": "https://api.github.com/users/TheCharlatan/followers",
        "following_url": "https://api.github.com/users/TheCharlatan/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/TheCharlatan/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/TheCharlatan/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/TheCharlatan/subscriptions",
        "organizations_url": "https://api.github.com/users/TheCharlatan/orgs",
        "repos_url": "https://api.github.com/users/TheCharlatan/repos",
        "events_url": "https://api.github.com/users/TheCharlatan/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/TheCharlatan/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": "941a194c944826049f823858cb15c41963e4619a",
      "commit_url": "https://api.github.com/repos/TheCharlatan/bitcoin/commits/941a194c944826049f823858cb15c41963e4619a",
      "created_at": "2025-01-09T12:02:17Z"
    },
    {
      "event": "commented",
      "id": 2580005706,
      "node_id": "IC_kwDOABII586Zx8NK",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2580005706",
      "actor": {
        "login": "TheCharlatan",
        "id": 8421793,
        "node_id": "MDQ6VXNlcjg0MjE3OTM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8421793?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/TheCharlatan",
        "html_url": "https://github.com/TheCharlatan",
        "followers_url": "https://api.github.com/users/TheCharlatan/followers",
        "following_url": "https://api.github.com/users/TheCharlatan/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/TheCharlatan/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/TheCharlatan/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/TheCharlatan/subscriptions",
        "organizations_url": "https://api.github.com/users/TheCharlatan/orgs",
        "repos_url": "https://api.github.com/users/TheCharlatan/repos",
        "events_url": "https://api.github.com/users/TheCharlatan/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/TheCharlatan/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-01-09T12:11:47Z",
      "updated_at": "2025-01-09T12:11:47Z",
      "author_association": "CONTRIBUTOR",
      "body": "Thank you for the reviews @ryanofsky and @stickies-v , sorry for the many pushes here, pushed a stale branch by mistake.\r\n\r\nUpdated 578654c686e394d08bac7c3bcddbfd90b46eaa62 -> 941a194c944826049f823858cb15c41963e4619a ([kernel_cache_sizes_9](https://github.com/TheCharlatan/bitcoin/tree/kernel_cache_sizes_9) -> [kernel_cache_sizes_10](https://github.com/TheCharlatan/bitcoin/tree/kernel_cache_sizes_10), [compare](https://github.com/TheCharlatan/bitcoin/compare/kernel_cache_sizes_9..kernel_cache_sizes_10))\r\n\r\n* Addressed @stickies-v's [comment](https://github.com/bitcoin/bitcoin/pull/31483#discussion_r1907267762), moved some MiB to bytes conversions to the constants themselves so we can do the conversion and bounds check at compile time.\r\n* Addressed @ryanofsky's [comment](https://github.com/bitcoin/bitcoin/pull/31483#discussion_r1907588881), added refactor clarification in the message of the commit cleaning up the cache calculation.\r\n* Addressed @ryanofsky's [comment](https://github.com/bitcoin/bitcoin/pull/31483#discussion_r1907618229), using the suggested simplified method for converting and checking the range of of the passed in value in `MiBToBytes`.\r\n* Added a separate commit for introducing the `MiBToBytes` utility in its own header and with its own unit test. ",
      "user": {
        "login": "TheCharlatan",
        "id": 8421793,
        "node_id": "MDQ6VXNlcjg0MjE3OTM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8421793?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/TheCharlatan",
        "html_url": "https://github.com/TheCharlatan",
        "followers_url": "https://api.github.com/users/TheCharlatan/followers",
        "following_url": "https://api.github.com/users/TheCharlatan/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/TheCharlatan/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/TheCharlatan/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/TheCharlatan/subscriptions",
        "organizations_url": "https://api.github.com/users/TheCharlatan/orgs",
        "repos_url": "https://api.github.com/users/TheCharlatan/repos",
        "events_url": "https://api.github.com/users/TheCharlatan/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/TheCharlatan/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31483#issuecomment-2580005706",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/31483"
    },
    {
      "event": "mentioned",
      "id": 15867081423,
      "node_id": "MEE_lADOABII586jEBuMzwAAAAOxwHLP",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/15867081423",
      "actor": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-01-09T12:11:50Z"
    },
    {
      "event": "subscribed",
      "id": 15867081446,
      "node_id": "SE_lADOABII586jEBuMzwAAAAOxwHLm",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/15867081446",
      "actor": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-01-09T12:11:50Z"
    },
    {
      "event": "mentioned",
      "id": 15867081456,
      "node_id": "MEE_lADOABII586jEBuMzwAAAAOxwHLw",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/15867081456",
      "actor": {
        "login": "stickies-v",
        "id": 69010457,
        "node_id": "MDQ6VXNlcjY5MDEwNDU3",
        "avatar_url": "https://avatars.githubusercontent.com/u/69010457?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stickies-v",
        "html_url": "https://github.com/stickies-v",
        "followers_url": "https://api.github.com/users/stickies-v/followers",
        "following_url": "https://api.github.com/users/stickies-v/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stickies-v/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stickies-v/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stickies-v/subscriptions",
        "organizations_url": "https://api.github.com/users/stickies-v/orgs",
        "repos_url": "https://api.github.com/users/stickies-v/repos",
        "events_url": "https://api.github.com/users/stickies-v/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stickies-v/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-01-09T12:11:50Z"
    },
    {
      "event": "subscribed",
      "id": 15867081468,
      "node_id": "SE_lADOABII586jEBuMzwAAAAOxwHL8",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/15867081468",
      "actor": {
        "login": "stickies-v",
        "id": 69010457,
        "node_id": "MDQ6VXNlcjY5MDEwNDU3",
        "avatar_url": "https://avatars.githubusercontent.com/u/69010457?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stickies-v",
        "html_url": "https://github.com/stickies-v",
        "followers_url": "https://api.github.com/users/stickies-v/followers",
        "following_url": "https://api.github.com/users/stickies-v/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stickies-v/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stickies-v/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stickies-v/subscriptions",
        "organizations_url": "https://api.github.com/users/stickies-v/orgs",
        "repos_url": "https://api.github.com/users/stickies-v/repos",
        "events_url": "https://api.github.com/users/stickies-v/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stickies-v/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-01-09T12:11:50Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 15867576020,
      "node_id": "HRFPE_lADOABII586jEBuMzwAAAAOxx_7U",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/15867576020",
      "actor": {
        "login": "TheCharlatan",
        "id": 8421793,
        "node_id": "MDQ6VXNlcjg0MjE3OTM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8421793?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/TheCharlatan",
        "html_url": "https://github.com/TheCharlatan",
        "followers_url": "https://api.github.com/users/TheCharlatan/followers",
        "following_url": "https://api.github.com/users/TheCharlatan/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/TheCharlatan/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/TheCharlatan/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/TheCharlatan/subscriptions",
        "organizations_url": "https://api.github.com/users/TheCharlatan/orgs",
        "repos_url": "https://api.github.com/users/TheCharlatan/repos",
        "events_url": "https://api.github.com/users/TheCharlatan/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/TheCharlatan/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": "82706e217f34d1f09cbd30dde6b8ae5ac0385f0a",
      "commit_url": "https://api.github.com/repos/TheCharlatan/bitcoin/commits/82706e217f34d1f09cbd30dde6b8ae5ac0385f0a",
      "created_at": "2025-01-09T12:54:55Z"
    },
    {
      "event": "commented",
      "id": 2580086993,
      "node_id": "IC_kwDOABII586ZyQDR",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2580086993",
      "actor": {
        "login": "TheCharlatan",
        "id": 8421793,
        "node_id": "MDQ6VXNlcjg0MjE3OTM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8421793?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/TheCharlatan",
        "html_url": "https://github.com/TheCharlatan",
        "followers_url": "https://api.github.com/users/TheCharlatan/followers",
        "following_url": "https://api.github.com/users/TheCharlatan/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/TheCharlatan/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/TheCharlatan/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/TheCharlatan/subscriptions",
        "organizations_url": "https://api.github.com/users/TheCharlatan/orgs",
        "repos_url": "https://api.github.com/users/TheCharlatan/repos",
        "events_url": "https://api.github.com/users/TheCharlatan/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/TheCharlatan/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-01-09T12:55:05Z",
      "updated_at": "2025-01-09T12:55:05Z",
      "author_association": "CONTRIBUTOR",
      "body": "Updated 941a194c944826049f823858cb15c41963e4619a -> 82706e217f34d1f09cbd30dde6b8ae5ac0385f0a ([kernel_cache_sizes_10](https://github.com/TheCharlatan/bitcoin/tree/kernel_cache_sizes_10) -> [kernel_cache_sizes_11](https://github.com/TheCharlatan/bitcoin/tree/kernel_cache_sizes_11), [compare](https://github.com/TheCharlatan/bitcoin/compare/kernel_cache_sizes_10..kernel_cache_sizes_11))\r\n\r\n* Fix UBSan failure by avoiding undefined behaviour by casting to `size_t`.",
      "user": {
        "login": "TheCharlatan",
        "id": 8421793,
        "node_id": "MDQ6VXNlcjg0MjE3OTM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8421793?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/TheCharlatan",
        "html_url": "https://github.com/TheCharlatan",
        "followers_url": "https://api.github.com/users/TheCharlatan/followers",
        "following_url": "https://api.github.com/users/TheCharlatan/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/TheCharlatan/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/TheCharlatan/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/TheCharlatan/subscriptions",
        "organizations_url": "https://api.github.com/users/TheCharlatan/orgs",
        "repos_url": "https://api.github.com/users/TheCharlatan/repos",
        "events_url": "https://api.github.com/users/TheCharlatan/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/TheCharlatan/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31483#issuecomment-2580086993",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/31483"
    },
    {
      "event": "unlabeled",
      "id": 15869193883,
      "node_id": "UNLE_lADOABII586jEBuMzwAAAAOx4K6b",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/15869193883",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-01-09T14:53:34Z",
      "label": {
        "name": "CI failed",
        "color": "cccccc"
      }
    },
    {
      "event": "reviewed",
      "id": 2540166691,
      "node_id": "PRR_kwDOABII586XZ94j",
      "url": null,
      "actor": null,
      "commit_id": "82706e217f34d1f09cbd30dde6b8ae5ac0385f0a",
      "commit_url": null,
      "created_at": null,
      "author_association": "CONTRIBUTOR",
      "body": "Code review ACK 82706e217f34d1f09cbd30dde6b8ae5ac0385f0a. Since last review avoided undefined -dbcache overflow behavior and changed the warning into an error. Also simplified and moved MiB conversion function and added test, and converted most constants to use byte sizes instead of MiB sizes (MIN_DB_CACHE still uses MiB not bytes, I think because that constant is not used by the kernel and is used by qt)",
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31483#pullrequestreview-2540166691",
      "submitted_at": "2025-01-09T15:34:19Z",
      "state": "APPROVED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31483"
    },
    {
      "event": "review_requested",
      "id": 15869767457,
      "node_id": "RRE_lADOABII586jEBuMzwAAAAOx6W8h",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/15869767457",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-01-09T15:34:25Z",
      "requested_reviewer": {
        "login": "hodlinator",
        "id": 172445034,
        "node_id": "U_kgDOCkdNag",
        "avatar_url": "https://avatars.githubusercontent.com/u/172445034?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/hodlinator",
        "html_url": "https://github.com/hodlinator",
        "followers_url": "https://api.github.com/users/hodlinator/followers",
        "following_url": "https://api.github.com/users/hodlinator/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/hodlinator/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/hodlinator/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/hodlinator/subscriptions",
        "organizations_url": "https://api.github.com/users/hodlinator/orgs",
        "repos_url": "https://api.github.com/users/hodlinator/repos",
        "events_url": "https://api.github.com/users/hodlinator/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/hodlinator/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "review_requester": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      }
    },
    {
      "event": "reviewed",
      "id": 2542035711,
      "node_id": "PRR_kwDOABII586XhGL_",
      "url": null,
      "actor": null,
      "commit_id": "82706e217f34d1f09cbd30dde6b8ae5ac0385f0a",
      "commit_url": null,
      "created_at": null,
      "author_association": "CONTRIBUTOR",
      "body": "re-ACK 82706e217f34d1f09cbd30dde6b8ae5ac0385f0a\r\n\r\nMixing of MiB and bytes in constants is tolerable, and at least the units are documented.\r\n\r\nNew unit tests look good to me.\r\n\r\n---\r\n\r\nNit: commit message in 82706e217f34d1f09cbd30dde6b8ae5ac0385f0a contains 3 ways of describing the number of bits:\r\n- \"memory was allocated on 32bit platforms.\"\r\n- \"maximum size of a 32 bit unsigned\"\r\n- \"in behaviour on 32-bit systems.\"",
      "user": {
        "login": "hodlinator",
        "id": 172445034,
        "node_id": "U_kgDOCkdNag",
        "avatar_url": "https://avatars.githubusercontent.com/u/172445034?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/hodlinator",
        "html_url": "https://github.com/hodlinator",
        "followers_url": "https://api.github.com/users/hodlinator/followers",
        "following_url": "https://api.github.com/users/hodlinator/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/hodlinator/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/hodlinator/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/hodlinator/subscriptions",
        "organizations_url": "https://api.github.com/users/hodlinator/orgs",
        "repos_url": "https://api.github.com/users/hodlinator/repos",
        "events_url": "https://api.github.com/users/hodlinator/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/hodlinator/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31483#pullrequestreview-2542035711",
      "submitted_at": "2025-01-10T10:14:24Z",
      "state": "APPROVED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31483"
    },
    {
      "event": "reviewed",
      "id": 2543008314,
      "node_id": "PRR_kwDOABII586Xkzo6",
      "url": null,
      "actor": null,
      "commit_id": "82706e217f34d1f09cbd30dde6b8ae5ac0385f0a",
      "commit_url": null,
      "created_at": null,
      "author_association": "CONTRIBUTOR",
      "user": {
        "login": "stickies-v",
        "id": 69010457,
        "node_id": "MDQ6VXNlcjY5MDEwNDU3",
        "avatar_url": "https://avatars.githubusercontent.com/u/69010457?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stickies-v",
        "html_url": "https://github.com/stickies-v",
        "followers_url": "https://api.github.com/users/stickies-v/followers",
        "following_url": "https://api.github.com/users/stickies-v/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stickies-v/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stickies-v/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stickies-v/subscriptions",
        "organizations_url": "https://api.github.com/users/stickies-v/orgs",
        "repos_url": "https://api.github.com/users/stickies-v/repos",
        "events_url": "https://api.github.com/users/stickies-v/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stickies-v/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31483#pullrequestreview-2543008314",
      "submitted_at": "2025-01-10T20:15:26Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31483"
    },
    {
      "event": "review_requested",
      "id": 15888226900,
      "node_id": "RRE_lADOABII586jEBuMzwAAAAOzAxpU",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/15888226900",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-01-10T20:15:30Z",
      "requested_reviewer": {
        "login": "stickies-v",
        "id": 69010457,
        "node_id": "MDQ6VXNlcjY5MDEwNDU3",
        "avatar_url": "https://avatars.githubusercontent.com/u/69010457?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stickies-v",
        "html_url": "https://github.com/stickies-v",
        "followers_url": "https://api.github.com/users/stickies-v/followers",
        "following_url": "https://api.github.com/users/stickies-v/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stickies-v/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stickies-v/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stickies-v/subscriptions",
        "organizations_url": "https://api.github.com/users/stickies-v/orgs",
        "repos_url": "https://api.github.com/users/stickies-v/repos",
        "events_url": "https://api.github.com/users/stickies-v/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stickies-v/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "review_requester": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      }
    },
    {
      "event": "head_ref_force_pushed",
      "id": 15892749677,
      "node_id": "HRFPE_lADOABII586jEBuMzwAAAAOzSB1t",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/15892749677",
      "actor": {
        "login": "TheCharlatan",
        "id": 8421793,
        "node_id": "MDQ6VXNlcjg0MjE3OTM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8421793?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/TheCharlatan",
        "html_url": "https://github.com/TheCharlatan",
        "followers_url": "https://api.github.com/users/TheCharlatan/followers",
        "following_url": "https://api.github.com/users/TheCharlatan/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/TheCharlatan/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/TheCharlatan/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/TheCharlatan/subscriptions",
        "organizations_url": "https://api.github.com/users/TheCharlatan/orgs",
        "repos_url": "https://api.github.com/users/TheCharlatan/repos",
        "events_url": "https://api.github.com/users/TheCharlatan/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/TheCharlatan/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": "45fe603f8fd94c171f5ce1a38bc20d273baa9b1b",
      "commit_url": "https://api.github.com/repos/TheCharlatan/bitcoin/commits/45fe603f8fd94c171f5ce1a38bc20d273baa9b1b",
      "created_at": "2025-01-11T14:21:25Z"
    },
    {
      "event": "commented",
      "id": 2585284602,
      "node_id": "IC_kwDOABII586aGE_6",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2585284602",
      "actor": {
        "login": "TheCharlatan",
        "id": 8421793,
        "node_id": "MDQ6VXNlcjg0MjE3OTM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8421793?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/TheCharlatan",
        "html_url": "https://github.com/TheCharlatan",
        "followers_url": "https://api.github.com/users/TheCharlatan/followers",
        "following_url": "https://api.github.com/users/TheCharlatan/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/TheCharlatan/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/TheCharlatan/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/TheCharlatan/subscriptions",
        "organizations_url": "https://api.github.com/users/TheCharlatan/orgs",
        "repos_url": "https://api.github.com/users/TheCharlatan/repos",
        "events_url": "https://api.github.com/users/TheCharlatan/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/TheCharlatan/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-01-11T14:21:31Z",
      "updated_at": "2025-01-11T14:21:31Z",
      "author_association": "CONTRIBUTOR",
      "body": "Thank you for the re-newed reviews and your suggestions @ryanofsky and @stickies-v. I hope we can settle on something this time round:\r\n\r\nUpdated 82706e217f34d1f09cbd30dde6b8ae5ac0385f0a -> 45fe603f8fd94c171f5ce1a38bc20d273baa9b1b ([kernel_cache_sizes_11](https://github.com/TheCharlatan/bitcoin/tree/kernel_cache_sizes_11) -> [kernel_cache_sizes_12](https://github.com/TheCharlatan/bitcoin/tree/kernel_cache_sizes_12), [compare](https://github.com/TheCharlatan/bitcoin/compare/kernel_cache_sizes_11..kernel_cache_sizes_12))\r\n\r\n* Replaced `MiBToBytes` with the patch @stickies-v [suggested](https://github.com/bitcoin/bitcoin/pull/31483#discussion_r1911227603), spread out over its relevant commits.\r\n* Added `CheckedLeftShift`, `SaturatingLeftShift` and `_MiB` string literal functions with relevant tests.\r\n* Addressed @ryanofsky's [comment](https://github.com/bitcoin/bitcoin/pull/31483#discussion_r1908969637), dropped the hard error if the requested amount of `-dbcache` does not fit in a `size_t`. Instead the maximum value is now capped at the maximum value of a `size_t`.\r\n* Removed the release note, since there is no significant change in behaviour anymore.",
      "user": {
        "login": "TheCharlatan",
        "id": 8421793,
        "node_id": "MDQ6VXNlcjg0MjE3OTM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8421793?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/TheCharlatan",
        "html_url": "https://github.com/TheCharlatan",
        "followers_url": "https://api.github.com/users/TheCharlatan/followers",
        "following_url": "https://api.github.com/users/TheCharlatan/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/TheCharlatan/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/TheCharlatan/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/TheCharlatan/subscriptions",
        "organizations_url": "https://api.github.com/users/TheCharlatan/orgs",
        "repos_url": "https://api.github.com/users/TheCharlatan/repos",
        "events_url": "https://api.github.com/users/TheCharlatan/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/TheCharlatan/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31483#issuecomment-2585284602",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/31483"
    },
    {
      "event": "mentioned",
      "id": 15892749830,
      "node_id": "MEE_lADOABII586jEBuMzwAAAAOzSB4G",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/15892749830",
      "actor": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-01-11T14:21:32Z"
    },
    {
      "event": "subscribed",
      "id": 15892749832,
      "node_id": "SE_lADOABII586jEBuMzwAAAAOzSB4I",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/15892749832",
      "actor": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-01-11T14:21:32Z"
    },
    {
      "event": "mentioned",
      "id": 15892749834,
      "node_id": "MEE_lADOABII586jEBuMzwAAAAOzSB4K",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/15892749834",
      "actor": {
        "login": "stickies-v",
        "id": 69010457,
        "node_id": "MDQ6VXNlcjY5MDEwNDU3",
        "avatar_url": "https://avatars.githubusercontent.com/u/69010457?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stickies-v",
        "html_url": "https://github.com/stickies-v",
        "followers_url": "https://api.github.com/users/stickies-v/followers",
        "following_url": "https://api.github.com/users/stickies-v/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stickies-v/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stickies-v/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stickies-v/subscriptions",
        "organizations_url": "https://api.github.com/users/stickies-v/orgs",
        "repos_url": "https://api.github.com/users/stickies-v/repos",
        "events_url": "https://api.github.com/users/stickies-v/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stickies-v/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-01-11T14:21:32Z"
    },
    {
      "event": "subscribed",
      "id": 15892749837,
      "node_id": "SE_lADOABII586jEBuMzwAAAAOzSB4N",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/15892749837",
      "actor": {
        "login": "stickies-v",
        "id": 69010457,
        "node_id": "MDQ6VXNlcjY5MDEwNDU3",
        "avatar_url": "https://avatars.githubusercontent.com/u/69010457?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stickies-v",
        "html_url": "https://github.com/stickies-v",
        "followers_url": "https://api.github.com/users/stickies-v/followers",
        "following_url": "https://api.github.com/users/stickies-v/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stickies-v/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stickies-v/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stickies-v/subscriptions",
        "organizations_url": "https://api.github.com/users/stickies-v/orgs",
        "repos_url": "https://api.github.com/users/stickies-v/repos",
        "events_url": "https://api.github.com/users/stickies-v/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stickies-v/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-01-11T14:21:32Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 15892850986,
      "node_id": "HRFPE_lADOABII586jEBuMzwAAAAOzSakq",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/15892850986",
      "actor": {
        "login": "TheCharlatan",
        "id": 8421793,
        "node_id": "MDQ6VXNlcjg0MjE3OTM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8421793?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/TheCharlatan",
        "html_url": "https://github.com/TheCharlatan",
        "followers_url": "https://api.github.com/users/TheCharlatan/followers",
        "following_url": "https://api.github.com/users/TheCharlatan/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/TheCharlatan/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/TheCharlatan/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/TheCharlatan/subscriptions",
        "organizations_url": "https://api.github.com/users/TheCharlatan/orgs",
        "repos_url": "https://api.github.com/users/TheCharlatan/repos",
        "events_url": "https://api.github.com/users/TheCharlatan/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/TheCharlatan/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": "11497dad37d9c9676cb9423fd290d9eceb060822",
      "commit_url": "https://api.github.com/repos/TheCharlatan/bitcoin/commits/11497dad37d9c9676cb9423fd290d9eceb060822",
      "created_at": "2025-01-11T15:20:56Z"
    },
    {
      "event": "labeled",
      "id": 15892851138,
      "node_id": "LE_lADOABII586jEBuMzwAAAAOzSanC",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/15892851138",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-01-11T15:21:01Z",
      "label": {
        "name": "CI failed",
        "color": "cccccc"
      }
    },
    {
      "event": "commented",
      "id": 2585301018,
      "node_id": "IC_kwDOABII586aGJAa",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2585301018",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-01-11T15:21:02Z",
      "updated_at": "2025-01-11T15:21:02Z",
      "author_association": "CONTRIBUTOR",
      "body": "<!--85328a0da195eb286784d51f73fa0af9-->\n🚧 At least one of the CI tasks failed.\n<sub>Debug: https://github.com/bitcoin/bitcoin/runs/35471739098</sub>\n\n<details><summary>Hints</summary>\n\nTry to run the tests locally, according to the documentation. However, a CI failure may still\nhappen due to a number of reasons, for example:\n\n* Possibly due to a silent merge conflict (the changes in this pull request being\nincompatible with the current code in the target branch). If so, make sure to rebase on the latest\ncommit of the target branch.\n\n* A sanitizer issue, which can only be found by compiling with the sanitizer and running the\n  affected test.\n\n* An intermittent issue.\n\nLeave a comment here, if you need help tracking down a confusing failure.\n\n</details>\n",
      "user": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31483#issuecomment-2585301018",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/31483"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 15893244574,
      "node_id": "HRFPE_lADOABII586jEBuMzwAAAAOzT6qe",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/15893244574",
      "actor": {
        "login": "TheCharlatan",
        "id": 8421793,
        "node_id": "MDQ6VXNlcjg0MjE3OTM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8421793?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/TheCharlatan",
        "html_url": "https://github.com/TheCharlatan",
        "followers_url": "https://api.github.com/users/TheCharlatan/followers",
        "following_url": "https://api.github.com/users/TheCharlatan/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/TheCharlatan/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/TheCharlatan/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/TheCharlatan/subscriptions",
        "organizations_url": "https://api.github.com/users/TheCharlatan/orgs",
        "repos_url": "https://api.github.com/users/TheCharlatan/repos",
        "events_url": "https://api.github.com/users/TheCharlatan/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/TheCharlatan/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": "cf20c1b9e0b46cb8c4d4f93a054afd9c1f85e4e0",
      "commit_url": "https://api.github.com/repos/TheCharlatan/bitcoin/commits/cf20c1b9e0b46cb8c4d4f93a054afd9c1f85e4e0",
      "created_at": "2025-01-11T17:05:18Z"
    },
    {
      "event": "unlabeled",
      "id": 15893329836,
      "node_id": "UNLE_lADOABII586jEBuMzwAAAAOzUPes",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/15893329836",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-01-11T17:56:13Z",
      "label": {
        "name": "CI failed",
        "color": "cccccc"
      }
    },
    {
      "event": "commented",
      "id": 2585393698,
      "node_id": "IC_kwDOABII586aGfoi",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2585393698",
      "actor": {
        "login": "TheCharlatan",
        "id": 8421793,
        "node_id": "MDQ6VXNlcjg0MjE3OTM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8421793?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/TheCharlatan",
        "html_url": "https://github.com/TheCharlatan",
        "followers_url": "https://api.github.com/users/TheCharlatan/followers",
        "following_url": "https://api.github.com/users/TheCharlatan/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/TheCharlatan/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/TheCharlatan/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/TheCharlatan/subscriptions",
        "organizations_url": "https://api.github.com/users/TheCharlatan/orgs",
        "repos_url": "https://api.github.com/users/TheCharlatan/repos",
        "events_url": "https://api.github.com/users/TheCharlatan/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/TheCharlatan/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-01-11T20:07:22Z",
      "updated_at": "2025-01-11T20:07:22Z",
      "author_association": "CONTRIBUTOR",
      "body": "Updated 45fe603f8fd94c171f5ce1a38bc20d273baa9b1b -> cf20c1b9e0b46cb8c4d4f93a054afd9c1f85e4e0 ([kernel_cache_sizes_12](https://github.com/TheCharlatan/bitcoin/tree/kernel_cache_sizes_12) -> [kernel_cache_sizes_13](https://github.com/TheCharlatan/bitcoin/tree/kernel_cache_sizes_13), [compare](https://github.com/TheCharlatan/bitcoin/compare/kernel_cache_sizes_12..kernel_cache_sizes_13))\r\n\r\n* Fixed an issue with an include, a cast, and a signed/unsigned comparison.",
      "user": {
        "login": "TheCharlatan",
        "id": 8421793,
        "node_id": "MDQ6VXNlcjg0MjE3OTM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8421793?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/TheCharlatan",
        "html_url": "https://github.com/TheCharlatan",
        "followers_url": "https://api.github.com/users/TheCharlatan/followers",
        "following_url": "https://api.github.com/users/TheCharlatan/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/TheCharlatan/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/TheCharlatan/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/TheCharlatan/subscriptions",
        "organizations_url": "https://api.github.com/users/TheCharlatan/orgs",
        "repos_url": "https://api.github.com/users/TheCharlatan/repos",
        "events_url": "https://api.github.com/users/TheCharlatan/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/TheCharlatan/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31483#issuecomment-2585393698",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/31483"
    },
    {
      "event": "reviewed",
      "id": 2545133420,
      "node_id": "PRR_kwDOABII586Xs6ds",
      "url": null,
      "actor": null,
      "commit_id": "cf20c1b9e0b46cb8c4d4f93a054afd9c1f85e4e0",
      "commit_url": null,
      "created_at": null,
      "author_association": "CONTRIBUTOR",
      "body": "re-ACK cf20c1b9e0b46cb8c4d4f93a054afd9c1f85e4e0\r\n\r\nHappy with the `_MiB` user-defined literals. :)\r\n\r\nNothing blocking. Should probably at least fix the typo.\r\n\r\n---\r\n\r\nmega-nit: Could possibly have used `CheckedLeftShift()` or `SaturatingLeftShift()` in intermediate commits. But end state doesn't have naked shifts on touched lines, which is fine.\r\n```diff\r\n- kernel::CacheSizes cache_sizes{nDefaultDbCache << 20};\r\n+ kernel::CacheSizes cache_sizes{CheckedLeftShift<size_t>(nDefaultDbCache, 20).value()};\r\n```",
      "user": {
        "login": "hodlinator",
        "id": 172445034,
        "node_id": "U_kgDOCkdNag",
        "avatar_url": "https://avatars.githubusercontent.com/u/172445034?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/hodlinator",
        "html_url": "https://github.com/hodlinator",
        "followers_url": "https://api.github.com/users/hodlinator/followers",
        "following_url": "https://api.github.com/users/hodlinator/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/hodlinator/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/hodlinator/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/hodlinator/subscriptions",
        "organizations_url": "https://api.github.com/users/hodlinator/orgs",
        "repos_url": "https://api.github.com/users/hodlinator/repos",
        "events_url": "https://api.github.com/users/hodlinator/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/hodlinator/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31483#pullrequestreview-2545133420",
      "submitted_at": "2025-01-11T20:25:57Z",
      "state": "APPROVED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31483"
    },
    {
      "event": "review_requested",
      "id": 15893557315,
      "node_id": "RRE_lADOABII586jEBuMzwAAAAOzVHBD",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/15893557315",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-01-11T20:26:02Z",
      "requested_reviewer": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "review_requester": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      }
    },
    {
      "event": "head_ref_force_pushed",
      "id": 15893607833,
      "node_id": "HRFPE_lADOABII586jEBuMzwAAAAOzVTWZ",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/15893607833",
      "actor": {
        "login": "TheCharlatan",
        "id": 8421793,
        "node_id": "MDQ6VXNlcjg0MjE3OTM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8421793?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/TheCharlatan",
        "html_url": "https://github.com/TheCharlatan",
        "followers_url": "https://api.github.com/users/TheCharlatan/followers",
        "following_url": "https://api.github.com/users/TheCharlatan/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/TheCharlatan/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/TheCharlatan/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/TheCharlatan/subscriptions",
        "organizations_url": "https://api.github.com/users/TheCharlatan/orgs",
        "repos_url": "https://api.github.com/users/TheCharlatan/repos",
        "events_url": "https://api.github.com/users/TheCharlatan/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/TheCharlatan/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": "0e2887262e1a3a4a5ab0382f9e8713b135408a77",
      "commit_url": "https://api.github.com/repos/TheCharlatan/bitcoin/commits/0e2887262e1a3a4a5ab0382f9e8713b135408a77",
      "created_at": "2025-01-11T21:01:20Z"
    },
    {
      "event": "commented",
      "id": 2585406915,
      "node_id": "IC_kwDOABII586aGi3D",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2585406915",
      "actor": {
        "login": "TheCharlatan",
        "id": 8421793,
        "node_id": "MDQ6VXNlcjg0MjE3OTM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8421793?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/TheCharlatan",
        "html_url": "https://github.com/TheCharlatan",
        "followers_url": "https://api.github.com/users/TheCharlatan/followers",
        "following_url": "https://api.github.com/users/TheCharlatan/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/TheCharlatan/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/TheCharlatan/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/TheCharlatan/subscriptions",
        "organizations_url": "https://api.github.com/users/TheCharlatan/orgs",
        "repos_url": "https://api.github.com/users/TheCharlatan/repos",
        "events_url": "https://api.github.com/users/TheCharlatan/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/TheCharlatan/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-01-11T21:01:23Z",
      "updated_at": "2025-01-11T21:01:23Z",
      "author_association": "CONTRIBUTOR",
      "body": "Thanks for the ACK @hodlinator :)\r\n\r\nUpdated cf20c1b9e0b46cb8c4d4f93a054afd9c1f85e4e0 -> 0e2887262e1a3a4a5ab0382f9e8713b135408a77 ([kernel_cache_sizes_13](https://github.com/TheCharlatan/bitcoin/tree/kernel_cache_sizes_13) -> [kernel_cache_sizes_14](https://github.com/TheCharlatan/bitcoin/tree/kernel_cache_sizes_14), [compare](https://github.com/TheCharlatan/bitcoin/compare/kernel_cache_sizes_13..kernel_cache_sizes_14))\r\n\r\n* Addressed @hodlinator's [comment](https://github.com/bitcoin/bitcoin/pull/31483#discussion_r1912175146), improved text in exception throw on failed MiB conversion.\r\n* Addressed @hodlinator's [comment](https://github.com/bitcoin/bitcoin/pull/31483#discussion_r1912179390), fixed typo.\r\n* Addressed @hodlinator's [comment_1](https://github.com/bitcoin/bitcoin/pull/31483#discussion_r1912181339) and [comment_2](https://github.com/bitcoin/bitcoin/pull/31483#discussion_r1912212037), reducing line churn between commits.\r\n\r\n> mega-nit: Could possibly have used CheckedLeftShift() or SaturatingLeftShift() in intermediate commits.\r\n\r\nSkipping this one for now, unless another reviewer thinks it's useful.",
      "user": {
        "login": "TheCharlatan",
        "id": 8421793,
        "node_id": "MDQ6VXNlcjg0MjE3OTM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8421793?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/TheCharlatan",
        "html_url": "https://github.com/TheCharlatan",
        "followers_url": "https://api.github.com/users/TheCharlatan/followers",
        "following_url": "https://api.github.com/users/TheCharlatan/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/TheCharlatan/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/TheCharlatan/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/TheCharlatan/subscriptions",
        "organizations_url": "https://api.github.com/users/TheCharlatan/orgs",
        "repos_url": "https://api.github.com/users/TheCharlatan/repos",
        "events_url": "https://api.github.com/users/TheCharlatan/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/TheCharlatan/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31483#issuecomment-2585406915",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/31483"
    },
    {
      "event": "mentioned",
      "id": 15893607964,
      "node_id": "MEE_lADOABII586jEBuMzwAAAAOzVTYc",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/15893607964",
      "actor": {
        "login": "hodlinator",
        "id": 172445034,
        "node_id": "U_kgDOCkdNag",
        "avatar_url": "https://avatars.githubusercontent.com/u/172445034?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/hodlinator",
        "html_url": "https://github.com/hodlinator",
        "followers_url": "https://api.github.com/users/hodlinator/followers",
        "following_url": "https://api.github.com/users/hodlinator/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/hodlinator/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/hodlinator/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/hodlinator/subscriptions",
        "organizations_url": "https://api.github.com/users/hodlinator/orgs",
        "repos_url": "https://api.github.com/users/hodlinator/repos",
        "events_url": "https://api.github.com/users/hodlinator/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/hodlinator/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-01-11T21:01:25Z"
    },
    {
      "event": "subscribed",
      "id": 15893607976,
      "node_id": "SE_lADOABII586jEBuMzwAAAAOzVTYo",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/15893607976",
      "actor": {
        "login": "hodlinator",
        "id": 172445034,
        "node_id": "U_kgDOCkdNag",
        "avatar_url": "https://avatars.githubusercontent.com/u/172445034?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/hodlinator",
        "html_url": "https://github.com/hodlinator",
        "followers_url": "https://api.github.com/users/hodlinator/followers",
        "following_url": "https://api.github.com/users/hodlinator/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/hodlinator/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/hodlinator/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/hodlinator/subscriptions",
        "organizations_url": "https://api.github.com/users/hodlinator/orgs",
        "repos_url": "https://api.github.com/users/hodlinator/repos",
        "events_url": "https://api.github.com/users/hodlinator/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/hodlinator/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-01-11T21:01:25Z"
    },
    {
      "event": "reviewed",
      "id": 2545245484,
      "node_id": "PRR_kwDOABII586XtV0s",
      "url": null,
      "actor": null,
      "commit_id": "0e2887262e1a3a4a5ab0382f9e8713b135408a77",
      "commit_url": null,
      "created_at": null,
      "author_association": "CONTRIBUTOR",
      "body": "re-ACK 0e2887262e1a3a4a5ab0382f9e8713b135408a77\r\n\r\nThanks for addressing my comments. :rocket: ",
      "user": {
        "login": "hodlinator",
        "id": 172445034,
        "node_id": "U_kgDOCkdNag",
        "avatar_url": "https://avatars.githubusercontent.com/u/172445034?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/hodlinator",
        "html_url": "https://github.com/hodlinator",
        "followers_url": "https://api.github.com/users/hodlinator/followers",
        "following_url": "https://api.github.com/users/hodlinator/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/hodlinator/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/hodlinator/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/hodlinator/subscriptions",
        "organizations_url": "https://api.github.com/users/hodlinator/orgs",
        "repos_url": "https://api.github.com/users/hodlinator/repos",
        "events_url": "https://api.github.com/users/hodlinator/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/hodlinator/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31483#pullrequestreview-2545245484",
      "submitted_at": "2025-01-11T21:11:14Z",
      "state": "APPROVED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31483"
    },
    {
      "event": "labeled",
      "id": 15893729980,
      "node_id": "LE_lADOABII586jEBuMzwAAAAOzVxK8",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/15893729980",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-01-11T22:02:23Z",
      "label": {
        "name": "CI failed",
        "color": "cccccc"
      }
    },
    {
      "event": "unlabeled",
      "id": 15893753879,
      "node_id": "UNLE_lADOABII586jEBuMzwAAAAOzV3AX",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/15893753879",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-01-11T22:11:53Z",
      "label": {
        "name": "CI failed",
        "color": "cccccc"
      }
    },
    {
      "event": "reviewed",
      "id": 2546242450,
      "node_id": "PRR_kwDOABII586XxJOS",
      "url": null,
      "actor": null,
      "commit_id": "0e2887262e1a3a4a5ab0382f9e8713b135408a77",
      "commit_url": null,
      "created_at": null,
      "author_association": "CONTRIBUTOR",
      "body": "Did a full re-review on 0e2887262e1a3a4a5ab0382f9e8713b135408a77. Thank you for incorporating my `util/overflow.h` and `util/byte_units.h` suggestions, I really like the current approach.\r\n\r\nNits can  be ignored, but I think my 2 `util/overflow.h` UB comments([1](https://github.com/bitcoin/bitcoin/pull/31483#discussion_r1913008528), [2](https://github.com/bitcoin/bitcoin/pull/31483#discussion_r1913070129)) would be best to fix before merge. I probably won't be having any further comments after this.",
      "user": {
        "login": "stickies-v",
        "id": 69010457,
        "node_id": "MDQ6VXNlcjY5MDEwNDU3",
        "avatar_url": "https://avatars.githubusercontent.com/u/69010457?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stickies-v",
        "html_url": "https://github.com/stickies-v",
        "followers_url": "https://api.github.com/users/stickies-v/followers",
        "following_url": "https://api.github.com/users/stickies-v/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stickies-v/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stickies-v/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stickies-v/subscriptions",
        "organizations_url": "https://api.github.com/users/stickies-v/orgs",
        "repos_url": "https://api.github.com/users/stickies-v/repos",
        "events_url": "https://api.github.com/users/stickies-v/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stickies-v/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31483#pullrequestreview-2546242450",
      "submitted_at": "2025-01-13T15:06:12Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31483"
    },
    {
      "event": "review_requested",
      "id": 15906705757,
      "node_id": "RRE_lADOABII586jEBuMzwAAAAO0HRFd",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/15906705757",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-01-13T15:06:18Z",
      "requested_reviewer": {
        "login": "stickies-v",
        "id": 69010457,
        "node_id": "MDQ6VXNlcjY5MDEwNDU3",
        "avatar_url": "https://avatars.githubusercontent.com/u/69010457?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stickies-v",
        "html_url": "https://github.com/stickies-v",
        "followers_url": "https://api.github.com/users/stickies-v/followers",
        "following_url": "https://api.github.com/users/stickies-v/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stickies-v/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stickies-v/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stickies-v/subscriptions",
        "organizations_url": "https://api.github.com/users/stickies-v/orgs",
        "repos_url": "https://api.github.com/users/stickies-v/repos",
        "events_url": "https://api.github.com/users/stickies-v/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stickies-v/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "review_requester": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      }
    },
    {
      "event": "reviewed",
      "id": 2547263536,
      "node_id": "PRR_kwDOABII586X1Cgw",
      "url": null,
      "actor": null,
      "commit_id": "e0a541702def3a4c6cce8e44b6ebe8d608edad4e",
      "commit_url": null,
      "created_at": null,
      "author_association": "CONTRIBUTOR",
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31483#pullrequestreview-2547263536",
      "submitted_at": "2025-01-13T17:04:38Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31483"
    },
    {
      "event": "review_requested",
      "id": 15909028468,
      "node_id": "RRE_lADOABII586jEBuMzwAAAAO0QIJ0",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/15909028468",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-01-13T17:04:42Z",
      "requested_reviewer": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "review_requester": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      }
    },
    {
      "event": "commented",
      "id": 2590452047,
      "node_id": "IC_kwDOABII586aZylP",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2590452047",
      "actor": {
        "login": "TheCharlatan",
        "id": 8421793,
        "node_id": "MDQ6VXNlcjg0MjE3OTM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8421793?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/TheCharlatan",
        "html_url": "https://github.com/TheCharlatan",
        "followers_url": "https://api.github.com/users/TheCharlatan/followers",
        "following_url": "https://api.github.com/users/TheCharlatan/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/TheCharlatan/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/TheCharlatan/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/TheCharlatan/subscriptions",
        "organizations_url": "https://api.github.com/users/TheCharlatan/orgs",
        "repos_url": "https://api.github.com/users/TheCharlatan/repos",
        "events_url": "https://api.github.com/users/TheCharlatan/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/TheCharlatan/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-01-14T16:26:07Z",
      "updated_at": "2025-01-14T16:26:07Z",
      "author_association": "CONTRIBUTOR",
      "body": "Updated 0e2887262e1a3a4a5ab0382f9e8713b135408a77 -> 922aa7a25650bdfd8428198f171f88915af1ffa0 ([kernel_cache_sizes_14](https://github.com/TheCharlatan/bitcoin/tree/kernel_cache_sizes_14) -> [kernel_cache_sizes_15](https://github.com/TheCharlatan/bitcoin/tree/kernel_cache_sizes_15), [compare](https://github.com/TheCharlatan/bitcoin/compare/kernel_cache_sizes_14..kernel_cache_sizes_15))\r\n\r\n* Addressed @stickies-v's [comment](https://github.com/bitcoin/bitcoin/pull/31483#discussion_r1912972952), renaming `i` to `input`.\r\n* Addressed @stickies-v's [comment](https://github.com/bitcoin/bitcoin/pull/31483#discussion_r1913008528), avoid UB when shifting by more bits than the shifted type is wide.\r\n* Addressed @stickies-v's [comment](https://github.com/bitcoin/bitcoin/pull/31483#discussion_r1913070129), return 0 early in CheckedLeftShift when the input is 0.\r\n* Addressed @stickies-v's [comment](https://github.com/bitcoin/bitcoin/pull/31483#discussion_r1913095820), get rid of potentially confusing `using kernel::CachSizes` statement in `init.cpp`.\r\n* Addressed @stickies-v's [comment](https://github.com/bitcoin/bitcoin/pull/31483#discussion_r1913290613), removed `optional` include where no longer required from a prior state of this pull request.\r\n* Addressed @stickies-v's [comment](https://github.com/bitcoin/bitcoin/pull/31483#discussion_r1913307791), default-initialize `IndexCacheSizes` fields with `0`.\r\n* Addressed @stickies-v's [comment](https://github.com/bitcoin/bitcoin/pull/31483#discussion_r1913317790), correct type of `max_cache` to `size_t`.\r\n* Took @ryanofsky's [suggestion](https://github.com/bitcoin/bitcoin/pull/31483#discussion_r1913521985), make `CheckedLeftShift` and `SaturatingLeftShift` use the same type for input and output, as well as allowing negative input.",
      "user": {
        "login": "TheCharlatan",
        "id": 8421793,
        "node_id": "MDQ6VXNlcjg0MjE3OTM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8421793?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/TheCharlatan",
        "html_url": "https://github.com/TheCharlatan",
        "followers_url": "https://api.github.com/users/TheCharlatan/followers",
        "following_url": "https://api.github.com/users/TheCharlatan/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/TheCharlatan/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/TheCharlatan/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/TheCharlatan/subscriptions",
        "organizations_url": "https://api.github.com/users/TheCharlatan/orgs",
        "repos_url": "https://api.github.com/users/TheCharlatan/repos",
        "events_url": "https://api.github.com/users/TheCharlatan/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/TheCharlatan/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31483#issuecomment-2590452047",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/31483"
    },
    {
      "event": "mentioned",
      "id": 15926194399,
      "node_id": "MEE_lADOABII586jEBuMzwAAAAO1RnDf",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/15926194399",
      "actor": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-01-14T16:26:09Z"
    },
    {
      "event": "subscribed",
      "id": 15926194448,
      "node_id": "SE_lADOABII586jEBuMzwAAAAO1RnEQ",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/15926194448",
      "actor": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-01-14T16:26:09Z"
    },
    {
      "event": "mentioned",
      "id": 15926194473,
      "node_id": "MEE_lADOABII586jEBuMzwAAAAO1RnEp",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/15926194473",
      "actor": {
        "login": "stickies-v",
        "id": 69010457,
        "node_id": "MDQ6VXNlcjY5MDEwNDU3",
        "avatar_url": "https://avatars.githubusercontent.com/u/69010457?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stickies-v",
        "html_url": "https://github.com/stickies-v",
        "followers_url": "https://api.github.com/users/stickies-v/followers",
        "following_url": "https://api.github.com/users/stickies-v/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stickies-v/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stickies-v/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stickies-v/subscriptions",
        "organizations_url": "https://api.github.com/users/stickies-v/orgs",
        "repos_url": "https://api.github.com/users/stickies-v/repos",
        "events_url": "https://api.github.com/users/stickies-v/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stickies-v/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-01-14T16:26:09Z"
    },
    {
      "event": "subscribed",
      "id": 15926194485,
      "node_id": "SE_lADOABII586jEBuMzwAAAAO1RnE1",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/15926194485",
      "actor": {
        "login": "stickies-v",
        "id": 69010457,
        "node_id": "MDQ6VXNlcjY5MDEwNDU3",
        "avatar_url": "https://avatars.githubusercontent.com/u/69010457?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stickies-v",
        "html_url": "https://github.com/stickies-v",
        "followers_url": "https://api.github.com/users/stickies-v/followers",
        "following_url": "https://api.github.com/users/stickies-v/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stickies-v/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stickies-v/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stickies-v/subscriptions",
        "organizations_url": "https://api.github.com/users/stickies-v/orgs",
        "repos_url": "https://api.github.com/users/stickies-v/repos",
        "events_url": "https://api.github.com/users/stickies-v/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stickies-v/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-01-14T16:26:09Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 15926200204,
      "node_id": "HRFPE_lADOABII586jEBuMzwAAAAO1RoeM",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/15926200204",
      "actor": {
        "login": "TheCharlatan",
        "id": 8421793,
        "node_id": "MDQ6VXNlcjg0MjE3OTM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8421793?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/TheCharlatan",
        "html_url": "https://github.com/TheCharlatan",
        "followers_url": "https://api.github.com/users/TheCharlatan/followers",
        "following_url": "https://api.github.com/users/TheCharlatan/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/TheCharlatan/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/TheCharlatan/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/TheCharlatan/subscriptions",
        "organizations_url": "https://api.github.com/users/TheCharlatan/orgs",
        "repos_url": "https://api.github.com/users/TheCharlatan/repos",
        "events_url": "https://api.github.com/users/TheCharlatan/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/TheCharlatan/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": "922aa7a25650bdfd8428198f171f88915af1ffa0",
      "commit_url": "https://api.github.com/repos/TheCharlatan/bitcoin/commits/922aa7a25650bdfd8428198f171f88915af1ffa0",
      "created_at": "2025-01-14T16:26:25Z"
    },
    {
      "event": "reviewed",
      "id": 2550610710,
      "node_id": "PRR_kwDOABII586YBzsW",
      "url": null,
      "actor": null,
      "commit_id": "922aa7a25650bdfd8428198f171f88915af1ffa0",
      "commit_url": null,
      "created_at": null,
      "author_association": "CONTRIBUTOR",
      "body": "Code review ACK 922aa7a25650bdfd8428198f171f88915af1ffa0. Changes since last review were clamping -dbcache cache value instead of returning an error if it is too large, making more constants use bytes instead of mib, replacing MiBToBytes with SaturatingLeftShift, adding MiB literal suffix. Would maybe consider squashing the last two commits as it seems a little to safer to rename the constants at the same time as changing their units instead of separately.",
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31483#pullrequestreview-2550610710",
      "submitted_at": "2025-01-14T20:27:40Z",
      "state": "APPROVED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31483"
    },
    {
      "event": "review_requested",
      "id": 15929832347,
      "node_id": "RRE_lADOABII586jEBuMzwAAAAO1ffOb",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/15929832347",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-01-14T20:27:44Z",
      "requested_reviewer": {
        "login": "hodlinator",
        "id": 172445034,
        "node_id": "U_kgDOCkdNag",
        "avatar_url": "https://avatars.githubusercontent.com/u/172445034?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/hodlinator",
        "html_url": "https://github.com/hodlinator",
        "followers_url": "https://api.github.com/users/hodlinator/followers",
        "following_url": "https://api.github.com/users/hodlinator/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/hodlinator/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/hodlinator/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/hodlinator/subscriptions",
        "organizations_url": "https://api.github.com/users/hodlinator/orgs",
        "repos_url": "https://api.github.com/users/hodlinator/repos",
        "events_url": "https://api.github.com/users/hodlinator/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/hodlinator/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "review_requester": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      }
    },
    {
      "event": "head_ref_force_pushed",
      "id": 15937069028,
      "node_id": "HRFPE_lADOABII586jEBuMzwAAAAO17F_k",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/15937069028",
      "actor": {
        "login": "TheCharlatan",
        "id": 8421793,
        "node_id": "MDQ6VXNlcjg0MjE3OTM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8421793?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/TheCharlatan",
        "html_url": "https://github.com/TheCharlatan",
        "followers_url": "https://api.github.com/users/TheCharlatan/followers",
        "following_url": "https://api.github.com/users/TheCharlatan/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/TheCharlatan/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/TheCharlatan/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/TheCharlatan/subscriptions",
        "organizations_url": "https://api.github.com/users/TheCharlatan/orgs",
        "repos_url": "https://api.github.com/users/TheCharlatan/repos",
        "events_url": "https://api.github.com/users/TheCharlatan/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/TheCharlatan/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": "430d5feee9b8be3a85e85696c449753783301c2b",
      "commit_url": "https://api.github.com/repos/TheCharlatan/bitcoin/commits/430d5feee9b8be3a85e85696c449753783301c2b",
      "created_at": "2025-01-15T09:06:48Z"
    },
    {
      "event": "commented",
      "id": 2592035361,
      "node_id": "IC_kwDOABII586af1Ih",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2592035361",
      "actor": {
        "login": "TheCharlatan",
        "id": 8421793,
        "node_id": "MDQ6VXNlcjg0MjE3OTM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8421793?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/TheCharlatan",
        "html_url": "https://github.com/TheCharlatan",
        "followers_url": "https://api.github.com/users/TheCharlatan/followers",
        "following_url": "https://api.github.com/users/TheCharlatan/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/TheCharlatan/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/TheCharlatan/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/TheCharlatan/subscriptions",
        "organizations_url": "https://api.github.com/users/TheCharlatan/orgs",
        "repos_url": "https://api.github.com/users/TheCharlatan/repos",
        "events_url": "https://api.github.com/users/TheCharlatan/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/TheCharlatan/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-01-15T09:06:51Z",
      "updated_at": "2025-01-15T09:37:13Z",
      "author_association": "CONTRIBUTOR",
      "body": "Updated 922aa7a25650bdfd8428198f171f88915af1ffa0 -> 430d5feee9b8be3a85e85696c449753783301c2b ([kernel_cache_sizes_15](https://github.com/TheCharlatan/bitcoin/tree/kernel_cache_sizes_15) -> [kernel_cache_sizes_16](https://github.com/TheCharlatan/bitcoin/tree/kernel_cache_sizes_16), [compare](https://github.com/TheCharlatan/bitcoin/compare/kernel_cache_sizes_15..kernel_cache_sizes_16))\r\n\r\n* Addressed @ryanofsky's [comment_1](https://github.com/bitcoin/bitcoin/pull/31483#discussion_r1915387311), [comment_2](https://github.com/bitcoin/bitcoin/pull/31483#discussion_r1915394447), simplifying left shift helpers doc string.\r\n* Added @ryanofsky's [suggested](https://github.com/bitcoin/bitcoin/pull/31483#discussion_r1915356827) fuzz test.\r\n* Reverted bit width check to `if (shift >= sizeof(T) * CHAR_BIT) return std::nullopt;` instead of counting digits, since it actually does as advertised (count bits to avoid UB). Any potential shift into negative value ranges is still caught by the `max_allowed_input` check.\r\n\r\n",
      "user": {
        "login": "TheCharlatan",
        "id": 8421793,
        "node_id": "MDQ6VXNlcjg0MjE3OTM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8421793?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/TheCharlatan",
        "html_url": "https://github.com/TheCharlatan",
        "followers_url": "https://api.github.com/users/TheCharlatan/followers",
        "following_url": "https://api.github.com/users/TheCharlatan/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/TheCharlatan/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/TheCharlatan/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/TheCharlatan/subscriptions",
        "organizations_url": "https://api.github.com/users/TheCharlatan/orgs",
        "repos_url": "https://api.github.com/users/TheCharlatan/repos",
        "events_url": "https://api.github.com/users/TheCharlatan/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/TheCharlatan/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31483#issuecomment-2592035361",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/31483"
    },
    {
      "event": "mentioned",
      "id": 15937070019,
      "node_id": "MEE_lADOABII586jEBuMzwAAAAO17GPD",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/15937070019",
      "actor": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-01-15T09:06:52Z"
    },
    {
      "event": "subscribed",
      "id": 15937070037,
      "node_id": "SE_lADOABII586jEBuMzwAAAAO17GPV",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/15937070037",
      "actor": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-01-15T09:06:52Z"
    },
    {
      "event": "reviewed",
      "id": 2552509159,
      "node_id": "PRR_kwDOABII586YJDLn",
      "url": null,
      "actor": null,
      "commit_id": "430d5feee9b8be3a85e85696c449753783301c2b",
      "commit_url": null,
      "created_at": null,
      "author_association": "CONTRIBUTOR",
      "body": "ACK 430d5feee9b8be3a85e85696c449753783301c2b",
      "user": {
        "login": "stickies-v",
        "id": 69010457,
        "node_id": "MDQ6VXNlcjY5MDEwNDU3",
        "avatar_url": "https://avatars.githubusercontent.com/u/69010457?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stickies-v",
        "html_url": "https://github.com/stickies-v",
        "followers_url": "https://api.github.com/users/stickies-v/followers",
        "following_url": "https://api.github.com/users/stickies-v/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stickies-v/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stickies-v/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stickies-v/subscriptions",
        "organizations_url": "https://api.github.com/users/stickies-v/orgs",
        "repos_url": "https://api.github.com/users/stickies-v/repos",
        "events_url": "https://api.github.com/users/stickies-v/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stickies-v/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31483#pullrequestreview-2552509159",
      "submitted_at": "2025-01-15T13:59:23Z",
      "state": "APPROVED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31483"
    },
    {
      "event": "review_requested",
      "id": 15941510481,
      "node_id": "RRE_lADOABII586jEBuMzwAAAAO2MCVR",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/15941510481",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-01-15T13:59:29Z",
      "requested_reviewer": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "review_requester": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      }
    },
    {
      "event": "reviewed",
      "id": 2552875375,
      "node_id": "PRR_kwDOABII586YKclv",
      "url": null,
      "actor": null,
      "commit_id": "430d5feee9b8be3a85e85696c449753783301c2b",
      "commit_url": null,
      "created_at": null,
      "author_association": "CONTRIBUTOR",
      "body": "Code review ACK 430d5feee9b8be3a85e85696c449753783301c2b. Changes since last review were adding fuzz test and changing comments as suggested and switching back from digits() to sizeof().\r\n\r\nThis all looks good, though I was curious about two things. (No need to investigate these, just curious if there is any more information)\r\n\r\n- This is moot but I was wondering about the \"I had a compiler complain about signed to unsigned integer comparison without it.\" https://github.com/bitcoin/bitcoin/pull/31483#discussion_r1915573360 comment because I actually don't know what signed to unsigned comparison would have been taking place there or why I wasn't seeing it.\r\n\r\n- Curious what motivated change from digits() back to sizeof(). Both ways seem fine. I guess sizeof() matches c++ documentation more closely, but digits() looked a little cleaner and could maybe be better in a theoretical case where a type had some padding or custom integer types were supported.",
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31483#pullrequestreview-2552875375",
      "submitted_at": "2025-01-15T14:40:09Z",
      "state": "APPROVED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31483"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKGMwM2EyNzk1YThlMDQ0ZDE3ODM1YmJmMDNkZTBjNjRkYzdiNDFkYTg",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/c03a2795a8e044d17835bbf03de0c64dc7b41da8",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/c03a2795a8e044d17835bbf03de0c64dc7b41da8",
      "tree": {
        "sha": "34dcf185aa8086f7ebc0621988f60350673a7e04",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/34dcf185aa8086f7ebc0621988f60350673a7e04"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree 34dcf185aa8086f7ebc0621988f60350673a7e04\nparent 8bd5f8a38ce903c05606841ebed1902398cb0b14\nauthor TheCharlatan <seb.kung@gmail.com> 1736418343 +0100\ncommitter TheCharlatan <seb.kung@gmail.com> 1736952185 +0100\n\nutil: Add integer left shift helpers\n\nThe helpers are used in the following commits to increase the safety of\nconversions during cache size calculations.\n\nCo-authored-by: Ryan Ofsky <ryan@ofsky.org>\nCo-authored-by: stickies-v <stickies-v@protonmail.com>\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCgAdFiEE8s/Eq9C5nYN+67fQm3m0VpHbQXMFAmeHyXoACgkQm3m0VpHb\nQXM/3w//QaXsdE9wQOstHWJpLf5OmdfZkZtFToOj9AQtAYuOVv5iCqzId/n6e+hR\npyuu5XZOrgCX4LnJNLPkXkFHvwVgKDxqe+a18GgDe8ap3PPq3Cce+thdaPZeEPB+\nB5RLaVMxPtutoqedfzZZHeQF/oZDMM6GQNW+GwkUbtq5Nbs5JDyiukJEi2ax1afq\n/ObtZgJwcVlTXws+njOBeSG1BvUBa78P3Mt+0ncls82o7UuiYLb50jfdklM1FmDZ\n5f3NCmIXvA5bHin8/gz5t2cjMleWOUBzucM2BJtHLSmPeZZOOf4AXpZpJitK8FBg\nmbMaa3t/oyfhhi0LMOZ6qSUn3cBsOIIK4j/Ch2Rce6KjIGDREjmTtwNNWchwJ8xe\nO4ewT37YCNSLagx8Qn6SqbXyqX8jMaxX+JnUVyPD0BrQ91awvYMB1leTML3Abpqt\n6OTaD4cPl5Qp6sXjna9tDIgFrLNZzf6AvTZEpo9aZpVNRXVQGFUbMP/9Vg8fiHuB\n2qkVP8anx/GjpYWwK7CQCFE0Cmo39JB1wxR8ijM07TD9iMGe2b/J26EDo3kt0F/7\na/heWzdU7gBYqyG4KsP4/tpQ5beO/fSC7b+4W1GyTkqXA5831GbHPhgwNpfUhu/r\nrm7Yc4JpSPOWT+o0tvL9/KuQLpcGjw8+ieoPgZbx5CljF5IiVRM=\n=iMpx\n-----END PGP SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/8bd5f8a38ce903c05606841ebed1902398cb0b14",
          "sha": "8bd5f8a38ce903c05606841ebed1902398cb0b14",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/8bd5f8a38ce903c05606841ebed1902398cb0b14"
        }
      ],
      "message": "util: Add integer left shift helpers\n\nThe helpers are used in the following commits to increase the safety of\nconversions during cache size calculations.\n\nCo-authored-by: Ryan Ofsky <ryan@ofsky.org>\nCo-authored-by: stickies-v <stickies-v@protonmail.com>",
      "committer": {
        "name": "TheCharlatan",
        "email": "seb.kung@gmail.com",
        "date": "2025-01-15T14:43:05Z"
      },
      "author": {
        "name": "TheCharlatan",
        "email": "seb.kung@gmail.com",
        "date": "2025-01-09T10:25:43Z"
      },
      "sha": "c03a2795a8e044d17835bbf03de0c64dc7b41da8"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKGQ1ZTJjNGE0MDk3Yzc5OTQzM2NmYzUzNjdjNjE1NjhmYWQyYzc4NGU",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/d5e2c4a4097c799433cfc5367c61568fad2c784e",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/d5e2c4a4097c799433cfc5367c61568fad2c784e",
      "tree": {
        "sha": "9c7bba8913da8859fc083178b6eb1ac0d311c84c",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/9c7bba8913da8859fc083178b6eb1ac0d311c84c"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree 9c7bba8913da8859fc083178b6eb1ac0d311c84c\nparent c03a2795a8e044d17835bbf03de0c64dc7b41da8\nauthor TheCharlatan <seb.kung@gmail.com> 1736889705 +0100\ncommitter TheCharlatan <seb.kung@gmail.com> 1736952243 +0100\n\nfuzz: Add fuzz test for checked and saturating add and left shift\n\nCo-authored-by: Ryan Ofsky <ryan@ofsky.org>\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCgAdFiEE8s/Eq9C5nYN+67fQm3m0VpHbQXMFAmeHybMACgkQm3m0VpHb\nQXOxPQ/8DxbHB5lcz6aAuhL6AYIcCiD9fSIHK0LQ4P679CR9/bao2y7WfGWxfuNR\nvJ2FLOOxlJj56alfGVT4aCaN6DQUeyILrRMS3tdqSV3gTKaWjYM3Myn7ZFmsLy0b\nF2xuT2H9oSZ3T+Rp8FlD0vE+BAFkIdv7Ta7eUrLmrK6nBSel2t9nHTshi4UQkS86\n7XTAmQvVJMxumBLxopn8W/Hy6i5RU3NJvQ7RrRRDmo2/wmEcNIAMiwHUukYABxZ7\noXyqjj7ccKusUNIxsSE632+M/T5RIowPPqQ1HrxGQG+u86iA1nfWa72iRgBYvgBJ\nNBGsGuPkBUBc572s9Du6YS2gowz/T57kUKf3NFlBea5bYC8Sa6tHXMd8Xz+uqjWs\nDC4UEksgDyctMoGb07vjNCniXA66MBMjTMSx7ADkxFIERJ9T2FohCvH8iHK0/6d3\nT8P8ImaOvkWrp7x/kbnDe/jurZxNfLYZ32HnoKob/EZggEX2b5dM/RUSQ9gkhHdm\nrFKQx2q0YHt1Y8fgvIyWi8rCYcHw6GWAO/2DA2Zx+T5fmfy/HFY/GCcdv96vYYMq\n9VezcMplLEbnEKP3weVnHr6f87PqnnJsQFEfI5d2MttKz9mL/mXQHnNeSE5trT7T\nnL/BaiPncKVPDeZrYet4W09FnpQrB3lgmDZGMpntI8F5+CNvhK8=\n=1kMt\n-----END PGP SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/c03a2795a8e044d17835bbf03de0c64dc7b41da8",
          "sha": "c03a2795a8e044d17835bbf03de0c64dc7b41da8",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/c03a2795a8e044d17835bbf03de0c64dc7b41da8"
        }
      ],
      "message": "fuzz: Add fuzz test for checked and saturating add and left shift\n\nCo-authored-by: Ryan Ofsky <ryan@ofsky.org>",
      "committer": {
        "name": "TheCharlatan",
        "email": "seb.kung@gmail.com",
        "date": "2025-01-15T14:44:03Z"
      },
      "author": {
        "name": "TheCharlatan",
        "email": "seb.kung@gmail.com",
        "date": "2025-01-14T21:21:45Z"
      },
      "sha": "d5e2c4a4097c799433cfc5367c61568fad2c784e"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKGU3NThiMjZiODVkYTI3ZWY0NGYzZDJjOTI0ZjNmMDhlOGMxZjRmZGY",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/e758b26b85da27ef44f3d2c924f3f08e8c1f4fdf",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/e758b26b85da27ef44f3d2c924f3f08e8c1f4fdf",
      "tree": {
        "sha": "2e771f5e4e303cd2be48fdeb6baeaa196a2a3f78",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/2e771f5e4e303cd2be48fdeb6baeaa196a2a3f78"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree 2e771f5e4e303cd2be48fdeb6baeaa196a2a3f78\nparent d5e2c4a4097c799433cfc5367c61568fad2c784e\nauthor TheCharlatan <seb.kung@gmail.com> 1732305094 +0100\ncommitter TheCharlatan <seb.kung@gmail.com> 1736952256 +0100\n\nkernel: Move kernel-specific cache size options to kernel\n\nCarrying non-kernel related fields in the cache sizes for the indexes is\nconfusing for kernel library users. The cache sizes also are set\ncurrently with magic numbers in bitcoin-chainstate. The comments for the\ncache size calculations are also not completely clear.\n\nSolve these things by moving the kernel-specific cache size fields to\ntheir own struct.\n\nThis slightly changes the way the cache is allocated if the txindex\nand/or blockfilterindex is used. Since they are now given precedence\nover the block tree db cache, this results in a bit less cache being\nallocated to the block tree db, coinsdb and coins caches. The effect is\nnegligible though, i.e. cache sizes with default dbcache reported\nthrough the logs are:\n\nmaster:\nCache configuration:\n* Using 2.0 MiB for block index database\n* Using 56.0 MiB for transaction index database\n* Using 49.0 MiB for basic block filter index database\n* Using 8.0 MiB for chain state database\n* Using 335.0 MiB for in-memory UTXO set (plus up to 286.1 MiB of unused mempool space)\n\nthis branch:\nCache configuration:\n* Using 2.0 MiB for block index database\n* Using 56.2 MiB for transaction index database\n* Using 49.2 MiB for basic block filter index database\n* Using 8.0 MiB for chain state database\n* Using 334.5 MiB for in-memory UTXO set (plus up to 286.1 MiB of unused mempool space)\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCgAdFiEE8s/Eq9C5nYN+67fQm3m0VpHbQXMFAmeHycAACgkQm3m0VpHb\nQXPpcBAAsCPaKxF6G0K1x1qI/d1/0bVdvq+pYnRJWu/q26peaVFITn32fcdeiBzG\nvE/GDsXtgr8u/X0H3vs4REz/xwpNududjpfV36VLASnJIBM71ERxPMgbsBeZHeJM\nDJy/zKUI6XnR6BP7FUmDCwog7lFVeSSxbJCZ6npvsw3lIEk0Vg07ExIgH3zQuoqK\nQN/InLnREnYk9KyL0lYWDoXIhE7J3ODoBNFi+NjKYjAdmHsUD6IEq5UVj2eXHasa\nE2TZRNren5w77IPuzNd5iTJ3rCxYK0ZUHcgo6s54iEF9ZJSp5b1uynQ9QeRxFLQt\ntGutHrorf++cvVIC07b2oc66pUDw9xLvG+4wkRgZQKlRKXr1oLH1vf1AtZEYDVA5\n9EtaMPww/jse6x26sxc0avgnRGMbiyNaQZRLJgAqW8qNWJIdc3IctkRAquKs3Nji\n4sYbRDdpEkE/FdMTJYzLvrW4WpdKcsyqlMslMaenUtDyJYKRH4oh1SbM6Y4YKFe7\nuC+IhQmdj5p/cVLSVybuKymhufmsB7skWuXH9nV33OdkEitPQP8z5GuvC3nfP2/r\nvgmiPH6nkF/TtaQ0QuwY5wWAaq1gnMgpfHXjVBNUBJpWj9Y3Eb69hbmV1gjXFuUd\nkT1J3X8DCXPUGGPVZQKrg0Cc9i6W1Cs+eTFIhhTdLfhOJNTS7/8=\n=2z71\n-----END PGP SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/d5e2c4a4097c799433cfc5367c61568fad2c784e",
          "sha": "d5e2c4a4097c799433cfc5367c61568fad2c784e",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/d5e2c4a4097c799433cfc5367c61568fad2c784e"
        }
      ],
      "message": "kernel: Move kernel-specific cache size options to kernel\n\nCarrying non-kernel related fields in the cache sizes for the indexes is\nconfusing for kernel library users. The cache sizes also are set\ncurrently with magic numbers in bitcoin-chainstate. The comments for the\ncache size calculations are also not completely clear.\n\nSolve these things by moving the kernel-specific cache size fields to\ntheir own struct.\n\nThis slightly changes the way the cache is allocated if the txindex\nand/or blockfilterindex is used. Since they are now given precedence\nover the block tree db cache, this results in a bit less cache being\nallocated to the block tree db, coinsdb and coins caches. The effect is\nnegligible though, i.e. cache sizes with default dbcache reported\nthrough the logs are:\n\nmaster:\nCache configuration:\n* Using 2.0 MiB for block index database\n* Using 56.0 MiB for transaction index database\n* Using 49.0 MiB for basic block filter index database\n* Using 8.0 MiB for chain state database\n* Using 335.0 MiB for in-memory UTXO set (plus up to 286.1 MiB of unused mempool space)\n\nthis branch:\nCache configuration:\n* Using 2.0 MiB for block index database\n* Using 56.2 MiB for transaction index database\n* Using 49.2 MiB for basic block filter index database\n* Using 8.0 MiB for chain state database\n* Using 334.5 MiB for in-memory UTXO set (plus up to 286.1 MiB of unused mempool space)",
      "committer": {
        "name": "TheCharlatan",
        "email": "seb.kung@gmail.com",
        "date": "2025-01-15T14:44:16Z"
      },
      "author": {
        "name": "TheCharlatan",
        "email": "seb.kung@gmail.com",
        "date": "2024-11-22T19:51:34Z"
      },
      "sha": "e758b26b85da27ef44f3d2c924f3f08e8c1f4fdf"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDg4MjZjYWUyODU0OTA0MzlkYzFmMTliMjVmYTcwYjJiOWU2MmRmZTg",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/8826cae285490439dc1f19b25fa70b2b9e62dfe8",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/8826cae285490439dc1f19b25fa70b2b9e62dfe8",
      "tree": {
        "sha": "7686f14e8d23fb09de461f267c65a3ff90d37835",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/7686f14e8d23fb09de461f267c65a3ff90d37835"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree 7686f14e8d23fb09de461f267c65a3ff90d37835\nparent e758b26b85da27ef44f3d2c924f3f08e8c1f4fdf\nauthor TheCharlatan <seb.kung@gmail.com> 1732311857 +0100\ncommitter TheCharlatan <seb.kung@gmail.com> 1736952284 +0100\n\nkernel: Move non-kernel db cache size constants\n\nThese have nothing to do with the txdb, so move them out and into the\nnode caches.\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCgAdFiEE8s/Eq9C5nYN+67fQm3m0VpHbQXMFAmeHyeIACgkQm3m0VpHb\nQXNXNA/+P77xSpMm4RatbMAs1SSv76J3/8MMuiap5pM+wcICmiyDJ3ogJSvezzIQ\nS63UllvPLIiX0fVmEYVynQKnWpP6Ma1cLYIE5/zZ/LVJiVdB6NDSK8okF6sa15jE\n3vCRYXYxaUS5bJREmfUmn51d5yqTwCJEWMWvyn21QTp07N+53CKVAZKsnLnLXOY9\n4WvWglu8FYCW+auyqjppO6XuNGAXeS9b2da1vHKIZbXUwFHwE/mX4RawS65VrUZ5\nYa55awR50iRNTM+kZGRv/nz+mLdbWCQS+gtQBzcqfov13cSVHfJOwADp+gg8c6Ah\nQ97xgnWbZPy3pRmnw2c2xKXG+QbqfUKtfN7NrSjSyoOPtsAtolkSSDCs8OMsQqhm\n0GmsKsjLojN+hE9CbRVzqCrt1sb0HAlNWff5GFHOWx0ZEVk+h+FuMdSUY5O8zTSI\nPl2j8g35y2eghOUpQ6ewmSkzzcQW4QCocOmXhtAHPaKwkv7yg/+2RDlMhOMhyZiK\nwdxv4f78YjW+69g1r+fzei64lid42FDmxu7VsUoZzSbsQNRLxpOezba/fCc/2o+U\ngvw/r8LzvYPdIywAmAXQOGSLdD+M685D9JNmg2EMr0PDUyu5dCDmtCj5qka69mix\nC7k+S2+zvvAObLqlahxYrlBWlkfWNUTDCA+Ii4E/HN1bVnJE4Sg=\n=Wg3u\n-----END PGP SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/e758b26b85da27ef44f3d2c924f3f08e8c1f4fdf",
          "sha": "e758b26b85da27ef44f3d2c924f3f08e8c1f4fdf",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/e758b26b85da27ef44f3d2c924f3f08e8c1f4fdf"
        }
      ],
      "message": "kernel: Move non-kernel db cache size constants\n\nThese have nothing to do with the txdb, so move them out and into the\nnode caches.",
      "committer": {
        "name": "TheCharlatan",
        "email": "seb.kung@gmail.com",
        "date": "2025-01-15T14:44:44Z"
      },
      "author": {
        "name": "TheCharlatan",
        "email": "seb.kung@gmail.com",
        "date": "2024-11-22T21:44:17Z"
      },
      "sha": "8826cae285490439dc1f19b25fa70b2b9e62dfe8"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDY1Y2RlMzYyMWRiYjlhYzdkMjEwZDQ5MjZlNzYwMWM0YWRmNWY0OTg",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/65cde3621dbb9ac7d210d4926e7601c4adf5f498",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/65cde3621dbb9ac7d210d4926e7601c4adf5f498",
      "tree": {
        "sha": "f6f325678d565c885ac12f511722d3313ceb63ed",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/f6f325678d565c885ac12f511722d3313ceb63ed"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree f6f325678d565c885ac12f511722d3313ceb63ed\nparent 8826cae285490439dc1f19b25fa70b2b9e62dfe8\nauthor TheCharlatan <seb.kung@gmail.com> 1732312322 +0100\ncommitter TheCharlatan <seb.kung@gmail.com> 1736952295 +0100\n\nkernel: Move default cache constants to caches\n\nThey are not related to the txdb, so a better place for them is the\nnew kernel and node cache file. Re-use the default amount of kernel\ncache for the default node cache.\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCgAdFiEE8s/Eq9C5nYN+67fQm3m0VpHbQXMFAmeHyecACgkQm3m0VpHb\nQXM5qw//eOigM1BMPLWp72+qhHfGZzNwY8a7l6JJzdzsrqObOxB15kdrZ/h6P8I+\nZdiMidio8gkS3wM7DMc/7c78TqHYN8BHYTkdzAu/W3uJht830l4DPfKDLzuZWwv9\nr4yMUi7oEoX796cq0ehBRAXUYDAe7D0GwUrDiJRTq3VRSqZcKa5TJTkgM1CAqXSp\nv6YjOLhGYOm8EKDdCG8CNlH4X0b7MXg/VfTyEQfu5NMvwnhdvxX4Caoj2BvIy5x4\nLhbthAHRaV4BfgjDJuWKdcHMOdj88yCjMGgCRpTNMd9zSfUjOtUc8A9kA+17u8C+\nAYzfdMbHytdAGIT1XB5KjAcndZ5AnDiQheAzzA2jAx5UnvqoF4G8N/9BnG5tfKed\nmLrd6BBVbqQCDnj/9KvOMZEh0AQmfSiB+xrKTt1BCewgoJT8pT5UtNtn3O2eHiX1\nSBZwJXbFGBlf6kW+cXpFp5/cIdMtkmd8mRZFl/t/vf3QVAnJN5il4tsRfri/mDu2\n/oPsWbav7OY2qV4py+5ZRYfN/mHu5EESn7ukvA6y58kRLOuz50qqOfB0NqUPzGG7\nwKmQ+maq/QSO1FLUDqohcUTtX10Oy+69khWlUMftaSQZ7ZzOoCo5aDq+/LvQndnj\nWMaqw08AgT8YW1qVY3WGg6slERb9FWj+sG8cKqMGI+0EvSDfD4w=\n=yieI\n-----END PGP SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/8826cae285490439dc1f19b25fa70b2b9e62dfe8",
          "sha": "8826cae285490439dc1f19b25fa70b2b9e62dfe8",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/8826cae285490439dc1f19b25fa70b2b9e62dfe8"
        }
      ],
      "message": "kernel: Move default cache constants to caches\n\nThey are not related to the txdb, so a better place for them is the\nnew kernel and node cache file. Re-use the default amount of kernel\ncache for the default node cache.",
      "committer": {
        "name": "TheCharlatan",
        "email": "seb.kung@gmail.com",
        "date": "2025-01-15T14:44:55Z"
      },
      "author": {
        "name": "TheCharlatan",
        "email": "seb.kung@gmail.com",
        "date": "2024-11-22T21:52:02Z"
      },
      "sha": "65cde3621dbb9ac7d210d4926e7601c4adf5f498"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDJhOTI3MDJiYWZjYTVjNzhiMjcwYTk1MDJhMjJjYjlkZWFjMDJjZmM",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/2a92702bafca5c78b270a9502a22cb9deac02cfc",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/2a92702bafca5c78b270a9502a22cb9deac02cfc",
      "tree": {
        "sha": "cf41cd892166b9a08972bf74dbd84ffafa44f6aa",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/cf41cd892166b9a08972bf74dbd84ffafa44f6aa"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree cf41cd892166b9a08972bf74dbd84ffafa44f6aa\nparent 65cde3621dbb9ac7d210d4926e7601c4adf5f498\nauthor TheCharlatan <seb.kung@gmail.com> 1734469127 +0100\ncommitter TheCharlatan <seb.kung@gmail.com> 1736952296 +0100\n\ninit: Use size_t consistently for cache sizes\n\nThis avoids having to rely on implicit casts when passing them to the\nvarious functions allocating the caches.\n\nThis also ensures that if the requested amount of db_cache does not fit\nin a size_t, it is clamped to the maximum value of a size_t.\n\nAlso take this opportunity to make the total amounts of cache in the\nchainstate manager a size_t too.\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCgAdFiEE8s/Eq9C5nYN+67fQm3m0VpHbQXMFAmeHyegACgkQm3m0VpHb\nQXNoHg//cHVGGPOYoYuQtg40P8ML0MLNIloly45uKcwDe8JWTkhQTJoo4sTUfrHb\n4w5ad+DGntgbI655MHtxIFI6NqpM0ne4LFFw7kBQHFhFiWYkoLBr0uTrvEDuAWZK\nb61lLyQMbnP9u7Vq53Awwx1mUd1wGJS3LPas7Wq0LMQJ8JYWQQshAj4F+5sPgam8\nZ60WRHKajMsDp0EftKJlorcuBuYK5fC8AnfwCGj2q5AtXZ/9AsuLIFudXfuPxKcD\n6GRCpAPrIi591fonzc4f17J5cL4yAJZ9vxh8rpd1OKLK3yLi8jjhnWAuOLlRXXBY\ngpSQsmItBfyG95gkSbkay0j3XjR+rAitDWbEoSqV6crGl3/3R8o+j34VU+1FxYff\n/8spboBeEBEF1F/5JzKVz6sDhKH7lfINaLZKX6jk2Uj7FDk0YjyitB53We2pdmlY\naVzQHhP8lzTenZ2MuQ58QOe1Mrt/3T//IYNzHXfAux11VdczdFXiDdxp21Z4w6Ue\nFD6O3CFBOF33eKmZyLxrCPtQK2I3WsmtMKtNn6W97SEKfINnGwAiD8pLjEH1+qvx\nJYMdT72gvweF0zV8udrQFeW2aq0VhS2myVkPDyxBQ8Lo4Tp7C11pnXBdf54a52Cc\nl3540sxJdmlMYfyo7zlUKrqROYwCVd3epHbXgZ49fOOoPRBR2hw=\n=BQbx\n-----END PGP SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/65cde3621dbb9ac7d210d4926e7601c4adf5f498",
          "sha": "65cde3621dbb9ac7d210d4926e7601c4adf5f498",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/65cde3621dbb9ac7d210d4926e7601c4adf5f498"
        }
      ],
      "message": "init: Use size_t consistently for cache sizes\n\nThis avoids having to rely on implicit casts when passing them to the\nvarious functions allocating the caches.\n\nThis also ensures that if the requested amount of db_cache does not fit\nin a size_t, it is clamped to the maximum value of a size_t.\n\nAlso take this opportunity to make the total amounts of cache in the\nchainstate manager a size_t too.",
      "committer": {
        "name": "TheCharlatan",
        "email": "seb.kung@gmail.com",
        "date": "2025-01-15T14:44:56Z"
      },
      "author": {
        "name": "TheCharlatan",
        "email": "seb.kung@gmail.com",
        "date": "2024-12-17T20:58:47Z"
      },
      "sha": "2a92702bafca5c78b270a9502a22cb9deac02cfc"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 15942885862,
      "node_id": "HRFPE_lADOABII586jEBuMzwAAAAO2RSHm",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/15942885862",
      "actor": {
        "login": "TheCharlatan",
        "id": 8421793,
        "node_id": "MDQ6VXNlcjg0MjE3OTM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8421793?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/TheCharlatan",
        "html_url": "https://github.com/TheCharlatan",
        "followers_url": "https://api.github.com/users/TheCharlatan/followers",
        "following_url": "https://api.github.com/users/TheCharlatan/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/TheCharlatan/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/TheCharlatan/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/TheCharlatan/subscriptions",
        "organizations_url": "https://api.github.com/users/TheCharlatan/orgs",
        "repos_url": "https://api.github.com/users/TheCharlatan/repos",
        "events_url": "https://api.github.com/users/TheCharlatan/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/TheCharlatan/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": "2a92702bafca5c78b270a9502a22cb9deac02cfc",
      "commit_url": "https://api.github.com/repos/TheCharlatan/bitcoin/commits/2a92702bafca5c78b270a9502a22cb9deac02cfc",
      "created_at": "2025-01-15T15:32:31Z"
    },
    {
      "event": "commented",
      "id": 2593227168,
      "node_id": "IC_kwDOABII586akYGg",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2593227168",
      "actor": {
        "login": "TheCharlatan",
        "id": 8421793,
        "node_id": "MDQ6VXNlcjg0MjE3OTM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8421793?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/TheCharlatan",
        "html_url": "https://github.com/TheCharlatan",
        "followers_url": "https://api.github.com/users/TheCharlatan/followers",
        "following_url": "https://api.github.com/users/TheCharlatan/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/TheCharlatan/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/TheCharlatan/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/TheCharlatan/subscriptions",
        "organizations_url": "https://api.github.com/users/TheCharlatan/orgs",
        "repos_url": "https://api.github.com/users/TheCharlatan/repos",
        "events_url": "https://api.github.com/users/TheCharlatan/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/TheCharlatan/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-01-15T15:32:45Z",
      "updated_at": "2025-01-15T15:32:45Z",
      "author_association": "CONTRIBUTOR",
      "body": "Updated 430d5feee9b8be3a85e85696c449753783301c2b -> 2a92702bafca5c78b270a9502a22cb9deac02cfc ([kernel_cache_sizes_16](https://github.com/TheCharlatan/bitcoin/tree/kernel_cache_sizes_16) -> [kernel_cache_sizes_17](https://github.com/TheCharlatan/bitcoin/tree/kernel_cache_sizes_17), [compare](https://github.com/TheCharlatan/bitcoin/compare/kernel_cache_sizes_16..kernel_cache_sizes_17))\r\n\r\n* Took @stickies-v's [suggestion](https://github.com/bitcoin/bitcoin/pull/31483#discussion_r1916527403) for simpler range checks in `CheckedLeftShift`.\r\n* Took @stickies-v's [suggestion](https://github.com/bitcoin/bitcoin/pull/31483#discussion_r1916557354) for better error case test of the _MiB literal.\r\n* Addressed @stickies-v's [comment](https://github.com/bitcoin/bitcoin/pull/31483#discussion_r1916686135), reverted index cach sizes back to `size_t`.\r\n * Addressed @ryanofsky's [comment](https://github.com/bitcoin/bitcoin/pull/31483#discussion_r1916730308), fixed typo\r\n * Addressed @ryanofsky's [comment](https://github.com/bitcoin/bitcoin/pull/31483#discussion_r1916739868), added comment to overflow fuzz test describing asserted range checks.\r\n \r\n > Curious what motivated change from digits() back to sizeof(). Both ways seem fine. I guess sizeof() matches c++ documentation more closely\r\n \r\n Yes, that was my motivation for the change back to sizeof().",
      "user": {
        "login": "TheCharlatan",
        "id": 8421793,
        "node_id": "MDQ6VXNlcjg0MjE3OTM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8421793?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/TheCharlatan",
        "html_url": "https://github.com/TheCharlatan",
        "followers_url": "https://api.github.com/users/TheCharlatan/followers",
        "following_url": "https://api.github.com/users/TheCharlatan/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/TheCharlatan/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/TheCharlatan/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/TheCharlatan/subscriptions",
        "organizations_url": "https://api.github.com/users/TheCharlatan/orgs",
        "repos_url": "https://api.github.com/users/TheCharlatan/repos",
        "events_url": "https://api.github.com/users/TheCharlatan/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/TheCharlatan/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31483#issuecomment-2593227168",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/31483"
    },
    {
      "event": "mentioned",
      "id": 15942890177,
      "node_id": "MEE_lADOABII586jEBuMzwAAAAO2RTLB",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/15942890177",
      "actor": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-01-15T15:32:47Z"
    },
    {
      "event": "subscribed",
      "id": 15942890200,
      "node_id": "SE_lADOABII586jEBuMzwAAAAO2RTLY",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/15942890200",
      "actor": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-01-15T15:32:47Z"
    },
    {
      "event": "mentioned",
      "id": 15942890219,
      "node_id": "MEE_lADOABII586jEBuMzwAAAAO2RTLr",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/15942890219",
      "actor": {
        "login": "stickies-v",
        "id": 69010457,
        "node_id": "MDQ6VXNlcjY5MDEwNDU3",
        "avatar_url": "https://avatars.githubusercontent.com/u/69010457?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stickies-v",
        "html_url": "https://github.com/stickies-v",
        "followers_url": "https://api.github.com/users/stickies-v/followers",
        "following_url": "https://api.github.com/users/stickies-v/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stickies-v/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stickies-v/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stickies-v/subscriptions",
        "organizations_url": "https://api.github.com/users/stickies-v/orgs",
        "repos_url": "https://api.github.com/users/stickies-v/repos",
        "events_url": "https://api.github.com/users/stickies-v/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stickies-v/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-01-15T15:32:47Z"
    },
    {
      "event": "subscribed",
      "id": 15942890239,
      "node_id": "SE_lADOABII586jEBuMzwAAAAO2RTL_",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/15942890239",
      "actor": {
        "login": "stickies-v",
        "id": 69010457,
        "node_id": "MDQ6VXNlcjY5MDEwNDU3",
        "avatar_url": "https://avatars.githubusercontent.com/u/69010457?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stickies-v",
        "html_url": "https://github.com/stickies-v",
        "followers_url": "https://api.github.com/users/stickies-v/followers",
        "following_url": "https://api.github.com/users/stickies-v/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stickies-v/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stickies-v/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stickies-v/subscriptions",
        "organizations_url": "https://api.github.com/users/stickies-v/orgs",
        "repos_url": "https://api.github.com/users/stickies-v/repos",
        "events_url": "https://api.github.com/users/stickies-v/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stickies-v/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-01-15T15:32:47Z"
    },
    {
      "event": "commented",
      "id": 2593266357,
      "node_id": "IC_kwDOABII586akhq1",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2593266357",
      "actor": {
        "login": "stickies-v",
        "id": 69010457,
        "node_id": "MDQ6VXNlcjY5MDEwNDU3",
        "avatar_url": "https://avatars.githubusercontent.com/u/69010457?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stickies-v",
        "html_url": "https://github.com/stickies-v",
        "followers_url": "https://api.github.com/users/stickies-v/followers",
        "following_url": "https://api.github.com/users/stickies-v/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stickies-v/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stickies-v/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stickies-v/subscriptions",
        "organizations_url": "https://api.github.com/users/stickies-v/orgs",
        "repos_url": "https://api.github.com/users/stickies-v/repos",
        "events_url": "https://api.github.com/users/stickies-v/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stickies-v/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-01-15T15:42:58Z",
      "updated_at": "2025-01-15T15:42:58Z",
      "author_association": "CONTRIBUTOR",
      "body": "re-ACK 2a92702bafca5c78b270a9502a22cb9deac02cfc\r\n\r\nNo changes except for outstanding review comments to simplify `CheckedLeftShift()`'s implementation wrt range checks, making the `_MiB` test platform-agnostic, making `IndexCacheSizes` members `size_t` and doc/typo improvements.",
      "user": {
        "login": "stickies-v",
        "id": 69010457,
        "node_id": "MDQ6VXNlcjY5MDEwNDU3",
        "avatar_url": "https://avatars.githubusercontent.com/u/69010457?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stickies-v",
        "html_url": "https://github.com/stickies-v",
        "followers_url": "https://api.github.com/users/stickies-v/followers",
        "following_url": "https://api.github.com/users/stickies-v/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stickies-v/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stickies-v/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stickies-v/subscriptions",
        "organizations_url": "https://api.github.com/users/stickies-v/orgs",
        "repos_url": "https://api.github.com/users/stickies-v/repos",
        "events_url": "https://api.github.com/users/stickies-v/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stickies-v/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31483#issuecomment-2593266357",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/31483"
    },
    {
      "event": "review_requested",
      "id": 15943042897,
      "node_id": "RRE_lADOABII586jEBuMzwAAAAO2R4dR",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/15943042897",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-01-15T15:43:05Z",
      "requested_reviewer": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "review_requester": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      }
    }
  ],
  "comments": [
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1881990823",
      "pull_request_review_id": 2499365306,
      "id": 1881990823,
      "node_id": "PRRC_kwDOABII585wLOan",
      "diff_hunk": "@@ -0,0 +1,38 @@\n+// Copyright (c) 2024-present The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#ifndef BITCOIN_KERNEL_CACHES_H\n+#define BITCOIN_KERNEL_CACHES_H\n+\n+#include <algorithm>\n+#include <cstdint>\n+\n+//! min. -dbcache (MiB)\n+static constexpr int64_t MIN_DB_CACHE{4};\n+//! -dbcache default (MiB)\n+static constexpr int64_t DEFAULT_DB_CACHE{450};\n+//! Max memory allocated to block tree DB specific cache",
      "path": "src/kernel/caches.h",
      "position": null,
      "original_position": 15,
      "commit_id": "2a92702bafca5c78b270a9502a22cb9deac02cfc",
      "original_commit_id": "62da6a0b1ef99fc00357e967fe868ca3235cc4fb",
      "in_reply_to_id": null,
      "user": {
        "login": "ajtowns",
        "id": 127186,
        "node_id": "MDQ6VXNlcjEyNzE4Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/127186?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ajtowns",
        "html_url": "https://github.com/ajtowns",
        "followers_url": "https://api.github.com/users/ajtowns/followers",
        "following_url": "https://api.github.com/users/ajtowns/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ajtowns/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ajtowns/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ajtowns/subscriptions",
        "organizations_url": "https://api.github.com/users/ajtowns/orgs",
        "repos_url": "https://api.github.com/users/ajtowns/repos",
        "events_url": "https://api.github.com/users/ajtowns/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ajtowns/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "Missing the `(MiB)` comment.",
      "created_at": "2024-12-12T12:40:39Z",
      "updated_at": "2024-12-12T12:40:40Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31483#discussion_r1881990823",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1881990823"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31483"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 15,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1882016734",
      "pull_request_review_id": 2499436523,
      "id": 1882016734,
      "node_id": "PRRC_kwDOABII585wLUve",
      "diff_hunk": "@@ -0,0 +1,38 @@\n+// Copyright (c) 2024-present The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#ifndef BITCOIN_KERNEL_CACHES_H\n+#define BITCOIN_KERNEL_CACHES_H\n+\n+#include <algorithm>\n+#include <cstdint>\n+\n+//! min. -dbcache (MiB)\n+static constexpr int64_t MIN_DB_CACHE{4};\n+//! -dbcache default (MiB)\n+static constexpr int64_t DEFAULT_DB_CACHE{450};\n+//! Max memory allocated to block tree DB specific cache",
      "path": "src/kernel/caches.h",
      "position": null,
      "original_position": 15,
      "commit_id": "2a92702bafca5c78b270a9502a22cb9deac02cfc",
      "original_commit_id": "62da6a0b1ef99fc00357e967fe868ca3235cc4fb",
      "in_reply_to_id": 1881990823,
      "user": {
        "login": "TheCharlatan",
        "id": 8421793,
        "node_id": "MDQ6VXNlcjg0MjE3OTM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8421793?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/TheCharlatan",
        "html_url": "https://github.com/TheCharlatan",
        "followers_url": "https://api.github.com/users/TheCharlatan/followers",
        "following_url": "https://api.github.com/users/TheCharlatan/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/TheCharlatan/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/TheCharlatan/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/TheCharlatan/subscriptions",
        "organizations_url": "https://api.github.com/users/TheCharlatan/orgs",
        "repos_url": "https://api.github.com/users/TheCharlatan/repos",
        "events_url": "https://api.github.com/users/TheCharlatan/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/TheCharlatan/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "Thanks, fixed.",
      "created_at": "2024-12-12T12:58:37Z",
      "updated_at": "2024-12-12T12:58:37Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31483#discussion_r1882016734",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1882016734"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31483"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 15,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1883535731",
      "pull_request_review_id": 2501686219,
      "id": 1883535731,
      "node_id": "PRRC_kwDOABII585wRHlz",
      "diff_hunk": "@@ -5,20 +5,20 @@\n #ifndef BITCOIN_NODE_CACHES_H\n #define BITCOIN_NODE_CACHES_H\n \n+#include <kernel/caches.h>\n+\n #include <cstddef>\n #include <cstdint>\n+#include <tuple>\n \n class ArgsManager;\n \n namespace node {\n-struct CacheSizes {\n-    int64_t block_tree_db;\n-    int64_t coins_db;\n-    int64_t coins;\n+struct IndexCacheSizes {",
      "path": "src/node/caches.h",
      "position": 18,
      "original_position": 17,
      "commit_id": "2a92702bafca5c78b270a9502a22cb9deac02cfc",
      "original_commit_id": "173477b5efad4723863b38fe51cd1156620d01df",
      "in_reply_to_id": null,
      "user": {
        "login": "stickies-v",
        "id": 69010457,
        "node_id": "MDQ6VXNlcjY5MDEwNDU3",
        "avatar_url": "https://avatars.githubusercontent.com/u/69010457?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stickies-v",
        "html_url": "https://github.com/stickies-v",
        "followers_url": "https://api.github.com/users/stickies-v/followers",
        "following_url": "https://api.github.com/users/stickies-v/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stickies-v/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stickies-v/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stickies-v/subscriptions",
        "organizations_url": "https://api.github.com/users/stickies-v/orgs",
        "repos_url": "https://api.github.com/users/stickies-v/repos",
        "events_url": "https://api.github.com/users/stickies-v/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stickies-v/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "nit: will we have separate structs for different node cache sizes? I think just keeping it `CacheSizes` and adding the `node::` namespace in ambiguous places makes more sense for now?\r\n\r\n<details>\r\n<summary>git diff on 2e6c43f9c3</summary>\r\n\r\n```diff\r\ndiff --git a/src/node/caches.cpp b/src/node/caches.cpp\r\nindex 50e41b8d1e..41bd8c95d0 100644\r\n--- a/src/node/caches.cpp\r\n+++ b/src/node/caches.cpp\r\n@@ -13,11 +13,11 @@\r\n #include <string>\r\n \r\n namespace node {\r\n-std::tuple<IndexCacheSizes, kernel::CacheSizes> CalculateCacheSizes(const ArgsManager& args, size_t n_indexes)\r\n+std::tuple<node::CacheSizes, kernel::CacheSizes> CalculateCacheSizes(const ArgsManager& args, size_t n_indexes)\r\n {\r\n     int64_t nTotalCache = (args.GetIntArg(\"-dbcache\", nDefaultDbCache) << 20);\r\n     nTotalCache = std::max(nTotalCache, nMinDbCache << 20); // total cache cannot be less than nMinDbCache\r\n-    IndexCacheSizes sizes;\r\n+    CacheSizes sizes;\r\n     sizes.tx_index = std::min(nTotalCache / 8, args.GetBoolArg(\"-txindex\", DEFAULT_TXINDEX) ? nMaxTxIndexCache << 20 : 0);\r\n     nTotalCache -= sizes.tx_index;\r\n     sizes.filter_index = 0;\r\ndiff --git a/src/node/caches.h b/src/node/caches.h\r\nindex f4cc14bb23..c47134539b 100644\r\n--- a/src/node/caches.h\r\n+++ b/src/node/caches.h\r\n@@ -14,11 +14,11 @@\r\n class ArgsManager;\r\n \r\n namespace node {\r\n-struct IndexCacheSizes {\r\n+struct CacheSizes {\r\n     int64_t tx_index;\r\n     int64_t filter_index;\r\n };\r\n-std::tuple<IndexCacheSizes, kernel::CacheSizes> CalculateCacheSizes(const ArgsManager& args, size_t n_indexes = 0);\r\n+std::tuple<node::CacheSizes, kernel::CacheSizes> CalculateCacheSizes(const ArgsManager& args, size_t n_indexes = 0);\r\n } // namespace node\r\n \r\n #endif // BITCOIN_NODE_CACHES_H\r\ndiff --git a/src/test/util/setup_common.h b/src/test/util/setup_common.h\r\nindex 46035772f5..fbea90a20b 100644\r\n--- a/src/test/util/setup_common.h\r\n+++ b/src/test/util/setup_common.h\r\n@@ -104,7 +104,7 @@ struct BasicTestingSetup {\r\n  * initialization behaviour.\r\n  */\r\n struct ChainTestingSetup : public BasicTestingSetup {\r\n-    node::IndexCacheSizes m_index_cache_sizes{std::get<0>(node::CalculateCacheSizes(m_args))};\r\n+    node::CacheSizes m_index_cache_sizes{std::get<0>(node::CalculateCacheSizes(m_args))};\r\n     kernel::CacheSizes m_kernel_cache_sizes{std::get<1>(node::CalculateCacheSizes(m_args))};\r\n     bool m_coins_db_in_memory{true};\r\n     bool m_block_tree_db_in_memory{true};\r\n\r\n```\r\n</details>\r\n",
      "created_at": "2024-12-13T08:18:57Z",
      "updated_at": "2024-12-13T15:12:13Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31483#discussion_r1883535731",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1883535731"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31483"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 21,
      "original_line": 21,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1883674740",
      "pull_request_review_id": 2501686219,
      "id": 1883674740,
      "node_id": "PRRC_kwDOABII585wRph0",
      "diff_hunk": "@@ -119,9 +120,10 @@ using common::AmountErrMsg;\n using common::InvalidPortErrMsg;\n using common::ResolveErrMsg;\n \n+using kernel::CacheSizes;",
      "path": "src/init.cpp",
      "position": null,
      "original_position": 12,
      "commit_id": "2a92702bafca5c78b270a9502a22cb9deac02cfc",
      "original_commit_id": "173477b5efad4723863b38fe51cd1156620d01df",
      "in_reply_to_id": null,
      "user": {
        "login": "stickies-v",
        "id": 69010457,
        "node_id": "MDQ6VXNlcjY5MDEwNDU3",
        "avatar_url": "https://avatars.githubusercontent.com/u/69010457?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stickies-v",
        "html_url": "https://github.com/stickies-v",
        "followers_url": "https://api.github.com/users/stickies-v/followers",
        "following_url": "https://api.github.com/users/stickies-v/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stickies-v/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stickies-v/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stickies-v/subscriptions",
        "organizations_url": "https://api.github.com/users/stickies-v/orgs",
        "repos_url": "https://api.github.com/users/stickies-v/repos",
        "events_url": "https://api.github.com/users/stickies-v/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stickies-v/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "nit: since it doesn't meaningfully change the diff, I would much prefer not to use `using` here to immediately disambiguate with `node::CacheSizes` (+ in `chainstate.cpp`)\r\n\r\n<details>\r\n<summary>git diff on 2e6c43f9c3</summary>\r\n\r\n```diff\r\ndiff --git a/src/init.cpp b/src/init.cpp\r\nindex dd273cfe61..f52933b658 100644\r\n--- a/src/init.cpp\r\n+++ b/src/init.cpp\r\n@@ -120,8 +120,6 @@ using common::AmountErrMsg;\r\n using common::InvalidPortErrMsg;\r\n using common::ResolveErrMsg;\r\n \r\n-using kernel::CacheSizes;\r\n-\r\n using node::ApplyArgsManOptions;\r\n using node::BlockManager;\r\n using node::CalculateCacheSizes;\r\n@@ -1179,7 +1177,7 @@ static ChainstateLoadResult InitAndLoadChainstate(\r\n     NodeContext& node,\r\n     bool do_reindex,\r\n     const bool do_reindex_chainstate,\r\n-    CacheSizes& cache_sizes,\r\n+    kernel::CacheSizes& cache_sizes,\r\n     const ArgsManager& args)\r\n {\r\n     const CChainParams& chainparams = Params();\r\ndiff --git a/src/node/chainstate.cpp b/src/node/chainstate.cpp\r\nindex 660d2c3289..d4d8828f73 100644\r\n--- a/src/node/chainstate.cpp\r\n+++ b/src/node/chainstate.cpp\r\n@@ -29,14 +29,12 @@\r\n #include <memory>\r\n #include <vector>\r\n \r\n-using kernel::CacheSizes;\r\n-\r\n namespace node {\r\n // Complete initialization of chainstates after the initial call has been made\r\n // to ChainstateManager::InitializeChainstate().\r\n static ChainstateLoadResult CompleteChainstateInitialization(\r\n     ChainstateManager& chainman,\r\n-    const CacheSizes& cache_sizes,\r\n+    const kernel::CacheSizes& cache_sizes,\r\n     const ChainstateLoadOptions& options) EXCLUSIVE_LOCKS_REQUIRED(::cs_main)\r\n {\r\n     auto& pblocktree{chainman.m_blockman.m_block_tree_db};\r\n@@ -172,7 +170,7 @@ static ChainstateLoadResult CompleteChainstateInitialization(\r\n     return {ChainstateLoadStatus::SUCCESS, {}};\r\n }\r\n \r\n-ChainstateLoadResult LoadChainstate(ChainstateManager& chainman, const CacheSizes& cache_sizes,\r\n+ChainstateLoadResult LoadChainstate(ChainstateManager& chainman, const kernel::CacheSizes& cache_sizes,\r\n                                     const ChainstateLoadOptions& options)\r\n {\r\n     if (!chainman.AssumedValidBlock().IsNull()) {\r\n\r\n```\r\n</details>\r\n\r\nedit: oh, that's less true for the current `node::IndexCacheSizes` name of course. I personally still prefer keeping the namespace for clarity, but it also fits within the `init.cpp` coding style.\r\n",
      "created_at": "2024-12-13T10:01:59Z",
      "updated_at": "2024-12-13T15:12:13Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31483#discussion_r1883674740",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1883674740"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31483"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 123,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1883694847",
      "pull_request_review_id": 2501686219,
      "id": 1883694847,
      "node_id": "PRRC_kwDOABII585wRub_",
      "diff_hunk": "@@ -12,6 +12,7 @@\n \n #include <common/args.h>\n #include <interfaces/node.h>\n+#include <kernel/caches.h>",
      "path": "src/qt/optionsmodel.cpp",
      "position": null,
      "original_position": 4,
      "commit_id": "2a92702bafca5c78b270a9502a22cb9deac02cfc",
      "original_commit_id": "2e6c43f9c3aed577678a537b5456adaa31a2cb04",
      "in_reply_to_id": null,
      "user": {
        "login": "stickies-v",
        "id": 69010457,
        "node_id": "MDQ6VXNlcjY5MDEwNDU3",
        "avatar_url": "https://avatars.githubusercontent.com/u/69010457?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stickies-v",
        "html_url": "https://github.com/stickies-v",
        "followers_url": "https://api.github.com/users/stickies-v/followers",
        "following_url": "https://api.github.com/users/stickies-v/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stickies-v/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stickies-v/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stickies-v/subscriptions",
        "organizations_url": "https://api.github.com/users/stickies-v/orgs",
        "repos_url": "https://api.github.com/users/stickies-v/repos",
        "events_url": "https://api.github.com/users/stickies-v/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stickies-v/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "nit: this is in the wrong commit (2e6c43f9c3aed577678a537b5456adaa31a2cb04)",
      "created_at": "2024-12-13T10:14:51Z",
      "updated_at": "2024-12-13T15:12:13Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31483#discussion_r1883694847",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1883694847"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31483"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 15,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1884061716",
      "pull_request_review_id": 2501686219,
      "id": 1884061716,
      "node_id": "PRRC_kwDOABII585wTIAU",
      "diff_hunk": "@@ -0,0 +1,38 @@\n+// Copyright (c) 2024-present The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#ifndef BITCOIN_KERNEL_CACHES_H\n+#define BITCOIN_KERNEL_CACHES_H\n+\n+#include <algorithm>\n+#include <cstdint>\n+\n+//! min. -dbcache (MiB)\n+static constexpr int64_t MIN_DB_CACHE{4};\n+//! -dbcache default (MiB)\n+static constexpr int64_t DEFAULT_DB_CACHE{450};",
      "path": "src/kernel/caches.h",
      "position": null,
      "original_position": 14,
      "commit_id": "2a92702bafca5c78b270a9502a22cb9deac02cfc",
      "original_commit_id": "173477b5efad4723863b38fe51cd1156620d01df",
      "in_reply_to_id": null,
      "user": {
        "login": "stickies-v",
        "id": 69010457,
        "node_id": "MDQ6VXNlcjY5MDEwNDU3",
        "avatar_url": "https://avatars.githubusercontent.com/u/69010457?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stickies-v",
        "html_url": "https://github.com/stickies-v",
        "followers_url": "https://api.github.com/users/stickies-v/followers",
        "following_url": "https://api.github.com/users/stickies-v/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stickies-v/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stickies-v/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stickies-v/subscriptions",
        "organizations_url": "https://api.github.com/users/stickies-v/orgs",
        "repos_url": "https://api.github.com/users/stickies-v/repos",
        "events_url": "https://api.github.com/users/stickies-v/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stickies-v/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "I'm not sure what the best solution is, but aren't `MIN_DB_CACHE` and `DEFAULT_DB_CACHE` `node` attributes, instead of `kernel`? Then again, we do need a default total cache size in kernel, so maybe the best approach is to just rename to e.g. `MIN_KERNEL_CACHE` and `DEFAULT_KERNEL_CACHE` - or redefine `DEFAULT_DB_CACHE{DEFAULT_KERNEL_CACHE};`?",
      "created_at": "2024-12-13T14:57:45Z",
      "updated_at": "2024-12-13T15:12:13Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31483#discussion_r1884061716",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1884061716"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31483"
        }
      },
      "start_line": null,
      "original_start_line": 12,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 14,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1884078251",
      "pull_request_review_id": 2501686219,
      "id": 1884078251,
      "node_id": "PRRC_kwDOABII585wTMCr",
      "diff_hunk": "@@ -103,7 +104,8 @@ struct BasicTestingSetup {\n  * initialization behaviour.\n  */\n struct ChainTestingSetup : public BasicTestingSetup {\n-    node::CacheSizes m_cache_sizes{};\n+    node::IndexCacheSizes m_index_cache_sizes{std::get<0>(node::CalculateCacheSizes(m_args))};",
      "path": "src/test/util/setup_common.h",
      "position": null,
      "original_position": 13,
      "commit_id": "2a92702bafca5c78b270a9502a22cb9deac02cfc",
      "original_commit_id": "173477b5efad4723863b38fe51cd1156620d01df",
      "in_reply_to_id": null,
      "user": {
        "login": "stickies-v",
        "id": 69010457,
        "node_id": "MDQ6VXNlcjY5MDEwNDU3",
        "avatar_url": "https://avatars.githubusercontent.com/u/69010457?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stickies-v",
        "html_url": "https://github.com/stickies-v",
        "followers_url": "https://api.github.com/users/stickies-v/followers",
        "following_url": "https://api.github.com/users/stickies-v/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stickies-v/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stickies-v/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stickies-v/subscriptions",
        "organizations_url": "https://api.github.com/users/stickies-v/orgs",
        "repos_url": "https://api.github.com/users/stickies-v/repos",
        "events_url": "https://api.github.com/users/stickies-v/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stickies-v/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "This member is not used, best to remove until it is?",
      "created_at": "2024-12-13T15:09:51Z",
      "updated_at": "2024-12-13T15:12:13Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31483#discussion_r1884078251",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1884078251"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31483"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 107,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1884999663",
      "pull_request_review_id": 2503766075,
      "id": 1884999663,
      "node_id": "PRRC_kwDOABII585wWs_v",
      "diff_hunk": "@@ -0,0 +1,38 @@\n+// Copyright (c) 2024-present The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#ifndef BITCOIN_KERNEL_CACHES_H\n+#define BITCOIN_KERNEL_CACHES_H\n+\n+#include <algorithm>\n+#include <cstdint>\n+\n+//! min. -dbcache (MiB)\n+static constexpr int64_t MIN_DB_CACHE{4};\n+//! -dbcache default (MiB)\n+static constexpr int64_t DEFAULT_DB_CACHE{450};",
      "path": "src/kernel/caches.h",
      "position": null,
      "original_position": 14,
      "commit_id": "2a92702bafca5c78b270a9502a22cb9deac02cfc",
      "original_commit_id": "173477b5efad4723863b38fe51cd1156620d01df",
      "in_reply_to_id": 1884061716,
      "user": {
        "login": "TheCharlatan",
        "id": 8421793,
        "node_id": "MDQ6VXNlcjg0MjE3OTM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8421793?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/TheCharlatan",
        "html_url": "https://github.com/TheCharlatan",
        "followers_url": "https://api.github.com/users/TheCharlatan/followers",
        "following_url": "https://api.github.com/users/TheCharlatan/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/TheCharlatan/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/TheCharlatan/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/TheCharlatan/subscriptions",
        "organizations_url": "https://api.github.com/users/TheCharlatan/orgs",
        "repos_url": "https://api.github.com/users/TheCharlatan/repos",
        "events_url": "https://api.github.com/users/TheCharlatan/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/TheCharlatan/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "Mmh, is there a scenario where `DEFAULT_DB_CACHE` and `DEFAULT_KERNEL_CACHE` would ever diverge? The current naming does not seem too confusing to me.",
      "created_at": "2024-12-14T09:43:43Z",
      "updated_at": "2024-12-14T10:10:26Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31483#discussion_r1884999663",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1884999663"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31483"
        }
      },
      "start_line": null,
      "original_start_line": 12,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 14,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1885000798",
      "pull_request_review_id": 2503766075,
      "id": 1885000798,
      "node_id": "PRRC_kwDOABII585wWtRe",
      "diff_hunk": "@@ -5,20 +5,20 @@\n #ifndef BITCOIN_NODE_CACHES_H\n #define BITCOIN_NODE_CACHES_H\n \n+#include <kernel/caches.h>\n+\n #include <cstddef>\n #include <cstdint>\n+#include <tuple>\n \n class ArgsManager;\n \n namespace node {\n-struct CacheSizes {\n-    int64_t block_tree_db;\n-    int64_t coins_db;\n-    int64_t coins;\n+struct IndexCacheSizes {",
      "path": "src/node/caches.h",
      "position": 18,
      "original_position": 17,
      "commit_id": "2a92702bafca5c78b270a9502a22cb9deac02cfc",
      "original_commit_id": "173477b5efad4723863b38fe51cd1156620d01df",
      "in_reply_to_id": 1883535731,
      "user": {
        "login": "TheCharlatan",
        "id": 8421793,
        "node_id": "MDQ6VXNlcjg0MjE3OTM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8421793?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/TheCharlatan",
        "html_url": "https://github.com/TheCharlatan",
        "followers_url": "https://api.github.com/users/TheCharlatan/followers",
        "following_url": "https://api.github.com/users/TheCharlatan/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/TheCharlatan/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/TheCharlatan/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/TheCharlatan/subscriptions",
        "organizations_url": "https://api.github.com/users/TheCharlatan/orgs",
        "repos_url": "https://api.github.com/users/TheCharlatan/repos",
        "events_url": "https://api.github.com/users/TheCharlatan/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/TheCharlatan/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "My expectation would be that if other non-index caches are added later, they would get their own struct too. This also might make it a bit easier in case the indexes ever get their own process?",
      "created_at": "2024-12-14T09:45:26Z",
      "updated_at": "2024-12-14T10:10:26Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31483#discussion_r1885000798",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1885000798"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31483"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 21,
      "original_line": 21,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1887412097",
      "pull_request_review_id": 2507107693,
      "id": 1887412097,
      "node_id": "PRRC_kwDOABII585wf5-B",
      "diff_hunk": "@@ -0,0 +1,38 @@\n+// Copyright (c) 2024-present The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#ifndef BITCOIN_KERNEL_CACHES_H\n+#define BITCOIN_KERNEL_CACHES_H\n+\n+#include <algorithm>\n+#include <cstdint>\n+\n+//! min. -dbcache (MiB)\n+static constexpr int64_t MIN_DB_CACHE{4};\n+//! -dbcache default (MiB)\n+static constexpr int64_t DEFAULT_DB_CACHE{450};",
      "path": "src/kernel/caches.h",
      "position": null,
      "original_position": 14,
      "commit_id": "2a92702bafca5c78b270a9502a22cb9deac02cfc",
      "original_commit_id": "173477b5efad4723863b38fe51cd1156620d01df",
      "in_reply_to_id": 1884061716,
      "user": {
        "login": "stickies-v",
        "id": 69010457,
        "node_id": "MDQ6VXNlcjY5MDEwNDU3",
        "avatar_url": "https://avatars.githubusercontent.com/u/69010457?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stickies-v",
        "html_url": "https://github.com/stickies-v",
        "followers_url": "https://api.github.com/users/stickies-v/followers",
        "following_url": "https://api.github.com/users/stickies-v/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stickies-v/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stickies-v/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stickies-v/subscriptions",
        "organizations_url": "https://api.github.com/users/stickies-v/orgs",
        "repos_url": "https://api.github.com/users/stickies-v/repos",
        "events_url": "https://api.github.com/users/stickies-v/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stickies-v/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "> Mmh, is there a scenario where `DEFAULT_DB_CACHE` and `DEFAULT_KERNEL_CACHE` would ever diverge?\r\n\r\n`node` could decide to increase the default total cache size (e.g. because it enables certain indexes by default), and that shouldn't affect the `kernel` default cache size.\r\n\r\n> The current naming does not seem too confusing to me.\r\n\r\nIt's not necessarily confusing, but `-dbcache` is a node setting, not a kernel setting. So I think `DEFAULT_KERNEL_CACHE` is both more accurate (in `kernel/caches.h`) and - as per the previous paragraph - more futureproof.\r\n\r\nEither way, it's easy to fix in the future. My suggestion feels more logical to me but either is fine, so can be resolved if you disagree.",
      "created_at": "2024-12-16T19:31:42Z",
      "updated_at": "2024-12-16T19:31:42Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31483#discussion_r1887412097",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1887412097"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31483"
        }
      },
      "start_line": null,
      "original_start_line": 12,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 14,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1887420476",
      "pull_request_review_id": 2507116596,
      "id": 1887420476,
      "node_id": "PRRC_kwDOABII585wf8A8",
      "diff_hunk": "@@ -5,20 +5,20 @@\n #ifndef BITCOIN_NODE_CACHES_H\n #define BITCOIN_NODE_CACHES_H\n \n+#include <kernel/caches.h>\n+\n #include <cstddef>\n #include <cstdint>\n+#include <tuple>\n \n class ArgsManager;\n \n namespace node {\n-struct CacheSizes {\n-    int64_t block_tree_db;\n-    int64_t coins_db;\n-    int64_t coins;\n+struct IndexCacheSizes {",
      "path": "src/node/caches.h",
      "position": 18,
      "original_position": 17,
      "commit_id": "2a92702bafca5c78b270a9502a22cb9deac02cfc",
      "original_commit_id": "173477b5efad4723863b38fe51cd1156620d01df",
      "in_reply_to_id": 1883535731,
      "user": {
        "login": "stickies-v",
        "id": 69010457,
        "node_id": "MDQ6VXNlcjY5MDEwNDU3",
        "avatar_url": "https://avatars.githubusercontent.com/u/69010457?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stickies-v",
        "html_url": "https://github.com/stickies-v",
        "followers_url": "https://api.github.com/users/stickies-v/followers",
        "following_url": "https://api.github.com/users/stickies-v/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stickies-v/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stickies-v/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stickies-v/subscriptions",
        "organizations_url": "https://api.github.com/users/stickies-v/orgs",
        "repos_url": "https://api.github.com/users/stickies-v/repos",
        "events_url": "https://api.github.com/users/stickies-v/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stickies-v/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "Works for me, thanks!",
      "created_at": "2024-12-16T19:33:39Z",
      "updated_at": "2024-12-16T19:33:39Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31483#discussion_r1887420476",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1887420476"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31483"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 21,
      "original_line": 21,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1888558172",
      "pull_request_review_id": 2508948359,
      "id": 1888558172,
      "node_id": "PRRC_kwDOABII585wkRxc",
      "diff_hunk": "@@ -6,28 +6,31 @@\n \n #include <common/args.h>\n #include <index/txindex.h>\n-#include <txdb.h>\n+#include <kernel/caches.h>\n+\n+#include <algorithm>\n+#include <string>\n+\n+// Unlike for the UTXO database, for the txindex scenario the leveldb cache make\n+// a meaningful difference: https://github.com/bitcoin/bitcoin/pull/8273#issuecomment-229601991\n+static constexpr int64_t MAX_TX_INDEX_CACHE{1024};\n+//! Max memory allocated to all block filter index caches combined in MiB.\n+static constexpr int64_t MAX_FILTER_INDEX_CACHE{1024};\n \n namespace node {\n-CacheSizes CalculateCacheSizes(const ArgsManager& args, size_t n_indexes)\n+std::tuple<IndexCacheSizes, kernel::CacheSizes> CalculateCacheSizes(const ArgsManager& args, size_t n_indexes)\n {\n-    int64_t nTotalCache = (args.GetIntArg(\"-dbcache\", nDefaultDbCache) << 20);\n-    nTotalCache = std::max(nTotalCache, nMinDbCache << 20); // total cache cannot be less than nMinDbCache\n-    CacheSizes sizes;\n-    sizes.block_tree_db = std::min(nTotalCache / 8, nMaxBlockDBCache << 20);\n-    nTotalCache -= sizes.block_tree_db;\n-    sizes.tx_index = std::min(nTotalCache / 8, args.GetBoolArg(\"-txindex\", DEFAULT_TXINDEX) ? nMaxTxIndexCache << 20 : 0);\n+    int64_t nTotalCache = (args.GetIntArg(\"-dbcache\", DEFAULT_DB_CACHE) << 20);\n+    nTotalCache = std::max(nTotalCache, MIN_DB_CACHE << 20); // total cache cannot be less than nMinDbCache",
      "path": "src/node/caches.cpp",
      "position": null,
      "original_position": 27,
      "commit_id": "2a92702bafca5c78b270a9502a22cb9deac02cfc",
      "original_commit_id": "2c49e0bfd295dc0326d02cd0a80853d7dee885ac",
      "in_reply_to_id": null,
      "user": {
        "login": "stickies-v",
        "id": 69010457,
        "node_id": "MDQ6VXNlcjY5MDEwNDU3",
        "avatar_url": "https://avatars.githubusercontent.com/u/69010457?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stickies-v",
        "html_url": "https://github.com/stickies-v",
        "followers_url": "https://api.github.com/users/stickies-v/followers",
        "following_url": "https://api.github.com/users/stickies-v/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stickies-v/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stickies-v/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stickies-v/subscriptions",
        "organizations_url": "https://api.github.com/users/stickies-v/orgs",
        "repos_url": "https://api.github.com/users/stickies-v/repos",
        "events_url": "https://api.github.com/users/stickies-v/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stickies-v/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "```suggestion\r\n    nTotalCache = std::max(nTotalCache, MIN_DB_CACHE << 20); // total cache cannot be less than MIN_DB_CACHE\r\n```\r\nedit: actually, the comment is pretty redundant, might as well just remove it too.",
      "created_at": "2024-12-17T13:53:00Z",
      "updated_at": "2024-12-17T14:51:05Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31483#discussion_r1888558172",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1888558172"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31483"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 24,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1888724781",
      "pull_request_review_id": 2509230463,
      "id": 1888724781,
      "node_id": "PRRC_kwDOABII585wk6ct",
      "diff_hunk": "@@ -6,28 +6,31 @@\n \n #include <common/args.h>\n #include <index/txindex.h>\n-#include <txdb.h>\n+#include <kernel/caches.h>\n+\n+#include <algorithm>\n+#include <string>\n+\n+// Unlike for the UTXO database, for the txindex scenario the leveldb cache make\n+// a meaningful difference: https://github.com/bitcoin/bitcoin/pull/8273#issuecomment-229601991\n+static constexpr int64_t MAX_TX_INDEX_CACHE{1024};\n+//! Max memory allocated to all block filter index caches combined in MiB.\n+static constexpr int64_t MAX_FILTER_INDEX_CACHE{1024};\n \n namespace node {\n-CacheSizes CalculateCacheSizes(const ArgsManager& args, size_t n_indexes)\n+std::tuple<IndexCacheSizes, kernel::CacheSizes> CalculateCacheSizes(const ArgsManager& args, size_t n_indexes)\n {\n-    int64_t nTotalCache = (args.GetIntArg(\"-dbcache\", nDefaultDbCache) << 20);\n-    nTotalCache = std::max(nTotalCache, nMinDbCache << 20); // total cache cannot be less than nMinDbCache\n-    CacheSizes sizes;\n-    sizes.block_tree_db = std::min(nTotalCache / 8, nMaxBlockDBCache << 20);\n-    nTotalCache -= sizes.block_tree_db;\n-    sizes.tx_index = std::min(nTotalCache / 8, args.GetBoolArg(\"-txindex\", DEFAULT_TXINDEX) ? nMaxTxIndexCache << 20 : 0);\n+    int64_t nTotalCache = (args.GetIntArg(\"-dbcache\", DEFAULT_DB_CACHE) << 20);\n+    nTotalCache = std::max(nTotalCache, MIN_DB_CACHE << 20); // total cache cannot be less than nMinDbCache",
      "path": "src/node/caches.cpp",
      "position": null,
      "original_position": 27,
      "commit_id": "2a92702bafca5c78b270a9502a22cb9deac02cfc",
      "original_commit_id": "2c49e0bfd295dc0326d02cd0a80853d7dee885ac",
      "in_reply_to_id": 1888558172,
      "user": {
        "login": "TheCharlatan",
        "id": 8421793,
        "node_id": "MDQ6VXNlcjg0MjE3OTM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8421793?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/TheCharlatan",
        "html_url": "https://github.com/TheCharlatan",
        "followers_url": "https://api.github.com/users/TheCharlatan/followers",
        "following_url": "https://api.github.com/users/TheCharlatan/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/TheCharlatan/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/TheCharlatan/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/TheCharlatan/subscriptions",
        "organizations_url": "https://api.github.com/users/TheCharlatan/orgs",
        "repos_url": "https://api.github.com/users/TheCharlatan/repos",
        "events_url": "https://api.github.com/users/TheCharlatan/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/TheCharlatan/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "thanks for the suggestion, I removed it.",
      "created_at": "2024-12-17T15:37:32Z",
      "updated_at": "2024-12-17T15:37:32Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31483#discussion_r1888724781",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1888724781"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31483"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 24,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1888992732",
      "pull_request_review_id": 2509692136,
      "id": 1888992732,
      "node_id": "PRRC_kwDOABII585wl73c",
      "diff_hunk": "@@ -18,10 +23,10 @@ struct CacheSizes {\n \n     CacheSizes(int64_t total_cache)\n     {\n-        block_tree_db = std::min(total_cache / 8, nMaxBlockDBCache << 20);\n+        block_tree_db = std::min(total_cache / 8, MAX_BLOCK_DB_CACHE << 20);\n         total_cache -= block_tree_db;\n         // use 25%-50% of the remainder for disk cache, capped by the maximum.\n-        coins_db = std::min({total_cache / 2, (total_cache / 4) + (1 << 23), nMaxCoinsDBCache << 20});\n+        coins_db = std::min({total_cache / 2, (total_cache / 4) + (1 << 23), MAX_COINS_DB_CACHE << 20});",
      "path": "src/kernel/caches.h",
      "position": null,
      "original_position": 28,
      "commit_id": "2a92702bafca5c78b270a9502a22cb9deac02cfc",
      "original_commit_id": "8e929e343e14b0228f6f4841ecf2d85a73afda3b",
      "in_reply_to_id": null,
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "re: In commit \"kernel: Move kernel-related cache constants to kernel cache\" (8e929e343e14b0228f6f4841ecf2d85a73afda3b)\r\n\r\nPrecedes this PR, but this code does not seem to make any sense. (1 << 23) is 8MiB which is the same as MAX_COINS_DB_CACHE. So this is effectively min(total / 2, total / 4 + 8MiB, 8Mib) with the middle argument not doing anything. Could be simplified to `std::min(total_cache / 2, MAX_COINS_DB_CACHE << 20)` with no change in behavior AFAICT.",
      "created_at": "2024-12-17T18:09:17Z",
      "updated_at": "2024-12-17T18:24:26Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31483#discussion_r1888992732",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1888992732"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31483"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 29,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1889179809",
      "pull_request_review_id": 2510045835,
      "id": 1889179809,
      "node_id": "PRRC_kwDOABII585wmpih",
      "diff_hunk": "@@ -18,10 +23,10 @@ struct CacheSizes {\n \n     CacheSizes(int64_t total_cache)\n     {\n-        block_tree_db = std::min(total_cache / 8, nMaxBlockDBCache << 20);\n+        block_tree_db = std::min(total_cache / 8, MAX_BLOCK_DB_CACHE << 20);\n         total_cache -= block_tree_db;\n         // use 25%-50% of the remainder for disk cache, capped by the maximum.\n-        coins_db = std::min({total_cache / 2, (total_cache / 4) + (1 << 23), nMaxCoinsDBCache << 20});\n+        coins_db = std::min({total_cache / 2, (total_cache / 4) + (1 << 23), MAX_COINS_DB_CACHE << 20});",
      "path": "src/kernel/caches.h",
      "position": null,
      "original_position": 28,
      "commit_id": "2a92702bafca5c78b270a9502a22cb9deac02cfc",
      "original_commit_id": "8e929e343e14b0228f6f4841ecf2d85a73afda3b",
      "in_reply_to_id": 1888992732,
      "user": {
        "login": "TheCharlatan",
        "id": 8421793,
        "node_id": "MDQ6VXNlcjg0MjE3OTM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8421793?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/TheCharlatan",
        "html_url": "https://github.com/TheCharlatan",
        "followers_url": "https://api.github.com/users/TheCharlatan/followers",
        "following_url": "https://api.github.com/users/TheCharlatan/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/TheCharlatan/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/TheCharlatan/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/TheCharlatan/subscriptions",
        "organizations_url": "https://api.github.com/users/TheCharlatan/orgs",
        "repos_url": "https://api.github.com/users/TheCharlatan/repos",
        "events_url": "https://api.github.com/users/TheCharlatan/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/TheCharlatan/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "Heh, I guess I should have actually done the math here. Will remove.",
      "created_at": "2024-12-17T20:31:57Z",
      "updated_at": "2024-12-17T20:31:57Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31483#discussion_r1889179809",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1889179809"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31483"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 29,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1890138649",
      "pull_request_review_id": 2511656329,
      "id": 1890138649,
      "node_id": "PRRC_kwDOABII585wqToZ",
      "diff_hunk": "@@ -0,0 +1,35 @@\n+// Copyright (c) 2024-present The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#ifndef BITCOIN_KERNEL_CACHES_H\n+#define BITCOIN_KERNEL_CACHES_H\n+\n+#include <algorithm>\n+#include <cstdint>\n+\n+//! Suggested default amount of cache reserved for the kernel (MiB)\n+static constexpr int64_t DEFAULT_KERNEL_CACHE{450};\n+//! Max memory allocated to block tree DB specific cache (MiB)\n+static constexpr int64_t MAX_BLOCK_DB_CACHE{2};\n+//! Max memory allocated to coin DB specific cache (MiB)\n+static constexpr int64_t MAX_COINS_DB_CACHE{8};\n+\n+namespace kernel {\n+struct CacheSizes {\n+    size_t block_tree_db;\n+    size_t coins_db;\n+    size_t coins;\n+\n+    CacheSizes(int64_t total_cache)\n+    {\n+        block_tree_db = std::min(total_cache / 8, MAX_BLOCK_DB_CACHE << 20);",
      "path": "src/kernel/caches.h",
      "position": null,
      "original_position": 26,
      "commit_id": "2a92702bafca5c78b270a9502a22cb9deac02cfc",
      "original_commit_id": "7517126d9fd2c3e50dc95ce831bac6895b950e24",
      "in_reply_to_id": null,
      "user": {
        "login": "stickies-v",
        "id": 69010457,
        "node_id": "MDQ6VXNlcjY5MDEwNDU3",
        "avatar_url": "https://avatars.githubusercontent.com/u/69010457?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stickies-v",
        "html_url": "https://github.com/stickies-v",
        "followers_url": "https://api.github.com/users/stickies-v/followers",
        "following_url": "https://api.github.com/users/stickies-v/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stickies-v/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stickies-v/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stickies-v/subscriptions",
        "organizations_url": "https://api.github.com/users/stickies-v/orgs",
        "repos_url": "https://api.github.com/users/stickies-v/repos",
        "events_url": "https://api.github.com/users/stickies-v/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stickies-v/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "Would be prudent to ensure no negative values here\r\n```suggestion\r\n        assert(total_cache >= 0);\r\n        block_tree_db = std::min(total_cache / 8, MAX_BLOCK_DB_CACHE << 20);\r\n```",
      "created_at": "2024-12-18T12:12:45Z",
      "updated_at": "2024-12-18T12:24:28Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31483#discussion_r1890138649",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1890138649"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31483"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 26,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1890151750",
      "pull_request_review_id": 2511656329,
      "id": 1890151750,
      "node_id": "PRRC_kwDOABII585wqW1G",
      "diff_hunk": "@@ -0,0 +1,35 @@\n+// Copyright (c) 2024-present The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#ifndef BITCOIN_KERNEL_CACHES_H\n+#define BITCOIN_KERNEL_CACHES_H\n+\n+#include <algorithm>\n+#include <cstdint>\n+\n+//! Suggested default amount of cache reserved for the kernel (MiB)\n+static constexpr int64_t DEFAULT_KERNEL_CACHE{450};\n+//! Max memory allocated to block tree DB specific cache (MiB)\n+static constexpr int64_t MAX_BLOCK_DB_CACHE{2};\n+//! Max memory allocated to coin DB specific cache (MiB)\n+static constexpr int64_t MAX_COINS_DB_CACHE{8};\n+\n+namespace kernel {\n+struct CacheSizes {\n+    size_t block_tree_db;\n+    size_t coins_db;\n+    size_t coins;",
      "path": "src/kernel/caches.h",
      "position": 23,
      "original_position": 22,
      "commit_id": "2a92702bafca5c78b270a9502a22cb9deac02cfc",
      "original_commit_id": "7517126d9fd2c3e50dc95ce831bac6895b950e24",
      "in_reply_to_id": null,
      "user": {
        "login": "stickies-v",
        "id": 69010457,
        "node_id": "MDQ6VXNlcjY5MDEwNDU3",
        "avatar_url": "https://avatars.githubusercontent.com/u/69010457?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stickies-v",
        "html_url": "https://github.com/stickies-v",
        "followers_url": "https://api.github.com/users/stickies-v/followers",
        "following_url": "https://api.github.com/users/stickies-v/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stickies-v/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stickies-v/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stickies-v/subscriptions",
        "organizations_url": "https://api.github.com/users/stickies-v/orgs",
        "repos_url": "https://api.github.com/users/stickies-v/repos",
        "events_url": "https://api.github.com/users/stickies-v/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stickies-v/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "I think I'm ~0 on this change. I follow @ryanofsky's [reasoning](https://github.com/bitcoin/bitcoin/pull/31483#pullrequestreview-2509692136), but it also goes against the work done e.g. in https://github.com/bitcoin/bitcoin/pull/23962. If `kernel::CacheSizes` becomes part of the public kernel interface, then keeping these members an `int64_t` might be more prudent, as per e.g. the link in [this comment](https://github.com/bitcoin/bitcoin/pull/23962#issuecomment-1005494716)? But of course, `size_t` is a pretty natural fit for a size type.",
      "created_at": "2024-12-18T12:23:39Z",
      "updated_at": "2024-12-18T12:24:28Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31483#discussion_r1890151750",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1890151750"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31483"
        }
      },
      "start_line": 21,
      "original_start_line": 20,
      "start_side": "RIGHT",
      "line": 23,
      "original_line": 23,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1890537379",
      "pull_request_review_id": 2512351049,
      "id": 1890537379,
      "node_id": "PRRC_kwDOABII585wr0-j",
      "diff_hunk": "@@ -24,8 +24,7 @@ CacheSizes CalculateCacheSizes(const ArgsManager& args, size_t n_indexes)\n         sizes.filter_index = max_cache / n_indexes;\n         nTotalCache -= sizes.filter_index * n_indexes;\n     }\n-    sizes.coins_db = std::min(nTotalCache / 2, (nTotalCache / 4) + (1 << 23)); // use 25%-50% of the remainder for disk cache\n-    sizes.coins_db = std::min(sizes.coins_db, nMaxCoinsDBCache << 20); // cap total coins db cache",
      "path": "src/node/caches.cpp",
      "position": 50,
      "original_position": 5,
      "commit_id": "2a92702bafca5c78b270a9502a22cb9deac02cfc",
      "original_commit_id": "c71fc6ac6e62e5eea96e8aa4e0f43260afc81723",
      "in_reply_to_id": null,
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "In commit \"init: Simplify coinsdb cache calculation\" (c71fc6ac6e62e5eea96e8aa4e0f43260afc81723)\r\n\r\nFor background on why previous code was written this way, apparently the first line `coins_db = min(total / 2, total / 4 + 8MiB)` made sense when it was added in b3ed4236beb7f68e1720ceb3da15e0c3682ef629 from #6102. But when the second line `coins_db = min(coins_db, 8MiB)` was added later in 32cab91278651d07a11132b7636dc3d21144e616 from [#8273](https://github.com/bitcoin/bitcoin/pull/8273), the `total / 4` term in the first line became redundant.\r\n\r\nIt seems like the second change was probably intentional (even though the implementation is confusing) because the commit message says \"This avoids that the extra cache memory goes to the much less effective\r\nleveldb cache instead of our application-level cache.\"",
      "created_at": "2024-12-18T16:40:00Z",
      "updated_at": "2024-12-18T17:09:18Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31483#discussion_r1890537379",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1890537379"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31483"
        }
      },
      "start_line": 27,
      "original_start_line": 27,
      "start_side": "LEFT",
      "line": 28,
      "original_line": 28,
      "side": "LEFT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1890571436",
      "pull_request_review_id": 2512351049,
      "id": 1890571436,
      "node_id": "PRRC_kwDOABII585wr9Ss",
      "diff_hunk": "@@ -0,0 +1,35 @@\n+// Copyright (c) 2024-present The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#ifndef BITCOIN_KERNEL_CACHES_H\n+#define BITCOIN_KERNEL_CACHES_H\n+\n+#include <algorithm>\n+#include <cstdint>\n+\n+//! Suggested default amount of cache reserved for the kernel (MiB)\n+static constexpr int64_t DEFAULT_KERNEL_CACHE{450};\n+//! Max memory allocated to block tree DB specific cache (MiB)\n+static constexpr int64_t MAX_BLOCK_DB_CACHE{2};\n+//! Max memory allocated to coin DB specific cache (MiB)\n+static constexpr int64_t MAX_COINS_DB_CACHE{8};\n+\n+namespace kernel {\n+struct CacheSizes {\n+    size_t block_tree_db;\n+    size_t coins_db;\n+    size_t coins;",
      "path": "src/kernel/caches.h",
      "position": 23,
      "original_position": 22,
      "commit_id": "2a92702bafca5c78b270a9502a22cb9deac02cfc",
      "original_commit_id": "7517126d9fd2c3e50dc95ce831bac6895b950e24",
      "in_reply_to_id": 1890151750,
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "re: https://github.com/bitcoin/bitcoin/pull/31483#discussion_r1890151750\r\n\r\nI agree with changes in the issues you linked to, but I don't think the reasoning in those cases carries over to this one. int32_t is a good choice for transaction sizes and weights, because we know the sizes of transactions are bounded and can't get very big, so it makes sense to use a small type, and we want the bounds to be platform independent so it makes to use fixed width types, and because they are numbers we do arithmetic with, and signed types tend to be safer than unsigned types for arithmetic.\r\n\r\nI think size_t is a better choice for the cache size variables in this PR, because these values are eventually used to allocate memory so making them size_t from the beginning is clearer and avoids the need for casts and conversions later on. Also size_t is the standard type to use for this purpose so it's more idiomatic c++. Also maximum cache sizes do depend on the platform, so size_t a safe choice because it is guaranteed to be able to represent the maximum size of any allocated object on a platform. I do think a downside of choosing size_t is that it is unsigned and unsigned types have less intuitive overflow behavior, but if the values are just going to get casted to size_t later anyway, potentially bad overflow behavior is there no matter what.",
      "created_at": "2024-12-18T17:03:58Z",
      "updated_at": "2024-12-18T17:10:30Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31483#discussion_r1890571436",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1890571436"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31483"
        }
      },
      "start_line": 21,
      "original_start_line": 20,
      "start_side": "RIGHT",
      "line": 23,
      "original_line": 23,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1890652637",
      "pull_request_review_id": 2512542163,
      "id": 1890652637,
      "node_id": "PRRC_kwDOABII585wsRHd",
      "diff_hunk": "@@ -0,0 +1,35 @@\n+// Copyright (c) 2024-present The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#ifndef BITCOIN_KERNEL_CACHES_H\n+#define BITCOIN_KERNEL_CACHES_H\n+\n+#include <algorithm>\n+#include <cstdint>\n+\n+//! Suggested default amount of cache reserved for the kernel (MiB)\n+static constexpr int64_t DEFAULT_KERNEL_CACHE{450};\n+//! Max memory allocated to block tree DB specific cache (MiB)\n+static constexpr int64_t MAX_BLOCK_DB_CACHE{2};\n+//! Max memory allocated to coin DB specific cache (MiB)\n+static constexpr int64_t MAX_COINS_DB_CACHE{8};\n+\n+namespace kernel {\n+struct CacheSizes {\n+    size_t block_tree_db;\n+    size_t coins_db;\n+    size_t coins;",
      "path": "src/kernel/caches.h",
      "position": 23,
      "original_position": 22,
      "commit_id": "2a92702bafca5c78b270a9502a22cb9deac02cfc",
      "original_commit_id": "7517126d9fd2c3e50dc95ce831bac6895b950e24",
      "in_reply_to_id": 1890151750,
      "user": {
        "login": "stickies-v",
        "id": 69010457,
        "node_id": "MDQ6VXNlcjY5MDEwNDU3",
        "avatar_url": "https://avatars.githubusercontent.com/u/69010457?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stickies-v",
        "html_url": "https://github.com/stickies-v",
        "followers_url": "https://api.github.com/users/stickies-v/followers",
        "following_url": "https://api.github.com/users/stickies-v/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stickies-v/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stickies-v/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stickies-v/subscriptions",
        "organizations_url": "https://api.github.com/users/stickies-v/orgs",
        "repos_url": "https://api.github.com/users/stickies-v/repos",
        "events_url": "https://api.github.com/users/stickies-v/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stickies-v/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "Yeah, thinking about it more I agree with all of your points. I was a bit alarmed by all the comparison operations we were doing with these (now) `size_t` types, but they almost all happen inside the constructor. Once the sizes are determined, they don't seem likely to be used for arithmetic operations or comparisons, just for allocating memory.\r\n\r\nI think the benefits you outline outweigh the potential downsides, so I'm happy with the new approach.",
      "created_at": "2024-12-18T18:14:16Z",
      "updated_at": "2024-12-18T18:14:17Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31483#discussion_r1890652637",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1890652637"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31483"
        }
      },
      "start_line": 21,
      "original_start_line": 20,
      "start_side": "RIGHT",
      "line": 23,
      "original_line": 23,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1894591427",
      "pull_request_review_id": 2518616838,
      "id": 1894591427,
      "node_id": "PRRC_kwDOABII585w7SvD",
      "diff_hunk": "@@ -5,20 +5,25 @@\n #ifndef BITCOIN_NODE_CACHES_H\n #define BITCOIN_NODE_CACHES_H\n \n+#include <kernel/caches.h>\n+\n #include <cstddef>\n #include <cstdint>\n+#include <tuple>\n \n class ArgsManager;\n \n+//! min. -dbcache (MiB)\n+static constexpr int64_t MIN_DB_CACHE{4};\n+//! -dbcache default (MiB)\n+static constexpr int64_t DEFAULT_DB_CACHE{DEFAULT_KERNEL_CACHE};\n+\n namespace node {\n-struct CacheSizes {\n-    int64_t block_tree_db;\n-    int64_t coins_db;\n-    int64_t coins;\n-    int64_t tx_index;\n-    int64_t filter_index;\n+struct IndexCacheSizes {\n+    size_t tx_index;\n+    size_t filter_index;\n };\n-CacheSizes CalculateCacheSizes(const ArgsManager& args, size_t n_indexes = 0);\n+std::tuple<IndexCacheSizes, kernel::CacheSizes> CalculateCacheSizes(const ArgsManager& args, size_t n_indexes = 0);",
      "path": "src/node/caches.h",
      "position": null,
      "original_position": 29,
      "commit_id": "2a92702bafca5c78b270a9502a22cb9deac02cfc",
      "original_commit_id": "7517126d9fd2c3e50dc95ce831bac6895b950e24",
      "in_reply_to_id": null,
      "user": {
        "login": "hodlinator",
        "id": 172445034,
        "node_id": "U_kgDOCkdNag",
        "avatar_url": "https://avatars.githubusercontent.com/u/172445034?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/hodlinator",
        "html_url": "https://github.com/hodlinator",
        "followers_url": "https://api.github.com/users/hodlinator/followers",
        "following_url": "https://api.github.com/users/hodlinator/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/hodlinator/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/hodlinator/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/hodlinator/subscriptions",
        "organizations_url": "https://api.github.com/users/hodlinator/orgs",
        "repos_url": "https://api.github.com/users/hodlinator/repos",
        "events_url": "https://api.github.com/users/hodlinator/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/hodlinator/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "nit: Me and the compilers would prefer a contrived name over `std::tuple<...>`. It still allows for the structured bindings in *init.cpp*.\r\n\r\n\r\n```suggestion\r\nstruct IndexAndKernelCacheSizes {\r\n    IndexCacheSizes index;\r\n    kernel::CacheSizes kernel;\r\n};\r\nIndexAndKernelCacheSizes CalculateCacheSizes(const ArgsManager& args, size_t n_indexes = 0);\r\n```\r\n\r\n<details>\r\n<summary>Full diff</summary>\r\n\r\n```diff\r\ndiff --git a/src/node/caches.cpp b/src/node/caches.cpp\r\nindex bd0c93d76f..c7197b6ef1 100644\r\n--- a/src/node/caches.cpp\r\n+++ b/src/node/caches.cpp\r\n@@ -18,7 +18,7 @@ static constexpr int64_t MAX_TX_INDEX_CACHE{1024};\r\n static constexpr int64_t MAX_FILTER_INDEX_CACHE{1024};\r\n \r\n namespace node {\r\n-std::tuple<IndexCacheSizes, kernel::CacheSizes> CalculateCacheSizes(const ArgsManager& args, size_t n_indexes)\r\n+IndexAndKernelCacheSizes CalculateCacheSizes(const ArgsManager& args, size_t n_indexes)\r\n {\r\n     int64_t nTotalCache = (args.GetIntArg(\"-dbcache\", DEFAULT_DB_CACHE) << 20);\r\n     nTotalCache = std::max(nTotalCache, MIN_DB_CACHE << 20);\r\ndiff --git a/src/node/caches.h b/src/node/caches.h\r\nindex 02b91cee87..afa0946d8b 100644\r\n--- a/src/node/caches.h\r\n+++ b/src/node/caches.h\r\n@@ -9,7 +9,6 @@\r\n \r\n #include <cstddef>\r\n #include <cstdint>\r\n-#include <tuple>\r\n \r\n class ArgsManager;\r\n \r\n@@ -23,7 +22,11 @@ struct IndexCacheSizes {\r\n     size_t tx_index;\r\n     size_t filter_index;\r\n };\r\n-std::tuple<IndexCacheSizes, kernel::CacheSizes> CalculateCacheSizes(const ArgsManager& args, size_t n_indexes = 0);\r\n+struct IndexAndKernelCacheSizes {\r\n+    IndexCacheSizes index;\r\n+    kernel::CacheSizes kernel;\r\n+};\r\n+IndexAndKernelCacheSizes CalculateCacheSizes(const ArgsManager& args, size_t n_indexes = 0);\r\n } // namespace node\r\n \r\n #endif // BITCOIN_NODE_CACHES_H\r\ndiff --git a/src/test/util/setup_common.h b/src/test/util/setup_common.h\r\nindex ca9e2111a4..33ad258457 100644\r\n--- a/src/test/util/setup_common.h\r\n+++ b/src/test/util/setup_common.h\r\n@@ -104,7 +104,7 @@ struct BasicTestingSetup {\r\n  * initialization behaviour.\r\n  */\r\n struct ChainTestingSetup : public BasicTestingSetup {\r\n-    kernel::CacheSizes m_kernel_cache_sizes{std::get<1>(node::CalculateCacheSizes(m_args))};\r\n+    kernel::CacheSizes m_kernel_cache_sizes{node::CalculateCacheSizes(m_args).kernel};\r\n     bool m_coins_db_in_memory{true};\r\n     bool m_block_tree_db_in_memory{true};\r\n     std::function<void()> m_make_chainman{};\r\n```\r\n</details>\r\n\r\nThe compilation speed difference is probably not measurable, more a case of death by a thousand eventual cuts.",
      "created_at": "2024-12-21T09:27:55Z",
      "updated_at": "2024-12-21T22:25:25Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31483#discussion_r1894591427",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1894591427"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31483"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 26,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1894593777",
      "pull_request_review_id": 2518616838,
      "id": 1894593777,
      "node_id": "PRRC_kwDOABII585w7TTx",
      "diff_hunk": "@@ -21,22 +21,8 @@\n class COutPoint;\n class uint256;\n \n-//! -dbcache default (MiB)\n-static const int64_t nDefaultDbCache = 450;\n //! -dbbatchsize default (bytes)\n static const int64_t nDefaultDbBatchSize = 16 << 20;\n-//! min. -dbcache (MiB)\n-static const int64_t nMinDbCache = 4;\n-//! Max memory allocated to block tree DB specific cache, if no -txindex (MiB)\n-static const int64_t nMaxBlockDBCache = 2;\n-//! Max memory allocated to block tree DB specific cache, if -txindex (MiB)",
      "path": "src/txdb.h",
      "position": 12,
      "original_position": 12,
      "commit_id": "2a92702bafca5c78b270a9502a22cb9deac02cfc",
      "original_commit_id": "7517126d9fd2c3e50dc95ce831bac6895b950e24",
      "in_reply_to_id": null,
      "user": {
        "login": "hodlinator",
        "id": 172445034,
        "node_id": "U_kgDOCkdNag",
        "avatar_url": "https://avatars.githubusercontent.com/u/172445034?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/hodlinator",
        "html_url": "https://github.com/hodlinator",
        "followers_url": "https://api.github.com/users/hodlinator/followers",
        "following_url": "https://api.github.com/users/hodlinator/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/hodlinator/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/hodlinator/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/hodlinator/subscriptions",
        "organizations_url": "https://api.github.com/users/hodlinator/orgs",
        "repos_url": "https://api.github.com/users/hodlinator/repos",
        "events_url": "https://api.github.com/users/hodlinator/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/hodlinator/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "nit: The message of commit 69159326810822c804ab53a009ef57fb5f28fac9 belonging to this PR states:\r\n> It always applied in the same way, no matter how the txindex is setup.\r\n\r\nThere is some nuance here, the comment was correct in 32cab91278651d07a11132b7636dc3d21144e616 (laanwj 2016 #8273), but was no longer valid after 8181db88f6e0ed96654951e18b1558cd8f78765b (jimpo 2017 #13033). Could add nuance to the commit message.",
      "created_at": "2024-12-21T09:48:28Z",
      "updated_at": "2024-12-21T22:25:25Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31483#discussion_r1894593777",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1894593777"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31483"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 32,
      "original_line": 32,
      "side": "LEFT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1894596535",
      "pull_request_review_id": 2518616838,
      "id": 1894596535,
      "node_id": "PRRC_kwDOABII585w7T-3",
      "diff_hunk": "@@ -24,8 +24,7 @@ CacheSizes CalculateCacheSizes(const ArgsManager& args, size_t n_indexes)\n         sizes.filter_index = max_cache / n_indexes;\n         nTotalCache -= sizes.filter_index * n_indexes;\n     }\n-    sizes.coins_db = std::min(nTotalCache / 2, (nTotalCache / 4) + (1 << 23)); // use 25%-50% of the remainder for disk cache\n-    sizes.coins_db = std::min(sizes.coins_db, nMaxCoinsDBCache << 20); // cap total coins db cache",
      "path": "src/node/caches.cpp",
      "position": 50,
      "original_position": 5,
      "commit_id": "2a92702bafca5c78b270a9502a22cb9deac02cfc",
      "original_commit_id": "c71fc6ac6e62e5eea96e8aa4e0f43260afc81723",
      "in_reply_to_id": 1890537379,
      "user": {
        "login": "hodlinator",
        "id": 172445034,
        "node_id": "U_kgDOCkdNag",
        "avatar_url": "https://avatars.githubusercontent.com/u/172445034?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/hodlinator",
        "html_url": "https://github.com/hodlinator",
        "followers_url": "https://api.github.com/users/hodlinator/followers",
        "following_url": "https://api.github.com/users/hodlinator/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/hodlinator/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/hodlinator/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/hodlinator/subscriptions",
        "organizations_url": "https://api.github.com/users/hodlinator/orgs",
        "repos_url": "https://api.github.com/users/hodlinator/repos",
        "events_url": "https://api.github.com/users/hodlinator/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/hodlinator/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "re: https://github.com/bitcoin/bitcoin/pull/31483#discussion_r1890537379\r\n\r\nAgree with the simplification mostly. Only way the old calculation was useful was if someone was to tweak `nMaxCoinsDBCache` to be lower than `(1 << 23)`/8MiB, which is very unlikely.",
      "created_at": "2024-12-21T10:10:55Z",
      "updated_at": "2024-12-21T22:25:25Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31483#discussion_r1894596535",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1894596535"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31483"
        }
      },
      "start_line": 27,
      "original_start_line": 27,
      "start_side": "LEFT",
      "line": 28,
      "original_line": 28,
      "side": "LEFT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1894597050",
      "pull_request_review_id": 2518616838,
      "id": 1894597050,
      "node_id": "PRRC_kwDOABII585w7UG6",
      "diff_hunk": "@@ -6,28 +6,31 @@\n \n #include <common/args.h>\n #include <index/txindex.h>\n-#include <txdb.h>\n+#include <kernel/caches.h>\n+\n+#include <algorithm>\n+#include <string>\n+\n+// Unlike for the UTXO database, for the txindex scenario the leveldb cache make\n+// a meaningful difference: https://github.com/bitcoin/bitcoin/pull/8273#issuecomment-229601991\n+static constexpr int64_t MAX_TX_INDEX_CACHE{1024};\n+//! Max memory allocated to all block filter index caches combined in MiB.\n+static constexpr int64_t MAX_FILTER_INDEX_CACHE{1024};\n \n namespace node {\n-CacheSizes CalculateCacheSizes(const ArgsManager& args, size_t n_indexes)\n+std::tuple<IndexCacheSizes, kernel::CacheSizes> CalculateCacheSizes(const ArgsManager& args, size_t n_indexes)\n {\n-    int64_t nTotalCache = (args.GetIntArg(\"-dbcache\", nDefaultDbCache) << 20);\n-    nTotalCache = std::max(nTotalCache, nMinDbCache << 20); // total cache cannot be less than nMinDbCache\n-    CacheSizes sizes;\n-    sizes.block_tree_db = std::min(nTotalCache / 8, nMaxBlockDBCache << 20);\n-    nTotalCache -= sizes.block_tree_db;\n-    sizes.tx_index = std::min(nTotalCache / 8, args.GetBoolArg(\"-txindex\", DEFAULT_TXINDEX) ? nMaxTxIndexCache << 20 : 0);\n+    int64_t nTotalCache = (args.GetIntArg(\"-dbcache\", DEFAULT_DB_CACHE) << 20);\n+    nTotalCache = std::max(nTotalCache, MIN_DB_CACHE << 20);\n+    IndexCacheSizes sizes;",
      "path": "src/node/caches.cpp",
      "position": null,
      "original_position": 28,
      "commit_id": "2a92702bafca5c78b270a9502a22cb9deac02cfc",
      "original_commit_id": "7517126d9fd2c3e50dc95ce831bac6895b950e24",
      "in_reply_to_id": null,
      "user": {
        "login": "hodlinator",
        "id": 172445034,
        "node_id": "U_kgDOCkdNag",
        "avatar_url": "https://avatars.githubusercontent.com/u/172445034?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/hodlinator",
        "html_url": "https://github.com/hodlinator",
        "followers_url": "https://api.github.com/users/hodlinator/followers",
        "following_url": "https://api.github.com/users/hodlinator/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/hodlinator/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/hodlinator/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/hodlinator/subscriptions",
        "organizations_url": "https://api.github.com/users/hodlinator/orgs",
        "repos_url": "https://api.github.com/users/hodlinator/repos",
        "events_url": "https://api.github.com/users/hodlinator/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/hodlinator/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "nit: Arguably clearer:\r\n```suggestion\r\n    IndexCacheSizes index_sizes;\r\n```",
      "created_at": "2024-12-21T10:15:35Z",
      "updated_at": "2024-12-21T22:25:25Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31483#discussion_r1894597050",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1894597050"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31483"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 25,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1894643162",
      "pull_request_review_id": 2518616838,
      "id": 1894643162,
      "node_id": "PRRC_kwDOABII585w7fXa",
      "diff_hunk": "@@ -0,0 +1,35 @@\n+// Copyright (c) 2024-present The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#ifndef BITCOIN_KERNEL_CACHES_H\n+#define BITCOIN_KERNEL_CACHES_H\n+\n+#include <algorithm>\n+#include <cstdint>\n+\n+//! Suggested default amount of cache reserved for the kernel (MiB)\n+static constexpr int64_t DEFAULT_KERNEL_CACHE{450};\n+//! Max memory allocated to block tree DB specific cache (MiB)\n+static constexpr int64_t MAX_BLOCK_DB_CACHE{2};\n+//! Max memory allocated to coin DB specific cache (MiB)\n+static constexpr int64_t MAX_COINS_DB_CACHE{8};\n+\n+namespace kernel {\n+struct CacheSizes {\n+    size_t block_tree_db;\n+    size_t coins_db;\n+    size_t coins;",
      "path": "src/kernel/caches.h",
      "position": 23,
      "original_position": 22,
      "commit_id": "2a92702bafca5c78b270a9502a22cb9deac02cfc",
      "original_commit_id": "7517126d9fd2c3e50dc95ce831bac6895b950e24",
      "in_reply_to_id": 1890151750,
      "user": {
        "login": "hodlinator",
        "id": 172445034,
        "node_id": "U_kgDOCkdNag",
        "avatar_url": "https://avatars.githubusercontent.com/u/172445034?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/hodlinator",
        "html_url": "https://github.com/hodlinator",
        "followers_url": "https://api.github.com/users/hodlinator/followers",
        "following_url": "https://api.github.com/users/hodlinator/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/hodlinator/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/hodlinator/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/hodlinator/subscriptions",
        "organizations_url": "https://api.github.com/users/hodlinator/orgs",
        "repos_url": "https://api.github.com/users/hodlinator/repos",
        "events_url": "https://api.github.com/users/hodlinator/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/hodlinator/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "re: https://github.com/bitcoin/bitcoin/pull/31483#discussion_r1890151750\r\n\r\nMy intuition was \"why not keep using 64-bit types in case the platform is 32-bit\", but 32-bit implies it will not be able to make use of larger than `size_t`, so `size_t` is preferable.\r\n\r\n---\r\n\r\nAdded:\r\n```\r\nstatic_assert(sizeof(size_t) == 4);\r\n```\r\nand built on a 32-bit container (i686-centos).\r\n\r\n---\r\n\r\nWhat is worrying is that I also tested adding an extra zero here:\r\n```C++\r\n//! Suggested default amount of cache reserved for the kernel (MiB)\r\nstatic constexpr int64_t DEFAULT_KERNEL_CACHE{4500};\r\n```\r\nShifted left 20 bits, that value should have become greater than 4294967295/max of `size_t`, but didn't trigger any errors. :warning: See my suggestion in another comment about adding curlies to trigger narrowing conversion errors.\r\n\r\nThis 10x tweak of that constant is caught by asserts I added to my branch.",
      "created_at": "2024-12-21T15:03:25Z",
      "updated_at": "2024-12-21T22:27:50Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31483#discussion_r1894643162",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1894643162"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31483"
        }
      },
      "start_line": 21,
      "original_start_line": 20,
      "start_side": "RIGHT",
      "line": 23,
      "original_line": 23,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1894643334",
      "pull_request_review_id": 2518616838,
      "id": 1894643334,
      "node_id": "PRRC_kwDOABII585w7faG",
      "diff_hunk": "@@ -0,0 +1,35 @@\n+// Copyright (c) 2024-present The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#ifndef BITCOIN_KERNEL_CACHES_H\n+#define BITCOIN_KERNEL_CACHES_H\n+\n+#include <algorithm>\n+#include <cstdint>\n+\n+//! Suggested default amount of cache reserved for the kernel (MiB)\n+static constexpr int64_t DEFAULT_KERNEL_CACHE{450};\n+//! Max memory allocated to block tree DB specific cache (MiB)\n+static constexpr int64_t MAX_BLOCK_DB_CACHE{2};\n+//! Max memory allocated to coin DB specific cache (MiB)\n+static constexpr int64_t MAX_COINS_DB_CACHE{8};\n+\n+namespace kernel {\n+struct CacheSizes {\n+    size_t block_tree_db;\n+    size_t coins_db;\n+    size_t coins;\n+\n+    CacheSizes(int64_t total_cache)\n+    {\n+        block_tree_db = std::min(total_cache / 8, MAX_BLOCK_DB_CACHE << 20);",
      "path": "src/kernel/caches.h",
      "position": null,
      "original_position": 26,
      "commit_id": "2a92702bafca5c78b270a9502a22cb9deac02cfc",
      "original_commit_id": "7517126d9fd2c3e50dc95ce831bac6895b950e24",
      "in_reply_to_id": 1890138649,
      "user": {
        "login": "hodlinator",
        "id": 172445034,
        "node_id": "U_kgDOCkdNag",
        "avatar_url": "https://avatars.githubusercontent.com/u/172445034?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/hodlinator",
        "html_url": "https://github.com/hodlinator",
        "followers_url": "https://api.github.com/users/hodlinator/followers",
        "following_url": "https://api.github.com/users/hodlinator/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/hodlinator/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/hodlinator/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/hodlinator/subscriptions",
        "organizations_url": "https://api.github.com/users/hodlinator/orgs",
        "repos_url": "https://api.github.com/users/hodlinator/repos",
        "events_url": "https://api.github.com/users/hodlinator/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/hodlinator/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "re: https://github.com/bitcoin/bitcoin/pull/31483#discussion_r1890138649\r\n\r\nOr make `total_cache` `size_t`, removing the need for an assert, and also helps signal the unit being bytes? (May require adding casts though).\r\n\r\n---\r\n\r\nWe also have some implicit narrowing going on here, especially on 32-bit platforms, from `int64_t` to `size_t`. Adding curlies trigger an error.\r\n```suggestion\r\n        block_tree_db = {std::min(total_cache / 8, MAX_BLOCK_DB_CACHE << 20)};\r\n```",
      "created_at": "2024-12-21T15:05:01Z",
      "updated_at": "2024-12-21T22:25:25Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31483#discussion_r1894643334",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1894643334"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31483"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 26,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1894643457",
      "pull_request_review_id": 2518616838,
      "id": 1894643457,
      "node_id": "PRRC_kwDOABII585w7fcB",
      "diff_hunk": "@@ -6,28 +6,31 @@\n \n #include <common/args.h>\n #include <index/txindex.h>\n-#include <txdb.h>\n+#include <kernel/caches.h>\n+\n+#include <algorithm>\n+#include <string>\n+\n+// Unlike for the UTXO database, for the txindex scenario the leveldb cache make\n+// a meaningful difference: https://github.com/bitcoin/bitcoin/pull/8273#issuecomment-229601991\n+static constexpr int64_t MAX_TX_INDEX_CACHE{1024};",
      "path": "src/node/caches.cpp",
      "position": null,
      "original_position": 12,
      "commit_id": "2a92702bafca5c78b270a9502a22cb9deac02cfc",
      "original_commit_id": "7517126d9fd2c3e50dc95ce831bac6895b950e24",
      "in_reply_to_id": null,
      "user": {
        "login": "hodlinator",
        "id": 172445034,
        "node_id": "U_kgDOCkdNag",
        "avatar_url": "https://avatars.githubusercontent.com/u/172445034?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/hodlinator",
        "html_url": "https://github.com/hodlinator",
        "followers_url": "https://api.github.com/users/hodlinator/followers",
        "following_url": "https://api.github.com/users/hodlinator/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/hodlinator/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/hodlinator/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/hodlinator/subscriptions",
        "organizations_url": "https://api.github.com/users/hodlinator/orgs",
        "repos_url": "https://api.github.com/users/hodlinator/repos",
        "events_url": "https://api.github.com/users/hodlinator/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/hodlinator/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "No longer documents unit (MiB) due to commit 69159326810822c804ab53a009ef57fb5f28fac9.",
      "created_at": "2024-12-21T15:05:42Z",
      "updated_at": "2024-12-21T22:25:25Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31483#discussion_r1894643457",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1894643457"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31483"
        }
      },
      "start_line": null,
      "original_start_line": 14,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 19,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1903999989",
      "pull_request_review_id": 2531853195,
      "id": 1903999989,
      "node_id": "PRRC_kwDOABII585xfLv1",
      "diff_hunk": "@@ -0,0 +1,47 @@\n+// Copyright (c) 2024-present The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#ifndef BITCOIN_KERNEL_CACHES_H\n+#define BITCOIN_KERNEL_CACHES_H\n+\n+#include <util/check.h>\n+\n+#include <algorithm>\n+#include <cstdint>\n+#include <limits>\n+\n+//! Suggested default amount of cache reserved for the kernel (MiB)\n+static constexpr int64_t DEFAULT_KERNEL_CACHE{450};\n+//! Max memory allocated to block tree DB specific cache (MiB)\n+static constexpr int64_t MAX_BLOCK_DB_CACHE{2};\n+//! Max memory allocated to coin DB specific cache (MiB)\n+static constexpr int64_t MAX_COINS_DB_CACHE{8};\n+\n+constexpr size_t MiBToBytes(int64_t mib)\n+{\n+    Assert(mib >= 0);\n+    const int64_t bytes{mib << 20};\n+    Assert(bytes >= 0);\n+    Assert(static_cast<uint64_t>(bytes) <= static_cast<uint64_t>(std::numeric_limits<size_t>::max()));",
      "path": "src/kernel/caches.h",
      "position": null,
      "original_position": 26,
      "commit_id": "2a92702bafca5c78b270a9502a22cb9deac02cfc",
      "original_commit_id": "ad80e410b3bf8814cb5b997715ee8cb28f2a2a66",
      "in_reply_to_id": null,
      "user": {
        "login": "hodlinator",
        "id": 172445034,
        "node_id": "U_kgDOCkdNag",
        "avatar_url": "https://avatars.githubusercontent.com/u/172445034?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/hodlinator",
        "html_url": "https://github.com/hodlinator",
        "followers_url": "https://api.github.com/users/hodlinator/followers",
        "following_url": "https://api.github.com/users/hodlinator/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/hodlinator/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/hodlinator/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/hodlinator/subscriptions",
        "organizations_url": "https://api.github.com/users/hodlinator/orgs",
        "repos_url": "https://api.github.com/users/hodlinator/repos",
        "events_url": "https://api.github.com/users/hodlinator/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/hodlinator/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "(Sorry to be correcting my own suggestion, ran out of steam a bit by the time I landed on the approach of using this free function).\r\n\r\n- The 2 first asserts could be improved through replacing them with this more complex one.\r\n- `size_t` is always unsigned, it was probably unnecessary to cast the max value in the last assert.\r\n\r\n```suggestion\r\n    Assert(std::countl_zero(static_cast<uint64_t>(mib)) >= 21); // Ensure signed bit is unset + enough zeros to shift.\r\n    const int64_t bytes{mib << 20};\r\n    Assert(static_cast<uint64_t>(bytes) <= std::numeric_limits<size_t>::max());\r\n```\r\n\r\n`countl_zero` requires:\r\n```diff\r\n+ #include <bit>\r\n```",
      "created_at": "2025-01-06T10:48:17Z",
      "updated_at": "2025-01-06T14:29:53Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31483#discussion_r1903999989",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1903999989"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31483"
        }
      },
      "start_line": null,
      "original_start_line": 23,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 26,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1904015194",
      "pull_request_review_id": 2531853195,
      "id": 1904015194,
      "node_id": "PRRC_kwDOABII585xfPda",
      "diff_hunk": "@@ -0,0 +1,47 @@\n+// Copyright (c) 2024-present The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#ifndef BITCOIN_KERNEL_CACHES_H\n+#define BITCOIN_KERNEL_CACHES_H\n+\n+#include <util/check.h>\n+\n+#include <algorithm>\n+#include <cstdint>\n+#include <limits>\n+\n+//! Suggested default amount of cache reserved for the kernel (MiB)\n+static constexpr int64_t DEFAULT_KERNEL_CACHE{450};\n+//! Max memory allocated to block tree DB specific cache (MiB)\n+static constexpr int64_t MAX_BLOCK_DB_CACHE{2};\n+//! Max memory allocated to coin DB specific cache (MiB)\n+static constexpr int64_t MAX_COINS_DB_CACHE{8};\n+\n+constexpr size_t MiBToBytes(int64_t mib)",
      "path": "src/kernel/caches.h",
      "position": null,
      "original_position": 21,
      "commit_id": "2a92702bafca5c78b270a9502a22cb9deac02cfc",
      "original_commit_id": "ad80e410b3bf8814cb5b997715ee8cb28f2a2a66",
      "in_reply_to_id": null,
      "user": {
        "login": "hodlinator",
        "id": 172445034,
        "node_id": "U_kgDOCkdNag",
        "avatar_url": "https://avatars.githubusercontent.com/u/172445034?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/hodlinator",
        "html_url": "https://github.com/hodlinator",
        "followers_url": "https://api.github.com/users/hodlinator/followers",
        "following_url": "https://api.github.com/users/hodlinator/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/hodlinator/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/hodlinator/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/hodlinator/subscriptions",
        "organizations_url": "https://api.github.com/users/hodlinator/orgs",
        "repos_url": "https://api.github.com/users/hodlinator/repos",
        "events_url": "https://api.github.com/users/hodlinator/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/hodlinator/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "nit: Could deserve a brief comment?\r\n```C++\r\n//! Guards against truncation of values before converting.\r\nconstexpr size_t MiBToBytes(int64_t mib)\r\n```",
      "created_at": "2025-01-06T11:00:51Z",
      "updated_at": "2025-01-06T14:29:53Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31483#discussion_r1904015194",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1904015194"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31483"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 23,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1904029488",
      "pull_request_review_id": 2531853195,
      "id": 1904029488,
      "node_id": "PRRC_kwDOABII585xfS8w",
      "diff_hunk": "@@ -6,28 +6,39 @@\n \n #include <common/args.h>\n #include <index/txindex.h>\n-#include <txdb.h>\n+#include <kernel/caches.h>\n+#include <logging.h>\n+\n+#include <algorithm>\n+#include <optional>\n+#include <string>\n+\n+// Unlike for the UTXO database, for the txindex scenario the leveldb cache make\n+// a meaningful difference: https://github.com/bitcoin/bitcoin/pull/8273#issuecomment-229601991\n+//! Max memory allocated to tx index DB specific cache in MiB.\n+static constexpr int64_t MAX_TX_INDEX_CACHE{1024};\n+//! Max memory allocated to all block filter index caches combined in MiB.\n+static constexpr int64_t MAX_FILTER_INDEX_CACHE{1024};\n \n namespace node {\n-CacheSizes CalculateCacheSizes(const ArgsManager& args, size_t n_indexes)\n+std::optional<CacheSizes> CalculateCacheSizes(const ArgsManager& args, size_t n_indexes)\n {\n-    int64_t nTotalCache = (args.GetIntArg(\"-dbcache\", nDefaultDbCache) << 20);\n-    nTotalCache = std::max(nTotalCache, nMinDbCache << 20); // total cache cannot be less than nMinDbCache\n-    CacheSizes sizes;\n-    sizes.block_tree_db = std::min(nTotalCache / 8, nMaxBlockDBCache << 20);\n-    nTotalCache -= sizes.block_tree_db;\n-    sizes.tx_index = std::min(nTotalCache / 8, args.GetBoolArg(\"-txindex\", DEFAULT_TXINDEX) ? nMaxTxIndexCache << 20 : 0);\n-    nTotalCache -= sizes.tx_index;\n-    sizes.filter_index = 0;\n+    int64_t db_cache = args.GetIntArg(\"-dbcache\", DEFAULT_DB_CACHE);\n+    if (static_cast<uint64_t>(db_cache << 20) > static_cast<uint64_t>(std::numeric_limits<size_t>::max())) {",
      "path": "src/node/caches.cpp",
      "position": null,
      "original_position": 32,
      "commit_id": "2a92702bafca5c78b270a9502a22cb9deac02cfc",
      "original_commit_id": "ad80e410b3bf8814cb5b997715ee8cb28f2a2a66",
      "in_reply_to_id": null,
      "user": {
        "login": "hodlinator",
        "id": 172445034,
        "node_id": "U_kgDOCkdNag",
        "avatar_url": "https://avatars.githubusercontent.com/u/172445034?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/hodlinator",
        "html_url": "https://github.com/hodlinator",
        "followers_url": "https://api.github.com/users/hodlinator/followers",
        "following_url": "https://api.github.com/users/hodlinator/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/hodlinator/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/hodlinator/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/hodlinator/subscriptions",
        "organizations_url": "https://api.github.com/users/hodlinator/orgs",
        "repos_url": "https://api.github.com/users/hodlinator/repos",
        "events_url": "https://api.github.com/users/hodlinator/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/hodlinator/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "Good to have this for user supplied data instead of triggering asserts!\r\n\r\nnit: Might be able to skip one cast:\r\n```suggestion\r\n    if (static_cast<uint64_t>(db_cache << 20) > std::numeric_limits<size_t>::max()) {\r\n```",
      "created_at": "2025-01-06T11:16:06Z",
      "updated_at": "2025-01-06T14:29:53Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31483#discussion_r1904029488",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1904029488"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31483"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 27,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1904134914",
      "pull_request_review_id": 2531853195,
      "id": 1904134914,
      "node_id": "PRRC_kwDOABII585xfssC",
      "diff_hunk": "@@ -6,28 +6,39 @@\n \n #include <common/args.h>\n #include <index/txindex.h>\n-#include <txdb.h>\n+#include <kernel/caches.h>\n+#include <logging.h>\n+\n+#include <algorithm>\n+#include <optional>\n+#include <string>\n+\n+// Unlike for the UTXO database, for the txindex scenario the leveldb cache make\n+// a meaningful difference: https://github.com/bitcoin/bitcoin/pull/8273#issuecomment-229601991\n+//! Max memory allocated to tx index DB specific cache in MiB.\n+static constexpr int64_t MAX_TX_INDEX_CACHE{1024};\n+//! Max memory allocated to all block filter index caches combined in MiB.\n+static constexpr int64_t MAX_FILTER_INDEX_CACHE{1024};\n \n namespace node {\n-CacheSizes CalculateCacheSizes(const ArgsManager& args, size_t n_indexes)\n+std::optional<CacheSizes> CalculateCacheSizes(const ArgsManager& args, size_t n_indexes)\n {\n-    int64_t nTotalCache = (args.GetIntArg(\"-dbcache\", nDefaultDbCache) << 20);\n-    nTotalCache = std::max(nTotalCache, nMinDbCache << 20); // total cache cannot be less than nMinDbCache\n-    CacheSizes sizes;\n-    sizes.block_tree_db = std::min(nTotalCache / 8, nMaxBlockDBCache << 20);\n-    nTotalCache -= sizes.block_tree_db;\n-    sizes.tx_index = std::min(nTotalCache / 8, args.GetBoolArg(\"-txindex\", DEFAULT_TXINDEX) ? nMaxTxIndexCache << 20 : 0);\n-    nTotalCache -= sizes.tx_index;\n-    sizes.filter_index = 0;\n+    int64_t db_cache = args.GetIntArg(\"-dbcache\", DEFAULT_DB_CACHE);\n+    if (static_cast<uint64_t>(db_cache << 20) > static_cast<uint64_t>(std::numeric_limits<size_t>::max())) {",
      "path": "src/node/caches.cpp",
      "position": null,
      "original_position": 32,
      "commit_id": "2a92702bafca5c78b270a9502a22cb9deac02cfc",
      "original_commit_id": "ad80e410b3bf8814cb5b997715ee8cb28f2a2a66",
      "in_reply_to_id": null,
      "user": {
        "login": "hodlinator",
        "id": 172445034,
        "node_id": "U_kgDOCkdNag",
        "avatar_url": "https://avatars.githubusercontent.com/u/172445034?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/hodlinator",
        "html_url": "https://github.com/hodlinator",
        "followers_url": "https://api.github.com/users/hodlinator/followers",
        "following_url": "https://api.github.com/users/hodlinator/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/hodlinator/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/hodlinator/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/hodlinator/subscriptions",
        "organizations_url": "https://api.github.com/users/hodlinator/orgs",
        "repos_url": "https://api.github.com/users/hodlinator/repos",
        "events_url": "https://api.github.com/users/hodlinator/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/hodlinator/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "Would be good to check against negative `-dbcache` values as well.",
      "created_at": "2025-01-06T13:12:14Z",
      "updated_at": "2025-01-06T14:29:53Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31483#discussion_r1904134914",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1904134914"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31483"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 27,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1904193756",
      "pull_request_review_id": 2531853195,
      "id": 1904193756,
      "node_id": "PRRC_kwDOABII585xf7Dc",
      "diff_hunk": "@@ -1603,18 +1605,22 @@ bool AppInitMain(NodeContext& node, interfaces::BlockAndHeaderTipInfo* tip_info)\n     ReadNotificationArgs(args, kernel_notifications);\n \n     // cache size calculations\n-    CacheSizes cache_sizes = CalculateCacheSizes(args, g_enabled_filter_types.size());\n+    const auto cache_sizes = CalculateCacheSizes(args, g_enabled_filter_types.size());\n+    if (!cache_sizes) {\n+        return InitError(_(\"Failed to calculate cache sizes. Try lowering the -dbcache value.\"));\n+    }\n+    auto [index_cache_sizes, kernel_cache_sizes] = *cache_sizes;\n \n     LogPrintf(\"Cache configuration:\\n\");\n-    LogPrintf(\"* Using %.1f MiB for block index database\\n\", cache_sizes.block_tree_db * (1.0 / 1024 / 1024));\n+    LogPrintf(\"* Using %.1f MiB for block index database\\n\", kernel_cache_sizes.block_tree_db * (1.0 / 1024 / 1024));",
      "path": "src/init.cpp",
      "position": null,
      "original_position": 42,
      "commit_id": "2a92702bafca5c78b270a9502a22cb9deac02cfc",
      "original_commit_id": "ad80e410b3bf8814cb5b997715ee8cb28f2a2a66",
      "in_reply_to_id": null,
      "user": {
        "login": "hodlinator",
        "id": 172445034,
        "node_id": "U_kgDOCkdNag",
        "avatar_url": "https://avatars.githubusercontent.com/u/172445034?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/hodlinator",
        "html_url": "https://github.com/hodlinator",
        "followers_url": "https://api.github.com/users/hodlinator/followers",
        "following_url": "https://api.github.com/users/hodlinator/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/hodlinator/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/hodlinator/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/hodlinator/subscriptions",
        "organizations_url": "https://api.github.com/users/hodlinator/orgs",
        "repos_url": "https://api.github.com/users/hodlinator/repos",
        "events_url": "https://api.github.com/users/hodlinator/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/hodlinator/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "nit: Could use more modern `LogInfo()` instead.",
      "created_at": "2025-01-06T14:06:42Z",
      "updated_at": "2025-01-06T14:29:53Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31483#discussion_r1904193756",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1904193756"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31483"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1615,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1904214972",
      "pull_request_review_id": 2531853195,
      "id": 1904214972,
      "node_id": "PRRC_kwDOABII585xgAO8",
      "diff_hunk": "@@ -0,0 +1,6 @@\n+Updated settings\n+------\n+\n+- On 32-bit systems an error is returned on startup if the user passes a\n+  `-dbcache` value exceeding 4096MiB.",
      "path": "doc/release-notes-31483.md",
      "position": null,
      "original_position": 5,
      "commit_id": "2a92702bafca5c78b270a9502a22cb9deac02cfc",
      "original_commit_id": "ad80e410b3bf8814cb5b997715ee8cb28f2a2a66",
      "in_reply_to_id": null,
      "user": {
        "login": "hodlinator",
        "id": 172445034,
        "node_id": "U_kgDOCkdNag",
        "avatar_url": "https://avatars.githubusercontent.com/u/172445034?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/hodlinator",
        "html_url": "https://github.com/hodlinator",
        "followers_url": "https://api.github.com/users/hodlinator/followers",
        "following_url": "https://api.github.com/users/hodlinator/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/hodlinator/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/hodlinator/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/hodlinator/subscriptions",
        "organizations_url": "https://api.github.com/users/hodlinator/orgs",
        "repos_url": "https://api.github.com/users/hodlinator/repos",
        "events_url": "https://api.github.com/users/hodlinator/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/hodlinator/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "nit: Simpler to say 4GiB?\r\n\r\nI know 32-bit Windows has issues using more than 2GB unless one sets `/LARGEADDRESSAWARE`, not sure whether we do that. See https://learn.microsoft.com/en-us/windows/win32/memory/memory-limits-for-windows-releases\r\n\r\nEdit: I guess we don't ship 32-bit Windows builds any longer, so the 2GB limit should not be a concern.",
      "created_at": "2025-01-06T14:25:22Z",
      "updated_at": "2025-01-06T14:32:21Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31483#discussion_r1904214972",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1904214972"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31483"
        }
      },
      "start_line": null,
      "original_start_line": 4,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 5,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1904334692",
      "pull_request_review_id": 2532457667,
      "id": 1904334692,
      "node_id": "PRRC_kwDOABII585xgddk",
      "diff_hunk": "@@ -6,28 +6,39 @@\n \n #include <common/args.h>\n #include <index/txindex.h>\n-#include <txdb.h>\n+#include <kernel/caches.h>\n+#include <logging.h>\n+\n+#include <algorithm>\n+#include <optional>\n+#include <string>\n+\n+// Unlike for the UTXO database, for the txindex scenario the leveldb cache make\n+// a meaningful difference: https://github.com/bitcoin/bitcoin/pull/8273#issuecomment-229601991\n+//! Max memory allocated to tx index DB specific cache in MiB.\n+static constexpr int64_t MAX_TX_INDEX_CACHE{1024};\n+//! Max memory allocated to all block filter index caches combined in MiB.\n+static constexpr int64_t MAX_FILTER_INDEX_CACHE{1024};\n \n namespace node {\n-CacheSizes CalculateCacheSizes(const ArgsManager& args, size_t n_indexes)\n+std::optional<CacheSizes> CalculateCacheSizes(const ArgsManager& args, size_t n_indexes)\n {\n-    int64_t nTotalCache = (args.GetIntArg(\"-dbcache\", nDefaultDbCache) << 20);\n-    nTotalCache = std::max(nTotalCache, nMinDbCache << 20); // total cache cannot be less than nMinDbCache\n-    CacheSizes sizes;\n-    sizes.block_tree_db = std::min(nTotalCache / 8, nMaxBlockDBCache << 20);\n-    nTotalCache -= sizes.block_tree_db;\n-    sizes.tx_index = std::min(nTotalCache / 8, args.GetBoolArg(\"-txindex\", DEFAULT_TXINDEX) ? nMaxTxIndexCache << 20 : 0);\n-    nTotalCache -= sizes.tx_index;\n-    sizes.filter_index = 0;\n+    int64_t db_cache = args.GetIntArg(\"-dbcache\", DEFAULT_DB_CACHE);\n+    if (static_cast<uint64_t>(db_cache << 20) > static_cast<uint64_t>(std::numeric_limits<size_t>::max())) {",
      "path": "src/node/caches.cpp",
      "position": null,
      "original_position": 32,
      "commit_id": "2a92702bafca5c78b270a9502a22cb9deac02cfc",
      "original_commit_id": "ad80e410b3bf8814cb5b997715ee8cb28f2a2a66",
      "in_reply_to_id": 1904134914,
      "user": {
        "login": "TheCharlatan",
        "id": 8421793,
        "node_id": "MDQ6VXNlcjg0MjE3OTM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8421793?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/TheCharlatan",
        "html_url": "https://github.com/TheCharlatan",
        "followers_url": "https://api.github.com/users/TheCharlatan/followers",
        "following_url": "https://api.github.com/users/TheCharlatan/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/TheCharlatan/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/TheCharlatan/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/TheCharlatan/subscriptions",
        "organizations_url": "https://api.github.com/users/TheCharlatan/orgs",
        "repos_url": "https://api.github.com/users/TheCharlatan/repos",
        "events_url": "https://api.github.com/users/TheCharlatan/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/TheCharlatan/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "Ugh, must have switched to the old branch by mistake when I was testing this. I think it would be better to clamp the negative values to zero, which preserves the current behaviour.",
      "created_at": "2025-01-06T16:02:07Z",
      "updated_at": "2025-01-06T16:02:08Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31483#discussion_r1904334692",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1904334692"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31483"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 27,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1905322706",
      "pull_request_review_id": 2534107645,
      "id": 1905322706,
      "node_id": "PRRC_kwDOABII585xkOrS",
      "diff_hunk": "@@ -0,0 +1,48 @@\n+// Copyright (c) 2024-present The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#ifndef BITCOIN_KERNEL_CACHES_H\n+#define BITCOIN_KERNEL_CACHES_H\n+\n+#include <util/check.h>\n+\n+#include <algorithm>\n+#include <bit>\n+#include <cstdint>\n+#include <limits>\n+\n+//! Suggested default amount of cache reserved for the kernel (MiB)\n+static constexpr int64_t DEFAULT_KERNEL_CACHE{450};\n+//! Max memory allocated to block tree DB specific cache (MiB)\n+static constexpr int64_t MAX_BLOCK_DB_CACHE{2};\n+//! Max memory allocated to coin DB specific cache (MiB)\n+static constexpr int64_t MAX_COINS_DB_CACHE{8};\n+\n+//! Guard against truncation of values before converting.\n+constexpr size_t MiBToBytes(int64_t mib)\n+{\n+    Assert(std::countl_zero(static_cast<uint64_t>(mib)) >= 21); // Ensure signed bit is unset + enough zeros to shift.",
      "path": "src/kernel/caches.h",
      "position": null,
      "original_position": 25,
      "commit_id": "2a92702bafca5c78b270a9502a22cb9deac02cfc",
      "original_commit_id": "54bdaaefbc683a61f3051dd90bbaf69de5d6cac5",
      "in_reply_to_id": null,
      "user": {
        "login": "hodlinator",
        "id": 172445034,
        "node_id": "U_kgDOCkdNag",
        "avatar_url": "https://avatars.githubusercontent.com/u/172445034?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/hodlinator",
        "html_url": "https://github.com/hodlinator",
        "followers_url": "https://api.github.com/users/hodlinator/followers",
        "following_url": "https://api.github.com/users/hodlinator/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/hodlinator/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/hodlinator/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/hodlinator/subscriptions",
        "organizations_url": "https://api.github.com/users/hodlinator/orgs",
        "repos_url": "https://api.github.com/users/hodlinator/repos",
        "events_url": "https://api.github.com/users/hodlinator/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/hodlinator/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "nit: If you re-touch, slightly more correct:\r\n```suggestion\r\n    Assert(std::countl_zero(static_cast<uint64_t>(mib)) >= 21); // Ensure sign bit is unset + enough zeros to shift.\r\n```",
      "created_at": "2025-01-07T11:31:10Z",
      "updated_at": "2025-01-07T11:43:14Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31483#discussion_r1905322706",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1905322706"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31483"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 25,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1905324826",
      "pull_request_review_id": 2534107645,
      "id": 1905324826,
      "node_id": "PRRC_kwDOABII585xkPMa",
      "diff_hunk": "@@ -0,0 +1,48 @@\n+// Copyright (c) 2024-present The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#ifndef BITCOIN_KERNEL_CACHES_H\n+#define BITCOIN_KERNEL_CACHES_H\n+\n+#include <util/check.h>\n+\n+#include <algorithm>\n+#include <bit>\n+#include <cstdint>\n+#include <limits>",
      "path": "src/kernel/caches.h",
      "position": null,
      "original_position": 13,
      "commit_id": "2a92702bafca5c78b270a9502a22cb9deac02cfc",
      "original_commit_id": "54bdaaefbc683a61f3051dd90bbaf69de5d6cac5",
      "in_reply_to_id": null,
      "user": {
        "login": "hodlinator",
        "id": 172445034,
        "node_id": "U_kgDOCkdNag",
        "avatar_url": "https://avatars.githubusercontent.com/u/172445034?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/hodlinator",
        "html_url": "https://github.com/hodlinator",
        "followers_url": "https://api.github.com/users/hodlinator/followers",
        "following_url": "https://api.github.com/users/hodlinator/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/hodlinator/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/hodlinator/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/hodlinator/subscriptions",
        "organizations_url": "https://api.github.com/users/hodlinator/orgs",
        "repos_url": "https://api.github.com/users/hodlinator/repos",
        "events_url": "https://api.github.com/users/hodlinator/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/hodlinator/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "nit: `<limits>` should be added in same commit as `<bit>` and `MiBToBytes()`.",
      "created_at": "2025-01-07T11:33:10Z",
      "updated_at": "2025-01-07T11:43:14Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31483#discussion_r1905324826",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1905324826"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31483"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 13,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1905431196",
      "pull_request_review_id": 2534296691,
      "id": 1905431196,
      "node_id": "PRRC_kwDOABII585xkpKc",
      "diff_hunk": "@@ -0,0 +1,48 @@\n+// Copyright (c) 2024-present The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#ifndef BITCOIN_KERNEL_CACHES_H\n+#define BITCOIN_KERNEL_CACHES_H\n+\n+#include <util/check.h>\n+\n+#include <algorithm>\n+#include <bit>\n+#include <cstdint>\n+#include <limits>\n+\n+//! Suggested default amount of cache reserved for the kernel (MiB)\n+static constexpr int64_t DEFAULT_KERNEL_CACHE{450};\n+//! Max memory allocated to block tree DB specific cache (MiB)\n+static constexpr int64_t MAX_BLOCK_DB_CACHE{2};\n+//! Max memory allocated to coin DB specific cache (MiB)\n+static constexpr int64_t MAX_COINS_DB_CACHE{8};\n+\n+//! Guard against truncation of values before converting.\n+constexpr size_t MiBToBytes(int64_t mib)\n+{\n+    Assert(std::countl_zero(static_cast<uint64_t>(mib)) >= 21); // Ensure signed bit is unset + enough zeros to shift.",
      "path": "src/kernel/caches.h",
      "position": null,
      "original_position": 25,
      "commit_id": "2a92702bafca5c78b270a9502a22cb9deac02cfc",
      "original_commit_id": "54bdaaefbc683a61f3051dd90bbaf69de5d6cac5",
      "in_reply_to_id": 1905322706,
      "user": {
        "login": "hodlinator",
        "id": 172445034,
        "node_id": "U_kgDOCkdNag",
        "avatar_url": "https://avatars.githubusercontent.com/u/172445034?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/hodlinator",
        "html_url": "https://github.com/hodlinator",
        "followers_url": "https://api.github.com/users/hodlinator/followers",
        "following_url": "https://api.github.com/users/hodlinator/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/hodlinator/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/hodlinator/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/hodlinator/subscriptions",
        "organizations_url": "https://api.github.com/users/hodlinator/orgs",
        "repos_url": "https://api.github.com/users/hodlinator/repos",
        "events_url": "https://api.github.com/users/hodlinator/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/hodlinator/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "Should probably fix this typo in commit it was introduced (a5742b7c09f1b4204abf4a1992018fb7be2fef27), instead of in final commit (224bfeb07f7561470451c95dc0df1db959bc187e).",
      "created_at": "2025-01-07T13:07:54Z",
      "updated_at": "2025-01-07T13:07:54Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31483#discussion_r1905431196",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1905431196"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31483"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 25,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1907055901",
      "pull_request_review_id": 2536926530,
      "id": 1907055901,
      "node_id": "PRRC_kwDOABII585xq10d",
      "diff_hunk": "@@ -0,0 +1,48 @@\n+// Copyright (c) 2024-present The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#ifndef BITCOIN_KERNEL_CACHES_H\n+#define BITCOIN_KERNEL_CACHES_H\n+\n+#include <util/check.h>\n+\n+#include <algorithm>\n+#include <bit>\n+#include <cstdint>\n+#include <limits>\n+\n+//! Suggested default amount of cache reserved for the kernel (MiB)\n+static constexpr int64_t DEFAULT_KERNEL_CACHE{450};\n+//! Max memory allocated to block tree DB specific cache (MiB)\n+static constexpr int64_t MAX_BLOCK_DB_CACHE{2};\n+//! Max memory allocated to coin DB specific cache (MiB)\n+static constexpr int64_t MAX_COINS_DB_CACHE{8};\n+\n+//! Guard against truncation of values before converting.\n+constexpr size_t MiBToBytes(int64_t mib)\n+{\n+    Assert(std::countl_zero(static_cast<uint64_t>(mib)) >= 21); // Ensure sign bit is unset + enough zeros to shift.",
      "path": "src/kernel/caches.h",
      "position": null,
      "original_position": 25,
      "commit_id": "2a92702bafca5c78b270a9502a22cb9deac02cfc",
      "original_commit_id": "578654c686e394d08bac7c3bcddbfd90b46eaa62",
      "in_reply_to_id": null,
      "user": {
        "login": "stickies-v",
        "id": 69010457,
        "node_id": "MDQ6VXNlcjY5MDEwNDU3",
        "avatar_url": "https://avatars.githubusercontent.com/u/69010457?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stickies-v",
        "html_url": "https://github.com/stickies-v",
        "followers_url": "https://api.github.com/users/stickies-v/followers",
        "following_url": "https://api.github.com/users/stickies-v/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stickies-v/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stickies-v/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stickies-v/subscriptions",
        "organizations_url": "https://api.github.com/users/stickies-v/orgs",
        "repos_url": "https://api.github.com/users/stickies-v/repos",
        "events_url": "https://api.github.com/users/stickies-v/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stickies-v/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "I think the docstring is misleading: we're casting to uint64_t, so the sign bit will always be unset. Relatedly, this function does not deal with negative input well, so I think we should first assert that `mib` is positive and update the docstring to remove the signedness reference.",
      "created_at": "2025-01-08T11:44:07Z",
      "updated_at": "2025-01-08T14:35:25Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31483#discussion_r1907055901",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1907055901"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31483"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 25,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1907068544",
      "pull_request_review_id": 2536926530,
      "id": 1907068544,
      "node_id": "PRRC_kwDOABII585xq46A",
      "diff_hunk": "@@ -0,0 +1,48 @@\n+// Copyright (c) 2024-present The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#ifndef BITCOIN_KERNEL_CACHES_H\n+#define BITCOIN_KERNEL_CACHES_H\n+\n+#include <util/check.h>\n+\n+#include <algorithm>\n+#include <bit>\n+#include <cstdint>\n+#include <limits>\n+\n+//! Suggested default amount of cache reserved for the kernel (MiB)\n+static constexpr int64_t DEFAULT_KERNEL_CACHE{450};\n+//! Max memory allocated to block tree DB specific cache (MiB)\n+static constexpr int64_t MAX_BLOCK_DB_CACHE{2};\n+//! Max memory allocated to coin DB specific cache (MiB)\n+static constexpr int64_t MAX_COINS_DB_CACHE{8};\n+\n+//! Guard against truncation of values before converting.\n+constexpr size_t MiBToBytes(int64_t mib)",
      "path": "src/kernel/caches.h",
      "position": null,
      "original_position": 23,
      "commit_id": "2a92702bafca5c78b270a9502a22cb9deac02cfc",
      "original_commit_id": "578654c686e394d08bac7c3bcddbfd90b46eaa62",
      "in_reply_to_id": null,
      "user": {
        "login": "stickies-v",
        "id": 69010457,
        "node_id": "MDQ6VXNlcjY5MDEwNDU3",
        "avatar_url": "https://avatars.githubusercontent.com/u/69010457?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stickies-v",
        "html_url": "https://github.com/stickies-v",
        "followers_url": "https://api.github.com/users/stickies-v/followers",
        "following_url": "https://api.github.com/users/stickies-v/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stickies-v/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stickies-v/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stickies-v/subscriptions",
        "organizations_url": "https://api.github.com/users/stickies-v/orgs",
        "repos_url": "https://api.github.com/users/stickies-v/repos",
        "events_url": "https://api.github.com/users/stickies-v/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stickies-v/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "I think a `std::optional<size_t>` return type is more appropriate for this function, the assertions make this function hard to test. Below diff updates the return type, adds a positiveness check (as per my other comment), and adds a test case:\r\n\r\n<details>\r\n<summary>git diff on 578654c686</summary>\r\n\r\n```diff\r\ndiff --git a/src/bitcoin-chainstate.cpp b/src/bitcoin-chainstate.cpp\r\nindex 46ca35ea90..623aec5aa0 100644\r\n--- a/src/bitcoin-chainstate.cpp\r\n+++ b/src/bitcoin-chainstate.cpp\r\n@@ -123,7 +123,7 @@ int main(int argc, char* argv[])\r\n     util::SignalInterrupt interrupt;\r\n     ChainstateManager chainman{interrupt, chainman_opts, blockman_opts};\r\n \r\n-    kernel::CacheSizes cache_sizes{MiBToBytes(DEFAULT_KERNEL_CACHE)};\r\n+    kernel::CacheSizes cache_sizes{*Assert(MiBToBytes(DEFAULT_KERNEL_CACHE))};\r\n     node::ChainstateLoadOptions options;\r\n     auto [status, error] = node::LoadChainstate(chainman, cache_sizes, options);\r\n     if (status != node::ChainstateLoadStatus::SUCCESS) {\r\ndiff --git a/src/kernel/caches.h b/src/kernel/caches.h\r\nindex 2b5ba9eefc..298ebf8d43 100644\r\n--- a/src/kernel/caches.h\r\n+++ b/src/kernel/caches.h\r\n@@ -11,6 +11,7 @@\r\n #include <bit>\r\n #include <cstdint>\r\n #include <limits>\r\n+#include <optional>\r\n \r\n //! Suggested default amount of cache reserved for the kernel (MiB)\r\n static constexpr int64_t DEFAULT_KERNEL_CACHE{450};\r\n@@ -20,11 +21,15 @@ static constexpr int64_t MAX_BLOCK_DB_CACHE{2};\r\n static constexpr int64_t MAX_COINS_DB_CACHE{8};\r\n \r\n //! Guard against truncation of values before converting.\r\n-constexpr size_t MiBToBytes(int64_t mib)\r\n+constexpr std::optional<size_t> MiBToBytes(int64_t mib)\r\n {\r\n-    Assert(std::countl_zero(static_cast<uint64_t>(mib)) >= 21); // Ensure sign bit is unset + enough zeros to shift.\r\n+    if (mib < 0 || std::countl_zero(static_cast<uint64_t>(mib)) < 21) {\r\n+        return std::nullopt;\r\n+    }\r\n     const int64_t bytes{mib << 20};\r\n-    Assert(static_cast<uint64_t>(bytes) <= std::numeric_limits<size_t>::max());\r\n+    if (static_cast<uint64_t>(bytes) > std::numeric_limits<size_t>::max()) {\r\n+        return std::nullopt;\r\n+    }\r\n     return static_cast<size_t>(bytes);\r\n }\r\n \r\n@@ -36,9 +41,9 @@ struct CacheSizes {\r\n \r\n     CacheSizes(size_t total_cache)\r\n     {\r\n-        block_tree_db = std::min(total_cache / 8, MiBToBytes(MAX_BLOCK_DB_CACHE));\r\n+        block_tree_db = std::min(total_cache / 8, *Assert(MiBToBytes(MAX_BLOCK_DB_CACHE)));\r\n         total_cache -= block_tree_db;\r\n-        coins_db = std::min(total_cache / 2, MiBToBytes(MAX_COINS_DB_CACHE));\r\n+        coins_db = std::min(total_cache / 2, *Assert(MiBToBytes(MAX_COINS_DB_CACHE)));\r\n         total_cache -= coins_db;\r\n         coins = total_cache; // the rest goes to the coins cache\r\n     }\r\ndiff --git a/src/node/caches.cpp b/src/node/caches.cpp\r\nindex 9dbbccd304..f59748a222 100644\r\n--- a/src/node/caches.cpp\r\n+++ b/src/node/caches.cpp\r\n@@ -8,6 +8,7 @@\r\n #include <index/txindex.h>\r\n #include <kernel/caches.h>\r\n #include <logging.h>\r\n+#include <util/check.h>\r\n \r\n #include <algorithm>\r\n #include <optional>\r\n@@ -31,14 +32,14 @@ std::optional<CacheSizes> CalculateCacheSizes(const ArgsManager& args, size_t n_\r\n \r\n     // negative values are permitted, but interpreted as zero.\r\n     db_cache = std::max(int64_t{0}, db_cache);\r\n-    size_t total_cache = std::max(MiBToBytes(db_cache), MiBToBytes(MIN_DB_CACHE));\r\n+    size_t total_cache = std::max(*Assert(MiBToBytes(db_cache)), *Assert(MiBToBytes(MIN_DB_CACHE)));\r\n \r\n     IndexCacheSizes index_sizes;\r\n-    index_sizes.tx_index = std::min(total_cache / 8, args.GetBoolArg(\"-txindex\", DEFAULT_TXINDEX) ? MiBToBytes(MAX_TX_INDEX_CACHE) : 0);\r\n+    index_sizes.tx_index = std::min(total_cache / 8, args.GetBoolArg(\"-txindex\", DEFAULT_TXINDEX) ? *Assert(MiBToBytes(MAX_TX_INDEX_CACHE)) : 0);\r\n     total_cache -= index_sizes.tx_index;\r\n     index_sizes.filter_index = 0;\r\n     if (n_indexes > 0) {\r\n-        int64_t max_cache = std::min(total_cache / 8, MiBToBytes(MAX_FILTER_INDEX_CACHE));\r\n+        int64_t max_cache = std::min(total_cache / 8, *Assert(MiBToBytes(MAX_FILTER_INDEX_CACHE)));\r\n         index_sizes.filter_index = max_cache / n_indexes;\r\n         total_cache -= index_sizes.filter_index * n_indexes;\r\n     }\r\ndiff --git a/src/test/CMakeLists.txt b/src/test/CMakeLists.txt\r\nindex ed73e44901..7cf42c2aa9 100644\r\n--- a/src/test/CMakeLists.txt\r\n+++ b/src/test/CMakeLists.txt\r\n@@ -71,6 +71,7 @@ add_executable(test_bitcoin\r\n   httpserver_tests.cpp\r\n   i2p_tests.cpp\r\n   interfaces_tests.cpp\r\n+  kernel_caches_tests.cpp\r\n   key_io_tests.cpp\r\n   key_tests.cpp\r\n   logging_tests.cpp\r\n\r\n```\r\n</details>\r\n",
      "created_at": "2025-01-08T11:54:52Z",
      "updated_at": "2025-01-08T14:34:23Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31483#discussion_r1907068544",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1907068544"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31483"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 23,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1907214794",
      "pull_request_review_id": 2536926530,
      "id": 1907214794,
      "node_id": "PRRC_kwDOABII585xrcnK",
      "diff_hunk": "@@ -6,28 +6,42 @@\n \n #include <common/args.h>\n #include <index/txindex.h>\n-#include <txdb.h>\n+#include <kernel/caches.h>\n+#include <logging.h>\n+\n+#include <algorithm>\n+#include <optional>\n+#include <string>\n+\n+// Unlike for the UTXO database, for the txindex scenario the leveldb cache make\n+// a meaningful difference: https://github.com/bitcoin/bitcoin/pull/8273#issuecomment-229601991\n+//! Max memory allocated to tx index DB specific cache in MiB.\n+static constexpr int64_t MAX_TX_INDEX_CACHE{1024};\n+//! Max memory allocated to all block filter index caches combined in MiB.\n+static constexpr int64_t MAX_FILTER_INDEX_CACHE{1024};\n \n namespace node {\n-CacheSizes CalculateCacheSizes(const ArgsManager& args, size_t n_indexes)\n+std::optional<CacheSizes> CalculateCacheSizes(const ArgsManager& args, size_t n_indexes)\n {\n-    int64_t nTotalCache = (args.GetIntArg(\"-dbcache\", nDefaultDbCache) << 20);\n-    nTotalCache = std::max(nTotalCache, nMinDbCache << 20); // total cache cannot be less than nMinDbCache\n-    CacheSizes sizes;\n-    sizes.block_tree_db = std::min(nTotalCache / 8, nMaxBlockDBCache << 20);\n-    nTotalCache -= sizes.block_tree_db;\n-    sizes.tx_index = std::min(nTotalCache / 8, args.GetBoolArg(\"-txindex\", DEFAULT_TXINDEX) ? nMaxTxIndexCache << 20 : 0);\n-    nTotalCache -= sizes.tx_index;\n-    sizes.filter_index = 0;\n+    int64_t db_cache = args.GetIntArg(\"-dbcache\", DEFAULT_DB_CACHE);\n+    if (static_cast<uint64_t>(db_cache << 20) > std::numeric_limits<size_t>::max()) {\n+        LogWarning(\"Cannot allocate more than %d MiB in total for db caches.\", static_cast<double>(std::numeric_limits<size_t>::max()) * (1.0 / 1024 / 1024));\n+        return std::nullopt;\n+    }",
      "path": "src/node/caches.cpp",
      "position": null,
      "original_position": 35,
      "commit_id": "2a92702bafca5c78b270a9502a22cb9deac02cfc",
      "original_commit_id": "578654c686e394d08bac7c3bcddbfd90b46eaa62",
      "in_reply_to_id": null,
      "user": {
        "login": "stickies-v",
        "id": 69010457,
        "node_id": "MDQ6VXNlcjY5MDEwNDU3",
        "avatar_url": "https://avatars.githubusercontent.com/u/69010457?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stickies-v",
        "html_url": "https://github.com/stickies-v",
        "followers_url": "https://api.github.com/users/stickies-v/followers",
        "following_url": "https://api.github.com/users/stickies-v/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stickies-v/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stickies-v/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stickies-v/subscriptions",
        "organizations_url": "https://api.github.com/users/stickies-v/orgs",
        "repos_url": "https://api.github.com/users/stickies-v/repos",
        "events_url": "https://api.github.com/users/stickies-v/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stickies-v/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "This check seems pretty broken to me. Left shifting a negative value is UB, and if db_cache is indeed too large it would already overflow in `static_cast<uint64_t>(db_cache << 20)`.\r\n\r\nOn my machine, it seems this whole block is compiled away entirely, I'm not getting any warnings for either negative or too large values.",
      "created_at": "2025-01-08T13:50:43Z",
      "updated_at": "2025-01-08T14:34:23Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31483#discussion_r1907214794",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1907214794"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31483"
        }
      },
      "start_line": null,
      "original_start_line": 27,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 32,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1907267762",
      "pull_request_review_id": 2536926530,
      "id": 1907267762,
      "node_id": "PRRC_kwDOABII585xrpiy",
      "diff_hunk": "@@ -0,0 +1,48 @@\n+// Copyright (c) 2024-present The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#ifndef BITCOIN_KERNEL_CACHES_H\n+#define BITCOIN_KERNEL_CACHES_H\n+\n+#include <util/check.h>\n+\n+#include <algorithm>\n+#include <bit>\n+#include <cstdint>\n+#include <limits>\n+\n+//! Suggested default amount of cache reserved for the kernel (MiB)\n+static constexpr int64_t DEFAULT_KERNEL_CACHE{450};\n+//! Max memory allocated to block tree DB specific cache (MiB)\n+static constexpr int64_t MAX_BLOCK_DB_CACHE{2};\n+//! Max memory allocated to coin DB specific cache (MiB)\n+static constexpr int64_t MAX_COINS_DB_CACHE{8};\n+\n+//! Guard against truncation of values before converting.\n+constexpr size_t MiBToBytes(int64_t mib)",
      "path": "src/kernel/caches.h",
      "position": null,
      "original_position": 23,
      "commit_id": "2a92702bafca5c78b270a9502a22cb9deac02cfc",
      "original_commit_id": "578654c686e394d08bac7c3bcddbfd90b46eaa62",
      "in_reply_to_id": null,
      "user": {
        "login": "stickies-v",
        "id": 69010457,
        "node_id": "MDQ6VXNlcjY5MDEwNDU3",
        "avatar_url": "https://avatars.githubusercontent.com/u/69010457?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stickies-v",
        "html_url": "https://github.com/stickies-v",
        "followers_url": "https://api.github.com/users/stickies-v/followers",
        "following_url": "https://api.github.com/users/stickies-v/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stickies-v/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stickies-v/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stickies-v/subscriptions",
        "organizations_url": "https://api.github.com/users/stickies-v/orgs",
        "repos_url": "https://api.github.com/users/stickies-v/repos",
        "events_url": "https://api.github.com/users/stickies-v/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stickies-v/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "I'm not sure we need `MiBToBytes()` at all. All but one callsite can be eliminated by just storing the constants as `size_t` byte amounts, allowing compile-time guarantees that we're not overflowing the system's `size_t` size. It adds a few more right shift operations, but those aren't prone to overflowing, and are only required for viewing purposes.\r\n\r\nThe only place where we're dealing with run-time values (in `CalculateCacheSizes()`, we already partially (and buggily, as per my [other comment](https://github.com/bitcoin/bitcoin/pull/31483#discussion_r1907214794)) implemented the checks, so I'd suggest inlining the function there.\r\n\r\n<details>\r\n<summary>git diff on 578654c686</summary>\r\n\r\n```diff\r\ndiff --git a/src/bitcoin-chainstate.cpp b/src/bitcoin-chainstate.cpp\r\nindex 46ca35ea90..51c482607a 100644\r\n--- a/src/bitcoin-chainstate.cpp\r\n+++ b/src/bitcoin-chainstate.cpp\r\n@@ -123,7 +123,7 @@ int main(int argc, char* argv[])\r\n     util::SignalInterrupt interrupt;\r\n     ChainstateManager chainman{interrupt, chainman_opts, blockman_opts};\r\n \r\n-    kernel::CacheSizes cache_sizes{MiBToBytes(DEFAULT_KERNEL_CACHE)};\r\n+    kernel::CacheSizes cache_sizes{DEFAULT_KERNEL_CACHE};\r\n     node::ChainstateLoadOptions options;\r\n     auto [status, error] = node::LoadChainstate(chainman, cache_sizes, options);\r\n     if (status != node::ChainstateLoadStatus::SUCCESS) {\r\ndiff --git a/src/init.cpp b/src/init.cpp\r\nindex 1ae968760d..300b46a3d2 100644\r\n--- a/src/init.cpp\r\n+++ b/src/init.cpp\r\n@@ -489,7 +489,7 @@ void SetupServerArgs(ArgsManager& argsman, bool can_listen_ipc)\r\n     argsman.AddArg(\"-conf=<file>\", strprintf(\"Specify path to read-only configuration file. Relative paths will be prefixed by datadir location (only useable from command line, not configuration file) (default: %s)\", BITCOIN_CONF_FILENAME), ArgsManager::ALLOW_ANY, OptionsCategory::OPTIONS);\r\n     argsman.AddArg(\"-datadir=<dir>\", \"Specify data directory\", ArgsManager::ALLOW_ANY | ArgsManager::DISALLOW_NEGATION, OptionsCategory::OPTIONS);\r\n     argsman.AddArg(\"-dbbatchsize\", strprintf(\"Maximum database write batch size in bytes (default: %u)\", nDefaultDbBatchSize), ArgsManager::ALLOW_ANY | ArgsManager::DEBUG_ONLY, OptionsCategory::OPTIONS);\r\n-    argsman.AddArg(\"-dbcache=<n>\", strprintf(\"Maximum database cache size <n> MiB (minimum %d, default: %d). Make sure you have enough RAM. In addition, unused memory allocated to the mempool is shared with this cache (see -maxmempool).\", MIN_DB_CACHE, DEFAULT_DB_CACHE), ArgsManager::ALLOW_ANY, OptionsCategory::OPTIONS);\r\n+    argsman.AddArg(\"-dbcache=<n>\", strprintf(\"Maximum database cache size <n> MiB (minimum %d, default: %d). Make sure you have enough RAM. In addition, unused memory allocated to the mempool is shared with this cache (see -maxmempool).\", MIN_DB_CACHE >> 20, DEFAULT_DB_CACHE >> 20), ArgsManager::ALLOW_ANY, OptionsCategory::OPTIONS);\r\n     argsman.AddArg(\"-includeconf=<file>\", \"Specify additional configuration file, relative to the -datadir path (only useable from configuration file, not command line)\", ArgsManager::ALLOW_ANY, OptionsCategory::OPTIONS);\r\n     argsman.AddArg(\"-allowignoredconf\", strprintf(\"For backwards compatibility, treat an unused %s file in the datadir as a warning, not an error.\", BITCOIN_CONF_FILENAME), ArgsManager::ALLOW_ANY, OptionsCategory::OPTIONS);\r\n     argsman.AddArg(\"-loadblock=<file>\", \"Imports blocks from external file on startup\", ArgsManager::ALLOW_ANY, OptionsCategory::OPTIONS);\r\ndiff --git a/src/kernel/caches.h b/src/kernel/caches.h\r\nindex 2b5ba9eefc..d30813d284 100644\r\n--- a/src/kernel/caches.h\r\n+++ b/src/kernel/caches.h\r\n@@ -8,25 +8,14 @@\r\n #include <util/check.h>\r\n \r\n #include <algorithm>\r\n-#include <bit>\r\n #include <cstdint>\r\n-#include <limits>\r\n \r\n-//! Suggested default amount of cache reserved for the kernel (MiB)\r\n-static constexpr int64_t DEFAULT_KERNEL_CACHE{450};\r\n-//! Max memory allocated to block tree DB specific cache (MiB)\r\n-static constexpr int64_t MAX_BLOCK_DB_CACHE{2};\r\n-//! Max memory allocated to coin DB specific cache (MiB)\r\n-static constexpr int64_t MAX_COINS_DB_CACHE{8};\r\n-\r\n-//! Guard against truncation of values before converting.\r\n-constexpr size_t MiBToBytes(int64_t mib)\r\n-{\r\n-    Assert(std::countl_zero(static_cast<uint64_t>(mib)) >= 21); // Ensure sign bit is unset + enough zeros to shift.\r\n-    const int64_t bytes{mib << 20};\r\n-    Assert(static_cast<uint64_t>(bytes) <= std::numeric_limits<size_t>::max());\r\n-    return static_cast<size_t>(bytes);\r\n-}\r\n+//! Suggested default amount of cache reserved for the kernel (bytes)\r\n+static constexpr size_t DEFAULT_KERNEL_CACHE{450 << 20};\r\n+//! Max memory allocated to block tree DB specific cache (bytes)\r\n+static constexpr size_t MAX_BLOCK_DB_CACHE{2 << 20};\r\n+//! Max memory allocated to coin DB specific cache (bytes)\r\n+static constexpr size_t MAX_COINS_DB_CACHE{8 << 20};\r\n \r\n namespace kernel {\r\n struct CacheSizes {\r\n@@ -36,9 +25,9 @@ struct CacheSizes {\r\n \r\n     CacheSizes(size_t total_cache)\r\n     {\r\n-        block_tree_db = std::min(total_cache / 8, MiBToBytes(MAX_BLOCK_DB_CACHE));\r\n+        block_tree_db = std::min(total_cache / 8, MAX_BLOCK_DB_CACHE);\r\n         total_cache -= block_tree_db;\r\n-        coins_db = std::min(total_cache / 2, MiBToBytes(MAX_COINS_DB_CACHE));\r\n+        coins_db = std::min(total_cache / 2, MAX_COINS_DB_CACHE);\r\n         total_cache -= coins_db;\r\n         coins = total_cache; // the rest goes to the coins cache\r\n     }\r\ndiff --git a/src/node/caches.cpp b/src/node/caches.cpp\r\nindex 9dbbccd304..af27d9af0f 100644\r\n--- a/src/node/caches.cpp\r\n+++ b/src/node/caches.cpp\r\n@@ -10,35 +10,35 @@\r\n #include <logging.h>\r\n \r\n #include <algorithm>\r\n+#include <bit>\r\n #include <optional>\r\n #include <string>\r\n \r\n // Unlike for the UTXO database, for the txindex scenario the leveldb cache make\r\n // a meaningful difference: https://github.com/bitcoin/bitcoin/pull/8273#issuecomment-229601991\r\n-//! Max memory allocated to tx index DB specific cache in MiB.\r\n-static constexpr int64_t MAX_TX_INDEX_CACHE{1024};\r\n-//! Max memory allocated to all block filter index caches combined in MiB.\r\n-static constexpr int64_t MAX_FILTER_INDEX_CACHE{1024};\r\n+//! Max memory allocated to tx index DB specific cache in bytes.\r\n+static constexpr size_t MAX_TX_INDEX_CACHE{1024 << 20};\r\n+//! Max memory allocated to all block filter index caches combined in bytes.\r\n+static constexpr size_t MAX_FILTER_INDEX_CACHE{1024 << 20};\r\n \r\n namespace node {\r\n std::optional<CacheSizes> CalculateCacheSizes(const ArgsManager& args, size_t n_indexes)\r\n {\r\n-    int64_t db_cache = args.GetIntArg(\"-dbcache\", DEFAULT_DB_CACHE);\r\n-    if (static_cast<uint64_t>(db_cache << 20) > std::numeric_limits<size_t>::max()) {\r\n-        LogWarning(\"Cannot allocate more than %d MiB in total for db caches.\", static_cast<double>(std::numeric_limits<size_t>::max()) * (1.0 / 1024 / 1024));\r\n+    // negative values are permitted, but interpreted as zero.\r\n+    uint64_t db_cache_mib = std::max<int64_t>(0, args.GetIntArg(\"-dbcache\", DEFAULT_DB_CACHE >> 20));\r\n+    constexpr size_t max_mib = std::numeric_limits<size_t>::max() >> 20;\r\n+    if (db_cache_mib > max_mib) {\r\n+        LogWarning(\"Cannot allocate more than %d MiB for db caches.\", max_mib);\r\n         return std::nullopt;\r\n     }\r\n-\r\n-    // negative values are permitted, but interpreted as zero.\r\n-    db_cache = std::max(int64_t{0}, db_cache);\r\n-    size_t total_cache = std::max(MiBToBytes(db_cache), MiBToBytes(MIN_DB_CACHE));\r\n+    size_t total_cache{std::max(static_cast<size_t>(db_cache_mib << 20), MIN_DB_CACHE)};\r\n \r\n     IndexCacheSizes index_sizes;\r\n-    index_sizes.tx_index = std::min(total_cache / 8, args.GetBoolArg(\"-txindex\", DEFAULT_TXINDEX) ? MiBToBytes(MAX_TX_INDEX_CACHE) : 0);\r\n+    index_sizes.tx_index = std::min(total_cache / 8, args.GetBoolArg(\"-txindex\", DEFAULT_TXINDEX) ? MAX_TX_INDEX_CACHE : 0);\r\n     total_cache -= index_sizes.tx_index;\r\n     index_sizes.filter_index = 0;\r\n     if (n_indexes > 0) {\r\n-        int64_t max_cache = std::min(total_cache / 8, MiBToBytes(MAX_FILTER_INDEX_CACHE));\r\n+        int64_t max_cache = std::min(total_cache / 8, MAX_FILTER_INDEX_CACHE);\r\n         index_sizes.filter_index = max_cache / n_indexes;\r\n         total_cache -= index_sizes.filter_index * n_indexes;\r\n     }\r\ndiff --git a/src/node/caches.h b/src/node/caches.h\r\nindex fd6b8b4ab8..f52fefd766 100644\r\n--- a/src/node/caches.h\r\n+++ b/src/node/caches.h\r\n@@ -13,10 +13,10 @@\r\n \r\n class ArgsManager;\r\n \r\n-//! min. -dbcache (MiB)\r\n-static constexpr int64_t MIN_DB_CACHE{4};\r\n-//! -dbcache default (MiB)\r\n-static constexpr int64_t DEFAULT_DB_CACHE{DEFAULT_KERNEL_CACHE};\r\n+//! min. -dbcache (bytes)\r\n+static constexpr size_t MIN_DB_CACHE{4 << 20};\r\n+//! -dbcache default (bytes)\r\n+static constexpr size_t DEFAULT_DB_CACHE{DEFAULT_KERNEL_CACHE};\r\n \r\n namespace node {\r\n struct IndexCacheSizes {\r\ndiff --git a/src/qt/optionsdialog.cpp b/src/qt/optionsdialog.cpp\r\nindex 76b7852109..2cea1bf6ab 100644\r\n--- a/src/qt/optionsdialog.cpp\r\n+++ b/src/qt/optionsdialog.cpp\r\n@@ -95,7 +95,7 @@ OptionsDialog::OptionsDialog(QWidget* parent, bool enableWallet)\r\n     ui->verticalLayout->setStretchFactor(ui->tabWidget, 1);\r\n \r\n     /* Main elements init */\r\n-    ui->databaseCache->setRange(MIN_DB_CACHE, std::numeric_limits<int>::max());\r\n+    ui->databaseCache->setRange(MIN_DB_CACHE >> 20, std::numeric_limits<int>::max());\r\n     ui->threadsScriptVerif->setMinimum(-GetNumCores());\r\n     ui->threadsScriptVerif->setMaximum(MAX_SCRIPTCHECK_THREADS);\r\n     ui->pruneWarning->setVisible(false);\r\ndiff --git a/src/qt/optionsmodel.cpp b/src/qt/optionsmodel.cpp\r\nindex 2c6f13dc6d..5ff22b0f4c 100644\r\n--- a/src/qt/optionsmodel.cpp\r\n+++ b/src/qt/optionsmodel.cpp\r\n@@ -470,7 +470,7 @@ QVariant OptionsModel::getOption(OptionID option, const std::string& suffix) con\r\n                suffix.empty()          ? getOption(option, \"-prev\") :\r\n                                          DEFAULT_PRUNE_TARGET_GB;\r\n     case DatabaseCache:\r\n-        return qlonglong(SettingToInt(setting(), DEFAULT_DB_CACHE));\r\n+        return qlonglong(SettingToInt(setting(), DEFAULT_DB_CACHE >> 20));\r\n     case ThreadsScriptVerif:\r\n         return qlonglong(SettingToInt(setting(), DEFAULT_SCRIPTCHECK_THREADS));\r\n     case Listen:\r\n@@ -733,7 +733,7 @@ void OptionsModel::checkAndMigrate()\r\n         // see https://github.com/bitcoin/bitcoin/pull/8273\r\n         // force people to upgrade to the new value if they are using 100MB\r\n         if (settingsVersion < 130000 && settings.contains(\"nDatabaseCache\") && settings.value(\"nDatabaseCache\").toLongLong() == 100)\r\n-            settings.setValue(\"nDatabaseCache\", (qint64)DEFAULT_DB_CACHE);\r\n+            settings.setValue(\"nDatabaseCache\", (qint64)DEFAULT_DB_CACHE >> 20);\r\n \r\n         settings.setValue(strSettingsVersionKey, CLIENT_VERSION);\r\n     }\r\n\r\n```\r\n</details>\r\n\r\nNote: implementing something like this diff should also address all the other comments in this review.\r\n",
      "created_at": "2025-01-08T14:25:57Z",
      "updated_at": "2025-01-08T14:36:59Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31483#discussion_r1907267762",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1907267762"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31483"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 23,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1907297290",
      "pull_request_review_id": 2537344600,
      "id": 1907297290,
      "node_id": "PRRC_kwDOABII585xrwwK",
      "diff_hunk": "@@ -6,28 +6,42 @@\n \n #include <common/args.h>\n #include <index/txindex.h>\n-#include <txdb.h>\n+#include <kernel/caches.h>\n+#include <logging.h>\n+\n+#include <algorithm>\n+#include <optional>\n+#include <string>\n+\n+// Unlike for the UTXO database, for the txindex scenario the leveldb cache make\n+// a meaningful difference: https://github.com/bitcoin/bitcoin/pull/8273#issuecomment-229601991\n+//! Max memory allocated to tx index DB specific cache in MiB.\n+static constexpr int64_t MAX_TX_INDEX_CACHE{1024};\n+//! Max memory allocated to all block filter index caches combined in MiB.\n+static constexpr int64_t MAX_FILTER_INDEX_CACHE{1024};\n \n namespace node {\n-CacheSizes CalculateCacheSizes(const ArgsManager& args, size_t n_indexes)\n+std::optional<CacheSizes> CalculateCacheSizes(const ArgsManager& args, size_t n_indexes)\n {\n-    int64_t nTotalCache = (args.GetIntArg(\"-dbcache\", nDefaultDbCache) << 20);\n-    nTotalCache = std::max(nTotalCache, nMinDbCache << 20); // total cache cannot be less than nMinDbCache\n-    CacheSizes sizes;\n-    sizes.block_tree_db = std::min(nTotalCache / 8, nMaxBlockDBCache << 20);\n-    nTotalCache -= sizes.block_tree_db;\n-    sizes.tx_index = std::min(nTotalCache / 8, args.GetBoolArg(\"-txindex\", DEFAULT_TXINDEX) ? nMaxTxIndexCache << 20 : 0);\n-    nTotalCache -= sizes.tx_index;\n-    sizes.filter_index = 0;\n+    int64_t db_cache = args.GetIntArg(\"-dbcache\", DEFAULT_DB_CACHE);\n+    if (static_cast<uint64_t>(db_cache << 20) > std::numeric_limits<size_t>::max()) {\n+        LogWarning(\"Cannot allocate more than %d MiB in total for db caches.\", static_cast<double>(std::numeric_limits<size_t>::max()) * (1.0 / 1024 / 1024));\n+        return std::nullopt;\n+    }",
      "path": "src/node/caches.cpp",
      "position": null,
      "original_position": 35,
      "commit_id": "2a92702bafca5c78b270a9502a22cb9deac02cfc",
      "original_commit_id": "578654c686e394d08bac7c3bcddbfd90b46eaa62",
      "in_reply_to_id": 1907214794,
      "user": {
        "login": "TheCharlatan",
        "id": 8421793,
        "node_id": "MDQ6VXNlcjg0MjE3OTM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8421793?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/TheCharlatan",
        "html_url": "https://github.com/TheCharlatan",
        "followers_url": "https://api.github.com/users/TheCharlatan/followers",
        "following_url": "https://api.github.com/users/TheCharlatan/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/TheCharlatan/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/TheCharlatan/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/TheCharlatan/subscriptions",
        "organizations_url": "https://api.github.com/users/TheCharlatan/orgs",
        "repos_url": "https://api.github.com/users/TheCharlatan/repos",
        "events_url": "https://api.github.com/users/TheCharlatan/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/TheCharlatan/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "This is only relevant on machines where size_t is not a uint64_t, so I'm not surprised this is optimized away. I tested this by compiling for `arm-linux-gnueabihf` and running with:\r\n```\r\nqemu-arm -L /usr/arm-linux-gnueabihf build_arm_32/src/bitcoind -nowallet -dbcache=10000 -signet\r\n```\r\n+1 for clamping the value range to zero before doing that check though.",
      "created_at": "2025-01-08T14:45:24Z",
      "updated_at": "2025-01-08T14:45:24Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31483#discussion_r1907297290",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1907297290"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31483"
        }
      },
      "start_line": null,
      "original_start_line": 27,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 32,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1907373571",
      "pull_request_review_id": 2537475199,
      "id": 1907373571,
      "node_id": "PRRC_kwDOABII585xsDYD",
      "diff_hunk": "@@ -0,0 +1,48 @@\n+// Copyright (c) 2024-present The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#ifndef BITCOIN_KERNEL_CACHES_H\n+#define BITCOIN_KERNEL_CACHES_H\n+\n+#include <util/check.h>\n+\n+#include <algorithm>\n+#include <bit>\n+#include <cstdint>\n+#include <limits>\n+\n+//! Suggested default amount of cache reserved for the kernel (MiB)\n+static constexpr int64_t DEFAULT_KERNEL_CACHE{450};\n+//! Max memory allocated to block tree DB specific cache (MiB)\n+static constexpr int64_t MAX_BLOCK_DB_CACHE{2};\n+//! Max memory allocated to coin DB specific cache (MiB)\n+static constexpr int64_t MAX_COINS_DB_CACHE{8};\n+\n+//! Guard against truncation of values before converting.\n+constexpr size_t MiBToBytes(int64_t mib)",
      "path": "src/kernel/caches.h",
      "position": null,
      "original_position": 23,
      "commit_id": "2a92702bafca5c78b270a9502a22cb9deac02cfc",
      "original_commit_id": "578654c686e394d08bac7c3bcddbfd90b46eaa62",
      "in_reply_to_id": 1907267762,
      "user": {
        "login": "TheCharlatan",
        "id": 8421793,
        "node_id": "MDQ6VXNlcjg0MjE3OTM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8421793?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/TheCharlatan",
        "html_url": "https://github.com/TheCharlatan",
        "followers_url": "https://api.github.com/users/TheCharlatan/followers",
        "following_url": "https://api.github.com/users/TheCharlatan/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/TheCharlatan/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/TheCharlatan/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/TheCharlatan/subscriptions",
        "organizations_url": "https://api.github.com/users/TheCharlatan/orgs",
        "repos_url": "https://api.github.com/users/TheCharlatan/repos",
        "events_url": "https://api.github.com/users/TheCharlatan/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/TheCharlatan/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": ">  allowing compile-time guarantees that we're not overflowing the system's size_t size. \r\n\r\nI'm not sure that is actually true. Does this actually guard against any possible overflow?",
      "created_at": "2025-01-08T15:28:27Z",
      "updated_at": "2025-01-08T15:28:27Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31483#discussion_r1907373571",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1907373571"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31483"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 23,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1907385011",
      "pull_request_review_id": 2537494524,
      "id": 1907385011,
      "node_id": "PRRC_kwDOABII585xsGKz",
      "diff_hunk": "@@ -6,28 +6,42 @@\n \n #include <common/args.h>\n #include <index/txindex.h>\n-#include <txdb.h>\n+#include <kernel/caches.h>\n+#include <logging.h>\n+\n+#include <algorithm>\n+#include <optional>\n+#include <string>\n+\n+// Unlike for the UTXO database, for the txindex scenario the leveldb cache make\n+// a meaningful difference: https://github.com/bitcoin/bitcoin/pull/8273#issuecomment-229601991\n+//! Max memory allocated to tx index DB specific cache in MiB.\n+static constexpr int64_t MAX_TX_INDEX_CACHE{1024};\n+//! Max memory allocated to all block filter index caches combined in MiB.\n+static constexpr int64_t MAX_FILTER_INDEX_CACHE{1024};\n \n namespace node {\n-CacheSizes CalculateCacheSizes(const ArgsManager& args, size_t n_indexes)\n+std::optional<CacheSizes> CalculateCacheSizes(const ArgsManager& args, size_t n_indexes)\n {\n-    int64_t nTotalCache = (args.GetIntArg(\"-dbcache\", nDefaultDbCache) << 20);\n-    nTotalCache = std::max(nTotalCache, nMinDbCache << 20); // total cache cannot be less than nMinDbCache\n-    CacheSizes sizes;\n-    sizes.block_tree_db = std::min(nTotalCache / 8, nMaxBlockDBCache << 20);\n-    nTotalCache -= sizes.block_tree_db;\n-    sizes.tx_index = std::min(nTotalCache / 8, args.GetBoolArg(\"-txindex\", DEFAULT_TXINDEX) ? nMaxTxIndexCache << 20 : 0);\n-    nTotalCache -= sizes.tx_index;\n-    sizes.filter_index = 0;\n+    int64_t db_cache = args.GetIntArg(\"-dbcache\", DEFAULT_DB_CACHE);\n+    if (static_cast<uint64_t>(db_cache << 20) > std::numeric_limits<size_t>::max()) {\n+        LogWarning(\"Cannot allocate more than %d MiB in total for db caches.\", static_cast<double>(std::numeric_limits<size_t>::max()) * (1.0 / 1024 / 1024));\n+        return std::nullopt;\n+    }",
      "path": "src/node/caches.cpp",
      "position": null,
      "original_position": 35,
      "commit_id": "2a92702bafca5c78b270a9502a22cb9deac02cfc",
      "original_commit_id": "578654c686e394d08bac7c3bcddbfd90b46eaa62",
      "in_reply_to_id": 1907214794,
      "user": {
        "login": "stickies-v",
        "id": 69010457,
        "node_id": "MDQ6VXNlcjY5MDEwNDU3",
        "avatar_url": "https://avatars.githubusercontent.com/u/69010457?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stickies-v",
        "html_url": "https://github.com/stickies-v",
        "followers_url": "https://api.github.com/users/stickies-v/followers",
        "following_url": "https://api.github.com/users/stickies-v/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stickies-v/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stickies-v/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stickies-v/subscriptions",
        "organizations_url": "https://api.github.com/users/stickies-v/orgs",
        "repos_url": "https://api.github.com/users/stickies-v/repos",
        "events_url": "https://api.github.com/users/stickies-v/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stickies-v/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "> This is only relevant on machines where size_t is not a uint64_t, so I'm not surprised this is optimized away.\r\n\r\nIt seems to me like this check is necessary on all platforms? E.g. on this branch, when I run with `-dbcache=10000000000000000` on arm64 I get\r\n\r\n```\r\n../../src/kernel/caches.h:25 MiBToBytes: Assertion `std::countl_zero(static_cast<uint64_t>(mib)) >= 21' failed.\r\n```\r\n\r\nIn `static_cast<uint64_t>(db_cache << 20)` we're left-shifting `db_cache` without checking that it'll fit the `uint64_t`. I think my approach suggested in https://github.com/bitcoin/bitcoin/pull/31483#discussion_r1907267762 addresses all of this quite nicely?",
      "created_at": "2025-01-08T15:36:08Z",
      "updated_at": "2025-01-08T15:36:20Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31483#discussion_r1907385011",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1907385011"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31483"
        }
      },
      "start_line": null,
      "original_start_line": 27,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 32,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1907407674",
      "pull_request_review_id": 2537532893,
      "id": 1907407674,
      "node_id": "PRRC_kwDOABII585xsLs6",
      "diff_hunk": "@@ -0,0 +1,48 @@\n+// Copyright (c) 2024-present The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#ifndef BITCOIN_KERNEL_CACHES_H\n+#define BITCOIN_KERNEL_CACHES_H\n+\n+#include <util/check.h>\n+\n+#include <algorithm>\n+#include <bit>\n+#include <cstdint>\n+#include <limits>\n+\n+//! Suggested default amount of cache reserved for the kernel (MiB)\n+static constexpr int64_t DEFAULT_KERNEL_CACHE{450};\n+//! Max memory allocated to block tree DB specific cache (MiB)\n+static constexpr int64_t MAX_BLOCK_DB_CACHE{2};\n+//! Max memory allocated to coin DB specific cache (MiB)\n+static constexpr int64_t MAX_COINS_DB_CACHE{8};\n+\n+//! Guard against truncation of values before converting.\n+constexpr size_t MiBToBytes(int64_t mib)",
      "path": "src/kernel/caches.h",
      "position": null,
      "original_position": 23,
      "commit_id": "2a92702bafca5c78b270a9502a22cb9deac02cfc",
      "original_commit_id": "578654c686e394d08bac7c3bcddbfd90b46eaa62",
      "in_reply_to_id": 1907267762,
      "user": {
        "login": "stickies-v",
        "id": 69010457,
        "node_id": "MDQ6VXNlcjY5MDEwNDU3",
        "avatar_url": "https://avatars.githubusercontent.com/u/69010457?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stickies-v",
        "html_url": "https://github.com/stickies-v",
        "followers_url": "https://api.github.com/users/stickies-v/followers",
        "following_url": "https://api.github.com/users/stickies-v/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stickies-v/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stickies-v/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stickies-v/subscriptions",
        "organizations_url": "https://api.github.com/users/stickies-v/orgs",
        "repos_url": "https://api.github.com/users/stickies-v/repos",
        "events_url": "https://api.github.com/users/stickies-v/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stickies-v/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "I'm not sure what the guarantees are, but at least on my machine, with `static constexpr size_t MAX_FILTER_INDEX_CACHE{18446744073709551616};` (i.e. max + 1 on 64 bit) compilation fails with:\r\n\r\n```\r\n../../src/node/caches.cpp:22:48: error: integer literal is too large to be represented in any integer type\r\nstatic constexpr size_t MAX_FILTER_INDEX_CACHE{18446744073709551616};\r\n                                               ^\r\n1 error generated.\r\n```\r\n\r\nSimilarly, for `static constexpr uint8_t TEST_8{266};` it fails with:\r\n\r\n```\r\n../../src/node/caches.cpp:23:33: error: constant expression evaluates to 266 which cannot be narrowed to type 'uint8_t' (aka 'unsigned char') [-Wc++11-narrowing]\r\nstatic constexpr uint8_t TEST_8{266};\r\n                                ^~~\r\n../../src/node/caches.cpp:23:33: note: insert an explicit cast to silence this issue\r\nstatic constexpr uint8_t TEST_8{266};\r\n                                ^~~\r\n                                static_cast<uint8_t>( )\r\n../../src/node/caches.cpp:23:33: warning: implicit conversion from 'int' to 'const uint8_t' (aka 'const unsigned char') changes value from 266 to 10 [-Wconstant-conversion]\r\nstatic constexpr uint8_t TEST_8{266};\r\n                               ~^~~\r\n1 warning and 1 error generated.\r\n```",
      "created_at": "2025-01-08T15:51:01Z",
      "updated_at": "2025-01-08T15:51:01Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31483#discussion_r1907407674",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1907407674"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31483"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 23,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1907547564",
      "pull_request_review_id": 2537765524,
      "id": 1907547564,
      "node_id": "PRRC_kwDOABII585xst2s",
      "diff_hunk": "@@ -0,0 +1,48 @@\n+// Copyright (c) 2024-present The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#ifndef BITCOIN_KERNEL_CACHES_H\n+#define BITCOIN_KERNEL_CACHES_H\n+\n+#include <util/check.h>\n+\n+#include <algorithm>\n+#include <bit>\n+#include <cstdint>\n+#include <limits>\n+\n+//! Suggested default amount of cache reserved for the kernel (MiB)\n+static constexpr int64_t DEFAULT_KERNEL_CACHE{450};\n+//! Max memory allocated to block tree DB specific cache (MiB)\n+static constexpr int64_t MAX_BLOCK_DB_CACHE{2};\n+//! Max memory allocated to coin DB specific cache (MiB)\n+static constexpr int64_t MAX_COINS_DB_CACHE{8};\n+\n+//! Guard against truncation of values before converting.\n+constexpr size_t MiBToBytes(int64_t mib)",
      "path": "src/kernel/caches.h",
      "position": null,
      "original_position": 23,
      "commit_id": "2a92702bafca5c78b270a9502a22cb9deac02cfc",
      "original_commit_id": "578654c686e394d08bac7c3bcddbfd90b46eaa62",
      "in_reply_to_id": 1907267762,
      "user": {
        "login": "TheCharlatan",
        "id": 8421793,
        "node_id": "MDQ6VXNlcjg0MjE3OTM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8421793?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/TheCharlatan",
        "html_url": "https://github.com/TheCharlatan",
        "followers_url": "https://api.github.com/users/TheCharlatan/followers",
        "following_url": "https://api.github.com/users/TheCharlatan/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/TheCharlatan/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/TheCharlatan/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/TheCharlatan/subscriptions",
        "organizations_url": "https://api.github.com/users/TheCharlatan/orgs",
        "repos_url": "https://api.github.com/users/TheCharlatan/repos",
        "events_url": "https://api.github.com/users/TheCharlatan/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/TheCharlatan/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "I'm more concerned how the shift will be cast. E.g. a potential future bump to 3000 MiB would error:\r\n```\r\nerror: constant expression evaluates to -1149239296 which cannot be narrowed to type 'size_t' (aka 'unsigned long') [-Wc++11-narrowing]\r\n   16 | static constexpr size_t DEFAULT_KERNEL_CACHE{3000 << 20};\r\n```\r\nso to make this future proof, I think a function interpreting the values properly, or more ugly casts are required.",
      "created_at": "2025-01-08T17:29:05Z",
      "updated_at": "2025-01-08T17:29:05Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31483#discussion_r1907547564",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1907547564"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31483"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 23,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1907588881",
      "pull_request_review_id": 2537837742,
      "id": 1907588881,
      "node_id": "PRRC_kwDOABII585xs38R",
      "diff_hunk": "",
      "path": "src/node/caches.cpp",
      "position": 1,
      "original_position": 1,
      "commit_id": "578654c686e394d08bac7c3bcddbfd90b46eaa62",
      "original_commit_id": "19316eccaf93776c49b1870f8aa9a5fe57ec5f33",
      "in_reply_to_id": null,
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "In commit \"init: Simplify coinsdb cache calculation\" (19316eccaf93776c49b1870f8aa9a5fe57ec5f33)\r\n\r\nDidn't notice this first time I reviewed this, but it would be good if commit subject included \"refactor\" and make it obvious this is not changing behavior. This simplification is only changing the way the calculation is performed, not changing the result of the calculation.",
      "created_at": "2025-01-08T18:02:46Z",
      "updated_at": "2025-01-08T18:51:00Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31483#discussion_r1907588881",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1907588881"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31483"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 1,
      "original_line": 1,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1907604163",
      "pull_request_review_id": 2537837742,
      "id": 1907604163,
      "node_id": "PRRC_kwDOABII585xs7rD",
      "diff_hunk": "@@ -24,8 +24,7 @@ CacheSizes CalculateCacheSizes(const ArgsManager& args, size_t n_indexes)\n         sizes.filter_index = max_cache / n_indexes;\n         nTotalCache -= sizes.filter_index * n_indexes;\n     }\n-    sizes.coins_db = std::min(nTotalCache / 2, (nTotalCache / 4) + (1 << 23)); // use 25%-50% of the remainder for disk cache\n-    sizes.coins_db = std::min(sizes.coins_db, nMaxCoinsDBCache << 20); // cap total coins db cache",
      "path": "src/node/caches.cpp",
      "position": 50,
      "original_position": 5,
      "commit_id": "2a92702bafca5c78b270a9502a22cb9deac02cfc",
      "original_commit_id": "c71fc6ac6e62e5eea96e8aa4e0f43260afc81723",
      "in_reply_to_id": 1890537379,
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "To be pedantic, old calculation could only be useful if nMaxCoinsDBCache was *higher* not lower than 8 MiB. As long as it is 8MiB or lower this commit does not change behavior.\r\n\r\nIn #6102 the coins_db cache size was set to min(50% total cache size, 8MiB + 25% total cache size). But then in #8273 it was capped to nMaxCoinsDBCache, so as long as nMaxCoinsDBCache <= 8 MiB, this is just equivalent to min(50% total cache size, nMaxCoinsDBCache)\r\n\r\n",
      "created_at": "2025-01-08T18:16:32Z",
      "updated_at": "2025-01-08T18:51:00Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31483#discussion_r1907604163",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1907604163"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31483"
        }
      },
      "start_line": 27,
      "original_start_line": 27,
      "start_side": "LEFT",
      "line": 28,
      "original_line": 28,
      "side": "LEFT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1907618229",
      "pull_request_review_id": 2537837742,
      "id": 1907618229,
      "node_id": "PRRC_kwDOABII585xs_G1",
      "diff_hunk": "@@ -0,0 +1,42 @@\n+// Copyright (c) 2024-present The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#ifndef BITCOIN_KERNEL_CACHES_H\n+#define BITCOIN_KERNEL_CACHES_H\n+\n+#include <txdb.h>\n+#include <util/check.h>\n+\n+#include <algorithm>\n+#include <bit>\n+#include <cstdint>\n+#include <limits>\n+\n+//! Guard against truncation of values before converting.\n+constexpr size_t MiBToBytes(int64_t mib)\n+{\n+    Assert(std::countl_zero(static_cast<uint64_t>(mib)) >= 21); // Ensure sign bit is unset + enough zeros to shift.\n+    const int64_t bytes{mib << 20};\n+    Assert(static_cast<uint64_t>(bytes) <= std::numeric_limits<size_t>::max());\n+    return static_cast<size_t>(bytes);",
      "path": "src/kernel/caches.h",
      "position": null,
      "original_position": 22,
      "commit_id": "2a92702bafca5c78b270a9502a22cb9deac02cfc",
      "original_commit_id": "41bc7164880ffd0782ff5882211c4fcadd656022",
      "in_reply_to_id": null,
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "In commit \"kernel: Move kernel-specific cache size options to kernel\" (41bc7164880ffd0782ff5882211c4fcadd656022)\r\n\r\nThis seems like it is overthinking things. I think this should just be:\r\n\r\n```c++\r\nAssert(mib >= 0);\r\nAssert(mib <= std::numeric_limits<size_t>::max() >> 20);\r\nreturn mib << 20;\r\n```",
      "created_at": "2025-01-08T18:27:21Z",
      "updated_at": "2025-01-08T18:51:00Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31483#discussion_r1907618229",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1907618229"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31483"
        }
      },
      "start_line": null,
      "original_start_line": 19,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 22,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1907639861",
      "pull_request_review_id": 2537837742,
      "id": 1907639861,
      "node_id": "PRRC_kwDOABII585xtEY1",
      "diff_hunk": "@@ -0,0 +1,48 @@\n+// Copyright (c) 2024-present The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#ifndef BITCOIN_KERNEL_CACHES_H\n+#define BITCOIN_KERNEL_CACHES_H\n+\n+#include <util/check.h>\n+\n+#include <algorithm>\n+#include <bit>\n+#include <cstdint>\n+#include <limits>\n+\n+//! Suggested default amount of cache reserved for the kernel (MiB)\n+static constexpr int64_t DEFAULT_KERNEL_CACHE{450};\n+//! Max memory allocated to block tree DB specific cache (MiB)\n+static constexpr int64_t MAX_BLOCK_DB_CACHE{2};\n+//! Max memory allocated to coin DB specific cache (MiB)\n+static constexpr int64_t MAX_COINS_DB_CACHE{8};\n+\n+//! Guard against truncation of values before converting.\n+constexpr size_t MiBToBytes(int64_t mib)",
      "path": "src/kernel/caches.h",
      "position": null,
      "original_position": 23,
      "commit_id": "2a92702bafca5c78b270a9502a22cb9deac02cfc",
      "original_commit_id": "578654c686e394d08bac7c3bcddbfd90b46eaa62",
      "in_reply_to_id": 1907068544,
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "re: https://github.com/bitcoin/bitcoin/pull/31483#discussion_r1907068544\r\n\r\n> and adds a test case\r\n\r\nI don't think I see a new test case added in the diff. Is it missing?\r\n\r\nAnother way to make this testable without adding interface complexity would just be to throw std::overflow_error",
      "created_at": "2025-01-08T18:42:59Z",
      "updated_at": "2025-01-08T18:51:00Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31483#discussion_r1907639861",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1907639861"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31483"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 23,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1907647674",
      "pull_request_review_id": 2537837742,
      "id": 1907647674,
      "node_id": "PRRC_kwDOABII585xtGS6",
      "diff_hunk": "@@ -6,28 +6,42 @@\n \n #include <common/args.h>\n #include <index/txindex.h>\n-#include <txdb.h>\n+#include <kernel/caches.h>\n+#include <logging.h>\n+\n+#include <algorithm>\n+#include <optional>\n+#include <string>\n+\n+// Unlike for the UTXO database, for the txindex scenario the leveldb cache make\n+// a meaningful difference: https://github.com/bitcoin/bitcoin/pull/8273#issuecomment-229601991\n+//! Max memory allocated to tx index DB specific cache in MiB.\n+static constexpr int64_t MAX_TX_INDEX_CACHE{1024};\n+//! Max memory allocated to all block filter index caches combined in MiB.\n+static constexpr int64_t MAX_FILTER_INDEX_CACHE{1024};\n \n namespace node {\n-CacheSizes CalculateCacheSizes(const ArgsManager& args, size_t n_indexes)\n+std::optional<CacheSizes> CalculateCacheSizes(const ArgsManager& args, size_t n_indexes)\n {\n-    int64_t nTotalCache = (args.GetIntArg(\"-dbcache\", nDefaultDbCache) << 20);\n-    nTotalCache = std::max(nTotalCache, nMinDbCache << 20); // total cache cannot be less than nMinDbCache\n-    CacheSizes sizes;\n-    sizes.block_tree_db = std::min(nTotalCache / 8, nMaxBlockDBCache << 20);\n-    nTotalCache -= sizes.block_tree_db;\n-    sizes.tx_index = std::min(nTotalCache / 8, args.GetBoolArg(\"-txindex\", DEFAULT_TXINDEX) ? nMaxTxIndexCache << 20 : 0);\n-    nTotalCache -= sizes.tx_index;\n-    sizes.filter_index = 0;\n+    int64_t db_cache = args.GetIntArg(\"-dbcache\", DEFAULT_DB_CACHE);\n+    if (static_cast<uint64_t>(db_cache << 20) > std::numeric_limits<size_t>::max()) {\n+        LogWarning(\"Cannot allocate more than %d MiB in total for db caches.\", static_cast<double>(std::numeric_limits<size_t>::max()) * (1.0 / 1024 / 1024));\n+        return std::nullopt;\n+    }",
      "path": "src/node/caches.cpp",
      "position": null,
      "original_position": 35,
      "commit_id": "2a92702bafca5c78b270a9502a22cb9deac02cfc",
      "original_commit_id": "578654c686e394d08bac7c3bcddbfd90b46eaa62",
      "in_reply_to_id": 1907214794,
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "re: https://github.com/bitcoin/bitcoin/pull/31483#discussion_r1907214794\r\n\r\nAgree with stickies overflow should be fixed. I think an easy way would just be to check if `db_cache > std::numeric_limits<size_t>::max() >> 20` though. ",
      "created_at": "2025-01-08T18:49:47Z",
      "updated_at": "2025-01-08T18:51:00Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31483#discussion_r1907647674",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1907647674"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31483"
        }
      },
      "start_line": null,
      "original_start_line": 27,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 32,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1908409725",
      "pull_request_review_id": 2539222413,
      "id": 1908409725,
      "node_id": "PRRC_kwDOABII585xwAV9",
      "diff_hunk": "@@ -0,0 +1,48 @@\n+// Copyright (c) 2024-present The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#ifndef BITCOIN_KERNEL_CACHES_H\n+#define BITCOIN_KERNEL_CACHES_H\n+\n+#include <util/check.h>\n+\n+#include <algorithm>\n+#include <bit>\n+#include <cstdint>\n+#include <limits>\n+\n+//! Suggested default amount of cache reserved for the kernel (MiB)\n+static constexpr int64_t DEFAULT_KERNEL_CACHE{450};\n+//! Max memory allocated to block tree DB specific cache (MiB)\n+static constexpr int64_t MAX_BLOCK_DB_CACHE{2};\n+//! Max memory allocated to coin DB specific cache (MiB)\n+static constexpr int64_t MAX_COINS_DB_CACHE{8};\n+\n+//! Guard against truncation of values before converting.\n+constexpr size_t MiBToBytes(int64_t mib)\n+{\n+    Assert(std::countl_zero(static_cast<uint64_t>(mib)) >= 21); // Ensure sign bit is unset + enough zeros to shift.",
      "path": "src/kernel/caches.h",
      "position": null,
      "original_position": 25,
      "commit_id": "2a92702bafca5c78b270a9502a22cb9deac02cfc",
      "original_commit_id": "578654c686e394d08bac7c3bcddbfd90b46eaa62",
      "in_reply_to_id": 1907055901,
      "user": {
        "login": "hodlinator",
        "id": 172445034,
        "node_id": "U_kgDOCkdNag",
        "avatar_url": "https://avatars.githubusercontent.com/u/172445034?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/hodlinator",
        "html_url": "https://github.com/hodlinator",
        "followers_url": "https://api.github.com/users/hodlinator/followers",
        "following_url": "https://api.github.com/users/hodlinator/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/hodlinator/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/hodlinator/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/hodlinator/subscriptions",
        "organizations_url": "https://api.github.com/users/hodlinator/orgs",
        "repos_url": "https://api.github.com/users/hodlinator/repos",
        "events_url": "https://api.github.com/users/hodlinator/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/hodlinator/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "Tried compiling a `static_assert` with `mib` replaced by `-1`. Got the expected result from the sign bit:\r\n```\r\n/home/hodlinator/bitcoin/src/bitcoind.cpp:164:63: error: static assertion failed\r\n  164 |     static_assert(std::countl_zero(static_cast<uint64_t>(-1)) >= 21);\r\n      |                   ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~\r\n/home/hodlinator/bitcoin/src/bitcoind.cpp:164:63: note: the comparison reduces to ‘(0 >= 21)’\r\n```\r\nEdit: The sign bit is referring to the `mib` variable, and that bit position does not become unset just from casting.",
      "created_at": "2025-01-09T09:18:03Z",
      "updated_at": "2025-01-09T09:33:02Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31483#discussion_r1908409725",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1908409725"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31483"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 25,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1908477798",
      "pull_request_review_id": 2539400981,
      "id": 1908477798,
      "node_id": "PRRC_kwDOABII585xwQ9m",
      "diff_hunk": "@@ -0,0 +1,48 @@\n+// Copyright (c) 2024-present The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#ifndef BITCOIN_KERNEL_CACHES_H\n+#define BITCOIN_KERNEL_CACHES_H\n+\n+#include <util/check.h>\n+\n+#include <algorithm>\n+#include <bit>\n+#include <cstdint>\n+#include <limits>\n+\n+//! Suggested default amount of cache reserved for the kernel (MiB)\n+static constexpr int64_t DEFAULT_KERNEL_CACHE{450};\n+//! Max memory allocated to block tree DB specific cache (MiB)\n+static constexpr int64_t MAX_BLOCK_DB_CACHE{2};\n+//! Max memory allocated to coin DB specific cache (MiB)\n+static constexpr int64_t MAX_COINS_DB_CACHE{8};\n+\n+//! Guard against truncation of values before converting.\n+constexpr size_t MiBToBytes(int64_t mib)\n+{\n+    Assert(std::countl_zero(static_cast<uint64_t>(mib)) >= 21); // Ensure sign bit is unset + enough zeros to shift.",
      "path": "src/kernel/caches.h",
      "position": null,
      "original_position": 25,
      "commit_id": "2a92702bafca5c78b270a9502a22cb9deac02cfc",
      "original_commit_id": "578654c686e394d08bac7c3bcddbfd90b46eaa62",
      "in_reply_to_id": 1907055901,
      "user": {
        "login": "stickies-v",
        "id": 69010457,
        "node_id": "MDQ6VXNlcjY5MDEwNDU3",
        "avatar_url": "https://avatars.githubusercontent.com/u/69010457?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stickies-v",
        "html_url": "https://github.com/stickies-v",
        "followers_url": "https://api.github.com/users/stickies-v/followers",
        "following_url": "https://api.github.com/users/stickies-v/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stickies-v/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stickies-v/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stickies-v/subscriptions",
        "organizations_url": "https://api.github.com/users/stickies-v/orgs",
        "repos_url": "https://api.github.com/users/stickies-v/repos",
        "events_url": "https://api.github.com/users/stickies-v/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stickies-v/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "Did you hard-code the -1 literal? I don't think that holds for a variable `mib` at runtime?",
      "created_at": "2025-01-09T10:03:10Z",
      "updated_at": "2025-01-09T10:03:10Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31483#discussion_r1908477798",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1908477798"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31483"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 25,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1908520794",
      "pull_request_review_id": 2539520639,
      "id": 1908520794,
      "node_id": "PRRC_kwDOABII585xwbda",
      "diff_hunk": "@@ -0,0 +1,48 @@\n+// Copyright (c) 2024-present The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#ifndef BITCOIN_KERNEL_CACHES_H\n+#define BITCOIN_KERNEL_CACHES_H\n+\n+#include <util/check.h>\n+\n+#include <algorithm>\n+#include <bit>\n+#include <cstdint>\n+#include <limits>\n+\n+//! Suggested default amount of cache reserved for the kernel (MiB)\n+static constexpr int64_t DEFAULT_KERNEL_CACHE{450};\n+//! Max memory allocated to block tree DB specific cache (MiB)\n+static constexpr int64_t MAX_BLOCK_DB_CACHE{2};\n+//! Max memory allocated to coin DB specific cache (MiB)\n+static constexpr int64_t MAX_COINS_DB_CACHE{8};\n+\n+//! Guard against truncation of values before converting.\n+constexpr size_t MiBToBytes(int64_t mib)\n+{\n+    Assert(std::countl_zero(static_cast<uint64_t>(mib)) >= 21); // Ensure sign bit is unset + enough zeros to shift.",
      "path": "src/kernel/caches.h",
      "position": null,
      "original_position": 25,
      "commit_id": "2a92702bafca5c78b270a9502a22cb9deac02cfc",
      "original_commit_id": "578654c686e394d08bac7c3bcddbfd90b46eaa62",
      "in_reply_to_id": 1907055901,
      "user": {
        "login": "hodlinator",
        "id": 172445034,
        "node_id": "U_kgDOCkdNag",
        "avatar_url": "https://avatars.githubusercontent.com/u/172445034?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/hodlinator",
        "html_url": "https://github.com/hodlinator",
        "followers_url": "https://api.github.com/users/hodlinator/followers",
        "following_url": "https://api.github.com/users/hodlinator/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/hodlinator/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/hodlinator/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/hodlinator/subscriptions",
        "organizations_url": "https://api.github.com/users/hodlinator/orgs",
        "repos_url": "https://api.github.com/users/hodlinator/repos",
        "events_url": "https://api.github.com/users/hodlinator/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/hodlinator/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "Yes, I hard-coded the literal into the `static_assert` above. What part of integer arithmetic and casting changes when done in a runtime context?",
      "created_at": "2025-01-09T10:35:18Z",
      "updated_at": "2025-01-09T10:35:18Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31483#discussion_r1908520794",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1908520794"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31483"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 25,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1908525582",
      "pull_request_review_id": 2539534342,
      "id": 1908525582,
      "node_id": "PRRC_kwDOABII585xwcoO",
      "diff_hunk": "@@ -0,0 +1,48 @@\n+// Copyright (c) 2024-present The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#ifndef BITCOIN_KERNEL_CACHES_H\n+#define BITCOIN_KERNEL_CACHES_H\n+\n+#include <util/check.h>\n+\n+#include <algorithm>\n+#include <bit>\n+#include <cstdint>\n+#include <limits>\n+\n+//! Suggested default amount of cache reserved for the kernel (MiB)\n+static constexpr int64_t DEFAULT_KERNEL_CACHE{450};\n+//! Max memory allocated to block tree DB specific cache (MiB)\n+static constexpr int64_t MAX_BLOCK_DB_CACHE{2};\n+//! Max memory allocated to coin DB specific cache (MiB)\n+static constexpr int64_t MAX_COINS_DB_CACHE{8};\n+\n+//! Guard against truncation of values before converting.\n+constexpr size_t MiBToBytes(int64_t mib)\n+{\n+    Assert(std::countl_zero(static_cast<uint64_t>(mib)) >= 21); // Ensure sign bit is unset + enough zeros to shift.",
      "path": "src/kernel/caches.h",
      "position": null,
      "original_position": 25,
      "commit_id": "2a92702bafca5c78b270a9502a22cb9deac02cfc",
      "original_commit_id": "578654c686e394d08bac7c3bcddbfd90b46eaa62",
      "in_reply_to_id": 1907055901,
      "user": {
        "login": "hodlinator",
        "id": 172445034,
        "node_id": "U_kgDOCkdNag",
        "avatar_url": "https://avatars.githubusercontent.com/u/172445034?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/hodlinator",
        "html_url": "https://github.com/hodlinator",
        "followers_url": "https://api.github.com/users/hodlinator/followers",
        "following_url": "https://api.github.com/users/hodlinator/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/hodlinator/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/hodlinator/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/hodlinator/subscriptions",
        "organizations_url": "https://api.github.com/users/hodlinator/orgs",
        "repos_url": "https://api.github.com/users/hodlinator/repos",
        "events_url": "https://api.github.com/users/hodlinator/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/hodlinator/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "Even if the assert is correct, maybe the fact that this thread exists is justification enough for replacing it with something closer to what it was originally. Like https://github.com/bitcoin/bitcoin/pull/31483#discussion_r1907618229",
      "created_at": "2025-01-09T10:39:04Z",
      "updated_at": "2025-01-09T10:39:04Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31483#discussion_r1908525582",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1908525582"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31483"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 25,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1908583360",
      "pull_request_review_id": 2539630095,
      "id": 1908583360,
      "node_id": "PRRC_kwDOABII585xwqvA",
      "diff_hunk": "@@ -0,0 +1,48 @@\n+// Copyright (c) 2024-present The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#ifndef BITCOIN_KERNEL_CACHES_H\n+#define BITCOIN_KERNEL_CACHES_H\n+\n+#include <util/check.h>\n+\n+#include <algorithm>\n+#include <bit>\n+#include <cstdint>\n+#include <limits>\n+\n+//! Suggested default amount of cache reserved for the kernel (MiB)\n+static constexpr int64_t DEFAULT_KERNEL_CACHE{450};\n+//! Max memory allocated to block tree DB specific cache (MiB)\n+static constexpr int64_t MAX_BLOCK_DB_CACHE{2};\n+//! Max memory allocated to coin DB specific cache (MiB)\n+static constexpr int64_t MAX_COINS_DB_CACHE{8};\n+\n+//! Guard against truncation of values before converting.\n+constexpr size_t MiBToBytes(int64_t mib)",
      "path": "src/kernel/caches.h",
      "position": null,
      "original_position": 23,
      "commit_id": "2a92702bafca5c78b270a9502a22cb9deac02cfc",
      "original_commit_id": "578654c686e394d08bac7c3bcddbfd90b46eaa62",
      "in_reply_to_id": 1907267762,
      "user": {
        "login": "stickies-v",
        "id": 69010457,
        "node_id": "MDQ6VXNlcjY5MDEwNDU3",
        "avatar_url": "https://avatars.githubusercontent.com/u/69010457?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stickies-v",
        "html_url": "https://github.com/stickies-v",
        "followers_url": "https://api.github.com/users/stickies-v/followers",
        "following_url": "https://api.github.com/users/stickies-v/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stickies-v/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stickies-v/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stickies-v/subscriptions",
        "organizations_url": "https://api.github.com/users/stickies-v/orgs",
        "repos_url": "https://api.github.com/users/stickies-v/repos",
        "events_url": "https://api.github.com/users/stickies-v/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stickies-v/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "Hmm, you raise a good point. I see two alternatives:\r\n1) The low-code solution: when values get problematic (which is pretty infrequent, and constant), write them as one of follows:\r\n\r\n```c++\r\nstatic constexpr size_t DEFAULT_KERNEL_CACHE{3145728000};\r\nstatic_assert(DEFAULT_KERNEL_CACHE >> 20 == 3000);\r\n```\r\n\r\nor \r\n\r\n```c++\r\nstatic constexpr size_t DEFAULT_KERNEL_CACHE{size_t{3000} << 20};\r\nstatic_assert(DEFAULT_KERNEL_CACHE >> 20 == 3000);\r\n```\r\n\r\n\r\n2) instead of adding a `MiBToBytes` function, add a `template <typename T> constexpr T CheckedLeftShift(T value, unsigned shift)` function to `util/overflow.h` which can more generally be re-used?\r\n\r\n```c++\r\nstatic constexpr uint32_t DEFAULT_KERNEL_CACHE{CheckedLeftShift<uint32_t>(3000, 20)};\r\n\r\n...\r\n\r\ntemplate <typename T>\r\nconstexpr T CheckedLeftShift(T value, unsigned shift)\r\n{\r\n    static_assert(std::is_unsigned_v<T>, \r\n                  \"CheckedLeftShift requires an unsigned type\");\r\n\r\n    if (shift >= std::numeric_limits<T>::digits) {\r\n        throw std::overflow_error(\"shift out of range\");\r\n    }\r\n\r\n    if (value > (std::numeric_limits<T>::max() >> shift)) {\r\n        throw std::overflow_error(\"shift would overflow\");\r\n    }\r\n\r\n    return static_cast<T>(value << shift);\r\n}\r\n```",
      "created_at": "2025-01-09T11:11:27Z",
      "updated_at": "2025-01-09T11:11:27Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31483#discussion_r1908583360",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1908583360"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31483"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 23,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1908587275",
      "pull_request_review_id": 2539634960,
      "id": 1908587275,
      "node_id": "PRRC_kwDOABII585xwrsL",
      "diff_hunk": "@@ -0,0 +1,48 @@\n+// Copyright (c) 2024-present The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#ifndef BITCOIN_KERNEL_CACHES_H\n+#define BITCOIN_KERNEL_CACHES_H\n+\n+#include <util/check.h>\n+\n+#include <algorithm>\n+#include <bit>\n+#include <cstdint>\n+#include <limits>\n+\n+//! Suggested default amount of cache reserved for the kernel (MiB)\n+static constexpr int64_t DEFAULT_KERNEL_CACHE{450};\n+//! Max memory allocated to block tree DB specific cache (MiB)\n+static constexpr int64_t MAX_BLOCK_DB_CACHE{2};\n+//! Max memory allocated to coin DB specific cache (MiB)\n+static constexpr int64_t MAX_COINS_DB_CACHE{8};\n+\n+//! Guard against truncation of values before converting.\n+constexpr size_t MiBToBytes(int64_t mib)",
      "path": "src/kernel/caches.h",
      "position": null,
      "original_position": 23,
      "commit_id": "2a92702bafca5c78b270a9502a22cb9deac02cfc",
      "original_commit_id": "578654c686e394d08bac7c3bcddbfd90b46eaa62",
      "in_reply_to_id": 1907068544,
      "user": {
        "login": "stickies-v",
        "id": 69010457,
        "node_id": "MDQ6VXNlcjY5MDEwNDU3",
        "avatar_url": "https://avatars.githubusercontent.com/u/69010457?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stickies-v",
        "html_url": "https://github.com/stickies-v",
        "followers_url": "https://api.github.com/users/stickies-v/followers",
        "following_url": "https://api.github.com/users/stickies-v/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stickies-v/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stickies-v/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stickies-v/subscriptions",
        "organizations_url": "https://api.github.com/users/stickies-v/orgs",
        "repos_url": "https://api.github.com/users/stickies-v/repos",
        "events_url": "https://api.github.com/users/stickies-v/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stickies-v/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "> I don't think I see a new test case added in the diff. Is it missing?\r\n\r\nSnap, they weren't included in my `git diff` because they were added in a new file, and I didn't notice, sorry. I see @TheCharlatan already added a test case in his latest push.",
      "created_at": "2025-01-09T11:13:39Z",
      "updated_at": "2025-01-09T11:13:39Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31483#discussion_r1908587275",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1908587275"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31483"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 23,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1908602680",
      "pull_request_review_id": 2539654304,
      "id": 1908602680,
      "node_id": "PRRC_kwDOABII585xwvc4",
      "diff_hunk": "@@ -0,0 +1,48 @@\n+// Copyright (c) 2024-present The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#ifndef BITCOIN_KERNEL_CACHES_H\n+#define BITCOIN_KERNEL_CACHES_H\n+\n+#include <util/check.h>\n+\n+#include <algorithm>\n+#include <bit>\n+#include <cstdint>\n+#include <limits>\n+\n+//! Suggested default amount of cache reserved for the kernel (MiB)\n+static constexpr int64_t DEFAULT_KERNEL_CACHE{450};\n+//! Max memory allocated to block tree DB specific cache (MiB)\n+static constexpr int64_t MAX_BLOCK_DB_CACHE{2};\n+//! Max memory allocated to coin DB specific cache (MiB)\n+static constexpr int64_t MAX_COINS_DB_CACHE{8};\n+\n+//! Guard against truncation of values before converting.\n+constexpr size_t MiBToBytes(int64_t mib)\n+{\n+    Assert(std::countl_zero(static_cast<uint64_t>(mib)) >= 21); // Ensure sign bit is unset + enough zeros to shift.",
      "path": "src/kernel/caches.h",
      "position": null,
      "original_position": 25,
      "commit_id": "2a92702bafca5c78b270a9502a22cb9deac02cfc",
      "original_commit_id": "578654c686e394d08bac7c3bcddbfd90b46eaa62",
      "in_reply_to_id": 1907055901,
      "user": {
        "login": "stickies-v",
        "id": 69010457,
        "node_id": "MDQ6VXNlcjY5MDEwNDU3",
        "avatar_url": "https://avatars.githubusercontent.com/u/69010457?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stickies-v",
        "html_url": "https://github.com/stickies-v",
        "followers_url": "https://api.github.com/users/stickies-v/followers",
        "following_url": "https://api.github.com/users/stickies-v/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stickies-v/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stickies-v/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stickies-v/subscriptions",
        "organizations_url": "https://api.github.com/users/stickies-v/orgs",
        "repos_url": "https://api.github.com/users/stickies-v/repos",
        "events_url": "https://api.github.com/users/stickies-v/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stickies-v/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "Sorry, maybe I'm misunderstanding you but I think for a run-time invocation of `MiBToBytes()` with `mib==-1` this assertion `Assert(std::countl_zero(static_cast<uint64_t>(mib)) >= 21);` would not be hit, which is different to your hard-coded static_assert expression.\r\n\r\nBut I agree that @ryanofsky's right-shifting the max approach preferable (and also what I suggested in my inlined approach in https://github.com/bitcoin/bitcoin/pull/31483#discussion_r1907267762)",
      "created_at": "2025-01-09T11:22:52Z",
      "updated_at": "2025-01-09T11:23:00Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31483#discussion_r1908602680",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1908602680"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31483"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 25,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1908758174",
      "pull_request_review_id": 2539861556,
      "id": 1908758174,
      "node_id": "PRRC_kwDOABII585xxVae",
      "diff_hunk": "@@ -0,0 +1,48 @@\n+// Copyright (c) 2024-present The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#ifndef BITCOIN_KERNEL_CACHES_H\n+#define BITCOIN_KERNEL_CACHES_H\n+\n+#include <util/check.h>\n+\n+#include <algorithm>\n+#include <bit>\n+#include <cstdint>\n+#include <limits>\n+\n+//! Suggested default amount of cache reserved for the kernel (MiB)\n+static constexpr int64_t DEFAULT_KERNEL_CACHE{450};\n+//! Max memory allocated to block tree DB specific cache (MiB)\n+static constexpr int64_t MAX_BLOCK_DB_CACHE{2};\n+//! Max memory allocated to coin DB specific cache (MiB)\n+static constexpr int64_t MAX_COINS_DB_CACHE{8};\n+\n+//! Guard against truncation of values before converting.\n+constexpr size_t MiBToBytes(int64_t mib)",
      "path": "src/kernel/caches.h",
      "position": null,
      "original_position": 23,
      "commit_id": "2a92702bafca5c78b270a9502a22cb9deac02cfc",
      "original_commit_id": "578654c686e394d08bac7c3bcddbfd90b46eaa62",
      "in_reply_to_id": 1907267762,
      "user": {
        "login": "TheCharlatan",
        "id": 8421793,
        "node_id": "MDQ6VXNlcjg0MjE3OTM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8421793?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/TheCharlatan",
        "html_url": "https://github.com/TheCharlatan",
        "followers_url": "https://api.github.com/users/TheCharlatan/followers",
        "following_url": "https://api.github.com/users/TheCharlatan/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/TheCharlatan/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/TheCharlatan/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/TheCharlatan/subscriptions",
        "organizations_url": "https://api.github.com/users/TheCharlatan/orgs",
        "repos_url": "https://api.github.com/users/TheCharlatan/repos",
        "events_url": "https://api.github.com/users/TheCharlatan/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/TheCharlatan/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "Are there places where this would be re-used? I'd be happy to add something more generic if there is demand for it.",
      "created_at": "2025-01-09T13:01:41Z",
      "updated_at": "2025-01-09T13:01:41Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31483#discussion_r1908758174",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1908758174"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31483"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 23,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1908969637",
      "pull_request_review_id": 2540166691,
      "id": 1908969637,
      "node_id": "PRRC_kwDOABII585xyJCl",
      "diff_hunk": "@@ -7,31 +7,46 @@\n #include <common/args.h>\n #include <index/txindex.h>\n #include <kernel/caches.h>\n+#include <logging.h>\n+#include <util/byte_conversion.h>\n \n #include <algorithm>\n+#include <optional>\n+#include <stdexcept>\n #include <string>\n \n // Unlike for the UTXO database, for the txindex scenario the leveldb cache make\n // a meaningful difference: https://github.com/bitcoin/bitcoin/pull/8273#issuecomment-229601991\n-//! Max memory allocated to tx index DB specific cache in MiB.\n-static constexpr int64_t MAX_TX_INDEX_CACHE{1024};\n-//! Max memory allocated to all block filter index caches combined in MiB.\n-static constexpr int64_t MAX_FILTER_INDEX_CACHE{1024};\n+//! Max memory allocated to tx index DB specific cache in bytes.\n+static constexpr size_t MAX_TX_INDEX_CACHE{MiBToBytes(1024)};\n+//! Max memory allocated to all block filter index caches combined in bytes.\n+static constexpr size_t MAX_FILTER_INDEX_CACHE{MiBToBytes(1024)};\n \n namespace node {\n-CacheSizes CalculateCacheSizes(const ArgsManager& args, size_t n_indexes)\n+std::optional<CacheSizes> CalculateCacheSizes(const ArgsManager& args, size_t n_indexes)\n {\n-    int64_t nTotalCache = (args.GetIntArg(\"-dbcache\", DEFAULT_DB_CACHE) << 20);\n-    nTotalCache = std::max(nTotalCache, MIN_DB_CACHE << 20);\n-    IndexCacheSizes sizes;\n-    sizes.tx_index = std::min(nTotalCache / 8, args.GetBoolArg(\"-txindex\", DEFAULT_TXINDEX) ? MAX_TX_INDEX_CACHE << 20 : 0);\n-    nTotalCache -= sizes.tx_index;\n-    sizes.filter_index = 0;\n+    int64_t db_cache = args.GetIntArg(\"-dbcache\", DEFAULT_DB_CACHE);\n+\n+    // negative values are permitted, but interpreted as zero.\n+    db_cache = std::max(int64_t{0}, db_cache);\n+\n+    size_t total_cache = 0;\n+    try {\n+        total_cache = std::max(MiBToBytes(db_cache), MiBToBytes(MIN_DB_CACHE));\n+    } catch (const std::out_of_range&) {\n+        LogError(\"Cannot allocate more than %d MiB in total for db caches.\", std::numeric_limits<size_t>::max() >> 20);\n+        return std::nullopt;\n+    }",
      "path": "src/node/caches.cpp",
      "position": null,
      "original_position": 44,
      "commit_id": "2a92702bafca5c78b270a9502a22cb9deac02cfc",
      "original_commit_id": "82706e217f34d1f09cbd30dde6b8ae5ac0385f0a",
      "in_reply_to_id": null,
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "In commit \"init: Use size_t consistently for cache sizes\" (82706e217f34d1f09cbd30dde6b8ae5ac0385f0a)\r\n\r\nCode could be simplified to make it clear what is causing the new error:\r\n\r\n<details><summary>diff</summary>\r\n<p>\r\n\r\n```diff\r\n--- a/src/node/caches.cpp\r\n+++ b/src/node/caches.cpp\r\n@@ -25,14 +25,10 @@ static constexpr size_t MAX_FILTER_INDEX_CACHE{MiBToBytes(1024)};\r\n namespace node {\r\n std::optional<CacheSizes> CalculateCacheSizes(const ArgsManager& args, size_t n_indexes)\r\n {\r\n-    int64_t db_cache = args.GetIntArg(\"-dbcache\", DEFAULT_DB_CACHE);\r\n-\r\n-    // negative values are permitted, but interpreted as zero.\r\n-    db_cache = std::max(int64_t{0}, db_cache);\r\n-\r\n+    const int64_t db_cache = std::max(MIN_DB_CACHE, args.GetIntArg(\"-dbcache\", DEFAULT_DB_CACHE));\r\n     size_t total_cache = 0;\r\n     try {\r\n-        total_cache = std::max(MiBToBytes(db_cache), MiBToBytes(MIN_DB_CACHE));\r\n+        total_cache = MiBToBytes(db_cache);\r\n     } catch (const std::out_of_range&) {\r\n         LogError(\"Cannot allocate more than %d MiB in total for db caches.\", std::numeric_limits<size_t>::max() >> 20);\r\n         return std::nullopt;\r\n```\r\n</p>\r\n</details>\r\n\r\nThough I think we don't need this error, could do something even simpler like:\r\n\r\n```c++\r\n// Total cache size in MiB, floored by MIN_DB_CACHE\r\nconst int64_t db_cache = std::max(MIN_DB_CACHE, args.GetIntArg(\"-dbcache\", DEFAULT_DB_CACHE));\r\n// Total cache size in bytes, capped by max size_t value\r\nsize_t total_cache = std::min<int64_t>(db_cache, std::numeric_limits<size_t>::max() >> 20) << 20;\r\n```\r\n\r\nCurrent code or whatever you prefer seems fine though.",
      "created_at": "2025-01-09T15:01:35Z",
      "updated_at": "2025-01-09T15:34:19Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31483#discussion_r1908969637",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1908969637"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31483"
        }
      },
      "start_line": null,
      "original_start_line": 28,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 32,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1909014627",
      "pull_request_review_id": 2540166691,
      "id": 1909014627,
      "node_id": "PRRC_kwDOABII585xyUBj",
      "diff_hunk": "@@ -0,0 +1,48 @@\n+// Copyright (c) 2024-present The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#ifndef BITCOIN_KERNEL_CACHES_H\n+#define BITCOIN_KERNEL_CACHES_H\n+\n+#include <util/check.h>\n+\n+#include <algorithm>\n+#include <bit>\n+#include <cstdint>\n+#include <limits>\n+\n+//! Suggested default amount of cache reserved for the kernel (MiB)\n+static constexpr int64_t DEFAULT_KERNEL_CACHE{450};\n+//! Max memory allocated to block tree DB specific cache (MiB)\n+static constexpr int64_t MAX_BLOCK_DB_CACHE{2};\n+//! Max memory allocated to coin DB specific cache (MiB)\n+static constexpr int64_t MAX_COINS_DB_CACHE{8};\n+\n+//! Guard against truncation of values before converting.\n+constexpr size_t MiBToBytes(int64_t mib)",
      "path": "src/kernel/caches.h",
      "position": null,
      "original_position": 23,
      "commit_id": "2a92702bafca5c78b270a9502a22cb9deac02cfc",
      "original_commit_id": "578654c686e394d08bac7c3bcddbfd90b46eaa62",
      "in_reply_to_id": 1907267762,
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "re: https://github.com/bitcoin/bitcoin/pull/31483#discussion_r1908758174\r\n\r\n> Are there places where this would be re-used? I'd be happy to add something more generic if there is demand for it.\r\n\r\nFWIW, all of the approaches discussed in this thread seem fine to me. If I were writing this PR, I think I would drop the MiBToBytes function and just write the constants as byte counts:\r\n\r\n```\r\nstatic constexpr size_t MAX_BLOCK_DB_CACHE{2 << 20};\r\nstatic constexpr size_t MAX_COINS_DB_CACHE{8 << 20};\r\n```\r\n\r\nThen when converting the `-dbcache` value from MiB to bytes I would just cap the value if it would overflow. (I might consider adding a `SaturatingLeftShift` function to overflow.h to do that, but that would probably be overkill).",
      "created_at": "2025-01-09T15:26:06Z",
      "updated_at": "2025-01-09T15:34:19Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31483#discussion_r1909014627",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1909014627"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31483"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 23,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1909955145",
      "pull_request_review_id": 2541747843,
      "id": 1909955145,
      "node_id": "PRRC_kwDOABII585x15pJ",
      "diff_hunk": "@@ -0,0 +1,48 @@\n+// Copyright (c) 2024-present The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#ifndef BITCOIN_KERNEL_CACHES_H\n+#define BITCOIN_KERNEL_CACHES_H\n+\n+#include <util/check.h>\n+\n+#include <algorithm>\n+#include <bit>\n+#include <cstdint>\n+#include <limits>\n+\n+//! Suggested default amount of cache reserved for the kernel (MiB)\n+static constexpr int64_t DEFAULT_KERNEL_CACHE{450};\n+//! Max memory allocated to block tree DB specific cache (MiB)\n+static constexpr int64_t MAX_BLOCK_DB_CACHE{2};\n+//! Max memory allocated to coin DB specific cache (MiB)\n+static constexpr int64_t MAX_COINS_DB_CACHE{8};\n+\n+//! Guard against truncation of values before converting.\n+constexpr size_t MiBToBytes(int64_t mib)",
      "path": "src/kernel/caches.h",
      "position": null,
      "original_position": 23,
      "commit_id": "2a92702bafca5c78b270a9502a22cb9deac02cfc",
      "original_commit_id": "578654c686e394d08bac7c3bcddbfd90b46eaa62",
      "in_reply_to_id": 1907267762,
      "user": {
        "login": "TheCharlatan",
        "id": 8421793,
        "node_id": "MDQ6VXNlcjg0MjE3OTM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8421793?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/TheCharlatan",
        "html_url": "https://github.com/TheCharlatan",
        "followers_url": "https://api.github.com/users/TheCharlatan/followers",
        "following_url": "https://api.github.com/users/TheCharlatan/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/TheCharlatan/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/TheCharlatan/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/TheCharlatan/subscriptions",
        "organizations_url": "https://api.github.com/users/TheCharlatan/orgs",
        "repos_url": "https://api.github.com/users/TheCharlatan/repos",
        "events_url": "https://api.github.com/users/TheCharlatan/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/TheCharlatan/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "@hodlinator since you initially proposed the current solution, do you have any fresh opinions here?",
      "created_at": "2025-01-10T07:51:28Z",
      "updated_at": "2025-01-10T07:51:29Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31483#discussion_r1909955145",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1909955145"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31483"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 23,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1910139282",
      "pull_request_review_id": 2542035711,
      "id": 1910139282,
      "node_id": "PRRC_kwDOABII585x2mmS",
      "diff_hunk": "@@ -7,31 +7,46 @@\n #include <common/args.h>\n #include <index/txindex.h>\n #include <kernel/caches.h>\n+#include <logging.h>\n+#include <util/byte_conversion.h>\n \n #include <algorithm>\n+#include <optional>\n+#include <stdexcept>\n #include <string>\n \n // Unlike for the UTXO database, for the txindex scenario the leveldb cache make\n // a meaningful difference: https://github.com/bitcoin/bitcoin/pull/8273#issuecomment-229601991\n-//! Max memory allocated to tx index DB specific cache in MiB.\n-static constexpr int64_t MAX_TX_INDEX_CACHE{1024};\n-//! Max memory allocated to all block filter index caches combined in MiB.\n-static constexpr int64_t MAX_FILTER_INDEX_CACHE{1024};\n+//! Max memory allocated to tx index DB specific cache in bytes.\n+static constexpr size_t MAX_TX_INDEX_CACHE{MiBToBytes(1024)};\n+//! Max memory allocated to all block filter index caches combined in bytes.\n+static constexpr size_t MAX_FILTER_INDEX_CACHE{MiBToBytes(1024)};\n \n namespace node {\n-CacheSizes CalculateCacheSizes(const ArgsManager& args, size_t n_indexes)\n+std::optional<CacheSizes> CalculateCacheSizes(const ArgsManager& args, size_t n_indexes)\n {\n-    int64_t nTotalCache = (args.GetIntArg(\"-dbcache\", DEFAULT_DB_CACHE) << 20);\n-    nTotalCache = std::max(nTotalCache, MIN_DB_CACHE << 20);\n-    IndexCacheSizes sizes;\n-    sizes.tx_index = std::min(nTotalCache / 8, args.GetBoolArg(\"-txindex\", DEFAULT_TXINDEX) ? MAX_TX_INDEX_CACHE << 20 : 0);\n-    nTotalCache -= sizes.tx_index;\n-    sizes.filter_index = 0;\n+    int64_t db_cache = args.GetIntArg(\"-dbcache\", DEFAULT_DB_CACHE);\n+\n+    // negative values are permitted, but interpreted as zero.\n+    db_cache = std::max(int64_t{0}, db_cache);\n+\n+    size_t total_cache = 0;\n+    try {\n+        total_cache = std::max(MiBToBytes(db_cache), MiBToBytes(MIN_DB_CACHE));\n+    } catch (const std::out_of_range&) {\n+        LogError(\"Cannot allocate more than %d MiB in total for db caches.\", std::numeric_limits<size_t>::max() >> 20);\n+        return std::nullopt;\n+    }",
      "path": "src/node/caches.cpp",
      "position": null,
      "original_position": 44,
      "commit_id": "2a92702bafca5c78b270a9502a22cb9deac02cfc",
      "original_commit_id": "82706e217f34d1f09cbd30dde6b8ae5ac0385f0a",
      "in_reply_to_id": 1908969637,
      "user": {
        "login": "hodlinator",
        "id": 172445034,
        "node_id": "U_kgDOCkdNag",
        "avatar_url": "https://avatars.githubusercontent.com/u/172445034?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/hodlinator",
        "html_url": "https://github.com/hodlinator",
        "followers_url": "https://api.github.com/users/hodlinator/followers",
        "following_url": "https://api.github.com/users/hodlinator/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/hodlinator/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/hodlinator/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/hodlinator/subscriptions",
        "organizations_url": "https://api.github.com/users/hodlinator/orgs",
        "repos_url": "https://api.github.com/users/hodlinator/repos",
        "events_url": "https://api.github.com/users/hodlinator/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/hodlinator/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "Thread https://github.com/bitcoin/bitcoin/pull/31483#discussion_r1908969637:\r\nAgree it's a bit verbose right now. I especially like the first suggestion in the diff.",
      "created_at": "2025-01-10T10:08:20Z",
      "updated_at": "2025-01-10T10:15:11Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31483#discussion_r1910139282",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1910139282"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31483"
        }
      },
      "start_line": null,
      "original_start_line": 28,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 32,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1910229692",
      "pull_request_review_id": 2542185581,
      "id": 1910229692,
      "node_id": "PRRC_kwDOABII585x28q8",
      "diff_hunk": "@@ -0,0 +1,48 @@\n+// Copyright (c) 2024-present The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#ifndef BITCOIN_KERNEL_CACHES_H\n+#define BITCOIN_KERNEL_CACHES_H\n+\n+#include <util/check.h>\n+\n+#include <algorithm>\n+#include <bit>\n+#include <cstdint>\n+#include <limits>\n+\n+//! Suggested default amount of cache reserved for the kernel (MiB)\n+static constexpr int64_t DEFAULT_KERNEL_CACHE{450};\n+//! Max memory allocated to block tree DB specific cache (MiB)\n+static constexpr int64_t MAX_BLOCK_DB_CACHE{2};\n+//! Max memory allocated to coin DB specific cache (MiB)\n+static constexpr int64_t MAX_COINS_DB_CACHE{8};\n+\n+//! Guard against truncation of values before converting.\n+constexpr size_t MiBToBytes(int64_t mib)",
      "path": "src/kernel/caches.h",
      "position": null,
      "original_position": 23,
      "commit_id": "2a92702bafca5c78b270a9502a22cb9deac02cfc",
      "original_commit_id": "578654c686e394d08bac7c3bcddbfd90b46eaa62",
      "in_reply_to_id": 1907267762,
      "user": {
        "login": "stickies-v",
        "id": 69010457,
        "node_id": "MDQ6VXNlcjY5MDEwNDU3",
        "avatar_url": "https://avatars.githubusercontent.com/u/69010457?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stickies-v",
        "html_url": "https://github.com/stickies-v",
        "followers_url": "https://api.github.com/users/stickies-v/followers",
        "following_url": "https://api.github.com/users/stickies-v/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stickies-v/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stickies-v/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stickies-v/subscriptions",
        "organizations_url": "https://api.github.com/users/stickies-v/orgs",
        "repos_url": "https://api.github.com/users/stickies-v/repos",
        "events_url": "https://api.github.com/users/stickies-v/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stickies-v/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "> Are there places where this would be re-used?\r\n\r\nI can't quite find one - it's also a bit difficult to search for given how much `<<` is used for streams too. I agree there's no need to generalize too early, but given how similar the functionality is I still have a preference for the more generic `CheckedLeftShift()` and/or `SaturatingLeftShift()` as suggested by @ryanofsky. But, I'm okay with either approach.\r\n\r\n> I think I would drop the MiBToBytes function and just write the constants as byte counts:\r\n\r\nI agree (+ with everything in your comment).",
      "created_at": "2025-01-10T11:15:16Z",
      "updated_at": "2025-01-10T11:15:17Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31483#discussion_r1910229692",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1910229692"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31483"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 23,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1910681619",
      "pull_request_review_id": 2543008314,
      "id": 1910681619,
      "node_id": "PRRC_kwDOABII585x4rAT",
      "diff_hunk": "@@ -1603,18 +1605,22 @@ bool AppInitMain(NodeContext& node, interfaces::BlockAndHeaderTipInfo* tip_info)\n     ReadNotificationArgs(args, kernel_notifications);\n \n     // cache size calculations\n-    CacheSizes cache_sizes = CalculateCacheSizes(args, g_enabled_filter_types.size());\n+    const auto cache_sizes = CalculateCacheSizes(args, g_enabled_filter_types.size());\n+    if (!cache_sizes) {\n+        return InitError(_(\"Failed to calculate cache sizes. Try lowering the -dbcache value.\"));\n+    }\n+    auto [index_cache_sizes, kernel_cache_sizes] = *cache_sizes;",
      "path": "src/init.cpp",
      "position": null,
      "original_position": 38,
      "commit_id": "2a92702bafca5c78b270a9502a22cb9deac02cfc",
      "original_commit_id": "82706e217f34d1f09cbd30dde6b8ae5ac0385f0a",
      "in_reply_to_id": null,
      "user": {
        "login": "stickies-v",
        "id": 69010457,
        "node_id": "MDQ6VXNlcjY5MDEwNDU3",
        "avatar_url": "https://avatars.githubusercontent.com/u/69010457?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stickies-v",
        "html_url": "https://github.com/stickies-v",
        "followers_url": "https://api.github.com/users/stickies-v/followers",
        "following_url": "https://api.github.com/users/stickies-v/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stickies-v/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stickies-v/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stickies-v/subscriptions",
        "organizations_url": "https://api.github.com/users/stickies-v/orgs",
        "repos_url": "https://api.github.com/users/stickies-v/repos",
        "events_url": "https://api.github.com/users/stickies-v/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stickies-v/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "nit: this could be `const` if you update `InitAndLoadChainstate()`'s `cache_sizes` parameter to `const`",
      "created_at": "2025-01-10T17:14:34Z",
      "updated_at": "2025-01-10T20:15:26Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31483#discussion_r1910681619",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1910681619"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31483"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1612,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1911227603",
      "pull_request_review_id": 2543008314,
      "id": 1911227603,
      "node_id": "PRRC_kwDOABII585x6wTT",
      "diff_hunk": "@@ -0,0 +1,48 @@\n+// Copyright (c) 2024-present The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#ifndef BITCOIN_KERNEL_CACHES_H\n+#define BITCOIN_KERNEL_CACHES_H\n+\n+#include <util/check.h>\n+\n+#include <algorithm>\n+#include <bit>\n+#include <cstdint>\n+#include <limits>\n+\n+//! Suggested default amount of cache reserved for the kernel (MiB)\n+static constexpr int64_t DEFAULT_KERNEL_CACHE{450};\n+//! Max memory allocated to block tree DB specific cache (MiB)\n+static constexpr int64_t MAX_BLOCK_DB_CACHE{2};\n+//! Max memory allocated to coin DB specific cache (MiB)\n+static constexpr int64_t MAX_COINS_DB_CACHE{8};\n+\n+//! Guard against truncation of values before converting.\n+constexpr size_t MiBToBytes(int64_t mib)",
      "path": "src/kernel/caches.h",
      "position": null,
      "original_position": 23,
      "commit_id": "2a92702bafca5c78b270a9502a22cb9deac02cfc",
      "original_commit_id": "578654c686e394d08bac7c3bcddbfd90b46eaa62",
      "in_reply_to_id": 1907267762,
      "user": {
        "login": "stickies-v",
        "id": 69010457,
        "node_id": "MDQ6VXNlcjY5MDEwNDU3",
        "avatar_url": "https://avatars.githubusercontent.com/u/69010457?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stickies-v",
        "html_url": "https://github.com/stickies-v",
        "followers_url": "https://api.github.com/users/stickies-v/followers",
        "following_url": "https://api.github.com/users/stickies-v/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stickies-v/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stickies-v/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stickies-v/subscriptions",
        "organizations_url": "https://api.github.com/users/stickies-v/orgs",
        "repos_url": "https://api.github.com/users/stickies-v/repos",
        "events_url": "https://api.github.com/users/stickies-v/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stickies-v/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "Okay I'm sorry I can't seem to just let it go but here's another approach. It adds `SaturatingLeftShift` and `CheckedLeftShift()` `util/overflow.h` functionality (+tests, pinky promise), a `_MiB` string literal to allow remaining sizes to be converted to `size_t` bytes with concise notation and compile-time overflow guarantees (🤞). It also incorporates @ryanofsky's [suggestion](https://github.com/bitcoin/bitcoin/pull/31483#discussion_r1908969637) to just saturate -dbcache values instead of throwing. It's not necessary for my suggestion but I think it's a good approach and aligns well with the `SaturatingLeftShift()` helper fn.\r\n\r\n<details>\r\n<summary>git diff on 82706e217f</summary>\r\n\r\n```diff\r\ndiff --git a/src/bitcoin-chainstate.cpp b/src/bitcoin-chainstate.cpp\r\nindex 82bda4b22b..51c482607a 100644\r\n--- a/src/bitcoin-chainstate.cpp\r\n+++ b/src/bitcoin-chainstate.cpp\r\n@@ -26,7 +26,6 @@\r\n #include <random.h>\r\n #include <script/sigcache.h>\r\n #include <util/chaintype.h>\r\n-#include <util/byte_conversion.h>\r\n #include <util/fs.h>\r\n #include <util/signalinterrupt.h>\r\n #include <util/task_runner.h>\r\n@@ -124,7 +123,7 @@ int main(int argc, char* argv[])\r\n     util::SignalInterrupt interrupt;\r\n     ChainstateManager chainman{interrupt, chainman_opts, blockman_opts};\r\n \r\n-    kernel::CacheSizes cache_sizes{MiBToBytes(DEFAULT_KERNEL_CACHE)};\r\n+    kernel::CacheSizes cache_sizes{DEFAULT_KERNEL_CACHE};\r\n     node::ChainstateLoadOptions options;\r\n     auto [status, error] = node::LoadChainstate(chainman, cache_sizes, options);\r\n     if (status != node::ChainstateLoadStatus::SUCCESS) {\r\ndiff --git a/src/init.cpp b/src/init.cpp\r\nindex 1ae968760d..847facad87 100644\r\n--- a/src/init.cpp\r\n+++ b/src/init.cpp\r\n@@ -489,7 +489,7 @@ void SetupServerArgs(ArgsManager& argsman, bool can_listen_ipc)\r\n     argsman.AddArg(\"-conf=<file>\", strprintf(\"Specify path to read-only configuration file. Relative paths will be prefixed by datadir location (only useable from command line, not configuration file) (default: %s)\", BITCOIN_CONF_FILENAME), ArgsManager::ALLOW_ANY, OptionsCategory::OPTIONS);\r\n     argsman.AddArg(\"-datadir=<dir>\", \"Specify data directory\", ArgsManager::ALLOW_ANY | ArgsManager::DISALLOW_NEGATION, OptionsCategory::OPTIONS);\r\n     argsman.AddArg(\"-dbbatchsize\", strprintf(\"Maximum database write batch size in bytes (default: %u)\", nDefaultDbBatchSize), ArgsManager::ALLOW_ANY | ArgsManager::DEBUG_ONLY, OptionsCategory::OPTIONS);\r\n-    argsman.AddArg(\"-dbcache=<n>\", strprintf(\"Maximum database cache size <n> MiB (minimum %d, default: %d). Make sure you have enough RAM. In addition, unused memory allocated to the mempool is shared with this cache (see -maxmempool).\", MIN_DB_CACHE, DEFAULT_DB_CACHE), ArgsManager::ALLOW_ANY, OptionsCategory::OPTIONS);\r\n+    argsman.AddArg(\"-dbcache=<n>\", strprintf(\"Maximum database cache size <n> MiB (minimum %d, default: %d). Make sure you have enough RAM. In addition, unused memory allocated to the mempool is shared with this cache (see -maxmempool).\", MIN_DB_CACHE >> 20, DEFAULT_DB_CACHE >> 20), ArgsManager::ALLOW_ANY, OptionsCategory::OPTIONS);\r\n     argsman.AddArg(\"-includeconf=<file>\", \"Specify additional configuration file, relative to the -datadir path (only useable from configuration file, not command line)\", ArgsManager::ALLOW_ANY, OptionsCategory::OPTIONS);\r\n     argsman.AddArg(\"-allowignoredconf\", strprintf(\"For backwards compatibility, treat an unused %s file in the datadir as a warning, not an error.\", BITCOIN_CONF_FILENAME), ArgsManager::ALLOW_ANY, OptionsCategory::OPTIONS);\r\n     argsman.AddArg(\"-loadblock=<file>\", \"Imports blocks from external file on startup\", ArgsManager::ALLOW_ANY, OptionsCategory::OPTIONS);\r\n@@ -1179,7 +1179,7 @@ static ChainstateLoadResult InitAndLoadChainstate(\r\n     NodeContext& node,\r\n     bool do_reindex,\r\n     const bool do_reindex_chainstate,\r\n-    CacheSizes& cache_sizes,\r\n+    const CacheSizes& cache_sizes,\r\n     const ArgsManager& args)\r\n {\r\n     const CChainParams& chainparams = Params();\r\n@@ -1605,11 +1605,7 @@ bool AppInitMain(NodeContext& node, interfaces::BlockAndHeaderTipInfo* tip_info)\r\n     ReadNotificationArgs(args, kernel_notifications);\r\n \r\n     // cache size calculations\r\n-    const auto cache_sizes = CalculateCacheSizes(args, g_enabled_filter_types.size());\r\n-    if (!cache_sizes) {\r\n-        return InitError(_(\"Failed to calculate cache sizes. Try lowering the -dbcache value.\"));\r\n-    }\r\n-    auto [index_cache_sizes, kernel_cache_sizes] = *cache_sizes;\r\n+    const auto [index_cache_sizes, kernel_cache_sizes] = CalculateCacheSizes(args, g_enabled_filter_types.size());\r\n \r\n     LogInfo(\"Cache configuration:\");\r\n     LogInfo(\"* Using %.1f MiB for block index database\", kernel_cache_sizes.block_tree_db * (1.0 / 1024 / 1024));\r\ndiff --git a/src/kernel/caches.h b/src/kernel/caches.h\r\nindex 9ee5a31e0a..4414d1a123 100644\r\n--- a/src/kernel/caches.h\r\n+++ b/src/kernel/caches.h\r\n@@ -5,16 +5,16 @@\r\n #ifndef BITCOIN_KERNEL_CACHES_H\r\n #define BITCOIN_KERNEL_CACHES_H\r\n \r\n-#include <util/byte_conversion.h>\r\n+#include <util/storage.h>\r\n \r\n #include <algorithm>\r\n \r\n-//! Suggested default amount of cache reserved for the kernel (MiB)\r\n-static constexpr int64_t DEFAULT_KERNEL_CACHE{450};\r\n+//! Suggested default amount of cache reserved for the kernel (bytes)\r\n+static constexpr size_t DEFAULT_KERNEL_CACHE{450_MiB};\r\n //! Max memory allocated to block tree DB specific cache (bytes)\r\n-static constexpr size_t MAX_BLOCK_DB_CACHE{MiBToBytes(2)};\r\n+static constexpr size_t MAX_BLOCK_DB_CACHE{2_MiB};\r\n //! Max memory allocated to coin DB specific cache (bytes)\r\n-static constexpr size_t MAX_COINS_DB_CACHE{MiBToBytes(8)};\r\n+static constexpr size_t MAX_COINS_DB_CACHE{8_MiB};\r\n \r\n namespace kernel {\r\n struct CacheSizes {\r\ndiff --git a/src/node/caches.cpp b/src/node/caches.cpp\r\nindex 41a8971665..94ad5bbe61 100644\r\n--- a/src/node/caches.cpp\r\n+++ b/src/node/caches.cpp\r\n@@ -8,34 +8,27 @@\r\n #include <index/txindex.h>\r\n #include <kernel/caches.h>\r\n #include <logging.h>\r\n-#include <util/byte_conversion.h>\r\n+#include <util/overflow.h>\r\n+#include <util/storage.h>\r\n \r\n #include <algorithm>\r\n-#include <optional>\r\n #include <stdexcept>\r\n #include <string>\r\n \r\n // Unlike for the UTXO database, for the txindex scenario the leveldb cache make\r\n // a meaningful difference: https://github.com/bitcoin/bitcoin/pull/8273#issuecomment-229601991\r\n //! Max memory allocated to tx index DB specific cache in bytes.\r\n-static constexpr size_t MAX_TX_INDEX_CACHE{MiBToBytes(1024)};\r\n+static constexpr size_t MAX_TX_INDEX_CACHE{1024_MiB};\r\n //! Max memory allocated to all block filter index caches combined in bytes.\r\n-static constexpr size_t MAX_FILTER_INDEX_CACHE{MiBToBytes(1024)};\r\n+static constexpr size_t MAX_FILTER_INDEX_CACHE{1024_MiB};\r\n \r\n namespace node {\r\n-std::optional<CacheSizes> CalculateCacheSizes(const ArgsManager& args, size_t n_indexes)\r\n+CacheSizes CalculateCacheSizes(const ArgsManager& args, size_t n_indexes)\r\n {\r\n-    int64_t db_cache = args.GetIntArg(\"-dbcache\", DEFAULT_DB_CACHE);\r\n-\r\n-    // negative values are permitted, but interpreted as zero.\r\n-    db_cache = std::max(int64_t{0}, db_cache);\r\n-\r\n-    size_t total_cache = 0;\r\n-    try {\r\n-        total_cache = std::max(MiBToBytes(db_cache), MiBToBytes(MIN_DB_CACHE));\r\n-    } catch (const std::out_of_range&) {\r\n-        LogError(\"Cannot allocate more than %d MiB in total for db caches.\", std::numeric_limits<size_t>::max() >> 20);\r\n-        return std::nullopt;\r\n+    // Total cache size in MiB, floored by MIN_DB_CACHE and capped by max size_t value\r\n+    size_t total_cache{DEFAULT_DB_CACHE};\r\n+    if (auto db_cache = args.GetIntArg(\"-dbcache\")) {\r\n+        total_cache = std::max(MIN_DB_CACHE, SaturatingLeftShift<size_t>(*db_cache, 20));\r\n     }\r\n \r\n     IndexCacheSizes index_sizes;\r\n@@ -47,6 +40,6 @@ std::optional<CacheSizes> CalculateCacheSizes(const ArgsManager& args, size_t n_\r\n         index_sizes.filter_index = max_cache / n_indexes;\r\n         total_cache -= index_sizes.filter_index * n_indexes;\r\n     }\r\n-    return {{index_sizes, kernel::CacheSizes{total_cache}}};\r\n+    return {index_sizes, kernel::CacheSizes{total_cache}};\r\n }\r\n } // namespace node\r\ndiff --git a/src/node/caches.h b/src/node/caches.h\r\nindex b4f2e3d516..aab7871e93 100644\r\n--- a/src/node/caches.h\r\n+++ b/src/node/caches.h\r\n@@ -6,17 +6,16 @@\r\n #define BITCOIN_NODE_CACHES_H\r\n \r\n #include <kernel/caches.h>\r\n-#include <util/byte_conversion.h>\r\n+#include <util/storage.h>\r\n \r\n #include <cstddef>\r\n-#include <optional>\r\n \r\n class ArgsManager;\r\n \r\n-//! min. -dbcache (MiB)\r\n-static constexpr int64_t MIN_DB_CACHE{4};\r\n-//! -dbcache default (MiB)\r\n-static constexpr int64_t DEFAULT_DB_CACHE{DEFAULT_KERNEL_CACHE};\r\n+//! min. -dbcache (bytes)\r\n+static constexpr size_t MIN_DB_CACHE{4_MiB};\r\n+//! -dbcache default (bytes)\r\n+static constexpr size_t DEFAULT_DB_CACHE{DEFAULT_KERNEL_CACHE};\r\n \r\n namespace node {\r\n struct IndexCacheSizes {\r\n@@ -27,7 +26,7 @@ struct CacheSizes {\r\n     IndexCacheSizes index;\r\n     kernel::CacheSizes kernel;\r\n };\r\n-std::optional<CacheSizes> CalculateCacheSizes(const ArgsManager& args, size_t n_indexes = 0);\r\n+CacheSizes CalculateCacheSizes(const ArgsManager& args, size_t n_indexes = 0);\r\n } // namespace node\r\n \r\n #endif // BITCOIN_NODE_CACHES_H\r\ndiff --git a/src/qt/optionsdialog.cpp b/src/qt/optionsdialog.cpp\r\nindex 76b7852109..2cea1bf6ab 100644\r\n--- a/src/qt/optionsdialog.cpp\r\n+++ b/src/qt/optionsdialog.cpp\r\n@@ -95,7 +95,7 @@ OptionsDialog::OptionsDialog(QWidget* parent, bool enableWallet)\r\n     ui->verticalLayout->setStretchFactor(ui->tabWidget, 1);\r\n \r\n     /* Main elements init */\r\n-    ui->databaseCache->setRange(MIN_DB_CACHE, std::numeric_limits<int>::max());\r\n+    ui->databaseCache->setRange(MIN_DB_CACHE >> 20, std::numeric_limits<int>::max());\r\n     ui->threadsScriptVerif->setMinimum(-GetNumCores());\r\n     ui->threadsScriptVerif->setMaximum(MAX_SCRIPTCHECK_THREADS);\r\n     ui->pruneWarning->setVisible(false);\r\ndiff --git a/src/qt/optionsmodel.cpp b/src/qt/optionsmodel.cpp\r\nindex 2c6f13dc6d..5ff22b0f4c 100644\r\n--- a/src/qt/optionsmodel.cpp\r\n+++ b/src/qt/optionsmodel.cpp\r\n@@ -470,7 +470,7 @@ QVariant OptionsModel::getOption(OptionID option, const std::string& suffix) con\r\n                suffix.empty()          ? getOption(option, \"-prev\") :\r\n                                          DEFAULT_PRUNE_TARGET_GB;\r\n     case DatabaseCache:\r\n-        return qlonglong(SettingToInt(setting(), DEFAULT_DB_CACHE));\r\n+        return qlonglong(SettingToInt(setting(), DEFAULT_DB_CACHE >> 20));\r\n     case ThreadsScriptVerif:\r\n         return qlonglong(SettingToInt(setting(), DEFAULT_SCRIPTCHECK_THREADS));\r\n     case Listen:\r\n@@ -733,7 +733,7 @@ void OptionsModel::checkAndMigrate()\r\n         // see https://github.com/bitcoin/bitcoin/pull/8273\r\n         // force people to upgrade to the new value if they are using 100MB\r\n         if (settingsVersion < 130000 && settings.contains(\"nDatabaseCache\") && settings.value(\"nDatabaseCache\").toLongLong() == 100)\r\n-            settings.setValue(\"nDatabaseCache\", (qint64)DEFAULT_DB_CACHE);\r\n+            settings.setValue(\"nDatabaseCache\", (qint64)DEFAULT_DB_CACHE >> 20);\r\n \r\n         settings.setValue(strSettingsVersionKey, CLIENT_VERSION);\r\n     }\r\ndiff --git a/src/test/util/setup_common.h b/src/test/util/setup_common.h\r\nindex 7d7c7b7cd4..33ad258457 100644\r\n--- a/src/test/util/setup_common.h\r\n+++ b/src/test/util/setup_common.h\r\n@@ -104,7 +104,7 @@ struct BasicTestingSetup {\r\n  * initialization behaviour.\r\n  */\r\n struct ChainTestingSetup : public BasicTestingSetup {\r\n-    kernel::CacheSizes m_kernel_cache_sizes{node::CalculateCacheSizes(m_args).value().kernel};\r\n+    kernel::CacheSizes m_kernel_cache_sizes{node::CalculateCacheSizes(m_args).kernel};\r\n     bool m_coins_db_in_memory{true};\r\n     bool m_block_tree_db_in_memory{true};\r\n     std::function<void()> m_make_chainman{};\r\ndiff --git a/src/test/util_tests.cpp b/src/test/util_tests.cpp\r\nindex e8e0abbda6..dbe1d76ca8 100644\r\n--- a/src/test/util_tests.cpp\r\n+++ b/src/test/util_tests.cpp\r\n@@ -13,12 +13,12 @@\r\n #include <test/util/setup_common.h>\r\n #include <uint256.h>\r\n #include <util/bitdeque.h>\r\n-#include <util/byte_conversion.h>\r\n #include <util/fs.h>\r\n #include <util/fs_helpers.h>\r\n #include <util/moneystr.h>\r\n #include <util/overflow.h>\r\n #include <util/readwritefile.h>\r\n+#include <util/storage.h>\r\n #include <util/strencodings.h>\r\n #include <util/string.h>\r\n #include <util/time.h>\r\n@@ -141,19 +141,6 @@ BOOST_AUTO_TEST_CASE(util_criticalsection)\r\n     } while(0);\r\n }\r\n \r\n-BOOST_AUTO_TEST_CASE(byte_conversion)\r\n-{\r\n-    // maximum allowed value in MiB\r\n-    const int64_t max_cache = std::numeric_limits<size_t>::max() >> 20;\r\n-\r\n-    BOOST_CHECK_EXCEPTION(MiBToBytes(-1), std::out_of_range, HasReason(\"Value may not be negative.\"));\r\n-    BOOST_CHECK_EXCEPTION(MiBToBytes(std::numeric_limits<int64_t>::max()), std::out_of_range, HasReason(\"Conversion to bytes of\"));\r\n-    BOOST_CHECK_EXCEPTION(MiBToBytes(max_cache + 1), std::out_of_range, HasReason(\"Conversion to bytes of\"));\r\n-\r\n-    BOOST_CHECK_EQUAL(MiBToBytes(0), 0);\r\n-    BOOST_CHECK_EQUAL(MiBToBytes(max_cache), max_cache << 20);\r\n-}\r\n-\r\n constexpr char HEX_PARSE_INPUT[] = \"04678afdb0fe5548271967f1a67130b7105cd6a828e03909a67962e0ea1f61deb649f6bc3f4cef38c4f35504e51ec112de5c384df7ba0b8d578a4c702b6bf11d5f\";\r\n constexpr uint8_t HEX_PARSE_OUTPUT[] = {\r\n     0x04, 0x67, 0x8a, 0xfd, 0xb0, 0xfe, 0x55, 0x48, 0x27, 0x19, 0x67, 0xf1, 0xa6, 0x71, 0x30, 0xb7,\r\n@@ -1892,4 +1879,63 @@ BOOST_AUTO_TEST_CASE(clearshrink_test)\r\n     }\r\n }\r\n \r\n+template <typename T>\r\n+void TestCheckedLeftShift()\r\n+{\r\n+    BOOST_TEST_CONTEXT(\"Testing CheckedLeftShift with \" << typeid(T).name()) {\r\n+        // Basic operations\r\n+        BOOST_CHECK_EQUAL(CheckedLeftShift<T>(0, 1), 0);\r\n+        BOOST_CHECK_EQUAL(CheckedLeftShift<T>(1, 1), 2);\r\n+        BOOST_CHECK_EQUAL(CheckedLeftShift<T>(2, 2), 8);\r\n+\r\n+        // Negative input\r\n+        BOOST_CHECK(!CheckedLeftShift<T>(-1, 1));\r\n+\r\n+        // Overflow cases\r\n+        BOOST_CHECK(!CheckedLeftShift<T>((std::numeric_limits<T>::max() >> 1) + 1, 1));\r\n+        BOOST_CHECK(!CheckedLeftShift<T>(std::numeric_limits<T>::max(), 1));\r\n+    }\r\n+}\r\n+\r\n+template <typename T>\r\n+void TestSaturatingLeftShift()\r\n+{\r\n+    BOOST_TEST_CONTEXT(\"Testing SaturatingLeftShift with \" << typeid(T).name()) {\r\n+        // Basic operations\r\n+        BOOST_CHECK_EQUAL(SaturatingLeftShift<T>(0, 1), 0);\r\n+        BOOST_CHECK_EQUAL(SaturatingLeftShift<T>(1, 1), 2);\r\n+        BOOST_CHECK_EQUAL(SaturatingLeftShift<T>(2, 2), 8);\r\n+\r\n+        // Negative input\r\n+        BOOST_CHECK_EQUAL(SaturatingLeftShift<T>(-1, 1), 0);\r\n+\r\n+        // Saturation cases\r\n+        BOOST_CHECK_EQUAL(SaturatingLeftShift<T>((std::numeric_limits<T>::max() >> 1) + 1, 1), std::numeric_limits<T>::max());\r\n+        BOOST_CHECK_EQUAL(SaturatingLeftShift<T>(std::numeric_limits<T>::max(), 1), std::numeric_limits<T>::max());\r\n+    }\r\n+}\r\n+\r\n+BOOST_AUTO_TEST_CASE(checked_left_shift_test)\r\n+{\r\n+    TestCheckedLeftShift<uint8_t>();\r\n+    TestCheckedLeftShift<size_t>();\r\n+    TestCheckedLeftShift<uint64_t>();\r\n+}\r\n+\r\n+BOOST_AUTO_TEST_CASE(saturating_left_shift_test)\r\n+{\r\n+    TestSaturatingLeftShift<uint8_t>();\r\n+    TestSaturatingLeftShift<size_t>();\r\n+    TestSaturatingLeftShift<uint64_t>();\r\n+}\r\n+\r\n+BOOST_AUTO_TEST_CASE(mib_string_literal_test)\r\n+{\r\n+    BOOST_CHECK_EQUAL(0_MiB, 0);\r\n+    BOOST_CHECK_EQUAL(1_MiB, 1024 * 1024);\r\n+\r\n+    constexpr size_t max_safe_mib = std::numeric_limits<size_t>::max() / (1024 * 1024);\r\n+    BOOST_CHECK_EQUAL(max_safe_mib * (1024 * 1024), max_safe_mib * 1_MiB);\r\n+}\r\n+\r\n BOOST_AUTO_TEST_SUITE_END()\r\ndiff --git a/src/util/byte_conversion.h b/src/util/byte_conversion.h\r\ndeleted file mode 100644\r\nindex bbdad04bff..0000000000\r\n--- a/src/util/byte_conversion.h\r\n+++ /dev/null\r\n@@ -1,26 +0,0 @@\r\n-// Copyright (c) 2025-present The Bitcoin Core developers\r\n-// Distributed under the MIT software license, see the accompanying\r\n-// file COPYING or http://www.opensource.org/licenses/mit-license.php.\r\n-\r\n-#ifndef BITCOIN_UTIL_BYTE_CONVERSION_H\r\n-#define BITCOIN_UTIL_BYTE_CONVERSION_H\r\n-\r\n-#include <tinyformat.h>\r\n-\r\n-#include <cstdint>\r\n-#include <limits>\r\n-#include <stdexcept>\r\n-\r\n-//! Guard against truncation of values before converting.\r\n-constexpr size_t MiBToBytes(int64_t mib)\r\n-{\r\n-    if (mib < 0) {\r\n-        throw std::out_of_range(\"Value may not be negative.\");\r\n-    }\r\n-    if (static_cast<uint64_t>(mib) > std::numeric_limits<size_t>::max() >> 20) {\r\n-        throw std::out_of_range(strprintf(\"Conversion to bytes of %d does not fit into size_t with maximum value %d.\", mib, std::numeric_limits<size_t>::max()));\r\n-    }\r\n-    return static_cast<size_t>(mib) << 20;\r\n-}\r\n-\r\n-#endif // BITCOIN_UTIL_BYTE_CONVERSION_H\r\ndiff --git a/src/util/overflow.h b/src/util/overflow.h\r\nindex 7e0cce6c27..bb5277db28 100644\r\n--- a/src/util/overflow.h\r\n+++ b/src/util/overflow.h\r\n@@ -47,4 +47,42 @@ template <class T>\r\n     return i + j;\r\n }\r\n \r\n+/**\r\n+ * @brief Left bit shift with overflow checking.\r\n+ * @param i The input value to be left shifted.\r\n+ * @param shift The number of bits to left shift.\r\n+ * @return The result of the left shift, or std::nullopt in case of\r\n+ *         overflow or negative input value.\r\n+ */\r\n+template <class Output, class Input>\r\n+constexpr std::optional<Output> CheckedLeftShift(Input i, unsigned shift) noexcept\r\n+    requires std::is_unsigned_v<Output>\r\n+{\r\n+    if constexpr (std::is_signed_v<Input>) {\r\n+        if (i < 0) return std::nullopt;\r\n+    }\r\n+    if (std::make_unsigned_t<Input>(i) > (std::numeric_limits<Output>::max() >> shift)) {\r\n+        return std::nullopt;\r\n+    }\r\n+    return i << shift;\r\n+}\r\n+\r\n+/**\r\n+ * @brief Left bit shift with safe minimum and maximum values.\r\n+ * @param i The input value to be left shifted.\r\n+ * @param shift The number of bits to left shift.\r\n+ * @return The result of the left shift, with the return value clamped\r\n+ *         between zero and the maximum Output value if overflow occurs.\r\n+ */\r\n+template <class Output, class Input>\r\n+constexpr Output SaturatingLeftShift(Input i, unsigned shift) noexcept\r\n+    requires std::is_unsigned_v<Output>\r\n+{\r\n+    auto default_value{std::numeric_limits<Output>::max()};\r\n+    if constexpr (std::is_signed_v<Input>) {\r\n+        if (i < 0) default_value = 0;\r\n+    }\r\n+    return CheckedLeftShift<Output>(i, shift).value_or(default_value);\r\n+}\r\n+\r\n #endif // BITCOIN_UTIL_OVERFLOW_H\r\ndiff --git a/src/util/storage.h b/src/util/storage.h\r\nnew file mode 100644\r\nindex 0000000000..042875510b\r\n--- /dev/null\r\n+++ b/src/util/storage.h\r\n@@ -0,0 +1,24 @@\r\n+// Copyright (c) 2025-present The Bitcoin Core developers\r\n+// Distributed under the MIT software license, see the accompanying\r\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\r\n+\r\n+#ifndef BITCOIN_UTIL_STORAGE_H\r\n+#define BITCOIN_UTIL_STORAGE_H\r\n+\r\n+#include <util/overflow.h>\r\n+\r\n+#include <cstdint>\r\n+#include <limits>\r\n+#include <stdexcept>\r\n+\r\n+//! Overflow-safe conversion of MiB to bytes.\r\n+constexpr size_t operator\"\" _MiB(unsigned long long mebibytes)\r\n+{\r\n+    auto bytes{CheckedLeftShift<size_t>(static_cast<size_t>(mebibytes), 20)};\r\n+    if (!bytes) {\r\n+        throw std::overflow_error(\"mebibytes cannot be converted to bytes\");\r\n+    }\r\n+    return *bytes;\r\n+}\r\n+\r\n+#endif // BITCOIN_UTIL_STORAGE_H\r\n\r\n\r\n```\r\n</details>\r\n\r\n",
      "created_at": "2025-01-10T20:14:22Z",
      "updated_at": "2025-01-10T20:15:26Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31483#discussion_r1911227603",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1911227603"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31483"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 23,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1911315361",
      "pull_request_review_id": 2543782604,
      "id": 1911315361,
      "node_id": "PRRC_kwDOABII585x7Fuh",
      "diff_hunk": "@@ -0,0 +1,48 @@\n+// Copyright (c) 2024-present The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#ifndef BITCOIN_KERNEL_CACHES_H\n+#define BITCOIN_KERNEL_CACHES_H\n+\n+#include <util/check.h>\n+\n+#include <algorithm>\n+#include <bit>\n+#include <cstdint>\n+#include <limits>\n+\n+//! Suggested default amount of cache reserved for the kernel (MiB)\n+static constexpr int64_t DEFAULT_KERNEL_CACHE{450};\n+//! Max memory allocated to block tree DB specific cache (MiB)\n+static constexpr int64_t MAX_BLOCK_DB_CACHE{2};\n+//! Max memory allocated to coin DB specific cache (MiB)\n+static constexpr int64_t MAX_COINS_DB_CACHE{8};\n+\n+//! Guard against truncation of values before converting.\n+constexpr size_t MiBToBytes(int64_t mib)",
      "path": "src/kernel/caches.h",
      "position": null,
      "original_position": 23,
      "commit_id": "2a92702bafca5c78b270a9502a22cb9deac02cfc",
      "original_commit_id": "578654c686e394d08bac7c3bcddbfd90b46eaa62",
      "in_reply_to_id": 1907267762,
      "user": {
        "login": "hodlinator",
        "id": 172445034,
        "node_id": "U_kgDOCkdNag",
        "avatar_url": "https://avatars.githubusercontent.com/u/172445034?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/hodlinator",
        "html_url": "https://github.com/hodlinator",
        "followers_url": "https://api.github.com/users/hodlinator/followers",
        "following_url": "https://api.github.com/users/hodlinator/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/hodlinator/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/hodlinator/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/hodlinator/subscriptions",
        "organizations_url": "https://api.github.com/users/hodlinator/orgs",
        "repos_url": "https://api.github.com/users/hodlinator/repos",
        "events_url": "https://api.github.com/users/hodlinator/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/hodlinator/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "> @hodlinator since you initially proposed the current solution, do you have any fresh opinions here?\r\n\r\nWhen used with `size_t` constants, I get helpful GCC compiler errors when increasing the value of the constants (I guess this in part comes from C++ integer literals being signed 32-bit by default?):\r\n```\r\n/home/hodlinator/bitcoin/src/node/caches.cpp:23:53: error: narrowing conversion of ‘-176160768’ from ‘int’ to ‘size_t’ {aka ‘long unsigned int’} [-Wnarrowing]\r\n   23 | static constexpr size_t MAX_FILTER_INDEX_CACHE{8024 << 20};\r\n      |                                                ~~~~~^~~~~\r\n```\r\n---\r\n\r\nI don't get such errors when shifting an `int64_t` constant and then truncating it into a `size_t` function argument. 10x-ed `DEFAULT_KERNEL_CACHE`:\r\n```\r\nstatic constexpr int64_t DEFAULT_KERNEL_CACHE{4500};\r\n```\r\nAdded this into *caches.cpp*/`CalculateCacheSizes()`, sending a too large value into `size_t` function argument:\r\n```\r\nkernel::CacheSizes cache_sizes{DEFAULT_KERNEL_CACHE << 20};\r\n```\r\nGot no error/warning when compiling on CentOS (32-bit).\r\n\r\n---\r\n\r\nThe second block above makes me lean towards recommending keeping some kind of free function with checks for non-`size_t` constants. @stickies-v's latest diff seems overall like a good direction, building on the pre-existing *overflow.h*.",
      "created_at": "2025-01-10T20:42:47Z",
      "updated_at": "2025-01-10T20:42:47Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31483#discussion_r1911315361",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1911315361"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31483"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 23,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1912175146",
      "pull_request_review_id": 2545133420,
      "id": 1912175146,
      "node_id": "PRRC_kwDOABII585x-Xoq",
      "diff_hunk": "@@ -0,0 +1,22 @@\n+// Copyright (c) 2025-present The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#ifndef BITCOIN_UTIL_BYTE_UNITS_H\n+#define BITCOIN_UTIL_BYTE_UNITS_H\n+\n+#include <util/overflow.h>\n+\n+#include <stdexcept>\n+\n+//! Overflow-safe conversion of MiB to bytes.\n+constexpr size_t operator\"\" _MiB(unsigned long long mebibytes)\n+{\n+    auto bytes{CheckedLeftShift<size_t>(mebibytes, 20)};\n+    if (!bytes) {\n+        throw std::overflow_error(\"mebibytes could not be converted to bytes\");",
      "path": "src/util/byte_units.h",
      "position": null,
      "original_position": 17,
      "commit_id": "2a92702bafca5c78b270a9502a22cb9deac02cfc",
      "original_commit_id": "cf20c1b9e0b46cb8c4d4f93a054afd9c1f85e4e0",
      "in_reply_to_id": null,
      "user": {
        "login": "hodlinator",
        "id": 172445034,
        "node_id": "U_kgDOCkdNag",
        "avatar_url": "https://avatars.githubusercontent.com/u/172445034?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/hodlinator",
        "html_url": "https://github.com/hodlinator",
        "followers_url": "https://api.github.com/users/hodlinator/followers",
        "following_url": "https://api.github.com/users/hodlinator/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/hodlinator/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/hodlinator/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/hodlinator/subscriptions",
        "organizations_url": "https://api.github.com/users/hodlinator/orgs",
        "repos_url": "https://api.github.com/users/hodlinator/repos",
        "events_url": "https://api.github.com/users/hodlinator/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/hodlinator/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "nit: Give a hint at why?\r\n```suggestion\r\n        throw std::overflow_error(\"Too many mebibytes to fit into size_t bytes\");\r\n```",
      "created_at": "2025-01-11T19:17:04Z",
      "updated_at": "2025-01-11T20:25:57Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31483#discussion_r1912175146",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1912175146"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31483"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 17,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1912179390",
      "pull_request_review_id": 2545133420,
      "id": 1912179390,
      "node_id": "PRRC_kwDOABII585x-Yq-",
      "diff_hunk": "@@ -6,28 +6,39 @@\n \n #include <common/args.h>\n #include <index/txindex.h>\n-#include <txdb.h>\n+#include <kernel/caches.h>\n+#include <logging.h>\n+#include <util/byte_units.h>\n+\n+#include <algorithm>\n+#include <optional>\n+#include <string>\n+\n+// Unlike for the UTXO database, for the txindex scenario the leveldb cache make\n+// a meaningful difference: https://github.com/bitcoin/bitcoin/pull/8273#issuecomment-229601991\n+//! Max memory allocated to tx index DB specific cache in bytes.\n+static constexpr size_t MAX_TX_INDEX_CACHE{1024_MiB};\n+//! Max memory allocated to all block filter index caches combined in bytes.\n+static constexpr size_t MAX_FILTER_INDEX_CACHE{1024_MiB};\n \n namespace node {\n CacheSizes CalculateCacheSizes(const ArgsManager& args, size_t n_indexes)\n {\n-    int64_t nTotalCache = (args.GetIntArg(\"-dbcache\", nDefaultDbCache) << 20);\n-    nTotalCache = std::max(nTotalCache, nMinDbCache << 20); // total cache cannot be less than nMinDbCache\n-    CacheSizes sizes;\n-    sizes.block_tree_db = std::min(nTotalCache / 8, nMaxBlockDBCache << 20);\n-    nTotalCache -= sizes.block_tree_db;\n-    sizes.tx_index = std::min(nTotalCache / 8, args.GetBoolArg(\"-txindex\", DEFAULT_TXINDEX) ? nMaxTxIndexCache << 20 : 0);\n-    nTotalCache -= sizes.tx_index;\n-    sizes.filter_index = 0;\n+    // Convert -dbcache from MiB units to bytes. The total chache is floored by MIN_DB_CACHE and capped by max size_t value.",
      "path": "src/node/caches.cpp",
      "position": null,
      "original_position": 31,
      "commit_id": "2a92702bafca5c78b270a9502a22cb9deac02cfc",
      "original_commit_id": "cf20c1b9e0b46cb8c4d4f93a054afd9c1f85e4e0",
      "in_reply_to_id": null,
      "user": {
        "login": "hodlinator",
        "id": 172445034,
        "node_id": "U_kgDOCkdNag",
        "avatar_url": "https://avatars.githubusercontent.com/u/172445034?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/hodlinator",
        "html_url": "https://github.com/hodlinator",
        "followers_url": "https://api.github.com/users/hodlinator/followers",
        "following_url": "https://api.github.com/users/hodlinator/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/hodlinator/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/hodlinator/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/hodlinator/subscriptions",
        "organizations_url": "https://api.github.com/users/hodlinator/orgs",
        "repos_url": "https://api.github.com/users/hodlinator/repos",
        "events_url": "https://api.github.com/users/hodlinator/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/hodlinator/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "nit: Typo\r\n```suggestion\r\n    // Convert -dbcache from MiB units to bytes. The total cache is floored by MIN_DB_CACHE and capped by max size_t value.\r\n```",
      "created_at": "2025-01-11T19:24:12Z",
      "updated_at": "2025-01-11T20:25:57Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31483#discussion_r1912179390",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1912179390"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31483"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 27,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1912181339",
      "pull_request_review_id": 2545133420,
      "id": 1912181339,
      "node_id": "PRRC_kwDOABII585x-ZJb",
      "diff_hunk": "@@ -1603,18 +1605,18 @@ bool AppInitMain(NodeContext& node, interfaces::BlockAndHeaderTipInfo* tip_info)\n     ReadNotificationArgs(args, kernel_notifications);\n \n     // cache size calculations\n-    CacheSizes cache_sizes = CalculateCacheSizes(args, g_enabled_filter_types.size());\n+    const auto [index_cache_sizes, kernel_cache_sizes] = CalculateCacheSizes(args, g_enabled_filter_types.size());",
      "path": "src/init.cpp",
      "position": 39,
      "original_position": 43,
      "commit_id": "2a92702bafca5c78b270a9502a22cb9deac02cfc",
      "original_commit_id": "cf20c1b9e0b46cb8c4d4f93a054afd9c1f85e4e0",
      "in_reply_to_id": null,
      "user": {
        "login": "hodlinator",
        "id": 172445034,
        "node_id": "U_kgDOCkdNag",
        "avatar_url": "https://avatars.githubusercontent.com/u/172445034?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/hodlinator",
        "html_url": "https://github.com/hodlinator",
        "followers_url": "https://api.github.com/users/hodlinator/followers",
        "following_url": "https://api.github.com/users/hodlinator/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/hodlinator/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/hodlinator/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/hodlinator/subscriptions",
        "organizations_url": "https://api.github.com/users/hodlinator/orgs",
        "repos_url": "https://api.github.com/users/hodlinator/repos",
        "events_url": "https://api.github.com/users/hodlinator/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/hodlinator/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "nit: Could have less churn on the line by making `InitAndLoadChainstate()` take `const` in the same commit where this line is first touched.",
      "created_at": "2025-01-11T19:27:23Z",
      "updated_at": "2025-01-11T20:25:57Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31483#discussion_r1912181339",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1912181339"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31483"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 1606,
      "original_line": 1606,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1912185410",
      "pull_request_review_id": 2545133420,
      "id": 1912185410,
      "node_id": "PRRC_kwDOABII585x-aJC",
      "diff_hunk": "@@ -47,4 +48,40 @@ template <class T>\n     return i + j;\n }\n \n+/**\n+ * @brief Left bit shift with overflow checking.\n+ * @param i The input value to be left shifted.\n+ * @param shift The number of bits to left shift.\n+ * @return The result of the left shift, or std::nullopt in case of\n+ *         overflow or negative input value.\n+ */\n+template <std::unsigned_integral Output, std::integral Input>\n+constexpr std::optional<Output> CheckedLeftShift(Input i, unsigned shift) noexcept\n+{\n+    if constexpr (std::is_signed_v<Input>) {\n+        if (i < 0) return std::nullopt;\n+    }\n+    if (std::make_unsigned_t<Input>(i) > Output(std::numeric_limits<Output>::max() >> shift)) {",
      "path": "src/util/overflow.h",
      "position": null,
      "original_position": 25,
      "commit_id": "2a92702bafca5c78b270a9502a22cb9deac02cfc",
      "original_commit_id": "cf20c1b9e0b46cb8c4d4f93a054afd9c1f85e4e0",
      "in_reply_to_id": null,
      "user": {
        "login": "hodlinator",
        "id": 172445034,
        "node_id": "U_kgDOCkdNag",
        "avatar_url": "https://avatars.githubusercontent.com/u/172445034?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/hodlinator",
        "html_url": "https://github.com/hodlinator",
        "followers_url": "https://api.github.com/users/hodlinator/followers",
        "following_url": "https://api.github.com/users/hodlinator/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/hodlinator/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/hodlinator/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/hodlinator/subscriptions",
        "organizations_url": "https://api.github.com/users/hodlinator/orgs",
        "repos_url": "https://api.github.com/users/hodlinator/repos",
        "events_url": "https://api.github.com/users/hodlinator/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/hodlinator/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "nit: Could modernize cast.\r\n```suggestion\r\n    if (std::make_unsigned_t<Input>(i) > Output{std::numeric_limits<Output>::max() >> shift}) {\r\n```",
      "created_at": "2025-01-11T19:34:24Z",
      "updated_at": "2025-01-11T20:25:57Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31483#discussion_r1912185410",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1912185410"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31483"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 64,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1912212037",
      "pull_request_review_id": 2545133420,
      "id": 1912212037,
      "node_id": "PRRC_kwDOABII585x-gpF",
      "diff_hunk": "@@ -0,0 +1,34 @@\n+// Copyright (c) 2024-present The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#ifndef BITCOIN_KERNEL_CACHES_H\n+#define BITCOIN_KERNEL_CACHES_H\n+\n+#include <util/byte_units.h>\n+\n+#include <algorithm>\n+\n+//! Max memory allocated to block tree DB specific cache (bytes)\n+static constexpr size_t MAX_BLOCK_DB_CACHE{2_MiB};\n+//! Max memory allocated to coin DB specific cache (bytes)\n+static constexpr size_t MAX_COINS_DB_CACHE{8_MiB};\n+\n+namespace kernel {\n+struct CacheSizes {\n+    size_t block_tree_db;\n+    size_t coins_db;\n+    size_t coins;\n+\n+    CacheSizes(size_t total_cache)\n+    {\n+        block_tree_db = std::min<size_t>(total_cache / 8, MAX_BLOCK_DB_CACHE);\n+        total_cache -= block_tree_db;\n+        coins_db = std::min<size_t>(total_cache / 2, MAX_COINS_DB_CACHE);",
      "path": "src/kernel/caches.h",
      "position": null,
      "original_position": 27,
      "commit_id": "2a92702bafca5c78b270a9502a22cb9deac02cfc",
      "original_commit_id": "4eebb638916ecf43cfd9237c7e8bb8da7bc397d7",
      "in_reply_to_id": null,
      "user": {
        "login": "hodlinator",
        "id": 172445034,
        "node_id": "U_kgDOCkdNag",
        "avatar_url": "https://avatars.githubusercontent.com/u/172445034?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/hodlinator",
        "html_url": "https://github.com/hodlinator",
        "followers_url": "https://api.github.com/users/hodlinator/followers",
        "following_url": "https://api.github.com/users/hodlinator/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/hodlinator/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/hodlinator/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/hodlinator/subscriptions",
        "organizations_url": "https://api.github.com/users/hodlinator/orgs",
        "repos_url": "https://api.github.com/users/hodlinator/repos",
        "events_url": "https://api.github.com/users/hodlinator/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/hodlinator/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "nit in commit 4eebb638916ecf43cfd9237c7e8bb8da7bc397d7:\r\nSeems like we could use `std::min` without the template parameter here from the start (it's removed later without parameter types changing, resulting in line churn).",
      "created_at": "2025-01-11T20:18:56Z",
      "updated_at": "2025-01-11T20:25:57Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31483#discussion_r1912212037",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1912212037"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31483"
        }
      },
      "start_line": null,
      "original_start_line": 25,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 27,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1912234840",
      "pull_request_review_id": 2545225625,
      "id": 1912234840,
      "node_id": "PRRC_kwDOABII585x-mNY",
      "diff_hunk": "@@ -47,4 +48,40 @@ template <class T>\n     return i + j;\n }\n \n+/**\n+ * @brief Left bit shift with overflow checking.\n+ * @param i The input value to be left shifted.\n+ * @param shift The number of bits to left shift.\n+ * @return The result of the left shift, or std::nullopt in case of\n+ *         overflow or negative input value.\n+ */\n+template <std::unsigned_integral Output, std::integral Input>\n+constexpr std::optional<Output> CheckedLeftShift(Input i, unsigned shift) noexcept\n+{\n+    if constexpr (std::is_signed_v<Input>) {\n+        if (i < 0) return std::nullopt;\n+    }\n+    if (std::make_unsigned_t<Input>(i) > Output(std::numeric_limits<Output>::max() >> shift)) {",
      "path": "src/util/overflow.h",
      "position": null,
      "original_position": 25,
      "commit_id": "2a92702bafca5c78b270a9502a22cb9deac02cfc",
      "original_commit_id": "cf20c1b9e0b46cb8c4d4f93a054afd9c1f85e4e0",
      "in_reply_to_id": 1912185410,
      "user": {
        "login": "TheCharlatan",
        "id": 8421793,
        "node_id": "MDQ6VXNlcjg0MjE3OTM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8421793?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/TheCharlatan",
        "html_url": "https://github.com/TheCharlatan",
        "followers_url": "https://api.github.com/users/TheCharlatan/followers",
        "following_url": "https://api.github.com/users/TheCharlatan/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/TheCharlatan/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/TheCharlatan/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/TheCharlatan/subscriptions",
        "organizations_url": "https://api.github.com/users/TheCharlatan/orgs",
        "repos_url": "https://api.github.com/users/TheCharlatan/repos",
        "events_url": "https://api.github.com/users/TheCharlatan/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/TheCharlatan/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "Using non-narrowing conversion should give you a compiler error. Allowing type narrowing here should be safe.",
      "created_at": "2025-01-11T20:58:14Z",
      "updated_at": "2025-01-11T20:58:15Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31483#discussion_r1912234840",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1912234840"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31483"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 64,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1912238290",
      "pull_request_review_id": 2545245484,
      "id": 1912238290,
      "node_id": "PRRC_kwDOABII585x-nDS",
      "diff_hunk": "@@ -47,4 +48,40 @@ template <class T>\n     return i + j;\n }\n \n+/**\n+ * @brief Left bit shift with overflow checking.\n+ * @param i The input value to be left shifted.\n+ * @param shift The number of bits to left shift.\n+ * @return The result of the left shift, or std::nullopt in case of\n+ *         overflow or negative input value.\n+ */\n+template <std::unsigned_integral Output, std::integral Input>\n+constexpr std::optional<Output> CheckedLeftShift(Input i, unsigned shift) noexcept\n+{\n+    if constexpr (std::is_signed_v<Input>) {\n+        if (i < 0) return std::nullopt;\n+    }\n+    if (std::make_unsigned_t<Input>(i) > Output(std::numeric_limits<Output>::max() >> shift)) {",
      "path": "src/util/overflow.h",
      "position": null,
      "original_position": 25,
      "commit_id": "2a92702bafca5c78b270a9502a22cb9deac02cfc",
      "original_commit_id": "cf20c1b9e0b46cb8c4d4f93a054afd9c1f85e4e0",
      "in_reply_to_id": 1912185410,
      "user": {
        "login": "hodlinator",
        "id": 172445034,
        "node_id": "U_kgDOCkdNag",
        "avatar_url": "https://avatars.githubusercontent.com/u/172445034?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/hodlinator",
        "html_url": "https://github.com/hodlinator",
        "followers_url": "https://api.github.com/users/hodlinator/followers",
        "following_url": "https://api.github.com/users/hodlinator/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/hodlinator/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/hodlinator/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/hodlinator/subscriptions",
        "organizations_url": "https://api.github.com/users/hodlinator/orgs",
        "repos_url": "https://api.github.com/users/hodlinator/repos",
        "events_url": "https://api.github.com/users/hodlinator/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/hodlinator/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "In thread https://github.com/bitcoin/bitcoin/pull/31483#discussion_r1912185410:\r\nWhat the.. could have sworn my suggestion compiled without warnings, but now I get them. Sorry.",
      "created_at": "2025-01-11T21:10:13Z",
      "updated_at": "2025-01-11T21:11:43Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31483#discussion_r1912238290",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1912238290"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31483"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 64,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1912972952",
      "pull_request_review_id": 2546242450,
      "id": 1912972952,
      "node_id": "PRRC_kwDOABII585yBaaY",
      "diff_hunk": "@@ -47,4 +48,40 @@ template <class T>\n     return i + j;\n }\n \n+/**\n+ * @brief Left bit shift with overflow checking.\n+ * @param i The input value to be left shifted.\n+ * @param shift The number of bits to left shift.\n+ * @return The result of the left shift, or std::nullopt in case of\n+ *         overflow or negative input value.\n+ */\n+template <std::unsigned_integral Output, std::integral Input>\n+constexpr std::optional<Output> CheckedLeftShift(Input i, unsigned shift) noexcept",
      "path": "src/util/overflow.h",
      "position": null,
      "original_position": 20,
      "commit_id": "2a92702bafca5c78b270a9502a22cb9deac02cfc",
      "original_commit_id": "e0a541702def3a4c6cce8e44b6ebe8d608edad4e",
      "in_reply_to_id": null,
      "user": {
        "login": "stickies-v",
        "id": 69010457,
        "node_id": "MDQ6VXNlcjY5MDEwNDU3",
        "avatar_url": "https://avatars.githubusercontent.com/u/69010457?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stickies-v",
        "html_url": "https://github.com/stickies-v",
        "followers_url": "https://api.github.com/users/stickies-v/followers",
        "following_url": "https://api.github.com/users/stickies-v/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stickies-v/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stickies-v/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stickies-v/subscriptions",
        "organizations_url": "https://api.github.com/users/stickies-v/orgs",
        "repos_url": "https://api.github.com/users/stickies-v/repos",
        "events_url": "https://api.github.com/users/stickies-v/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stickies-v/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "in e0a541702def3a4c6cce8e44b6ebe8d608edad4e:\r\nnit: would prefer replacing `i` with `input` (I'm sorry for not doing this in my initial suggestion)\r\n\r\n<details>\r\n<summary>git diff on e0a541702d</summary>\r\n\r\n```diff\r\ndiff --git a/src/util/overflow.h b/src/util/overflow.h\r\nindex a0698f5c69..c35e44690a 100644\r\n--- a/src/util/overflow.h\r\n+++ b/src/util/overflow.h\r\n@@ -50,38 +50,38 @@ template <class T>\r\n \r\n /**\r\n  * @brief Left bit shift with overflow checking.\r\n- * @param i The input value to be left shifted.\r\n+ * @param input The input value to be left shifted.\r\n  * @param shift The number of bits to left shift.\r\n  * @return The result of the left shift, or std::nullopt in case of\r\n  *         overflow or negative input value.\r\n  */\r\n template <std::unsigned_integral Output, std::integral Input>\r\n-constexpr std::optional<Output> CheckedLeftShift(Input i, unsigned shift) noexcept\r\n+constexpr std::optional<Output> CheckedLeftShift(Input input, unsigned shift) noexcept\r\n {\r\n     if constexpr (std::is_signed_v<Input>) {\r\n-        if (i < 0) return std::nullopt;\r\n+        if (input < 0) return std::nullopt;\r\n     }\r\n-    if (std::make_unsigned_t<Input>(i) > Output(std::numeric_limits<Output>::max() >> shift)) {\r\n+    if (std::make_unsigned_t<Input>(input) > Output(std::numeric_limits<Output>::max() >> shift)) {\r\n         return std::nullopt;\r\n     }\r\n-    return i << shift;\r\n+    return input << shift;\r\n }\r\n \r\n /**\r\n  * @brief Left bit shift with safe minimum and maximum values.\r\n- * @param i The input value to be left shifted.\r\n+ * @param input The input value to be left shifted.\r\n  * @param shift The number of bits to left shift.\r\n  * @return The result of the left shift, with the return value clamped\r\n  *         between zero and the maximum Output value if overflow occurs.\r\n  */\r\n template <std::unsigned_integral Output, std::integral Input>\r\n-constexpr Output SaturatingLeftShift(Input i, unsigned shift) noexcept\r\n+constexpr Output SaturatingLeftShift(Input input, unsigned shift) noexcept\r\n {\r\n     auto default_value{std::numeric_limits<Output>::max()};\r\n     if constexpr (std::is_signed_v<Input>) {\r\n-        if (i < 0) default_value = 0;\r\n+        if (input < 0) default_value = 0;\r\n     }\r\n-    return CheckedLeftShift<Output>(i, shift).value_or(default_value);\r\n+    return CheckedLeftShift<Output>(input, shift).value_or(default_value);\r\n }\r\n \r\n #endif // BITCOIN_UTIL_OVERFLOW_H\r\n\r\n```\r\n</details>\r\n",
      "created_at": "2025-01-13T10:29:28Z",
      "updated_at": "2025-01-13T15:06:12Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31483#discussion_r1912972952",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1912972952"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31483"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 59,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1913008528",
      "pull_request_review_id": 2546242450,
      "id": 1913008528,
      "node_id": "PRRC_kwDOABII585yBjGQ",
      "diff_hunk": "@@ -47,4 +48,40 @@ template <class T>\n     return i + j;\n }\n \n+/**\n+ * @brief Left bit shift with overflow checking.\n+ * @param i The input value to be left shifted.\n+ * @param shift The number of bits to left shift.\n+ * @return The result of the left shift, or std::nullopt in case of\n+ *         overflow or negative input value.\n+ */\n+template <std::unsigned_integral Output, std::integral Input>\n+constexpr std::optional<Output> CheckedLeftShift(Input i, unsigned shift) noexcept\n+{\n+    if constexpr (std::is_signed_v<Input>) {\n+        if (i < 0) return std::nullopt;\n+    }\n+    if (std::make_unsigned_t<Input>(i) > Output(std::numeric_limits<Output>::max() >> shift)) {",
      "path": "src/util/overflow.h",
      "position": null,
      "original_position": 25,
      "commit_id": "2a92702bafca5c78b270a9502a22cb9deac02cfc",
      "original_commit_id": "e0a541702def3a4c6cce8e44b6ebe8d608edad4e",
      "in_reply_to_id": null,
      "user": {
        "login": "stickies-v",
        "id": 69010457,
        "node_id": "MDQ6VXNlcjY5MDEwNDU3",
        "avatar_url": "https://avatars.githubusercontent.com/u/69010457?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stickies-v",
        "html_url": "https://github.com/stickies-v",
        "followers_url": "https://api.github.com/users/stickies-v/followers",
        "following_url": "https://api.github.com/users/stickies-v/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stickies-v/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stickies-v/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stickies-v/subscriptions",
        "organizations_url": "https://api.github.com/users/stickies-v/orgs",
        "repos_url": "https://api.github.com/users/stickies-v/repos",
        "events_url": "https://api.github.com/users/stickies-v/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stickies-v/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "in e0a541702def3a4c6cce8e44b6ebe8d608edad4e:\r\n\r\nRight-shifting by more bits than the width of Output is UB, so we should probably add an extra check for that. I've also added some test cases, but interestingly they don't seem to trigger UBSan (without the `util/overflow.h` patch) on my machine:\r\n\r\n<details>\r\n<summary>git diff on e0a541702d</summary>\r\n\r\n```diff\r\ndiff --git a/src/test/util_tests.cpp b/src/test/util_tests.cpp\r\nindex 09ba278d3a..ae292d7761 100644\r\n--- a/src/test/util_tests.cpp\r\n+++ b/src/test/util_tests.cpp\r\n@@ -1897,6 +1897,7 @@ void TestCheckedLeftShift()\r\n         // Overflow cases\r\n         BOOST_CHECK(!CheckedLeftShift<T>((MAX >> 1) + 1, 1));\r\n         BOOST_CHECK(!CheckedLeftShift<T>(MAX, 1));\r\n+        BOOST_CHECK(!CheckedLeftShift<T>(1, std::numeric_limits<T>::digits + 1));\r\n     }\r\n }\r\n \r\n@@ -1919,6 +1920,8 @@ void TestSaturatingLeftShift()\r\n         // Saturation cases\r\n         BOOST_CHECK_EQUAL(SaturatingLeftShift<T>((MAX >> 1) + 1, 1), MAX);\r\n         BOOST_CHECK_EQUAL(SaturatingLeftShift<T>(MAX, 1), MAX);\r\n+        BOOST_CHECK_EQUAL(SaturatingLeftShift<T>(-1, std::numeric_limits<T>::digits + 1), 0);\r\n+        BOOST_CHECK_EQUAL(SaturatingLeftShift<T>(1, std::numeric_limits<T>::digits + 1), MAX);\r\n     }\r\n }\r\n \r\ndiff --git a/src/util/overflow.h b/src/util/overflow.h\r\nindex a0698f5c69..d85f5b9c9d 100644\r\n--- a/src/util/overflow.h\r\n+++ b/src/util/overflow.h\r\n@@ -61,7 +61,8 @@ constexpr std::optional<Output> CheckedLeftShift(Input i, unsigned shift) noexce\r\n     if constexpr (std::is_signed_v<Input>) {\r\n         if (i < 0) return std::nullopt;\r\n     }\r\n-    if (std::make_unsigned_t<Input>(i) > Output(std::numeric_limits<Output>::max() >> shift)) {\r\n+    if (shift >= std::numeric_limits<Input>::digits ||\r\n+        std::make_unsigned_t<Input>(i) > Output(std::numeric_limits<Output>::max() >> shift)) {\r\n         return std::nullopt;\r\n     }\r\n     return i << shift;\r\n\r\n```\r\n</details>\r\n\r\n\r\n",
      "created_at": "2025-01-13T10:57:34Z",
      "updated_at": "2025-01-13T15:06:12Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31483#discussion_r1913008528",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1913008528"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31483"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 64,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1913070129",
      "pull_request_review_id": 2546242450,
      "id": 1913070129,
      "node_id": "PRRC_kwDOABII585yByIx",
      "diff_hunk": "@@ -47,4 +48,40 @@ template <class T>\n     return i + j;\n }\n \n+/**\n+ * @brief Left bit shift with overflow checking.\n+ * @param i The input value to be left shifted.\n+ * @param shift The number of bits to left shift.\n+ * @return The result of the left shift, or std::nullopt in case of\n+ *         overflow or negative input value.\n+ */\n+template <std::unsigned_integral Output, std::integral Input>\n+constexpr std::optional<Output> CheckedLeftShift(Input i, unsigned shift) noexcept\n+{\n+    if constexpr (std::is_signed_v<Input>) {\n+        if (i < 0) return std::nullopt;\n+    }\n+    if (std::make_unsigned_t<Input>(i) > Output(std::numeric_limits<Output>::max() >> shift)) {\n+        return std::nullopt;\n+    }\n+    return i << shift;\n+}\n+\n+/**\n+ * @brief Left bit shift with safe minimum and maximum values.\n+ * @param i The input value to be left shifted.\n+ * @param shift The number of bits to left shift.\n+ * @return The result of the left shift, with the return value clamped\n+ *         between zero and the maximum Output value if overflow occurs.\n+ */\n+template <std::unsigned_integral Output, std::integral Input>\n+constexpr Output SaturatingLeftShift(Input i, unsigned shift) noexcept\n+{\n+    auto default_value{std::numeric_limits<Output>::max()};\n+    if constexpr (std::is_signed_v<Input>) {\n+        if (i < 0) default_value = 0;\n+    }",
      "path": "src/util/overflow.h",
      "position": null,
      "original_position": 44,
      "commit_id": "2a92702bafca5c78b270a9502a22cb9deac02cfc",
      "original_commit_id": "e0a541702def3a4c6cce8e44b6ebe8d608edad4e",
      "in_reply_to_id": null,
      "user": {
        "login": "stickies-v",
        "id": 69010457,
        "node_id": "MDQ6VXNlcjY5MDEwNDU3",
        "avatar_url": "https://avatars.githubusercontent.com/u/69010457?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stickies-v",
        "html_url": "https://github.com/stickies-v",
        "followers_url": "https://api.github.com/users/stickies-v/followers",
        "following_url": "https://api.github.com/users/stickies-v/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stickies-v/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stickies-v/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stickies-v/subscriptions",
        "organizations_url": "https://api.github.com/users/stickies-v/orgs",
        "repos_url": "https://api.github.com/users/stickies-v/repos",
        "events_url": "https://api.github.com/users/stickies-v/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stickies-v/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "in e0a541702def3a4c6cce8e44b6ebe8d608edad4e:\r\n\r\nSaturated left shifting a 0-input should probably always return a 0-output, so suggested update (+ tests, one depending on my [other comment re right-shift UB](https://github.com/bitcoin/bitcoin/pull/31483#discussion_r1913008528)):\r\n\r\n<details>\r\n<summary>git diff on e0a541702d</summary>\r\n\r\n```diff\r\ndiff --git a/src/test/util_tests.cpp b/src/test/util_tests.cpp\r\nindex 09ba278d3a..07b98be446 100644\r\n--- a/src/test/util_tests.cpp\r\n+++ b/src/test/util_tests.cpp\r\n@@ -1897,6 +1897,7 @@ void TestCheckedLeftShift()\r\n         // Overflow cases\r\n         BOOST_CHECK(!CheckedLeftShift<T>((MAX >> 1) + 1, 1));\r\n         BOOST_CHECK(!CheckedLeftShift<T>(MAX, 1));\r\n+        // BOOST_CHECK(!CheckedLeftShift<T>(0, std::numeric_limits<T>::digits + 1));  // TODO: requires right-shift overflow check to pass\r\n     }\r\n }\r\n \r\n@@ -1919,6 +1920,7 @@ void TestSaturatingLeftShift()\r\n         // Saturation cases\r\n         BOOST_CHECK_EQUAL(SaturatingLeftShift<T>((MAX >> 1) + 1, 1), MAX);\r\n         BOOST_CHECK_EQUAL(SaturatingLeftShift<T>(MAX, 1), MAX);\r\n+        BOOST_CHECK_EQUAL(SaturatingLeftShift<T>(0, std::numeric_limits<T>::digits + 1), 0);\r\n     }\r\n }\r\n \r\ndiff --git a/src/util/overflow.h b/src/util/overflow.h\r\nindex a0698f5c69..f9e1fe4e82 100644\r\n--- a/src/util/overflow.h\r\n+++ b/src/util/overflow.h\r\n@@ -77,10 +77,7 @@ constexpr std::optional<Output> CheckedLeftShift(Input i, unsigned shift) noexce\r\n template <std::unsigned_integral Output, std::integral Input>\r\n constexpr Output SaturatingLeftShift(Input i, unsigned shift) noexcept\r\n {\r\n-    auto default_value{std::numeric_limits<Output>::max()};\r\n-    if constexpr (std::is_signed_v<Input>) {\r\n-        if (i < 0) default_value = 0;\r\n-    }\r\n+    auto default_value{i <= 0 ? 0 : std::numeric_limits<Output>::max()};\r\n     return CheckedLeftShift<Output>(i, shift).value_or(default_value);\r\n }\r\n \r\n\r\n```\r\n</details>\r\n\r\n\r\n",
      "created_at": "2025-01-13T11:50:43Z",
      "updated_at": "2025-01-13T15:16:15Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31483#discussion_r1913070129",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1913070129"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31483"
        }
      },
      "start_line": null,
      "original_start_line": 81,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 83,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1913090648",
      "pull_request_review_id": 2546242450,
      "id": 1913090648,
      "node_id": "PRRC_kwDOABII585yB3JY",
      "diff_hunk": "@@ -24,9 +26,6 @@ CacheSizes CalculateCacheSizes(const ArgsManager& args, size_t n_indexes)\n         sizes.filter_index = max_cache / n_indexes;\n         nTotalCache -= sizes.filter_index * n_indexes;\n     }\n-    sizes.coins_db = std::min(nTotalCache / 2, nMaxCoinsDBCache << 20);\n-    nTotalCache -= sizes.coins_db;\n-    sizes.coins = nTotalCache; // the rest goes to in-memory cache\n-    return sizes;\n+    return {sizes, kernel::CacheSizes{static_cast<size_t>(nTotalCache)}};",
      "path": "src/node/caches.cpp",
      "position": null,
      "original_position": 30,
      "commit_id": "2a92702bafca5c78b270a9502a22cb9deac02cfc",
      "original_commit_id": "ccf8caa4430f57b8f148e96ac2a241221977bcab",
      "in_reply_to_id": null,
      "user": {
        "login": "stickies-v",
        "id": 69010457,
        "node_id": "MDQ6VXNlcjY5MDEwNDU3",
        "avatar_url": "https://avatars.githubusercontent.com/u/69010457?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stickies-v",
        "html_url": "https://github.com/stickies-v",
        "followers_url": "https://api.github.com/users/stickies-v/followers",
        "following_url": "https://api.github.com/users/stickies-v/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stickies-v/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stickies-v/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stickies-v/subscriptions",
        "organizations_url": "https://api.github.com/users/stickies-v/orgs",
        "repos_url": "https://api.github.com/users/stickies-v/repos",
        "events_url": "https://api.github.com/users/stickies-v/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stickies-v/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "in ccf8caa4430f57b8f148e96ac2a241221977bcab\r\n\r\nnote/nit: this can overflow on 32 bit machines. It is fixed in later commits, and I think fixing it in this commit would be overly verbose, but I'm mentioning it in case there are further code changes that could make this problematic again.",
      "created_at": "2025-01-13T12:09:33Z",
      "updated_at": "2025-01-13T15:06:12Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31483#discussion_r1913090648",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1913090648"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31483"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 29,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1913095820",
      "pull_request_review_id": 2546242450,
      "id": 1913095820,
      "node_id": "PRRC_kwDOABII585yB4aM",
      "diff_hunk": "@@ -29,6 +29,8 @@\n #include <memory>\n #include <vector>\n \n+using kernel::CacheSizes;",
      "path": "src/node/chainstate.cpp",
      "position": 15,
      "original_position": 15,
      "commit_id": "2a92702bafca5c78b270a9502a22cb9deac02cfc",
      "original_commit_id": "ccf8caa4430f57b8f148e96ac2a241221977bcab",
      "in_reply_to_id": null,
      "user": {
        "login": "stickies-v",
        "id": 69010457,
        "node_id": "MDQ6VXNlcjY5MDEwNDU3",
        "avatar_url": "https://avatars.githubusercontent.com/u/69010457?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stickies-v",
        "html_url": "https://github.com/stickies-v",
        "followers_url": "https://api.github.com/users/stickies-v/followers",
        "following_url": "https://api.github.com/users/stickies-v/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stickies-v/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stickies-v/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stickies-v/subscriptions",
        "organizations_url": "https://api.github.com/users/stickies-v/orgs",
        "repos_url": "https://api.github.com/users/stickies-v/repos",
        "events_url": "https://api.github.com/users/stickies-v/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stickies-v/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "in ccf8caa4430f57b8f148e96ac2a241221977bcab\r\n\r\nnit: I've raised this before, but since we now have a `kernel::CacheSizes` and `node::CacheSizes`, I think `using` a `kernel::CacheSizes` in a `node` file is unnecessarily confusing, so I would prefer making this explicit (as in the `chainstate.h` file):\r\n\r\n<details>\r\n<summary>git diff on ccf8caa443</summary>\r\n\r\n```diff\r\ndiff --git a/src/node/chainstate.cpp b/src/node/chainstate.cpp\r\nindex 660d2c3289..d4d8828f73 100644\r\n--- a/src/node/chainstate.cpp\r\n+++ b/src/node/chainstate.cpp\r\n@@ -29,14 +29,12 @@\r\n #include <memory>\r\n #include <vector>\r\n \r\n-using kernel::CacheSizes;\r\n-\r\n namespace node {\r\n // Complete initialization of chainstates after the initial call has been made\r\n // to ChainstateManager::InitializeChainstate().\r\n static ChainstateLoadResult CompleteChainstateInitialization(\r\n     ChainstateManager& chainman,\r\n-    const CacheSizes& cache_sizes,\r\n+    const kernel::CacheSizes& cache_sizes,\r\n     const ChainstateLoadOptions& options) EXCLUSIVE_LOCKS_REQUIRED(::cs_main)\r\n {\r\n     auto& pblocktree{chainman.m_blockman.m_block_tree_db};\r\n@@ -172,7 +170,7 @@ static ChainstateLoadResult CompleteChainstateInitialization(\r\n     return {ChainstateLoadStatus::SUCCESS, {}};\r\n }\r\n \r\n-ChainstateLoadResult LoadChainstate(ChainstateManager& chainman, const CacheSizes& cache_sizes,\r\n+ChainstateLoadResult LoadChainstate(ChainstateManager& chainman, const kernel::CacheSizes& cache_sizes,\r\n                                     const ChainstateLoadOptions& options)\r\n {\r\n     if (!chainman.AssumedValidBlock().IsNull()) {\r\n\r\n```\r\n</details>\r\n",
      "created_at": "2025-01-13T12:13:49Z",
      "updated_at": "2025-01-13T15:06:12Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31483#discussion_r1913095820",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1913095820"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31483"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 32,
      "original_line": 32,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1913290613",
      "pull_request_review_id": 2546242450,
      "id": 1913290613,
      "node_id": "PRRC_kwDOABII585yCn91",
      "diff_hunk": "@@ -7,31 +7,38 @@\n #include <common/args.h>\n #include <index/txindex.h>\n #include <kernel/caches.h>\n+#include <logging.h>\n+#include <util/byte_units.h>\n \n #include <algorithm>\n+#include <optional>",
      "path": "src/node/caches.cpp",
      "position": null,
      "original_position": 8,
      "commit_id": "2a92702bafca5c78b270a9502a22cb9deac02cfc",
      "original_commit_id": "0e2887262e1a3a4a5ab0382f9e8713b135408a77",
      "in_reply_to_id": null,
      "user": {
        "login": "stickies-v",
        "id": 69010457,
        "node_id": "MDQ6VXNlcjY5MDEwNDU3",
        "avatar_url": "https://avatars.githubusercontent.com/u/69010457?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stickies-v",
        "html_url": "https://github.com/stickies-v",
        "followers_url": "https://api.github.com/users/stickies-v/followers",
        "following_url": "https://api.github.com/users/stickies-v/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stickies-v/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stickies-v/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stickies-v/subscriptions",
        "organizations_url": "https://api.github.com/users/stickies-v/orgs",
        "repos_url": "https://api.github.com/users/stickies-v/repos",
        "events_url": "https://api.github.com/users/stickies-v/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stickies-v/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "in 0e2887262e1a3a4a5ab0382f9e8713b135408a77\r\n\r\nnit: optional header no longer necessary",
      "created_at": "2025-01-13T14:35:15Z",
      "updated_at": "2025-01-13T15:06:12Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31483#discussion_r1913290613",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1913290613"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31483"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 14,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1913307791",
      "pull_request_review_id": 2546242450,
      "id": 1913307791,
      "node_id": "PRRC_kwDOABII585yCsKP",
      "diff_hunk": "@@ -7,31 +7,38 @@\n #include <common/args.h>\n #include <index/txindex.h>\n #include <kernel/caches.h>\n+#include <logging.h>\n+#include <util/byte_units.h>\n \n #include <algorithm>\n+#include <optional>\n #include <string>\n \n // Unlike for the UTXO database, for the txindex scenario the leveldb cache make\n // a meaningful difference: https://github.com/bitcoin/bitcoin/pull/8273#issuecomment-229601991\n-//! Max memory allocated to tx index DB specific cache in MiB.\n-static constexpr int64_t MAX_TX_INDEX_CACHE{1024};\n-//! Max memory allocated to all block filter index caches combined in MiB.\n-static constexpr int64_t MAX_FILTER_INDEX_CACHE{1024};\n+//! Max memory allocated to tx index DB specific cache in bytes.\n+static constexpr size_t MAX_TX_INDEX_CACHE{1024_MiB};\n+//! Max memory allocated to all block filter index caches combined in bytes.\n+static constexpr size_t MAX_FILTER_INDEX_CACHE{1024_MiB};\n \n namespace node {\n CacheSizes CalculateCacheSizes(const ArgsManager& args, size_t n_indexes)\n {\n-    int64_t nTotalCache = (args.GetIntArg(\"-dbcache\", DEFAULT_DB_CACHE) << 20);\n-    nTotalCache = std::max(nTotalCache, MIN_DB_CACHE << 20);\n-    IndexCacheSizes sizes;\n-    sizes.tx_index = std::min(nTotalCache / 8, args.GetBoolArg(\"-txindex\", DEFAULT_TXINDEX) ? MAX_TX_INDEX_CACHE << 20 : 0);\n-    nTotalCache -= sizes.tx_index;\n-    sizes.filter_index = 0;\n+    // Convert -dbcache from MiB units to bytes. The total cache is floored by MIN_DB_CACHE and capped by max size_t value.\n+    size_t total_cache{DEFAULT_DB_CACHE};\n+    if (auto db_cache = args.GetIntArg(\"-dbcache\")) {\n+        total_cache = std::max(MIN_DB_CACHE, SaturatingLeftShift<size_t>(*db_cache, 20));\n+    }\n+\n+    IndexCacheSizes index_sizes;\n+    index_sizes.tx_index = std::min(total_cache / 8, args.GetBoolArg(\"-txindex\", DEFAULT_TXINDEX) ? MAX_TX_INDEX_CACHE : 0);\n+    total_cache -= index_sizes.tx_index;\n+    index_sizes.filter_index = 0;",
      "path": "src/node/caches.cpp",
      "position": null,
      "original_position": 40,
      "commit_id": "2a92702bafca5c78b270a9502a22cb9deac02cfc",
      "original_commit_id": "0e2887262e1a3a4a5ab0382f9e8713b135408a77",
      "in_reply_to_id": null,
      "user": {
        "login": "stickies-v",
        "id": 69010457,
        "node_id": "MDQ6VXNlcjY5MDEwNDU3",
        "avatar_url": "https://avatars.githubusercontent.com/u/69010457?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stickies-v",
        "html_url": "https://github.com/stickies-v",
        "followers_url": "https://api.github.com/users/stickies-v/followers",
        "following_url": "https://api.github.com/users/stickies-v/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stickies-v/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stickies-v/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stickies-v/subscriptions",
        "organizations_url": "https://api.github.com/users/stickies-v/orgs",
        "repos_url": "https://api.github.com/users/stickies-v/repos",
        "events_url": "https://api.github.com/users/stickies-v/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stickies-v/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "in 0e2887262e\r\n\r\nnit: I would default-initialize `IndexCacheSizes` members to 0, avoiding potential issues of accessing uninitialized members (and removing the need for this line):\r\n\r\n<details>\r\n<summary>git diff on 0e2887262e</summary>\r\n\r\n```diff\r\ndiff --git a/src/node/caches.cpp b/src/node/caches.cpp\r\nindex 0e0305cd19..f4fbb7ead9 100644\r\n--- a/src/node/caches.cpp\r\n+++ b/src/node/caches.cpp\r\n@@ -33,7 +33,6 @@ CacheSizes CalculateCacheSizes(const ArgsManager& args, size_t n_indexes)\r\n     IndexCacheSizes index_sizes;\r\n     index_sizes.tx_index = std::min(total_cache / 8, args.GetBoolArg(\"-txindex\", DEFAULT_TXINDEX) ? MAX_TX_INDEX_CACHE : 0);\r\n     total_cache -= index_sizes.tx_index;\r\n-    index_sizes.filter_index = 0;\r\n     if (n_indexes > 0) {\r\n         int64_t max_cache = std::min(total_cache / 8, MAX_FILTER_INDEX_CACHE);\r\n         index_sizes.filter_index = max_cache / n_indexes;\r\ndiff --git a/src/node/caches.h b/src/node/caches.h\r\nindex 0f916c7e5b..f24e9cc910 100644\r\n--- a/src/node/caches.h\r\n+++ b/src/node/caches.h\r\n@@ -19,8 +19,8 @@ static constexpr size_t DEFAULT_DB_CACHE{DEFAULT_KERNEL_CACHE};\r\n \r\n namespace node {\r\n struct IndexCacheSizes {\r\n-    size_t tx_index;\r\n-    size_t filter_index;\r\n+    size_t tx_index{0};\r\n+    size_t filter_index{0};\r\n };\r\n struct CacheSizes {\r\n     IndexCacheSizes index;\r\n\r\n```\r\n</details>\r\n",
      "created_at": "2025-01-13T14:45:34Z",
      "updated_at": "2025-01-13T15:06:12Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31483#discussion_r1913307791",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1913307791"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31483"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 36,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1913317790",
      "pull_request_review_id": 2546242450,
      "id": 1913317790,
      "node_id": "PRRC_kwDOABII585yCume",
      "diff_hunk": "@@ -6,28 +6,39 @@\n \n #include <common/args.h>\n #include <index/txindex.h>\n-#include <txdb.h>\n+#include <kernel/caches.h>\n+#include <logging.h>\n+#include <util/byte_units.h>\n+\n+#include <algorithm>\n+#include <optional>\n+#include <string>\n+\n+// Unlike for the UTXO database, for the txindex scenario the leveldb cache make\n+// a meaningful difference: https://github.com/bitcoin/bitcoin/pull/8273#issuecomment-229601991\n+//! Max memory allocated to tx index DB specific cache in bytes.\n+static constexpr size_t MAX_TX_INDEX_CACHE{1024_MiB};\n+//! Max memory allocated to all block filter index caches combined in bytes.\n+static constexpr size_t MAX_FILTER_INDEX_CACHE{1024_MiB};\n \n namespace node {\n CacheSizes CalculateCacheSizes(const ArgsManager& args, size_t n_indexes)\n {\n-    int64_t nTotalCache = (args.GetIntArg(\"-dbcache\", nDefaultDbCache) << 20);\n-    nTotalCache = std::max(nTotalCache, nMinDbCache << 20); // total cache cannot be less than nMinDbCache\n-    CacheSizes sizes;\n-    sizes.block_tree_db = std::min(nTotalCache / 8, nMaxBlockDBCache << 20);\n-    nTotalCache -= sizes.block_tree_db;\n-    sizes.tx_index = std::min(nTotalCache / 8, args.GetBoolArg(\"-txindex\", DEFAULT_TXINDEX) ? nMaxTxIndexCache << 20 : 0);\n-    nTotalCache -= sizes.tx_index;\n-    sizes.filter_index = 0;\n+    // Convert -dbcache from MiB units to bytes. The total cache is floored by MIN_DB_CACHE and capped by max size_t value.\n+    size_t total_cache{DEFAULT_DB_CACHE};\n+    if (auto db_cache = args.GetIntArg(\"-dbcache\")) {\n+        total_cache = std::max(MIN_DB_CACHE, SaturatingLeftShift<size_t>(*db_cache, 20));\n+    }\n+\n+    IndexCacheSizes index_sizes;\n+    index_sizes.tx_index = std::min(total_cache / 8, args.GetBoolArg(\"-txindex\", DEFAULT_TXINDEX) ? MAX_TX_INDEX_CACHE : 0);\n+    total_cache -= index_sizes.tx_index;\n+    index_sizes.filter_index = 0;\n     if (n_indexes > 0) {\n-        int64_t max_cache = std::min(nTotalCache / 8, max_filter_index_cache << 20);\n-        sizes.filter_index = max_cache / n_indexes;\n-        nTotalCache -= sizes.filter_index * n_indexes;\n+        int64_t max_cache = std::min(total_cache / 8, MAX_FILTER_INDEX_CACHE);",
      "path": "src/node/caches.cpp",
      "position": null,
      "original_position": 45,
      "commit_id": "2a92702bafca5c78b270a9502a22cb9deac02cfc",
      "original_commit_id": "0e2887262e1a3a4a5ab0382f9e8713b135408a77",
      "in_reply_to_id": null,
      "user": {
        "login": "stickies-v",
        "id": 69010457,
        "node_id": "MDQ6VXNlcjY5MDEwNDU3",
        "avatar_url": "https://avatars.githubusercontent.com/u/69010457?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stickies-v",
        "html_url": "https://github.com/stickies-v",
        "followers_url": "https://api.github.com/users/stickies-v/followers",
        "following_url": "https://api.github.com/users/stickies-v/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stickies-v/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stickies-v/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stickies-v/subscriptions",
        "organizations_url": "https://api.github.com/users/stickies-v/orgs",
        "repos_url": "https://api.github.com/users/stickies-v/repos",
        "events_url": "https://api.github.com/users/stickies-v/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stickies-v/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "in 0e2887262e1a3a4a5ab0382f9e8713b135408a77\r\n\r\nnit: this should now also be a `size_t`\r\n\r\n```suggestion\r\n        size_t max_cache{std::min(total_cache / 8, MAX_FILTER_INDEX_CACHE)};\r\n```",
      "created_at": "2025-01-13T14:51:38Z",
      "updated_at": "2025-01-13T15:06:12Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31483#discussion_r1913317790",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1913317790"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31483"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 38,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1913521985",
      "pull_request_review_id": 2547263536,
      "id": 1913521985,
      "node_id": "PRRC_kwDOABII585yDgdB",
      "diff_hunk": "@@ -47,4 +48,40 @@ template <class T>\n     return i + j;\n }\n \n+/**\n+ * @brief Left bit shift with overflow checking.\n+ * @param i The input value to be left shifted.\n+ * @param shift The number of bits to left shift.\n+ * @return The result of the left shift, or std::nullopt in case of\n+ *         overflow or negative input value.\n+ */\n+template <std::unsigned_integral Output, std::integral Input>\n+constexpr std::optional<Output> CheckedLeftShift(Input i, unsigned shift) noexcept\n+{\n+    if constexpr (std::is_signed_v<Input>) {\n+        if (i < 0) return std::nullopt;\n+    }\n+    if (std::make_unsigned_t<Input>(i) > Output(std::numeric_limits<Output>::max() >> shift)) {\n+        return std::nullopt;\n+    }\n+    return i << shift;\n+}\n+\n+/**\n+ * @brief Left bit shift with safe minimum and maximum values.\n+ * @param i The input value to be left shifted.\n+ * @param shift The number of bits to left shift.\n+ * @return The result of the left shift, with the return value clamped\n+ *         between zero and the maximum Output value if overflow occurs.\n+ */\n+template <std::unsigned_integral Output, std::integral Input>\n+constexpr Output SaturatingLeftShift(Input i, unsigned shift) noexcept",
      "path": "src/util/overflow.h",
      "position": null,
      "original_position": 39,
      "commit_id": "2a92702bafca5c78b270a9502a22cb9deac02cfc",
      "original_commit_id": "e0a541702def3a4c6cce8e44b6ebe8d608edad4e",
      "in_reply_to_id": null,
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "In commit \"util: Add integer left shift helpers\" (e0a541702def3a4c6cce8e44b6ebe8d608edad4e)\r\n\r\nIt seems wrong that calling `SaturatingLeftShift` on a negative input can wrap around to 0. The point of saturating operations should be that they don't wrap around, but effectively perform operations with full precision and just clamp the result values. In c++ [left shift](https://en.cppreference.com/w/cpp/language/operator_arithmetic#Bitwise_shift_operators) `i << j` is defined as <em>i * 2<sup>j</sup></em>, so `CheckedLeftShift` and `SaturatingLeftShift` should be able to compute the same thing, but without undefined behavior or wrapping.\r\n\r\nIt also seems like a footgun that these left shift functions are using different input and output types instead of just using the one type like other functions in this file. Would suggest making new functions more similar to existing functions and writing like:\r\n\r\n```c++\r\ntemplate <std::integral T>\r\nconstexpr std::optional<T> CheckedLeftShift(T i, unsigned shift) noexcept\r\n{\r\n    if (shift == 0 || i == 0) return i;\r\n    // Avoid undefined c++ behavior if shift is >= number of bits in T.\r\n    if (shift >= sizeof(T) * CHAR_BIT) return std::nullopt;\r\n    // If i << shift is too big to fit in T, return nullopt.\r\n    const auto max{std::numeric_limits<T>::max() >> shift};\r\n    if (i > 0 && i > max) return std::nullopt;\r\n    if (i < 0 && i < -max - 1) return std::nullopt;\r\n    return i << shift;\r\n}\r\n\r\ntemplate <std::integral T>\r\nconstexpr T SaturatingLeftShift(T i, unsigned shift) noexcept\r\n{\r\n    if (auto result{CheckedLeftShift(i, shift)}) return *result;\r\n    // If i << shift is to big to fit in T, return biggest positive or negative\r\n    // number that fits.\r\n    return i < 0 ? std::numeric_limits<T>::min() : std::numeric_limits<T>::max();\r\n}\r\n```\r\n\r\nI didn't test these extensively but did sanity check with:\r\n\r\n```c++\r\n    static_assert(SaturatingLeftShift<signed char>(0, 100) ==  0);\r\n    static_assert(SaturatingLeftShift<signed char>(1, 100) ==  127);\r\n    static_assert(SaturatingLeftShift<signed char>(-1, 100) ==  -128);\r\n\r\n    static_assert(SaturatingLeftShift<signed char>(3, 2) ==  12);\r\n    static_assert(SaturatingLeftShift<signed char>(-3, 2) ==  -12);\r\n\r\n    static_assert(SaturatingLeftShift<signed char>(6, 4) ==  96);\r\n    static_assert(SaturatingLeftShift<signed char>(-6, 4) ==  -96);\r\n\r\n    static_assert(SaturatingLeftShift<signed char>(63, 1) ==  126);\r\n    static_assert(SaturatingLeftShift<signed char>(64, 1) ==  127);\r\n    static_assert(SaturatingLeftShift<signed char>(-63, 1) ==  -126);\r\n    static_assert(SaturatingLeftShift<signed char>(-64, 1) ==  -128);\r\n    static_assert(SaturatingLeftShift<signed char>(-65, 1) ==  -128);\r\n\r\n\r\n    static_assert(SaturatingLeftShift<signed char>(31, 2) ==  124);\r\n    static_assert(SaturatingLeftShift<signed char>(32, 2) ==  127);\r\n    static_assert(SaturatingLeftShift<signed char>(-31, 2) ==  -124);\r\n    static_assert(SaturatingLeftShift<signed char>(-32, 2) ==  -128);\r\n    static_assert(SaturatingLeftShift<signed char>(-33, 2) ==  -128);\r\n```\r\n\r\n",
      "created_at": "2025-01-13T17:04:38Z",
      "updated_at": "2025-01-13T17:04:38Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31483#discussion_r1913521985",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1913521985"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31483"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 78,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1913589077",
      "pull_request_review_id": 2547384923,
      "id": 1913589077,
      "node_id": "PRRC_kwDOABII585yDw1V",
      "diff_hunk": "@@ -47,4 +48,40 @@ template <class T>\n     return i + j;\n }\n \n+/**\n+ * @brief Left bit shift with overflow checking.\n+ * @param i The input value to be left shifted.\n+ * @param shift The number of bits to left shift.\n+ * @return The result of the left shift, or std::nullopt in case of\n+ *         overflow or negative input value.\n+ */\n+template <std::unsigned_integral Output, std::integral Input>\n+constexpr std::optional<Output> CheckedLeftShift(Input i, unsigned shift) noexcept\n+{\n+    if constexpr (std::is_signed_v<Input>) {\n+        if (i < 0) return std::nullopt;\n+    }\n+    if (std::make_unsigned_t<Input>(i) > Output(std::numeric_limits<Output>::max() >> shift)) {\n+        return std::nullopt;\n+    }\n+    return i << shift;\n+}\n+\n+/**\n+ * @brief Left bit shift with safe minimum and maximum values.\n+ * @param i The input value to be left shifted.\n+ * @param shift The number of bits to left shift.\n+ * @return The result of the left shift, with the return value clamped\n+ *         between zero and the maximum Output value if overflow occurs.\n+ */\n+template <std::unsigned_integral Output, std::integral Input>\n+constexpr Output SaturatingLeftShift(Input i, unsigned shift) noexcept",
      "path": "src/util/overflow.h",
      "position": null,
      "original_position": 39,
      "commit_id": "2a92702bafca5c78b270a9502a22cb9deac02cfc",
      "original_commit_id": "e0a541702def3a4c6cce8e44b6ebe8d608edad4e",
      "in_reply_to_id": 1913521985,
      "user": {
        "login": "stickies-v",
        "id": 69010457,
        "node_id": "MDQ6VXNlcjY5MDEwNDU3",
        "avatar_url": "https://avatars.githubusercontent.com/u/69010457?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stickies-v",
        "html_url": "https://github.com/stickies-v",
        "followers_url": "https://api.github.com/users/stickies-v/followers",
        "following_url": "https://api.github.com/users/stickies-v/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stickies-v/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stickies-v/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stickies-v/subscriptions",
        "organizations_url": "https://api.github.com/users/stickies-v/orgs",
        "repos_url": "https://api.github.com/users/stickies-v/repos",
        "events_url": "https://api.github.com/users/stickies-v/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stickies-v/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "> It seems wrong that calling `SaturatingLeftShift` on a negative input can wrap around to 0.\r\n\r\nMy understanding was that left shift `a << b` with negative `a` was UB in C++, which is why I thought saturating negative inputs to 0 was the most sensible noexcept approach. Thanks for pointing out (as per your cppreference link) that since C++20 this is indeed defined, which definitely means our implementation can (and should) too, nice!\r\n\r\n> It also seems like a footgun that these left shift functions are using different input and output types instead of just using the one type like other functions in this file.\r\n\r\nThat was my initial approach, but I eventually decided on separate types as to be able to safely catch negative input values instead of silently wrapping around (e.g. when calling `SaturatingLeftShift<size_t>(*db_cache, 20)` with a negative `db_cache`). For my understanding, if it's not too much off-topic, I'd be curious to hear where the footgun potential is - since the point of my approach was to exactly avoid that?\r\n\r\n---\r\n\r\n~~I agree that since C++20, left shift helper functions with negative `input` and result values, a single type `T` is preferable.~~\r\n\r\n~~Your suggested implementation LGTM but I think keeping `std::numeric_limits<T>::digits` instead of `sizeof(T) * CHAR_BIT` is preferable since it takes into account the sign bit?~~\r\n\r\n_edit: I still think, to prevent accidental overflow/wrap-around, that having separate Input and Output types is safer, even when allowing for negative inputs and outputs._",
      "created_at": "2025-01-13T17:59:42Z",
      "updated_at": "2025-01-14T15:43:25Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31483#discussion_r1913589077",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1913589077"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31483"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 78,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1914478423",
      "pull_request_review_id": 2549160438,
      "id": 1914478423,
      "node_id": "PRRC_kwDOABII585yHJ9X",
      "diff_hunk": "@@ -47,4 +48,40 @@ template <class T>\n     return i + j;\n }\n \n+/**\n+ * @brief Left bit shift with overflow checking.\n+ * @param i The input value to be left shifted.\n+ * @param shift The number of bits to left shift.\n+ * @return The result of the left shift, or std::nullopt in case of\n+ *         overflow or negative input value.\n+ */\n+template <std::unsigned_integral Output, std::integral Input>\n+constexpr std::optional<Output> CheckedLeftShift(Input i, unsigned shift) noexcept\n+{\n+    if constexpr (std::is_signed_v<Input>) {\n+        if (i < 0) return std::nullopt;\n+    }\n+    if (std::make_unsigned_t<Input>(i) > Output(std::numeric_limits<Output>::max() >> shift)) {\n+        return std::nullopt;\n+    }\n+    return i << shift;\n+}\n+\n+/**\n+ * @brief Left bit shift with safe minimum and maximum values.\n+ * @param i The input value to be left shifted.\n+ * @param shift The number of bits to left shift.\n+ * @return The result of the left shift, with the return value clamped\n+ *         between zero and the maximum Output value if overflow occurs.\n+ */\n+template <std::unsigned_integral Output, std::integral Input>\n+constexpr Output SaturatingLeftShift(Input i, unsigned shift) noexcept",
      "path": "src/util/overflow.h",
      "position": null,
      "original_position": 39,
      "commit_id": "2a92702bafca5c78b270a9502a22cb9deac02cfc",
      "original_commit_id": "e0a541702def3a4c6cce8e44b6ebe8d608edad4e",
      "in_reply_to_id": 1913521985,
      "user": {
        "login": "TheCharlatan",
        "id": 8421793,
        "node_id": "MDQ6VXNlcjg0MjE3OTM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8421793?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/TheCharlatan",
        "html_url": "https://github.com/TheCharlatan",
        "followers_url": "https://api.github.com/users/TheCharlatan/followers",
        "following_url": "https://api.github.com/users/TheCharlatan/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/TheCharlatan/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/TheCharlatan/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/TheCharlatan/subscriptions",
        "organizations_url": "https://api.github.com/users/TheCharlatan/orgs",
        "repos_url": "https://api.github.com/users/TheCharlatan/repos",
        "events_url": "https://api.github.com/users/TheCharlatan/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/TheCharlatan/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "> Your suggested implementation LGTM but I think keeping std::numeric_limits<T>::digits instead of sizeof(T) * CHAR_BIT is preferable since it takes into account the sign bit?\r\n\r\nAs far as I understand it is legal to shift e.g. `int32_t{1} << 31` to get the minimum `int32_t` value. But I think in this case we should prohibit this quirk of the underlying bit representation and use `std::numeric_limits<T>::digits`.",
      "created_at": "2025-01-14T09:10:26Z",
      "updated_at": "2025-01-14T09:10:26Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31483#discussion_r1914478423",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1914478423"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31483"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 78,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1915042087",
      "pull_request_review_id": 2550087827,
      "id": 1915042087,
      "node_id": "PRRC_kwDOABII585yJTkn",
      "diff_hunk": "@@ -47,4 +48,40 @@ template <class T>\n     return i + j;\n }\n \n+/**\n+ * @brief Left bit shift with overflow checking.\n+ * @param i The input value to be left shifted.\n+ * @param shift The number of bits to left shift.\n+ * @return The result of the left shift, or std::nullopt in case of\n+ *         overflow or negative input value.\n+ */\n+template <std::unsigned_integral Output, std::integral Input>\n+constexpr std::optional<Output> CheckedLeftShift(Input i, unsigned shift) noexcept\n+{\n+    if constexpr (std::is_signed_v<Input>) {\n+        if (i < 0) return std::nullopt;\n+    }\n+    if (std::make_unsigned_t<Input>(i) > Output(std::numeric_limits<Output>::max() >> shift)) {\n+        return std::nullopt;\n+    }\n+    return i << shift;\n+}\n+\n+/**\n+ * @brief Left bit shift with safe minimum and maximum values.\n+ * @param i The input value to be left shifted.\n+ * @param shift The number of bits to left shift.\n+ * @return The result of the left shift, with the return value clamped\n+ *         between zero and the maximum Output value if overflow occurs.\n+ */\n+template <std::unsigned_integral Output, std::integral Input>\n+constexpr Output SaturatingLeftShift(Input i, unsigned shift) noexcept",
      "path": "src/util/overflow.h",
      "position": null,
      "original_position": 39,
      "commit_id": "2a92702bafca5c78b270a9502a22cb9deac02cfc",
      "original_commit_id": "e0a541702def3a4c6cce8e44b6ebe8d608edad4e",
      "in_reply_to_id": 1913521985,
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "re: https://github.com/bitcoin/bitcoin/pull/31483#discussion_r1913589077\r\n\r\nI didn't know about `digits()` and agree that it would be better to use than `sizeof()` so thanks for suggesting that.\r\n\r\n> For my understanding, if it's not too much off-topic, I'd be curious to hear where the footgun potential is - since the point of my approach was to exactly avoid that?\r\n\r\nMy concern with using different types for input and output is that code like `auto kbps = SaturatingLeftShift(mbps, 10)` would be misleading because you could reasonably assume that multiplying a number by 1024 should not change its type from signed to unsigned (and set it to 0 if the input is negative), but that is what the current implementation in e0a541702def3a4c6cce8e44b6ebe8d608edad4e) would do.",
      "created_at": "2025-01-14T15:27:07Z",
      "updated_at": "2025-01-14T15:27:08Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31483#discussion_r1915042087",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1915042087"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31483"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 78,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1915078874",
      "pull_request_review_id": 2550145530,
      "id": 1915078874,
      "node_id": "PRRC_kwDOABII585yJcja",
      "diff_hunk": "@@ -47,4 +48,40 @@ template <class T>\n     return i + j;\n }\n \n+/**\n+ * @brief Left bit shift with overflow checking.\n+ * @param i The input value to be left shifted.\n+ * @param shift The number of bits to left shift.\n+ * @return The result of the left shift, or std::nullopt in case of\n+ *         overflow or negative input value.\n+ */\n+template <std::unsigned_integral Output, std::integral Input>\n+constexpr std::optional<Output> CheckedLeftShift(Input i, unsigned shift) noexcept\n+{\n+    if constexpr (std::is_signed_v<Input>) {\n+        if (i < 0) return std::nullopt;\n+    }\n+    if (std::make_unsigned_t<Input>(i) > Output(std::numeric_limits<Output>::max() >> shift)) {\n+        return std::nullopt;\n+    }\n+    return i << shift;\n+}\n+\n+/**\n+ * @brief Left bit shift with safe minimum and maximum values.\n+ * @param i The input value to be left shifted.\n+ * @param shift The number of bits to left shift.\n+ * @return The result of the left shift, with the return value clamped\n+ *         between zero and the maximum Output value if overflow occurs.\n+ */\n+template <std::unsigned_integral Output, std::integral Input>\n+constexpr Output SaturatingLeftShift(Input i, unsigned shift) noexcept",
      "path": "src/util/overflow.h",
      "position": null,
      "original_position": 39,
      "commit_id": "2a92702bafca5c78b270a9502a22cb9deac02cfc",
      "original_commit_id": "e0a541702def3a4c6cce8e44b6ebe8d608edad4e",
      "in_reply_to_id": 1913521985,
      "user": {
        "login": "stickies-v",
        "id": 69010457,
        "node_id": "MDQ6VXNlcjY5MDEwNDU3",
        "avatar_url": "https://avatars.githubusercontent.com/u/69010457?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stickies-v",
        "html_url": "https://github.com/stickies-v",
        "followers_url": "https://api.github.com/users/stickies-v/followers",
        "following_url": "https://api.github.com/users/stickies-v/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stickies-v/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stickies-v/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stickies-v/subscriptions",
        "organizations_url": "https://api.github.com/users/stickies-v/orgs",
        "repos_url": "https://api.github.com/users/stickies-v/repos",
        "events_url": "https://api.github.com/users/stickies-v/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stickies-v/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "> but that is what the current implementation in [e0a5417](https://github.com/bitcoin/bitcoin/commit/e0a541702def3a4c6cce8e44b6ebe8d608edad4e)) would do.\r\n\r\nAre you sure it would? I don't see how the `Output` return type could be deduced with `auto`. That's kind of the point of the separate `Input` and `Output` types: it force the user to specify the return type, because especially with left shift the chances of the return type being much bigger than the input are high. Using (and potentially wrapping around) the input type, for that reason, seems footgunny for a `util/overflow.h` function?\r\n\r\nWhen testing with:\r\n\r\n```cpp\r\n    int32_t mbps{20};\r\n    auto kbps = SaturatingLeftShift(mbps, 10);\r\n```\r\n\r\nI get, as expected:\r\n\r\n```\r\n../../src/node/caches.cpp:30:17: error: no matching function for call to 'SaturatingLeftShift'\r\n    auto kbps = SaturatingLeftShift(mbps, 10);\r\n                ^~~~~~~~~~~~~~~~~~~\r\n../../src/util/overflow.h:78:18: note: candidate template ignored: couldn't infer template argument 'Output'\r\nconstexpr Output SaturatingLeftShift(Input i, unsigned shift) noexcept\r\n                 ^\r\n1 error generated.\r\n```\r\n\r\n> would be misleading\r\n\r\nWith the user being forced to specify the return type, I don't think there's any room for ambiguity?\r\n",
      "created_at": "2025-01-14T15:40:49Z",
      "updated_at": "2025-01-14T15:41:36Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31483#discussion_r1915078874",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1915078874"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31483"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 78,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1915119234",
      "pull_request_review_id": 2550214960,
      "id": 1915119234,
      "node_id": "PRRC_kwDOABII585yJmaC",
      "diff_hunk": "@@ -47,4 +48,40 @@ template <class T>\n     return i + j;\n }\n \n+/**\n+ * @brief Left bit shift with overflow checking.\n+ * @param i The input value to be left shifted.\n+ * @param shift The number of bits to left shift.\n+ * @return The result of the left shift, or std::nullopt in case of\n+ *         overflow or negative input value.\n+ */\n+template <std::unsigned_integral Output, std::integral Input>\n+constexpr std::optional<Output> CheckedLeftShift(Input i, unsigned shift) noexcept\n+{\n+    if constexpr (std::is_signed_v<Input>) {\n+        if (i < 0) return std::nullopt;\n+    }\n+    if (std::make_unsigned_t<Input>(i) > Output(std::numeric_limits<Output>::max() >> shift)) {\n+        return std::nullopt;\n+    }\n+    return i << shift;\n+}\n+\n+/**\n+ * @brief Left bit shift with safe minimum and maximum values.\n+ * @param i The input value to be left shifted.\n+ * @param shift The number of bits to left shift.\n+ * @return The result of the left shift, with the return value clamped\n+ *         between zero and the maximum Output value if overflow occurs.\n+ */\n+template <std::unsigned_integral Output, std::integral Input>\n+constexpr Output SaturatingLeftShift(Input i, unsigned shift) noexcept",
      "path": "src/util/overflow.h",
      "position": null,
      "original_position": 39,
      "commit_id": "2a92702bafca5c78b270a9502a22cb9deac02cfc",
      "original_commit_id": "e0a541702def3a4c6cce8e44b6ebe8d608edad4e",
      "in_reply_to_id": 1913521985,
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "> Are you sure it would? I don't see how the `Output` return type could be deduced with `auto`. \r\n\r\nYou're right. I didn't realize e0a541702def3a4c6cce8e44b6ebe8d608edad4e required specifying what type to cast the output to. In that case, I take back the comment that it has a footgun.\r\n\r\nBut I would say the implementation does not seem consistent with other functions in this file, or consistent with what I would expect a function that is doing a saturating multiplication operation to do. I think the fact that it casts output to a different type is not ideal, and the wrapping to 0 doesn't make much sense to me. I think `SaturatingLeftShift(i, shift)` should just be a saturating implementation of (i x 2<sup>shift</sup>) like `SaturatingAdd(i, j)` is a saturating implementation of (i + j).\r\n\r\n\r\n\r\n",
      "created_at": "2025-01-14T16:02:50Z",
      "updated_at": "2025-01-14T16:02:50Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31483#discussion_r1915119234",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1915119234"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31483"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 78,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1915196192",
      "pull_request_review_id": 2550343637,
      "id": 1915196192,
      "node_id": "PRRC_kwDOABII585yJ5Mg",
      "diff_hunk": "@@ -47,4 +48,40 @@ template <class T>\n     return i + j;\n }\n \n+/**\n+ * @brief Left bit shift with overflow checking.\n+ * @param i The input value to be left shifted.\n+ * @param shift The number of bits to left shift.\n+ * @return The result of the left shift, or std::nullopt in case of\n+ *         overflow or negative input value.\n+ */\n+template <std::unsigned_integral Output, std::integral Input>\n+constexpr std::optional<Output> CheckedLeftShift(Input i, unsigned shift) noexcept\n+{\n+    if constexpr (std::is_signed_v<Input>) {\n+        if (i < 0) return std::nullopt;\n+    }\n+    if (std::make_unsigned_t<Input>(i) > Output(std::numeric_limits<Output>::max() >> shift)) {\n+        return std::nullopt;\n+    }\n+    return i << shift;\n+}\n+\n+/**\n+ * @brief Left bit shift with safe minimum and maximum values.\n+ * @param i The input value to be left shifted.\n+ * @param shift The number of bits to left shift.\n+ * @return The result of the left shift, with the return value clamped\n+ *         between zero and the maximum Output value if overflow occurs.\n+ */\n+template <std::unsigned_integral Output, std::integral Input>\n+constexpr Output SaturatingLeftShift(Input i, unsigned shift) noexcept",
      "path": "src/util/overflow.h",
      "position": null,
      "original_position": 39,
      "commit_id": "2a92702bafca5c78b270a9502a22cb9deac02cfc",
      "original_commit_id": "e0a541702def3a4c6cce8e44b6ebe8d608edad4e",
      "in_reply_to_id": 1913521985,
      "user": {
        "login": "TheCharlatan",
        "id": 8421793,
        "node_id": "MDQ6VXNlcjg0MjE3OTM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8421793?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/TheCharlatan",
        "html_url": "https://github.com/TheCharlatan",
        "followers_url": "https://api.github.com/users/TheCharlatan/followers",
        "following_url": "https://api.github.com/users/TheCharlatan/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/TheCharlatan/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/TheCharlatan/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/TheCharlatan/subscriptions",
        "organizations_url": "https://api.github.com/users/TheCharlatan/orgs",
        "repos_url": "https://api.github.com/users/TheCharlatan/repos",
        "events_url": "https://api.github.com/users/TheCharlatan/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/TheCharlatan/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "> But I would say the implementation does not seem consistent with other functions in this file, or consistent with what I would expect a function that is doing a saturating multiplication operation to do.\r\n\r\nI tend to agree with this, and rolled with your suggestion for now, but still open for other suggestions.",
      "created_at": "2025-01-14T16:31:10Z",
      "updated_at": "2025-01-14T16:31:11Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31483#discussion_r1915196192",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1915196192"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31483"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 78,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1915356827",
      "pull_request_review_id": 2550610710,
      "id": 1915356827,
      "node_id": "PRRC_kwDOABII585yKgab",
      "diff_hunk": "@@ -1877,4 +1878,99 @@ BOOST_AUTO_TEST_CASE(clearshrink_test)\n     }\n }\n \n+template <typename T>\n+void TestCheckedLeftShift()",
      "path": "src/test/util_tests.cpp",
      "position": 13,
      "original_position": 13,
      "commit_id": "2a92702bafca5c78b270a9502a22cb9deac02cfc",
      "original_commit_id": "a85c07a891f76cd9e606aa83c0671506b1173f30",
      "in_reply_to_id": null,
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "In commit \"util: Add integer left shift helpers\" (a85c07a891f76cd9e606aa83c0671506b1173f30)\r\n\r\nCould consider adding a fuzz test too. Maybe:\r\n\r\n```c++\r\nnamespace {\r\n//! Test overflow operations for type T using a wider type, W, to verify results.\r\ntemplate <typename T, typename W>\r\nvoid TestOverflow(FuzzedDataProvider& fuzzed_data_provider)\r\n{\r\n    constexpr auto min{std::numeric_limits<T>::min()};\r\n    constexpr auto max{std::numeric_limits<T>::max()};\r\n    static_assert(min >= std::numeric_limits<W>::min() / 2);\r\n    static_assert(max <= std::numeric_limits<W>::max() / 2);\r\n\r\n    auto widen = [](T value) -> W { return value; };\r\n    auto clamp = [](W value) -> W { return std::clamp<W>(value, min, max); };\r\n    auto check = [](W value) -> std::optional<W> { if (value >= min && value <= max) return value; else return std::nullopt; };\r\n\r\n    const T i = fuzzed_data_provider.ConsumeIntegral<T>();\r\n    const T j = fuzzed_data_provider.ConsumeIntegral<T>();\r\n    const unsigned shift = fuzzed_data_provider.ConsumeIntegralInRange<unsigned>(0, std::numeric_limits<W>::digits - 1);\r\n\r\n    Assert(clamp(widen(i) + widen(j)) == SaturatingAdd(i, j));\r\n    Assert(check(widen(i) + widen(j)) == CheckedAdd(i, j));\r\n\r\n    Assert(clamp(widen(i) << shift) == SaturatingLeftShift(i, j));\r\n    Assert(check(widen(i) << shift) == CheckedLeftShift(i, j));\r\n}\r\n} // namespace\r\n\r\nFUZZ_TARGET(overflow)\r\n{\r\n    FuzzedDataProvider fuzzed_data_provider(buffer.data(), buffer.size());\r\n    TestOverflow<int8_t, int16_t>(fuzzed_data_provider);\r\n    TestOverflow<int16_t, int32_t>(fuzzed_data_provider);\r\n    TestOverflow<int32_t, int64_t>(fuzzed_data_provider);\r\n    TestOverflow<uint8_t, uint16_t>(fuzzed_data_provider);\r\n    TestOverflow<uint16_t, uint32_t>(fuzzed_data_provider);\r\n    TestOverflow<uint32_t, uint64_t>(fuzzed_data_provider);\r\n}\r\n```\r\n\r\n(This compiles but I didn't actually test it)",
      "created_at": "2025-01-14T17:56:39Z",
      "updated_at": "2025-01-14T20:27:40Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31483#discussion_r1915356827",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1915356827"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31483"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 1882,
      "original_line": 1882,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1915373211",
      "pull_request_review_id": 2550610710,
      "id": 1915373211,
      "node_id": "PRRC_kwDOABII585yKkab",
      "diff_hunk": "@@ -47,4 +49,44 @@ template <class T>\n     return i + j;\n }\n \n+/**\n+ * @brief Left bit shift with overflow checking.\n+ * @param input The input value to be left shifted.\n+ * @param shift The number of bits to left shift.\n+ * @return The result of the left shift, or std::nullopt in case of\n+ *         overflow or too high shift value.\n+ */\n+template <std::integral T>\n+constexpr std::optional<T> CheckedLeftShift(T input, unsigned shift) noexcept\n+{\n+    if (shift == 0 || input == 0) return input;\n+    // Avoid undefined c++ behaviour if shift is >= number of bits in T.\n+    if (shift >= std::numeric_limits<T>::digits) return std::nullopt;\n+    // If input << shift is too big to fit in T, return nullopt.\n+    const auto max_allowed_input{std::numeric_limits<T>::max() >> shift};\n+    if (input > 0 && input > max_allowed_input) return std::nullopt;\n+    if constexpr (std::is_signed_v<T>) {",
      "path": "src/util/overflow.h",
      "position": null,
      "original_position": 29,
      "commit_id": "2a92702bafca5c78b270a9502a22cb9deac02cfc",
      "original_commit_id": "a85c07a891f76cd9e606aa83c0671506b1173f30",
      "in_reply_to_id": null,
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "In commit \"util: Add integer left shift helpers\" (https://github.com/bitcoin/bitcoin/commit/a85c07a891f76cd9e606aa83c0671506b1173f30)\r\n\r\nCould consider dropping this line. Code is correct without it and it seems like a distraction. Or, if it is important to check type of T for some reason, presumably that reason would also apply in the `SaturatingLeftShift` function below and this same check should be done there before checking for `input < 0`.",
      "created_at": "2025-01-14T18:02:58Z",
      "updated_at": "2025-01-14T20:27:40Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31483#discussion_r1915373211",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1915373211"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31483"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 67,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1915387311",
      "pull_request_review_id": 2550610710,
      "id": 1915387311,
      "node_id": "PRRC_kwDOABII585yKn2v",
      "diff_hunk": "@@ -47,4 +49,44 @@ template <class T>\n     return i + j;\n }\n \n+/**\n+ * @brief Left bit shift with overflow checking.\n+ * @param input The input value to be left shifted.\n+ * @param shift The number of bits to left shift.\n+ * @return The result of the left shift, or std::nullopt in case of\n+ *         overflow or too high shift value.",
      "path": "src/util/overflow.h",
      "position": null,
      "original_position": 18,
      "commit_id": "2a92702bafca5c78b270a9502a22cb9deac02cfc",
      "original_commit_id": "a85c07a891f76cd9e606aa83c0671506b1173f30",
      "in_reply_to_id": null,
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "In commit \"util: Add integer left shift helpers\" (https://github.com/bitcoin/bitcoin/commit/a85c07a891f76cd9e606aa83c0671506b1173f30)\r\n\r\n\"overflow or too high shift value\" seem like the same thing so it is confusing to refer to them as different cases. Phrasing is also potentially ambiguous. Would maybe suggest `@return (input * 2^shift) or nullopt if it would not fit in the return type.`",
      "created_at": "2025-01-14T18:13:10Z",
      "updated_at": "2025-01-14T20:27:40Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31483#discussion_r1915387311",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1915387311"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31483"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 57,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1915394447",
      "pull_request_review_id": 2550610710,
      "id": 1915394447,
      "node_id": "PRRC_kwDOABII585yKpmP",
      "diff_hunk": "@@ -47,4 +49,44 @@ template <class T>\n     return i + j;\n }\n \n+/**\n+ * @brief Left bit shift with overflow checking.\n+ * @param input The input value to be left shifted.\n+ * @param shift The number of bits to left shift.\n+ * @return The result of the left shift, or std::nullopt in case of\n+ *         overflow or too high shift value.\n+ */\n+template <std::integral T>\n+constexpr std::optional<T> CheckedLeftShift(T input, unsigned shift) noexcept\n+{\n+    if (shift == 0 || input == 0) return input;\n+    // Avoid undefined c++ behaviour if shift is >= number of bits in T.\n+    if (shift >= std::numeric_limits<T>::digits) return std::nullopt;\n+    // If input << shift is too big to fit in T, return nullopt.\n+    const auto max_allowed_input{std::numeric_limits<T>::max() >> shift};\n+    if (input > 0 && input > max_allowed_input) return std::nullopt;\n+    if constexpr (std::is_signed_v<T>) {\n+        if (input < 0 && input < -max_allowed_input - 1) return std::nullopt;\n+    }\n+    return input << shift;\n+}\n+\n+/**\n+ * @brief Left bit shift with safe minimum and maximum values.\n+ * @param input The input value to be left shifted.\n+ * @param shift The number of bits to left shift.\n+ * @return The result of the left shift, with the return value saturated\n+ *         to the maximum value of T if the input is positive and the\n+ *         minimum value of T if the input is negative, on left shift\n+ *         overflow.",
      "path": "src/util/overflow.h",
      "position": null,
      "original_position": 42,
      "commit_id": "2a92702bafca5c78b270a9502a22cb9deac02cfc",
      "original_commit_id": "a85c07a891f76cd9e606aa83c0671506b1173f30",
      "in_reply_to_id": null,
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "In commit \"util: Add integer left shift helpers\" (https://github.com/bitcoin/bitcoin/commit/a85c07a891f76cd9e606aa83c0671506b1173f30)\r\n\r\nAgain would suggest something shorter and less ambiguous about meaning of left shift like `@return (input * 2^shift) clamped to fit between the lowest and highest representable values of the type T`",
      "created_at": "2025-01-14T18:18:57Z",
      "updated_at": "2025-01-14T20:27:40Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31483#discussion_r1915394447",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1915394447"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31483"
        }
      },
      "start_line": null,
      "original_start_line": 78,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 81,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1915527924",
      "pull_request_review_id": 2550610710,
      "id": 1915527924,
      "node_id": "PRRC_kwDOABII585yLKL0",
      "diff_hunk": "@@ -7,30 +7,38 @@\n #include <common/args.h>\n #include <index/txindex.h>\n #include <kernel/caches.h>\n+#include <logging.h>\n+#include <util/byte_units.h>\n \n #include <algorithm>\n #include <string>\n \n // Unlike for the UTXO database, for the txindex scenario the leveldb cache make\n // a meaningful difference: https://github.com/bitcoin/bitcoin/pull/8273#issuecomment-229601991\n-//! Max memory allocated to tx index DB specific cache in MiB.\n-static constexpr int64_t MAX_TX_INDEX_CACHE{1024};\n-//! Max memory allocated to all block filter index caches combined in MiB.\n-static constexpr int64_t MAX_FILTER_INDEX_CACHE{1024};\n+//! Max memory allocated to tx index DB specific cache in bytes.\n+static constexpr size_t MAX_TX_INDEX_CACHE{1024_MiB};\n+//! Max memory allocated to all block filter index caches combined in bytes.\n+static constexpr size_t MAX_FILTER_INDEX_CACHE{1024_MiB};\n \n namespace node {\n CacheSizes CalculateCacheSizes(const ArgsManager& args, size_t n_indexes)\n {\n-    int64_t nTotalCache = (args.GetIntArg(\"-dbcache\", DEFAULT_DB_CACHE) << 20);\n-    nTotalCache = std::max(nTotalCache, MIN_DB_CACHE << 20);\n-    IndexCacheSizes sizes;\n-    sizes.tx_index = std::min(nTotalCache / 8, args.GetBoolArg(\"-txindex\", DEFAULT_TXINDEX) ? MAX_TX_INDEX_CACHE << 20 : 0);\n-    nTotalCache -= sizes.tx_index;\n+    // Convert -dbcache from MiB units to bytes. The total cache is floored by MIN_DB_CACHE and capped by max size_t value.\n+    size_t total_cache{DEFAULT_DB_CACHE};\n+    if (std::optional<int64_t> db_cache = args.GetIntArg(\"-dbcache\")) {\n+        if (*db_cache < 0) db_cache = 0;\n+        uint64_t db_cache_bytes = SaturatingLeftShift<uint64_t>(*db_cache, 20);\n+        total_cache = std::max<size_t>(MIN_DB_CACHE, std::min<uint64_t>(db_cache_bytes, std::numeric_limits<size_t>::max()));",
      "path": "src/node/caches.cpp",
      "position": 35,
      "original_position": 34,
      "commit_id": "2a92702bafca5c78b270a9502a22cb9deac02cfc",
      "original_commit_id": "922aa7a25650bdfd8428198f171f88915af1ffa0",
      "in_reply_to_id": null,
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "In commit \"init: Use size_t consistently for cache sizes\" (922aa7a25650bdfd8428198f171f88915af1ffa0)\r\n\r\nNote: Passing max `size_t` value to `min<uint64_t>` could be broken in the theoretical case where `size_t` type is wider than `uint64_t`. If we had a [`saturate_cast`](https://en.cppreference.com/w/cpp/numeric/saturate_cast) function the code be simplified to avoid this type of problem:\r\n\r\n```c++\r\n    if (std::optional<int64_t> db_cache = args.GetIntArg(\"-dbcache\")) {\r\n        total_cache = std::max(MIN_DB_CACHE, saturate_cast<size_t>(SaturatingLeftShift(*db_cache, 20)));\r\n    }\r\n```\r\n\r\nBut I think it is fine to keep current code because for practical purposes size_t should not be wider than uint64_t.",
      "created_at": "2025-01-14T20:01:37Z",
      "updated_at": "2025-01-14T20:27:40Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31483#discussion_r1915527924",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1915527924"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31483"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 31,
      "original_line": 31,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1915573360",
      "pull_request_review_id": 2550976349,
      "id": 1915573360,
      "node_id": "PRRC_kwDOABII585yLVRw",
      "diff_hunk": "@@ -47,4 +49,44 @@ template <class T>\n     return i + j;\n }\n \n+/**\n+ * @brief Left bit shift with overflow checking.\n+ * @param input The input value to be left shifted.\n+ * @param shift The number of bits to left shift.\n+ * @return The result of the left shift, or std::nullopt in case of\n+ *         overflow or too high shift value.\n+ */\n+template <std::integral T>\n+constexpr std::optional<T> CheckedLeftShift(T input, unsigned shift) noexcept\n+{\n+    if (shift == 0 || input == 0) return input;\n+    // Avoid undefined c++ behaviour if shift is >= number of bits in T.\n+    if (shift >= std::numeric_limits<T>::digits) return std::nullopt;\n+    // If input << shift is too big to fit in T, return nullopt.\n+    const auto max_allowed_input{std::numeric_limits<T>::max() >> shift};\n+    if (input > 0 && input > max_allowed_input) return std::nullopt;\n+    if constexpr (std::is_signed_v<T>) {",
      "path": "src/util/overflow.h",
      "position": null,
      "original_position": 29,
      "commit_id": "2a92702bafca5c78b270a9502a22cb9deac02cfc",
      "original_commit_id": "a85c07a891f76cd9e606aa83c0671506b1173f30",
      "in_reply_to_id": 1915373211,
      "user": {
        "login": "TheCharlatan",
        "id": 8421793,
        "node_id": "MDQ6VXNlcjg0MjE3OTM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8421793?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/TheCharlatan",
        "html_url": "https://github.com/TheCharlatan",
        "followers_url": "https://api.github.com/users/TheCharlatan/followers",
        "following_url": "https://api.github.com/users/TheCharlatan/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/TheCharlatan/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/TheCharlatan/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/TheCharlatan/subscriptions",
        "organizations_url": "https://api.github.com/users/TheCharlatan/orgs",
        "repos_url": "https://api.github.com/users/TheCharlatan/repos",
        "events_url": "https://api.github.com/users/TheCharlatan/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/TheCharlatan/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "I had a compiler complain about signed to unsigned integer comparison without it.",
      "created_at": "2025-01-14T20:42:37Z",
      "updated_at": "2025-01-14T20:42:37Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31483#discussion_r1915573360",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1915573360"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31483"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 67,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1915615707",
      "pull_request_review_id": 2551045099,
      "id": 1915615707,
      "node_id": "PRRC_kwDOABII585yLfnb",
      "diff_hunk": "@@ -1877,4 +1878,99 @@ BOOST_AUTO_TEST_CASE(clearshrink_test)\n     }\n }\n \n+template <typename T>\n+void TestCheckedLeftShift()",
      "path": "src/test/util_tests.cpp",
      "position": 13,
      "original_position": 13,
      "commit_id": "2a92702bafca5c78b270a9502a22cb9deac02cfc",
      "original_commit_id": "a85c07a891f76cd9e606aa83c0671506b1173f30",
      "in_reply_to_id": 1915356827,
      "user": {
        "login": "TheCharlatan",
        "id": 8421793,
        "node_id": "MDQ6VXNlcjg0MjE3OTM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8421793?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/TheCharlatan",
        "html_url": "https://github.com/TheCharlatan",
        "followers_url": "https://api.github.com/users/TheCharlatan/followers",
        "following_url": "https://api.github.com/users/TheCharlatan/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/TheCharlatan/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/TheCharlatan/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/TheCharlatan/subscriptions",
        "organizations_url": "https://api.github.com/users/TheCharlatan/orgs",
        "repos_url": "https://api.github.com/users/TheCharlatan/repos",
        "events_url": "https://api.github.com/users/TheCharlatan/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/TheCharlatan/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "Thanks, but I get a crash immediately:\r\n```\r\ntest/fuzz/overflow.cpp:36 TestOverflow: Assertion `check(widen(i) << shift) == CheckedLeftShift(i, j)' failed.\r\n```\r\nDoes this correction make sense to you?\r\n```diff\r\ndiff --git a/src/test/fuzz/overflow.cpp b/src/test/fuzz/overflow.cpp\r\nindex defaf9926d..d29273eb6e 100644\r\n--- a/src/test/fuzz/overflow.cpp\r\n+++ b/src/test/fuzz/overflow.cpp\r\n@@ -27,13 +27,13 @@ void TestOverflow(FuzzedDataProvider& fuzzed_data_provider)\r\n \r\n     const T i = fuzzed_data_provider.ConsumeIntegral<T>();\r\n     const T j = fuzzed_data_provider.ConsumeIntegral<T>();\r\n-    const unsigned shift = fuzzed_data_provider.ConsumeIntegralInRange<unsigned>(0, std::numeric_limits<W>::digits - 1);\r\n+    const unsigned shift = fuzzed_data_provider.ConsumeIntegralInRange<unsigned>(0, std::numeric_limits<T>::digits - 1);\r\n \r\n     Assert(clamp(widen(i) + widen(j)) == SaturatingAdd(i, j));\r\n     Assert(check(widen(i) + widen(j)) == CheckedAdd(i, j));\r\n \r\n-    Assert(clamp(widen(i) << shift) == SaturatingLeftShift(i, j));\r\n-    Assert(check(widen(i) << shift) == CheckedLeftShift(i, j));\r\n+    Assert(clamp(widen(i) << shift) == SaturatingLeftShift(i, shift));\r\n+    Assert(check(widen(i) << shift) == CheckedLeftShift(i, shift));\r\n }\r\n } // namespace\r\n ```\r\n Edit: The test seems fine otherwise and I don't find new paths after just a few seconds.",
      "created_at": "2025-01-14T21:24:26Z",
      "updated_at": "2025-01-14T21:25:19Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31483#discussion_r1915615707",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1915615707"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31483"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 1882,
      "original_line": 1882,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1915622193",
      "pull_request_review_id": 2551055951,
      "id": 1915622193,
      "node_id": "PRRC_kwDOABII585yLhMx",
      "diff_hunk": "@@ -1877,4 +1878,99 @@ BOOST_AUTO_TEST_CASE(clearshrink_test)\n     }\n }\n \n+template <typename T>\n+void TestCheckedLeftShift()",
      "path": "src/test/util_tests.cpp",
      "position": 13,
      "original_position": 13,
      "commit_id": "2a92702bafca5c78b270a9502a22cb9deac02cfc",
      "original_commit_id": "a85c07a891f76cd9e606aa83c0671506b1173f30",
      "in_reply_to_id": 1915356827,
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "Thanks, the bottom part of that correction (shifting by `shift` instead of `j`) makes sense but the top part changing `std::numeric_limits<W>::digits ` to `std::numeric_limits<T>::digits` reduces the coverage of the fuzz test by reducing the range of `shift` so I think would not be a good change.",
      "created_at": "2025-01-14T21:31:15Z",
      "updated_at": "2025-01-14T21:31:15Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31483#discussion_r1915622193",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1915622193"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31483"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 1882,
      "original_line": 1882,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1915697166",
      "pull_request_review_id": 2551161590,
      "id": 1915697166,
      "node_id": "PRRC_kwDOABII585yLzgO",
      "diff_hunk": "@@ -1877,4 +1878,99 @@ BOOST_AUTO_TEST_CASE(clearshrink_test)\n     }\n }\n \n+template <typename T>\n+void TestCheckedLeftShift()",
      "path": "src/test/util_tests.cpp",
      "position": 13,
      "original_position": 13,
      "commit_id": "2a92702bafca5c78b270a9502a22cb9deac02cfc",
      "original_commit_id": "a85c07a891f76cd9e606aa83c0671506b1173f30",
      "in_reply_to_id": 1915356827,
      "user": {
        "login": "TheCharlatan",
        "id": 8421793,
        "node_id": "MDQ6VXNlcjg0MjE3OTM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8421793?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/TheCharlatan",
        "html_url": "https://github.com/TheCharlatan",
        "followers_url": "https://api.github.com/users/TheCharlatan/followers",
        "following_url": "https://api.github.com/users/TheCharlatan/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/TheCharlatan/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/TheCharlatan/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/TheCharlatan/subscriptions",
        "organizations_url": "https://api.github.com/users/TheCharlatan/orgs",
        "repos_url": "https://api.github.com/users/TheCharlatan/repos",
        "events_url": "https://api.github.com/users/TheCharlatan/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/TheCharlatan/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "Ah, of course. The actual problem is that we are shifting even out of the widened type's range, so it wraps around. Not sure if there is a nice solution to that without re-implementing the logic we are trying to test. Do you have a better solution besides changing the shift value to get the digits of `T`?",
      "created_at": "2025-01-14T22:29:57Z",
      "updated_at": "2025-01-14T22:48:41Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31483#discussion_r1915697166",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1915697166"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31483"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 1882,
      "original_line": 1882,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1915912236",
      "pull_request_review_id": 2551510347,
      "id": 1915912236,
      "node_id": "PRRC_kwDOABII585yMoAs",
      "diff_hunk": "@@ -1877,4 +1878,99 @@ BOOST_AUTO_TEST_CASE(clearshrink_test)\n     }\n }\n \n+template <typename T>\n+void TestCheckedLeftShift()",
      "path": "src/test/util_tests.cpp",
      "position": 13,
      "original_position": 13,
      "commit_id": "2a92702bafca5c78b270a9502a22cb9deac02cfc",
      "original_commit_id": "a85c07a891f76cd9e606aa83c0671506b1173f30",
      "in_reply_to_id": 1915356827,
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "> Ah, of course. The actual problem is that we are shifting even out of the widened type's range, so it wraps around.\r\n\r\nI see. So the max amount you can safely shift is without overflowing is not `std::numeric_limits<W>::digits - 1` but actually `std::numeric_limits<W>::digits - std::numeric_limits<T>::digits` since that is how much free space there is to the right of T's bits in W.\r\n\r\nSo maybe if you switch to that amount and change the test cases to: \r\n\r\n    TestOverflow<int8_t, int64_t>(fuzzed_data_provider);\r\n    TestOverflow<int16_t, int64_t>(fuzzed_data_provider);\r\n    TestOverflow<int32_t, int64_t>(fuzzed_data_provider);\r\n    TestOverflow<uint8_t, uint64_t>(fuzzed_data_provider);\r\n    TestOverflow<uint16_t, uint64_t>(fuzzed_data_provider);\r\n    TestOverflow<uint32_t, uint64_t>(fuzzed_data_provider);\r\n\r\nIt could provide good coverage without overflowing",
      "created_at": "2025-01-15T04:02:51Z",
      "updated_at": "2025-01-15T04:02:51Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31483#discussion_r1915912236",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1915912236"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31483"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 1882,
      "original_line": 1882,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1916121562",
      "pull_request_review_id": 2551842420,
      "id": 1916121562,
      "node_id": "PRRC_kwDOABII585yNbHa",
      "diff_hunk": "@@ -1877,4 +1878,99 @@ BOOST_AUTO_TEST_CASE(clearshrink_test)\n     }\n }\n \n+template <typename T>\n+void TestCheckedLeftShift()",
      "path": "src/test/util_tests.cpp",
      "position": 13,
      "original_position": 13,
      "commit_id": "2a92702bafca5c78b270a9502a22cb9deac02cfc",
      "original_commit_id": "a85c07a891f76cd9e606aa83c0671506b1173f30",
      "in_reply_to_id": 1915356827,
      "user": {
        "login": "TheCharlatan",
        "id": 8421793,
        "node_id": "MDQ6VXNlcjg0MjE3OTM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8421793?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/TheCharlatan",
        "html_url": "https://github.com/TheCharlatan",
        "followers_url": "https://api.github.com/users/TheCharlatan/followers",
        "following_url": "https://api.github.com/users/TheCharlatan/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/TheCharlatan/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/TheCharlatan/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/TheCharlatan/subscriptions",
        "organizations_url": "https://api.github.com/users/TheCharlatan/orgs",
        "repos_url": "https://api.github.com/users/TheCharlatan/repos",
        "events_url": "https://api.github.com/users/TheCharlatan/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/TheCharlatan/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "Yeah, that should work. I'll fuzz with this for some time.",
      "created_at": "2025-01-15T08:23:39Z",
      "updated_at": "2025-01-15T08:23:40Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31483#discussion_r1916121562",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1916121562"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31483"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 1882,
      "original_line": 1882,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1916527403",
      "pull_request_review_id": 2552509159,
      "id": 1916527403,
      "node_id": "PRRC_kwDOABII585yO-Mr",
      "diff_hunk": "@@ -47,4 +49,41 @@ template <class T>\n     return i + j;\n }\n \n+/**\n+ * @brief Left bit shift with overflow checking.\n+ * @param input The input value to be left shifted.\n+ * @param shift The number of bits to left shift.\n+ * @return (intput * 2^shift) or nullopt if it would not fit in the return type.\n+ */\n+template <std::integral T>\n+constexpr std::optional<T> CheckedLeftShift(T input, unsigned shift) noexcept\n+{\n+    if (shift == 0 || input == 0) return input;\n+    // Avoid undefined c++ behaviour if shift is >= number of bits in T.\n+    if (shift >= sizeof(T) * CHAR_BIT) return std::nullopt;\n+    // If input << shift is too big to fit in T, return nullopt.\n+    const auto max_allowed_input{std::numeric_limits<T>::max() >> shift};\n+    if (input > 0 && input > max_allowed_input) return std::nullopt;\n+    if constexpr (std::is_signed_v<T>) {\n+        if (input < 0 && input < -max_allowed_input - 1) return std::nullopt;\n+    }",
      "path": "src/util/overflow.h",
      "position": null,
      "original_position": 30,
      "commit_id": "2a92702bafca5c78b270a9502a22cb9deac02cfc",
      "original_commit_id": "430d5feee9b8be3a85e85696c449753783301c2b",
      "in_reply_to_id": null,
      "user": {
        "login": "stickies-v",
        "id": 69010457,
        "node_id": "MDQ6VXNlcjY5MDEwNDU3",
        "avatar_url": "https://avatars.githubusercontent.com/u/69010457?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stickies-v",
        "html_url": "https://github.com/stickies-v",
        "followers_url": "https://api.github.com/users/stickies-v/followers",
        "following_url": "https://api.github.com/users/stickies-v/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stickies-v/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stickies-v/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stickies-v/subscriptions",
        "organizations_url": "https://api.github.com/users/stickies-v/orgs",
        "repos_url": "https://api.github.com/users/stickies-v/repos",
        "events_url": "https://api.github.com/users/stickies-v/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stickies-v/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "in 7993f26173d911d3773cb2580938ac9aad8ad31b:\r\n\r\nnit: I think the runtime signedness checks are unnecessary, and find `std::numeric_limits<T>::min()` a bit more readable than `-max_allowed_input - 1`, so putting it all together this can just be simplified to\r\n\r\n```suggestion\r\n    if (input > (std::numeric_limits<T>::max() >> shift)) return std::nullopt;\r\n    if (input < (std::numeric_limits<T>::min() >> shift)) return std::nullopt;\r\n```\r\n",
      "created_at": "2025-01-15T12:24:03Z",
      "updated_at": "2025-01-15T14:01:23Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31483#discussion_r1916527403",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1916527403"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31483"
        }
      },
      "start_line": null,
      "original_start_line": 65,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 69,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1916557354",
      "pull_request_review_id": 2552509159,
      "id": 1916557354,
      "node_id": "PRRC_kwDOABII585yPFgq",
      "diff_hunk": "@@ -1877,4 +1878,99 @@ BOOST_AUTO_TEST_CASE(clearshrink_test)\n     }\n }\n \n+template <typename T>\n+void TestCheckedLeftShift()\n+{\n+    constexpr auto MAX{std::numeric_limits<T>::max()};\n+\n+    // Basic operations\n+    BOOST_CHECK_EQUAL(CheckedLeftShift<T>(0, 1), 0);\n+    BOOST_CHECK_EQUAL(CheckedLeftShift<T>(0, 127), 0);\n+    BOOST_CHECK_EQUAL(CheckedLeftShift<T>(1, 1), 2);\n+    BOOST_CHECK_EQUAL(CheckedLeftShift<T>(2, 2), 8);\n+    BOOST_CHECK_EQUAL(CheckedLeftShift<T>(MAX >> 1, 1), MAX - 1);\n+\n+    // Max left shift\n+    BOOST_CHECK_EQUAL(CheckedLeftShift<T>(1, std::numeric_limits<T>::digits - 1), MAX / 2 + 1);\n+\n+    // Overflow cases\n+    BOOST_CHECK(!CheckedLeftShift<T>((MAX >> 1) + 1, 1));\n+    BOOST_CHECK(!CheckedLeftShift<T>(MAX, 1));\n+    BOOST_CHECK(!CheckedLeftShift<T>(1, std::numeric_limits<T>::digits));\n+    BOOST_CHECK(!CheckedLeftShift<T>(1, std::numeric_limits<T>::digits + 1));\n+\n+    if constexpr (std::is_signed_v<T>) {\n+        constexpr auto MIN{std::numeric_limits<T>::min()};\n+        // Negative input\n+        BOOST_CHECK_EQUAL(CheckedLeftShift<T>(-1, 1), -2);\n+        BOOST_CHECK_EQUAL(CheckedLeftShift<T>((MIN >> 2), 1), MIN / 2);\n+        BOOST_CHECK_EQUAL(CheckedLeftShift<T>((MIN >> 1) + 1, 1), MIN + 2);\n+        BOOST_CHECK_EQUAL(CheckedLeftShift<T>(MIN >> 1, 1), MIN);\n+        // Overflow negative\n+        BOOST_CHECK(!CheckedLeftShift<T>((MIN >> 1) - 1, 1));\n+        BOOST_CHECK(!CheckedLeftShift<T>(MIN >> 1, 2));\n+        BOOST_CHECK(!CheckedLeftShift<T>(-1, 100));\n+    }\n+}\n+\n+template <typename T>\n+void TestSaturatingLeftShift()\n+{\n+    constexpr auto MAX{std::numeric_limits<T>::max()};\n+\n+    // Basic operations\n+    BOOST_CHECK_EQUAL(SaturatingLeftShift<T>(0, 1), 0);\n+    BOOST_CHECK_EQUAL(SaturatingLeftShift<T>(0, 127), 0);\n+    BOOST_CHECK_EQUAL(SaturatingLeftShift<T>(1, 1), 2);\n+    BOOST_CHECK_EQUAL(SaturatingLeftShift<T>(2, 2), 8);\n+    BOOST_CHECK_EQUAL(SaturatingLeftShift<T>(MAX >> 1, 1), MAX - 1);\n+\n+    // Max left shift\n+    BOOST_CHECK_EQUAL(SaturatingLeftShift<T>(1, std::numeric_limits<T>::digits - 1), MAX / 2 + 1);\n+\n+    // Saturation cases\n+    BOOST_CHECK_EQUAL(SaturatingLeftShift<T>((MAX >> 1) + 1, 1), MAX);\n+    BOOST_CHECK_EQUAL(SaturatingLeftShift<T>(MAX, 1), MAX);\n+    BOOST_CHECK_EQUAL(SaturatingLeftShift<T>(1, std::numeric_limits<T>::digits), MAX);\n+    BOOST_CHECK_EQUAL(SaturatingLeftShift<T>(1, std::numeric_limits<T>::digits + 1), MAX);\n+\n+    if constexpr (std::is_signed_v<T>) {\n+        constexpr auto MIN{std::numeric_limits<T>::min()};\n+        // Negative input\n+        BOOST_CHECK_EQUAL(SaturatingLeftShift<T>(-1, 1), -2);\n+        BOOST_CHECK_EQUAL(SaturatingLeftShift<T>((MIN >> 2), 1), MIN / 2);\n+        BOOST_CHECK_EQUAL(SaturatingLeftShift<T>((MIN >> 1) + 1, 1), MIN + 2);\n+        BOOST_CHECK_EQUAL(SaturatingLeftShift<T>(MIN >> 1, 1), MIN);\n+        // Saturation negative\n+        BOOST_CHECK_EQUAL(SaturatingLeftShift<T>((MIN >> 1) - 1, 1), MIN);\n+        BOOST_CHECK_EQUAL(SaturatingLeftShift<T>(MIN >> 1, 2), MIN);\n+        BOOST_CHECK_EQUAL(SaturatingLeftShift<T>(-1, 100), MIN);\n+    }\n+}\n+\n+BOOST_AUTO_TEST_CASE(checked_left_shift_test)\n+{\n+    TestCheckedLeftShift<uint8_t>();\n+    TestCheckedLeftShift<int8_t>();\n+    TestCheckedLeftShift<size_t>();\n+    TestCheckedLeftShift<uint64_t>();\n+    TestCheckedLeftShift<int64_t>();\n+}\n+\n+BOOST_AUTO_TEST_CASE(saturating_left_shift_test)\n+{\n+    TestSaturatingLeftShift<uint8_t>();\n+    TestSaturatingLeftShift<int8_t>();\n+    TestSaturatingLeftShift<size_t>();\n+    TestSaturatingLeftShift<uint64_t>();\n+    TestSaturatingLeftShift<int64_t>();\n+}\n+\n+BOOST_AUTO_TEST_CASE(mib_string_literal_test)\n+{\n+    BOOST_CHECK_EQUAL(0_MiB, 0);\n+    BOOST_CHECK_EQUAL(1_MiB, 1024 * 1024);\n+    BOOST_CHECK_EXCEPTION(17592186044416_MiB, std::overflow_error, HasReason(\"MiB value too large for size_t byte conversion\"));",
      "path": "src/test/util_tests.cpp",
      "position": null,
      "original_position": 104,
      "commit_id": "2a92702bafca5c78b270a9502a22cb9deac02cfc",
      "original_commit_id": "7993f26173d911d3773cb2580938ac9aad8ad31b",
      "in_reply_to_id": null,
      "user": {
        "login": "stickies-v",
        "id": 69010457,
        "node_id": "MDQ6VXNlcjY5MDEwNDU3",
        "avatar_url": "https://avatars.githubusercontent.com/u/69010457?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stickies-v",
        "html_url": "https://github.com/stickies-v",
        "followers_url": "https://api.github.com/users/stickies-v/followers",
        "following_url": "https://api.github.com/users/stickies-v/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stickies-v/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stickies-v/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stickies-v/subscriptions",
        "organizations_url": "https://api.github.com/users/stickies-v/orgs",
        "repos_url": "https://api.github.com/users/stickies-v/repos",
        "events_url": "https://api.github.com/users/stickies-v/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stickies-v/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "in 7993f26173d911d3773cb2580938ac9aad8ad31b\r\n\r\nYou could make this test platform independent with:\r\n\r\n<details>\r\n<summary>git diff on 7993f26173</summary>\r\n\r\n```diff\r\ndiff --git a/src/test/util_tests.cpp b/src/test/util_tests.cpp\r\nindex 9991b1dda5..5bde29d0bb 100644\r\n--- a/src/test/util_tests.cpp\r\n+++ b/src/test/util_tests.cpp\r\n@@ -1970,7 +1970,9 @@ BOOST_AUTO_TEST_CASE(mib_string_literal_test)\r\n {\r\n     BOOST_CHECK_EQUAL(0_MiB, 0);\r\n     BOOST_CHECK_EQUAL(1_MiB, 1024 * 1024);\r\n-    BOOST_CHECK_EXCEPTION(17592186044416_MiB, std::overflow_error, HasReason(\"MiB value too large for size_t byte conversion\"));\r\n+    const auto max_mib{std::numeric_limits<size_t>::max() >> 20};\r\n+    BOOST_CHECK_EXCEPTION(operator\"\" _MiB(static_cast<unsigned long long>(max_mib) + 1),\r\n+                          std::overflow_error, HasReason(\"MiB value too large for size_t byte conversion\"));\r\n }\r\n \r\n BOOST_AUTO_TEST_SUITE_END()\r\n\r\n```\r\n</details>\r\n\r\n\r\n",
      "created_at": "2025-01-15T12:34:28Z",
      "updated_at": "2025-01-15T13:59:23Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31483#discussion_r1916557354",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1916557354"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31483"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1973,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1916686135",
      "pull_request_review_id": 2552509159,
      "id": 1916686135,
      "node_id": "PRRC_kwDOABII585yPk83",
      "diff_hunk": "@@ -5,18 +5,26 @@\n #ifndef BITCOIN_NODE_CACHES_H\n #define BITCOIN_NODE_CACHES_H\n \n+#include <kernel/caches.h>\n+#include <util/byte_units.h>\n+\n #include <cstddef>\n-#include <cstdint>\n \n class ArgsManager;\n \n+//! min. -dbcache (bytes)\n+static constexpr size_t MIN_DB_CACHE{4_MiB};\n+//! -dbcache default (bytes)\n+static constexpr size_t DEFAULT_DB_CACHE{DEFAULT_KERNEL_CACHE};\n+\n namespace node {\n+struct IndexCacheSizes {\n+    int64_t tx_index{0};\n+    int64_t filter_index{0};",
      "path": "src/node/caches.h",
      "position": null,
      "original_position": 20,
      "commit_id": "2a92702bafca5c78b270a9502a22cb9deac02cfc",
      "original_commit_id": "430d5feee9b8be3a85e85696c449753783301c2b",
      "in_reply_to_id": null,
      "user": {
        "login": "stickies-v",
        "id": 69010457,
        "node_id": "MDQ6VXNlcjY5MDEwNDU3",
        "avatar_url": "https://avatars.githubusercontent.com/u/69010457?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stickies-v",
        "html_url": "https://github.com/stickies-v",
        "followers_url": "https://api.github.com/users/stickies-v/followers",
        "following_url": "https://api.github.com/users/stickies-v/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stickies-v/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stickies-v/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stickies-v/subscriptions",
        "organizations_url": "https://api.github.com/users/stickies-v/orgs",
        "repos_url": "https://api.github.com/users/stickies-v/repos",
        "events_url": "https://api.github.com/users/stickies-v/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stickies-v/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "I think these should be `size_t` too?",
      "created_at": "2025-01-15T13:50:56Z",
      "updated_at": "2025-01-15T13:59:23Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31483#discussion_r1916686135",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1916686135"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31483"
        }
      },
      "start_line": null,
      "original_start_line": 22,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 23,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1916694318",
      "pull_request_review_id": 2552509159,
      "id": 1916694318,
      "node_id": "PRRC_kwDOABII585yPm8u",
      "diff_hunk": "@@ -47,4 +48,40 @@ template <class T>\n     return i + j;\n }\n \n+/**\n+ * @brief Left bit shift with overflow checking.\n+ * @param i The input value to be left shifted.\n+ * @param shift The number of bits to left shift.\n+ * @return The result of the left shift, or std::nullopt in case of\n+ *         overflow or negative input value.\n+ */\n+template <std::unsigned_integral Output, std::integral Input>\n+constexpr std::optional<Output> CheckedLeftShift(Input i, unsigned shift) noexcept\n+{\n+    if constexpr (std::is_signed_v<Input>) {\n+        if (i < 0) return std::nullopt;\n+    }\n+    if (std::make_unsigned_t<Input>(i) > Output(std::numeric_limits<Output>::max() >> shift)) {\n+        return std::nullopt;\n+    }\n+    return i << shift;\n+}\n+\n+/**\n+ * @brief Left bit shift with safe minimum and maximum values.\n+ * @param i The input value to be left shifted.\n+ * @param shift The number of bits to left shift.\n+ * @return The result of the left shift, with the return value clamped\n+ *         between zero and the maximum Output value if overflow occurs.\n+ */\n+template <std::unsigned_integral Output, std::integral Input>\n+constexpr Output SaturatingLeftShift(Input i, unsigned shift) noexcept",
      "path": "src/util/overflow.h",
      "position": null,
      "original_position": 39,
      "commit_id": "2a92702bafca5c78b270a9502a22cb9deac02cfc",
      "original_commit_id": "e0a541702def3a4c6cce8e44b6ebe8d608edad4e",
      "in_reply_to_id": 1913521985,
      "user": {
        "login": "stickies-v",
        "id": 69010457,
        "node_id": "MDQ6VXNlcjY5MDEwNDU3",
        "avatar_url": "https://avatars.githubusercontent.com/u/69010457?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stickies-v",
        "html_url": "https://github.com/stickies-v",
        "followers_url": "https://api.github.com/users/stickies-v/followers",
        "following_url": "https://api.github.com/users/stickies-v/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stickies-v/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stickies-v/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stickies-v/subscriptions",
        "organizations_url": "https://api.github.com/users/stickies-v/orgs",
        "repos_url": "https://api.github.com/users/stickies-v/repos",
        "events_url": "https://api.github.com/users/stickies-v/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stickies-v/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "Alright, I'm on board too. I liked how the dual-type implementation made using the functions without casting and clamping easier (and as such perhaps a bit safer), but I agree that from a single-responsibility principle the current approach makes more sense, and it is consistent.",
      "created_at": "2025-01-15T13:56:22Z",
      "updated_at": "2025-01-15T13:59:23Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31483#discussion_r1916694318",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1916694318"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31483"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 78,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1916720450",
      "pull_request_review_id": 2552869662,
      "id": 1916720450,
      "node_id": "PRRC_kwDOABII585yPtVC",
      "diff_hunk": "@@ -5,18 +5,26 @@\n #ifndef BITCOIN_NODE_CACHES_H\n #define BITCOIN_NODE_CACHES_H\n \n+#include <kernel/caches.h>\n+#include <util/byte_units.h>\n+\n #include <cstddef>\n-#include <cstdint>\n \n class ArgsManager;\n \n+//! min. -dbcache (bytes)\n+static constexpr size_t MIN_DB_CACHE{4_MiB};\n+//! -dbcache default (bytes)\n+static constexpr size_t DEFAULT_DB_CACHE{DEFAULT_KERNEL_CACHE};\n+\n namespace node {\n+struct IndexCacheSizes {\n+    int64_t tx_index{0};\n+    int64_t filter_index{0};",
      "path": "src/node/caches.h",
      "position": null,
      "original_position": 20,
      "commit_id": "2a92702bafca5c78b270a9502a22cb9deac02cfc",
      "original_commit_id": "430d5feee9b8be3a85e85696c449753783301c2b",
      "in_reply_to_id": 1916686135,
      "user": {
        "login": "TheCharlatan",
        "id": 8421793,
        "node_id": "MDQ6VXNlcjg0MjE3OTM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8421793?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/TheCharlatan",
        "html_url": "https://github.com/TheCharlatan",
        "followers_url": "https://api.github.com/users/TheCharlatan/followers",
        "following_url": "https://api.github.com/users/TheCharlatan/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/TheCharlatan/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/TheCharlatan/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/TheCharlatan/subscriptions",
        "organizations_url": "https://api.github.com/users/TheCharlatan/orgs",
        "repos_url": "https://api.github.com/users/TheCharlatan/repos",
        "events_url": "https://api.github.com/users/TheCharlatan/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/TheCharlatan/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "Must have dropped this by mistake during one of the rebases.",
      "created_at": "2025-01-15T14:14:08Z",
      "updated_at": "2025-01-15T14:14:08Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31483#discussion_r1916720450",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1916720450"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31483"
        }
      },
      "start_line": null,
      "original_start_line": 22,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 23,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1916723745",
      "pull_request_review_id": 2552875375,
      "id": 1916723745,
      "node_id": "PRRC_kwDOABII585yPuIh",
      "diff_hunk": "@@ -47,4 +49,41 @@ template <class T>\n     return i + j;\n }\n \n+/**\n+ * @brief Left bit shift with overflow checking.\n+ * @param input The input value to be left shifted.\n+ * @param shift The number of bits to left shift.\n+ * @return (intput * 2^shift) or nullopt if it would not fit in the return type.\n+ */\n+template <std::integral T>\n+constexpr std::optional<T> CheckedLeftShift(T input, unsigned shift) noexcept\n+{\n+    if (shift == 0 || input == 0) return input;\n+    // Avoid undefined c++ behaviour if shift is >= number of bits in T.\n+    if (shift >= sizeof(T) * CHAR_BIT) return std::nullopt;\n+    // If input << shift is too big to fit in T, return nullopt.\n+    const auto max_allowed_input{std::numeric_limits<T>::max() >> shift};\n+    if (input > 0 && input > max_allowed_input) return std::nullopt;\n+    if constexpr (std::is_signed_v<T>) {\n+        if (input < 0 && input < -max_allowed_input - 1) return std::nullopt;\n+    }",
      "path": "src/util/overflow.h",
      "position": null,
      "original_position": 30,
      "commit_id": "2a92702bafca5c78b270a9502a22cb9deac02cfc",
      "original_commit_id": "430d5feee9b8be3a85e85696c449753783301c2b",
      "in_reply_to_id": 1916527403,
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "re: https://github.com/bitcoin/bitcoin/pull/31483#discussion_r1916527403\r\n\r\n> nit: I think the runtime signedness checks are unnecessary, and find `std::numeric_limits<T>::min()` a bit more readable than `-max_allowed_input - 1`, so putting it all together this can just be simplified to\r\n\r\nAgree with this suggestion. The only reason for writing code that way was that I read \"For negative a, the value of a >> b is implementation-defined\" in the [c++ reference](https://en.cppreference.com/w/cpp/language/operator_arithmetic#Built-in_bitwise_shift_operators) and didn't realize that sentence was in the \"until c++20\" section. After c++ 20, right shifting negative values is well defined so this should be ok.",
      "created_at": "2025-01-15T14:16:18Z",
      "updated_at": "2025-01-15T14:40:09Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31483#discussion_r1916723745",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1916723745"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31483"
        }
      },
      "start_line": null,
      "original_start_line": 65,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 69,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1916730308",
      "pull_request_review_id": 2552875375,
      "id": 1916730308,
      "node_id": "PRRC_kwDOABII585yPvvE",
      "diff_hunk": "@@ -47,4 +49,41 @@ template <class T>\n     return i + j;\n }\n \n+/**\n+ * @brief Left bit shift with overflow checking.\n+ * @param input The input value to be left shifted.\n+ * @param shift The number of bits to left shift.\n+ * @return (intput * 2^shift) or nullopt if it would not fit in the return type.",
      "path": "src/util/overflow.h",
      "position": null,
      "original_position": 17,
      "commit_id": "2a92702bafca5c78b270a9502a22cb9deac02cfc",
      "original_commit_id": "7993f26173d911d3773cb2580938ac9aad8ad31b",
      "in_reply_to_id": null,
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "In commit \"util: Add integer left shift helpers\" (7993f26173d911d3773cb2580938ac9aad8ad31b)\r\n\r\nintput (unless you want to coin a phrase)",
      "created_at": "2025-01-15T14:19:28Z",
      "updated_at": "2025-01-15T14:40:09Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31483#discussion_r1916730308",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1916730308"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31483"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 56,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1916739868",
      "pull_request_review_id": 2552875375,
      "id": 1916739868,
      "node_id": "PRRC_kwDOABII585yPyEc",
      "diff_hunk": "@@ -0,0 +1,49 @@\n+// Copyright (c) 2025-present The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#include <test/fuzz/FuzzedDataProvider.h>\n+#include <test/fuzz/fuzz.h>\n+#include <util/check.h>\n+#include <util/overflow.h>\n+\n+#include <algorithm>\n+#include <limits>\n+#include <optional>\n+\n+namespace {\n+//! Test overflow operations for type T using a wider type, W, to verify results.\n+template <typename T, typename W>\n+void TestOverflow(FuzzedDataProvider& fuzzed_data_provider)\n+{\n+    constexpr auto min{std::numeric_limits<T>::min()};\n+    constexpr auto max{std::numeric_limits<T>::max()};\n+    static_assert(min >= std::numeric_limits<W>::min() / 2);",
      "path": "src/test/fuzz/overflow.cpp",
      "position": 22,
      "original_position": 21,
      "commit_id": "2a92702bafca5c78b270a9502a22cb9deac02cfc",
      "original_commit_id": "430d5feee9b8be3a85e85696c449753783301c2b",
      "in_reply_to_id": null,
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "In commit \"fuzz: Add fuzz test for checked and saturating add and left shift\" (b7c8d88ec2d299d2b19f5c622ee5080cfdf8b2a0)\r\n\r\nCould add comment to explain divide by two: \"// Range needs to be at least twice as big to allow two numbers to be added without overflowing.\" Apparently I have goldfish memory, I wrote this code yesterday and already forgot why it was there.",
      "created_at": "2025-01-15T14:23:10Z",
      "updated_at": "2025-01-15T14:40:09Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31483#discussion_r1916739868",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1916739868"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31483"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 22,
      "original_line": 22,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1916750160",
      "pull_request_review_id": 2552914048,
      "id": 1916750160,
      "node_id": "PRRC_kwDOABII585yP0lQ",
      "diff_hunk": "@@ -47,4 +49,41 @@ template <class T>\n     return i + j;\n }\n \n+/**\n+ * @brief Left bit shift with overflow checking.\n+ * @param input The input value to be left shifted.\n+ * @param shift The number of bits to left shift.\n+ * @return (intput * 2^shift) or nullopt if it would not fit in the return type.\n+ */\n+template <std::integral T>\n+constexpr std::optional<T> CheckedLeftShift(T input, unsigned shift) noexcept\n+{\n+    if (shift == 0 || input == 0) return input;\n+    // Avoid undefined c++ behaviour if shift is >= number of bits in T.\n+    if (shift >= sizeof(T) * CHAR_BIT) return std::nullopt;\n+    // If input << shift is too big to fit in T, return nullopt.\n+    const auto max_allowed_input{std::numeric_limits<T>::max() >> shift};\n+    if (input > 0 && input > max_allowed_input) return std::nullopt;\n+    if constexpr (std::is_signed_v<T>) {\n+        if (input < 0 && input < -max_allowed_input - 1) return std::nullopt;\n+    }",
      "path": "src/util/overflow.h",
      "position": null,
      "original_position": 30,
      "commit_id": "2a92702bafca5c78b270a9502a22cb9deac02cfc",
      "original_commit_id": "430d5feee9b8be3a85e85696c449753783301c2b",
      "in_reply_to_id": 1916527403,
      "user": {
        "login": "TheCharlatan",
        "id": 8421793,
        "node_id": "MDQ6VXNlcjg0MjE3OTM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8421793?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/TheCharlatan",
        "html_url": "https://github.com/TheCharlatan",
        "followers_url": "https://api.github.com/users/TheCharlatan/followers",
        "following_url": "https://api.github.com/users/TheCharlatan/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/TheCharlatan/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/TheCharlatan/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/TheCharlatan/subscriptions",
        "organizations_url": "https://api.github.com/users/TheCharlatan/orgs",
        "repos_url": "https://api.github.com/users/TheCharlatan/repos",
        "events_url": "https://api.github.com/users/TheCharlatan/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/TheCharlatan/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "Mmh, yeah, I think that should work.",
      "created_at": "2025-01-15T14:26:27Z",
      "updated_at": "2025-01-15T14:26:27Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/31483#discussion_r1916750160",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1916750160"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/31483"
        }
      },
      "start_line": null,
      "original_start_line": 65,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 69,
      "side": "RIGHT"
    }
  ]
}
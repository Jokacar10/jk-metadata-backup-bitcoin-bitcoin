{
  "type": "pull",
  "pull": {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29179",
    "id": 1664966896,
    "node_id": "PR_kwDOABII585jPWDw",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/29179",
    "diff_url": "https://github.com/bitcoin/bitcoin/pull/29179.diff",
    "patch_url": "https://github.com/bitcoin/bitcoin/pull/29179.patch",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29179",
    "commits_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29179/commits",
    "review_comments_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29179/comments",
    "review_comment_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments%7B/number%7D",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29179/comments",
    "statuses_url": "https://api.github.com/repos/bitcoin/bitcoin/statuses/df30247705940c50c5eaafd74e2abbeb8b0cec07",
    "number": 29179,
    "state": "closed",
    "locked": true,
    "maintainer_can_modify": false,
    "title": "test: wallet rescan with reorged parent + IsFromMe child in mempool",
    "user": {
      "login": "glozow",
      "id": 25183001,
      "node_id": "MDQ6VXNlcjI1MTgzMDAx",
      "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/glozow",
      "html_url": "https://github.com/glozow",
      "followers_url": "https://api.github.com/users/glozow/followers",
      "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
      "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
      "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
      "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
      "organizations_url": "https://api.github.com/users/glozow/orgs",
      "repos_url": "https://api.github.com/users/glozow/repos",
      "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
      "received_events_url": "https://api.github.com/users/glozow/received_events",
      "type": "User",
      "site_admin": false,
      "patch_url": null
    },
    "body": "Originally motivated by #29019, which reverts back to having `requestMempoolTransactions` emit `transactionAddedToMempool` in `mapTx` default order instead of `GetSortedDepthAndScore` order.\r\n\r\nIt's important that these notifications happen in topological order, otherwise the wallet rescan may miss transactions that belong to it. Notably, checking whether a transaction `IsFromMe` requires knowing its inputs, which may be from a mempool parent.\r\n\r\nWhen using `mapTx` order, a parent may come later than its child if it was added from a block disconnected in a reorg.\r\n\r\nThis PR adds a test for this case.",
    "labels": [
      {
        "id": 62963516,
        "node_id": "MDU6TGFiZWw2Mjk2MzUxNg==",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Tests",
        "name": "Tests",
        "color": "d4c5f9",
        "default": false
      }
    ],
    "created_at": "2024-01-04T16:26:03Z",
    "updated_at": "2025-02-07T07:29:50Z",
    "closed_at": "2024-01-16T17:49:28Z",
    "mergeable_state": "unknown",
    "merged_at": "2024-01-16T17:49:28Z",
    "merged_by": {
      "login": "achow101",
      "id": 3782274,
      "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/achow101",
      "html_url": "https://github.com/achow101",
      "followers_url": "https://api.github.com/users/achow101/followers",
      "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
      "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
      "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
      "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
      "organizations_url": "https://api.github.com/users/achow101/orgs",
      "repos_url": "https://api.github.com/users/achow101/repos",
      "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
      "received_events_url": "https://api.github.com/users/achow101/received_events",
      "type": "User",
      "site_admin": false,
      "patch_url": null
    },
    "merge_commit_sha": "27d935f58b9ef5560ddd5914547a6de7884c41e6",
    "assignees": [],
    "requested_reviewers": [],
    "requested_teams": [],
    "head": {
      "label": "glozow:2024-01-test-reorg-rescan",
      "ref": "2024-01-test-reorg-rescan",
      "sha": "df30247705940c50c5eaafd74e2abbeb8b0cec07",
      "user": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "repo": {
        "id": 244262754,
        "node_id": "MDEwOlJlcG9zaXRvcnkyNDQyNjI3NTQ=",
        "name": "bitcoin",
        "full_name": "glozow/bitcoin",
        "owner": {
          "login": "glozow",
          "id": 25183001,
          "node_id": "MDQ6VXNlcjI1MTgzMDAx",
          "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
          "gravatar_id": "",
          "url": "https://api.github.com/users/glozow",
          "html_url": "https://github.com/glozow",
          "followers_url": "https://api.github.com/users/glozow/followers",
          "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
          "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
          "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
          "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
          "organizations_url": "https://api.github.com/users/glozow/orgs",
          "repos_url": "https://api.github.com/users/glozow/repos",
          "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
          "received_events_url": "https://api.github.com/users/glozow/received_events",
          "type": "User",
          "site_admin": false,
          "patch_url": null
        },
        "private": false,
        "html_url": "https://github.com/glozow/bitcoin",
        "description": "Bitcoin Core integration/staging tree",
        "fork": true,
        "url": "https://api.github.com/repos/glozow/bitcoin",
        "archive_url": "https://api.github.com/repos/glozow/bitcoin/%7Barchive_format%7D%7B/ref%7D",
        "assignees_url": "https://api.github.com/repos/glozow/bitcoin/assignees%7B/user%7D",
        "blobs_url": "https://api.github.com/repos/glozow/bitcoin/git/blobs%7B/sha%7D",
        "branches_url": "https://api.github.com/repos/glozow/bitcoin/branches%7B/branch%7D",
        "collaborators_url": "https://api.github.com/repos/glozow/bitcoin/collaborators%7B/collaborator%7D",
        "comments_url": "https://api.github.com/repos/glozow/bitcoin/comments%7B/number%7D",
        "commits_url": "https://api.github.com/repos/glozow/bitcoin/commits%7B/sha%7D",
        "compare_url": "https://api.github.com/repos/glozow/bitcoin/compare/%7Bbase%7D...%7Bhead%7D",
        "contents_url": "https://api.github.com/repos/glozow/bitcoin/contents/%7B+path%7D",
        "contributors_url": "https://api.github.com/repos/glozow/bitcoin/contributors",
        "deployments_url": "https://api.github.com/repos/glozow/bitcoin/deployments",
        "downloads_url": "https://api.github.com/repos/glozow/bitcoin/downloads",
        "events_url": "https://api.github.com/repos/glozow/bitcoin/events",
        "forks_url": "https://api.github.com/repos/glozow/bitcoin/forks",
        "git_commits_url": "https://api.github.com/repos/glozow/bitcoin/git/commits%7B/sha%7D",
        "git_refs_url": "https://api.github.com/repos/glozow/bitcoin/git/refs%7B/sha%7D",
        "git_tags_url": "https://api.github.com/repos/glozow/bitcoin/git/tags%7B/sha%7D",
        "git_url": "git://github.com/glozow/bitcoin.git",
        "issue_comment_url": "https://api.github.com/repos/glozow/bitcoin/issues/comments%7B/number%7D",
        "issue_events_url": "https://api.github.com/repos/glozow/bitcoin/issues/events%7B/number%7D",
        "issues_url": "https://api.github.com/repos/glozow/bitcoin/issues%7B/number%7D",
        "keys_url": "https://api.github.com/repos/glozow/bitcoin/keys%7B/key_id%7D",
        "labels_url": "https://api.github.com/repos/glozow/bitcoin/labels%7B/name%7D",
        "languages_url": "https://api.github.com/repos/glozow/bitcoin/languages",
        "merges_url": "https://api.github.com/repos/glozow/bitcoin/merges",
        "milestones_url": "https://api.github.com/repos/glozow/bitcoin/milestones%7B/number%7D",
        "notifications_url": "https://api.github.com/repos/glozow/bitcoin/notifications%7B?since,all,participating}",
        "pulls_url": "https://api.github.com/repos/glozow/bitcoin/pulls%7B/number%7D",
        "releases_url": "https://api.github.com/repos/glozow/bitcoin/releases%7B/id%7D",
        "ssh_url": "git@github.com:glozow/bitcoin.git",
        "stargazers_url": "https://api.github.com/repos/glozow/bitcoin/stargazers",
        "statuses_url": "https://api.github.com/repos/glozow/bitcoin/statuses/%7Bsha%7D",
        "subscribers_url": "https://api.github.com/repos/glozow/bitcoin/subscribers",
        "subscription_url": "https://api.github.com/repos/glozow/bitcoin/subscription",
        "tags_url": "https://api.github.com/repos/glozow/bitcoin/tags",
        "teams_url": "https://api.github.com/repos/glozow/bitcoin/teams",
        "trees_url": "https://api.github.com/repos/glozow/bitcoin/git/trees%7B/sha%7D",
        "clone_url": "https://github.com/glozow/bitcoin.git",
        "hooks_url": "https://api.github.com/repos/glozow/bitcoin/hooks",
        "svn_url": "https://github.com/glozow/bitcoin",
        "homepage": "https://bitcoincore.org/en/download",
        "language": "C++",
        "forks_count": 4,
        "stargazers_count": 12,
        "watchers_count": 12,
        "size": 266124,
        "default_branch": "master",
        "open_issues_count": 1,
        "is_template": false,
        "topics": [],
        "has_issues": false,
        "has_projects": true,
        "has_wiki": true,
        "has_pages": false,
        "has_downloads": false,
        "archived": false,
        "disabled": false,
        "visibility": "public",
        "pushed_at": "2025-02-06T20:46:47Z",
        "created_at": "2020-03-02T02:31:56Z",
        "updated_at": "2025-02-06T19:48:09Z",
        "allow_forking": true,
        "license": {
          "key": "mit",
          "name": "MIT License",
          "node_id": "MDc6TGljZW5zZTEz",
          "spdx_id": "MIT",
          "url": "https://api.github.com/licenses/mit",
          "html_url": null,
          "description": null,
          "implementation": null,
          "permissions": null,
          "conditions": null,
          "limitations": null,
          "body": null,
          "featured": null
        }
      }
    },
    "base": {
      "label": "bitcoin:master",
      "ref": "master",
      "sha": "3ba8de1b704d590fa4e1975620bd21d830d11666",
      "user": {
        "login": "bitcoin",
        "id": 528860,
        "node_id": "MDEyOk9yZ2FuaXphdGlvbjUyODg2MA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/528860?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/bitcoin",
        "html_url": "https://github.com/bitcoin",
        "followers_url": "https://api.github.com/users/bitcoin/followers",
        "following_url": "https://api.github.com/users/bitcoin/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/bitcoin/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/bitcoin/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/bitcoin/subscriptions",
        "organizations_url": "https://api.github.com/users/bitcoin/orgs",
        "repos_url": "https://api.github.com/users/bitcoin/repos",
        "events_url": "https://api.github.com/users/bitcoin/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/bitcoin/received_events",
        "type": "Organization",
        "site_admin": false,
        "patch_url": null
      },
      "repo": {
        "id": 1181927,
        "node_id": "MDEwOlJlcG9zaXRvcnkxMTgxOTI3",
        "name": "bitcoin",
        "full_name": "bitcoin/bitcoin",
        "owner": {
          "login": "bitcoin",
          "id": 528860,
          "node_id": "MDEyOk9yZ2FuaXphdGlvbjUyODg2MA==",
          "avatar_url": "https://avatars.githubusercontent.com/u/528860?v=4",
          "gravatar_id": "",
          "url": "https://api.github.com/users/bitcoin",
          "html_url": "https://github.com/bitcoin",
          "followers_url": "https://api.github.com/users/bitcoin/followers",
          "following_url": "https://api.github.com/users/bitcoin/following%7B/other_user%7D",
          "gists_url": "https://api.github.com/users/bitcoin/gists%7B/gist_id%7D",
          "starred_url": "https://api.github.com/users/bitcoin/starred%7B/owner%7D%7B/repo%7D",
          "subscriptions_url": "https://api.github.com/users/bitcoin/subscriptions",
          "organizations_url": "https://api.github.com/users/bitcoin/orgs",
          "repos_url": "https://api.github.com/users/bitcoin/repos",
          "events_url": "https://api.github.com/users/bitcoin/events%7B/privacy%7D",
          "received_events_url": "https://api.github.com/users/bitcoin/received_events",
          "type": "Organization",
          "site_admin": false,
          "patch_url": null
        },
        "private": false,
        "html_url": "https://github.com/bitcoin/bitcoin",
        "description": "Bitcoin Core integration/staging tree",
        "fork": false,
        "url": "https://api.github.com/repos/bitcoin/bitcoin",
        "archive_url": "https://api.github.com/repos/bitcoin/bitcoin/%7Barchive_format%7D%7B/ref%7D",
        "assignees_url": "https://api.github.com/repos/bitcoin/bitcoin/assignees%7B/user%7D",
        "blobs_url": "https://api.github.com/repos/bitcoin/bitcoin/git/blobs%7B/sha%7D",
        "branches_url": "https://api.github.com/repos/bitcoin/bitcoin/branches%7B/branch%7D",
        "collaborators_url": "https://api.github.com/repos/bitcoin/bitcoin/collaborators%7B/collaborator%7D",
        "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/comments%7B/number%7D",
        "commits_url": "https://api.github.com/repos/bitcoin/bitcoin/commits%7B/sha%7D",
        "compare_url": "https://api.github.com/repos/bitcoin/bitcoin/compare/%7Bbase%7D...%7Bhead%7D",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/%7B+path%7D",
        "contributors_url": "https://api.github.com/repos/bitcoin/bitcoin/contributors",
        "deployments_url": "https://api.github.com/repos/bitcoin/bitcoin/deployments",
        "downloads_url": "https://api.github.com/repos/bitcoin/bitcoin/downloads",
        "events_url": "https://api.github.com/repos/bitcoin/bitcoin/events",
        "forks_url": "https://api.github.com/repos/bitcoin/bitcoin/forks",
        "git_commits_url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits%7B/sha%7D",
        "git_refs_url": "https://api.github.com/repos/bitcoin/bitcoin/git/refs%7B/sha%7D",
        "git_tags_url": "https://api.github.com/repos/bitcoin/bitcoin/git/tags%7B/sha%7D",
        "git_url": "git://github.com/bitcoin/bitcoin.git",
        "issue_comment_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments%7B/number%7D",
        "issue_events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events%7B/number%7D",
        "issues_url": "https://api.github.com/repos/bitcoin/bitcoin/issues%7B/number%7D",
        "keys_url": "https://api.github.com/repos/bitcoin/bitcoin/keys%7B/key_id%7D",
        "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/labels%7B/name%7D",
        "languages_url": "https://api.github.com/repos/bitcoin/bitcoin/languages",
        "merges_url": "https://api.github.com/repos/bitcoin/bitcoin/merges",
        "milestones_url": "https://api.github.com/repos/bitcoin/bitcoin/milestones%7B/number%7D",
        "notifications_url": "https://api.github.com/repos/bitcoin/bitcoin/notifications%7B?since,all,participating}",
        "pulls_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls%7B/number%7D",
        "releases_url": "https://api.github.com/repos/bitcoin/bitcoin/releases%7B/id%7D",
        "ssh_url": "git@github.com:bitcoin/bitcoin.git",
        "stargazers_url": "https://api.github.com/repos/bitcoin/bitcoin/stargazers",
        "statuses_url": "https://api.github.com/repos/bitcoin/bitcoin/statuses/%7Bsha%7D",
        "subscribers_url": "https://api.github.com/repos/bitcoin/bitcoin/subscribers",
        "subscription_url": "https://api.github.com/repos/bitcoin/bitcoin/subscription",
        "tags_url": "https://api.github.com/repos/bitcoin/bitcoin/tags",
        "teams_url": "https://api.github.com/repos/bitcoin/bitcoin/teams",
        "trees_url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees%7B/sha%7D",
        "clone_url": "https://github.com/bitcoin/bitcoin.git",
        "hooks_url": "https://api.github.com/repos/bitcoin/bitcoin/hooks",
        "svn_url": "https://github.com/bitcoin/bitcoin",
        "homepage": "https://bitcoincore.org/en/download",
        "language": "C++",
        "forks_count": 36676,
        "stargazers_count": 81853,
        "watchers_count": 81853,
        "size": 275255,
        "default_branch": "master",
        "open_issues_count": 698,
        "is_template": false,
        "topics": [
          "bitcoin",
          "c-plus-plus",
          "cryptocurrency",
          "cryptography",
          "p2p"
        ],
        "has_issues": true,
        "has_projects": true,
        "has_wiki": false,
        "has_pages": false,
        "has_downloads": false,
        "archived": false,
        "disabled": false,
        "visibility": "public",
        "pushed_at": "2025-02-06T20:22:11Z",
        "created_at": "2010-12-19T15:16:43Z",
        "updated_at": "2025-02-07T06:32:24Z",
        "allow_forking": true,
        "license": {
          "key": "mit",
          "name": "MIT License",
          "node_id": "MDc6TGljZW5zZTEz",
          "spdx_id": "MIT",
          "url": "https://api.github.com/licenses/mit",
          "html_url": null,
          "description": null,
          "implementation": null,
          "permissions": null,
          "conditions": null,
          "limitations": null,
          "body": null,
          "featured": null
        }
      }
    },
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29179"
      }
    },
    "author_association": "MEMBER",
    "draft": false,
    "additions": 131,
    "deletions": 9,
    "changed_files": 3,
    "commits": 2,
    "review_comments": 37,
    "comments": 12
  },
  "events": [
    {
      "event": "labeled",
      "id": 11392098099,
      "node_id": "LE_lADOABII5857JAo-zwAAAAKnBZ8z",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/11392098099",
      "actor": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-01-04T16:26:03Z",
      "label": {
        "name": "Tests",
        "color": "d4c5f9"
      }
    },
    {
      "event": "commented",
      "id": 1877390756,
      "node_id": "IC_kwDOABII585v5rWk",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1877390756",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-01-04T16:26:06Z",
      "updated_at": "2024-01-16T17:38:43Z",
      "author_association": "CONTRIBUTOR",
      "body": "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--006a51241073e994b41acfe9ec718e94-->\n### Code Coverage\nFor detailed information about the code coverage, see the [test coverage report](https://corecheck.dev/bitcoin/bitcoin/pulls/29179).\n<!--021abf342d371248e50ceaed478a90ca-->\n### Reviews\nSee [the guideline](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#code-review) for information on the review process.\n| Type | Reviewers |\n| ---- | --------- |\n| ACK | [furszy](https://github.com/bitcoin/bitcoin/pull/29179#pullrequestreview-1818866732), [achow101](https://github.com/bitcoin/bitcoin/pull/29179#issuecomment-1894209088) |\n| Stale ACK | [Eunovo](https://github.com/bitcoin/bitcoin/pull/29179#issuecomment-1885834450), [stickies-v](https://github.com/bitcoin/bitcoin/pull/29179#pullrequestreview-1818404985) |\n\nIf your review is incorrectly listed, please react with 👎 to this comment and the bot will ignore it on the next update.\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* [#28710](https://github.com/bitcoin/bitcoin/pull/28710) (Remove the legacy wallet and BDB dependency by achow101)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.\n",
      "user": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29179#issuecomment-1877390756",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29179"
    },
    {
      "event": "commented",
      "id": 1877879833,
      "node_id": "IC_kwDOABII585v7iwZ",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1877879833",
      "actor": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-01-04T23:02:07Z",
      "updated_at": "2024-01-04T23:02:07Z",
      "author_association": "MEMBER",
      "body": "Huh, looks like this behavior has been broken since it was introduced in #15652",
      "user": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29179#issuecomment-1877879833",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29179"
    },
    {
      "event": "commented",
      "id": 1877892122,
      "node_id": "IC_kwDOABII585v7lwa",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1877892122",
      "actor": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-01-04T23:16:40Z",
      "updated_at": "2024-01-04T23:16:40Z",
      "author_association": "MEMBER",
      "body": "ACK 1a52ca7619eeb1baafa5a32b364381126862b29d",
      "user": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29179#issuecomment-1877892122",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29179"
    },
    {
      "event": "reviewed",
      "id": 1805846181,
      "node_id": "PRR_kwDOABII585rowal",
      "url": null,
      "actor": null,
      "commit_id": "1a52ca7619eeb1baafa5a32b364381126862b29d",
      "commit_url": null,
      "created_at": null,
      "author_association": "CONTRIBUTOR",
      "body": "Approach ACK, nice one finding this test case! 1a52ca7619eeb1baafa5a32b364381126862b29d looks good to me but not super familiar with this part of the code. Left some suggestions about maintainability and can be ignored.\r\n\r\nI verified that the tests fail on #29019 as well as on 453b4813ebc74859864803e9972b58e4be76a4d6~1, as is necessary.",
      "user": {
        "login": "stickies-v",
        "id": 69010457,
        "node_id": "MDQ6VXNlcjY5MDEwNDU3",
        "avatar_url": "https://avatars.githubusercontent.com/u/69010457?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stickies-v",
        "html_url": "https://github.com/stickies-v",
        "followers_url": "https://api.github.com/users/stickies-v/followers",
        "following_url": "https://api.github.com/users/stickies-v/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stickies-v/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stickies-v/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stickies-v/subscriptions",
        "organizations_url": "https://api.github.com/users/stickies-v/orgs",
        "repos_url": "https://api.github.com/users/stickies-v/repos",
        "events_url": "https://api.github.com/users/stickies-v/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stickies-v/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29179#pullrequestreview-1805846181",
      "submitted_at": "2024-01-05T17:25:16Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29179"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 11403952066,
      "node_id": "HRFPE_lADOABII5857JAo-zwAAAAKnun_C",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/11403952066",
      "actor": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": "aa7eda33c35a40760cd9ad26fed02c27f4127e1e",
      "commit_url": "https://api.github.com/repos/glozow/bitcoin/commits/aa7eda33c35a40760cd9ad26fed02c27f4127e1e",
      "created_at": "2024-01-05T18:14:07Z"
    },
    {
      "event": "reviewed",
      "id": 1806935444,
      "node_id": "PRR_kwDOABII585rs6WU",
      "url": null,
      "actor": null,
      "commit_id": "aa7eda33c35a40760cd9ad26fed02c27f4127e1e",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "body": "Pre-review note: have you considered that `wallet_import_rescan.py` is a legacy wallet only test?\r\nIf it's placed here due to a lack of alternatives, I think this could be moved to a separate `wallet_mempool.py` file, where we could continue adding more cases related to the wallet-mempool interaction (or.. we could upgrade this file to run on a descriptors wallet).",
      "user": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29179#pullrequestreview-1806935444",
      "submitted_at": "2024-01-05T22:18:30Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29179"
    },
    {
      "event": "commented",
      "id": 1880584066,
      "node_id": "IC_kwDOABII585wF2-C",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1880584066",
      "actor": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-01-08T08:46:54Z",
      "updated_at": "2024-01-08T09:18:40Z",
      "author_association": "MEMBER",
      "body": "> Pre-review note: have you considered that wallet_import_rescan.py is a legacy wallet only test?\r\n\r\nAh good point. ~I added a commit to run this test with descriptors as I couldn't find a reason why we don't do this. Lmk if this seems sufficient / ok to do?~ EDIT: oh descriptors can't use `dumpprivkey`, nvm",
      "user": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29179#issuecomment-1880584066",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29179"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 11415004610,
      "node_id": "HRFPE_lADOABII5857JAo-zwAAAAKoYyXC",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/11415004610",
      "actor": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": "aa7eda33c35a40760cd9ad26fed02c27f4127e1e",
      "commit_url": "https://api.github.com/repos/glozow/bitcoin/commits/aa7eda33c35a40760cd9ad26fed02c27f4127e1e",
      "created_at": "2024-01-08T09:18:52Z"
    },
    {
      "event": "labeled",
      "id": 11415005372,
      "node_id": "LE_lADOABII5857JAo-zwAAAAKoYyi8",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/11415005372",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-01-08T09:18:56Z",
      "label": {
        "name": "CI failed",
        "color": "cccccc"
      }
    },
    {
      "event": "unlabeled",
      "id": 11415499547,
      "node_id": "UNLE_lADOABII5857JAo-zwAAAAKoarMb",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/11415499547",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-01-08T10:03:16Z",
      "label": {
        "name": "CI failed",
        "color": "cccccc"
      }
    },
    {
      "event": "commented",
      "id": 1882660532,
      "node_id": "IC_kwDOABII585wNx60",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1882660532",
      "actor": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-01-09T09:04:43Z",
      "updated_at": "2024-01-09T09:04:43Z",
      "author_association": "MEMBER",
      "body": "I'm working on adding a descriptors version of this test so we can have both.",
      "user": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29179#issuecomment-1882660532",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29179"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 11428503435,
      "node_id": "HRFPE_lADOABII5857JAo-zwAAAAKpMR-L",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/11428503435",
      "actor": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": "86f5cc83dee14e8e66d5b602fee8c25b1802349f",
      "commit_url": "https://api.github.com/repos/glozow/bitcoin/commits/86f5cc83dee14e8e66d5b602fee8c25b1802349f",
      "created_at": "2024-01-09T10:36:36Z"
    },
    {
      "event": "commented",
      "id": 1882825009,
      "node_id": "IC_kwDOABII585wOaEx",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1882825009",
      "actor": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-01-09T10:39:16Z",
      "updated_at": "2024-01-09T10:39:16Z",
      "author_association": "MEMBER",
      "body": "I've added another commit which has pretty much the same test but using descriptor wallets i.e. a rescan through `importdescriptors`. Just like the other test, you can reproduce the bug by cherry-picking from #29019. You should get `JSONRPCEXCEPTION: Invalid or non-wallet transaction id (-5)` for the child tx.",
      "user": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29179#issuecomment-1882825009",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29179"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 11428734891,
      "node_id": "HRFPE_lADOABII5857JAo-zwAAAAKpNKer",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/11428734891",
      "actor": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": "1b18ac42a7a62e495d6e6ea29757fe5d9e97625c",
      "commit_url": "https://api.github.com/repos/glozow/bitcoin/commits/1b18ac42a7a62e495d6e6ea29757fe5d9e97625c",
      "created_at": "2024-01-09T10:55:36Z"
    },
    {
      "event": "labeled",
      "id": 11428735677,
      "node_id": "LE_lADOABII5857JAo-zwAAAAKpNKq9",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/11428735677",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-01-09T10:55:40Z",
      "label": {
        "name": "CI failed",
        "color": "cccccc"
      }
    },
    {
      "event": "head_ref_force_pushed",
      "id": 11428869979,
      "node_id": "HRFPE_lADOABII5857JAo-zwAAAAKpNrdb",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/11428869979",
      "actor": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": "fa2b8d0e30c45b4ff59db1ac6aaeab3dc10f3df3",
      "commit_url": "https://api.github.com/repos/glozow/bitcoin/commits/fa2b8d0e30c45b4ff59db1ac6aaeab3dc10f3df3",
      "created_at": "2024-01-09T11:07:06Z"
    },
    {
      "event": "reviewed",
      "id": 1811002749,
      "node_id": "PRR_kwDOABII585r8bV9",
      "url": null,
      "actor": null,
      "commit_id": "fa2b8d0e30c45b4ff59db1ac6aaeab3dc10f3df3",
      "commit_url": null,
      "created_at": null,
      "author_association": "CONTRIBUTOR",
      "body": "Hooray for adding descriptor wallet support. Is there a reason both legacy and descriptor wallet tests aren't in the new `wallet_rescan_unconfirmed` test, though? That seems like a more logical grouping with less duplication? If there are technical objections, I think it would be good to add some extra documentation to both tests stating that the other wallet type is tested in file xxx.py, making it easier to clean up these tests e.g. when we drop legacy wallets or make other significant changes?",
      "user": {
        "login": "stickies-v",
        "id": 69010457,
        "node_id": "MDQ6VXNlcjY5MDEwNDU3",
        "avatar_url": "https://avatars.githubusercontent.com/u/69010457?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stickies-v",
        "html_url": "https://github.com/stickies-v",
        "followers_url": "https://api.github.com/users/stickies-v/followers",
        "following_url": "https://api.github.com/users/stickies-v/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stickies-v/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stickies-v/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stickies-v/subscriptions",
        "organizations_url": "https://api.github.com/users/stickies-v/orgs",
        "repos_url": "https://api.github.com/users/stickies-v/repos",
        "events_url": "https://api.github.com/users/stickies-v/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stickies-v/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29179#pullrequestreview-1811002749",
      "submitted_at": "2024-01-09T12:09:00Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29179"
    },
    {
      "event": "unlabeled",
      "id": 11429804017,
      "node_id": "UNLE_lADOABII5857JAo-zwAAAAKpRPfx",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/11429804017",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-01-09T12:32:10Z",
      "label": {
        "name": "CI failed",
        "color": "cccccc"
      }
    },
    {
      "event": "commented",
      "id": 1883154232,
      "node_id": "IC_kwDOABII585wPqc4",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1883154232",
      "actor": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-01-09T14:30:25Z",
      "updated_at": "2024-01-09T14:31:19Z",
      "author_association": "MEMBER",
      "body": "> Is there a reason both legacy and descriptor wallet tests aren't in the new wallet_rescan_unconfirmed test, though? That seems like a more logical grouping with less duplication?\r\n\r\nThey use different RPCs. I think it's more readable for them to be separate (having most the test as `if is_sqlite_compiled() elif is_bdb_compiled()` is pretty annoying). I think it's much easier to delete legacy without touching the descriptor one if they're in different files.",
      "user": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29179#issuecomment-1883154232",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29179"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 11432220616,
      "node_id": "HRFPE_lADOABII5857JAo-zwAAAAKpadfI",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/11432220616",
      "actor": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": "d9df438c6e581dae0c818a4c2f5fe95627ae26bc",
      "commit_url": "https://api.github.com/repos/glozow/bitcoin/commits/d9df438c6e581dae0c818a4c2f5fe95627ae26bc",
      "created_at": "2024-01-09T15:48:28Z"
    },
    {
      "event": "review_requested",
      "id": 11441548047,
      "node_id": "RRE_lADOABII5857JAo-zwAAAAKp-CsP",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/11441548047",
      "actor": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-01-10T10:46:25Z",
      "requested_reviewer": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "review_requester": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      }
    },
    {
      "event": "review_requested",
      "id": 11441549373,
      "node_id": "RRE_lADOABII5857JAo-zwAAAAKp-DA9",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/11441549373",
      "actor": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-01-10T10:46:32Z",
      "requested_reviewer": {
        "login": "stickies-v",
        "id": 69010457,
        "node_id": "MDQ6VXNlcjY5MDEwNDU3",
        "avatar_url": "https://avatars.githubusercontent.com/u/69010457?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stickies-v",
        "html_url": "https://github.com/stickies-v",
        "followers_url": "https://api.github.com/users/stickies-v/followers",
        "following_url": "https://api.github.com/users/stickies-v/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stickies-v/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stickies-v/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stickies-v/subscriptions",
        "organizations_url": "https://api.github.com/users/stickies-v/orgs",
        "repos_url": "https://api.github.com/users/stickies-v/repos",
        "events_url": "https://api.github.com/users/stickies-v/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stickies-v/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "review_requester": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      }
    },
    {
      "event": "review_requested",
      "id": 11441549951,
      "node_id": "RRE_lADOABII5857JAo-zwAAAAKp-DJ_",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/11441549951",
      "actor": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-01-10T10:46:36Z",
      "requested_reviewer": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "review_requester": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      }
    },
    {
      "event": "commented",
      "id": 1885834450,
      "node_id": "IC_kwDOABII585wZ4zS",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1885834450",
      "actor": {
        "login": "Eunovo",
        "id": 37949128,
        "node_id": "MDQ6VXNlcjM3OTQ5MTI4",
        "avatar_url": "https://avatars.githubusercontent.com/u/37949128?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Eunovo",
        "html_url": "https://github.com/Eunovo",
        "followers_url": "https://api.github.com/users/Eunovo/followers",
        "following_url": "https://api.github.com/users/Eunovo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Eunovo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Eunovo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Eunovo/subscriptions",
        "organizations_url": "https://api.github.com/users/Eunovo/orgs",
        "repos_url": "https://api.github.com/users/Eunovo/repos",
        "events_url": "https://api.github.com/users/Eunovo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Eunovo/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-01-10T22:20:22Z",
      "updated_at": "2024-01-10T22:38:21Z",
      "author_association": "NONE",
      "body": "Tested ACK [d9df438](https://github.com/bitcoin/bitcoin/pull/29179/commits/d9df438c6e581dae0c818a4c2f5fe95627ae26bc)\r\n\r\nRan the tests locally and got `test_framework.authproxy.JSONRPCException: Invalid or non-wallet transaction id (-5)` for both `wallet_import_rescan.py` and `wallet_rescan_unconfirmed.py` when insertion order is used in `CTxMemPool::entryAll()`.\r\n",
      "user": {
        "login": "Eunovo",
        "id": 37949128,
        "node_id": "MDQ6VXNlcjM3OTQ5MTI4",
        "avatar_url": "https://avatars.githubusercontent.com/u/37949128?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Eunovo",
        "html_url": "https://github.com/Eunovo",
        "followers_url": "https://api.github.com/users/Eunovo/followers",
        "following_url": "https://api.github.com/users/Eunovo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Eunovo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Eunovo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Eunovo/subscriptions",
        "organizations_url": "https://api.github.com/users/Eunovo/orgs",
        "repos_url": "https://api.github.com/users/Eunovo/repos",
        "events_url": "https://api.github.com/users/Eunovo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Eunovo/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29179#issuecomment-1885834450",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29179"
    },
    {
      "event": "reviewed",
      "id": 1816762773,
      "node_id": "PRR_kwDOABII585sSZmV",
      "url": null,
      "actor": null,
      "commit_id": "d9df438c6e581dae0c818a4c2f5fe95627ae26bc",
      "commit_url": null,
      "created_at": null,
      "author_association": "CONTRIBUTOR",
      "body": "ACK d9df438c6e581dae0c818a4c2f5fe95627ae26bc\r\n\r\n> I think it's much easier to delete legacy without touching the descriptor one if they're in different files.\r\n\r\nThanks, you're right. There's less overlap than I thought there would be.",
      "user": {
        "login": "stickies-v",
        "id": 69010457,
        "node_id": "MDQ6VXNlcjY5MDEwNDU3",
        "avatar_url": "https://avatars.githubusercontent.com/u/69010457?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stickies-v",
        "html_url": "https://github.com/stickies-v",
        "followers_url": "https://api.github.com/users/stickies-v/followers",
        "following_url": "https://api.github.com/users/stickies-v/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stickies-v/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stickies-v/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stickies-v/subscriptions",
        "organizations_url": "https://api.github.com/users/stickies-v/orgs",
        "repos_url": "https://api.github.com/users/stickies-v/repos",
        "events_url": "https://api.github.com/users/stickies-v/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stickies-v/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29179#pullrequestreview-1816762773",
      "submitted_at": "2024-01-11T21:52:12Z",
      "state": "APPROVED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29179"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKGMzZDAyYmU1MzZhYzNmMzVjMTBlZmEwMzY1MzE4NmExN2ViYmZjMTI",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/c3d02be536ac3f35c10efa03653186a17ebbfc12",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/c3d02be536ac3f35c10efa03653186a17ebbfc12",
      "tree": {
        "sha": "fe2923ad883f86a0cfc6c068ac266e78a047101c",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/fe2923ad883f86a0cfc6c068ac266e78a047101c"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/65c05db660b2ca1d0076b0d8573a6760b3228068",
          "sha": "65c05db660b2ca1d0076b0d8573a6760b3228068",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/65c05db660b2ca1d0076b0d8573a6760b3228068"
        }
      ],
      "message": "[test] rescan legacy wallet with reorged parent + IsFromMe child in mempool\n\nTest that wallet rescans process transactions topologically, even if a\nparent's entry into the mempool is later than that of its child.\nThis behavior is important because IsFromMe requires the ability to look\nup a transaction's inputs.",
      "committer": {
        "name": "glozow",
        "email": "gloriajzhao@gmail.com",
        "date": "2024-01-12T09:54:57Z"
      },
      "author": {
        "name": "Gloria Zhao",
        "email": "gloriajzhao@gmail.com",
        "date": "2024-01-03T16:44:12Z"
      },
      "sha": "c3d02be536ac3f35c10efa03653186a17ebbfc12"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 11466993366,
      "node_id": "HRFPE_lADOABII5857JAo-zwAAAAKrfG7W",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/11466993366",
      "actor": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": "c39e82926a3740642f8f1bb72c6b10b67a6dc724",
      "commit_url": "https://api.github.com/repos/glozow/bitcoin/commits/c39e82926a3740642f8f1bb72c6b10b67a6dc724",
      "created_at": "2024-01-12T09:55:38Z"
    },
    {
      "event": "reviewed",
      "id": 1817832198,
      "node_id": "PRR_kwDOABII585sWesG",
      "url": null,
      "actor": null,
      "commit_id": "c39e82926a3740642f8f1bb72c6b10b67a6dc724",
      "commit_url": null,
      "created_at": null,
      "author_association": "CONTRIBUTOR",
      "body": "re-ACK c39e82926a3740642f8f1bb72c6b10b67a6dc724",
      "user": {
        "login": "stickies-v",
        "id": 69010457,
        "node_id": "MDQ6VXNlcjY5MDEwNDU3",
        "avatar_url": "https://avatars.githubusercontent.com/u/69010457?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stickies-v",
        "html_url": "https://github.com/stickies-v",
        "followers_url": "https://api.github.com/users/stickies-v/followers",
        "following_url": "https://api.github.com/users/stickies-v/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stickies-v/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stickies-v/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stickies-v/subscriptions",
        "organizations_url": "https://api.github.com/users/stickies-v/orgs",
        "repos_url": "https://api.github.com/users/stickies-v/repos",
        "events_url": "https://api.github.com/users/stickies-v/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stickies-v/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29179#pullrequestreview-1817832198",
      "submitted_at": "2024-01-12T10:03:28Z",
      "state": "APPROVED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29179"
    },
    {
      "event": "commented",
      "id": 1888844067,
      "node_id": "IC_kwDOABII585wlXkj",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1888844067",
      "actor": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-01-12T10:35:28Z",
      "updated_at": "2024-01-12T10:35:28Z",
      "author_association": "MEMBER",
      "body": "CI failure is unrelated, #29234",
      "user": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29179#issuecomment-1888844067",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29179"
    },
    {
      "event": "reviewed",
      "id": 1818093579,
      "node_id": "PRR_kwDOABII585sXegL",
      "url": null,
      "actor": null,
      "commit_id": "c39e82926a3740642f8f1bb72c6b10b67a6dc724",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "body": "Code reviewed, looking good. Left few comments, mostly testing time improvements. Nothing blocking.\r\n\r\nAs the scenario being covered does not require verifying p2p mempool relay, you could speed up the new `wallet_rescan_unconfirmed.py` test by ~2.5x (tested locally, ~3 secs versus ~8 secs) by using a single node instead of creating three of them. See commit f8273512 (feel free to pull it).",
      "user": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29179#pullrequestreview-1818093579",
      "submitted_at": "2024-01-12T13:15:36Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29179"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 11469851731,
      "node_id": "HRFPE_lADOABII5857JAo-zwAAAAKrqAxT",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/11469851731",
      "actor": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": "9db0d42509e0e223b45238fd8087fc98ef32c091",
      "commit_url": "https://api.github.com/repos/glozow/bitcoin/commits/9db0d42509e0e223b45238fd8087fc98ef32c091",
      "created_at": "2024-01-12T14:23:40Z"
    },
    {
      "event": "reviewed",
      "id": 1818404985,
      "node_id": "PRR_kwDOABII585sYqh5",
      "url": null,
      "actor": null,
      "commit_id": "9db0d42509e0e223b45238fd8087fc98ef32c091",
      "commit_url": null,
      "created_at": null,
      "author_association": "CONTRIBUTOR",
      "body": "re-ACK 9db0d42509e0e223b45238fd8087fc98ef32c091",
      "user": {
        "login": "stickies-v",
        "id": 69010457,
        "node_id": "MDQ6VXNlcjY5MDEwNDU3",
        "avatar_url": "https://avatars.githubusercontent.com/u/69010457?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stickies-v",
        "html_url": "https://github.com/stickies-v",
        "followers_url": "https://api.github.com/users/stickies-v/followers",
        "following_url": "https://api.github.com/users/stickies-v/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stickies-v/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stickies-v/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stickies-v/subscriptions",
        "organizations_url": "https://api.github.com/users/stickies-v/orgs",
        "repos_url": "https://api.github.com/users/stickies-v/repos",
        "events_url": "https://api.github.com/users/stickies-v/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stickies-v/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29179#pullrequestreview-1818404985",
      "submitted_at": "2024-01-12T14:39:02Z",
      "state": "APPROVED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29179"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 11470119593,
      "node_id": "HRFPE_lADOABII5857JAo-zwAAAAKrrCKp",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/11470119593",
      "actor": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": "4d09fd00847892cb7d368d2d8d7805d06cc249fb",
      "commit_url": "https://api.github.com/repos/glozow/bitcoin/commits/4d09fd00847892cb7d368d2d8d7805d06cc249fb",
      "created_at": "2024-01-12T14:46:26Z"
    },
    {
      "event": "labeled",
      "id": 11470120674,
      "node_id": "LE_lADOABII5857JAo-zwAAAAKrrCbi",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/11470120674",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-01-12T14:46:31Z",
      "label": {
        "name": "CI failed",
        "color": "cccccc"
      }
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKGRmMzAyNDc3MDU5NDBjNTBjNWVhYWZkNzRlMmFiYmViOGIwY2VjMDc",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/df30247705940c50c5eaafd74e2abbeb8b0cec07",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/df30247705940c50c5eaafd74e2abbeb8b0cec07",
      "tree": {
        "sha": "bad4fcf5347b7c80effe0cccbdfb12bae8c07e6d",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/bad4fcf5347b7c80effe0cccbdfb12bae8c07e6d"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/c3d02be536ac3f35c10efa03653186a17ebbfc12",
          "sha": "c3d02be536ac3f35c10efa03653186a17ebbfc12",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/c3d02be536ac3f35c10efa03653186a17ebbfc12"
        }
      ],
      "message": "[test] import descriptor wallet with reorged parent + IsFromMe child in mempool\n\nTest that wallet rescans process transactions topologically, even if a\nparent's entry into the mempool is later than that of its child.\nThis behavior is important because IsFromMe requires the ability to look\nup a transaction's inputs.\n\nCo-authored-by: furszy <matiasfurszyfer@protonmail.com>",
      "committer": {
        "name": "glozow",
        "email": "gloriajzhao@gmail.com",
        "date": "2024-01-12T14:51:16Z"
      },
      "author": {
        "name": "glozow",
        "email": "gloriajzhao@gmail.com",
        "date": "2024-01-09T10:03:20Z"
      },
      "sha": "df30247705940c50c5eaafd74e2abbeb8b0cec07"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 11470182392,
      "node_id": "HRFPE_lADOABII5857JAo-zwAAAAKrrRf4",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/11470182392",
      "actor": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": "df30247705940c50c5eaafd74e2abbeb8b0cec07",
      "commit_url": "https://api.github.com/repos/glozow/bitcoin/commits/df30247705940c50c5eaafd74e2abbeb8b0cec07",
      "created_at": "2024-01-12T14:52:04Z"
    },
    {
      "event": "commented",
      "id": 1889422328,
      "node_id": "IC_kwDOABII585wnkv4",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1889422328",
      "actor": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-01-12T14:53:09Z",
      "updated_at": "2024-01-12T14:53:09Z",
      "author_association": "MEMBER",
      "body": "> See commit https://github.com/bitcoin/bitcoin/commit/f8273512a50d9ed03bc48803634fb8780b9023c7 (feel free to pull it).\r\n\r\nSorry I hadn't seen this. Thanks, taken with a couple of edits.",
      "user": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29179#issuecomment-1889422328",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29179"
    },
    {
      "event": "unlabeled",
      "id": 11471089775,
      "node_id": "UNLE_lADOABII5857JAo-zwAAAAKruvBv",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/11471089775",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-01-12T16:07:59Z",
      "label": {
        "name": "CI failed",
        "color": "cccccc"
      }
    },
    {
      "event": "reviewed",
      "id": 1818866732,
      "node_id": "PRR_kwDOABII585sabQs",
      "url": null,
      "actor": null,
      "commit_id": "df30247705940c50c5eaafd74e2abbeb8b0cec07",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "body": "Code review ACK df30247705, nits can be disregarded.",
      "user": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29179#pullrequestreview-1818866732",
      "submitted_at": "2024-01-12T19:07:02Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29179"
    },
    {
      "event": "review_requested",
      "id": 11472841697,
      "node_id": "RRE_lADOABII5857JAo-zwAAAAKr1avh",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/11472841697",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-01-12T19:07:06Z",
      "requested_reviewer": {
        "login": "stickies-v",
        "id": 69010457,
        "node_id": "MDQ6VXNlcjY5MDEwNDU3",
        "avatar_url": "https://avatars.githubusercontent.com/u/69010457?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stickies-v",
        "html_url": "https://github.com/stickies-v",
        "followers_url": "https://api.github.com/users/stickies-v/followers",
        "following_url": "https://api.github.com/users/stickies-v/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stickies-v/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stickies-v/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stickies-v/subscriptions",
        "organizations_url": "https://api.github.com/users/stickies-v/orgs",
        "repos_url": "https://api.github.com/users/stickies-v/repos",
        "events_url": "https://api.github.com/users/stickies-v/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stickies-v/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "review_requester": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      }
    },
    {
      "event": "commented",
      "id": 1894209088,
      "node_id": "IC_kwDOABII585w51ZA",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1894209088",
      "actor": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-01-16T17:38:39Z",
      "updated_at": "2024-01-16T17:38:39Z",
      "author_association": "MEMBER",
      "body": "ACK df30247705940c50c5eaafd74e2abbeb8b0cec07",
      "user": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29179#issuecomment-1894209088",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29179"
    },
    {
      "event": "review_request_removed",
      "id": 11501956863,
      "node_id": "RRRE_lADOABII5857JAo-zwAAAAKtke7_",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/11501956863",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-01-16T17:38:43Z",
      "requested_reviewer": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "review_requester": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      }
    },
    {
      "event": "merged",
      "id": 11502058289,
      "node_id": "ME_lADOABII5857JAo-zwAAAAKtk3sx",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/11502058289",
      "actor": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": "27d935f58b9ef5560ddd5914547a6de7884c41e6",
      "commit_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/27d935f58b9ef5560ddd5914547a6de7884c41e6",
      "created_at": "2024-01-16T17:49:28Z"
    },
    {
      "event": "closed",
      "id": 11502058322,
      "node_id": "CE_lADOABII5857JAo-zwAAAAKtk3tS",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/11502058322",
      "actor": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-01-16T17:49:28Z"
    },
    {
      "event": "referenced",
      "id": 11523249489,
      "node_id": "REFE_lADOABII5857JAo-zwAAAAKu1tVR",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/11523249489",
      "actor": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": "d055adad985752c5ae3cf9dd0f509c83850e6c5b",
      "commit_url": "https://api.github.com/repos/glozow/bitcoin/commits/d055adad985752c5ae3cf9dd0f509c83850e6c5b",
      "created_at": "2024-01-18T10:20:32Z"
    },
    {
      "event": "reviewed",
      "id": 1829683082,
      "node_id": "PRR_kwDOABII585tDr-K",
      "url": null,
      "actor": null,
      "commit_id": "df30247705940c50c5eaafd74e2abbeb8b0cec07",
      "commit_url": null,
      "created_at": null,
      "author_association": "CONTRIBUTOR",
      "body": "Post-merge re-ACK df30247705940c50c5eaafd74e2abbeb8b0cec07, I was still investigating the non-deterministic behaviour in `wallet_import_rescan` but I've now found the issue and it doesn't seem problematic enough to revert or immediately fix.\r\n\r\nWhen rebasing these tests on top of e.g. https://github.com/bitcoin/bitcoin/pull/29019 as well as on https://github.com/bitcoin/bitcoin/commit/453b4813ebc74859864803e9972b58e4be76a4d6~1, the [mempool variant tests](https://github.com/bitcoin/bitcoin/pull/29179/files#diff-94e0490035bf63bb005387bd8e89e721762b1424ae9f53248a1e3fbef6f763ddR322-R323) should fail for every variant where `expect_rescan == True` because in each case, _only_ the parent is re-imported in the mempool (after re-org). However, when running the test multiple times one can observe this is not the case, and it sometimes takes 2 or even more rescan variants before the test fails.\r\n\r\n<details>\r\n<summary>log outputs</summary>\r\n\r\nExpected failure logs:\r\n```\r\n...\r\n2024-01-18T13:20:15.028000Z TestFramework (INFO): Test that the mempool is rescanned as well if the rescan parameter is set to true\r\n2024-01-18T13:20:30.271000Z TestFramework (INFO): Run import for mempool variant Variant(call=<Call.single: 1>, data=<Data.address: 1>, address_type=<AddressType.bech32: 'bech32'>, rescan=<Rescan.no: 1>, prune=False)\r\n2024-01-18T13:20:30.317000Z TestFramework (INFO): Run import for mempool variant Variant(call=<Call.single: 1>, data=<Data.address: 1>, address_type=<AddressType.bech32: 'bech32'>, rescan=<Rescan.yes: 2>, prune=False)\r\n2024-01-18T13:20:30.388000Z TestFramework (ERROR): JSONRPC error\r\n...\r\n```\r\n\r\nActual failure logs, sometimes:\r\n```\r\n...\r\n2024-01-18T13:25:50.799000Z TestFramework (INFO): Test that the mempool is rescanned as well if the rescan parameter is set to true\r\n2024-01-18T13:26:06.108000Z TestFramework (INFO): Run import for mempool variant Variant(call=<Call.single: 1>, data=<Data.address: 1>, address_type=<AddressType.bech32: 'bech32'>, rescan=<Rescan.no: 1>, prune=False)\r\n2024-01-18T13:26:06.164000Z TestFramework (INFO): Run import for mempool variant Variant(call=<Call.single: 1>, data=<Data.address: 1>, address_type=<AddressType.bech32: 'bech32'>, rescan=<Rescan.yes: 2>, prune=False)\r\n2024-01-18T13:26:06.235000Z TestFramework (INFO): Run import for mempool variant Variant(call=<Call.single: 1>, data=<Data.address: 1>, address_type=<AddressType.p2sh_segwit: 'p2sh-segwit'>, rescan=<Rescan.no: 1>, prune=False)\r\n2024-01-18T13:26:06.268000Z TestFramework (INFO): Run import for mempool variant Variant(call=<Call.single: 1>, data=<Data.address: 1>, address_type=<AddressType.p2sh_segwit: 'p2sh-segwit'>, rescan=<Rescan.yes: 2>, prune=False)\r\n2024-01-18T13:26:06.341000Z TestFramework (INFO): Run import for mempool variant Variant(call=<Call.single: 1>, data=<Data.address: 1>, address_type=<AddressType.legacy: 'legacy'>, rescan=<Rescan.no: 1>, prune=False)\r\n2024-01-18T13:26:06.374000Z TestFramework (INFO): Run import for mempool variant Variant(call=<Call.single: 1>, data=<Data.address: 1>, address_type=<AddressType.legacy: 'legacy'>, rescan=<Rescan.yes: 2>, prune=False)\r\n2024-01-18T13:26:06.449000Z TestFramework (INFO): Run import for mempool variant Variant(call=<Call.single: 1>, data=<Data.pub: 2>, address_type=<AddressType.bech32: 'bech32'>, rescan=<Rescan.no: 1>, prune=False)\r\n2024-01-18T13:26:06.494000Z TestFramework (INFO): Run import for mempool variant Variant(call=<Call.single: 1>, data=<Data.pub: 2>, address_type=<AddressType.bech32: 'bech32'>, rescan=<Rescan.yes: 2>, prune=False)\r\n2024-01-18T13:26:06.578000Z TestFramework (ERROR): JSONRPC error\r\n...\r\n```\r\n</details>\r\n\r\nThis happens because  a chain of transactions [can be formed](https://github.com/bitcoin/bitcoin/pull/29179/files#diff-94e0490035bf63bb005387bd8e89e721762b1424ae9f53248a1e3fbef6f763ddR274), where `variant_a.child_tx == variant_b.initial_txid`, causing `variant_a`'s child tx to be re-imported into the mempool when `variant b`'s initial tx is re-orged.\r\n\r\nI don't think this needs to be fixed or reverted, because if such a chain is formed, the last variant in the chain is still guaranteed to fail. The descriptor test is unaffected because we create only a single parent/child combo.",
      "user": {
        "login": "stickies-v",
        "id": 69010457,
        "node_id": "MDQ6VXNlcjY5MDEwNDU3",
        "avatar_url": "https://avatars.githubusercontent.com/u/69010457?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stickies-v",
        "html_url": "https://github.com/stickies-v",
        "followers_url": "https://api.github.com/users/stickies-v/followers",
        "following_url": "https://api.github.com/users/stickies-v/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stickies-v/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stickies-v/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stickies-v/subscriptions",
        "organizations_url": "https://api.github.com/users/stickies-v/orgs",
        "repos_url": "https://api.github.com/users/stickies-v/repos",
        "events_url": "https://api.github.com/users/stickies-v/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stickies-v/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29179#pullrequestreview-1829683082",
      "submitted_at": "2024-01-18T13:30:02Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29179"
    },
    {
      "event": "referenced",
      "id": 11526509391,
      "node_id": "REFE_lADOABII5857JAo-zwAAAAKvCJNP",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/11526509391",
      "actor": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": "2e76e87cef1be189d49d52c48291b76ca430b48d",
      "commit_url": "https://api.github.com/repos/glozow/bitcoin/commits/2e76e87cef1be189d49d52c48291b76ca430b48d",
      "created_at": "2024-01-18T15:09:35Z"
    },
    {
      "event": "referenced",
      "id": 11526509418,
      "node_id": "REFE_lADOABII5857JAo-zwAAAAKvCJNq",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/11526509418",
      "actor": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": "62694d727e352f61359bcdeb105cbdf9bf5bab53",
      "commit_url": "https://api.github.com/repos/glozow/bitcoin/commits/62694d727e352f61359bcdeb105cbdf9bf5bab53",
      "created_at": "2024-01-18T15:09:35Z"
    },
    {
      "event": "commented",
      "id": 1900516149,
      "node_id": "IC_kwDOABII585xR5M1",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1900516149",
      "actor": {
        "login": "stickies-v",
        "id": 69010457,
        "node_id": "MDQ6VXNlcjY5MDEwNDU3",
        "avatar_url": "https://avatars.githubusercontent.com/u/69010457?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stickies-v",
        "html_url": "https://github.com/stickies-v",
        "followers_url": "https://api.github.com/users/stickies-v/followers",
        "following_url": "https://api.github.com/users/stickies-v/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stickies-v/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stickies-v/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stickies-v/subscriptions",
        "organizations_url": "https://api.github.com/users/stickies-v/orgs",
        "repos_url": "https://api.github.com/users/stickies-v/repos",
        "events_url": "https://api.github.com/users/stickies-v/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stickies-v/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-01-19T14:26:49Z",
      "updated_at": "2024-01-19T14:26:49Z",
      "author_association": "CONTRIBUTOR",
      "body": "Reviewers might be interested in https://github.com/bitcoin/bitcoin/pull/29283, fixing a rare intermittency issue",
      "user": {
        "login": "stickies-v",
        "id": 69010457,
        "node_id": "MDQ6VXNlcjY5MDEwNDU3",
        "avatar_url": "https://avatars.githubusercontent.com/u/69010457?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stickies-v",
        "html_url": "https://github.com/stickies-v",
        "followers_url": "https://api.github.com/users/stickies-v/followers",
        "following_url": "https://api.github.com/users/stickies-v/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stickies-v/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stickies-v/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stickies-v/subscriptions",
        "organizations_url": "https://api.github.com/users/stickies-v/orgs",
        "repos_url": "https://api.github.com/users/stickies-v/repos",
        "events_url": "https://api.github.com/users/stickies-v/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stickies-v/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29179#issuecomment-1900516149",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29179"
    },
    {
      "event": "referenced",
      "id": 11539480394,
      "node_id": "REFE_lADOABII5857JAo-zwAAAAKvzn9K",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/11539480394",
      "actor": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": "ecb8ebc6608c71676f377398b8dd38fc484dc48e",
      "commit_url": "https://api.github.com/repos/glozow/bitcoin/commits/ecb8ebc6608c71676f377398b8dd38fc484dc48e",
      "created_at": "2024-01-19T16:15:23Z"
    },
    {
      "event": "referenced",
      "id": 11539480421,
      "node_id": "REFE_lADOABII5857JAo-zwAAAAKvzn9l",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/11539480421",
      "actor": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": "ac1b9a51dbb0ac682ac04e0a2a711091d5e962d8",
      "commit_url": "https://api.github.com/repos/glozow/bitcoin/commits/ac1b9a51dbb0ac682ac04e0a2a711091d5e962d8",
      "created_at": "2024-01-19T16:15:23Z"
    },
    {
      "event": "referenced",
      "id": 11829007746,
      "node_id": "REFE_lADOABII5857JAo-zwAAAALBEFWC",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/11829007746",
      "actor": {
        "login": "fanquake",
        "id": 863730,
        "node_id": "MDQ6VXNlcjg2MzczMA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/863730?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fanquake",
        "html_url": "https://github.com/fanquake",
        "followers_url": "https://api.github.com/users/fanquake/followers",
        "following_url": "https://api.github.com/users/fanquake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fanquake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fanquake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fanquake/subscriptions",
        "organizations_url": "https://api.github.com/users/fanquake/orgs",
        "repos_url": "https://api.github.com/users/fanquake/repos",
        "events_url": "https://api.github.com/users/fanquake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fanquake/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": "74df372750ceb4ccdfe310e18f14cdd3abac4a51",
      "commit_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/74df372750ceb4ccdfe310e18f14cdd3abac4a51",
      "created_at": "2024-02-16T13:37:26Z"
    },
    {
      "event": "locked",
      "id": 16220920435,
      "node_id": "LOE_lADOABII5857JAo-zwAAAAPG15pz",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/16220920435",
      "actor": {
        "login": "bitcoin",
        "id": 528860,
        "node_id": "MDEyOk9yZ2FuaXphdGlvbjUyODg2MA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/528860?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/bitcoin",
        "html_url": "https://github.com/bitcoin",
        "followers_url": "https://api.github.com/users/bitcoin/followers",
        "following_url": "https://api.github.com/users/bitcoin/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/bitcoin/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/bitcoin/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/bitcoin/subscriptions",
        "organizations_url": "https://api.github.com/users/bitcoin/orgs",
        "repos_url": "https://api.github.com/users/bitcoin/repos",
        "events_url": "https://api.github.com/users/bitcoin/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/bitcoin/received_events",
        "type": "Organization",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-02-07T07:29:50Z"
    }
  ],
  "comments": [
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1442808773",
      "pull_request_review_id": 1805846181,
      "id": 1442808773,
      "node_id": "PRRC_kwDOABII585V_4PF",
      "diff_hunk": "@@ -267,14 +271,45 @@ def run_test(self):\n                 address_type=variant.address_type.value,\n             ))\n             variant.key = self.nodes[1].dumpprivkey(variant.address[\"address\"])\n-            variant.initial_amount = get_rand_amount()\n+            variant.initial_amount = get_rand_amount() * 2\n             variant.initial_txid = self.nodes[0].sendtoaddress(variant.address[\"address\"], variant.initial_amount)\n             variant.confirmation_height = 0\n             variant.timestamp = timestamp\n \n+        # Mine a block so these parents are confirmed\n+        assert_equal(len(self.nodes[0].getrawmempool()), len(mempool_variants))\n+        self.sync_mempools()\n+        block_to_disconnect = self.generate(self.nodes[0], 1)\n+        assert_equal(len(self.nodes[0].getrawmempool()), 0)\n+\n+        # For each variant, create an unconfirmed child transaction from initial_txid, sending half of the balance to\n+        # itself and the other half to unspendable/fees. This transaction is only recognizable as\n+        # belonging to this wallet when the inputs are known. That means the rescan must process the\n+        # parent before the child.\n+        for variant in mempool_variants:\n+            inputs_to_spend = [txin for txin in self.nodes[1].listunspent() if txin[\"txid\"] == variant.initial_txid]",
      "path": "test/functional/wallet_import_rescan.py",
      "position": null,
      "original_position": 52,
      "commit_id": "df30247705940c50c5eaafd74e2abbeb8b0cec07",
      "original_commit_id": "1a52ca7619eeb1baafa5a32b364381126862b29d",
      "in_reply_to_id": null,
      "user": {
        "login": "stickies-v",
        "id": 69010457,
        "node_id": "MDQ6VXNlcjY5MDEwNDU3",
        "avatar_url": "https://avatars.githubusercontent.com/u/69010457?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stickies-v",
        "html_url": "https://github.com/stickies-v",
        "followers_url": "https://api.github.com/users/stickies-v/followers",
        "following_url": "https://api.github.com/users/stickies-v/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stickies-v/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stickies-v/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stickies-v/subscriptions",
        "organizations_url": "https://api.github.com/users/stickies-v/orgs",
        "repos_url": "https://api.github.com/users/stickies-v/repos",
        "events_url": "https://api.github.com/users/stickies-v/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stickies-v/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "nit: could be a bit more efficient by only calling and iterating over `listunspent` once (does not test for txid collisions, but I don't think we need that?)\r\n\r\n<details>\r\n<summary>git diff on 1a52ca7619</summary>\r\n\r\n```diff\r\ndiff --git a/test/functional/wallet_import_rescan.py b/test/functional/wallet_import_rescan.py\r\nindex 1abc9c0c79..928455c355 100755\r\n--- a/test/functional/wallet_import_rescan.py\r\n+++ b/test/functional/wallet_import_rescan.py\r\n@@ -286,13 +286,12 @@ class ImportRescanTest(BitcoinTestFramework):\r\n         # itself and the other half to unspendable/fees. This transaction is only recognizable as\r\n         # belonging to this wallet when the inputs are known. That means the rescan must process the\r\n         # parent before the child.\r\n+        unspent_txid_map = {txin[\"txid\"] : txin for txin in self.nodes[1].listunspent()}\r\n         for variant in mempool_variants:\r\n-            inputs_to_spend = [txin for txin in self.nodes[1].listunspent() if txin[\"txid\"] == variant.initial_txid]\r\n-            assert_equal(len(inputs_to_spend), 1)\r\n             # Send full amount, subtracting fee from outputs, to ensure no change is created.\r\n             child = self.nodes[1].send(\r\n                 add_to_wallet=False,\r\n-                inputs=inputs_to_spend,\r\n+                inputs=[unspent_txid_map[variant.initial_txid]],\r\n                 outputs=[{ADDRESS_BCRT1_UNSPENDABLE : variant.initial_amount}],\r\n                 subtract_fee_from_outputs=[0]\r\n             )\r\n\r\n```\r\n</details>\r\n",
      "created_at": "2024-01-05T12:18:30Z",
      "updated_at": "2024-01-05T17:25:16Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29179#discussion_r1442808773",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1442808773"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29179"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 290,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1442918332",
      "pull_request_review_id": 1805846181,
      "id": 1442918332,
      "node_id": "PRRC_kwDOABII585WAS-8",
      "diff_hunk": "@@ -267,14 +271,45 @@ def run_test(self):\n                 address_type=variant.address_type.value,\n             ))\n             variant.key = self.nodes[1].dumpprivkey(variant.address[\"address\"])\n-            variant.initial_amount = get_rand_amount()\n+            variant.initial_amount = get_rand_amount() * 2\n             variant.initial_txid = self.nodes[0].sendtoaddress(variant.address[\"address\"], variant.initial_amount)\n             variant.confirmation_height = 0\n             variant.timestamp = timestamp\n \n+        # Mine a block so these parents are confirmed\n+        assert_equal(len(self.nodes[0].getrawmempool()), len(mempool_variants))\n+        self.sync_mempools()\n+        block_to_disconnect = self.generate(self.nodes[0], 1)",
      "path": "test/functional/wallet_import_rescan.py",
      "position": null,
      "original_position": 44,
      "commit_id": "df30247705940c50c5eaafd74e2abbeb8b0cec07",
      "original_commit_id": "1a52ca7619eeb1baafa5a32b364381126862b29d",
      "in_reply_to_id": null,
      "user": {
        "login": "stickies-v",
        "id": 69010457,
        "node_id": "MDQ6VXNlcjY5MDEwNDU3",
        "avatar_url": "https://avatars.githubusercontent.com/u/69010457?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stickies-v",
        "html_url": "https://github.com/stickies-v",
        "followers_url": "https://api.github.com/users/stickies-v/followers",
        "following_url": "https://api.github.com/users/stickies-v/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stickies-v/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stickies-v/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stickies-v/subscriptions",
        "organizations_url": "https://api.github.com/users/stickies-v/orgs",
        "repos_url": "https://api.github.com/users/stickies-v/repos",
        "events_url": "https://api.github.com/users/stickies-v/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stickies-v/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "nit: makes more sense to unpack here imo\r\n```suggestion\r\n        block_to_disconnect = self.generate(self.nodes[0], 1)[0]\r\n```",
      "created_at": "2024-01-05T13:55:03Z",
      "updated_at": "2024-01-05T17:25:16Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29179#discussion_r1442918332",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1442918332"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29179"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 282,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1443052612",
      "pull_request_review_id": 1805846181,
      "id": 1443052612,
      "node_id": "PRRC_kwDOABII585WAzxE",
      "diff_hunk": "@@ -283,9 +318,11 @@ def run_test(self):\n             variant.node = self.nodes[2 + IMPORT_NODES.index(ImportNode(variant.prune, expect_rescan))]\n             variant.do_import(variant.timestamp)\n             if expect_rescan:\n-                variant.expected_balance = variant.initial_amount\n+                # Ensure both transactions were rescanned\n+                assert_equal(variant.node.gettransaction(variant.initial_txid)['confirmations'], 0)\n+                assert_equal(variant.node.gettransaction(variant.child_txid)['confirmations'], 0)",
      "path": "test/functional/wallet_import_rescan.py",
      "position": 99,
      "original_position": 85,
      "commit_id": "df30247705940c50c5eaafd74e2abbeb8b0cec07",
      "original_commit_id": "1a52ca7619eeb1baafa5a32b364381126862b29d",
      "in_reply_to_id": null,
      "user": {
        "login": "stickies-v",
        "id": 69010457,
        "node_id": "MDQ6VXNlcjY5MDEwNDU3",
        "avatar_url": "https://avatars.githubusercontent.com/u/69010457?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stickies-v",
        "html_url": "https://github.com/stickies-v",
        "followers_url": "https://api.github.com/users/stickies-v/followers",
        "following_url": "https://api.github.com/users/stickies-v/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stickies-v/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stickies-v/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stickies-v/subscriptions",
        "organizations_url": "https://api.github.com/users/stickies-v/orgs",
        "repos_url": "https://api.github.com/users/stickies-v/repos",
        "events_url": "https://api.github.com/users/stickies-v/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stickies-v/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "nit: I don't think we're actually checking the confirmations values, so for future maintenance, would this be more straightforward?\r\n```suggestion\r\n                variant.node.gettransaction(variant.initial_txid)  # raises if tx wasn't rescanned\r\n                variant.node.gettransaction(variant.child_txid)    # raises if tx wasn't rescanned\r\n```",
      "created_at": "2024-01-05T16:06:26Z",
      "updated_at": "2024-01-05T17:25:16Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29179#discussion_r1443052612",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1443052612"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29179"
        }
      },
      "start_line": 322,
      "original_start_line": 322,
      "start_side": "RIGHT",
      "line": 323,
      "original_line": 323,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1443144137",
      "pull_request_review_id": 1805846181,
      "id": 1443144137,
      "node_id": "PRRC_kwDOABII585WBKHJ",
      "diff_hunk": "@@ -79,7 +82,7 @@ def do_import(self, timestamp):\n             )\n             assert_equal(response, [{\"success\": True}])\n \n-    def check(self, txid=None, amount=None, confirmation_height=None):\n+    def check(self, txid=None, amount=None, confirmation_height=None, amount_is_balance=True):",
      "path": "test/functional/wallet_import_rescan.py",
      "position": null,
      "original_position": 17,
      "commit_id": "df30247705940c50c5eaafd74e2abbeb8b0cec07",
      "original_commit_id": "1a52ca7619eeb1baafa5a32b364381126862b29d",
      "in_reply_to_id": null,
      "user": {
        "login": "stickies-v",
        "id": 69010457,
        "node_id": "MDQ6VXNlcjY5MDEwNDU3",
        "avatar_url": "https://avatars.githubusercontent.com/u/69010457?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stickies-v",
        "html_url": "https://github.com/stickies-v",
        "followers_url": "https://api.github.com/users/stickies-v/followers",
        "following_url": "https://api.github.com/users/stickies-v/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stickies-v/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stickies-v/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stickies-v/subscriptions",
        "organizations_url": "https://api.github.com/users/stickies-v/orgs",
        "repos_url": "https://api.github.com/users/stickies-v/repos",
        "events_url": "https://api.github.com/users/stickies-v/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stickies-v/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "It doesn't seem like we're actually testing the expected balance at any point, rather the amount received, but I may be missing nuance. Would this diff make sense? I don't like adding an extra parameter to an already long function for something so specific, if we can avoid it.\r\n\r\n<details>\r\n<summary>git diff on 1a52ca7619</summary>\r\n\r\n```diff\r\ndiff --git a/test/functional/wallet_import_rescan.py b/test/functional/wallet_import_rescan.py\r\nindex 1abc9c0c79..fa9f43f66c 100755\r\n--- a/test/functional/wallet_import_rescan.py\r\n+++ b/test/functional/wallet_import_rescan.py\r\n@@ -82,7 +82,7 @@ class Variant(collections.namedtuple(\"Variant\", \"call data address_type rescan p\r\n             )\r\n             assert_equal(response, [{\"success\": True}])\r\n \r\n-    def check(self, txid=None, amount=None, confirmation_height=None, amount_is_balance=True):\r\n+    def check(self, txid=None, amount=None, confirmation_height=None):\r\n         \"\"\"Verify that listtransactions/listreceivedbyaddress return expected values.\"\"\"\r\n \r\n         txs = self.node.listtransactions(label=self.label, count=10000, include_watchonly=True)\r\n@@ -112,8 +112,7 @@ class Variant(collections.namedtuple(\"Variant\", \"call data address_type rescan p\r\n \r\n             address, = [ad for ad in addresses if txid in ad[\"txids\"]]\r\n             assert_equal(address[\"address\"], self.address[\"address\"])\r\n-            if amount_is_balance:\r\n-                assert_equal(address[\"amount\"], self.expected_balance)\r\n+            assert_equal(address[\"amount\"], self.amount_received)\r\n             assert_equal(address[\"confirmations\"], confirmations)\r\n             # Verify the transaction is correctly marked watchonly depending on\r\n             # whether the transaction pays to an imported public key or\r\n@@ -227,11 +226,11 @@ class ImportRescanTest(BitcoinTestFramework):\r\n             variant.node = self.nodes[2 + IMPORT_NODES.index(ImportNode(variant.prune, expect_rescan))]\r\n             variant.do_import(variant.timestamp)\r\n             if expect_rescan:\r\n-                variant.expected_balance = variant.initial_amount\r\n+                variant.amount_received = variant.initial_amount\r\n                 variant.expected_txs = 1\r\n                 variant.check(variant.initial_txid, variant.initial_amount, variant.confirmation_height)\r\n             else:\r\n-                variant.expected_balance = 0\r\n+                variant.amount_received = 0\r\n                 variant.expected_txs = 0\r\n                 variant.check()\r\n \r\n@@ -251,7 +250,7 @@ class ImportRescanTest(BitcoinTestFramework):\r\n         # Check the latest results from getbalance and listtransactions.\r\n         for variant in IMPORT_VARIANTS:\r\n             self.log.info('Run check for variant {}'.format(variant))\r\n-            variant.expected_balance += variant.sent_amount\r\n+            variant.amount_received += variant.sent_amount\r\n             variant.expected_txs += 1\r\n             variant.check(variant.sent_txid, variant.sent_amount, variant.confirmation_height)\r\n \r\n@@ -297,7 +296,6 @@ class ImportRescanTest(BitcoinTestFramework):\r\n                 subtract_fee_from_outputs=[0]\r\n             )\r\n             variant.child_txid = child[\"txid\"]\r\n-            variant.expected_balance = 0\r\n             self.nodes[0].sendrawtransaction(child[\"hex\"])\r\n \r\n         # Mempools should contain the child transactions for each variant.\r\n@@ -321,10 +319,11 @@ class ImportRescanTest(BitcoinTestFramework):\r\n                 # Ensure both transactions were rescanned\r\n                 assert_equal(variant.node.gettransaction(variant.initial_txid)['confirmations'], 0)\r\n                 assert_equal(variant.node.gettransaction(variant.child_txid)['confirmations'], 0)\r\n+                variant.amount_received = variant.initial_amount\r\n                 variant.expected_txs = 1\r\n-                variant.check(variant.initial_txid, variant.initial_amount, 0, False)\r\n+                variant.check(variant.initial_txid, variant.initial_amount, 0)\r\n             else:\r\n-                variant.expected_balance = 0\r\n+                variant.amount_received = 0\r\n                 variant.expected_txs = 0\r\n                 variant.check()\r\n \r\n\r\n```\r\n</details>\r\n",
      "created_at": "2024-01-05T17:19:11Z",
      "updated_at": "2024-01-05T17:25:16Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29179#discussion_r1443144137",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1443144137"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29179"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 85,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1443208149",
      "pull_request_review_id": 1806568472,
      "id": 1443208149,
      "node_id": "PRRC_kwDOABII585WBZvV",
      "diff_hunk": "@@ -79,7 +82,7 @@ def do_import(self, timestamp):\n             )\n             assert_equal(response, [{\"success\": True}])\n \n-    def check(self, txid=None, amount=None, confirmation_height=None):\n+    def check(self, txid=None, amount=None, confirmation_height=None, amount_is_balance=True):",
      "path": "test/functional/wallet_import_rescan.py",
      "position": null,
      "original_position": 17,
      "commit_id": "df30247705940c50c5eaafd74e2abbeb8b0cec07",
      "original_commit_id": "1a52ca7619eeb1baafa5a32b364381126862b29d",
      "in_reply_to_id": 1443144137,
      "user": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "Thanks, taken.",
      "created_at": "2024-01-05T18:11:55Z",
      "updated_at": "2024-01-05T18:14:12Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29179#discussion_r1443208149",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1443208149"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29179"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 85,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1443208232",
      "pull_request_review_id": 1806568472,
      "id": 1443208232,
      "node_id": "PRRC_kwDOABII585WBZwo",
      "diff_hunk": "@@ -267,14 +271,45 @@ def run_test(self):\n                 address_type=variant.address_type.value,\n             ))\n             variant.key = self.nodes[1].dumpprivkey(variant.address[\"address\"])\n-            variant.initial_amount = get_rand_amount()\n+            variant.initial_amount = get_rand_amount() * 2\n             variant.initial_txid = self.nodes[0].sendtoaddress(variant.address[\"address\"], variant.initial_amount)\n             variant.confirmation_height = 0\n             variant.timestamp = timestamp\n \n+        # Mine a block so these parents are confirmed\n+        assert_equal(len(self.nodes[0].getrawmempool()), len(mempool_variants))\n+        self.sync_mempools()\n+        block_to_disconnect = self.generate(self.nodes[0], 1)",
      "path": "test/functional/wallet_import_rescan.py",
      "position": null,
      "original_position": 44,
      "commit_id": "df30247705940c50c5eaafd74e2abbeb8b0cec07",
      "original_commit_id": "1a52ca7619eeb1baafa5a32b364381126862b29d",
      "in_reply_to_id": 1442918332,
      "user": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "I agree, taken",
      "created_at": "2024-01-05T18:12:00Z",
      "updated_at": "2024-01-05T18:14:12Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29179#discussion_r1443208232",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1443208232"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29179"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 282,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1443208305",
      "pull_request_review_id": 1806568472,
      "id": 1443208305,
      "node_id": "PRRC_kwDOABII585WBZxx",
      "diff_hunk": "@@ -267,14 +271,45 @@ def run_test(self):\n                 address_type=variant.address_type.value,\n             ))\n             variant.key = self.nodes[1].dumpprivkey(variant.address[\"address\"])\n-            variant.initial_amount = get_rand_amount()\n+            variant.initial_amount = get_rand_amount() * 2\n             variant.initial_txid = self.nodes[0].sendtoaddress(variant.address[\"address\"], variant.initial_amount)\n             variant.confirmation_height = 0\n             variant.timestamp = timestamp\n \n+        # Mine a block so these parents are confirmed\n+        assert_equal(len(self.nodes[0].getrawmempool()), len(mempool_variants))\n+        self.sync_mempools()\n+        block_to_disconnect = self.generate(self.nodes[0], 1)\n+        assert_equal(len(self.nodes[0].getrawmempool()), 0)\n+\n+        # For each variant, create an unconfirmed child transaction from initial_txid, sending half of the balance to\n+        # itself and the other half to unspendable/fees. This transaction is only recognizable as\n+        # belonging to this wallet when the inputs are known. That means the rescan must process the\n+        # parent before the child.\n+        for variant in mempool_variants:\n+            inputs_to_spend = [txin for txin in self.nodes[1].listunspent() if txin[\"txid\"] == variant.initial_txid]",
      "path": "test/functional/wallet_import_rescan.py",
      "position": null,
      "original_position": 52,
      "commit_id": "df30247705940c50c5eaafd74e2abbeb8b0cec07",
      "original_commit_id": "1a52ca7619eeb1baafa5a32b364381126862b29d",
      "in_reply_to_id": 1442808773,
      "user": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "taken",
      "created_at": "2024-01-05T18:12:05Z",
      "updated_at": "2024-01-05T18:14:11Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29179#discussion_r1443208305",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1443208305"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29179"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 290,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1443209504",
      "pull_request_review_id": 1806568472,
      "id": 1443209504,
      "node_id": "PRRC_kwDOABII585WBaEg",
      "diff_hunk": "@@ -283,9 +318,11 @@ def run_test(self):\n             variant.node = self.nodes[2 + IMPORT_NODES.index(ImportNode(variant.prune, expect_rescan))]\n             variant.do_import(variant.timestamp)\n             if expect_rescan:\n-                variant.expected_balance = variant.initial_amount\n+                # Ensure both transactions were rescanned\n+                assert_equal(variant.node.gettransaction(variant.initial_txid)['confirmations'], 0)\n+                assert_equal(variant.node.gettransaction(variant.child_txid)['confirmations'], 0)",
      "path": "test/functional/wallet_import_rescan.py",
      "position": 99,
      "original_position": 85,
      "commit_id": "df30247705940c50c5eaafd74e2abbeb8b0cec07",
      "original_commit_id": "1a52ca7619eeb1baafa5a32b364381126862b29d",
      "in_reply_to_id": 1443052612,
      "user": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "Added a similar comment.",
      "created_at": "2024-01-05T18:13:40Z",
      "updated_at": "2024-01-05T18:14:12Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29179#discussion_r1443209504",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1443209504"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29179"
        }
      },
      "start_line": 322,
      "original_start_line": 322,
      "start_side": "RIGHT",
      "line": 323,
      "original_line": 323,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1445998556",
      "pull_request_review_id": 1811002749,
      "id": 1445998556,
      "node_id": "PRRC_kwDOABII585WMC_c",
      "diff_hunk": "@@ -0,0 +1,97 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2024 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"Test that descriptor wallets rescan mempool transactions properly when importing.\"\"\"\n+\n+from test_framework.address import (\n+    address_to_scriptpubkey,\n+    ADDRESS_BCRT1_UNSPENDABLE,\n+)\n+from test_framework.test_framework import BitcoinTestFramework\n+from test_framework.util import assert_equal\n+from test_framework.wallet import MiniWallet\n+from test_framework.wallet_util import test_address\n+\n+\n+class WalletRescanUnconfirmed(BitcoinTestFramework):\n+    def add_options(self, parser):\n+        self.add_wallet_options(parser, legacy=False)\n+\n+    def set_test_params(self):\n+        self.num_nodes = 3\n+        # Immediate tx relay\n+        self.extra_args = [['-whitelist=noban@127.0.0.1']] * self.num_nodes\n+\n+    def skip_test_if_missing_module(self):\n+        self.skip_if_no_wallet()\n+        self.skip_if_no_sqlite()\n+\n+    def run_test(self):\n+        # Node with which we will use to send funds to the wallet and mine blocks",
      "path": "test/functional/wallet_rescan_unconfirmed.py",
      "position": null,
      "original_position": 31,
      "commit_id": "df30247705940c50c5eaafd74e2abbeb8b0cec07",
      "original_commit_id": "fa2b8d0e30c45b4ff59db1ac6aaeab3dc10f3df3",
      "in_reply_to_id": null,
      "user": {
        "login": "stickies-v",
        "id": 69010457,
        "node_id": "MDQ6VXNlcjY5MDEwNDU3",
        "avatar_url": "https://avatars.githubusercontent.com/u/69010457?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stickies-v",
        "html_url": "https://github.com/stickies-v",
        "followers_url": "https://api.github.com/users/stickies-v/followers",
        "following_url": "https://api.github.com/users/stickies-v/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stickies-v/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stickies-v/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stickies-v/subscriptions",
        "organizations_url": "https://api.github.com/users/stickies-v/orgs",
        "repos_url": "https://api.github.com/users/stickies-v/repos",
        "events_url": "https://api.github.com/users/stickies-v/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stickies-v/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "grammar nit\r\n```suggestion\r\n        # Node which we will use to send funds to the wallet and mine blocks\r\n```",
      "created_at": "2024-01-09T11:56:38Z",
      "updated_at": "2024-01-09T12:09:00Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29179#discussion_r1445998556",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1445998556"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29179"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 31,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1446005072",
      "pull_request_review_id": 1811002749,
      "id": 1446005072,
      "node_id": "PRRC_kwDOABII585WMElQ",
      "diff_hunk": "@@ -0,0 +1,97 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2024 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"Test that descriptor wallets rescan mempool transactions properly when importing.\"\"\"\n+\n+from test_framework.address import (\n+    address_to_scriptpubkey,\n+    ADDRESS_BCRT1_UNSPENDABLE,\n+)\n+from test_framework.test_framework import BitcoinTestFramework\n+from test_framework.util import assert_equal\n+from test_framework.wallet import MiniWallet\n+from test_framework.wallet_util import test_address\n+\n+\n+class WalletRescanUnconfirmed(BitcoinTestFramework):\n+    def add_options(self, parser):\n+        self.add_wallet_options(parser, legacy=False)\n+\n+    def set_test_params(self):\n+        self.num_nodes = 3\n+        # Immediate tx relay\n+        self.extra_args = [['-whitelist=noban@127.0.0.1']] * self.num_nodes\n+\n+    def skip_test_if_missing_module(self):\n+        self.skip_if_no_wallet()\n+        self.skip_if_no_sqlite()\n+\n+    def run_test(self):\n+        # Node with which we will use to send funds to the wallet and mine blocks\n+        tester_node = self.nodes[0]\n+        # Node on which the wallet is originally created\n+        orig_wallet_node = self.nodes[1]\n+        # Node which will import the wallet and rescan blocks / mempool for transactions\n+        import_wallet_node = self.nodes[2]\n+\n+\n+        self.log.info(\"Create wallets and mine initial chain\")\n+        tester_wallet = MiniWallet(tester_node)\n+        self.generate(tester_wallet, 110)",
      "path": "test/functional/wallet_rescan_unconfirmed.py",
      "position": null,
      "original_position": 41,
      "commit_id": "df30247705940c50c5eaafd74e2abbeb8b0cec07",
      "original_commit_id": "fa2b8d0e30c45b4ff59db1ac6aaeab3dc10f3df3",
      "in_reply_to_id": null,
      "user": {
        "login": "stickies-v",
        "id": 69010457,
        "node_id": "MDQ6VXNlcjY5MDEwNDU3",
        "avatar_url": "https://avatars.githubusercontent.com/u/69010457?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stickies-v",
        "html_url": "https://github.com/stickies-v",
        "followers_url": "https://api.github.com/users/stickies-v/followers",
        "following_url": "https://api.github.com/users/stickies-v/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stickies-v/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stickies-v/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stickies-v/subscriptions",
        "organizations_url": "https://api.github.com/users/stickies-v/orgs",
        "repos_url": "https://api.github.com/users/stickies-v/repos",
        "events_url": "https://api.github.com/users/stickies-v/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stickies-v/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "Is there a reason it's 110 and not `COINBASE_MATURITY`?",
      "created_at": "2024-01-09T12:00:26Z",
      "updated_at": "2024-01-09T12:09:00Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29179#discussion_r1446005072",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1446005072"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29179"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 41,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1446011145",
      "pull_request_review_id": 1811002749,
      "id": 1446011145,
      "node_id": "PRRC_kwDOABII585WMGEJ",
      "diff_hunk": "@@ -0,0 +1,97 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2024 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"Test that descriptor wallets rescan mempool transactions properly when importing.\"\"\"\n+\n+from test_framework.address import (\n+    address_to_scriptpubkey,\n+    ADDRESS_BCRT1_UNSPENDABLE,\n+)\n+from test_framework.test_framework import BitcoinTestFramework\n+from test_framework.util import assert_equal\n+from test_framework.wallet import MiniWallet\n+from test_framework.wallet_util import test_address\n+\n+\n+class WalletRescanUnconfirmed(BitcoinTestFramework):\n+    def add_options(self, parser):\n+        self.add_wallet_options(parser, legacy=False)\n+\n+    def set_test_params(self):\n+        self.num_nodes = 3\n+        # Immediate tx relay\n+        self.extra_args = [['-whitelist=noban@127.0.0.1']] * self.num_nodes\n+\n+    def skip_test_if_missing_module(self):\n+        self.skip_if_no_wallet()\n+        self.skip_if_no_sqlite()\n+\n+    def run_test(self):\n+        # Node with which we will use to send funds to the wallet and mine blocks\n+        tester_node = self.nodes[0]\n+        # Node on which the wallet is originally created\n+        orig_wallet_node = self.nodes[1]\n+        # Node which will import the wallet and rescan blocks / mempool for transactions\n+        import_wallet_node = self.nodes[2]\n+\n+\n+        self.log.info(\"Create wallets and mine initial chain\")\n+        tester_wallet = MiniWallet(tester_node)\n+        self.generate(tester_wallet, 110)\n+\n+        orig_wallet_node.createwallet(wallet_name='w0', disable_private_keys=False, descriptors=True)\n+        w0 = orig_wallet_node.get_wallet_rpc('w0')\n+\n+        self.log.info(\"Create a parent tx and mine it in a block that will later be disconnected\")\n+        parent_amount = 100000\n+        parent_address = w0.getnewaddress()\n+        tx_parent_to_reorg = tester_wallet.send_to(\n+            from_node=tester_node,\n+            scriptPubKey=address_to_scriptpubkey(parent_address),\n+            amount=parent_amount,\n+        )\n+        assert tx_parent_to_reorg[\"txid\"] in tester_node.getrawmempool()\n+        block_to_reorg = self.generate(tester_node, 1)[0]\n+        assert_equal(len(tester_node.getrawmempool()), 0)\n+\n+        # Create an unconfirmed child transaction from the parent tx, sending all\n+        # the funds to an unspendable address. Importantly, no change output is created so the\n+        # transaction can't be recognized using its outputs. The wallet rescan needs to know the\n+        # inputs of the transaction to detect it, so the parent must be processed before the child.\n+        w0_utxos = w0.listunspent()\n+\n+        self.log.info(\"Create a child tx and wait for it to propagate to all mempools\")\n+        # The only UTXO available to spend is tx_parent_to_reorg.\n+        assert_equal(len(w0_utxos), 1)\n+        assert_equal(w0_utxos[0][\"txid\"], tx_parent_to_reorg[\"txid\"])\n+        tx_child_unconfirmed_sweep = w0.sendall([ADDRESS_BCRT1_UNSPENDABLE])\n+        self.sync_all()\n+        assert tx_child_unconfirmed_sweep[\"txid\"] in tester_node.getrawmempool()\n+        assert tx_child_unconfirmed_sweep[\"txid\"] in import_wallet_node.getrawmempool()\n+\n+        self.log.info(\"Mock a reorg, causing parent to re-enter mempools after its child\")\n+        for node in self.nodes:\n+            node.invalidateblock(block_to_reorg)\n+            assert tx_parent_to_reorg[\"txid\"] in node.getrawmempool()\n+\n+        self.log.info(\"Import descriptor wallet on another node\")\n+        descriptors_to_import = []\n+        for item in w0.listdescriptors()[\"descriptors\"]:\n+            # descriptors_to_import.append(item)\n+            # use timestamp 0 to tell wallet to rescan entire chain\n+            if not item[\"internal\"]:\n+                descriptors_to_import.append({\"desc\": item[\"desc\"], \"timestamp\": 0, \"label\": \"w0 import\"})\n+        import_wallet_node.createwallet(wallet_name=\"w1\", disable_private_keys=True, blank=True, descriptors=True)\n+        w1 = import_wallet_node.get_wallet_rpc(\"w1\")\n+        w1.importdescriptors(descriptors_to_import)\n+\n+        self.log.info(\"Check that the importing node has properly rescanned mempool transactions\")\n+        # Check that parent address is correctly determined as ismine\n+        test_address(w1, parent_address, solvable=True, ismine=True)\n+        # This would raise a JSONRPCError if the transactions were not identified as belonging to the wallet.\n+        assert_equal(w1.gettransaction(tx_parent_to_reorg[\"txid\"])[\"confirmations\"], 0)\n+        assert_equal(w1.gettransaction(tx_child_unconfirmed_sweep[\"txid\"])[\"confirmations\"], 0)",
      "path": "test/functional/wallet_rescan_unconfirmed.py",
      "position": 80,
      "original_position": 94,
      "commit_id": "df30247705940c50c5eaafd74e2abbeb8b0cec07",
      "original_commit_id": "fa2b8d0e30c45b4ff59db1ac6aaeab3dc10f3df3",
      "in_reply_to_id": null,
      "user": {
        "login": "stickies-v",
        "id": 69010457,
        "node_id": "MDQ6VXNlcjY5MDEwNDU3",
        "avatar_url": "https://avatars.githubusercontent.com/u/69010457?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stickies-v",
        "html_url": "https://github.com/stickies-v",
        "followers_url": "https://api.github.com/users/stickies-v/followers",
        "following_url": "https://api.github.com/users/stickies-v/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stickies-v/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stickies-v/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stickies-v/subscriptions",
        "organizations_url": "https://api.github.com/users/stickies-v/orgs",
        "repos_url": "https://api.github.com/users/stickies-v/repos",
        "events_url": "https://api.github.com/users/stickies-v/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stickies-v/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "nit: I still think it's unnecessarily confusing for (current and future) reviewers to figure out why confirmations needs to equal 0 when afaiu this is completely unrelated to the test. I would either remove the value comparison or specifically state in the docs that we don't care about the `confirmations` value, just that the response is a JSON object with a field we recognize?",
      "created_at": "2024-01-09T12:06:37Z",
      "updated_at": "2024-01-09T12:09:00Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29179#discussion_r1446011145",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1446011145"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29179"
        }
      },
      "start_line": 79,
      "original_start_line": 93,
      "start_side": "RIGHT",
      "line": 80,
      "original_line": 80,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1446161874",
      "pull_request_review_id": 1811273879,
      "id": 1446161874,
      "node_id": "PRRC_kwDOABII585WMq3S",
      "diff_hunk": "@@ -0,0 +1,97 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2024 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"Test that descriptor wallets rescan mempool transactions properly when importing.\"\"\"\n+\n+from test_framework.address import (\n+    address_to_scriptpubkey,\n+    ADDRESS_BCRT1_UNSPENDABLE,\n+)\n+from test_framework.test_framework import BitcoinTestFramework\n+from test_framework.util import assert_equal\n+from test_framework.wallet import MiniWallet\n+from test_framework.wallet_util import test_address\n+\n+\n+class WalletRescanUnconfirmed(BitcoinTestFramework):\n+    def add_options(self, parser):\n+        self.add_wallet_options(parser, legacy=False)\n+\n+    def set_test_params(self):\n+        self.num_nodes = 3\n+        # Immediate tx relay\n+        self.extra_args = [['-whitelist=noban@127.0.0.1']] * self.num_nodes\n+\n+    def skip_test_if_missing_module(self):\n+        self.skip_if_no_wallet()\n+        self.skip_if_no_sqlite()\n+\n+    def run_test(self):\n+        # Node with which we will use to send funds to the wallet and mine blocks\n+        tester_node = self.nodes[0]\n+        # Node on which the wallet is originally created\n+        orig_wallet_node = self.nodes[1]\n+        # Node which will import the wallet and rescan blocks / mempool for transactions\n+        import_wallet_node = self.nodes[2]\n+\n+\n+        self.log.info(\"Create wallets and mine initial chain\")\n+        tester_wallet = MiniWallet(tester_node)\n+        self.generate(tester_wallet, 110)\n+\n+        orig_wallet_node.createwallet(wallet_name='w0', disable_private_keys=False, descriptors=True)\n+        w0 = orig_wallet_node.get_wallet_rpc('w0')\n+\n+        self.log.info(\"Create a parent tx and mine it in a block that will later be disconnected\")\n+        parent_amount = 100000\n+        parent_address = w0.getnewaddress()\n+        tx_parent_to_reorg = tester_wallet.send_to(\n+            from_node=tester_node,\n+            scriptPubKey=address_to_scriptpubkey(parent_address),\n+            amount=parent_amount,\n+        )\n+        assert tx_parent_to_reorg[\"txid\"] in tester_node.getrawmempool()\n+        block_to_reorg = self.generate(tester_node, 1)[0]\n+        assert_equal(len(tester_node.getrawmempool()), 0)\n+\n+        # Create an unconfirmed child transaction from the parent tx, sending all\n+        # the funds to an unspendable address. Importantly, no change output is created so the\n+        # transaction can't be recognized using its outputs. The wallet rescan needs to know the\n+        # inputs of the transaction to detect it, so the parent must be processed before the child.\n+        w0_utxos = w0.listunspent()\n+\n+        self.log.info(\"Create a child tx and wait for it to propagate to all mempools\")\n+        # The only UTXO available to spend is tx_parent_to_reorg.\n+        assert_equal(len(w0_utxos), 1)\n+        assert_equal(w0_utxos[0][\"txid\"], tx_parent_to_reorg[\"txid\"])\n+        tx_child_unconfirmed_sweep = w0.sendall([ADDRESS_BCRT1_UNSPENDABLE])\n+        self.sync_all()\n+        assert tx_child_unconfirmed_sweep[\"txid\"] in tester_node.getrawmempool()\n+        assert tx_child_unconfirmed_sweep[\"txid\"] in import_wallet_node.getrawmempool()\n+\n+        self.log.info(\"Mock a reorg, causing parent to re-enter mempools after its child\")\n+        for node in self.nodes:\n+            node.invalidateblock(block_to_reorg)\n+            assert tx_parent_to_reorg[\"txid\"] in node.getrawmempool()\n+\n+        self.log.info(\"Import descriptor wallet on another node\")\n+        descriptors_to_import = []\n+        for item in w0.listdescriptors()[\"descriptors\"]:\n+            # descriptors_to_import.append(item)\n+            # use timestamp 0 to tell wallet to rescan entire chain\n+            if not item[\"internal\"]:\n+                descriptors_to_import.append({\"desc\": item[\"desc\"], \"timestamp\": 0, \"label\": \"w0 import\"})\n+        import_wallet_node.createwallet(wallet_name=\"w1\", disable_private_keys=True, blank=True, descriptors=True)\n+        w1 = import_wallet_node.get_wallet_rpc(\"w1\")\n+        w1.importdescriptors(descriptors_to_import)\n+\n+        self.log.info(\"Check that the importing node has properly rescanned mempool transactions\")\n+        # Check that parent address is correctly determined as ismine\n+        test_address(w1, parent_address, solvable=True, ismine=True)\n+        # This would raise a JSONRPCError if the transactions were not identified as belonging to the wallet.\n+        assert_equal(w1.gettransaction(tx_parent_to_reorg[\"txid\"])[\"confirmations\"], 0)\n+        assert_equal(w1.gettransaction(tx_child_unconfirmed_sweep[\"txid\"])[\"confirmations\"], 0)",
      "path": "test/functional/wallet_rescan_unconfirmed.py",
      "position": 80,
      "original_position": 94,
      "commit_id": "df30247705940c50c5eaafd74e2abbeb8b0cec07",
      "original_commit_id": "fa2b8d0e30c45b4ff59db1ac6aaeab3dc10f3df3",
      "in_reply_to_id": 1446011145,
      "user": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "We are testing that they are marked as in-mempool wallet transactions. If the reorg didn't happen, the value would be 1.",
      "created_at": "2024-01-09T14:30:20Z",
      "updated_at": "2024-01-09T15:54:57Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29179#discussion_r1446161874",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1446161874"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29179"
        }
      },
      "start_line": 79,
      "original_start_line": 93,
      "start_side": "RIGHT",
      "line": 80,
      "original_line": 80,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1446269441",
      "pull_request_review_id": 1811449910,
      "id": 1446269441,
      "node_id": "PRRC_kwDOABII585WNFIB",
      "diff_hunk": "@@ -0,0 +1,97 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2024 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"Test that descriptor wallets rescan mempool transactions properly when importing.\"\"\"\n+\n+from test_framework.address import (\n+    address_to_scriptpubkey,\n+    ADDRESS_BCRT1_UNSPENDABLE,\n+)\n+from test_framework.test_framework import BitcoinTestFramework\n+from test_framework.util import assert_equal\n+from test_framework.wallet import MiniWallet\n+from test_framework.wallet_util import test_address\n+\n+\n+class WalletRescanUnconfirmed(BitcoinTestFramework):\n+    def add_options(self, parser):\n+        self.add_wallet_options(parser, legacy=False)\n+\n+    def set_test_params(self):\n+        self.num_nodes = 3\n+        # Immediate tx relay\n+        self.extra_args = [['-whitelist=noban@127.0.0.1']] * self.num_nodes\n+\n+    def skip_test_if_missing_module(self):\n+        self.skip_if_no_wallet()\n+        self.skip_if_no_sqlite()\n+\n+    def run_test(self):\n+        # Node with which we will use to send funds to the wallet and mine blocks\n+        tester_node = self.nodes[0]\n+        # Node on which the wallet is originally created\n+        orig_wallet_node = self.nodes[1]\n+        # Node which will import the wallet and rescan blocks / mempool for transactions\n+        import_wallet_node = self.nodes[2]\n+\n+\n+        self.log.info(\"Create wallets and mine initial chain\")\n+        tester_wallet = MiniWallet(tester_node)\n+        self.generate(tester_wallet, 110)",
      "path": "test/functional/wallet_rescan_unconfirmed.py",
      "position": null,
      "original_position": 41,
      "commit_id": "df30247705940c50c5eaafd74e2abbeb8b0cec07",
      "original_commit_id": "fa2b8d0e30c45b4ff59db1ac6aaeab3dc10f3df3",
      "in_reply_to_id": 1446005072,
      "user": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "changed",
      "created_at": "2024-01-09T15:48:42Z",
      "updated_at": "2024-01-09T15:48:42Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29179#discussion_r1446269441",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1446269441"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29179"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 41,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1446269555",
      "pull_request_review_id": 1811450059,
      "id": 1446269555,
      "node_id": "PRRC_kwDOABII585WNFJz",
      "diff_hunk": "@@ -0,0 +1,97 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2024 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"Test that descriptor wallets rescan mempool transactions properly when importing.\"\"\"\n+\n+from test_framework.address import (\n+    address_to_scriptpubkey,\n+    ADDRESS_BCRT1_UNSPENDABLE,\n+)\n+from test_framework.test_framework import BitcoinTestFramework\n+from test_framework.util import assert_equal\n+from test_framework.wallet import MiniWallet\n+from test_framework.wallet_util import test_address\n+\n+\n+class WalletRescanUnconfirmed(BitcoinTestFramework):\n+    def add_options(self, parser):\n+        self.add_wallet_options(parser, legacy=False)\n+\n+    def set_test_params(self):\n+        self.num_nodes = 3\n+        # Immediate tx relay\n+        self.extra_args = [['-whitelist=noban@127.0.0.1']] * self.num_nodes\n+\n+    def skip_test_if_missing_module(self):\n+        self.skip_if_no_wallet()\n+        self.skip_if_no_sqlite()\n+\n+    def run_test(self):\n+        # Node with which we will use to send funds to the wallet and mine blocks",
      "path": "test/functional/wallet_rescan_unconfirmed.py",
      "position": null,
      "original_position": 31,
      "commit_id": "df30247705940c50c5eaafd74e2abbeb8b0cec07",
      "original_commit_id": "fa2b8d0e30c45b4ff59db1ac6aaeab3dc10f3df3",
      "in_reply_to_id": 1445998556,
      "user": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "taken",
      "created_at": "2024-01-09T15:48:45Z",
      "updated_at": "2024-01-09T15:48:46Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29179#discussion_r1446269555",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1446269555"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29179"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 31,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1449427996",
      "pull_request_review_id": 1816762773,
      "id": 1449427996,
      "node_id": "PRRC_kwDOABII585WZIQc",
      "diff_hunk": "@@ -0,0 +1,98 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2024 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"Test that descriptor wallets rescan mempool transactions properly when importing.\"\"\"\n+\n+from test_framework.address import (\n+    address_to_scriptpubkey,\n+    ADDRESS_BCRT1_UNSPENDABLE,\n+)\n+from test_framework.blocktools import COINBASE_MATURITY\n+from test_framework.test_framework import BitcoinTestFramework\n+from test_framework.util import assert_equal\n+from test_framework.wallet import MiniWallet\n+from test_framework.wallet_util import test_address\n+\n+\n+class WalletRescanUnconfirmed(BitcoinTestFramework):\n+    def add_options(self, parser):\n+        self.add_wallet_options(parser, legacy=False)\n+\n+    def set_test_params(self):\n+        self.num_nodes = 3\n+        # Immediate tx relay\n+        self.extra_args = [['-whitelist=noban@127.0.0.1']] * self.num_nodes\n+\n+    def skip_test_if_missing_module(self):\n+        self.skip_if_no_wallet()\n+        self.skip_if_no_sqlite()\n+\n+    def run_test(self):\n+        # Node which we will use to send funds to the wallet and mine blocks\n+        tester_node = self.nodes[0]\n+        # Node on which the wallet is originally created\n+        orig_wallet_node = self.nodes[1]\n+        # Node which will import the wallet and rescan blocks / mempool for transactions\n+        import_wallet_node = self.nodes[2]\n+\n+\n+        self.log.info(\"Create wallets and mine initial chain\")\n+        tester_wallet = MiniWallet(tester_node)\n+        self.generate(tester_wallet, COINBASE_MATURITY)\n+\n+        orig_wallet_node.createwallet(wallet_name='w0', disable_private_keys=False, descriptors=True)\n+        w0 = orig_wallet_node.get_wallet_rpc('w0')\n+\n+        self.log.info(\"Create a parent tx and mine it in a block that will later be disconnected\")\n+        parent_amount = 100000\n+        parent_address = w0.getnewaddress()\n+        tx_parent_to_reorg = tester_wallet.send_to(\n+            from_node=tester_node,\n+            scriptPubKey=address_to_scriptpubkey(parent_address),\n+            amount=parent_amount,\n+        )\n+        assert tx_parent_to_reorg[\"txid\"] in tester_node.getrawmempool()\n+        block_to_reorg = self.generate(tester_node, 1)[0]\n+        assert_equal(len(tester_node.getrawmempool()), 0)\n+\n+        # Create an unconfirmed child transaction from the parent tx, sending all\n+        # the funds to an unspendable address. Importantly, no change output is created so the\n+        # transaction can't be recognized using its outputs. The wallet rescan needs to know the\n+        # inputs of the transaction to detect it, so the parent must be processed before the child.\n+        w0_utxos = w0.listunspent()\n+\n+        self.log.info(\"Create a child tx and wait for it to propagate to all mempools\")\n+        # The only UTXO available to spend is tx_parent_to_reorg.\n+        assert_equal(len(w0_utxos), 1)\n+        assert_equal(w0_utxos[0][\"txid\"], tx_parent_to_reorg[\"txid\"])\n+        tx_child_unconfirmed_sweep = w0.sendall([ADDRESS_BCRT1_UNSPENDABLE])\n+        self.sync_all()\n+        assert tx_child_unconfirmed_sweep[\"txid\"] in tester_node.getrawmempool()\n+        assert tx_child_unconfirmed_sweep[\"txid\"] in import_wallet_node.getrawmempool()\n+\n+        self.log.info(\"Mock a reorg, causing parent to re-enter mempools after its child\")\n+        for node in self.nodes:\n+            node.invalidateblock(block_to_reorg)\n+            assert tx_parent_to_reorg[\"txid\"] in node.getrawmempool()\n+\n+        self.log.info(\"Import descriptor wallet on another node\")\n+        descriptors_to_import = []\n+        for item in w0.listdescriptors()[\"descriptors\"]:\n+            # descriptors_to_import.append(item)",
      "path": "test/functional/wallet_rescan_unconfirmed.py",
      "position": null,
      "original_position": 82,
      "commit_id": "df30247705940c50c5eaafd74e2abbeb8b0cec07",
      "original_commit_id": "d9df438c6e581dae0c818a4c2f5fe95627ae26bc",
      "in_reply_to_id": null,
      "user": {
        "login": "stickies-v",
        "id": 69010457,
        "node_id": "MDQ6VXNlcjY5MDEwNDU3",
        "avatar_url": "https://avatars.githubusercontent.com/u/69010457?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stickies-v",
        "html_url": "https://github.com/stickies-v",
        "followers_url": "https://api.github.com/users/stickies-v/followers",
        "following_url": "https://api.github.com/users/stickies-v/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stickies-v/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stickies-v/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stickies-v/subscriptions",
        "organizations_url": "https://api.github.com/users/stickies-v/orgs",
        "repos_url": "https://api.github.com/users/stickies-v/repos",
        "events_url": "https://api.github.com/users/stickies-v/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stickies-v/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "probably should be removed?",
      "created_at": "2024-01-11T21:38:42Z",
      "updated_at": "2024-01-11T21:52:13Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29179#discussion_r1449427996",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1449427996"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29179"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 82,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1449435185",
      "pull_request_review_id": 1816762773,
      "id": 1449435185,
      "node_id": "PRRC_kwDOABII585WZKAx",
      "diff_hunk": "@@ -267,14 +270,44 @@ def run_test(self):\n                 address_type=variant.address_type.value,\n             ))\n             variant.key = self.nodes[1].dumpprivkey(variant.address[\"address\"])\n-            variant.initial_amount = get_rand_amount()\n+            variant.initial_amount = get_rand_amount() * 2\n             variant.initial_txid = self.nodes[0].sendtoaddress(variant.address[\"address\"], variant.initial_amount)\n             variant.confirmation_height = 0\n             variant.timestamp = timestamp\n \n+        # Mine a block so these parents are confirmed\n+        assert_equal(len(self.nodes[0].getrawmempool()), len(mempool_variants))\n+        self.sync_mempools()\n+        block_to_disconnect = self.generate(self.nodes[0], 1)[0]\n+        assert_equal(len(self.nodes[0].getrawmempool()), 0)\n+\n+        # For each variant, create an unconfirmed child transaction from initial_txid, sending all\n+        # the funds to an unspendable address. Importantly, no change output is created so the\n+        # transaction can't be recognized using its outputs. The wallet rescan needs to know the\n+        # inputs of the transaction to detect it, so the parent must be processed before the child.",
      "path": "test/functional/wallet_import_rescan.py",
      "position": 63,
      "original_position": 63,
      "commit_id": "df30247705940c50c5eaafd74e2abbeb8b0cec07",
      "original_commit_id": "d9df438c6e581dae0c818a4c2f5fe95627ae26bc",
      "in_reply_to_id": null,
      "user": {
        "login": "stickies-v",
        "id": 69010457,
        "node_id": "MDQ6VXNlcjY5MDEwNDU3",
        "avatar_url": "https://avatars.githubusercontent.com/u/69010457?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stickies-v",
        "html_url": "https://github.com/stickies-v",
        "followers_url": "https://api.github.com/users/stickies-v/followers",
        "following_url": "https://api.github.com/users/stickies-v/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stickies-v/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stickies-v/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stickies-v/subscriptions",
        "organizations_url": "https://api.github.com/users/stickies-v/orgs",
        "repos_url": "https://api.github.com/users/stickies-v/repos",
        "events_url": "https://api.github.com/users/stickies-v/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stickies-v/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "What do you think about adding one line to these docs in each file to reference the other file? Might be useful to e.g. keep tests in sync if problems are found, or when people wonder why this is (at first sight) only tested for legacy or descriptor wallets.\r\n\r\n```suggestion\r\n        # inputs of the transaction to detect it, so the parent must be processed before the child.\r\n        # This behaviour is tested for descriptor wallets in wallet_rescan_unconfirmed.py.\r\n```",
      "created_at": "2024-01-11T21:47:32Z",
      "updated_at": "2024-01-11T21:52:13Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29179#discussion_r1449435185",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1449435185"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29179"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 287,
      "original_line": 287,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1449439228",
      "pull_request_review_id": 1816762773,
      "id": 1449439228,
      "node_id": "PRRC_kwDOABII585WZK_8",
      "diff_hunk": "@@ -0,0 +1,97 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2024 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"Test that descriptor wallets rescan mempool transactions properly when importing.\"\"\"\n+\n+from test_framework.address import (\n+    address_to_scriptpubkey,\n+    ADDRESS_BCRT1_UNSPENDABLE,\n+)\n+from test_framework.test_framework import BitcoinTestFramework\n+from test_framework.util import assert_equal\n+from test_framework.wallet import MiniWallet\n+from test_framework.wallet_util import test_address\n+\n+\n+class WalletRescanUnconfirmed(BitcoinTestFramework):\n+    def add_options(self, parser):\n+        self.add_wallet_options(parser, legacy=False)\n+\n+    def set_test_params(self):\n+        self.num_nodes = 3\n+        # Immediate tx relay\n+        self.extra_args = [['-whitelist=noban@127.0.0.1']] * self.num_nodes\n+\n+    def skip_test_if_missing_module(self):\n+        self.skip_if_no_wallet()\n+        self.skip_if_no_sqlite()\n+\n+    def run_test(self):\n+        # Node with which we will use to send funds to the wallet and mine blocks\n+        tester_node = self.nodes[0]\n+        # Node on which the wallet is originally created\n+        orig_wallet_node = self.nodes[1]\n+        # Node which will import the wallet and rescan blocks / mempool for transactions\n+        import_wallet_node = self.nodes[2]\n+\n+\n+        self.log.info(\"Create wallets and mine initial chain\")\n+        tester_wallet = MiniWallet(tester_node)\n+        self.generate(tester_wallet, 110)\n+\n+        orig_wallet_node.createwallet(wallet_name='w0', disable_private_keys=False, descriptors=True)\n+        w0 = orig_wallet_node.get_wallet_rpc('w0')\n+\n+        self.log.info(\"Create a parent tx and mine it in a block that will later be disconnected\")\n+        parent_amount = 100000\n+        parent_address = w0.getnewaddress()\n+        tx_parent_to_reorg = tester_wallet.send_to(\n+            from_node=tester_node,\n+            scriptPubKey=address_to_scriptpubkey(parent_address),\n+            amount=parent_amount,\n+        )\n+        assert tx_parent_to_reorg[\"txid\"] in tester_node.getrawmempool()\n+        block_to_reorg = self.generate(tester_node, 1)[0]\n+        assert_equal(len(tester_node.getrawmempool()), 0)\n+\n+        # Create an unconfirmed child transaction from the parent tx, sending all\n+        # the funds to an unspendable address. Importantly, no change output is created so the\n+        # transaction can't be recognized using its outputs. The wallet rescan needs to know the\n+        # inputs of the transaction to detect it, so the parent must be processed before the child.\n+        w0_utxos = w0.listunspent()\n+\n+        self.log.info(\"Create a child tx and wait for it to propagate to all mempools\")\n+        # The only UTXO available to spend is tx_parent_to_reorg.\n+        assert_equal(len(w0_utxos), 1)\n+        assert_equal(w0_utxos[0][\"txid\"], tx_parent_to_reorg[\"txid\"])\n+        tx_child_unconfirmed_sweep = w0.sendall([ADDRESS_BCRT1_UNSPENDABLE])\n+        self.sync_all()\n+        assert tx_child_unconfirmed_sweep[\"txid\"] in tester_node.getrawmempool()\n+        assert tx_child_unconfirmed_sweep[\"txid\"] in import_wallet_node.getrawmempool()\n+\n+        self.log.info(\"Mock a reorg, causing parent to re-enter mempools after its child\")\n+        for node in self.nodes:\n+            node.invalidateblock(block_to_reorg)\n+            assert tx_parent_to_reorg[\"txid\"] in node.getrawmempool()\n+\n+        self.log.info(\"Import descriptor wallet on another node\")\n+        descriptors_to_import = []\n+        for item in w0.listdescriptors()[\"descriptors\"]:\n+            # descriptors_to_import.append(item)\n+            # use timestamp 0 to tell wallet to rescan entire chain\n+            if not item[\"internal\"]:\n+                descriptors_to_import.append({\"desc\": item[\"desc\"], \"timestamp\": 0, \"label\": \"w0 import\"})\n+        import_wallet_node.createwallet(wallet_name=\"w1\", disable_private_keys=True, blank=True, descriptors=True)\n+        w1 = import_wallet_node.get_wallet_rpc(\"w1\")\n+        w1.importdescriptors(descriptors_to_import)\n+\n+        self.log.info(\"Check that the importing node has properly rescanned mempool transactions\")\n+        # Check that parent address is correctly determined as ismine\n+        test_address(w1, parent_address, solvable=True, ismine=True)\n+        # This would raise a JSONRPCError if the transactions were not identified as belonging to the wallet.\n+        assert_equal(w1.gettransaction(tx_parent_to_reorg[\"txid\"])[\"confirmations\"], 0)\n+        assert_equal(w1.gettransaction(tx_child_unconfirmed_sweep[\"txid\"])[\"confirmations\"], 0)",
      "path": "test/functional/wallet_rescan_unconfirmed.py",
      "position": 80,
      "original_position": 94,
      "commit_id": "df30247705940c50c5eaafd74e2abbeb8b0cec07",
      "original_commit_id": "fa2b8d0e30c45b4ff59db1ac6aaeab3dc10f3df3",
      "in_reply_to_id": 1446011145,
      "user": {
        "login": "stickies-v",
        "id": 69010457,
        "node_id": "MDQ6VXNlcjY5MDEwNDU3",
        "avatar_url": "https://avatars.githubusercontent.com/u/69010457?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stickies-v",
        "html_url": "https://github.com/stickies-v",
        "followers_url": "https://api.github.com/users/stickies-v/followers",
        "following_url": "https://api.github.com/users/stickies-v/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stickies-v/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stickies-v/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stickies-v/subscriptions",
        "organizations_url": "https://api.github.com/users/stickies-v/orgs",
        "repos_url": "https://api.github.com/users/stickies-v/repos",
        "events_url": "https://api.github.com/users/stickies-v/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stickies-v/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "Makes sense, thank you! I failed to appreciate that we're calling the wallet `gettransaction` RPC, and not the not `getrawtransaction` RPC.",
      "created_at": "2024-01-11T21:51:30Z",
      "updated_at": "2024-01-11T21:52:13Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29179#discussion_r1449439228",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1449439228"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29179"
        }
      },
      "start_line": 79,
      "original_start_line": 93,
      "start_side": "RIGHT",
      "line": 80,
      "original_line": 80,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1450161338",
      "pull_request_review_id": 1817818865,
      "id": 1450161338,
      "node_id": "PRRC_kwDOABII585Wb7S6",
      "diff_hunk": "@@ -0,0 +1,98 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2024 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"Test that descriptor wallets rescan mempool transactions properly when importing.\"\"\"\n+\n+from test_framework.address import (\n+    address_to_scriptpubkey,\n+    ADDRESS_BCRT1_UNSPENDABLE,\n+)\n+from test_framework.blocktools import COINBASE_MATURITY\n+from test_framework.test_framework import BitcoinTestFramework\n+from test_framework.util import assert_equal\n+from test_framework.wallet import MiniWallet\n+from test_framework.wallet_util import test_address\n+\n+\n+class WalletRescanUnconfirmed(BitcoinTestFramework):\n+    def add_options(self, parser):\n+        self.add_wallet_options(parser, legacy=False)\n+\n+    def set_test_params(self):\n+        self.num_nodes = 3\n+        # Immediate tx relay\n+        self.extra_args = [['-whitelist=noban@127.0.0.1']] * self.num_nodes\n+\n+    def skip_test_if_missing_module(self):\n+        self.skip_if_no_wallet()\n+        self.skip_if_no_sqlite()\n+\n+    def run_test(self):\n+        # Node which we will use to send funds to the wallet and mine blocks\n+        tester_node = self.nodes[0]\n+        # Node on which the wallet is originally created\n+        orig_wallet_node = self.nodes[1]\n+        # Node which will import the wallet and rescan blocks / mempool for transactions\n+        import_wallet_node = self.nodes[2]\n+\n+\n+        self.log.info(\"Create wallets and mine initial chain\")\n+        tester_wallet = MiniWallet(tester_node)\n+        self.generate(tester_wallet, COINBASE_MATURITY)\n+\n+        orig_wallet_node.createwallet(wallet_name='w0', disable_private_keys=False, descriptors=True)\n+        w0 = orig_wallet_node.get_wallet_rpc('w0')\n+\n+        self.log.info(\"Create a parent tx and mine it in a block that will later be disconnected\")\n+        parent_amount = 100000\n+        parent_address = w0.getnewaddress()\n+        tx_parent_to_reorg = tester_wallet.send_to(\n+            from_node=tester_node,\n+            scriptPubKey=address_to_scriptpubkey(parent_address),\n+            amount=parent_amount,\n+        )\n+        assert tx_parent_to_reorg[\"txid\"] in tester_node.getrawmempool()\n+        block_to_reorg = self.generate(tester_node, 1)[0]\n+        assert_equal(len(tester_node.getrawmempool()), 0)\n+\n+        # Create an unconfirmed child transaction from the parent tx, sending all\n+        # the funds to an unspendable address. Importantly, no change output is created so the\n+        # transaction can't be recognized using its outputs. The wallet rescan needs to know the\n+        # inputs of the transaction to detect it, so the parent must be processed before the child.\n+        w0_utxos = w0.listunspent()\n+\n+        self.log.info(\"Create a child tx and wait for it to propagate to all mempools\")\n+        # The only UTXO available to spend is tx_parent_to_reorg.\n+        assert_equal(len(w0_utxos), 1)\n+        assert_equal(w0_utxos[0][\"txid\"], tx_parent_to_reorg[\"txid\"])\n+        tx_child_unconfirmed_sweep = w0.sendall([ADDRESS_BCRT1_UNSPENDABLE])\n+        self.sync_all()\n+        assert tx_child_unconfirmed_sweep[\"txid\"] in tester_node.getrawmempool()\n+        assert tx_child_unconfirmed_sweep[\"txid\"] in import_wallet_node.getrawmempool()\n+\n+        self.log.info(\"Mock a reorg, causing parent to re-enter mempools after its child\")\n+        for node in self.nodes:\n+            node.invalidateblock(block_to_reorg)\n+            assert tx_parent_to_reorg[\"txid\"] in node.getrawmempool()\n+\n+        self.log.info(\"Import descriptor wallet on another node\")\n+        descriptors_to_import = []\n+        for item in w0.listdescriptors()[\"descriptors\"]:\n+            # descriptors_to_import.append(item)",
      "path": "test/functional/wallet_rescan_unconfirmed.py",
      "position": null,
      "original_position": 82,
      "commit_id": "df30247705940c50c5eaafd74e2abbeb8b0cec07",
      "original_commit_id": "d9df438c6e581dae0c818a4c2f5fe95627ae26bc",
      "in_reply_to_id": 1449427996,
      "user": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "Oops! Removed.",
      "created_at": "2024-01-12T09:55:47Z",
      "updated_at": "2024-01-12T09:55:47Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29179#discussion_r1450161338",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1450161338"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29179"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 82,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1450162485",
      "pull_request_review_id": 1817820291,
      "id": 1450162485,
      "node_id": "PRRC_kwDOABII585Wb7k1",
      "diff_hunk": "@@ -267,14 +270,44 @@ def run_test(self):\n                 address_type=variant.address_type.value,\n             ))\n             variant.key = self.nodes[1].dumpprivkey(variant.address[\"address\"])\n-            variant.initial_amount = get_rand_amount()\n+            variant.initial_amount = get_rand_amount() * 2\n             variant.initial_txid = self.nodes[0].sendtoaddress(variant.address[\"address\"], variant.initial_amount)\n             variant.confirmation_height = 0\n             variant.timestamp = timestamp\n \n+        # Mine a block so these parents are confirmed\n+        assert_equal(len(self.nodes[0].getrawmempool()), len(mempool_variants))\n+        self.sync_mempools()\n+        block_to_disconnect = self.generate(self.nodes[0], 1)[0]\n+        assert_equal(len(self.nodes[0].getrawmempool()), 0)\n+\n+        # For each variant, create an unconfirmed child transaction from initial_txid, sending all\n+        # the funds to an unspendable address. Importantly, no change output is created so the\n+        # transaction can't be recognized using its outputs. The wallet rescan needs to know the\n+        # inputs of the transaction to detect it, so the parent must be processed before the child.",
      "path": "test/functional/wallet_import_rescan.py",
      "position": 63,
      "original_position": 63,
      "commit_id": "df30247705940c50c5eaafd74e2abbeb8b0cec07",
      "original_commit_id": "d9df438c6e581dae0c818a4c2f5fe95627ae26bc",
      "in_reply_to_id": 1449435185,
      "user": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "Added this comment in the legacy test as I agree it'll be convenient to know what coverage we are/aren't losing when deleting a legacy test.",
      "created_at": "2024-01-12T09:56:36Z",
      "updated_at": "2024-01-12T09:56:36Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29179#discussion_r1450162485",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1450162485"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29179"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 287,
      "original_line": 287,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1450164269",
      "pull_request_review_id": 1817822719,
      "id": 1450164269,
      "node_id": "PRRC_kwDOABII585Wb8At",
      "diff_hunk": "@@ -0,0 +1,97 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2024 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"Test that descriptor wallets rescan mempool transactions properly when importing.\"\"\"\n+\n+from test_framework.address import (\n+    address_to_scriptpubkey,\n+    ADDRESS_BCRT1_UNSPENDABLE,\n+)\n+from test_framework.test_framework import BitcoinTestFramework\n+from test_framework.util import assert_equal\n+from test_framework.wallet import MiniWallet\n+from test_framework.wallet_util import test_address\n+\n+\n+class WalletRescanUnconfirmed(BitcoinTestFramework):\n+    def add_options(self, parser):\n+        self.add_wallet_options(parser, legacy=False)\n+\n+    def set_test_params(self):\n+        self.num_nodes = 3\n+        # Immediate tx relay\n+        self.extra_args = [['-whitelist=noban@127.0.0.1']] * self.num_nodes\n+\n+    def skip_test_if_missing_module(self):\n+        self.skip_if_no_wallet()\n+        self.skip_if_no_sqlite()\n+\n+    def run_test(self):\n+        # Node with which we will use to send funds to the wallet and mine blocks\n+        tester_node = self.nodes[0]\n+        # Node on which the wallet is originally created\n+        orig_wallet_node = self.nodes[1]\n+        # Node which will import the wallet and rescan blocks / mempool for transactions\n+        import_wallet_node = self.nodes[2]\n+\n+\n+        self.log.info(\"Create wallets and mine initial chain\")\n+        tester_wallet = MiniWallet(tester_node)\n+        self.generate(tester_wallet, 110)\n+\n+        orig_wallet_node.createwallet(wallet_name='w0', disable_private_keys=False, descriptors=True)\n+        w0 = orig_wallet_node.get_wallet_rpc('w0')\n+\n+        self.log.info(\"Create a parent tx and mine it in a block that will later be disconnected\")\n+        parent_amount = 100000\n+        parent_address = w0.getnewaddress()\n+        tx_parent_to_reorg = tester_wallet.send_to(\n+            from_node=tester_node,\n+            scriptPubKey=address_to_scriptpubkey(parent_address),\n+            amount=parent_amount,\n+        )\n+        assert tx_parent_to_reorg[\"txid\"] in tester_node.getrawmempool()\n+        block_to_reorg = self.generate(tester_node, 1)[0]\n+        assert_equal(len(tester_node.getrawmempool()), 0)\n+\n+        # Create an unconfirmed child transaction from the parent tx, sending all\n+        # the funds to an unspendable address. Importantly, no change output is created so the\n+        # transaction can't be recognized using its outputs. The wallet rescan needs to know the\n+        # inputs of the transaction to detect it, so the parent must be processed before the child.\n+        w0_utxos = w0.listunspent()\n+\n+        self.log.info(\"Create a child tx and wait for it to propagate to all mempools\")\n+        # The only UTXO available to spend is tx_parent_to_reorg.\n+        assert_equal(len(w0_utxos), 1)\n+        assert_equal(w0_utxos[0][\"txid\"], tx_parent_to_reorg[\"txid\"])\n+        tx_child_unconfirmed_sweep = w0.sendall([ADDRESS_BCRT1_UNSPENDABLE])\n+        self.sync_all()\n+        assert tx_child_unconfirmed_sweep[\"txid\"] in tester_node.getrawmempool()\n+        assert tx_child_unconfirmed_sweep[\"txid\"] in import_wallet_node.getrawmempool()\n+\n+        self.log.info(\"Mock a reorg, causing parent to re-enter mempools after its child\")\n+        for node in self.nodes:\n+            node.invalidateblock(block_to_reorg)\n+            assert tx_parent_to_reorg[\"txid\"] in node.getrawmempool()\n+\n+        self.log.info(\"Import descriptor wallet on another node\")\n+        descriptors_to_import = []\n+        for item in w0.listdescriptors()[\"descriptors\"]:\n+            # descriptors_to_import.append(item)\n+            # use timestamp 0 to tell wallet to rescan entire chain\n+            if not item[\"internal\"]:\n+                descriptors_to_import.append({\"desc\": item[\"desc\"], \"timestamp\": 0, \"label\": \"w0 import\"})\n+        import_wallet_node.createwallet(wallet_name=\"w1\", disable_private_keys=True, blank=True, descriptors=True)\n+        w1 = import_wallet_node.get_wallet_rpc(\"w1\")\n+        w1.importdescriptors(descriptors_to_import)\n+\n+        self.log.info(\"Check that the importing node has properly rescanned mempool transactions\")\n+        # Check that parent address is correctly determined as ismine\n+        test_address(w1, parent_address, solvable=True, ismine=True)\n+        # This would raise a JSONRPCError if the transactions were not identified as belonging to the wallet.\n+        assert_equal(w1.gettransaction(tx_parent_to_reorg[\"txid\"])[\"confirmations\"], 0)\n+        assert_equal(w1.gettransaction(tx_child_unconfirmed_sweep[\"txid\"])[\"confirmations\"], 0)",
      "path": "test/functional/wallet_rescan_unconfirmed.py",
      "position": 80,
      "original_position": 94,
      "commit_id": "df30247705940c50c5eaafd74e2abbeb8b0cec07",
      "original_commit_id": "fa2b8d0e30c45b4ff59db1ac6aaeab3dc10f3df3",
      "in_reply_to_id": 1446011145,
      "user": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "Ah yeah, it's a wallet-specific RPC. I've added a check that the \"confirmations\" value is 1 on wallet 0 a few lines up, prior to the reorg. Hopefully that also helps make it clear why we're testing this way.",
      "created_at": "2024-01-12T09:57:57Z",
      "updated_at": "2024-01-12T09:57:57Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29179#discussion_r1450164269",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1450164269"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29179"
        }
      },
      "start_line": 79,
      "original_start_line": 93,
      "start_side": "RIGHT",
      "line": 80,
      "original_line": 80,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1450347036",
      "pull_request_review_id": 1818093579,
      "id": 1450347036,
      "node_id": "PRRC_kwDOABII585Wcooc",
      "diff_hunk": "@@ -0,0 +1,98 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2024 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"Test that descriptor wallets rescan mempool transactions properly when importing.\"\"\"\n+\n+from test_framework.address import (\n+    address_to_scriptpubkey,\n+    ADDRESS_BCRT1_UNSPENDABLE,\n+)\n+from test_framework.blocktools import COINBASE_MATURITY\n+from test_framework.test_framework import BitcoinTestFramework\n+from test_framework.util import assert_equal\n+from test_framework.wallet import MiniWallet\n+from test_framework.wallet_util import test_address\n+\n+\n+class WalletRescanUnconfirmed(BitcoinTestFramework):\n+    def add_options(self, parser):\n+        self.add_wallet_options(parser, legacy=False)\n+\n+    def set_test_params(self):\n+        self.num_nodes = 3\n+        # Immediate tx relay\n+        self.extra_args = [['-whitelist=noban@127.0.0.1']] * self.num_nodes\n+\n+    def skip_test_if_missing_module(self):\n+        self.skip_if_no_wallet()\n+        self.skip_if_no_sqlite()",
      "path": "test/functional/wallet_rescan_unconfirmed.py",
      "position": null,
      "original_position": 29,
      "commit_id": "df30247705940c50c5eaafd74e2abbeb8b0cec07",
      "original_commit_id": "c39e82926a3740642f8f1bb72c6b10b67a6dc724",
      "in_reply_to_id": null,
      "user": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "in c39e82926a:\r\n\r\ntiny nit:\r\nlooks redundant to call `add_wallet_options(legacy=False)` and then call `skip_if_no_sqlite()`.\r\nIf the wallet is enabled and `sqlite` is not supported, then the only option is a legacy wallet, which is blocked by the `add_wallet_options` call.",
      "created_at": "2024-01-12T12:08:16Z",
      "updated_at": "2024-01-12T13:15:36Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29179#discussion_r1450347036",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1450347036"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29179"
        }
      },
      "start_line": null,
      "original_start_line": 19,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 27,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1450354940",
      "pull_request_review_id": 1818093579,
      "id": 1450354940,
      "node_id": "PRRC_kwDOABII585Wcqj8",
      "diff_hunk": "@@ -0,0 +1,98 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2024 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"Test that descriptor wallets rescan mempool transactions properly when importing.\"\"\"\n+\n+from test_framework.address import (\n+    address_to_scriptpubkey,\n+    ADDRESS_BCRT1_UNSPENDABLE,\n+)\n+from test_framework.blocktools import COINBASE_MATURITY\n+from test_framework.test_framework import BitcoinTestFramework\n+from test_framework.util import assert_equal\n+from test_framework.wallet import MiniWallet\n+from test_framework.wallet_util import test_address\n+\n+\n+class WalletRescanUnconfirmed(BitcoinTestFramework):\n+    def add_options(self, parser):\n+        self.add_wallet_options(parser, legacy=False)\n+\n+    def set_test_params(self):\n+        self.num_nodes = 3\n+        # Immediate tx relay\n+        self.extra_args = [['-whitelist=noban@127.0.0.1']] * self.num_nodes\n+\n+    def skip_test_if_missing_module(self):\n+        self.skip_if_no_wallet()\n+        self.skip_if_no_sqlite()\n+\n+    def run_test(self):\n+        # Node which we will use to send funds to the wallet and mine blocks\n+        tester_node = self.nodes[0]\n+        # Node on which the wallet is originally created\n+        orig_wallet_node = self.nodes[1]\n+        # Node which will import the wallet and rescan blocks / mempool for transactions\n+        import_wallet_node = self.nodes[2]\n+\n+\n+        self.log.info(\"Create wallets and mine initial chain\")\n+        tester_wallet = MiniWallet(tester_node)\n+        self.generate(tester_wallet, COINBASE_MATURITY)\n+\n+        orig_wallet_node.createwallet(wallet_name='w0', disable_private_keys=False, descriptors=True)",
      "path": "test/functional/wallet_rescan_unconfirmed.py",
      "position": null,
      "original_position": 44,
      "commit_id": "df30247705940c50c5eaafd74e2abbeb8b0cec07",
      "original_commit_id": "c39e82926a3740642f8f1bb72c6b10b67a6dc724",
      "in_reply_to_id": null,
      "user": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "in https://github.com/bitcoin/bitcoin/commit/c39e82926a3740642f8f1bb72c6b10b67a6dc724:\r\n\r\nnit: `disable_private_keys` is false by default. And, because this is a descriptors-only test (per `self.add_wallet_options`), the `descriptors` flag is also redundant.",
      "created_at": "2024-01-12T12:15:41Z",
      "updated_at": "2024-01-12T13:15:37Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29179#discussion_r1450354940",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1450354940"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29179"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 44,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1450361941",
      "pull_request_review_id": 1818093579,
      "id": 1450361941,
      "node_id": "PRRC_kwDOABII585WcsRV",
      "diff_hunk": "@@ -0,0 +1,98 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2024 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"Test that descriptor wallets rescan mempool transactions properly when importing.\"\"\"\n+\n+from test_framework.address import (\n+    address_to_scriptpubkey,\n+    ADDRESS_BCRT1_UNSPENDABLE,\n+)\n+from test_framework.blocktools import COINBASE_MATURITY\n+from test_framework.test_framework import BitcoinTestFramework\n+from test_framework.util import assert_equal\n+from test_framework.wallet import MiniWallet\n+from test_framework.wallet_util import test_address\n+\n+\n+class WalletRescanUnconfirmed(BitcoinTestFramework):\n+    def add_options(self, parser):\n+        self.add_wallet_options(parser, legacy=False)\n+\n+    def set_test_params(self):\n+        self.num_nodes = 3\n+        # Immediate tx relay\n+        self.extra_args = [['-whitelist=noban@127.0.0.1']] * self.num_nodes\n+\n+    def skip_test_if_missing_module(self):\n+        self.skip_if_no_wallet()\n+        self.skip_if_no_sqlite()\n+\n+    def run_test(self):\n+        # Node which we will use to send funds to the wallet and mine blocks\n+        tester_node = self.nodes[0]\n+        # Node on which the wallet is originally created\n+        orig_wallet_node = self.nodes[1]\n+        # Node which will import the wallet and rescan blocks / mempool for transactions\n+        import_wallet_node = self.nodes[2]\n+\n+\n+        self.log.info(\"Create wallets and mine initial chain\")\n+        tester_wallet = MiniWallet(tester_node)\n+        self.generate(tester_wallet, COINBASE_MATURITY)\n+\n+        orig_wallet_node.createwallet(wallet_name='w0', disable_private_keys=False, descriptors=True)\n+        w0 = orig_wallet_node.get_wallet_rpc('w0')\n+\n+        self.log.info(\"Create a parent tx and mine it in a block that will later be disconnected\")\n+        parent_amount = 100000\n+        parent_address = w0.getnewaddress()\n+        tx_parent_to_reorg = tester_wallet.send_to(\n+            from_node=tester_node,\n+            scriptPubKey=address_to_scriptpubkey(parent_address),\n+            amount=parent_amount,\n+        )\n+        assert tx_parent_to_reorg[\"txid\"] in tester_node.getrawmempool()\n+        block_to_reorg = self.generate(tester_node, 1)[0]\n+        assert_equal(len(tester_node.getrawmempool()), 0)\n+        assert_equal(w0.gettransaction(tx_parent_to_reorg[\"txid\"])[\"confirmations\"], 1)\n+\n+        # Create an unconfirmed child transaction from the parent tx, sending all\n+        # the funds to an unspendable address. Importantly, no change output is created so the\n+        # transaction can't be recognized using its outputs. The wallet rescan needs to know the\n+        # inputs of the transaction to detect it, so the parent must be processed before the child.\n+        w0_utxos = w0.listunspent()\n+\n+        self.log.info(\"Create a child tx and wait for it to propagate to all mempools\")\n+        # The only UTXO available to spend is tx_parent_to_reorg.\n+        assert_equal(len(w0_utxos), 1)\n+        assert_equal(w0_utxos[0][\"txid\"], tx_parent_to_reorg[\"txid\"])\n+        tx_child_unconfirmed_sweep = w0.sendall([ADDRESS_BCRT1_UNSPENDABLE])\n+        self.sync_all()",
      "path": "test/functional/wallet_rescan_unconfirmed.py",
      "position": null,
      "original_position": 71,
      "commit_id": "df30247705940c50c5eaafd74e2abbeb8b0cec07",
      "original_commit_id": "c39e82926a3740642f8f1bb72c6b10b67a6dc724",
      "in_reply_to_id": null,
      "user": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "tiny nit: this could be `sync_mempools` instead.",
      "created_at": "2024-01-12T12:21:33Z",
      "updated_at": "2024-01-12T13:15:37Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29179#discussion_r1450361941",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1450361941"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29179"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 71,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1450366154",
      "pull_request_review_id": 1818093579,
      "id": 1450366154,
      "node_id": "PRRC_kwDOABII585WctTK",
      "diff_hunk": "@@ -0,0 +1,98 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2024 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"Test that descriptor wallets rescan mempool transactions properly when importing.\"\"\"\n+\n+from test_framework.address import (\n+    address_to_scriptpubkey,\n+    ADDRESS_BCRT1_UNSPENDABLE,\n+)\n+from test_framework.blocktools import COINBASE_MATURITY\n+from test_framework.test_framework import BitcoinTestFramework\n+from test_framework.util import assert_equal\n+from test_framework.wallet import MiniWallet\n+from test_framework.wallet_util import test_address\n+\n+\n+class WalletRescanUnconfirmed(BitcoinTestFramework):\n+    def add_options(self, parser):\n+        self.add_wallet_options(parser, legacy=False)\n+\n+    def set_test_params(self):\n+        self.num_nodes = 3\n+        # Immediate tx relay\n+        self.extra_args = [['-whitelist=noban@127.0.0.1']] * self.num_nodes\n+\n+    def skip_test_if_missing_module(self):\n+        self.skip_if_no_wallet()\n+        self.skip_if_no_sqlite()\n+\n+    def run_test(self):\n+        # Node which we will use to send funds to the wallet and mine blocks\n+        tester_node = self.nodes[0]\n+        # Node on which the wallet is originally created\n+        orig_wallet_node = self.nodes[1]\n+        # Node which will import the wallet and rescan blocks / mempool for transactions\n+        import_wallet_node = self.nodes[2]\n+\n+\n+        self.log.info(\"Create wallets and mine initial chain\")\n+        tester_wallet = MiniWallet(tester_node)\n+        self.generate(tester_wallet, COINBASE_MATURITY)\n+\n+        orig_wallet_node.createwallet(wallet_name='w0', disable_private_keys=False, descriptors=True)\n+        w0 = orig_wallet_node.get_wallet_rpc('w0')\n+\n+        self.log.info(\"Create a parent tx and mine it in a block that will later be disconnected\")\n+        parent_amount = 100000\n+        parent_address = w0.getnewaddress()\n+        tx_parent_to_reorg = tester_wallet.send_to(\n+            from_node=tester_node,\n+            scriptPubKey=address_to_scriptpubkey(parent_address),\n+            amount=parent_amount,\n+        )\n+        assert tx_parent_to_reorg[\"txid\"] in tester_node.getrawmempool()\n+        block_to_reorg = self.generate(tester_node, 1)[0]\n+        assert_equal(len(tester_node.getrawmempool()), 0)\n+        assert_equal(w0.gettransaction(tx_parent_to_reorg[\"txid\"])[\"confirmations\"], 1)\n+\n+        # Create an unconfirmed child transaction from the parent tx, sending all\n+        # the funds to an unspendable address. Importantly, no change output is created so the\n+        # transaction can't be recognized using its outputs. The wallet rescan needs to know the\n+        # inputs of the transaction to detect it, so the parent must be processed before the child.\n+        w0_utxos = w0.listunspent()\n+\n+        self.log.info(\"Create a child tx and wait for it to propagate to all mempools\")\n+        # The only UTXO available to spend is tx_parent_to_reorg.\n+        assert_equal(len(w0_utxos), 1)\n+        assert_equal(w0_utxos[0][\"txid\"], tx_parent_to_reorg[\"txid\"])\n+        tx_child_unconfirmed_sweep = w0.sendall([ADDRESS_BCRT1_UNSPENDABLE])\n+        self.sync_all()\n+        assert tx_child_unconfirmed_sweep[\"txid\"] in tester_node.getrawmempool()\n+        assert tx_child_unconfirmed_sweep[\"txid\"] in import_wallet_node.getrawmempool()\n+\n+        self.log.info(\"Mock a reorg, causing parent to re-enter mempools after its child\")\n+        for node in self.nodes:\n+            node.invalidateblock(block_to_reorg)\n+            assert tx_parent_to_reorg[\"txid\"] in node.getrawmempool()\n+\n+        self.log.info(\"Import descriptor wallet on another node\")\n+        descriptors_to_import = []\n+        for item in w0.listdescriptors()[\"descriptors\"]:\n+            # use timestamp 0 to tell wallet to rescan entire chain\n+            if not item[\"internal\"]:\n+                descriptors_to_import.append({\"desc\": item[\"desc\"], \"timestamp\": 0, \"label\": \"w0 import\"})\n+        import_wallet_node.createwallet(wallet_name=\"w1\", disable_private_keys=True, blank=True, descriptors=True)",
      "path": "test/functional/wallet_rescan_unconfirmed.py",
      "position": null,
      "original_position": 86,
      "commit_id": "df30247705940c50c5eaafd74e2abbeb8b0cec07",
      "original_commit_id": "c39e82926a3740642f8f1bb72c6b10b67a6dc724",
      "in_reply_to_id": null,
      "user": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "In https://github.com/bitcoin/bitcoin/commit/c39e82926a3740642f8f1bb72c6b10b67a6dc724:\r\n\r\nsame as above, the `descriptors` flag isn't needed. Also, if you set `disable_private_keys=True`, there is no need to set `blank=True`.",
      "created_at": "2024-01-12T12:26:09Z",
      "updated_at": "2024-01-12T13:15:37Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29179#discussion_r1450366154",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1450366154"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29179"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 86,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1450376850",
      "pull_request_review_id": 1818093579,
      "id": 1450376850,
      "node_id": "PRRC_kwDOABII585Wcv6S",
      "diff_hunk": "@@ -0,0 +1,98 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2024 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"Test that descriptor wallets rescan mempool transactions properly when importing.\"\"\"\n+\n+from test_framework.address import (\n+    address_to_scriptpubkey,\n+    ADDRESS_BCRT1_UNSPENDABLE,\n+)\n+from test_framework.blocktools import COINBASE_MATURITY\n+from test_framework.test_framework import BitcoinTestFramework\n+from test_framework.util import assert_equal\n+from test_framework.wallet import MiniWallet\n+from test_framework.wallet_util import test_address\n+\n+\n+class WalletRescanUnconfirmed(BitcoinTestFramework):\n+    def add_options(self, parser):\n+        self.add_wallet_options(parser, legacy=False)\n+\n+    def set_test_params(self):\n+        self.num_nodes = 3\n+        # Immediate tx relay\n+        self.extra_args = [['-whitelist=noban@127.0.0.1']] * self.num_nodes\n+\n+    def skip_test_if_missing_module(self):\n+        self.skip_if_no_wallet()\n+        self.skip_if_no_sqlite()\n+\n+    def run_test(self):\n+        # Node which we will use to send funds to the wallet and mine blocks\n+        tester_node = self.nodes[0]\n+        # Node on which the wallet is originally created\n+        orig_wallet_node = self.nodes[1]\n+        # Node which will import the wallet and rescan blocks / mempool for transactions\n+        import_wallet_node = self.nodes[2]\n+\n+\n+        self.log.info(\"Create wallets and mine initial chain\")\n+        tester_wallet = MiniWallet(tester_node)\n+        self.generate(tester_wallet, COINBASE_MATURITY)\n+\n+        orig_wallet_node.createwallet(wallet_name='w0', disable_private_keys=False, descriptors=True)\n+        w0 = orig_wallet_node.get_wallet_rpc('w0')\n+\n+        self.log.info(\"Create a parent tx and mine it in a block that will later be disconnected\")\n+        parent_amount = 100000\n+        parent_address = w0.getnewaddress()\n+        tx_parent_to_reorg = tester_wallet.send_to(\n+            from_node=tester_node,\n+            scriptPubKey=address_to_scriptpubkey(parent_address),\n+            amount=parent_amount,\n+        )\n+        assert tx_parent_to_reorg[\"txid\"] in tester_node.getrawmempool()\n+        block_to_reorg = self.generate(tester_node, 1)[0]\n+        assert_equal(len(tester_node.getrawmempool()), 0)\n+        assert_equal(w0.gettransaction(tx_parent_to_reorg[\"txid\"])[\"confirmations\"], 1)\n+\n+        # Create an unconfirmed child transaction from the parent tx, sending all\n+        # the funds to an unspendable address. Importantly, no change output is created so the\n+        # transaction can't be recognized using its outputs. The wallet rescan needs to know the\n+        # inputs of the transaction to detect it, so the parent must be processed before the child.\n+        w0_utxos = w0.listunspent()\n+\n+        self.log.info(\"Create a child tx and wait for it to propagate to all mempools\")\n+        # The only UTXO available to spend is tx_parent_to_reorg.\n+        assert_equal(len(w0_utxos), 1)\n+        assert_equal(w0_utxos[0][\"txid\"], tx_parent_to_reorg[\"txid\"])\n+        tx_child_unconfirmed_sweep = w0.sendall([ADDRESS_BCRT1_UNSPENDABLE])\n+        self.sync_all()\n+        assert tx_child_unconfirmed_sweep[\"txid\"] in tester_node.getrawmempool()\n+        assert tx_child_unconfirmed_sweep[\"txid\"] in import_wallet_node.getrawmempool()\n+\n+        self.log.info(\"Mock a reorg, causing parent to re-enter mempools after its child\")\n+        for node in self.nodes:\n+            node.invalidateblock(block_to_reorg)\n+            assert tx_parent_to_reorg[\"txid\"] in node.getrawmempool()\n+\n+        self.log.info(\"Import descriptor wallet on another node\")\n+        descriptors_to_import = []\n+        for item in w0.listdescriptors()[\"descriptors\"]:\n+            # use timestamp 0 to tell wallet to rescan entire chain\n+            if not item[\"internal\"]:\n+                descriptors_to_import.append({\"desc\": item[\"desc\"], \"timestamp\": 0, \"label\": \"w0 import\"})",
      "path": "test/functional/wallet_rescan_unconfirmed.py",
      "position": null,
      "original_position": 85,
      "commit_id": "df30247705940c50c5eaafd74e2abbeb8b0cec07",
      "original_commit_id": "c39e82926a3740642f8f1bb72c6b10b67a6dc724",
      "in_reply_to_id": null,
      "user": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "In c39e82926a3:\r\n\r\nCan simplify this by only importing the used address descriptor.\r\n```suggestion\r\ndescriptors_to_import = [{\"desc\": w0.getaddressinfo(parent_address)['parent_desc'], \"timestamp\": 0, \"label\": \"w0 import\"}]\r\n```",
      "created_at": "2024-01-12T12:34:59Z",
      "updated_at": "2024-01-12T13:15:37Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29179#discussion_r1450376850",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1450376850"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29179"
        }
      },
      "start_line": null,
      "original_start_line": 81,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 85,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1450417390",
      "pull_request_review_id": 1818093579,
      "id": 1450417390,
      "node_id": "PRRC_kwDOABII585Wc5zu",
      "diff_hunk": "@@ -0,0 +1,98 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2024 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"Test that descriptor wallets rescan mempool transactions properly when importing.\"\"\"\n+\n+from test_framework.address import (\n+    address_to_scriptpubkey,\n+    ADDRESS_BCRT1_UNSPENDABLE,\n+)\n+from test_framework.blocktools import COINBASE_MATURITY\n+from test_framework.test_framework import BitcoinTestFramework\n+from test_framework.util import assert_equal\n+from test_framework.wallet import MiniWallet\n+from test_framework.wallet_util import test_address\n+\n+\n+class WalletRescanUnconfirmed(BitcoinTestFramework):\n+    def add_options(self, parser):\n+        self.add_wallet_options(parser, legacy=False)\n+\n+    def set_test_params(self):\n+        self.num_nodes = 3\n+        # Immediate tx relay\n+        self.extra_args = [['-whitelist=noban@127.0.0.1']] * self.num_nodes\n+\n+    def skip_test_if_missing_module(self):\n+        self.skip_if_no_wallet()\n+        self.skip_if_no_sqlite()\n+\n+    def run_test(self):\n+        # Node which we will use to send funds to the wallet and mine blocks\n+        tester_node = self.nodes[0]\n+        # Node on which the wallet is originally created\n+        orig_wallet_node = self.nodes[1]\n+        # Node which will import the wallet and rescan blocks / mempool for transactions\n+        import_wallet_node = self.nodes[2]\n+\n+\n+        self.log.info(\"Create wallets and mine initial chain\")\n+        tester_wallet = MiniWallet(tester_node)\n+        self.generate(tester_wallet, COINBASE_MATURITY)",
      "path": "test/functional/wallet_rescan_unconfirmed.py",
      "position": null,
      "original_position": 42,
      "commit_id": "df30247705940c50c5eaafd74e2abbeb8b0cec07",
      "original_commit_id": "c39e82926a3740642f8f1bb72c6b10b67a6dc724",
      "in_reply_to_id": null,
      "user": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "In https://github.com/bitcoin/bitcoin/commit/c39e82926a3740642f8f1bb72c6b10b67a6dc724:\r\n\r\nUnless you specify a clean chain (which this test does not), the test will have an existing matured one. Which means, you could modify this for \r\n\r\n```suggestion\r\n        tester_wallet = MiniWallet(tester_node)\r\n        self.generate(tester_wallet, 1)\r\n```",
      "created_at": "2024-01-12T13:10:16Z",
      "updated_at": "2024-01-12T13:16:27Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29179#discussion_r1450417390",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1450417390"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29179"
        }
      },
      "start_line": null,
      "original_start_line": 41,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 42,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1450457328",
      "pull_request_review_id": 1818270953,
      "id": 1450457328,
      "node_id": "PRRC_kwDOABII585WdDjw",
      "diff_hunk": "@@ -0,0 +1,98 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2024 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"Test that descriptor wallets rescan mempool transactions properly when importing.\"\"\"\n+\n+from test_framework.address import (\n+    address_to_scriptpubkey,\n+    ADDRESS_BCRT1_UNSPENDABLE,\n+)\n+from test_framework.blocktools import COINBASE_MATURITY\n+from test_framework.test_framework import BitcoinTestFramework\n+from test_framework.util import assert_equal\n+from test_framework.wallet import MiniWallet\n+from test_framework.wallet_util import test_address\n+\n+\n+class WalletRescanUnconfirmed(BitcoinTestFramework):\n+    def add_options(self, parser):\n+        self.add_wallet_options(parser, legacy=False)\n+\n+    def set_test_params(self):\n+        self.num_nodes = 3\n+        # Immediate tx relay\n+        self.extra_args = [['-whitelist=noban@127.0.0.1']] * self.num_nodes\n+\n+    def skip_test_if_missing_module(self):\n+        self.skip_if_no_wallet()\n+        self.skip_if_no_sqlite()\n+\n+    def run_test(self):\n+        # Node which we will use to send funds to the wallet and mine blocks\n+        tester_node = self.nodes[0]\n+        # Node on which the wallet is originally created\n+        orig_wallet_node = self.nodes[1]\n+        # Node which will import the wallet and rescan blocks / mempool for transactions\n+        import_wallet_node = self.nodes[2]\n+\n+\n+        self.log.info(\"Create wallets and mine initial chain\")\n+        tester_wallet = MiniWallet(tester_node)\n+        self.generate(tester_wallet, COINBASE_MATURITY)\n+\n+        orig_wallet_node.createwallet(wallet_name='w0', disable_private_keys=False, descriptors=True)",
      "path": "test/functional/wallet_rescan_unconfirmed.py",
      "position": null,
      "original_position": 44,
      "commit_id": "df30247705940c50c5eaafd74e2abbeb8b0cec07",
      "original_commit_id": "c39e82926a3740642f8f1bb72c6b10b67a6dc724",
      "in_reply_to_id": 1450354940,
      "user": {
        "login": "stickies-v",
        "id": 69010457,
        "node_id": "MDQ6VXNlcjY5MDEwNDU3",
        "avatar_url": "https://avatars.githubusercontent.com/u/69010457?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stickies-v",
        "html_url": "https://github.com/stickies-v",
        "followers_url": "https://api.github.com/users/stickies-v/followers",
        "following_url": "https://api.github.com/users/stickies-v/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stickies-v/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stickies-v/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stickies-v/subscriptions",
        "organizations_url": "https://api.github.com/users/stickies-v/orgs",
        "repos_url": "https://api.github.com/users/stickies-v/repos",
        "events_url": "https://api.github.com/users/stickies-v/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stickies-v/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "I initially left the same comment about `disable_private_keys` but think it is helpful to contrast the difference with further down the test where we set `disable_private_keys=True`. Likewise, I think keeping `descriptors=True` is helpful self-documentation given the contrast with the test in `wallet_import_rescan.py`. No strong opinion on either, though.",
      "created_at": "2024-01-12T13:30:01Z",
      "updated_at": "2024-01-12T13:30:01Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29179#discussion_r1450457328",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1450457328"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29179"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 44,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1450509572",
      "pull_request_review_id": 1818360048,
      "id": 1450509572,
      "node_id": "PRRC_kwDOABII585WdQUE",
      "diff_hunk": "@@ -0,0 +1,98 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2024 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"Test that descriptor wallets rescan mempool transactions properly when importing.\"\"\"\n+\n+from test_framework.address import (\n+    address_to_scriptpubkey,\n+    ADDRESS_BCRT1_UNSPENDABLE,\n+)\n+from test_framework.blocktools import COINBASE_MATURITY\n+from test_framework.test_framework import BitcoinTestFramework\n+from test_framework.util import assert_equal\n+from test_framework.wallet import MiniWallet\n+from test_framework.wallet_util import test_address\n+\n+\n+class WalletRescanUnconfirmed(BitcoinTestFramework):\n+    def add_options(self, parser):\n+        self.add_wallet_options(parser, legacy=False)\n+\n+    def set_test_params(self):\n+        self.num_nodes = 3\n+        # Immediate tx relay\n+        self.extra_args = [['-whitelist=noban@127.0.0.1']] * self.num_nodes\n+\n+    def skip_test_if_missing_module(self):\n+        self.skip_if_no_wallet()\n+        self.skip_if_no_sqlite()",
      "path": "test/functional/wallet_rescan_unconfirmed.py",
      "position": null,
      "original_position": 29,
      "commit_id": "df30247705940c50c5eaafd74e2abbeb8b0cec07",
      "original_commit_id": "c39e82926a3740642f8f1bb72c6b10b67a6dc724",
      "in_reply_to_id": 1450347036,
      "user": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "Seems pretty common to specify both. They are technically different; one says no legacy and the other says need descriptors. I know that's effectively the same thing and we don't have 3 types, but I think it's harmless to keep this.",
      "created_at": "2024-01-12T14:17:24Z",
      "updated_at": "2024-01-12T14:23:43Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29179#discussion_r1450509572",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1450509572"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29179"
        }
      },
      "start_line": null,
      "original_start_line": 19,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 27,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1450510108",
      "pull_request_review_id": 1818360048,
      "id": 1450510108,
      "node_id": "PRRC_kwDOABII585WdQcc",
      "diff_hunk": "@@ -0,0 +1,98 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2024 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"Test that descriptor wallets rescan mempool transactions properly when importing.\"\"\"\n+\n+from test_framework.address import (\n+    address_to_scriptpubkey,\n+    ADDRESS_BCRT1_UNSPENDABLE,\n+)\n+from test_framework.blocktools import COINBASE_MATURITY\n+from test_framework.test_framework import BitcoinTestFramework\n+from test_framework.util import assert_equal\n+from test_framework.wallet import MiniWallet\n+from test_framework.wallet_util import test_address\n+\n+\n+class WalletRescanUnconfirmed(BitcoinTestFramework):\n+    def add_options(self, parser):\n+        self.add_wallet_options(parser, legacy=False)\n+\n+    def set_test_params(self):\n+        self.num_nodes = 3\n+        # Immediate tx relay\n+        self.extra_args = [['-whitelist=noban@127.0.0.1']] * self.num_nodes\n+\n+    def skip_test_if_missing_module(self):\n+        self.skip_if_no_wallet()\n+        self.skip_if_no_sqlite()\n+\n+    def run_test(self):\n+        # Node which we will use to send funds to the wallet and mine blocks\n+        tester_node = self.nodes[0]\n+        # Node on which the wallet is originally created\n+        orig_wallet_node = self.nodes[1]\n+        # Node which will import the wallet and rescan blocks / mempool for transactions\n+        import_wallet_node = self.nodes[2]\n+\n+\n+        self.log.info(\"Create wallets and mine initial chain\")\n+        tester_wallet = MiniWallet(tester_node)\n+        self.generate(tester_wallet, COINBASE_MATURITY)\n+\n+        orig_wallet_node.createwallet(wallet_name='w0', disable_private_keys=False, descriptors=True)\n+        w0 = orig_wallet_node.get_wallet_rpc('w0')\n+\n+        self.log.info(\"Create a parent tx and mine it in a block that will later be disconnected\")\n+        parent_amount = 100000\n+        parent_address = w0.getnewaddress()\n+        tx_parent_to_reorg = tester_wallet.send_to(\n+            from_node=tester_node,\n+            scriptPubKey=address_to_scriptpubkey(parent_address),\n+            amount=parent_amount,\n+        )\n+        assert tx_parent_to_reorg[\"txid\"] in tester_node.getrawmempool()\n+        block_to_reorg = self.generate(tester_node, 1)[0]\n+        assert_equal(len(tester_node.getrawmempool()), 0)\n+        assert_equal(w0.gettransaction(tx_parent_to_reorg[\"txid\"])[\"confirmations\"], 1)\n+\n+        # Create an unconfirmed child transaction from the parent tx, sending all\n+        # the funds to an unspendable address. Importantly, no change output is created so the\n+        # transaction can't be recognized using its outputs. The wallet rescan needs to know the\n+        # inputs of the transaction to detect it, so the parent must be processed before the child.\n+        w0_utxos = w0.listunspent()\n+\n+        self.log.info(\"Create a child tx and wait for it to propagate to all mempools\")\n+        # The only UTXO available to spend is tx_parent_to_reorg.\n+        assert_equal(len(w0_utxos), 1)\n+        assert_equal(w0_utxos[0][\"txid\"], tx_parent_to_reorg[\"txid\"])\n+        tx_child_unconfirmed_sweep = w0.sendall([ADDRESS_BCRT1_UNSPENDABLE])\n+        self.sync_all()",
      "path": "test/functional/wallet_rescan_unconfirmed.py",
      "position": null,
      "original_position": 71,
      "commit_id": "df30247705940c50c5eaafd74e2abbeb8b0cec07",
      "original_commit_id": "c39e82926a3740642f8f1bb72c6b10b67a6dc724",
      "in_reply_to_id": 1450361941,
      "user": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "done",
      "created_at": "2024-01-12T14:17:53Z",
      "updated_at": "2024-01-12T14:23:43Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29179#discussion_r1450510108",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1450510108"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29179"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 71,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1450510684",
      "pull_request_review_id": 1818360048,
      "id": 1450510684,
      "node_id": "PRRC_kwDOABII585WdQlc",
      "diff_hunk": "@@ -0,0 +1,98 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2024 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"Test that descriptor wallets rescan mempool transactions properly when importing.\"\"\"\n+\n+from test_framework.address import (\n+    address_to_scriptpubkey,\n+    ADDRESS_BCRT1_UNSPENDABLE,\n+)\n+from test_framework.blocktools import COINBASE_MATURITY\n+from test_framework.test_framework import BitcoinTestFramework\n+from test_framework.util import assert_equal\n+from test_framework.wallet import MiniWallet\n+from test_framework.wallet_util import test_address\n+\n+\n+class WalletRescanUnconfirmed(BitcoinTestFramework):\n+    def add_options(self, parser):\n+        self.add_wallet_options(parser, legacy=False)\n+\n+    def set_test_params(self):\n+        self.num_nodes = 3\n+        # Immediate tx relay\n+        self.extra_args = [['-whitelist=noban@127.0.0.1']] * self.num_nodes\n+\n+    def skip_test_if_missing_module(self):\n+        self.skip_if_no_wallet()\n+        self.skip_if_no_sqlite()\n+\n+    def run_test(self):\n+        # Node which we will use to send funds to the wallet and mine blocks\n+        tester_node = self.nodes[0]\n+        # Node on which the wallet is originally created\n+        orig_wallet_node = self.nodes[1]\n+        # Node which will import the wallet and rescan blocks / mempool for transactions\n+        import_wallet_node = self.nodes[2]\n+\n+\n+        self.log.info(\"Create wallets and mine initial chain\")\n+        tester_wallet = MiniWallet(tester_node)\n+        self.generate(tester_wallet, COINBASE_MATURITY)\n+\n+        orig_wallet_node.createwallet(wallet_name='w0', disable_private_keys=False, descriptors=True)\n+        w0 = orig_wallet_node.get_wallet_rpc('w0')\n+\n+        self.log.info(\"Create a parent tx and mine it in a block that will later be disconnected\")\n+        parent_amount = 100000\n+        parent_address = w0.getnewaddress()\n+        tx_parent_to_reorg = tester_wallet.send_to(\n+            from_node=tester_node,\n+            scriptPubKey=address_to_scriptpubkey(parent_address),\n+            amount=parent_amount,\n+        )\n+        assert tx_parent_to_reorg[\"txid\"] in tester_node.getrawmempool()\n+        block_to_reorg = self.generate(tester_node, 1)[0]\n+        assert_equal(len(tester_node.getrawmempool()), 0)\n+        assert_equal(w0.gettransaction(tx_parent_to_reorg[\"txid\"])[\"confirmations\"], 1)\n+\n+        # Create an unconfirmed child transaction from the parent tx, sending all\n+        # the funds to an unspendable address. Importantly, no change output is created so the\n+        # transaction can't be recognized using its outputs. The wallet rescan needs to know the\n+        # inputs of the transaction to detect it, so the parent must be processed before the child.\n+        w0_utxos = w0.listunspent()\n+\n+        self.log.info(\"Create a child tx and wait for it to propagate to all mempools\")\n+        # The only UTXO available to spend is tx_parent_to_reorg.\n+        assert_equal(len(w0_utxos), 1)\n+        assert_equal(w0_utxos[0][\"txid\"], tx_parent_to_reorg[\"txid\"])\n+        tx_child_unconfirmed_sweep = w0.sendall([ADDRESS_BCRT1_UNSPENDABLE])\n+        self.sync_all()\n+        assert tx_child_unconfirmed_sweep[\"txid\"] in tester_node.getrawmempool()\n+        assert tx_child_unconfirmed_sweep[\"txid\"] in import_wallet_node.getrawmempool()\n+\n+        self.log.info(\"Mock a reorg, causing parent to re-enter mempools after its child\")\n+        for node in self.nodes:\n+            node.invalidateblock(block_to_reorg)\n+            assert tx_parent_to_reorg[\"txid\"] in node.getrawmempool()\n+\n+        self.log.info(\"Import descriptor wallet on another node\")\n+        descriptors_to_import = []\n+        for item in w0.listdescriptors()[\"descriptors\"]:\n+            # use timestamp 0 to tell wallet to rescan entire chain\n+            if not item[\"internal\"]:\n+                descriptors_to_import.append({\"desc\": item[\"desc\"], \"timestamp\": 0, \"label\": \"w0 import\"})",
      "path": "test/functional/wallet_rescan_unconfirmed.py",
      "position": null,
      "original_position": 85,
      "commit_id": "df30247705940c50c5eaafd74e2abbeb8b0cec07",
      "original_commit_id": "c39e82926a3740642f8f1bb72c6b10b67a6dc724",
      "in_reply_to_id": 1450376850,
      "user": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "nice, taken",
      "created_at": "2024-01-12T14:18:25Z",
      "updated_at": "2024-01-12T14:23:43Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29179#discussion_r1450510684",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1450510684"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29179"
        }
      },
      "start_line": null,
      "original_start_line": 81,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 85,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1450511111",
      "pull_request_review_id": 1818360048,
      "id": 1450511111,
      "node_id": "PRRC_kwDOABII585WdQsH",
      "diff_hunk": "@@ -0,0 +1,98 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2024 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"Test that descriptor wallets rescan mempool transactions properly when importing.\"\"\"\n+\n+from test_framework.address import (\n+    address_to_scriptpubkey,\n+    ADDRESS_BCRT1_UNSPENDABLE,\n+)\n+from test_framework.blocktools import COINBASE_MATURITY\n+from test_framework.test_framework import BitcoinTestFramework\n+from test_framework.util import assert_equal\n+from test_framework.wallet import MiniWallet\n+from test_framework.wallet_util import test_address\n+\n+\n+class WalletRescanUnconfirmed(BitcoinTestFramework):\n+    def add_options(self, parser):\n+        self.add_wallet_options(parser, legacy=False)\n+\n+    def set_test_params(self):\n+        self.num_nodes = 3\n+        # Immediate tx relay\n+        self.extra_args = [['-whitelist=noban@127.0.0.1']] * self.num_nodes\n+\n+    def skip_test_if_missing_module(self):\n+        self.skip_if_no_wallet()\n+        self.skip_if_no_sqlite()\n+\n+    def run_test(self):\n+        # Node which we will use to send funds to the wallet and mine blocks\n+        tester_node = self.nodes[0]\n+        # Node on which the wallet is originally created\n+        orig_wallet_node = self.nodes[1]\n+        # Node which will import the wallet and rescan blocks / mempool for transactions\n+        import_wallet_node = self.nodes[2]\n+\n+\n+        self.log.info(\"Create wallets and mine initial chain\")\n+        tester_wallet = MiniWallet(tester_node)\n+        self.generate(tester_wallet, COINBASE_MATURITY)\n+\n+        orig_wallet_node.createwallet(wallet_name='w0', disable_private_keys=False, descriptors=True)\n+        w0 = orig_wallet_node.get_wallet_rpc('w0')\n+\n+        self.log.info(\"Create a parent tx and mine it in a block that will later be disconnected\")\n+        parent_amount = 100000\n+        parent_address = w0.getnewaddress()\n+        tx_parent_to_reorg = tester_wallet.send_to(\n+            from_node=tester_node,\n+            scriptPubKey=address_to_scriptpubkey(parent_address),\n+            amount=parent_amount,\n+        )\n+        assert tx_parent_to_reorg[\"txid\"] in tester_node.getrawmempool()\n+        block_to_reorg = self.generate(tester_node, 1)[0]\n+        assert_equal(len(tester_node.getrawmempool()), 0)\n+        assert_equal(w0.gettransaction(tx_parent_to_reorg[\"txid\"])[\"confirmations\"], 1)\n+\n+        # Create an unconfirmed child transaction from the parent tx, sending all\n+        # the funds to an unspendable address. Importantly, no change output is created so the\n+        # transaction can't be recognized using its outputs. The wallet rescan needs to know the\n+        # inputs of the transaction to detect it, so the parent must be processed before the child.\n+        w0_utxos = w0.listunspent()\n+\n+        self.log.info(\"Create a child tx and wait for it to propagate to all mempools\")\n+        # The only UTXO available to spend is tx_parent_to_reorg.\n+        assert_equal(len(w0_utxos), 1)\n+        assert_equal(w0_utxos[0][\"txid\"], tx_parent_to_reorg[\"txid\"])\n+        tx_child_unconfirmed_sweep = w0.sendall([ADDRESS_BCRT1_UNSPENDABLE])\n+        self.sync_all()\n+        assert tx_child_unconfirmed_sweep[\"txid\"] in tester_node.getrawmempool()\n+        assert tx_child_unconfirmed_sweep[\"txid\"] in import_wallet_node.getrawmempool()\n+\n+        self.log.info(\"Mock a reorg, causing parent to re-enter mempools after its child\")\n+        for node in self.nodes:\n+            node.invalidateblock(block_to_reorg)\n+            assert tx_parent_to_reorg[\"txid\"] in node.getrawmempool()\n+\n+        self.log.info(\"Import descriptor wallet on another node\")\n+        descriptors_to_import = []\n+        for item in w0.listdescriptors()[\"descriptors\"]:\n+            # use timestamp 0 to tell wallet to rescan entire chain\n+            if not item[\"internal\"]:\n+                descriptors_to_import.append({\"desc\": item[\"desc\"], \"timestamp\": 0, \"label\": \"w0 import\"})\n+        import_wallet_node.createwallet(wallet_name=\"w1\", disable_private_keys=True, blank=True, descriptors=True)",
      "path": "test/functional/wallet_rescan_unconfirmed.py",
      "position": null,
      "original_position": 86,
      "commit_id": "df30247705940c50c5eaafd74e2abbeb8b0cec07",
      "original_commit_id": "c39e82926a3740642f8f1bb72c6b10b67a6dc724",
      "in_reply_to_id": 1450366154,
      "user": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "dropped the args",
      "created_at": "2024-01-12T14:18:49Z",
      "updated_at": "2024-01-12T14:23:43Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29179#discussion_r1450511111",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1450511111"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29179"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 86,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1450512137",
      "pull_request_review_id": 1818360048,
      "id": 1450512137,
      "node_id": "PRRC_kwDOABII585WdQ8J",
      "diff_hunk": "@@ -0,0 +1,98 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2024 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"Test that descriptor wallets rescan mempool transactions properly when importing.\"\"\"\n+\n+from test_framework.address import (\n+    address_to_scriptpubkey,\n+    ADDRESS_BCRT1_UNSPENDABLE,\n+)\n+from test_framework.blocktools import COINBASE_MATURITY\n+from test_framework.test_framework import BitcoinTestFramework\n+from test_framework.util import assert_equal\n+from test_framework.wallet import MiniWallet\n+from test_framework.wallet_util import test_address\n+\n+\n+class WalletRescanUnconfirmed(BitcoinTestFramework):\n+    def add_options(self, parser):\n+        self.add_wallet_options(parser, legacy=False)\n+\n+    def set_test_params(self):\n+        self.num_nodes = 3\n+        # Immediate tx relay\n+        self.extra_args = [['-whitelist=noban@127.0.0.1']] * self.num_nodes\n+\n+    def skip_test_if_missing_module(self):\n+        self.skip_if_no_wallet()\n+        self.skip_if_no_sqlite()\n+\n+    def run_test(self):\n+        # Node which we will use to send funds to the wallet and mine blocks\n+        tester_node = self.nodes[0]\n+        # Node on which the wallet is originally created\n+        orig_wallet_node = self.nodes[1]\n+        # Node which will import the wallet and rescan blocks / mempool for transactions\n+        import_wallet_node = self.nodes[2]\n+\n+\n+        self.log.info(\"Create wallets and mine initial chain\")\n+        tester_wallet = MiniWallet(tester_node)\n+        self.generate(tester_wallet, COINBASE_MATURITY)\n+\n+        orig_wallet_node.createwallet(wallet_name='w0', disable_private_keys=False, descriptors=True)",
      "path": "test/functional/wallet_rescan_unconfirmed.py",
      "position": null,
      "original_position": 44,
      "commit_id": "df30247705940c50c5eaafd74e2abbeb8b0cec07",
      "original_commit_id": "c39e82926a3740642f8f1bb72c6b10b67a6dc724",
      "in_reply_to_id": 1450354940,
      "user": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "dropped the extra args (though I tend to prefer being a bit more verbose and self-documenting)",
      "created_at": "2024-01-12T14:19:38Z",
      "updated_at": "2024-01-12T14:29:06Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29179#discussion_r1450512137",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1450512137"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29179"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 44,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1450514108",
      "pull_request_review_id": 1818360048,
      "id": 1450514108,
      "node_id": "PRRC_kwDOABII585WdRa8",
      "diff_hunk": "@@ -0,0 +1,98 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2024 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"Test that descriptor wallets rescan mempool transactions properly when importing.\"\"\"\n+\n+from test_framework.address import (\n+    address_to_scriptpubkey,\n+    ADDRESS_BCRT1_UNSPENDABLE,\n+)\n+from test_framework.blocktools import COINBASE_MATURITY\n+from test_framework.test_framework import BitcoinTestFramework\n+from test_framework.util import assert_equal\n+from test_framework.wallet import MiniWallet\n+from test_framework.wallet_util import test_address\n+\n+\n+class WalletRescanUnconfirmed(BitcoinTestFramework):\n+    def add_options(self, parser):\n+        self.add_wallet_options(parser, legacy=False)\n+\n+    def set_test_params(self):\n+        self.num_nodes = 3\n+        # Immediate tx relay\n+        self.extra_args = [['-whitelist=noban@127.0.0.1']] * self.num_nodes\n+\n+    def skip_test_if_missing_module(self):\n+        self.skip_if_no_wallet()\n+        self.skip_if_no_sqlite()\n+\n+    def run_test(self):\n+        # Node which we will use to send funds to the wallet and mine blocks\n+        tester_node = self.nodes[0]\n+        # Node on which the wallet is originally created\n+        orig_wallet_node = self.nodes[1]\n+        # Node which will import the wallet and rescan blocks / mempool for transactions\n+        import_wallet_node = self.nodes[2]\n+\n+\n+        self.log.info(\"Create wallets and mine initial chain\")\n+        tester_wallet = MiniWallet(tester_node)\n+        self.generate(tester_wallet, COINBASE_MATURITY)",
      "path": "test/functional/wallet_rescan_unconfirmed.py",
      "position": null,
      "original_position": 42,
      "commit_id": "df30247705940c50c5eaafd74e2abbeb8b0cec07",
      "original_commit_id": "c39e82926a3740642f8f1bb72c6b10b67a6dc724",
      "in_reply_to_id": 1450417390,
      "user": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "Keeping as is because I prefer the peace of mind of knowing `tester_wallet` has a mature coinbase.",
      "created_at": "2024-01-12T14:21:09Z",
      "updated_at": "2024-01-12T14:23:43Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29179#discussion_r1450514108",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1450514108"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29179"
        }
      },
      "start_line": null,
      "original_start_line": 41,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 42,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1450532808",
      "pull_request_review_id": 1818398576,
      "id": 1450532808,
      "node_id": "PRRC_kwDOABII585WdV_I",
      "diff_hunk": "@@ -0,0 +1,98 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2024 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"Test that descriptor wallets rescan mempool transactions properly when importing.\"\"\"\n+\n+from test_framework.address import (\n+    address_to_scriptpubkey,\n+    ADDRESS_BCRT1_UNSPENDABLE,\n+)\n+from test_framework.blocktools import COINBASE_MATURITY\n+from test_framework.test_framework import BitcoinTestFramework\n+from test_framework.util import assert_equal\n+from test_framework.wallet import MiniWallet\n+from test_framework.wallet_util import test_address\n+\n+\n+class WalletRescanUnconfirmed(BitcoinTestFramework):\n+    def add_options(self, parser):\n+        self.add_wallet_options(parser, legacy=False)\n+\n+    def set_test_params(self):\n+        self.num_nodes = 3\n+        # Immediate tx relay\n+        self.extra_args = [['-whitelist=noban@127.0.0.1']] * self.num_nodes\n+\n+    def skip_test_if_missing_module(self):\n+        self.skip_if_no_wallet()\n+        self.skip_if_no_sqlite()\n+\n+    def run_test(self):\n+        # Node which we will use to send funds to the wallet and mine blocks\n+        tester_node = self.nodes[0]\n+        # Node on which the wallet is originally created\n+        orig_wallet_node = self.nodes[1]\n+        # Node which will import the wallet and rescan blocks / mempool for transactions\n+        import_wallet_node = self.nodes[2]\n+\n+\n+        self.log.info(\"Create wallets and mine initial chain\")\n+        tester_wallet = MiniWallet(tester_node)\n+        self.generate(tester_wallet, COINBASE_MATURITY)",
      "path": "test/functional/wallet_rescan_unconfirmed.py",
      "position": null,
      "original_position": 42,
      "commit_id": "df30247705940c50c5eaafd74e2abbeb8b0cec07",
      "original_commit_id": "c39e82926a3740642f8f1bb72c6b10b67a6dc724",
      "in_reply_to_id": 1450417390,
      "user": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "> Keeping as is because I prefer the peace of mind of knowing `tester_wallet` has a mature coinbase.\r\n\r\n~~You shouldn't be concerned about that. See [code](https://github.com/bitcoin/bitcoin/blob/3ba8de1b704d590fa4e1975620bd21d830d11666/test/functional/test_framework/test_framework.py#L381). If the wallet wouldn't be having mature coins, the test would be always failing due a lack of funds.~~\r\n\r\nor well, np. Its fine.",
      "created_at": "2024-01-12T14:35:53Z",
      "updated_at": "2024-01-12T14:37:44Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29179#discussion_r1450532808",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1450532808"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29179"
        }
      },
      "start_line": null,
      "original_start_line": 41,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 42,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1450547499",
      "pull_request_review_id": 1818430360,
      "id": 1450547499,
      "node_id": "PRRC_kwDOABII585WdZkr",
      "diff_hunk": "@@ -0,0 +1,98 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2024 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"Test that descriptor wallets rescan mempool transactions properly when importing.\"\"\"\n+\n+from test_framework.address import (\n+    address_to_scriptpubkey,\n+    ADDRESS_BCRT1_UNSPENDABLE,\n+)\n+from test_framework.blocktools import COINBASE_MATURITY\n+from test_framework.test_framework import BitcoinTestFramework\n+from test_framework.util import assert_equal\n+from test_framework.wallet import MiniWallet\n+from test_framework.wallet_util import test_address\n+\n+\n+class WalletRescanUnconfirmed(BitcoinTestFramework):\n+    def add_options(self, parser):\n+        self.add_wallet_options(parser, legacy=False)\n+\n+    def set_test_params(self):\n+        self.num_nodes = 3\n+        # Immediate tx relay\n+        self.extra_args = [['-whitelist=noban@127.0.0.1']] * self.num_nodes\n+\n+    def skip_test_if_missing_module(self):\n+        self.skip_if_no_wallet()\n+        self.skip_if_no_sqlite()\n+\n+    def run_test(self):\n+        # Node which we will use to send funds to the wallet and mine blocks\n+        tester_node = self.nodes[0]\n+        # Node on which the wallet is originally created\n+        orig_wallet_node = self.nodes[1]\n+        # Node which will import the wallet and rescan blocks / mempool for transactions\n+        import_wallet_node = self.nodes[2]\n+\n+\n+        self.log.info(\"Create wallets and mine initial chain\")\n+        tester_wallet = MiniWallet(tester_node)\n+        self.generate(tester_wallet, COINBASE_MATURITY)",
      "path": "test/functional/wallet_rescan_unconfirmed.py",
      "position": null,
      "original_position": 42,
      "commit_id": "df30247705940c50c5eaafd74e2abbeb8b0cec07",
      "original_commit_id": "c39e82926a3740642f8f1bb72c6b10b67a6dc724",
      "in_reply_to_id": 1450417390,
      "user": {
        "login": "glozow",
        "id": 25183001,
        "node_id": "MDQ6VXNlcjI1MTgzMDAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/glozow",
        "html_url": "https://github.com/glozow",
        "followers_url": "https://api.github.com/users/glozow/followers",
        "following_url": "https://api.github.com/users/glozow/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/glozow/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/glozow/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
        "organizations_url": "https://api.github.com/users/glozow/orgs",
        "repos_url": "https://api.github.com/users/glozow/repos",
        "events_url": "https://api.github.com/users/glozow/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/glozow/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "Deleted this line altogether, there's no reason to generate 1 either.",
      "created_at": "2024-01-12T14:47:50Z",
      "updated_at": "2024-01-12T14:47:50Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29179#discussion_r1450547499",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1450547499"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29179"
        }
      },
      "start_line": null,
      "original_start_line": 41,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 42,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1450823229",
      "pull_request_review_id": 1818866732,
      "id": 1450823229,
      "node_id": "PRRC_kwDOABII585Wec49",
      "diff_hunk": "@@ -0,0 +1,83 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2024 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"Test that descriptor wallets rescan mempool transactions properly when importing.\"\"\"\n+\n+from test_framework.address import (\n+    address_to_scriptpubkey,\n+    ADDRESS_BCRT1_UNSPENDABLE,\n+)\n+from test_framework.messages import COIN\n+from test_framework.test_framework import BitcoinTestFramework\n+from test_framework.util import assert_equal\n+from test_framework.wallet import MiniWallet\n+from test_framework.wallet_util import test_address\n+\n+\n+class WalletRescanUnconfirmed(BitcoinTestFramework):\n+    def add_options(self, parser):\n+        self.add_wallet_options(parser, legacy=False)\n+\n+    def set_test_params(self):\n+        self.num_nodes = 1\n+\n+    def skip_test_if_missing_module(self):\n+        self.skip_if_no_wallet()\n+        self.skip_if_no_sqlite()\n+\n+    def run_test(self):\n+        self.log.info(\"Create wallets and mine initial chain\")\n+        node = self.nodes[0]\n+        tester_wallet = MiniWallet(node)\n+\n+        node.createwallet(wallet_name='w0', disable_private_keys=False)\n+        w0 = node.get_wallet_rpc('w0')\n+\n+        self.log.info(\"Create a parent tx and mine it in a block that will later be disconnected\")\n+        parent_address = w0.getnewaddress()\n+        tx_parent_to_reorg = tester_wallet.send_to(\n+            from_node=node,\n+            scriptPubKey=address_to_scriptpubkey(parent_address),\n+            amount=COIN,\n+        )\n+        assert tx_parent_to_reorg[\"txid\"] in node.getrawmempool()\n+        block_to_reorg = self.generate(tester_wallet, 1)[0]\n+        assert_equal(len(node.getrawmempool()), 0)\n+        node.syncwithvalidationinterfacequeue()\n+        assert_equal(w0.gettransaction(tx_parent_to_reorg[\"txid\"])[\"confirmations\"], 1)\n+\n+        # Create an unconfirmed child transaction from the parent tx, sending all\n+        # the funds to an unspendable address. Importantly, no change output is created so the\n+        # transaction can't be recognized using its outputs. The wallet rescan needs to know the\n+        # inputs of the transaction to detect it, so the parent must be processed before the child.\n+        w0_utxos = w0.listunspent()\n+\n+        self.log.info(\"Create a child tx and wait for it to propagate to all mempools\")",
      "path": "test/functional/wallet_rescan_unconfirmed.py",
      "position": 56,
      "original_position": 56,
      "commit_id": "df30247705940c50c5eaafd74e2abbeb8b0cec07",
      "original_commit_id": "df30247705940c50c5eaafd74e2abbeb8b0cec07",
      "in_reply_to_id": null,
      "user": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "nit:\r\nleftover\r\n```suggestion\r\n        self.log.info(\"Create a child tx and wait until all wallets are notified\")\r\n```",
      "created_at": "2024-01-12T19:03:57Z",
      "updated_at": "2024-01-12T19:07:02Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29179#discussion_r1450823229",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1450823229"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29179"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 56,
      "original_line": 56,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1450823884",
      "pull_request_review_id": 1818866732,
      "id": 1450823884,
      "node_id": "PRRC_kwDOABII585WedDM",
      "diff_hunk": "@@ -0,0 +1,83 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2024 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"Test that descriptor wallets rescan mempool transactions properly when importing.\"\"\"\n+\n+from test_framework.address import (\n+    address_to_scriptpubkey,\n+    ADDRESS_BCRT1_UNSPENDABLE,\n+)\n+from test_framework.messages import COIN\n+from test_framework.test_framework import BitcoinTestFramework\n+from test_framework.util import assert_equal\n+from test_framework.wallet import MiniWallet\n+from test_framework.wallet_util import test_address\n+\n+\n+class WalletRescanUnconfirmed(BitcoinTestFramework):\n+    def add_options(self, parser):\n+        self.add_wallet_options(parser, legacy=False)\n+\n+    def set_test_params(self):\n+        self.num_nodes = 1\n+\n+    def skip_test_if_missing_module(self):\n+        self.skip_if_no_wallet()\n+        self.skip_if_no_sqlite()\n+\n+    def run_test(self):\n+        self.log.info(\"Create wallets and mine initial chain\")\n+        node = self.nodes[0]\n+        tester_wallet = MiniWallet(node)\n+\n+        node.createwallet(wallet_name='w0', disable_private_keys=False)\n+        w0 = node.get_wallet_rpc('w0')\n+\n+        self.log.info(\"Create a parent tx and mine it in a block that will later be disconnected\")\n+        parent_address = w0.getnewaddress()\n+        tx_parent_to_reorg = tester_wallet.send_to(\n+            from_node=node,\n+            scriptPubKey=address_to_scriptpubkey(parent_address),\n+            amount=COIN,\n+        )\n+        assert tx_parent_to_reorg[\"txid\"] in node.getrawmempool()\n+        block_to_reorg = self.generate(tester_wallet, 1)[0]\n+        assert_equal(len(node.getrawmempool()), 0)\n+        node.syncwithvalidationinterfacequeue()\n+        assert_equal(w0.gettransaction(tx_parent_to_reorg[\"txid\"])[\"confirmations\"], 1)\n+\n+        # Create an unconfirmed child transaction from the parent tx, sending all\n+        # the funds to an unspendable address. Importantly, no change output is created so the\n+        # transaction can't be recognized using its outputs. The wallet rescan needs to know the\n+        # inputs of the transaction to detect it, so the parent must be processed before the child.\n+        w0_utxos = w0.listunspent()\n+\n+        self.log.info(\"Create a child tx and wait for it to propagate to all mempools\")\n+        # The only UTXO available to spend is tx_parent_to_reorg.\n+        assert_equal(len(w0_utxos), 1)\n+        assert_equal(w0_utxos[0][\"txid\"], tx_parent_to_reorg[\"txid\"])\n+        tx_child_unconfirmed_sweep = w0.sendall([ADDRESS_BCRT1_UNSPENDABLE])\n+        assert tx_child_unconfirmed_sweep[\"txid\"] in node.getrawmempool()\n+        node.syncwithvalidationinterfacequeue()\n+\n+        self.log.info(\"Mock a reorg, causing parent to re-enter mempools after its child\")\n+        node.invalidateblock(block_to_reorg)\n+        assert tx_parent_to_reorg[\"txid\"] in node.getrawmempool()\n+\n+        self.log.info(\"Import descriptor wallet on another node\")",
      "path": "test/functional/wallet_rescan_unconfirmed.py",
      "position": 68,
      "original_position": 68,
      "commit_id": "df30247705940c50c5eaafd74e2abbeb8b0cec07",
      "original_commit_id": "df30247705940c50c5eaafd74e2abbeb8b0cec07",
      "in_reply_to_id": null,
      "user": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "nit:\r\nleftover; should be \"import descriptor on another wallet\"",
      "created_at": "2024-01-12T19:04:49Z",
      "updated_at": "2024-01-12T19:07:02Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29179#discussion_r1450823884",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1450823884"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29179"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 68,
      "original_line": 68,
      "side": "RIGHT"
    }
  ]
}
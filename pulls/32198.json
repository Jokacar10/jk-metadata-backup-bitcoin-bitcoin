{
  "type": "pull",
  "pull": {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/32198",
    "id": 2433458040,
    "node_id": "PR_kwDOABII586RC594",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/32198",
    "diff_url": "https://github.com/bitcoin/bitcoin/pull/32198.diff",
    "patch_url": "https://github.com/bitcoin/bitcoin/pull/32198.patch",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/32198",
    "commits_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/32198/commits",
    "review_comments_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/32198/comments",
    "review_comment_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments%7B/number%7D",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/32198/comments",
    "statuses_url": "https://api.github.com/repos/bitcoin/bitcoin/statuses/faa3ce31998cdbdcb888132b0d38ee7a1e743682",
    "number": 32198,
    "state": "open",
    "locked": false,
    "maintainer_can_modify": true,
    "title": "fuzz: Make p2p_headers_presync more deterministic",
    "user": {
      "login": "maflcko",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/maflcko",
      "html_url": "https://github.com/maflcko",
      "followers_url": "https://api.github.com/users/maflcko/followers",
      "following_url": "https://api.github.com/users/maflcko/following%7B/other_user%7D",
      "gists_url": "https://api.github.com/users/maflcko/gists%7B/gist_id%7D",
      "starred_url": "https://api.github.com/users/maflcko/starred%7B/owner%7D%7B/repo%7D",
      "subscriptions_url": "https://api.github.com/users/maflcko/subscriptions",
      "organizations_url": "https://api.github.com/users/maflcko/orgs",
      "repos_url": "https://api.github.com/users/maflcko/repos",
      "events_url": "https://api.github.com/users/maflcko/events%7B/privacy%7D",
      "received_events_url": "https://api.github.com/users/maflcko/received_events",
      "type": "User",
      "site_admin": false,
      "patch_url": null
    },
    "body": "This should make the `p2p_headers_presync` fuzz target more deterministic.\r\n\r\nTracking issue: https://github.com/bitcoin/bitcoin/issues/29018.\r\n\r\nThe first commits adds an `ElapseSteady` helper and type aliases. The second commit uses those helpers in `ReportHeadersPresync` and in the fuzz target to increase determinism.\r\n\r\n### Testing\r\n\r\nIt can be tested via (setting 32 parallel threads):\r\n\r\n```\r\ncargo run --manifest-path ./contrib/devtools/deterministic-fuzz-coverage/Cargo.toml -- $PWD/bld-cmake/ $PWD/../b-c-qa-assets/fuzz_corpora/ p2p_headers_presync 32\r\n```\r\n\r\nThe failing diff is contained in the commit messages, if applicable.",
    "labels": [
      {
        "id": 62963516,
        "node_id": "MDU6TGFiZWw2Mjk2MzUxNg==",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Tests",
        "name": "Tests",
        "color": "d4c5f9",
        "default": false
      }
    ],
    "created_at": "2025-04-02T08:14:59Z",
    "updated_at": "2025-04-10T12:40:28Z",
    "mergeable": true,
    "mergeable_state": "blocked",
    "merged": false,
    "merge_commit_sha": "5e4e3b97ad9e86ad61c2ad9b5311090b170f3e31",
    "assignees": [],
    "requested_reviewers": [],
    "requested_teams": [],
    "rebaseable": true,
    "head": {
      "label": "maflcko:2503-fuzz-det",
      "ref": "2503-fuzz-det",
      "sha": "faa3ce31998cdbdcb888132b0d38ee7a1e743682",
      "user": {
        "login": "maflcko",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/maflcko",
        "html_url": "https://github.com/maflcko",
        "followers_url": "https://api.github.com/users/maflcko/followers",
        "following_url": "https://api.github.com/users/maflcko/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/maflcko/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/maflcko/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/maflcko/subscriptions",
        "organizations_url": "https://api.github.com/users/maflcko/orgs",
        "repos_url": "https://api.github.com/users/maflcko/repos",
        "events_url": "https://api.github.com/users/maflcko/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/maflcko/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "repo": {
        "id": 40046254,
        "node_id": "MDEwOlJlcG9zaXRvcnk0MDA0NjI1NA==",
        "name": "bitcoin-core",
        "full_name": "maflcko/bitcoin-core",
        "owner": {
          "login": "maflcko",
          "id": 6399679,
          "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
          "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
          "gravatar_id": "",
          "url": "https://api.github.com/users/maflcko",
          "html_url": "https://github.com/maflcko",
          "followers_url": "https://api.github.com/users/maflcko/followers",
          "following_url": "https://api.github.com/users/maflcko/following%7B/other_user%7D",
          "gists_url": "https://api.github.com/users/maflcko/gists%7B/gist_id%7D",
          "starred_url": "https://api.github.com/users/maflcko/starred%7B/owner%7D%7B/repo%7D",
          "subscriptions_url": "https://api.github.com/users/maflcko/subscriptions",
          "organizations_url": "https://api.github.com/users/maflcko/orgs",
          "repos_url": "https://api.github.com/users/maflcko/repos",
          "events_url": "https://api.github.com/users/maflcko/events%7B/privacy%7D",
          "received_events_url": "https://api.github.com/users/maflcko/received_events",
          "type": "User",
          "site_admin": false,
          "patch_url": null
        },
        "private": false,
        "html_url": "https://github.com/maflcko/bitcoin-core",
        "fork": true,
        "url": "https://api.github.com/repos/maflcko/bitcoin-core",
        "archive_url": "https://api.github.com/repos/maflcko/bitcoin-core/%7Barchive_format%7D%7B/ref%7D",
        "assignees_url": "https://api.github.com/repos/maflcko/bitcoin-core/assignees%7B/user%7D",
        "blobs_url": "https://api.github.com/repos/maflcko/bitcoin-core/git/blobs%7B/sha%7D",
        "branches_url": "https://api.github.com/repos/maflcko/bitcoin-core/branches%7B/branch%7D",
        "collaborators_url": "https://api.github.com/repos/maflcko/bitcoin-core/collaborators%7B/collaborator%7D",
        "comments_url": "https://api.github.com/repos/maflcko/bitcoin-core/comments%7B/number%7D",
        "commits_url": "https://api.github.com/repos/maflcko/bitcoin-core/commits%7B/sha%7D",
        "compare_url": "https://api.github.com/repos/maflcko/bitcoin-core/compare/%7Bbase%7D...%7Bhead%7D",
        "contents_url": "https://api.github.com/repos/maflcko/bitcoin-core/contents/%7B+path%7D",
        "contributors_url": "https://api.github.com/repos/maflcko/bitcoin-core/contributors",
        "deployments_url": "https://api.github.com/repos/maflcko/bitcoin-core/deployments",
        "downloads_url": "https://api.github.com/repos/maflcko/bitcoin-core/downloads",
        "events_url": "https://api.github.com/repos/maflcko/bitcoin-core/events",
        "forks_url": "https://api.github.com/repos/maflcko/bitcoin-core/forks",
        "git_commits_url": "https://api.github.com/repos/maflcko/bitcoin-core/git/commits%7B/sha%7D",
        "git_refs_url": "https://api.github.com/repos/maflcko/bitcoin-core/git/refs%7B/sha%7D",
        "git_tags_url": "https://api.github.com/repos/maflcko/bitcoin-core/git/tags%7B/sha%7D",
        "git_url": "git://github.com/maflcko/bitcoin-core.git",
        "issue_comment_url": "https://api.github.com/repos/maflcko/bitcoin-core/issues/comments%7B/number%7D",
        "issue_events_url": "https://api.github.com/repos/maflcko/bitcoin-core/issues/events%7B/number%7D",
        "issues_url": "https://api.github.com/repos/maflcko/bitcoin-core/issues%7B/number%7D",
        "keys_url": "https://api.github.com/repos/maflcko/bitcoin-core/keys%7B/key_id%7D",
        "labels_url": "https://api.github.com/repos/maflcko/bitcoin-core/labels%7B/name%7D",
        "languages_url": "https://api.github.com/repos/maflcko/bitcoin-core/languages",
        "merges_url": "https://api.github.com/repos/maflcko/bitcoin-core/merges",
        "milestones_url": "https://api.github.com/repos/maflcko/bitcoin-core/milestones%7B/number%7D",
        "notifications_url": "https://api.github.com/repos/maflcko/bitcoin-core/notifications%7B?since,all,participating}",
        "pulls_url": "https://api.github.com/repos/maflcko/bitcoin-core/pulls%7B/number%7D",
        "releases_url": "https://api.github.com/repos/maflcko/bitcoin-core/releases%7B/id%7D",
        "ssh_url": "git@github.com:maflcko/bitcoin-core.git",
        "stargazers_url": "https://api.github.com/repos/maflcko/bitcoin-core/stargazers",
        "statuses_url": "https://api.github.com/repos/maflcko/bitcoin-core/statuses/%7Bsha%7D",
        "subscribers_url": "https://api.github.com/repos/maflcko/bitcoin-core/subscribers",
        "subscription_url": "https://api.github.com/repos/maflcko/bitcoin-core/subscription",
        "tags_url": "https://api.github.com/repos/maflcko/bitcoin-core/tags",
        "teams_url": "https://api.github.com/repos/maflcko/bitcoin-core/teams",
        "trees_url": "https://api.github.com/repos/maflcko/bitcoin-core/git/trees%7B/sha%7D",
        "clone_url": "https://github.com/maflcko/bitcoin-core.git",
        "hooks_url": "https://api.github.com/repos/maflcko/bitcoin-core/hooks",
        "svn_url": "https://github.com/maflcko/bitcoin-core",
        "homepage": "",
        "language": "C++",
        "forks_count": 9,
        "stargazers_count": 27,
        "watchers_count": 27,
        "size": 247640,
        "default_branch": "master",
        "open_issues_count": 14,
        "is_template": false,
        "topics": [],
        "has_issues": true,
        "has_projects": true,
        "has_wiki": false,
        "has_pages": false,
        "has_downloads": false,
        "archived": false,
        "disabled": false,
        "visibility": "public",
        "pushed_at": "2025-04-09T18:07:19Z",
        "created_at": "2015-08-01T12:42:47Z",
        "updated_at": "2025-01-22T17:43:41Z",
        "allow_forking": true,
        "license": {
          "key": "mit",
          "name": "MIT License",
          "node_id": "MDc6TGljZW5zZTEz",
          "spdx_id": "MIT",
          "url": "https://api.github.com/licenses/mit",
          "html_url": null,
          "description": null,
          "implementation": null,
          "permissions": null,
          "conditions": null,
          "limitations": null,
          "body": null,
          "featured": null
        }
      }
    },
    "base": {
      "label": "bitcoin:master",
      "ref": "master",
      "sha": "bb92bb36f211b88e4c1aa031a4364795cbd24767",
      "user": {
        "login": "bitcoin",
        "id": 528860,
        "node_id": "MDEyOk9yZ2FuaXphdGlvbjUyODg2MA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/528860?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/bitcoin",
        "html_url": "https://github.com/bitcoin",
        "followers_url": "https://api.github.com/users/bitcoin/followers",
        "following_url": "https://api.github.com/users/bitcoin/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/bitcoin/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/bitcoin/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/bitcoin/subscriptions",
        "organizations_url": "https://api.github.com/users/bitcoin/orgs",
        "repos_url": "https://api.github.com/users/bitcoin/repos",
        "events_url": "https://api.github.com/users/bitcoin/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/bitcoin/received_events",
        "type": "Organization",
        "site_admin": false,
        "patch_url": null
      },
      "repo": {
        "id": 1181927,
        "node_id": "MDEwOlJlcG9zaXRvcnkxMTgxOTI3",
        "name": "bitcoin",
        "full_name": "bitcoin/bitcoin",
        "owner": {
          "login": "bitcoin",
          "id": 528860,
          "node_id": "MDEyOk9yZ2FuaXphdGlvbjUyODg2MA==",
          "avatar_url": "https://avatars.githubusercontent.com/u/528860?v=4",
          "gravatar_id": "",
          "url": "https://api.github.com/users/bitcoin",
          "html_url": "https://github.com/bitcoin",
          "followers_url": "https://api.github.com/users/bitcoin/followers",
          "following_url": "https://api.github.com/users/bitcoin/following%7B/other_user%7D",
          "gists_url": "https://api.github.com/users/bitcoin/gists%7B/gist_id%7D",
          "starred_url": "https://api.github.com/users/bitcoin/starred%7B/owner%7D%7B/repo%7D",
          "subscriptions_url": "https://api.github.com/users/bitcoin/subscriptions",
          "organizations_url": "https://api.github.com/users/bitcoin/orgs",
          "repos_url": "https://api.github.com/users/bitcoin/repos",
          "events_url": "https://api.github.com/users/bitcoin/events%7B/privacy%7D",
          "received_events_url": "https://api.github.com/users/bitcoin/received_events",
          "type": "Organization",
          "site_admin": false,
          "patch_url": null
        },
        "private": false,
        "html_url": "https://github.com/bitcoin/bitcoin",
        "description": "Bitcoin Core integration/staging tree",
        "fork": false,
        "url": "https://api.github.com/repos/bitcoin/bitcoin",
        "archive_url": "https://api.github.com/repos/bitcoin/bitcoin/%7Barchive_format%7D%7B/ref%7D",
        "assignees_url": "https://api.github.com/repos/bitcoin/bitcoin/assignees%7B/user%7D",
        "blobs_url": "https://api.github.com/repos/bitcoin/bitcoin/git/blobs%7B/sha%7D",
        "branches_url": "https://api.github.com/repos/bitcoin/bitcoin/branches%7B/branch%7D",
        "collaborators_url": "https://api.github.com/repos/bitcoin/bitcoin/collaborators%7B/collaborator%7D",
        "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/comments%7B/number%7D",
        "commits_url": "https://api.github.com/repos/bitcoin/bitcoin/commits%7B/sha%7D",
        "compare_url": "https://api.github.com/repos/bitcoin/bitcoin/compare/%7Bbase%7D...%7Bhead%7D",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/%7B+path%7D",
        "contributors_url": "https://api.github.com/repos/bitcoin/bitcoin/contributors",
        "deployments_url": "https://api.github.com/repos/bitcoin/bitcoin/deployments",
        "downloads_url": "https://api.github.com/repos/bitcoin/bitcoin/downloads",
        "events_url": "https://api.github.com/repos/bitcoin/bitcoin/events",
        "forks_url": "https://api.github.com/repos/bitcoin/bitcoin/forks",
        "git_commits_url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits%7B/sha%7D",
        "git_refs_url": "https://api.github.com/repos/bitcoin/bitcoin/git/refs%7B/sha%7D",
        "git_tags_url": "https://api.github.com/repos/bitcoin/bitcoin/git/tags%7B/sha%7D",
        "git_url": "git://github.com/bitcoin/bitcoin.git",
        "issue_comment_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments%7B/number%7D",
        "issue_events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events%7B/number%7D",
        "issues_url": "https://api.github.com/repos/bitcoin/bitcoin/issues%7B/number%7D",
        "keys_url": "https://api.github.com/repos/bitcoin/bitcoin/keys%7B/key_id%7D",
        "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/labels%7B/name%7D",
        "languages_url": "https://api.github.com/repos/bitcoin/bitcoin/languages",
        "merges_url": "https://api.github.com/repos/bitcoin/bitcoin/merges",
        "milestones_url": "https://api.github.com/repos/bitcoin/bitcoin/milestones%7B/number%7D",
        "notifications_url": "https://api.github.com/repos/bitcoin/bitcoin/notifications%7B?since,all,participating}",
        "pulls_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls%7B/number%7D",
        "releases_url": "https://api.github.com/repos/bitcoin/bitcoin/releases%7B/id%7D",
        "ssh_url": "git@github.com:bitcoin/bitcoin.git",
        "stargazers_url": "https://api.github.com/repos/bitcoin/bitcoin/stargazers",
        "statuses_url": "https://api.github.com/repos/bitcoin/bitcoin/statuses/%7Bsha%7D",
        "subscribers_url": "https://api.github.com/repos/bitcoin/bitcoin/subscribers",
        "subscription_url": "https://api.github.com/repos/bitcoin/bitcoin/subscription",
        "tags_url": "https://api.github.com/repos/bitcoin/bitcoin/tags",
        "teams_url": "https://api.github.com/repos/bitcoin/bitcoin/teams",
        "trees_url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees%7B/sha%7D",
        "clone_url": "https://github.com/bitcoin/bitcoin.git",
        "hooks_url": "https://api.github.com/repos/bitcoin/bitcoin/hooks",
        "svn_url": "https://github.com/bitcoin/bitcoin",
        "homepage": "https://bitcoincore.org/en/download",
        "language": "C++",
        "forks_count": 37025,
        "stargazers_count": 82840,
        "watchers_count": 82840,
        "size": 279518,
        "default_branch": "master",
        "open_issues_count": 696,
        "is_template": false,
        "topics": [
          "bitcoin",
          "c-plus-plus",
          "cryptocurrency",
          "cryptography",
          "p2p"
        ],
        "has_issues": true,
        "has_projects": true,
        "has_wiki": false,
        "has_pages": false,
        "has_downloads": false,
        "archived": false,
        "disabled": false,
        "visibility": "public",
        "pushed_at": "2025-04-10T11:30:25Z",
        "created_at": "2010-12-19T15:16:43Z",
        "updated_at": "2025-04-10T12:52:37Z",
        "allow_forking": true,
        "license": {
          "key": "mit",
          "name": "MIT License",
          "node_id": "MDc6TGljZW5zZTEz",
          "spdx_id": "MIT",
          "url": "https://api.github.com/licenses/mit",
          "html_url": null,
          "description": null,
          "implementation": null,
          "permissions": null,
          "conditions": null,
          "limitations": null,
          "body": null,
          "featured": null
        }
      }
    },
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/32198"
      }
    },
    "author_association": "MEMBER",
    "draft": false,
    "additions": 71,
    "deletions": 20,
    "changed_files": 10,
    "commits": 8,
    "review_comments": 0,
    "comments": 28
  },
  "events": [
    {
      "event": "commented",
      "id": 2771759511,
      "node_id": "IC_kwDOABII586lNbGX",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2771759511",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-04-02T08:15:02Z",
      "updated_at": "2025-04-10T12:40:27Z",
      "author_association": "CONTRIBUTOR",
      "body": "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--006a51241073e994b41acfe9ec718e94-->\n### Code Coverage & Benchmarks\nFor details see: https://corecheck.dev/bitcoin/bitcoin/pulls/32198.\n<!--021abf342d371248e50ceaed478a90ca-->\n### Reviews\nSee [the guideline](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#code-review) for information on the review process.\n| Type | Reviewers |\n| ---- | --------- |\n| ACK | [janb84](https://github.com/bitcoin/bitcoin/pull/32198#pullrequestreview-2754361720), [marcofleon](https://github.com/bitcoin/bitcoin/pull/32198#pullrequestreview-2755940116) |\n| Concept ACK | [1440000bytes](https://github.com/bitcoin/bitcoin/pull/32198#issuecomment-2773164435) |\n| Stale ACK | [Crypt-iQ](https://github.com/bitcoin/bitcoin/pull/32198#issuecomment-2792610624) |\n\nIf your review is incorrectly listed, please react with 👎 to this comment and the bot will ignore it on the next update.\n",
      "user": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32198#issuecomment-2771759511",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/32198"
    },
    {
      "event": "renamed",
      "id": 17088844832,
      "node_id": "RTE_lADOABII586wwtHgzwAAAAP6kxQg",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/17088844832",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-04-02T08:15:04Z",
      "rename": {
        "from": " fuzz: Make p2p_headers_presync more deterministic ",
        "to": "fuzz: Make p2p_headers_presync more deterministic"
      }
    },
    {
      "event": "labeled",
      "id": 17088845021,
      "node_id": "LE_lADOABII586wwtHgzwAAAAP6kxTd",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/17088845021",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-04-02T08:15:05Z",
      "label": {
        "name": "Tests",
        "color": "d4c5f9"
      }
    },
    {
      "event": "commented",
      "id": 2773164435,
      "node_id": "IC_kwDOABII586lSyGT",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2773164435",
      "actor": {
        "login": "1440000bytes",
        "id": 147166694,
        "node_id": "U_kgDOCMWV5g",
        "avatar_url": "https://avatars.githubusercontent.com/u/147166694?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/1440000bytes",
        "html_url": "https://github.com/1440000bytes",
        "followers_url": "https://api.github.com/users/1440000bytes/followers",
        "following_url": "https://api.github.com/users/1440000bytes/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/1440000bytes/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/1440000bytes/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/1440000bytes/subscriptions",
        "organizations_url": "https://api.github.com/users/1440000bytes/orgs",
        "repos_url": "https://api.github.com/users/1440000bytes/repos",
        "events_url": "https://api.github.com/users/1440000bytes/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/1440000bytes/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-04-02T16:46:51Z",
      "updated_at": "2025-04-02T16:46:51Z",
      "author_association": "NONE",
      "body": "Concept ACK",
      "user": {
        "login": "1440000bytes",
        "id": 147166694,
        "node_id": "U_kgDOCMWV5g",
        "avatar_url": "https://avatars.githubusercontent.com/u/147166694?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/1440000bytes",
        "html_url": "https://github.com/1440000bytes",
        "followers_url": "https://api.github.com/users/1440000bytes/followers",
        "following_url": "https://api.github.com/users/1440000bytes/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/1440000bytes/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/1440000bytes/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/1440000bytes/subscriptions",
        "organizations_url": "https://api.github.com/users/1440000bytes/orgs",
        "repos_url": "https://api.github.com/users/1440000bytes/repos",
        "events_url": "https://api.github.com/users/1440000bytes/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/1440000bytes/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32198#issuecomment-2773164435",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/32198"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 17099083429,
      "node_id": "HRFPE_lADOABII586wwtHgzwAAAAP7L06l",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/17099083429",
      "actor": {
        "login": "maflcko",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/maflcko",
        "html_url": "https://github.com/maflcko",
        "followers_url": "https://api.github.com/users/maflcko/followers",
        "following_url": "https://api.github.com/users/maflcko/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/maflcko/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/maflcko/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/maflcko/subscriptions",
        "organizations_url": "https://api.github.com/users/maflcko/orgs",
        "repos_url": "https://api.github.com/users/maflcko/repos",
        "events_url": "https://api.github.com/users/maflcko/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/maflcko/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": "2222dd8e60d82e5aa96f3d80a81ddca880d627ea",
      "commit_url": "https://api.github.com/repos/maflcko/bitcoin-core/commits/2222dd8e60d82e5aa96f3d80a81ddca880d627ea",
      "created_at": "2025-04-02T18:32:17Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 17100538081,
      "node_id": "HRFPE_lADOABII586wwtHgzwAAAAP7RYDh",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/17100538081",
      "actor": {
        "login": "maflcko",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/maflcko",
        "html_url": "https://github.com/maflcko",
        "followers_url": "https://api.github.com/users/maflcko/followers",
        "following_url": "https://api.github.com/users/maflcko/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/maflcko/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/maflcko/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/maflcko/subscriptions",
        "organizations_url": "https://api.github.com/users/maflcko/orgs",
        "repos_url": "https://api.github.com/users/maflcko/repos",
        "events_url": "https://api.github.com/users/maflcko/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/maflcko/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": "fa27b91aaa75d48cb1ed0f408682e069a733e7a0",
      "commit_url": "https://api.github.com/repos/maflcko/bitcoin-core/commits/fa27b91aaa75d48cb1ed0f408682e069a733e7a0",
      "created_at": "2025-04-02T20:23:49Z"
    },
    {
      "event": "commented",
      "id": 2774641646,
      "node_id": "IC_kwDOABII586lYavu",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2774641646",
      "actor": {
        "login": "maflcko",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/maflcko",
        "html_url": "https://github.com/maflcko",
        "followers_url": "https://api.github.com/users/maflcko/followers",
        "following_url": "https://api.github.com/users/maflcko/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/maflcko/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/maflcko/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/maflcko/subscriptions",
        "organizations_url": "https://api.github.com/users/maflcko/orgs",
        "repos_url": "https://api.github.com/users/maflcko/repos",
        "events_url": "https://api.github.com/users/maflcko/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/maflcko/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-04-03T06:41:01Z",
      "updated_at": "2025-04-03T06:41:01Z",
      "author_association": "MEMBER",
      "body": "I've run `cargo run --manifest-path ./contrib/devtools/deterministic-fuzz-coverage/Cargo.toml -- $PWD/bld-cmake/ $PWD/../qa-assets/fuzz_corpora/ p2p_headers_presync 32` 150 times and it passed, so I guess this is reasonably deterministic now.\r\n\r\nI've also force pushed to modify the commit messages with details.\r\n\r\nCoverage reports:\r\n\r\nhttps://drahtbot.space/host_reports/DrahtBot/reports/coverage_fuzz/monotree/fa27b91aaa75d48c/728b3feddc08afb3/fuzz.coverage/index.html\r\n\r\nhttps://drahtbot.space/host_reports/DrahtBot/reports/coverage_fuzz/monotree/77dff373a667a22d/728b3feddc08afb3/fuzz.coverage/index.html\r\n",
      "user": {
        "login": "maflcko",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/maflcko",
        "html_url": "https://github.com/maflcko",
        "followers_url": "https://api.github.com/users/maflcko/followers",
        "following_url": "https://api.github.com/users/maflcko/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/maflcko/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/maflcko/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/maflcko/subscriptions",
        "organizations_url": "https://api.github.com/users/maflcko/orgs",
        "repos_url": "https://api.github.com/users/maflcko/repos",
        "events_url": "https://api.github.com/users/maflcko/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/maflcko/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32198#issuecomment-2774641646",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/32198"
    },
    {
      "event": "commented",
      "id": 2776124054,
      "node_id": "IC_kwDOABII586leEqW",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2776124054",
      "actor": {
        "login": "marcofleon",
        "id": 95179662,
        "node_id": "U_kgDOBaxTjg",
        "avatar_url": "https://avatars.githubusercontent.com/u/95179662?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/marcofleon",
        "html_url": "https://github.com/marcofleon",
        "followers_url": "https://api.github.com/users/marcofleon/followers",
        "following_url": "https://api.github.com/users/marcofleon/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/marcofleon/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/marcofleon/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/marcofleon/subscriptions",
        "organizations_url": "https://api.github.com/users/marcofleon/orgs",
        "repos_url": "https://api.github.com/users/marcofleon/repos",
        "events_url": "https://api.github.com/users/marcofleon/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/marcofleon/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-04-03T15:10:39Z",
      "updated_at": "2025-04-03T15:13:48Z",
      "author_association": "CONTRIBUTOR",
      "body": "> 150 times and it passed\r\n\r\nWhen you say it passed, are you referring to running the inputs one by one, or including the full corpus run as well?\r\n\r\nI still see differences in coverage when running the full corpus, but the previous instability that this PR addresses doesn't seem to be showing up anymore, so that's good.",
      "user": {
        "login": "marcofleon",
        "id": 95179662,
        "node_id": "U_kgDOBaxTjg",
        "avatar_url": "https://avatars.githubusercontent.com/u/95179662?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/marcofleon",
        "html_url": "https://github.com/marcofleon",
        "followers_url": "https://api.github.com/users/marcofleon/followers",
        "following_url": "https://api.github.com/users/marcofleon/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/marcofleon/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/marcofleon/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/marcofleon/subscriptions",
        "organizations_url": "https://api.github.com/users/marcofleon/orgs",
        "repos_url": "https://api.github.com/users/marcofleon/repos",
        "events_url": "https://api.github.com/users/marcofleon/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/marcofleon/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32198#issuecomment-2776124054",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/32198"
    },
    {
      "event": "commented",
      "id": 2776167279,
      "node_id": "IC_kwDOABII586lePNv",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2776167279",
      "actor": {
        "login": "maflcko",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/maflcko",
        "html_url": "https://github.com/maflcko",
        "followers_url": "https://api.github.com/users/maflcko/followers",
        "following_url": "https://api.github.com/users/maflcko/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/maflcko/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/maflcko/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/maflcko/subscriptions",
        "organizations_url": "https://api.github.com/users/maflcko/orgs",
        "repos_url": "https://api.github.com/users/maflcko/repos",
        "events_url": "https://api.github.com/users/maflcko/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/maflcko/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-04-03T15:25:08Z",
      "updated_at": "2025-04-03T15:25:08Z",
      "author_association": "MEMBER",
      "body": "> When you say it passed, are you referring to running the inputs one by one, or including the full corpus run as well?\r\n\r\nBoth. (All of it in the full command)\r\n\r\n> I still see differences in coverage when running the full corpus, but the previous instability that this PR addresses doesn't seem to be showing up anymore, so that's good.\r\n\r\nAre you using libFuzzer?",
      "user": {
        "login": "maflcko",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/maflcko",
        "html_url": "https://github.com/maflcko",
        "followers_url": "https://api.github.com/users/maflcko/followers",
        "following_url": "https://api.github.com/users/maflcko/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/maflcko/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/maflcko/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/maflcko/subscriptions",
        "organizations_url": "https://api.github.com/users/maflcko/orgs",
        "repos_url": "https://api.github.com/users/maflcko/repos",
        "events_url": "https://api.github.com/users/maflcko/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/maflcko/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32198#issuecomment-2776167279",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/32198"
    },
    {
      "event": "commented",
      "id": 2776192107,
      "node_id": "IC_kwDOABII586leVRr",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2776192107",
      "actor": {
        "login": "marcofleon",
        "id": 95179662,
        "node_id": "U_kgDOBaxTjg",
        "avatar_url": "https://avatars.githubusercontent.com/u/95179662?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/marcofleon",
        "html_url": "https://github.com/marcofleon",
        "followers_url": "https://api.github.com/users/marcofleon/followers",
        "following_url": "https://api.github.com/users/marcofleon/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/marcofleon/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/marcofleon/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/marcofleon/subscriptions",
        "organizations_url": "https://api.github.com/users/marcofleon/orgs",
        "repos_url": "https://api.github.com/users/marcofleon/repos",
        "events_url": "https://api.github.com/users/marcofleon/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/marcofleon/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-04-03T15:30:04Z",
      "updated_at": "2025-04-03T15:30:04Z",
      "author_association": "CONTRIBUTOR",
      "body": "> Are you using libFuzzer?\r\n\r\nyeah just figured this out, disregard. Do you know why this is? What about libFuzzer trips it up?",
      "user": {
        "login": "marcofleon",
        "id": 95179662,
        "node_id": "U_kgDOBaxTjg",
        "avatar_url": "https://avatars.githubusercontent.com/u/95179662?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/marcofleon",
        "html_url": "https://github.com/marcofleon",
        "followers_url": "https://api.github.com/users/marcofleon/followers",
        "following_url": "https://api.github.com/users/marcofleon/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/marcofleon/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/marcofleon/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/marcofleon/subscriptions",
        "organizations_url": "https://api.github.com/users/marcofleon/orgs",
        "repos_url": "https://api.github.com/users/marcofleon/repos",
        "events_url": "https://api.github.com/users/marcofleon/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/marcofleon/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32198#issuecomment-2776192107",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/32198"
    },
    {
      "event": "commented",
      "id": 2776198218,
      "node_id": "IC_kwDOABII586leWxK",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2776198218",
      "actor": {
        "login": "maflcko",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/maflcko",
        "html_url": "https://github.com/maflcko",
        "followers_url": "https://api.github.com/users/maflcko/followers",
        "following_url": "https://api.github.com/users/maflcko/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/maflcko/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/maflcko/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/maflcko/subscriptions",
        "organizations_url": "https://api.github.com/users/maflcko/orgs",
        "repos_url": "https://api.github.com/users/maflcko/repos",
        "events_url": "https://api.github.com/users/maflcko/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/maflcko/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-04-03T15:32:25Z",
      "updated_at": "2025-04-03T15:32:25Z",
      "author_association": "MEMBER",
      "body": "Not sure yet. It could be libFuzzer and coverage instrumentation interacting in a bad way, but I have no idea. Maybe I can take a look later.",
      "user": {
        "login": "maflcko",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/maflcko",
        "html_url": "https://github.com/maflcko",
        "followers_url": "https://api.github.com/users/maflcko/followers",
        "following_url": "https://api.github.com/users/maflcko/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/maflcko/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/maflcko/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/maflcko/subscriptions",
        "organizations_url": "https://api.github.com/users/maflcko/orgs",
        "repos_url": "https://api.github.com/users/maflcko/repos",
        "events_url": "https://api.github.com/users/maflcko/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/maflcko/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32198#issuecomment-2776198218",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/32198"
    },
    {
      "event": "commented",
      "id": 2776408663,
      "node_id": "IC_kwDOABII586lfKJX",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2776408663",
      "actor": {
        "login": "marcofleon",
        "id": 95179662,
        "node_id": "U_kgDOBaxTjg",
        "avatar_url": "https://avatars.githubusercontent.com/u/95179662?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/marcofleon",
        "html_url": "https://github.com/marcofleon",
        "followers_url": "https://api.github.com/users/marcofleon/followers",
        "following_url": "https://api.github.com/users/marcofleon/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/marcofleon/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/marcofleon/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/marcofleon/subscriptions",
        "organizations_url": "https://api.github.com/users/marcofleon/orgs",
        "repos_url": "https://api.github.com/users/marcofleon/repos",
        "events_url": "https://api.github.com/users/marcofleon/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/marcofleon/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-04-03T16:54:04Z",
      "updated_at": "2025-04-03T17:01:08Z",
      "author_association": "CONTRIBUTOR",
      "body": "@dergoegge and I checked it out. Turns out libfuzzer shuffles the corpus, so running it twice with a different ordering of inputs can result in different coverage. On this PR, running with libFuzzer and setting `-shuffle=0` should produce no coverage differences for `p2p_headers_presync`. \r\n\r\nI think this is another sign of non-determinism, as the ordering shouldn't affect line hit counts. It seems that using libFuzzer does end up providing a bit of new information.\r\n\r\nedit: It probably shows instability caused by global state? Which was the intention of doing the full corpus run through in the first place. So shuffling it between runs might be necessary for catching this sort of non-determinism.",
      "user": {
        "login": "marcofleon",
        "id": 95179662,
        "node_id": "U_kgDOBaxTjg",
        "avatar_url": "https://avatars.githubusercontent.com/u/95179662?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/marcofleon",
        "html_url": "https://github.com/marcofleon",
        "followers_url": "https://api.github.com/users/marcofleon/followers",
        "following_url": "https://api.github.com/users/marcofleon/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/marcofleon/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/marcofleon/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/marcofleon/subscriptions",
        "organizations_url": "https://api.github.com/users/marcofleon/orgs",
        "repos_url": "https://api.github.com/users/marcofleon/repos",
        "events_url": "https://api.github.com/users/marcofleon/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/marcofleon/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32198#issuecomment-2776408663",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/32198"
    },
    {
      "event": "mentioned",
      "id": 17117524110,
      "node_id": "MEE_lADOABII586wwtHgzwAAAAP8SLCO",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/17117524110",
      "actor": {
        "login": "dergoegge",
        "id": 8077169,
        "node_id": "MDQ6VXNlcjgwNzcxNjk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8077169?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dergoegge",
        "html_url": "https://github.com/dergoegge",
        "followers_url": "https://api.github.com/users/dergoegge/followers",
        "following_url": "https://api.github.com/users/dergoegge/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dergoegge/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dergoegge/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dergoegge/subscriptions",
        "organizations_url": "https://api.github.com/users/dergoegge/orgs",
        "repos_url": "https://api.github.com/users/dergoegge/repos",
        "events_url": "https://api.github.com/users/dergoegge/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dergoegge/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-04-03T16:54:05Z"
    },
    {
      "event": "subscribed",
      "id": 17117524125,
      "node_id": "SE_lADOABII586wwtHgzwAAAAP8SLCd",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/17117524125",
      "actor": {
        "login": "dergoegge",
        "id": 8077169,
        "node_id": "MDQ6VXNlcjgwNzcxNjk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8077169?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dergoegge",
        "html_url": "https://github.com/dergoegge",
        "followers_url": "https://api.github.com/users/dergoegge/followers",
        "following_url": "https://api.github.com/users/dergoegge/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dergoegge/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dergoegge/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dergoegge/subscriptions",
        "organizations_url": "https://api.github.com/users/dergoegge/orgs",
        "repos_url": "https://api.github.com/users/dergoegge/repos",
        "events_url": "https://api.github.com/users/dergoegge/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dergoegge/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-04-03T16:54:06Z"
    },
    {
      "event": "commented",
      "id": 2776461616,
      "node_id": "IC_kwDOABII586lfXEw",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2776461616",
      "actor": {
        "login": "maflcko",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/maflcko",
        "html_url": "https://github.com/maflcko",
        "followers_url": "https://api.github.com/users/maflcko/followers",
        "following_url": "https://api.github.com/users/maflcko/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/maflcko/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/maflcko/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/maflcko/subscriptions",
        "organizations_url": "https://api.github.com/users/maflcko/orgs",
        "repos_url": "https://api.github.com/users/maflcko/repos",
        "events_url": "https://api.github.com/users/maflcko/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/maflcko/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-04-03T17:18:49Z",
      "updated_at": "2025-04-03T17:18:49Z",
      "author_association": "MEMBER",
      "body": "> So shuffling it between runs might be necessary for catching this sort of non-determinism.\r\n\r\nYeah, good catch and nice idea!\r\n\r\nHowever, I am not seeing the global state that causes this. For reference, one part of the non-determinism is fixed by the change in commit https://github.com/bitcoin/bitcoin/commit/2222dd8e60d82e5aa96f3d80a81ddca880d627ea. I am happy to re-add the commit here, but I'd feel better if I fully understood the commit myself.",
      "user": {
        "login": "maflcko",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/maflcko",
        "html_url": "https://github.com/maflcko",
        "followers_url": "https://api.github.com/users/maflcko/followers",
        "following_url": "https://api.github.com/users/maflcko/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/maflcko/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/maflcko/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/maflcko/subscriptions",
        "organizations_url": "https://api.github.com/users/maflcko/orgs",
        "repos_url": "https://api.github.com/users/maflcko/repos",
        "events_url": "https://api.github.com/users/maflcko/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/maflcko/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32198#issuecomment-2776461616",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/32198"
    },
    {
      "event": "commented",
      "id": 2776726199,
      "node_id": "IC_kwDOABII586lgXq3",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2776726199",
      "actor": {
        "login": "Crypt-iQ",
        "id": 15145615,
        "node_id": "MDQ6VXNlcjE1MTQ1NjE1",
        "avatar_url": "https://avatars.githubusercontent.com/u/15145615?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Crypt-iQ",
        "html_url": "https://github.com/Crypt-iQ",
        "followers_url": "https://api.github.com/users/Crypt-iQ/followers",
        "following_url": "https://api.github.com/users/Crypt-iQ/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Crypt-iQ/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Crypt-iQ/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Crypt-iQ/subscriptions",
        "organizations_url": "https://api.github.com/users/Crypt-iQ/orgs",
        "repos_url": "https://api.github.com/users/Crypt-iQ/repos",
        "events_url": "https://api.github.com/users/Crypt-iQ/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Crypt-iQ/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-04-03T19:25:09Z",
      "updated_at": "2025-04-03T19:25:09Z",
      "author_association": "CONTRIBUTOR",
      "body": "This may be a shot in the dark, but is it possible that `ResetAndInitialize` re-initializing the `id` counter to 0 introduces some non-determinism across runs depending on the ordering of the corpus? During normal bitcoind operation, the `NodeId` is always monotonically increasing; is there a reason it is reset in `p2p_headers_presync` and `process_messages`?",
      "user": {
        "login": "Crypt-iQ",
        "id": 15145615,
        "node_id": "MDQ6VXNlcjE1MTQ1NjE1",
        "avatar_url": "https://avatars.githubusercontent.com/u/15145615?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Crypt-iQ",
        "html_url": "https://github.com/Crypt-iQ",
        "followers_url": "https://api.github.com/users/Crypt-iQ/followers",
        "following_url": "https://api.github.com/users/Crypt-iQ/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Crypt-iQ/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Crypt-iQ/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Crypt-iQ/subscriptions",
        "organizations_url": "https://api.github.com/users/Crypt-iQ/orgs",
        "repos_url": "https://api.github.com/users/Crypt-iQ/repos",
        "events_url": "https://api.github.com/users/Crypt-iQ/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Crypt-iQ/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32198#issuecomment-2776726199",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/32198"
    },
    {
      "event": "commented",
      "id": 2778718945,
      "node_id": "IC_kwDOABII586ln-Lh",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2778718945",
      "actor": {
        "login": "dergoegge",
        "id": 8077169,
        "node_id": "MDQ6VXNlcjgwNzcxNjk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8077169?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dergoegge",
        "html_url": "https://github.com/dergoegge",
        "followers_url": "https://api.github.com/users/dergoegge/followers",
        "following_url": "https://api.github.com/users/dergoegge/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dergoegge/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dergoegge/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dergoegge/subscriptions",
        "organizations_url": "https://api.github.com/users/dergoegge/orgs",
        "repos_url": "https://api.github.com/users/dergoegge/repos",
        "events_url": "https://api.github.com/users/dergoegge/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dergoegge/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-04-04T13:20:36Z",
      "updated_at": "2025-04-04T13:20:36Z",
      "author_association": "MEMBER",
      "body": "> However, I am not seeing the global state that causes this. For reference, one part of the non-determinism is fixed by the change in commit https://github.com/bitcoin/bitcoin/commit/2222dd8e60d82e5aa96f3d80a81ddca880d627ea. I am happy to re-add the commit here, but I'd feel better if I fully understood the commit myself.\r\n\r\nI think it might be the `m_rng` on peerman which is a global in this test.\r\n\r\nIn the following `m_rng` is only used if `tx_relay->m_next_inv_send_time < current_time` and https://github.com/bitcoin/bitcoin/commit/2222dd8e60d82e5aa96f3d80a81ddca880d627ea causes that to no longer be the case:\r\nhttps://github.com/bitcoin/bitcoin/blob/65dcbec75661d1652beb927f03b1feab4fab932e/src/net_processing.cpp#L5679-L5686\r\n\r\n> is there a reason it is reset in p2p_headers_presync and process_messages?\r\n\r\nFor each test case we want to simulate starting out with no peers (i.e. id = 0) and then add peers and send messages. ",
      "user": {
        "login": "dergoegge",
        "id": 8077169,
        "node_id": "MDQ6VXNlcjgwNzcxNjk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8077169?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dergoegge",
        "html_url": "https://github.com/dergoegge",
        "followers_url": "https://api.github.com/users/dergoegge/followers",
        "following_url": "https://api.github.com/users/dergoegge/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dergoegge/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dergoegge/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dergoegge/subscriptions",
        "organizations_url": "https://api.github.com/users/dergoegge/orgs",
        "repos_url": "https://api.github.com/users/dergoegge/repos",
        "events_url": "https://api.github.com/users/dergoegge/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dergoegge/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32198#issuecomment-2778718945",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/32198"
    },
    {
      "event": "commented",
      "id": 2778923110,
      "node_id": "IC_kwDOABII586lowBm",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2778923110",
      "actor": {
        "login": "Crypt-iQ",
        "id": 15145615,
        "node_id": "MDQ6VXNlcjE1MTQ1NjE1",
        "avatar_url": "https://avatars.githubusercontent.com/u/15145615?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Crypt-iQ",
        "html_url": "https://github.com/Crypt-iQ",
        "followers_url": "https://api.github.com/users/Crypt-iQ/followers",
        "following_url": "https://api.github.com/users/Crypt-iQ/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Crypt-iQ/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Crypt-iQ/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Crypt-iQ/subscriptions",
        "organizations_url": "https://api.github.com/users/Crypt-iQ/orgs",
        "repos_url": "https://api.github.com/users/Crypt-iQ/repos",
        "events_url": "https://api.github.com/users/Crypt-iQ/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Crypt-iQ/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-04-04T14:37:43Z",
      "updated_at": "2025-04-04T15:55:08Z",
      "author_association": "CONTRIBUTOR",
      "body": "> For each test case we want to simulate starting out with no peers (i.e. id = 0) and then add peers and send messages.\r\n\r\nThat makes sense, I think my question was a bit unclear. There are two places I can see in net_processing where `NodeId` persists even after the peer has disconnected (i.e. polluting global state somewhat between fuzz iterations):\r\n- `lNodesAnnouncingHeaderAndIDs`\r\n- `m_headers_presync_bestpeer`\r\n\r\nThe first one does not have any fuzz coverage, but the second one is executed by `p2p_headers_presync`. Running the full command in the OP above gives the following result where `m_headers_presync_bestpeer` [no longer exists in `m_headers_presync_stats`](https://github.com/bitcoin/bitcoin/blob/65dcbec75661d1652beb927f03b1feab4fab932e/src/net_processing.cpp#L2587-L2599):\r\n```diff\r\n diff --git a/Users/eugenesiegel/btc/bitcoin-review/build/fuzz_det_cov.show.t0.a.txt b/Users/eugenesiegel/btc/bitcoin-review/build/fuzz_det_cov.show.t0.b.txt\r\n index 0822ec1f73..74efd6c71d 100644\r\n  --- a/Users/eugenesiegel/btc/bitcoin-review/build/fuzz_det_cov.show.t0.a.txt\r\n  +++ b/Users/eugenesiegel/btc/bitcoin-review/build/fuzz_det_cov.show.t0.b.txt\r\n  @@ -102156,38 +102156,38 @@\r\n    2586|  3.79k|            bool best_updated = false;\r\n    2587|  3.79k|            if (best_it == m_headers_presync_stats.end()) {\r\n     ------------------\r\n  -  |  Branch (2587:17): [True: 37, False: 3.76k]\r\n  +  |  Branch (2587:17): [True: 39, False: 3.75k]\r\n     ------------------\r\n    2588|       |                // If the cached best peer is outdated, iterate over all remaining ones (including\r\n    2589|       |                // newly updated one) to find the best one.\r\n  - 2590|     37|                NodeId peer_best{-1};\r\n  - 2591|     37|                const HeadersPresyncStats* stat_best{nullptr};\r\n  - 2592|     37|                for (const auto& [peer, stat] : m_headers_presync_stats) {\r\n  + 2590|     39|                NodeId peer_best{-1};\r\n  + 2591|     39|                const HeadersPresyncStats* stat_best{nullptr};\r\n  + 2592|     39|                for (const auto& [peer, stat] : m_headers_presync_stats) {\r\n     ------------------\r\n  -  |  Branch (2592:47): [True: 37, False: 37]\r\n  +  |  Branch (2592:47): [True: 39, False: 39]\r\n     ------------------\r\n  - 2593|     37|                    if (!stat_best || stat > *stat_best) {\r\n  + 2593|     39|                    if (!stat_best || stat > *stat_best) {\r\n                                                       ^0\r\n     ------------------\r\n  -  |  Branch (2593:25): [True: 37, False: 0]\r\n  +  |  Branch (2593:25): [True: 39, False: 0]\r\n     |  Branch (2593:39): [True: 0, False: 0]\r\n     ------------------\r\n  - 2594|     37|                        peer_best = peer;\r\n  - 2595|     37|                        stat_best = &stat;\r\n  - 2596|     37|                    }\r\n  - 2597|     37|                }\r\n  - 2598|     37|                m_headers_presync_bestpeer = peer_best;\r\n  - 2599|     37|                best_updated = (peer_best == pfrom.GetId());\r\n  - 2600|  3.76k|            } else if (best_it->first == pfrom.GetId() || stats > best_it->second) {\r\n  + 2594|     39|                        peer_best = peer;\r\n  + 2595|     39|                        stat_best = &stat;\r\n  + 2596|     39|                    }\r\n  + 2597|     39|                }\r\n  + 2598|     39|                m_headers_presync_bestpeer = peer_best;\r\n  + 2599|     39|                best_updated = (peer_best == pfrom.GetId());\r\n  + 2600|  3.75k|            } else if (best_it->first == pfrom.GetId() || stats > best_it->second) {\r\n```\r\n\r\nChanging the `NodeId` to be a member of `HeadersSyncSetup` that is monotonically increasing does get rid of the above non-determinism, but it seems to introduce some new non-determinism elsewhere.\r\n\r\nEdit: The \"new non-determinism\" seems to be pre-existing, so I think changing `NodeId` to monotonically increase does reduce non-determinism if libfuzzer is used _with_ shuffling corpus inputs.",
      "user": {
        "login": "Crypt-iQ",
        "id": 15145615,
        "node_id": "MDQ6VXNlcjE1MTQ1NjE1",
        "avatar_url": "https://avatars.githubusercontent.com/u/15145615?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Crypt-iQ",
        "html_url": "https://github.com/Crypt-iQ",
        "followers_url": "https://api.github.com/users/Crypt-iQ/followers",
        "following_url": "https://api.github.com/users/Crypt-iQ/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Crypt-iQ/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Crypt-iQ/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Crypt-iQ/subscriptions",
        "organizations_url": "https://api.github.com/users/Crypt-iQ/orgs",
        "repos_url": "https://api.github.com/users/Crypt-iQ/repos",
        "events_url": "https://api.github.com/users/Crypt-iQ/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Crypt-iQ/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32198#issuecomment-2778923110",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/32198"
    },
    {
      "event": "commented",
      "id": 2779202401,
      "node_id": "IC_kwDOABII586lp0Nh",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2779202401",
      "actor": {
        "login": "marcofleon",
        "id": 95179662,
        "node_id": "U_kgDOBaxTjg",
        "avatar_url": "https://avatars.githubusercontent.com/u/95179662?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/marcofleon",
        "html_url": "https://github.com/marcofleon",
        "followers_url": "https://api.github.com/users/marcofleon/followers",
        "following_url": "https://api.github.com/users/marcofleon/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/marcofleon/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/marcofleon/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/marcofleon/subscriptions",
        "organizations_url": "https://api.github.com/users/marcofleon/orgs",
        "repos_url": "https://api.github.com/users/marcofleon/repos",
        "events_url": "https://api.github.com/users/marcofleon/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/marcofleon/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-04-04T16:12:20Z",
      "updated_at": "2025-04-04T16:12:20Z",
      "author_association": "CONTRIBUTOR",
      "body": "Commit 2222dd8e60d82e5aa96f3d80a81ddca880d627ea added to this PR fixes all non-determinism for me. I should probably run the script more than 10 times to be sure, but so far so good.\r\n\r\n@Crypt-iQ the part you're highlighting is the only code where the connection to Niklas's rationale isn't immediately clear. I think it could be in `MaybeSendPing` where sometimes a peer gets marked for disconnection based on some timeout which is dependent on mock time. That node then gets removed from `m_header_presync_stats` in `FinalizeNode`. So having the two different mock times and a different input ordering would affect which peers are part of the presync.",
      "user": {
        "login": "marcofleon",
        "id": 95179662,
        "node_id": "U_kgDOBaxTjg",
        "avatar_url": "https://avatars.githubusercontent.com/u/95179662?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/marcofleon",
        "html_url": "https://github.com/marcofleon",
        "followers_url": "https://api.github.com/users/marcofleon/followers",
        "following_url": "https://api.github.com/users/marcofleon/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/marcofleon/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/marcofleon/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/marcofleon/subscriptions",
        "organizations_url": "https://api.github.com/users/marcofleon/orgs",
        "repos_url": "https://api.github.com/users/marcofleon/repos",
        "events_url": "https://api.github.com/users/marcofleon/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/marcofleon/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32198#issuecomment-2779202401",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/32198"
    },
    {
      "event": "mentioned",
      "id": 17132822287,
      "node_id": "MEE_lADOABII586wwtHgzwAAAAP9Mh8P",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/17132822287",
      "actor": {
        "login": "Crypt-iQ",
        "id": 15145615,
        "node_id": "MDQ6VXNlcjE1MTQ1NjE1",
        "avatar_url": "https://avatars.githubusercontent.com/u/15145615?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Crypt-iQ",
        "html_url": "https://github.com/Crypt-iQ",
        "followers_url": "https://api.github.com/users/Crypt-iQ/followers",
        "following_url": "https://api.github.com/users/Crypt-iQ/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Crypt-iQ/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Crypt-iQ/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Crypt-iQ/subscriptions",
        "organizations_url": "https://api.github.com/users/Crypt-iQ/orgs",
        "repos_url": "https://api.github.com/users/Crypt-iQ/repos",
        "events_url": "https://api.github.com/users/Crypt-iQ/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Crypt-iQ/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-04-04T16:12:22Z"
    },
    {
      "event": "subscribed",
      "id": 17132822302,
      "node_id": "SE_lADOABII586wwtHgzwAAAAP9Mh8e",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/17132822302",
      "actor": {
        "login": "Crypt-iQ",
        "id": 15145615,
        "node_id": "MDQ6VXNlcjE1MTQ1NjE1",
        "avatar_url": "https://avatars.githubusercontent.com/u/15145615?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Crypt-iQ",
        "html_url": "https://github.com/Crypt-iQ",
        "followers_url": "https://api.github.com/users/Crypt-iQ/followers",
        "following_url": "https://api.github.com/users/Crypt-iQ/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Crypt-iQ/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Crypt-iQ/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Crypt-iQ/subscriptions",
        "organizations_url": "https://api.github.com/users/Crypt-iQ/orgs",
        "repos_url": "https://api.github.com/users/Crypt-iQ/repos",
        "events_url": "https://api.github.com/users/Crypt-iQ/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Crypt-iQ/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-04-04T16:12:22Z"
    },
    {
      "event": "commented",
      "id": 2779267298,
      "node_id": "IC_kwDOABII586lqEDi",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2779267298",
      "actor": {
        "login": "Crypt-iQ",
        "id": 15145615,
        "node_id": "MDQ6VXNlcjE1MTQ1NjE1",
        "avatar_url": "https://avatars.githubusercontent.com/u/15145615?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Crypt-iQ",
        "html_url": "https://github.com/Crypt-iQ",
        "followers_url": "https://api.github.com/users/Crypt-iQ/followers",
        "following_url": "https://api.github.com/users/Crypt-iQ/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Crypt-iQ/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Crypt-iQ/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Crypt-iQ/subscriptions",
        "organizations_url": "https://api.github.com/users/Crypt-iQ/orgs",
        "repos_url": "https://api.github.com/users/Crypt-iQ/repos",
        "events_url": "https://api.github.com/users/Crypt-iQ/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Crypt-iQ/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-04-04T16:44:17Z",
      "updated_at": "2025-04-04T16:45:02Z",
      "author_association": "CONTRIBUTOR",
      "body": "@marcofleon That sounds plausible, I don't immediately understand the connection to mock time; I was thinking along the lines of the `NodeId` getting reused across iterations:\r\n- Iteration 1: `id=0` is set as `m_headers_presync_bestpeer`\r\n- Iteration 2: `ResetAndInitialize` calls `FinalizeNode` which wipes all peer state except for `m_headers_presync_bestpeer`\r\n- Iteration 2: Depending on the corpus input, the peer with `id=0` sends a `HEADERS` message which eventually calls `IsContinuationOfLowWorkHeadersSync`. This will [populate](https://github.com/bitcoin/bitcoin/blob/65dcbec75661d1652beb927f03b1feab4fab932e/src/net_processing.cpp#L2584-L2585) the `m_headers_presync_stats` with `id=0` which then means that the best peer will be found in `m_headers_presync_stats`.",
      "user": {
        "login": "Crypt-iQ",
        "id": 15145615,
        "node_id": "MDQ6VXNlcjE1MTQ1NjE1",
        "avatar_url": "https://avatars.githubusercontent.com/u/15145615?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Crypt-iQ",
        "html_url": "https://github.com/Crypt-iQ",
        "followers_url": "https://api.github.com/users/Crypt-iQ/followers",
        "following_url": "https://api.github.com/users/Crypt-iQ/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Crypt-iQ/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Crypt-iQ/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Crypt-iQ/subscriptions",
        "organizations_url": "https://api.github.com/users/Crypt-iQ/orgs",
        "repos_url": "https://api.github.com/users/Crypt-iQ/repos",
        "events_url": "https://api.github.com/users/Crypt-iQ/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Crypt-iQ/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32198#issuecomment-2779267298",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/32198"
    },
    {
      "event": "mentioned",
      "id": 17133213572,
      "node_id": "MEE_lADOABII586wwtHgzwAAAAP9OBeE",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/17133213572",
      "actor": {
        "login": "marcofleon",
        "id": 95179662,
        "node_id": "U_kgDOBaxTjg",
        "avatar_url": "https://avatars.githubusercontent.com/u/95179662?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/marcofleon",
        "html_url": "https://github.com/marcofleon",
        "followers_url": "https://api.github.com/users/marcofleon/followers",
        "following_url": "https://api.github.com/users/marcofleon/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/marcofleon/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/marcofleon/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/marcofleon/subscriptions",
        "organizations_url": "https://api.github.com/users/marcofleon/orgs",
        "repos_url": "https://api.github.com/users/marcofleon/repos",
        "events_url": "https://api.github.com/users/marcofleon/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/marcofleon/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-04-04T16:44:19Z"
    },
    {
      "event": "subscribed",
      "id": 17133213587,
      "node_id": "SE_lADOABII586wwtHgzwAAAAP9OBeT",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/17133213587",
      "actor": {
        "login": "marcofleon",
        "id": 95179662,
        "node_id": "U_kgDOBaxTjg",
        "avatar_url": "https://avatars.githubusercontent.com/u/95179662?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/marcofleon",
        "html_url": "https://github.com/marcofleon",
        "followers_url": "https://api.github.com/users/marcofleon/followers",
        "following_url": "https://api.github.com/users/marcofleon/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/marcofleon/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/marcofleon/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/marcofleon/subscriptions",
        "organizations_url": "https://api.github.com/users/marcofleon/orgs",
        "repos_url": "https://api.github.com/users/marcofleon/repos",
        "events_url": "https://api.github.com/users/marcofleon/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/marcofleon/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-04-04T16:44:19Z"
    },
    {
      "event": "commented",
      "id": 2783047261,
      "node_id": "IC_kwDOABII586l4e5d",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2783047261",
      "actor": {
        "login": "marcofleon",
        "id": 95179662,
        "node_id": "U_kgDOBaxTjg",
        "avatar_url": "https://avatars.githubusercontent.com/u/95179662?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/marcofleon",
        "html_url": "https://github.com/marcofleon",
        "followers_url": "https://api.github.com/users/marcofleon/followers",
        "following_url": "https://api.github.com/users/marcofleon/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/marcofleon/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/marcofleon/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/marcofleon/subscriptions",
        "organizations_url": "https://api.github.com/users/marcofleon/orgs",
        "repos_url": "https://api.github.com/users/marcofleon/repos",
        "events_url": "https://api.github.com/users/marcofleon/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/marcofleon/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-04-07T11:45:59Z",
      "updated_at": "2025-04-07T12:44:36Z",
      "author_association": "CONTRIBUTOR",
      "body": "That's a good explanation, makes sense to me. I spent some time trying to connect what you're saying to the mock time fix, but turns out there is no connection. I forgot that taking out `SetMockTime(ConsumeTime(fuzzed_data_provider))` changes the input format so running on the old corpus isn't useful. As a workaround to generating a new corpus, I left the `ConsumeTime` in the test but didn't set it to mock time and this specific instability still shows up. It's separate from https://github.com/bitcoin/bitcoin/pull/32198#issuecomment-2778718945 then.\r\n\r\nIs `m_header_presync_bestpeer` only used for reporting/logging to validation? I'm not sure how useful to the test it would be to fix this specific source of non-determinism. Unless there's a relatively simple fix that doesn't slow down the test.\r\n\r\nCommit 2222dd8e60d82e5aa96f3d80a81ddca880d627ea seems to address some of the other non-determinism that shows up so I think including it in this PR makes sense.\r\n\r\nedit: I should add that https://github.com/bitcoin/bitcoin/pull/32198#issuecomment-2779202401 should be disregarded, as it is incorrect.\r\n",
      "user": {
        "login": "marcofleon",
        "id": 95179662,
        "node_id": "U_kgDOBaxTjg",
        "avatar_url": "https://avatars.githubusercontent.com/u/95179662?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/marcofleon",
        "html_url": "https://github.com/marcofleon",
        "followers_url": "https://api.github.com/users/marcofleon/followers",
        "following_url": "https://api.github.com/users/marcofleon/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/marcofleon/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/marcofleon/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/marcofleon/subscriptions",
        "organizations_url": "https://api.github.com/users/marcofleon/orgs",
        "repos_url": "https://api.github.com/users/marcofleon/repos",
        "events_url": "https://api.github.com/users/marcofleon/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/marcofleon/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32198#issuecomment-2783047261",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/32198"
    },
    {
      "event": "commented",
      "id": 2783112835,
      "node_id": "IC_kwDOABII586l4u6D",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2783112835",
      "actor": {
        "login": "maflcko",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/maflcko",
        "html_url": "https://github.com/maflcko",
        "followers_url": "https://api.github.com/users/maflcko/followers",
        "following_url": "https://api.github.com/users/maflcko/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/maflcko/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/maflcko/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/maflcko/subscriptions",
        "organizations_url": "https://api.github.com/users/maflcko/orgs",
        "repos_url": "https://api.github.com/users/maflcko/repos",
        "events_url": "https://api.github.com/users/maflcko/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/maflcko/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-04-07T12:07:48Z",
      "updated_at": "2025-04-07T12:07:48Z",
      "author_association": "MEMBER",
      "body": "> > However, I am not seeing the global state that causes this. For reference, one part of the non-determinism is fixed by the change in commit [2222dd8](https://github.com/bitcoin/bitcoin/commit/2222dd8e60d82e5aa96f3d80a81ddca880d627ea). I am happy to re-add the commit here, but I'd feel better if I fully understood the commit myself.\r\n> \r\n> I think it might be the `m_rng` on peerman which is a global in this test.\r\n> \r\n> In the following `m_rng` is only used if `tx_relay->m_next_inv_send_time < current_time` and [2222dd8](https://github.com/bitcoin/bitcoin/commit/2222dd8e60d82e5aa96f3d80a81ddca880d627ea) causes that to no longer be the case:\r\n\r\nThanks! I missed that `ResetAndInitialize` calls `NextInvToInbounds`. Pushed the commit again.\r\n\r\n\r\n\r\n> > So shuffling it between runs might be necessary for catching this sort of non-determinism.\r\n> \r\n> Yeah, good catch and nice idea!\r\n\r\nUpdate: Pushed a commit for this as well.\r\n\r\n\r\n\r\n> Iteration 1: `id=0` is set as `m_headers_presync_bestpeer`\r\n\r\nNice explanation. Add a commit for this as well.",
      "user": {
        "login": "maflcko",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/maflcko",
        "html_url": "https://github.com/maflcko",
        "followers_url": "https://api.github.com/users/maflcko/followers",
        "following_url": "https://api.github.com/users/maflcko/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/maflcko/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/maflcko/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/maflcko/subscriptions",
        "organizations_url": "https://api.github.com/users/maflcko/orgs",
        "repos_url": "https://api.github.com/users/maflcko/repos",
        "events_url": "https://api.github.com/users/maflcko/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/maflcko/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32198#issuecomment-2783112835",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/32198"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 17152822668,
      "node_id": "HRFPE_lADOABII586wwtHgzwAAAAP-Y02M",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/17152822668",
      "actor": {
        "login": "maflcko",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/maflcko",
        "html_url": "https://github.com/maflcko",
        "followers_url": "https://api.github.com/users/maflcko/followers",
        "following_url": "https://api.github.com/users/maflcko/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/maflcko/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/maflcko/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/maflcko/subscriptions",
        "organizations_url": "https://api.github.com/users/maflcko/orgs",
        "repos_url": "https://api.github.com/users/maflcko/repos",
        "events_url": "https://api.github.com/users/maflcko/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/maflcko/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": "fa2d3441c6557adba3d393abfc1af22fb788b5c2",
      "commit_url": "https://api.github.com/repos/maflcko/bitcoin-core/commits/fa2d3441c6557adba3d393abfc1af22fb788b5c2",
      "created_at": "2025-04-07T12:32:04Z"
    },
    {
      "event": "commented",
      "id": 2783187937,
      "node_id": "IC_kwDOABII586l5BPh",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2783187937",
      "actor": {
        "login": "maflcko",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/maflcko",
        "html_url": "https://github.com/maflcko",
        "followers_url": "https://api.github.com/users/maflcko/followers",
        "following_url": "https://api.github.com/users/maflcko/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/maflcko/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/maflcko/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/maflcko/subscriptions",
        "organizations_url": "https://api.github.com/users/maflcko/orgs",
        "repos_url": "https://api.github.com/users/maflcko/repos",
        "events_url": "https://api.github.com/users/maflcko/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/maflcko/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-04-07T12:35:14Z",
      "updated_at": "2025-04-07T12:35:14Z",
      "author_association": "MEMBER",
      "body": "force pushed with one more fix. Also, reordered some commits.\r\n\r\nObviously, the non-deterministic `std::ranges::shuffle(files, InsecureRandomContext{uint64_t(SystemClock::now().time_since_epoch().count())});` remains non-deterministic and should be ignored for now.\r\n\r\nLet me know if this should be fixed. Possible fixes are:\r\n\r\n* Pre-generated (cached) random numbers that are generated before coverage measurements start\r\n* Moving the code to a translation unit that is excluded from coverage.",
      "user": {
        "login": "maflcko",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/maflcko",
        "html_url": "https://github.com/maflcko",
        "followers_url": "https://api.github.com/users/maflcko/followers",
        "following_url": "https://api.github.com/users/maflcko/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/maflcko/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/maflcko/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/maflcko/subscriptions",
        "organizations_url": "https://api.github.com/users/maflcko/orgs",
        "repos_url": "https://api.github.com/users/maflcko/repos",
        "events_url": "https://api.github.com/users/maflcko/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/maflcko/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32198#issuecomment-2783187937",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/32198"
    },
    {
      "event": "commented",
      "id": 2783377375,
      "node_id": "IC_kwDOABII586l5vff",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2783377375",
      "actor": {
        "login": "Crypt-iQ",
        "id": 15145615,
        "node_id": "MDQ6VXNlcjE1MTQ1NjE1",
        "avatar_url": "https://avatars.githubusercontent.com/u/15145615?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Crypt-iQ",
        "html_url": "https://github.com/Crypt-iQ",
        "followers_url": "https://api.github.com/users/Crypt-iQ/followers",
        "following_url": "https://api.github.com/users/Crypt-iQ/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Crypt-iQ/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Crypt-iQ/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Crypt-iQ/subscriptions",
        "organizations_url": "https://api.github.com/users/Crypt-iQ/orgs",
        "repos_url": "https://api.github.com/users/Crypt-iQ/repos",
        "events_url": "https://api.github.com/users/Crypt-iQ/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Crypt-iQ/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-04-07T13:38:04Z",
      "updated_at": "2025-04-07T13:43:21Z",
      "author_association": "CONTRIBUTOR",
      "body": "> Is m_header_presync_bestpeer only used for reporting/logging to validation? I'm not sure how useful to the test it would be to fix this specific source of non-determinism. Unless there's a relatively simple fix that doesn't slow down the test.\r\n\r\nI haven't fully grokked the presync headers logic, so I don't know but I can find out. This commit fixes it https://github.com/bitcoin/bitcoin/pull/32198/commits/fa2c7cbd503cefba8b7db51be324aa0a3a992f2.\r\n\r\n> I forgot that taking out SetMockTime(ConsumeTime(fuzzed_data_provider)) changes the input format so running on the old corpus isn't useful.\r\n\r\nThis brings up something I was wondering about -- is there any current way to migrate the corpus if it gets invalidated?  I was looking at `FuzzedDataProvider` and realized it takes from the front and back of the input which makes me a bit confused on how migration can happen.\r\n\r\nEdit: Does fa2d3441c6557adba3d393abfc1af22fb788b5c2 invalidate the existing corpus or is the idea to either migrate or run the fuzzer long enough to achieve the same coverage?",
      "user": {
        "login": "Crypt-iQ",
        "id": 15145615,
        "node_id": "MDQ6VXNlcjE1MTQ1NjE1",
        "avatar_url": "https://avatars.githubusercontent.com/u/15145615?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Crypt-iQ",
        "html_url": "https://github.com/Crypt-iQ",
        "followers_url": "https://api.github.com/users/Crypt-iQ/followers",
        "following_url": "https://api.github.com/users/Crypt-iQ/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Crypt-iQ/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Crypt-iQ/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Crypt-iQ/subscriptions",
        "organizations_url": "https://api.github.com/users/Crypt-iQ/orgs",
        "repos_url": "https://api.github.com/users/Crypt-iQ/repos",
        "events_url": "https://api.github.com/users/Crypt-iQ/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Crypt-iQ/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32198#issuecomment-2783377375",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/32198"
    },
    {
      "event": "commented",
      "id": 2783401694,
      "node_id": "IC_kwDOABII586l51be",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2783401694",
      "actor": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-04-07T13:46:08Z",
      "updated_at": "2025-04-07T13:46:08Z",
      "author_association": "MEMBER",
      "body": "> Is `m_header_presync_bestpeer` only used for reporting/logging to validation?\r\n\r\nIt should be. Header presync is an inherently per-peer data operation (as the whole point is avoiding impact on global data structures until the peer has proven their chain is worthwhile), but for progress reporting we need a single number, so only the most advanced header sync is used.",
      "user": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32198#issuecomment-2783401694",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/32198"
    },
    {
      "event": "commented",
      "id": 2783452342,
      "node_id": "IC_kwDOABII586l6By2",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2783452342",
      "actor": {
        "login": "maflcko",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/maflcko",
        "html_url": "https://github.com/maflcko",
        "followers_url": "https://api.github.com/users/maflcko/followers",
        "following_url": "https://api.github.com/users/maflcko/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/maflcko/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/maflcko/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/maflcko/subscriptions",
        "organizations_url": "https://api.github.com/users/maflcko/orgs",
        "repos_url": "https://api.github.com/users/maflcko/repos",
        "events_url": "https://api.github.com/users/maflcko/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/maflcko/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-04-07T14:02:02Z",
      "updated_at": "2025-04-07T14:02:02Z",
      "author_association": "MEMBER",
      "body": "> > I forgot that taking out SetMockTime(ConsumeTime(fuzzed_data_provider)) changes the input format so running on the old corpus isn't useful.\r\n> \r\n> This brings up something I was wondering about -- is there any current way to migrate the corpus if it gets invalidated? I was looking at `FuzzedDataProvider` and realized it takes from the front and back of the input which makes me a bit confused on how migration can happen.\r\n> \r\n> Edit: Does [fa2d344](https://github.com/bitcoin/bitcoin/commit/fa2d3441c6557adba3d393abfc1af22fb788b5c2) invalidate the existing corpus or is the idea to either migrate or run the fuzzer long enough to achieve the same coverage?\r\n\r\nIn this case  it should be trivial by just popping the last bytes (whatever number of bytes it takes for `ConsumeTime`) from the end. However, I don't know how useful the prior inputs were, given that the fuzz target never was fully deterministic?\r\n\r\n<details><summary>For more involved cases you can ...</summary>\r\n\r\n.. run a modified version of the fuzzed data provider: https://github.com/maflcko/DrahtBot/blob/main/inverse_fdp/FuzzedDataProvider.example.patch (with additional adjustments to account for the newly  added or newly  removed data calls), then copy-paste the resulting code along with the inverse fuzzed data provider (https://github.com/maflcko/DrahtBot/blob/main/inverse_fdp/src/main.rs#L33C12-L33C16) into a new rust executable and run it. Though, I've never tried this myself :sweat_smile: \r\n\r\n</details>",
      "user": {
        "login": "maflcko",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/maflcko",
        "html_url": "https://github.com/maflcko",
        "followers_url": "https://api.github.com/users/maflcko/followers",
        "following_url": "https://api.github.com/users/maflcko/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/maflcko/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/maflcko/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/maflcko/subscriptions",
        "organizations_url": "https://api.github.com/users/maflcko/orgs",
        "repos_url": "https://api.github.com/users/maflcko/repos",
        "events_url": "https://api.github.com/users/maflcko/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/maflcko/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32198#issuecomment-2783452342",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/32198"
    },
    {
      "event": "commented",
      "id": 2785989825,
      "node_id": "IC_kwDOABII586mDtTB",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2785989825",
      "actor": {
        "login": "Crypt-iQ",
        "id": 15145615,
        "node_id": "MDQ6VXNlcjE1MTQ1NjE1",
        "avatar_url": "https://avatars.githubusercontent.com/u/15145615?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Crypt-iQ",
        "html_url": "https://github.com/Crypt-iQ",
        "followers_url": "https://api.github.com/users/Crypt-iQ/followers",
        "following_url": "https://api.github.com/users/Crypt-iQ/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Crypt-iQ/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Crypt-iQ/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Crypt-iQ/subscriptions",
        "organizations_url": "https://api.github.com/users/Crypt-iQ/orgs",
        "repos_url": "https://api.github.com/users/Crypt-iQ/repos",
        "events_url": "https://api.github.com/users/Crypt-iQ/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Crypt-iQ/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-04-08T10:34:06Z",
      "updated_at": "2025-04-08T10:34:06Z",
      "author_association": "CONTRIBUTOR",
      "body": "tACK fa2d3441c6557adba3d393abfc1af22fb788b5c2\r\n\r\nRan the script 100 times and it didn't give any errors.\r\n\r\n> Let me know if this should be fixed.\r\n\r\nI think this should be fixed to not give false positives, but I think this can be done in another PR?",
      "user": {
        "login": "Crypt-iQ",
        "id": 15145615,
        "node_id": "MDQ6VXNlcjE1MTQ1NjE1",
        "avatar_url": "https://avatars.githubusercontent.com/u/15145615?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Crypt-iQ",
        "html_url": "https://github.com/Crypt-iQ",
        "followers_url": "https://api.github.com/users/Crypt-iQ/followers",
        "following_url": "https://api.github.com/users/Crypt-iQ/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Crypt-iQ/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Crypt-iQ/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Crypt-iQ/subscriptions",
        "organizations_url": "https://api.github.com/users/Crypt-iQ/orgs",
        "repos_url": "https://api.github.com/users/Crypt-iQ/repos",
        "events_url": "https://api.github.com/users/Crypt-iQ/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Crypt-iQ/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32198#issuecomment-2785989825",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/32198"
    },
    {
      "event": "commented",
      "id": 2786049642,
      "node_id": "IC_kwDOABII586mD75q",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2786049642",
      "actor": {
        "login": "marcofleon",
        "id": 95179662,
        "node_id": "U_kgDOBaxTjg",
        "avatar_url": "https://avatars.githubusercontent.com/u/95179662?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/marcofleon",
        "html_url": "https://github.com/marcofleon",
        "followers_url": "https://api.github.com/users/marcofleon/followers",
        "following_url": "https://api.github.com/users/marcofleon/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/marcofleon/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/marcofleon/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/marcofleon/subscriptions",
        "organizations_url": "https://api.github.com/users/marcofleon/orgs",
        "repos_url": "https://api.github.com/users/marcofleon/repos",
        "events_url": "https://api.github.com/users/marcofleon/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/marcofleon/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-04-08T10:58:29Z",
      "updated_at": "2025-04-08T10:58:29Z",
      "author_association": "CONTRIBUTOR",
      "body": "Using a new corpus, this is coming up at times:\r\n<details>\r\n<summary>diff --git a/./fuzzbuild/fuzz_det_cov.show.t9.a.txt b/./fuzzbuild/fuzz_det_cov.show.t9.b.txt</summary>\r\n\r\n```\r\nindex 3cb0b6f082..9e79f23f38 100644\r\n--- a/./fuzzbuild/fuzz_det_cov.show.t9.a.txt\r\n+++ b/./fuzzbuild/fuzz_det_cov.show.t9.b.txt\r\n@@ -168783,28 +168783,26 @@\r\n    28|       |    // newTaskMutex is locked throughout this loop EXCEPT\r\n    29|       |    // when the thread is waiting or when the user's function\r\n    30|       |    // is called.\r\n-   31|      2|    while (!shouldStop()) {\r\n+   31|      1|    while (!shouldStop()) {\r\n   ------------------\r\n-  |  Branch (31:12): [True: 1, False: 1]\r\n+  |  Branch (31:12): [True: 0, False: 1]\r\n   ------------------\r\n-   32|      1|        try {\r\n-   33|      2|            while (!shouldStop() && taskQueue.empty()) {\r\n-                                                  ^1\r\n+   32|      0|        try {\r\n+   33|      0|            while (!shouldStop() && taskQueue.empty()) {\r\n   ------------------\r\n-  |  Branch (33:20): [True: 1, False: 1]\r\n-  |  Branch (33:37): [True: 1, False: 0]\r\n+  |  Branch (33:20): [True: 0, False: 0]\r\n+  |  Branch (33:37): [True: 0, False: 0]\r\n   ------------------\r\n    34|       |                // Wait until there is something to do.\r\n-   35|      1|                newTaskScheduled.wait(lock);\r\n-   36|      1|            }\r\n+   35|      0|                newTaskScheduled.wait(lock);\r\n+   36|      0|            }\r\n    37|       |\r\n    38|       |            // Wait until either there is a new task, or until\r\n    39|       |            // the time of the first item on the queue:\r\n    40|       |\r\n-   41|      1|            while (!shouldStop() && !taskQueue.empty()) {\r\n-                                                  ^0\r\n+   41|      0|            while (!shouldStop() && !taskQueue.empty()) {\r\n   ------------------\r\n-  |  Branch (41:20): [True: 0, False: 1]\r\n+  |  Branch (41:20): [True: 0, False: 0]\r\n   |  Branch (41:37): [True: 0, False: 0]\r\n   ------------------\r\n    42|      0|                std::chrono::steady_clock::time_point timeToWaitFor = taskQueue.begin()->first;\r\n@@ -168818,40 +168816,39 @@\r\n    47|       |\r\n    48|       |            // If there are multiple threads, the queue can empty while we're waiting (another\r\n    49|       |            // thread may service the task we were waiting on).\r\n-   50|      1|            if (shouldStop() || taskQueue.empty())\r\n-                                              ^0\r\n+   50|      0|            if (shouldStop() || taskQueue.empty())\r\n   ------------------\r\n-  |  Branch (50:17): [True: 1, False: 0]\r\n+  |  Branch (50:17): [True: 0, False: 0]\r\n   |  Branch (50:33): [True: 0, False: 0]\r\n   ------------------\r\n    51|      1|                continue;\r\n    52|       |\r\n-   53|      0|            Function f = taskQueue.begin()->second;\r\n-   54|      0|            taskQueue.erase(taskQueue.begin());\r\n+   53|  18.4E|            Function f = taskQueue.begin()->second;\r\n+   54|  18.4E|            taskQueue.erase(taskQueue.begin());\r\n    55|       |\r\n-   56|      0|            {\r\n+   56|  18.4E|            {\r\n    57|       |                // Unlock before calling f, so it can reschedule itself or another task\r\n    58|       |                // without deadlocking:\r\n-   59|      0|                REVERSE_LOCK(lock);\r\n+   59|  18.4E|                REVERSE_LOCK(lock);\r\n   ------------------\r\n-  |  |  243|      0|#define REVERSE_LOCK(g) typename std::decay<decltype(g)>::type::reverse_lock UNIQUE_NAME(revlock)(g, #g, __FILE__, __LINE__)\r\n+  |  |  243|  18.4E|#define REVERSE_LOCK(g) typename std::decay<decltype(g)>::type::reverse_lock UNIQUE_NAME(revlock)(g, #g, __FILE__, __LINE__)\r\n   |  |  ------------------\r\n-  |  |  |  |   11|      0|#define UNIQUE_NAME(name) PASTE2(name, __COUNTER__)\r\n+  |  |  |  |   11|  18.4E|#define UNIQUE_NAME(name) PASTE2(name, __COUNTER__)\r\n   |  |  |  |  ------------------\r\n-  |  |  |  |  |  |    9|      0|#define PASTE2(x, y) PASTE(x, y)\r\n+  |  |  |  |  |  |    9|  18.4E|#define PASTE2(x, y) PASTE(x, y)\r\n   |  |  |  |  |  |  ------------------\r\n-  |  |  |  |  |  |  |  |    8|      0|#define PASTE(x, y) x ## y\r\n+  |  |  |  |  |  |  |  |    8|  18.4E|#define PASTE(x, y) x ## y\r\n   |  |  |  |  |  |  ------------------\r\n   |  |  |  |  ------------------\r\n   |  |  ------------------\r\n   ------------------\r\n-   60|      0|                f();\r\n-   61|      0|            }\r\n-   62|      0|        } catch (...) {\r\n+   60|  18.4E|                f();\r\n+   61|  18.4E|            }\r\n+   62|  18.4E|        } catch (...) {\r\n    63|      0|            --nThreadsServicingQueue;\r\n    64|      0|            throw;\r\n    65|      0|        }\r\n-   66|      1|    }\r\n+   66|      0|    }\r\n    67|      1|    --nThreadsServicingQueue;\r\n    68|      1|    newTaskScheduled.notify_one();\r\n    69|      1|}\r\n@@ -169245,11 +169242,11 @@\r\n   108|       |    int nThreadsServicingQueue GUARDED_BY(newTaskMutex){0};\r\n   109|       |    bool stopRequested GUARDED_BY(newTaskMutex){false};\r\n   110|       |    bool stopWhenEmpty GUARDED_BY(newTaskMutex){false};\r\n-  111|      6|    bool shouldStop() const EXCLUSIVE_LOCKS_REQUIRED(newTaskMutex) { return stopRequested || (stopWhenEmpty && taskQueue.empty()); }\r\n-                                                                                                           ^2^2               ^0\r\n+  111|      4|    bool shouldStop() const EXCLUSIVE_LOCKS_REQUIRED(newTaskMutex) { return stopRequested || (stopWhenEmpty && taskQueue.empty()); }\r\n+                                                                                                           ^0^0               ^0\r\n   ------------------\r\n-  |  Branch (111:77): [True: 4, False: 2]\r\n-  |  Branch (111:95): [True: 0, False: 2]\r\n+  |  Branch (111:77): [True: 4, False: 0]\r\n+  |  Branch (111:95): [True: 0, False: 0]\r\n   |  Branch (111:112): [True: 0, False: 0]\r\n   ------------------\r\n   112|       |};\r\n@@ -227794,7 +227791,7 @@\r\n    75|  1.25k|inline void EnterCritical(const char* pszName, const char* pszFile, int nLine, MutexType* cs, bool fTry = false) {}\r\n   ------------------\r\n   | void EnterCritical<std::mutex>(char const*, char const*, int, std::mutex*, bool):\r\n-  |   75|    943|inline void EnterCritical(const char* pszName, const char* pszFile, int nLine, MutexType* cs, bool fTry = false) {}\r\n+  |   75|    942|inline void EnterCritical(const char* pszName, const char* pszFile, int nLine, MutexType* cs, bool fTry = false) {}\r\n   ------------------\r\n   | void EnterCritical<std::recursive_mutex>(char const*, char const*, int, std::recursive_mutex*, bool):\r\n   |   75|    309|inline void EnterCritical(const char* pszName, const char* pszFile, int nLine, MutexType* cs, bool fTry = false) {}\r\n@@ -228041,7 +228038,7 @@\r\n   197|  1.25k|    {\r\n   198|  1.25k|        if (Base::owns_lock())\r\n   ------------------\r\n-  |  Branch (198:13): [True: 943, False: 1]\r\n+  |  Branch (198:13): [True: 943, False: 0]\r\n   ------------------\r\n   |  Branch (198:13): [True: 309, False: 0]\r\n   ------------------\r\n@@ -228051,13 +228048,13 @@\r\n   200|  1.25k|    }\r\n   ------------------\r\n   | UniqueLock<AnnotatedMixin<std::mutex> >::~UniqueLock():\r\n-  |  197|    944|    {\r\n-  |  198|    944|        if (Base::owns_lock())\r\n+  |  197|    943|    {\r\n+  |  198|    943|        if (Base::owns_lock())\r\n   |  ------------------\r\n-  |  |  Branch (198:13): [True: 943, False: 1]\r\n+  |  |  Branch (198:13): [True: 943, False: 0]\r\n   |  ------------------\r\n   |  199|    943|            LeaveCritical();\r\n-  |  200|    944|    }\r\n+  |  200|    943|    }\r\n   ------------------\r\n   | UniqueLock<AnnotatedMixin<std::recursive_mutex> >::~UniqueLock():\r\n   |  197|    309|    {\r\n@@ -228108,20 +228105,15 @@\r\n   | Unexecuted instantiation: UniqueLock<AnnotatedMixin<std::mutex> >::reverse_lock::reverse_lock(UniqueLock<AnnotatedMixin<std::mutex> >&, char const*, char const*, int)\r\n   ------------------\r\n   223|       |\r\n-  224|      1|        ~reverse_lock() {\r\n-  225|      1|            templock.swap(lock);\r\n-  226|      1|            EnterCritical(lockname.c_str(), file.c_str(), line, lock.mutex());\r\n-  227|      1|            lock.lock();\r\n-  228|      1|        }\r\n+  224|      0|        ~reverse_lock() {\r\n+  225|      0|            templock.swap(lock);\r\n+  226|      0|            EnterCritical(lockname.c_str(), file.c_str(), line, lock.mutex());\r\n+  227|      0|            lock.lock();\r\n+  228|      0|        }\r\n   ------------------\r\n   | Unexecuted instantiation: UniqueLock<AnnotatedMixin<std::recursive_mutex> >::reverse_lock::~reverse_lock()\r\n   ------------------\r\n-  | UniqueLock<AnnotatedMixin<std::mutex> >::reverse_lock::~reverse_lock():\r\n-  |  224|      1|        ~reverse_lock() {\r\n-  |  225|      1|            templock.swap(lock);\r\n-  |  226|      1|            EnterCritical(lockname.c_str(), file.c_str(), line, lock.mutex());\r\n-  |  227|      1|            lock.lock();\r\n-  |  228|      1|        }\r\n+  | Unexecuted instantiation: UniqueLock<AnnotatedMixin<std::mutex> >::reverse_lock::~reverse_lock()\r\n   ------------------\r\n   229|       |\r\n   230|       |     private:\r\n@@ -228137,7 +228129,7 @@\r\n   240|       |     friend class reverse_lock;\r\n   241|       |};\r\n   242|       |\r\n-  243|      0|#define REVERSE_LOCK(g) typename std::decay<decltype(g)>::type::reverse_lock UNIQUE_NAME(revlock)(g, #g, __FILE__, __LINE__)\r\n+  243|  18.4E|#define REVERSE_LOCK(g) typename std::decay<decltype(g)>::type::reverse_lock UNIQUE_NAME(revlock)(g, #g, __FILE__, __LINE__)\r\n   244|       |\r\n   245|       |// When locking a Mutex, require negative capability to ensure the lock\r\n   246|       |// is not already held\r\n⚠️\r\n\r\nThe coverage was not deterministic between runs.\r\nThe fuzz target input was ./p2pheaderpresync_newcorp/p2p_headers_presync/30ad165903c86c0b30bd5940c0031c9f89bd264d.\r\n```\r\n\r\n</details>\r\n\r\nInstability in `scheduler.cpp`?",
      "user": {
        "login": "marcofleon",
        "id": 95179662,
        "node_id": "U_kgDOBaxTjg",
        "avatar_url": "https://avatars.githubusercontent.com/u/95179662?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/marcofleon",
        "html_url": "https://github.com/marcofleon",
        "followers_url": "https://api.github.com/users/marcofleon/followers",
        "following_url": "https://api.github.com/users/marcofleon/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/marcofleon/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/marcofleon/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/marcofleon/subscriptions",
        "organizations_url": "https://api.github.com/users/marcofleon/orgs",
        "repos_url": "https://api.github.com/users/marcofleon/repos",
        "events_url": "https://api.github.com/users/marcofleon/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/marcofleon/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32198#issuecomment-2786049642",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/32198"
    },
    {
      "event": "commented",
      "id": 2786159044,
      "node_id": "IC_kwDOABII586mEWnE",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2786159044",
      "actor": {
        "login": "janb84",
        "id": 608446,
        "node_id": "MDQ6VXNlcjYwODQ0Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/608446?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/janb84",
        "html_url": "https://github.com/janb84",
        "followers_url": "https://api.github.com/users/janb84/followers",
        "following_url": "https://api.github.com/users/janb84/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/janb84/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/janb84/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/janb84/subscriptions",
        "organizations_url": "https://api.github.com/users/janb84/orgs",
        "repos_url": "https://api.github.com/users/janb84/repos",
        "events_url": "https://api.github.com/users/janb84/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/janb84/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-04-08T11:42:02Z",
      "updated_at": "2025-04-08T11:42:02Z",
      "author_association": "CONTRIBUTOR",
      "body": "New corpus all runs end up non-deterministic: \r\n\r\nUsed command to test: \r\n```shell\r\n cargo run --manifest-path ./contrib/devtools/deterministic-fuzz-coverage/Cargo.toml -- $PWD/build_fuzz/ $PWD/qa-assets/fuzz_corpora/ p2p_headers_presync 9\r\n```\r\n\r\nOutcome: \r\n```shell\r\nThe coverage was not deterministic between runs.\r\n```\r\n\r\nLet me know if you need additional info or I need to test in a different way. (tested 4 times all runs end up like this) \r\n\r\n<details>\r\n<summary>diff</summary>\r\n\r\n```\r\n@@ -144603,7 +144603,7 @@\r\n|  185|  12.5k|    RandomNumberGenerator auto& Impl() noexcept { return static_cast<T&>(*this); }\r\n   ------------------\r\n   | _ZN11RandomMixinI21InsecureRandomContextE4ImplEv:\r\n-  |  185|    668|    RandomNumberGenerator auto& Impl() noexcept { return static_cast<T&>(*this); }\r\n+  |  185|    660|    RandomNumberGenerator auto& Impl() noexcept { return static_cast<T&>(*this); }\r\n   ------------------\r\n   186|       |\r\n   187|       |protected:\r\n@@ -145092,12 +145092,12 @@\r\n   ------------------\r\n   | Unexecuted instantiation: _ZN11RandomMixinI21InsecureRandomContextE3maxEv\r\n   ------------------\r\n-  367|    668|    inline uint64_t operator()() noexcept { return Impl().rand64(); }\r\n+  367|    660|    inline uint64_t operator()() noexcept { return Impl().rand64(); }\r\n   ------------------\r\n   | Unexecuted instantiation: _ZN11RandomMixinI17FastRandomContextEclEv\r\n   ------------------\r\n   | _ZN11RandomMixinI21InsecureRandomContextEclEv:\r\n-  |  367|    668|    inline uint64_t operator()() noexcept { return Impl().rand64(); }\r\n+  |  367|    660|    inline uint64_t operator()() noexcept { return Impl().rand64(); }\r\n   ------------------\r\n   368|       |};\r\n   369|       |\r\n@@ -145175,14 +145175,14 @@\r\n   437|      0|    }\r\n   438|       |\r\n   439|       |    constexpr uint64_t rand64() noexcept\r\n-  440|    668|    {\r\n-  441|    668|        uint64_t s0 = m_s0, s1 = m_s1;\r\n-  442|    668|        const uint64_t result = std::rotl(s0 + s1, 17) + s0;\r\n-  443|    668|        s1 ^= s0;\r\n-  444|    668|        m_s0 = std::rotl(s0, 49) ^ s1 ^ (s1 << 21);\r\n-  445|    668|        m_s1 = std::rotl(s1, 28);\r\n-  446|    668|        return result;\r\n-  447|    668|    }\r\n+  440|    660|    {\r\n+  441|    660|        uint64_t s0 = m_s0, s1 = m_s1;\r\n+  442|    660|        const uint64_t result = std::rotl(s0 + s1, 17) + s0;\r\n+  443|    660|        s1 ^= s0;\r\n+  444|    660|        m_s0 = std::rotl(s0, 49) ^ s1 ^ (s1 << 21);\r\n+  445|    660|        m_s1 = std::rotl(s1, 28);\r\n+  446|    660|        return result;\r\n+  447|    660|    }\r\n   448|       |};\r\n   449|       |\r\n   450|       |\r\n⚠️\r\n\r\nThe coverage was not deterministic between runs.\r\n```\r\n\r\n</details>\r\n",
      "user": {
        "login": "janb84",
        "id": 608446,
        "node_id": "MDQ6VXNlcjYwODQ0Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/608446?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/janb84",
        "html_url": "https://github.com/janb84",
        "followers_url": "https://api.github.com/users/janb84/followers",
        "following_url": "https://api.github.com/users/janb84/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/janb84/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/janb84/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/janb84/subscriptions",
        "organizations_url": "https://api.github.com/users/janb84/orgs",
        "repos_url": "https://api.github.com/users/janb84/repos",
        "events_url": "https://api.github.com/users/janb84/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/janb84/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32198#issuecomment-2786159044",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/32198"
    },
    {
      "event": "commented",
      "id": 2786715904,
      "node_id": "IC_kwDOABII586mGekA",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2786715904",
      "actor": {
        "login": "marcofleon",
        "id": 95179662,
        "node_id": "U_kgDOBaxTjg",
        "avatar_url": "https://avatars.githubusercontent.com/u/95179662?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/marcofleon",
        "html_url": "https://github.com/marcofleon",
        "followers_url": "https://api.github.com/users/marcofleon/followers",
        "following_url": "https://api.github.com/users/marcofleon/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/marcofleon/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/marcofleon/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/marcofleon/subscriptions",
        "organizations_url": "https://api.github.com/users/marcofleon/orgs",
        "repos_url": "https://api.github.com/users/marcofleon/repos",
        "events_url": "https://api.github.com/users/marcofleon/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/marcofleon/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-04-08T14:50:25Z",
      "updated_at": "2025-04-08T14:50:25Z",
      "author_association": "CONTRIBUTOR",
      "body": "@janb84 I could be wrong but I think that might be coming from faaf3819f2c957a4c9688386b8301a1ef70ace07. If so, then https://github.com/bitcoin/bitcoin/pull/32198#issuecomment-2783187937 mentioned it as a source of non-determinism to ignore for now.",
      "user": {
        "login": "marcofleon",
        "id": 95179662,
        "node_id": "U_kgDOBaxTjg",
        "avatar_url": "https://avatars.githubusercontent.com/u/95179662?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/marcofleon",
        "html_url": "https://github.com/marcofleon",
        "followers_url": "https://api.github.com/users/marcofleon/followers",
        "following_url": "https://api.github.com/users/marcofleon/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/marcofleon/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/marcofleon/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/marcofleon/subscriptions",
        "organizations_url": "https://api.github.com/users/marcofleon/orgs",
        "repos_url": "https://api.github.com/users/marcofleon/repos",
        "events_url": "https://api.github.com/users/marcofleon/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/marcofleon/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32198#issuecomment-2786715904",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/32198"
    },
    {
      "event": "mentioned",
      "id": 17172654338,
      "node_id": "MEE_lADOABII586wwtHgzwAAAAP_kekC",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/17172654338",
      "actor": {
        "login": "janb84",
        "id": 608446,
        "node_id": "MDQ6VXNlcjYwODQ0Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/608446?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/janb84",
        "html_url": "https://github.com/janb84",
        "followers_url": "https://api.github.com/users/janb84/followers",
        "following_url": "https://api.github.com/users/janb84/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/janb84/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/janb84/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/janb84/subscriptions",
        "organizations_url": "https://api.github.com/users/janb84/orgs",
        "repos_url": "https://api.github.com/users/janb84/repos",
        "events_url": "https://api.github.com/users/janb84/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/janb84/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-04-08T14:50:26Z"
    },
    {
      "event": "subscribed",
      "id": 17172654363,
      "node_id": "SE_lADOABII586wwtHgzwAAAAP_kekb",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/17172654363",
      "actor": {
        "login": "janb84",
        "id": 608446,
        "node_id": "MDQ6VXNlcjYwODQ0Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/608446?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/janb84",
        "html_url": "https://github.com/janb84",
        "followers_url": "https://api.github.com/users/janb84/followers",
        "following_url": "https://api.github.com/users/janb84/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/janb84/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/janb84/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/janb84/subscriptions",
        "organizations_url": "https://api.github.com/users/janb84/orgs",
        "repos_url": "https://api.github.com/users/janb84/repos",
        "events_url": "https://api.github.com/users/janb84/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/janb84/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-04-08T14:50:26Z"
    },
    {
      "event": "reviewed",
      "id": 2750624073,
      "node_id": "PRR_kwDOABII586j8zFJ",
      "url": null,
      "actor": null,
      "commit_id": "fa2d3441c6557adba3d393abfc1af22fb788b5c2",
      "commit_url": null,
      "created_at": null,
      "author_association": "CONTRIBUTOR",
      "body": "tACK [fa2d344](https://github.com/bitcoin/bitcoin/commit/fa2d3441c6557adba3d393abfc1af22fb788b5c2)\r\n\r\n> @janb84 I could be wrong but I think that might be coming from [faaf381](https://github.com/bitcoin/bitcoin/commit/faaf3819f2c957a4c9688386b8301a1ef70ace07). If so, then [#32198 (comment)](https://github.com/bitcoin/bitcoin/pull/32198#issuecomment-2783187937) mentioned it as a source of non-determinism to ignore for now.\r\n\r\nAh my bad, seems logical. Thanks @marcofleon for pointing this out to me, somehow I didn't made the connection between the two.",
      "user": {
        "login": "janb84",
        "id": 608446,
        "node_id": "MDQ6VXNlcjYwODQ0Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/608446?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/janb84",
        "html_url": "https://github.com/janb84",
        "followers_url": "https://api.github.com/users/janb84/followers",
        "following_url": "https://api.github.com/users/janb84/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/janb84/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/janb84/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/janb84/subscriptions",
        "organizations_url": "https://api.github.com/users/janb84/orgs",
        "repos_url": "https://api.github.com/users/janb84/repos",
        "events_url": "https://api.github.com/users/janb84/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/janb84/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32198#pullrequestreview-2750624073",
      "submitted_at": "2025-04-08T16:21:48Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/32198"
    },
    {
      "event": "commented",
      "id": 2789099600,
      "node_id": "IC_kwDOABII586mPkhQ",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2789099600",
      "actor": {
        "login": "maflcko",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/maflcko",
        "html_url": "https://github.com/maflcko",
        "followers_url": "https://api.github.com/users/maflcko/followers",
        "following_url": "https://api.github.com/users/maflcko/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/maflcko/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/maflcko/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/maflcko/subscriptions",
        "organizations_url": "https://api.github.com/users/maflcko/orgs",
        "repos_url": "https://api.github.com/users/maflcko/repos",
        "events_url": "https://api.github.com/users/maflcko/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/maflcko/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-04-09T09:57:24Z",
      "updated_at": "2025-04-09T09:57:24Z",
      "author_association": "MEMBER",
      "body": "> Instability in `scheduler.cpp`?\r\n\r\nI don't know where this is coming from and I can't reproduce. Are you running with libFuzzer or without?\r\n\r\nHowever, the scheduler thread isn't needed at all, so I dropped it.\r\n\r\n> > Let me know if this should be fixed.\r\n> \r\n> I think this should be fixed to not give false positives\r\n\r\nBy using the standard library random module (which is not coverage-instrumented), it should be sufficient to avoid the non-determinism in the random module from the shuffle. Thus, replacing `std::ranges::shuffle(files, InsecureRandomContext{uint64_t(SystemClock::now().time_since_epoch().count())});` by `std::ranges::shuffle(files, std::mt19937{std::random_device{}()});` should fix it. However, I couldn't confirm this by testing locally.\r\n\r\n\r\nI am still seeing non-determinism. For example:\r\n\r\n\r\n```diff\r\n   196|  60.7k|    if (next_height % HEADER_COMMITMENT_PERIOD == m_commit_offset) {\r\n   ------------------\r\n-  |  Branch (196:9): [True: 59, False: 60.6k]\r\n+  |  Branch (196:9): [True: 60, False: 60.6k]\r\n   ------------------\r\n   197|       |        // Add a commitment.\r\n-  198|     59|        m_header_commitments.push_back(m_hasher(current.GetHash()) & 1);\r\n-  199|     59|        if (m_header_commitments.size() > m_max_commitments) {\r\n+  198|     60|        m_header_commitments.push_back(m_hasher(current.GetHash()) & 1);\r\n+  199|     60|        if (m_header_commitments.size() > m_max_commitments) {\r\n```\r\n\r\nI am not sure how easy it is to avoid all non-determinism. So maybe those can be handled in a follow-up? ",
      "user": {
        "login": "maflcko",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/maflcko",
        "html_url": "https://github.com/maflcko",
        "followers_url": "https://api.github.com/users/maflcko/followers",
        "following_url": "https://api.github.com/users/maflcko/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/maflcko/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/maflcko/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/maflcko/subscriptions",
        "organizations_url": "https://api.github.com/users/maflcko/orgs",
        "repos_url": "https://api.github.com/users/maflcko/repos",
        "events_url": "https://api.github.com/users/maflcko/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/maflcko/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32198#issuecomment-2789099600",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/32198"
    },
    {
      "event": "reviewed",
      "id": 2753390078,
      "node_id": "PRR_kwDOABII586kHWX-",
      "url": null,
      "actor": null,
      "commit_id": "faee5569c0797084ac74e0173c1969d6108b180c",
      "commit_url": null,
      "created_at": null,
      "author_association": "CONTRIBUTOR",
      "body": "Re-ACK [faee556](https://github.com/bitcoin/bitcoin/pull/32198/commits/faee5569c0797084ac74e0173c1969d6108b180c)\r\n\r\nChange since last ACK:\r\n- removed he scheduler functionality \r\n\r\n(I'm too junior PR reviewer to judge if the randomness issue has to be solved in this PR)",
      "user": {
        "login": "janb84",
        "id": 608446,
        "node_id": "MDQ6VXNlcjYwODQ0Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/608446?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/janb84",
        "html_url": "https://github.com/janb84",
        "followers_url": "https://api.github.com/users/janb84/followers",
        "following_url": "https://api.github.com/users/janb84/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/janb84/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/janb84/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/janb84/subscriptions",
        "organizations_url": "https://api.github.com/users/janb84/orgs",
        "repos_url": "https://api.github.com/users/janb84/repos",
        "events_url": "https://api.github.com/users/janb84/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/janb84/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32198#pullrequestreview-2753390078",
      "submitted_at": "2025-04-09T12:58:44Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/32198"
    },
    {
      "event": "commented",
      "id": 2790168236,
      "node_id": "IC_kwDOABII586mTpas",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2790168236",
      "actor": {
        "login": "maflcko",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/maflcko",
        "html_url": "https://github.com/maflcko",
        "followers_url": "https://api.github.com/users/maflcko/followers",
        "following_url": "https://api.github.com/users/maflcko/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/maflcko/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/maflcko/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/maflcko/subscriptions",
        "organizations_url": "https://api.github.com/users/maflcko/orgs",
        "repos_url": "https://api.github.com/users/maflcko/repos",
        "events_url": "https://api.github.com/users/maflcko/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/maflcko/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-04-09T15:45:54Z",
      "updated_at": "2025-04-09T15:45:54Z",
      "author_association": "MEMBER",
      "body": "> (I'm too junior PR reviewer to judge if the randomness issue has to be solved in this PR)\r\n\r\nI ran 400 times with the libFuzzer `-shuffle=1` version and all of them passed, so at least there it seems somewhat deterministic.\r\n\r\nThe `std::shuffle` version seemed to shuffle more and ran into non-determinism. Probably the one you reported. I pushed one more commit to fix this as well. The commit message mentions that it did not reproduce on libFuzzer for me.",
      "user": {
        "login": "maflcko",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/maflcko",
        "html_url": "https://github.com/maflcko",
        "followers_url": "https://api.github.com/users/maflcko/followers",
        "following_url": "https://api.github.com/users/maflcko/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/maflcko/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/maflcko/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/maflcko/subscriptions",
        "organizations_url": "https://api.github.com/users/maflcko/orgs",
        "repos_url": "https://api.github.com/users/maflcko/repos",
        "events_url": "https://api.github.com/users/maflcko/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/maflcko/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32198#issuecomment-2790168236",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/32198"
    },
    {
      "event": "reviewed",
      "id": 2754032217,
      "node_id": "PRR_kwDOABII586kJzJZ",
      "url": null,
      "actor": null,
      "commit_id": "fa3cd7aac74acf576a85299c024249c81384b921",
      "commit_url": null,
      "created_at": null,
      "author_association": "CONTRIBUTOR",
      "body": "Re-ACK [fa3cd7a](https://github.com/bitcoin/bitcoin/pull/32198/commits/fa3cd7aac74acf576a85299c024249c81384b921)\r\n\r\nWhen replacing `std::ranges::shuffle(files, InsecureRandomContext{uint64_t(SystemClock::now().time_since_epoch().count())});` with `std::ranges::shuffle(files, std::mt19937{std::random_device{}()});` in this commit as suggested,  the test is deterministic ! \r\n\r\n Have run the fuzz test 10x ✅",
      "user": {
        "login": "janb84",
        "id": 608446,
        "node_id": "MDQ6VXNlcjYwODQ0Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/608446?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/janb84",
        "html_url": "https://github.com/janb84",
        "followers_url": "https://api.github.com/users/janb84/followers",
        "following_url": "https://api.github.com/users/janb84/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/janb84/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/janb84/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/janb84/subscriptions",
        "organizations_url": "https://api.github.com/users/janb84/orgs",
        "repos_url": "https://api.github.com/users/janb84/repos",
        "events_url": "https://api.github.com/users/janb84/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/janb84/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32198#pullrequestreview-2754032217",
      "submitted_at": "2025-04-09T16:13:27Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/32198"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKGZhZjJlMjM4ZmJiYjIzZmQwZTIwOTcwZGQ5NWRjZjAxODQ2ZGY5YWE",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/faf2e238fbbb23fd0e20970dd95dcf01846df9aa",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/faf2e238fbbb23fd0e20970dd95dcf01846df9aa",
      "tree": {
        "sha": "7e92d6be38293e4183a40a765ac8caf103c23b5e",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/7e92d6be38293e4183a40a765ac8caf103c23b5e"
      },
      "verification": {
        "verified": false,
        "reason": "no_user",
        "payload": "tree 7e92d6be38293e4183a40a765ac8caf103c23b5e\nparent 639279e86a6edd6cb68e8cf077d14337bcd13959\nauthor MarcoFalke <*~=`'#}+{/-|&$^_@721217.xyz> 1744020085 +0200\ncommitter MarcoFalke <*~=`'#}+{/-|&$^_@721217.xyz> 1744221878 +0200\n\nfuzz: Shuffle files before testing them\n\nWhen iterating over all fuzz input files in a folder, the order should\nnot matter.\n\nHowever, shuffling may be useful to detect non-determinism.\n\nThus, shuffle in fuzz.cpp, when using neither libFuzzer, nor AFL.\n\nAlso, shuffle in the deterministic-fuzz-coverage tool, when using\nlibFuzzer.\n",
        "signature": "-----BEGIN SSH SIGNATURE-----\nU1NIU0lHAAAAAQAAADMAAAALc3NoLWVkMjU1MTkAAAAgqxY/aMPiuXoCFn6iAEyAhvUqFX\njanTudd31Jtt35ct0AAAADZ2l0AAAAAAAAAAZzaGE1MTIAAABTAAAAC3NzaC1lZDI1NTE5\nAAAAQAA3gM/Vgr3RMGxZTo6bwH8NB4wYqzAcDt60UgPLfcIWoa8vkGPFZf26Yq7oRH/bIJ\n141Bmg5bH8NNdsie3h8gQ=\n-----END SSH SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/639279e86a6edd6cb68e8cf077d14337bcd13959",
          "sha": "639279e86a6edd6cb68e8cf077d14337bcd13959",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/639279e86a6edd6cb68e8cf077d14337bcd13959"
        }
      ],
      "message": "fuzz: Shuffle files before testing them\n\nWhen iterating over all fuzz input files in a folder, the order should\nnot matter.\n\nHowever, shuffling may be useful to detect non-determinism.\n\nThus, shuffle in fuzz.cpp, when using neither libFuzzer, nor AFL.\n\nAlso, shuffle in the deterministic-fuzz-coverage tool, when using\nlibFuzzer.",
      "committer": {
        "name": "MarcoFalke",
        "email": "*~=`'#}+{/-|&$^_@721217.xyz",
        "date": "2025-04-09T18:04:38Z"
      },
      "author": {
        "name": "MarcoFalke",
        "email": "*~=`'#}+{/-|&$^_@721217.xyz",
        "date": "2025-04-07T10:01:25Z"
      },
      "sha": "faf2e238fbbb23fd0e20970dd95dcf01846df9aa"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKGZhOTg0NTVlNGIxNjI4NzZkNmExMzA1N2EwZDZjMDNlZmFlMzI1MDU",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/fa98455e4b162876d6a13057a0d6c03efae32505",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/fa98455e4b162876d6a13057a0d6c03efae32505",
      "tree": {
        "sha": "b5c4044806c4f58ed65da31f8e5525d8aecbeddc",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/b5c4044806c4f58ed65da31f8e5525d8aecbeddc"
      },
      "verification": {
        "verified": false,
        "reason": "no_user",
        "payload": "tree b5c4044806c4f58ed65da31f8e5525d8aecbeddc\nparent faf2e238fbbb23fd0e20970dd95dcf01846df9aa\nauthor MarcoFalke <*~=`'#}+{/-|&$^_@721217.xyz> 1743610655 +0200\ncommitter MarcoFalke <*~=`'#}+{/-|&$^_@721217.xyz> 1744221886 +0200\n\nfuzz: Set ignore_incoming_txs in p2p_headers_presync\n\nThis avoids non-determistic code paths.\n\nWithout this patch, the tool would report a diff:\n\ncargo run --manifest-path ./contrib/devtools/deterministic-fuzz-coverage/Cargo.toml -- $PWD/bld-cmake/ $PWD/../qa-assets/fuzz_corpora/ p2p_headers_presync 32\n\n...\n- 5371|    393|        peer.m_next_send_feefilter = current_time + m_rng.randrange<std::chrono::microseconds>(MAX_FEEFILTER_CHANGE_DELAY);\n- 5372|    393|    }\n+ 5371|    396|        peer.m_next_send_feefilter = current_time + m_rng.randrange<std::chrono::microseconds>(MAX_FEEFILTER_CHANGE_DELAY);\n+ 5372|    396|    }\n  5373|  16.2k|}\n...\n",
        "signature": "-----BEGIN SSH SIGNATURE-----\nU1NIU0lHAAAAAQAAADMAAAALc3NoLWVkMjU1MTkAAAAgqxY/aMPiuXoCFn6iAEyAhvUqFX\njanTudd31Jtt35ct0AAAADZ2l0AAAAAAAAAAZzaGE1MTIAAABTAAAAC3NzaC1lZDI1NTE5\nAAAAQL7rmXQOBxcyvyVM1iGXkUVy9PnICF8HCNb7FPW0BF6LLfSN/dI6rL72H7ANlyBGJE\nGykSEF4iqz6Y1YKfDbGww=\n-----END SSH SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/faf2e238fbbb23fd0e20970dd95dcf01846df9aa",
          "sha": "faf2e238fbbb23fd0e20970dd95dcf01846df9aa",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/faf2e238fbbb23fd0e20970dd95dcf01846df9aa"
        }
      ],
      "message": "fuzz: Set ignore_incoming_txs in p2p_headers_presync\n\nThis avoids non-determistic code paths.\n\nWithout this patch, the tool would report a diff:\n\ncargo run --manifest-path ./contrib/devtools/deterministic-fuzz-coverage/Cargo.toml -- $PWD/bld-cmake/ $PWD/../qa-assets/fuzz_corpora/ p2p_headers_presync 32\n\n...\n- 5371|    393|        peer.m_next_send_feefilter = current_time + m_rng.randrange<std::chrono::microseconds>(MAX_FEEFILTER_CHANGE_DELAY);\n- 5372|    393|    }\n+ 5371|    396|        peer.m_next_send_feefilter = current_time + m_rng.randrange<std::chrono::microseconds>(MAX_FEEFILTER_CHANGE_DELAY);\n+ 5372|    396|    }\n  5373|  16.2k|}\n...",
      "committer": {
        "name": "MarcoFalke",
        "email": "*~=`'#}+{/-|&$^_@721217.xyz",
        "date": "2025-04-09T18:04:46Z"
      },
      "author": {
        "name": "MarcoFalke",
        "email": "*~=`'#}+{/-|&$^_@721217.xyz",
        "date": "2025-04-02T16:17:35Z"
      },
      "sha": "fa98455e4b162876d6a13057a0d6c03efae32505"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKGZhZjJkNTEyYzUyOWRiOWVjN2VkZDE0YmIyY2QzZTc1ZjAzNzQ4OWM",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/faf2d512c529db9ec7edd14bb2cd3e75f037489c",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/faf2d512c529db9ec7edd14bb2cd3e75f037489c",
      "tree": {
        "sha": "1002da7f43d34d52c6208b34afdbd7ead170ca9d",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/1002da7f43d34d52c6208b34afdbd7ead170ca9d"
      },
      "verification": {
        "verified": false,
        "reason": "no_user",
        "payload": "tree 1002da7f43d34d52c6208b34afdbd7ead170ca9d\nparent fa98455e4b162876d6a13057a0d6c03efae32505\nauthor MarcoFalke <*~=`'#}+{/-|&$^_@721217.xyz> 1744027321 +0200\ncommitter MarcoFalke <*~=`'#}+{/-|&$^_@721217.xyz> 1744221889 +0200\n\nfuzz: Move global node id counter along with other global state\n\nThe global m_headers_presync_stats is not reset in ResetAndInitialize.\nThis may lead to non-determinism.\n\nFix it by incrementing the global node id counter instead.\n\nWithout this patch, the tool would report a diff:\n\ncargo run --manifest-path ./contrib/devtools/deterministic-fuzz-coverage/Cargo.toml -- $PWD/bld-cmake/ $PWD/../qa-assets/fuzz_corpora/ p2p_headers_presync 32\n\n...\n  2587|  3.73k|            if (best_it == m_headers_presync_stats.end()) {\n   ------------------\n-  |  Branch (2587:17): [True: 80, False: 3.65k]\n+  |  Branch (2587:17): [True: 73, False: 3.66k]\n   ------------------\n...\n",
        "signature": "-----BEGIN SSH SIGNATURE-----\nU1NIU0lHAAAAAQAAADMAAAALc3NoLWVkMjU1MTkAAAAgqxY/aMPiuXoCFn6iAEyAhvUqFX\njanTudd31Jtt35ct0AAAADZ2l0AAAAAAAAAAZzaGE1MTIAAABTAAAAC3NzaC1lZDI1NTE5\nAAAAQF7eKkYsbKgTu6kj4xDMgj4qbN6ldFG+tusmGuI67roQg3DKTlrf4xAoeB66r8Utfk\n6kEoRNM3bcrvVqqgvuZQs=\n-----END SSH SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/fa98455e4b162876d6a13057a0d6c03efae32505",
          "sha": "fa98455e4b162876d6a13057a0d6c03efae32505",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/fa98455e4b162876d6a13057a0d6c03efae32505"
        }
      ],
      "message": "fuzz: Move global node id counter along with other global state\n\nThe global m_headers_presync_stats is not reset in ResetAndInitialize.\nThis may lead to non-determinism.\n\nFix it by incrementing the global node id counter instead.\n\nWithout this patch, the tool would report a diff:\n\ncargo run --manifest-path ./contrib/devtools/deterministic-fuzz-coverage/Cargo.toml -- $PWD/bld-cmake/ $PWD/../qa-assets/fuzz_corpora/ p2p_headers_presync 32\n\n...\n  2587|  3.73k|            if (best_it == m_headers_presync_stats.end()) {\n   ------------------\n-  |  Branch (2587:17): [True: 80, False: 3.65k]\n+  |  Branch (2587:17): [True: 73, False: 3.66k]\n   ------------------\n...",
      "committer": {
        "name": "MarcoFalke",
        "email": "*~=`'#}+{/-|&$^_@721217.xyz",
        "date": "2025-04-09T18:04:49Z"
      },
      "author": {
        "name": "MarcoFalke",
        "email": "*~=`'#}+{/-|&$^_@721217.xyz",
        "date": "2025-04-07T12:02:01Z"
      },
      "sha": "faf2d512c529db9ec7edd14bb2cd3e75f037489c"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKGZhOWMzODc5NGVmYjQ3NmQyYzZlOWRjYmM5YjEzN2I4YTFiYWM2NGE",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/fa9c38794efb476d2c6e9dcbc9b137b8a1bac64a",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/fa9c38794efb476d2c6e9dcbc9b137b8a1bac64a",
      "tree": {
        "sha": "0898bece846f2a67e658f19138c7136b462b2498",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/0898bece846f2a67e658f19138c7136b462b2498"
      },
      "verification": {
        "verified": false,
        "reason": "no_user",
        "payload": "tree 0898bece846f2a67e658f19138c7136b462b2498\nparent faf2d512c529db9ec7edd14bb2cd3e75f037489c\nauthor MarcoFalke <*~=`'#}+{/-|&$^_@721217.xyz> 1743152785 +0100\ncommitter MarcoFalke <*~=`'#}+{/-|&$^_@721217.xyz> 1744221917 +0200\n\ntest: Introduce MockableSteadyClock::mock_time_point and ElapseSteady helper\n\nThis refactor clarifies that the MockableSteadyClock::mock_time_point\nhas millisecond precision by defining a type an using it.\n\nMoreover, a ElapseSteady helper is added which can be re-used easily.\n",
        "signature": "-----BEGIN SSH SIGNATURE-----\nU1NIU0lHAAAAAQAAADMAAAALc3NoLWVkMjU1MTkAAAAgqxY/aMPiuXoCFn6iAEyAhvUqFX\njanTudd31Jtt35ct0AAAADZ2l0AAAAAAAAAAZzaGE1MTIAAABTAAAAC3NzaC1lZDI1NTE5\nAAAAQKCW3m8/V0+z+P9Ec9cUj+8E8d8y6WdF7crnpArXKL2DXjMyo2AqGiDFwgWbXm1JfE\n4EVaaFhMdogAfYnLKmYAc=\n-----END SSH SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/faf2d512c529db9ec7edd14bb2cd3e75f037489c",
          "sha": "faf2d512c529db9ec7edd14bb2cd3e75f037489c",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/faf2d512c529db9ec7edd14bb2cd3e75f037489c"
        }
      ],
      "message": "test: Introduce MockableSteadyClock::mock_time_point and ElapseSteady helper\n\nThis refactor clarifies that the MockableSteadyClock::mock_time_point\nhas millisecond precision by defining a type an using it.\n\nMoreover, a ElapseSteady helper is added which can be re-used easily.",
      "committer": {
        "name": "MarcoFalke",
        "email": "*~=`'#}+{/-|&$^_@721217.xyz",
        "date": "2025-04-09T18:05:17Z"
      },
      "author": {
        "name": "MarcoFalke",
        "email": "*~=`'#}+{/-|&$^_@721217.xyz",
        "date": "2025-03-28T09:06:25Z"
      },
      "sha": "fa9c38794efb476d2c6e9dcbc9b137b8a1bac64a"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKGZhZDIyMTQ5ZjQ2NzdhNjUwOTM5YmU1YWEwODY1ZjVmNmU3MDlhZWM",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/fad22149f4677a650939be5aa0865f5f6e709aec",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/fad22149f4677a650939be5aa0865f5f6e709aec",
      "tree": {
        "sha": "d5c32cf3932ea0a46a9b68e6e1422bb2cdf58afd",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/d5c32cf3932ea0a46a9b68e6e1422bb2cdf58afd"
      },
      "verification": {
        "verified": false,
        "reason": "no_user",
        "payload": "tree d5c32cf3932ea0a46a9b68e6e1422bb2cdf58afd\nparent fa9c38794efb476d2c6e9dcbc9b137b8a1bac64a\nauthor MarcoFalke <*~=`'#}+{/-|&$^_@721217.xyz> 1743166300 +0100\ncommitter MarcoFalke <*~=`'#}+{/-|&$^_@721217.xyz> 1744221936 +0200\n\nrefactor: Use MockableSteadyClock in ReportHeadersPresync\n\nThis allows the clock to be mockable in tests. Also, replace cs_main\nwith GetMutex() while touching this function.\n\nAlso, use the ElapseSteady test helper in the p2p_headers_presync fuzz\ntarget to make it more deterministic.\n\nThe m_last_presync_update variable is a global that is not reset in\nResetAndInitialize. However, it is only used for logging, so completely\ndisable it for now.\n\nWithout this patch, the tool would report a diff:\n\ncargo run --manifest-path ./contrib/devtools/deterministic-fuzz-coverage/Cargo.toml -- $PWD/bld-cmake/ $PWD/../qa-assets/fuzz_corpora/ p2p_headers_presync 32\n\n...\n  4468|     81|        auto now = std::chrono::steady_clock::now();\n  4469|     81|        if (now < m_last_presync_update + std::chrono::milliseconds{250}) return;\n-                                                                                        ^80\n+                                                                                        ^79\n...\n",
        "signature": "-----BEGIN SSH SIGNATURE-----\nU1NIU0lHAAAAAQAAADMAAAALc3NoLWVkMjU1MTkAAAAgqxY/aMPiuXoCFn6iAEyAhvUqFX\njanTudd31Jtt35ct0AAAADZ2l0AAAAAAAAAAZzaGE1MTIAAABTAAAAC3NzaC1lZDI1NTE5\nAAAAQLXtEqmv5ebcemrO1Sk4pgDc+T69uDcCLQJsvmSSgvqnDlxUo1bO0wO4miROLGjtsN\nEL8/DBtMIDeWpn3ftjugg=\n-----END SSH SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/fa9c38794efb476d2c6e9dcbc9b137b8a1bac64a",
          "sha": "fa9c38794efb476d2c6e9dcbc9b137b8a1bac64a",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/fa9c38794efb476d2c6e9dcbc9b137b8a1bac64a"
        }
      ],
      "message": "refactor: Use MockableSteadyClock in ReportHeadersPresync\n\nThis allows the clock to be mockable in tests. Also, replace cs_main\nwith GetMutex() while touching this function.\n\nAlso, use the ElapseSteady test helper in the p2p_headers_presync fuzz\ntarget to make it more deterministic.\n\nThe m_last_presync_update variable is a global that is not reset in\nResetAndInitialize. However, it is only used for logging, so completely\ndisable it for now.\n\nWithout this patch, the tool would report a diff:\n\ncargo run --manifest-path ./contrib/devtools/deterministic-fuzz-coverage/Cargo.toml -- $PWD/bld-cmake/ $PWD/../qa-assets/fuzz_corpora/ p2p_headers_presync 32\n\n...\n  4468|     81|        auto now = std::chrono::steady_clock::now();\n  4469|     81|        if (now < m_last_presync_update + std::chrono::milliseconds{250}) return;\n-                                                                                        ^80\n+                                                                                        ^79\n...",
      "committer": {
        "name": "MarcoFalke",
        "email": "*~=`'#}+{/-|&$^_@721217.xyz",
        "date": "2025-04-09T18:05:36Z"
      },
      "author": {
        "name": "MarcoFalke",
        "email": "*~=`'#}+{/-|&$^_@721217.xyz",
        "date": "2025-03-28T12:51:40Z"
      },
      "sha": "fad22149f4677a650939be5aa0865f5f6e709aec"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKGZhZmFjYTZjYmMyZmRhYmY5NWMyODZjOWQ4MzQ2ZTMzMWEyZGUyMTY",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/fafaca6cbc2fdabf95c286c9d8346e331a2de216",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/fafaca6cbc2fdabf95c286c9d8346e331a2de216",
      "tree": {
        "sha": "a4921041cf31111a19ed41e111ac55a22064006e",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/a4921041cf31111a19ed41e111ac55a22064006e"
      },
      "verification": {
        "verified": false,
        "reason": "no_user",
        "payload": "tree a4921041cf31111a19ed41e111ac55a22064006e\nparent fad22149f4677a650939be5aa0865f5f6e709aec\nauthor MarcoFalke <*~=`'#}+{/-|&$^_@721217.xyz> 1743610278 +0200\ncommitter MarcoFalke <*~=`'#}+{/-|&$^_@721217.xyz> 1744221939 +0200\n\nfuzz: Avoid setting the mock-time twice\n\nIt should be sufficient to set it once. Especially, if the dynamic value\nis only used by ResetAndInitialize.\n\nThis also avoids non-determistic code paths, when ResetAndInitialize may\nre-initialize m_next_inv_to_inbounds.\n\nWithout this patch, the tool would report a diff:\n\ncargo run --manifest-path ./contrib/devtools/deterministic-fuzz-coverage/Cargo.toml -- $PWD/bld-cmake/ $PWD/../qa-assets/fuzz_corpora/ p2p_headers_presync 32\n\n...\n- 1126|      3|        m_next_inv_to_inbounds = now + m_rng.rand_exp_duration(average_interval);\n- 1127|      3|    }\n+ 1126|     10|        m_next_inv_to_inbounds = now + m_rng.rand_exp_duration(average_interval);\n+ 1127|     10|    }\n  1128|    491|    return m_next_inv_to_inbounds;\n...\n",
        "signature": "-----BEGIN SSH SIGNATURE-----\nU1NIU0lHAAAAAQAAADMAAAALc3NoLWVkMjU1MTkAAAAgqxY/aMPiuXoCFn6iAEyAhvUqFX\njanTudd31Jtt35ct0AAAADZ2l0AAAAAAAAAAZzaGE1MTIAAABTAAAAC3NzaC1lZDI1NTE5\nAAAAQIehqSFePJ7c+WSokD5DKI1i93oNA8TfPeinUTf88MYLwp2BTzrDb+fx5lCqgZRzAa\nIXPznf+CXHWzqjJb7AGAo=\n-----END SSH SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/fad22149f4677a650939be5aa0865f5f6e709aec",
          "sha": "fad22149f4677a650939be5aa0865f5f6e709aec",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/fad22149f4677a650939be5aa0865f5f6e709aec"
        }
      ],
      "message": "fuzz: Avoid setting the mock-time twice\n\nIt should be sufficient to set it once. Especially, if the dynamic value\nis only used by ResetAndInitialize.\n\nThis also avoids non-determistic code paths, when ResetAndInitialize may\nre-initialize m_next_inv_to_inbounds.\n\nWithout this patch, the tool would report a diff:\n\ncargo run --manifest-path ./contrib/devtools/deterministic-fuzz-coverage/Cargo.toml -- $PWD/bld-cmake/ $PWD/../qa-assets/fuzz_corpora/ p2p_headers_presync 32\n\n...\n- 1126|      3|        m_next_inv_to_inbounds = now + m_rng.rand_exp_duration(average_interval);\n- 1127|      3|    }\n+ 1126|     10|        m_next_inv_to_inbounds = now + m_rng.rand_exp_duration(average_interval);\n+ 1127|     10|    }\n  1128|    491|    return m_next_inv_to_inbounds;\n...",
      "committer": {
        "name": "MarcoFalke",
        "email": "*~=`'#}+{/-|&$^_@721217.xyz",
        "date": "2025-04-09T18:05:39Z"
      },
      "author": {
        "name": "MarcoFalke",
        "email": "*~=`'#}+{/-|&$^_@721217.xyz",
        "date": "2025-04-02T16:11:18Z"
      },
      "sha": "fafaca6cbc2fdabf95c286c9d8346e331a2de216"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKGZhZjRjMWI2ZmMzMzA4ODVkZGY4NGI2NDM4MzhkMWUzMDFhYWVhYjI",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/faf4c1b6fc330885ddf84b643838d1e301aaeab2",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/faf4c1b6fc330885ddf84b643838d1e301aaeab2",
      "tree": {
        "sha": "bf96dde967caed4b8782410e9b1f8f63d626374f",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/bf96dde967caed4b8782410e9b1f8f63d626374f"
      },
      "verification": {
        "verified": false,
        "reason": "no_user",
        "payload": "tree bf96dde967caed4b8782410e9b1f8f63d626374f\nparent fafaca6cbc2fdabf95c286c9d8346e331a2de216\nauthor MarcoFalke <*~=`'#}+{/-|&$^_@721217.xyz> 1744190109 +0200\ncommitter MarcoFalke <*~=`'#}+{/-|&$^_@721217.xyz> 1744221956 +0200\n\nfuzz: Disable unused validation interface and scheduler in p2p_headers_presync\n\nThis may also avoid non-determinism in the scheduler thread.\n",
        "signature": "-----BEGIN SSH SIGNATURE-----\nU1NIU0lHAAAAAQAAADMAAAALc3NoLWVkMjU1MTkAAAAgqxY/aMPiuXoCFn6iAEyAhvUqFX\njanTudd31Jtt35ct0AAAADZ2l0AAAAAAAAAAZzaGE1MTIAAABTAAAAC3NzaC1lZDI1NTE5\nAAAAQPgbdZrp7MZ9w0BMXhEZNcNHydAqWaSnaUKsTsGuTflGJsXPleqXOwfJDAcMiWRBlc\nZ8i9ECb4EAV1NLE3D1zwU=\n-----END SSH SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/fafaca6cbc2fdabf95c286c9d8346e331a2de216",
          "sha": "fafaca6cbc2fdabf95c286c9d8346e331a2de216",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/fafaca6cbc2fdabf95c286c9d8346e331a2de216"
        }
      ],
      "message": "fuzz: Disable unused validation interface and scheduler in p2p_headers_presync\n\nThis may also avoid non-determinism in the scheduler thread.",
      "committer": {
        "name": "MarcoFalke",
        "email": "*~=`'#}+{/-|&$^_@721217.xyz",
        "date": "2025-04-09T18:05:56Z"
      },
      "author": {
        "name": "MarcoFalke",
        "email": "*~=`'#}+{/-|&$^_@721217.xyz",
        "date": "2025-04-09T09:15:09Z"
      },
      "sha": "faf4c1b6fc330885ddf84b643838d1e301aaeab2"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKGZhYTNjZTMxOTk4Y2RiZGNiODg4MTMyYjBkMzhlZTdhMWU3NDM2ODI",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/faa3ce31998cdbdcb888132b0d38ee7a1e743682",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/faa3ce31998cdbdcb888132b0d38ee7a1e743682",
      "tree": {
        "sha": "10776b48c8f579033e82e7b6612041ab3d82cf65",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/10776b48c8f579033e82e7b6612041ab3d82cf65"
      },
      "verification": {
        "verified": false,
        "reason": "no_user",
        "payload": "tree 10776b48c8f579033e82e7b6612041ab3d82cf65\nparent faf4c1b6fc330885ddf84b643838d1e301aaeab2\nauthor MarcoFalke <*~=`'#}+{/-|&$^_@721217.xyz> 1744214300 +0200\ncommitter MarcoFalke <*~=`'#}+{/-|&$^_@721217.xyz> 1744222016 +0200\n\nfuzz: Avoid influence on the global RNG from peerman m_rng\n\nThis should avoid the remaining non-determistic code coverage paths.\n\nWithout this patch, the tool would report a diff (only when running\nwithout libFuzzer):\n\ncargo run --manifest-path ./contrib/devtools/deterministic-fuzz-coverage/Cargo.toml -- $PWD/bld-cmake/ $PWD/../qa-assets/fuzz_corpora/ p2p_headers_presync 32\n",
        "signature": "-----BEGIN SSH SIGNATURE-----\nU1NIU0lHAAAAAQAAADMAAAALc3NoLWVkMjU1MTkAAAAgqxY/aMPiuXoCFn6iAEyAhvUqFX\njanTudd31Jtt35ct0AAAADZ2l0AAAAAAAAAAZzaGE1MTIAAABTAAAAC3NzaC1lZDI1NTE5\nAAAAQCYawuiv0cJo1axb0oP881+rvJOCH+hE0jeF0zH41h5TjQyzLZV9kJPEzuttI0G4+j\nDojvQOf7pzPt9i5fq5rgc=\n-----END SSH SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/faf4c1b6fc330885ddf84b643838d1e301aaeab2",
          "sha": "faf4c1b6fc330885ddf84b643838d1e301aaeab2",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/faf4c1b6fc330885ddf84b643838d1e301aaeab2"
        }
      ],
      "message": "fuzz: Avoid influence on the global RNG from peerman m_rng\n\nThis should avoid the remaining non-determistic code coverage paths.\n\nWithout this patch, the tool would report a diff (only when running\nwithout libFuzzer):\n\ncargo run --manifest-path ./contrib/devtools/deterministic-fuzz-coverage/Cargo.toml -- $PWD/bld-cmake/ $PWD/../qa-assets/fuzz_corpora/ p2p_headers_presync 32",
      "committer": {
        "name": "MarcoFalke",
        "email": "*~=`'#}+{/-|&$^_@721217.xyz",
        "date": "2025-04-09T18:06:56Z"
      },
      "author": {
        "name": "MarcoFalke",
        "email": "*~=`'#}+{/-|&$^_@721217.xyz",
        "date": "2025-04-09T15:58:20Z"
      },
      "sha": "faa3ce31998cdbdcb888132b0d38ee7a1e743682"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 17193905382,
      "node_id": "HRFPE_lADOABII586wwtHgzwAAAAQA1izm",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/17193905382",
      "actor": {
        "login": "maflcko",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/maflcko",
        "html_url": "https://github.com/maflcko",
        "followers_url": "https://api.github.com/users/maflcko/followers",
        "following_url": "https://api.github.com/users/maflcko/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/maflcko/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/maflcko/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/maflcko/subscriptions",
        "organizations_url": "https://api.github.com/users/maflcko/orgs",
        "repos_url": "https://api.github.com/users/maflcko/repos",
        "events_url": "https://api.github.com/users/maflcko/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/maflcko/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": "faa3ce31998cdbdcb888132b0d38ee7a1e743682",
      "commit_url": "https://api.github.com/repos/maflcko/bitcoin-core/commits/faa3ce31998cdbdcb888132b0d38ee7a1e743682",
      "created_at": "2025-04-09T18:07:20Z"
    },
    {
      "event": "commented",
      "id": 2790545360,
      "node_id": "IC_kwDOABII586mVFfQ",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2790545360",
      "actor": {
        "login": "maflcko",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/maflcko",
        "html_url": "https://github.com/maflcko",
        "followers_url": "https://api.github.com/users/maflcko/followers",
        "following_url": "https://api.github.com/users/maflcko/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/maflcko/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/maflcko/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/maflcko/subscriptions",
        "organizations_url": "https://api.github.com/users/maflcko/orgs",
        "repos_url": "https://api.github.com/users/maflcko/repos",
        "events_url": "https://api.github.com/users/maflcko/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/maflcko/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-04-09T18:08:23Z",
      "updated_at": "2025-04-09T18:08:23Z",
      "author_association": "MEMBER",
      "body": "> When replacing `std::ranges::shuffle(files, InsecureRandomContext{uint64_t(SystemClock::now().time_since_epoch().count())});` with `std::ranges::shuffle(files, std::mt19937{std::random_device{}()});` in this commit as suggested, the test is deterministic !\r\n\r\nOk, now I see that this is required for libc++, which I guess you are using? (I was using the GCC std lib)\r\n\r\nPushed that diff as well.\r\n\r\nHopefully this is the last one :sweat_smile: ",
      "user": {
        "login": "maflcko",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/maflcko",
        "html_url": "https://github.com/maflcko",
        "followers_url": "https://api.github.com/users/maflcko/followers",
        "following_url": "https://api.github.com/users/maflcko/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/maflcko/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/maflcko/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/maflcko/subscriptions",
        "organizations_url": "https://api.github.com/users/maflcko/orgs",
        "repos_url": "https://api.github.com/users/maflcko/repos",
        "events_url": "https://api.github.com/users/maflcko/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/maflcko/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32198#issuecomment-2790545360",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/32198"
    },
    {
      "event": "reviewed",
      "id": 2754361720,
      "node_id": "PRR_kwDOABII586kLDl4",
      "url": null,
      "actor": null,
      "commit_id": "faa3ce31998cdbdcb888132b0d38ee7a1e743682",
      "commit_url": null,
      "created_at": null,
      "author_association": "CONTRIBUTOR",
      "body": "Re-ACK [faa3ce3](https://github.com/bitcoin/bitcoin/commit/faa3ce31998cdbdcb888132b0d38ee7a1e743682)\r\n\r\nTest is deterministic without changes ✅ (tested 10x) \r\n\r\n> > When replacing `std::ranges::shuffle(files, InsecureRandomContext{uint64_t(SystemClock::now().time_since_epoch().count())});` with `std::ranges::shuffle(files, std::mt19937{std::random_device{}()});` in this commit as suggested, the test is deterministic !\r\n> \r\n> Ok, now I see that this is required for libc++, which I guess you are using? (I was using the GCC std lib)\r\n\r\nYes the macos version of it & Clang 19\r\n\r\n> \r\n> Pushed that diff as well.\r\n> \r\n> Hopefully this is the last one 😅\r\n\r\nI'm sorry, I was under the impression you wanted to do that change in a later PR. \r\n\r\n",
      "user": {
        "login": "janb84",
        "id": 608446,
        "node_id": "MDQ6VXNlcjYwODQ0Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/608446?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/janb84",
        "html_url": "https://github.com/janb84",
        "followers_url": "https://api.github.com/users/janb84/followers",
        "following_url": "https://api.github.com/users/janb84/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/janb84/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/janb84/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/janb84/subscriptions",
        "organizations_url": "https://api.github.com/users/janb84/orgs",
        "repos_url": "https://api.github.com/users/janb84/repos",
        "events_url": "https://api.github.com/users/janb84/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/janb84/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32198#pullrequestreview-2754361720",
      "submitted_at": "2025-04-09T18:27:06Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/32198"
    },
    {
      "event": "review_requested",
      "id": 17199883801,
      "node_id": "RRE_lADOABII586wwtHgzwAAAAQBMWYZ",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/17199883801",
      "actor": {
        "login": "maflcko",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/maflcko",
        "html_url": "https://github.com/maflcko",
        "followers_url": "https://api.github.com/users/maflcko/followers",
        "following_url": "https://api.github.com/users/maflcko/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/maflcko/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/maflcko/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/maflcko/subscriptions",
        "organizations_url": "https://api.github.com/users/maflcko/orgs",
        "repos_url": "https://api.github.com/users/maflcko/repos",
        "events_url": "https://api.github.com/users/maflcko/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/maflcko/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-04-10T06:02:02Z",
      "requested_reviewer": {
        "login": "marcofleon",
        "id": 95179662,
        "node_id": "U_kgDOBaxTjg",
        "avatar_url": "https://avatars.githubusercontent.com/u/95179662?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/marcofleon",
        "html_url": "https://github.com/marcofleon",
        "followers_url": "https://api.github.com/users/marcofleon/followers",
        "following_url": "https://api.github.com/users/marcofleon/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/marcofleon/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/marcofleon/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/marcofleon/subscriptions",
        "organizations_url": "https://api.github.com/users/marcofleon/orgs",
        "repos_url": "https://api.github.com/users/marcofleon/repos",
        "events_url": "https://api.github.com/users/marcofleon/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/marcofleon/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "review_requester": {
        "login": "maflcko",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/maflcko",
        "html_url": "https://github.com/maflcko",
        "followers_url": "https://api.github.com/users/maflcko/followers",
        "following_url": "https://api.github.com/users/maflcko/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/maflcko/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/maflcko/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/maflcko/subscriptions",
        "organizations_url": "https://api.github.com/users/maflcko/orgs",
        "repos_url": "https://api.github.com/users/maflcko/repos",
        "events_url": "https://api.github.com/users/maflcko/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/maflcko/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      }
    },
    {
      "event": "reviewed",
      "id": 2755940116,
      "node_id": "PRR_kwDOABII586kRE8U",
      "url": null,
      "actor": null,
      "commit_id": "faa3ce31998cdbdcb888132b0d38ee7a1e743682",
      "commit_url": null,
      "created_at": null,
      "author_association": "CONTRIBUTOR",
      "body": "ACK faa3ce31998cdbdcb888132b0d38ee7a1e743682\r\n\r\n[coverage on master](https://marcofleon.github.io/coverage/p2pheaderspresync_master/)\r\n[coverage on this PR](https://marcofleon.github.io/coverage/p2pheaderpresync_32198/)\r\n\r\nCoverage on this PR is just from a run overnight but seems to be about the same where it counts.\r\n\r\nI've run the script 10 times or so and the determinism is looking good!",
      "user": {
        "login": "marcofleon",
        "id": 95179662,
        "node_id": "U_kgDOBaxTjg",
        "avatar_url": "https://avatars.githubusercontent.com/u/95179662?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/marcofleon",
        "html_url": "https://github.com/marcofleon",
        "followers_url": "https://api.github.com/users/marcofleon/followers",
        "following_url": "https://api.github.com/users/marcofleon/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/marcofleon/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/marcofleon/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/marcofleon/subscriptions",
        "organizations_url": "https://api.github.com/users/marcofleon/orgs",
        "repos_url": "https://api.github.com/users/marcofleon/repos",
        "events_url": "https://api.github.com/users/marcofleon/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/marcofleon/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32198#pullrequestreview-2755940116",
      "submitted_at": "2025-04-10T09:08:16Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/32198"
    },
    {
      "event": "commented",
      "id": 2792610624,
      "node_id": "IC_kwDOABII586mc9tA",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2792610624",
      "actor": {
        "login": "Crypt-iQ",
        "id": 15145615,
        "node_id": "MDQ6VXNlcjE1MTQ1NjE1",
        "avatar_url": "https://avatars.githubusercontent.com/u/15145615?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Crypt-iQ",
        "html_url": "https://github.com/Crypt-iQ",
        "followers_url": "https://api.github.com/users/Crypt-iQ/followers",
        "following_url": "https://api.github.com/users/Crypt-iQ/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Crypt-iQ/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Crypt-iQ/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Crypt-iQ/subscriptions",
        "organizations_url": "https://api.github.com/users/Crypt-iQ/orgs",
        "repos_url": "https://api.github.com/users/Crypt-iQ/repos",
        "events_url": "https://api.github.com/users/Crypt-iQ/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Crypt-iQ/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-04-10T12:40:23Z",
      "updated_at": "2025-04-10T12:40:23Z",
      "author_association": "CONTRIBUTOR",
      "body": "tACK faf4c1b6fc330885ddf84b643838d1e301aaeab2\r\n\r\nHave verified that the shuffle change in the first commit gets rid of the non-determinism.  Just a question, does disabling the scheduler remove some important coverage that otherwise wouldn't be hit?",
      "user": {
        "login": "Crypt-iQ",
        "id": 15145615,
        "node_id": "MDQ6VXNlcjE1MTQ1NjE1",
        "avatar_url": "https://avatars.githubusercontent.com/u/15145615?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Crypt-iQ",
        "html_url": "https://github.com/Crypt-iQ",
        "followers_url": "https://api.github.com/users/Crypt-iQ/followers",
        "following_url": "https://api.github.com/users/Crypt-iQ/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Crypt-iQ/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Crypt-iQ/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Crypt-iQ/subscriptions",
        "organizations_url": "https://api.github.com/users/Crypt-iQ/orgs",
        "repos_url": "https://api.github.com/users/Crypt-iQ/repos",
        "events_url": "https://api.github.com/users/Crypt-iQ/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Crypt-iQ/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32198#issuecomment-2792610624",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/32198"
    }
  ],
  "comments": []
}
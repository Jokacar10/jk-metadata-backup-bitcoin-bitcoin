{
  "type": "pull",
  "pull": {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29442",
    "id": 1729853245,
    "node_id": "PR_kwDOABII585nG3c9",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/29442",
    "diff_url": "https://github.com/bitcoin/bitcoin/pull/29442.diff",
    "patch_url": "https://github.com/bitcoin/bitcoin/pull/29442.patch",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29442",
    "commits_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29442/commits",
    "review_comments_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29442/comments",
    "review_comment_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments%7B/number%7D",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29442/comments",
    "statuses_url": "https://api.github.com/repos/bitcoin/bitcoin/statuses/2efadb1b47611f714609c2b147d17aaac818ddc4",
    "number": 29442,
    "state": "closed",
    "locked": true,
    "maintainer_can_modify": false,
    "title": "wallet: Target a pre-defined utxo set composition by adjusting change outputs",
    "user": {
      "login": "remyers",
      "id": 8568892,
      "node_id": "MDQ6VXNlcjg1Njg4OTI=",
      "avatar_url": "https://avatars.githubusercontent.com/u/8568892?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/remyers",
      "html_url": "https://github.com/remyers",
      "followers_url": "https://api.github.com/users/remyers/followers",
      "following_url": "https://api.github.com/users/remyers/following%7B/other_user%7D",
      "gists_url": "https://api.github.com/users/remyers/gists%7B/gist_id%7D",
      "starred_url": "https://api.github.com/users/remyers/starred%7B/owner%7D%7B/repo%7D",
      "subscriptions_url": "https://api.github.com/users/remyers/subscriptions",
      "organizations_url": "https://api.github.com/users/remyers/orgs",
      "repos_url": "https://api.github.com/users/remyers/repos",
      "events_url": "https://api.github.com/users/remyers/events%7B/privacy%7D",
      "received_events_url": "https://api.github.com/users/remyers/received_events",
      "type": "User",
      "site_admin": false,
      "patch_url": null
    },
    "body": "This PR is designed for the use case of a Lightning node that provides liquidity of predefined amounts via [liquidity ads](https://github.com/lightning/bolts/pull/878).\r\n\r\nCoin selection is currently optimized to reduce the size of the utxo set and create change optimized for privacy. A liquidity provider instead needs to service multiple liquidity requests by spending confirmed utxos of known sizes.\r\n\r\nIdeally most liquidity transactions would be funded by a single input or a small set of inputs optimized to reduce fees. To minimize the number of unconfirmed transactions, inputs should also be sized in a range where most transactions do not produce change. When change is created, it should be divided into outputs of the sizes needed so that the wallet's utxo set converges towards an ideal utxo set specified by the user.\r\n\r\nI am opening this PR as a draft to get feedback and suggestions on the concept and my implementation to address this use case.\r\n\r\nThe algorithm described below can be implemented externally via RPC calls or directly in the wallet. \r\n\r\n1. Externally: use a new option to set the change target used for coin selection. \r\n2. Wallet (opportunistic): a new configuration file defines the desired utxo set which the wallet uses to compute the change target used for coin selection and to split change outputs (if any). \r\n4. Wallet (reactive/proactive):  pre-select a large input to force coin selection to produce change when fees are below some specified threshold or the desired set of utxos falls below some threshold. \r\n\r\n## utxo targets file example:\r\n\r\n```json\r\n{\r\n    \"buckets\": [\r\n        {\r\n            \"start_satoshis\": 10000,\r\n            \"end_satoshis\": 25000,\r\n            \"target_utxo_count\": 150\r\n        },\r\n        {\r\n            \"start_satoshis\": 50000,\r\n            \"end_satoshis\": 75000,\r\n            \"target_utxo_count\": 50\r\n        },\r\n        {\r\n            \"start_satoshis\": 200000,\r\n            \"end_satoshis\": 250000,\r\n            \"target_utxo_count\": 20\r\n        },\r\n        {\r\n            \"start_satoshis\": 1000000,\r\n            \"end_satoshis\": 1400000,\r\n            \"target_utxo_count\": 5\r\n        }\r\n    ],\r\n    \"bucket_refill_feerate\": 30000\r\n}\r\n```\r\n - The `target_utxo_count` for a bucket should be larger than the anticipated number of liquidity requests of `bucket_start_satoshis` within the expected confirmation time of a liquidity transaction.\r\n - The range from `bucket_start_satoshis` to `bucket_end_satoshis` should encompass expected fee variance.\r\n - The `bucket_refill_feerate` should be set to the expected median fee rate (?).\r\n - This file will be reloaded for every spend request to allow for on-the-fly updates\r\n\r\n## Algorithm steps\r\n\r\nFor each payment do the following:\r\n\r\n1) Calculate the current capacity of each target bucket from the wallet's utxo set.\r\n    - Include outputs from both confirmed and unconfirmed transactions in the wallet to calculate capacity.\r\n2) Add our largest confirmed utxo as an input IF the capacity of the least full target bucket is below some threshold (eg. < 30% full) or less than some higher threshold (eg. < 70%) and fee rates are below the `bucket_refill_feerate`.\r\n    - When the largest confirmed utxo is from one of our target buckets, then we should refill our wallet with a utxo from cold storage.\r\n3) Set the minimum change target [`m_min_change_target`](https://github.com/bitcoin/bitcoin/blob/3054416f62644120a4a6bc76e927054c7fbbd487/src/wallet/coinselection.h#L147) to a value from the target bucket with the lowest current capacity.\r\n    - Generate a random change target of the amount: current `change_fee` (the fee for creating an output) + a random value in the range: `bucket_start_satoshis` to `bucket_end_satoshi` - `change_fee`.\r\n    - Currently the change target is set by [`GenerateChangeTarget()`](https://github.com/bitcoin/bitcoin/blob/6ff0aa089c01ff3e610ecb47814ed739d685a14c/src/wallet/coinselection.cpp#L824) in a hard coded range.\r\n    - This parameter is only used by the 'knapsack' and 'coingrinder' algorithms.\r\n4) Call ['SelectCoins()'](https://github.com/bitcoin/bitcoin/blob/3054416f62644120a4a6bc76e927054c7fbbd487/src/wallet/spend.cpp#L1132) with the input from step 2 (if any) added to the `preset_inputs` parameter and with the minimum change target from step 3.\r\n    - The `consolidatefeerate=0` configuration option should always be set so that utxos are not preemptively cosolidated. Coin selection sets the parameter [`m_long_term_feerate`](https://github.com/bitcoin/bitcoin/blob/37fdf5a492786c1772b5b40773a1031237447070/src/wallet/coinselection.h#L160) to the wallets `consolidatefeerate`.\r\n    - Ideally, only the 'bnb' and 'cg' coin selection algorithms should be used and the others disabled to optimize for low fees.\r\n5) If the coin selection result includes a change output, then split the single change output amount into multiple outputs.\r\n    - Add the mimimum change target as an output first.\r\n    - If there is remaining value after paying the fee for a new output, then add a target from the next most empty target bucket.\r\n    - If there is not enough value to add a new output and fees, add remaining value to the last output added instead.\r\n\r\n",
    "labels": [
      {
        "id": 149424,
        "node_id": "MDU6TGFiZWwxNDk0MjQ=",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Wallet",
        "name": "Wallet",
        "color": "08a781",
        "default": false
      },
      {
        "id": 955867938,
        "node_id": "MDU6TGFiZWw5NTU4Njc5Mzg=",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Needs%20rebase",
        "name": "Needs rebase",
        "description": "",
        "color": "cccccc",
        "default": false
      },
      {
        "id": 5334691551,
        "node_id": "LA_kwDOABII588AAAABPfju3w",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/CI%20failed",
        "name": "CI failed",
        "description": "",
        "color": "cccccc",
        "default": false
      }
    ],
    "created_at": "2024-02-16T16:45:09Z",
    "updated_at": "2025-05-14T06:07:13Z",
    "closed_at": "2024-05-13T09:25:15Z",
    "mergeable": false,
    "mergeable_state": "dirty",
    "merged": false,
    "merge_commit_sha": "0301b634f93a7b9ac38fbc116b138c64a17ca7ba",
    "assignees": [],
    "requested_reviewers": [],
    "requested_teams": [],
    "rebaseable": false,
    "head": {
      "label": "remyers:2024-02-change-target",
      "ref": "2024-02-change-target",
      "sha": "2efadb1b47611f714609c2b147d17aaac818ddc4",
      "user": {
        "login": "remyers",
        "id": 8568892,
        "node_id": "MDQ6VXNlcjg1Njg4OTI=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8568892?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/remyers",
        "html_url": "https://github.com/remyers",
        "followers_url": "https://api.github.com/users/remyers/followers",
        "following_url": "https://api.github.com/users/remyers/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/remyers/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/remyers/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/remyers/subscriptions",
        "organizations_url": "https://api.github.com/users/remyers/orgs",
        "repos_url": "https://api.github.com/users/remyers/repos",
        "events_url": "https://api.github.com/users/remyers/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/remyers/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "repo": {
        "id": 221530299,
        "node_id": "MDEwOlJlcG9zaXRvcnkyMjE1MzAyOTk=",
        "name": "bitcoin",
        "full_name": "remyers/bitcoin",
        "owner": {
          "login": "remyers",
          "id": 8568892,
          "node_id": "MDQ6VXNlcjg1Njg4OTI=",
          "avatar_url": "https://avatars.githubusercontent.com/u/8568892?v=4",
          "gravatar_id": "",
          "url": "https://api.github.com/users/remyers",
          "html_url": "https://github.com/remyers",
          "followers_url": "https://api.github.com/users/remyers/followers",
          "following_url": "https://api.github.com/users/remyers/following%7B/other_user%7D",
          "gists_url": "https://api.github.com/users/remyers/gists%7B/gist_id%7D",
          "starred_url": "https://api.github.com/users/remyers/starred%7B/owner%7D%7B/repo%7D",
          "subscriptions_url": "https://api.github.com/users/remyers/subscriptions",
          "organizations_url": "https://api.github.com/users/remyers/orgs",
          "repos_url": "https://api.github.com/users/remyers/repos",
          "events_url": "https://api.github.com/users/remyers/events%7B/privacy%7D",
          "received_events_url": "https://api.github.com/users/remyers/received_events",
          "type": "User",
          "site_admin": false,
          "patch_url": null
        },
        "private": false,
        "html_url": "https://github.com/remyers/bitcoin",
        "description": "Bitcoin Core integration/staging tree",
        "fork": true,
        "url": "https://api.github.com/repos/remyers/bitcoin",
        "archive_url": "https://api.github.com/repos/remyers/bitcoin/%7Barchive_format%7D%7B/ref%7D",
        "assignees_url": "https://api.github.com/repos/remyers/bitcoin/assignees%7B/user%7D",
        "blobs_url": "https://api.github.com/repos/remyers/bitcoin/git/blobs%7B/sha%7D",
        "branches_url": "https://api.github.com/repos/remyers/bitcoin/branches%7B/branch%7D",
        "collaborators_url": "https://api.github.com/repos/remyers/bitcoin/collaborators%7B/collaborator%7D",
        "comments_url": "https://api.github.com/repos/remyers/bitcoin/comments%7B/number%7D",
        "commits_url": "https://api.github.com/repos/remyers/bitcoin/commits%7B/sha%7D",
        "compare_url": "https://api.github.com/repos/remyers/bitcoin/compare/%7Bbase%7D...%7Bhead%7D",
        "contents_url": "https://api.github.com/repos/remyers/bitcoin/contents/%7B+path%7D",
        "contributors_url": "https://api.github.com/repos/remyers/bitcoin/contributors",
        "deployments_url": "https://api.github.com/repos/remyers/bitcoin/deployments",
        "downloads_url": "https://api.github.com/repos/remyers/bitcoin/downloads",
        "events_url": "https://api.github.com/repos/remyers/bitcoin/events",
        "forks_url": "https://api.github.com/repos/remyers/bitcoin/forks",
        "git_commits_url": "https://api.github.com/repos/remyers/bitcoin/git/commits%7B/sha%7D",
        "git_refs_url": "https://api.github.com/repos/remyers/bitcoin/git/refs%7B/sha%7D",
        "git_tags_url": "https://api.github.com/repos/remyers/bitcoin/git/tags%7B/sha%7D",
        "git_url": "git://github.com/remyers/bitcoin.git",
        "issue_comment_url": "https://api.github.com/repos/remyers/bitcoin/issues/comments%7B/number%7D",
        "issue_events_url": "https://api.github.com/repos/remyers/bitcoin/issues/events%7B/number%7D",
        "issues_url": "https://api.github.com/repos/remyers/bitcoin/issues%7B/number%7D",
        "keys_url": "https://api.github.com/repos/remyers/bitcoin/keys%7B/key_id%7D",
        "labels_url": "https://api.github.com/repos/remyers/bitcoin/labels%7B/name%7D",
        "languages_url": "https://api.github.com/repos/remyers/bitcoin/languages",
        "merges_url": "https://api.github.com/repos/remyers/bitcoin/merges",
        "milestones_url": "https://api.github.com/repos/remyers/bitcoin/milestones%7B/number%7D",
        "notifications_url": "https://api.github.com/repos/remyers/bitcoin/notifications%7B?since,all,participating}",
        "pulls_url": "https://api.github.com/repos/remyers/bitcoin/pulls%7B/number%7D",
        "releases_url": "https://api.github.com/repos/remyers/bitcoin/releases%7B/id%7D",
        "ssh_url": "git@github.com:remyers/bitcoin.git",
        "stargazers_url": "https://api.github.com/repos/remyers/bitcoin/stargazers",
        "statuses_url": "https://api.github.com/repos/remyers/bitcoin/statuses/%7Bsha%7D",
        "subscribers_url": "https://api.github.com/repos/remyers/bitcoin/subscribers",
        "subscription_url": "https://api.github.com/repos/remyers/bitcoin/subscription",
        "tags_url": "https://api.github.com/repos/remyers/bitcoin/tags",
        "teams_url": "https://api.github.com/repos/remyers/bitcoin/teams",
        "trees_url": "https://api.github.com/repos/remyers/bitcoin/git/trees%7B/sha%7D",
        "clone_url": "https://github.com/remyers/bitcoin.git",
        "hooks_url": "https://api.github.com/repos/remyers/bitcoin/hooks",
        "svn_url": "https://github.com/remyers/bitcoin",
        "homepage": "https://bitcoin.org/en/download",
        "language": "C++",
        "forks_count": 0,
        "stargazers_count": 1,
        "watchers_count": 1,
        "size": 229997,
        "default_branch": "master",
        "open_issues_count": 0,
        "is_template": false,
        "topics": [],
        "has_issues": false,
        "has_projects": true,
        "has_wiki": false,
        "has_pages": true,
        "has_downloads": false,
        "archived": false,
        "disabled": false,
        "visibility": "public",
        "pushed_at": "2024-09-16T10:15:17Z",
        "created_at": "2019-11-13T18:56:20Z",
        "updated_at": "2024-09-02T12:35:26Z",
        "allow_forking": true,
        "license": {
          "key": "mit",
          "name": "MIT License",
          "node_id": "MDc6TGljZW5zZTEz",
          "spdx_id": "MIT",
          "url": "https://api.github.com/licenses/mit",
          "html_url": null,
          "description": null,
          "implementation": null,
          "permissions": null,
          "conditions": null,
          "limitations": null,
          "body": null,
          "featured": null
        }
      }
    },
    "base": {
      "label": "bitcoin:master",
      "ref": "master",
      "sha": "0de63b8b46eff5cda85b4950062703324ba65a80",
      "user": {
        "login": "bitcoin",
        "id": 528860,
        "node_id": "MDEyOk9yZ2FuaXphdGlvbjUyODg2MA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/528860?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/bitcoin",
        "html_url": "https://github.com/bitcoin",
        "followers_url": "https://api.github.com/users/bitcoin/followers",
        "following_url": "https://api.github.com/users/bitcoin/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/bitcoin/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/bitcoin/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/bitcoin/subscriptions",
        "organizations_url": "https://api.github.com/users/bitcoin/orgs",
        "repos_url": "https://api.github.com/users/bitcoin/repos",
        "events_url": "https://api.github.com/users/bitcoin/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/bitcoin/received_events",
        "type": "Organization",
        "site_admin": false,
        "patch_url": null
      },
      "repo": {
        "id": 1181927,
        "node_id": "MDEwOlJlcG9zaXRvcnkxMTgxOTI3",
        "name": "bitcoin",
        "full_name": "bitcoin/bitcoin",
        "owner": {
          "login": "bitcoin",
          "id": 528860,
          "node_id": "MDEyOk9yZ2FuaXphdGlvbjUyODg2MA==",
          "avatar_url": "https://avatars.githubusercontent.com/u/528860?v=4",
          "gravatar_id": "",
          "url": "https://api.github.com/users/bitcoin",
          "html_url": "https://github.com/bitcoin",
          "followers_url": "https://api.github.com/users/bitcoin/followers",
          "following_url": "https://api.github.com/users/bitcoin/following%7B/other_user%7D",
          "gists_url": "https://api.github.com/users/bitcoin/gists%7B/gist_id%7D",
          "starred_url": "https://api.github.com/users/bitcoin/starred%7B/owner%7D%7B/repo%7D",
          "subscriptions_url": "https://api.github.com/users/bitcoin/subscriptions",
          "organizations_url": "https://api.github.com/users/bitcoin/orgs",
          "repos_url": "https://api.github.com/users/bitcoin/repos",
          "events_url": "https://api.github.com/users/bitcoin/events%7B/privacy%7D",
          "received_events_url": "https://api.github.com/users/bitcoin/received_events",
          "type": "Organization",
          "site_admin": false,
          "patch_url": null
        },
        "private": false,
        "html_url": "https://github.com/bitcoin/bitcoin",
        "description": "Bitcoin Core integration/staging tree",
        "fork": false,
        "url": "https://api.github.com/repos/bitcoin/bitcoin",
        "archive_url": "https://api.github.com/repos/bitcoin/bitcoin/%7Barchive_format%7D%7B/ref%7D",
        "assignees_url": "https://api.github.com/repos/bitcoin/bitcoin/assignees%7B/user%7D",
        "blobs_url": "https://api.github.com/repos/bitcoin/bitcoin/git/blobs%7B/sha%7D",
        "branches_url": "https://api.github.com/repos/bitcoin/bitcoin/branches%7B/branch%7D",
        "collaborators_url": "https://api.github.com/repos/bitcoin/bitcoin/collaborators%7B/collaborator%7D",
        "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/comments%7B/number%7D",
        "commits_url": "https://api.github.com/repos/bitcoin/bitcoin/commits%7B/sha%7D",
        "compare_url": "https://api.github.com/repos/bitcoin/bitcoin/compare/%7Bbase%7D...%7Bhead%7D",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/%7B+path%7D",
        "contributors_url": "https://api.github.com/repos/bitcoin/bitcoin/contributors",
        "deployments_url": "https://api.github.com/repos/bitcoin/bitcoin/deployments",
        "downloads_url": "https://api.github.com/repos/bitcoin/bitcoin/downloads",
        "events_url": "https://api.github.com/repos/bitcoin/bitcoin/events",
        "forks_url": "https://api.github.com/repos/bitcoin/bitcoin/forks",
        "git_commits_url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits%7B/sha%7D",
        "git_refs_url": "https://api.github.com/repos/bitcoin/bitcoin/git/refs%7B/sha%7D",
        "git_tags_url": "https://api.github.com/repos/bitcoin/bitcoin/git/tags%7B/sha%7D",
        "git_url": "git://github.com/bitcoin/bitcoin.git",
        "issue_comment_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments%7B/number%7D",
        "issue_events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events%7B/number%7D",
        "issues_url": "https://api.github.com/repos/bitcoin/bitcoin/issues%7B/number%7D",
        "keys_url": "https://api.github.com/repos/bitcoin/bitcoin/keys%7B/key_id%7D",
        "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/labels%7B/name%7D",
        "languages_url": "https://api.github.com/repos/bitcoin/bitcoin/languages",
        "merges_url": "https://api.github.com/repos/bitcoin/bitcoin/merges",
        "milestones_url": "https://api.github.com/repos/bitcoin/bitcoin/milestones%7B/number%7D",
        "notifications_url": "https://api.github.com/repos/bitcoin/bitcoin/notifications%7B?since,all,participating}",
        "pulls_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls%7B/number%7D",
        "releases_url": "https://api.github.com/repos/bitcoin/bitcoin/releases%7B/id%7D",
        "ssh_url": "git@github.com:bitcoin/bitcoin.git",
        "stargazers_url": "https://api.github.com/repos/bitcoin/bitcoin/stargazers",
        "statuses_url": "https://api.github.com/repos/bitcoin/bitcoin/statuses/%7Bsha%7D",
        "subscribers_url": "https://api.github.com/repos/bitcoin/bitcoin/subscribers",
        "subscription_url": "https://api.github.com/repos/bitcoin/bitcoin/subscription",
        "tags_url": "https://api.github.com/repos/bitcoin/bitcoin/tags",
        "teams_url": "https://api.github.com/repos/bitcoin/bitcoin/teams",
        "trees_url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees%7B/sha%7D",
        "clone_url": "https://github.com/bitcoin/bitcoin.git",
        "hooks_url": "https://api.github.com/repos/bitcoin/bitcoin/hooks",
        "svn_url": "https://github.com/bitcoin/bitcoin",
        "homepage": "https://bitcoincore.org/en/download",
        "language": "C++",
        "forks_count": 37215,
        "stargazers_count": 83559,
        "watchers_count": 83559,
        "size": 281882,
        "default_branch": "master",
        "open_issues_count": 724,
        "is_template": false,
        "topics": [
          "bitcoin",
          "c-plus-plus",
          "cryptocurrency",
          "cryptography",
          "p2p"
        ],
        "has_issues": true,
        "has_projects": true,
        "has_wiki": false,
        "has_pages": false,
        "has_downloads": false,
        "archived": false,
        "disabled": false,
        "visibility": "public",
        "pushed_at": "2025-05-13T20:50:40Z",
        "created_at": "2010-12-19T15:16:43Z",
        "updated_at": "2025-05-14T05:57:23Z",
        "allow_forking": true,
        "license": {
          "key": "mit",
          "name": "MIT License",
          "node_id": "MDc6TGljZW5zZTEz",
          "spdx_id": "MIT",
          "url": "https://api.github.com/licenses/mit",
          "html_url": null,
          "description": null,
          "implementation": null,
          "permissions": null,
          "conditions": null,
          "limitations": null,
          "body": null,
          "featured": null
        }
      }
    },
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29442"
      }
    },
    "author_association": "CONTRIBUTOR",
    "draft": true,
    "additions": 402,
    "deletions": 38,
    "changed_files": 11,
    "commits": 8,
    "review_comments": 7,
    "comments": 11
  },
  "events": [
    {
      "event": "commented",
      "id": 1948862298,
      "node_id": "IC_kwDOABII5850KUda",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1948862298",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-02-16T16:45:12Z",
      "updated_at": "2024-04-26T02:36:50Z",
      "author_association": "CONTRIBUTOR",
      "body": "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--006a51241073e994b41acfe9ec718e94-->\n### Code Coverage\nFor detailed information about the code coverage, see the [test coverage report](https://corecheck.dev/bitcoin/bitcoin/pulls/29442).\n<!--021abf342d371248e50ceaed478a90ca-->\n### Reviews\nSee [the guideline](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#code-review) for information on the review process.\nA summary of reviews will appear here.\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* [#29906](https://github.com/bitcoin/bitcoin/pull/29906) (Disable util::Result copying and assignment by ryanofsky)\n* [#29700](https://github.com/bitcoin/bitcoin/pull/29700) (kernel, refactor: return error status on all fatal errors by ryanofsky)\n* [#29523](https://github.com/bitcoin/bitcoin/pull/29523) (Wallet:  Add `max_tx_weight` to transaction funding options (take 2) by ismaelsadeeq)\n* [#29015](https://github.com/bitcoin/bitcoin/pull/29015) (kernel: Streamline util library by ryanofsky)\n* [#28366](https://github.com/bitcoin/bitcoin/pull/28366) (Fix waste calculation in SelectionResult by murchandamus)\n* [#28201](https://github.com/bitcoin/bitcoin/pull/28201) (Silent Payments: sending by josibake)\n* [#26606](https://github.com/bitcoin/bitcoin/pull/26606) (wallet: Implement independent BDB parser by achow101)\n* [#26596](https://github.com/bitcoin/bitcoin/pull/26596) (wallet: Migrate legacy wallets to descriptor wallets without requiring BDB by achow101)\n* [#26022](https://github.com/bitcoin/bitcoin/pull/26022) (Add util::ResultPtr class by ryanofsky)\n* [#25722](https://github.com/bitcoin/bitcoin/pull/25722) (refactor: Use util::Result class for wallet loading by ryanofsky)\n* [#25665](https://github.com/bitcoin/bitcoin/pull/25665) (refactor: Add util::Result failure values, multiple error and warning messages by ryanofsky)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.\n",
      "user": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29442#issuecomment-1948862298",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29442"
    },
    {
      "event": "labeled",
      "id": 11831179519,
      "node_id": "LE_lADOABII585_fkYfzwAAAALBMXj_",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/11831179519",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-02-16T16:45:14Z",
      "label": {
        "name": "Wallet",
        "color": "08a781"
      }
    },
    {
      "event": "head_ref_force_pushed",
      "id": 11831263913,
      "node_id": "HRFPE_lADOABII585_fkYfzwAAAALBMsKp",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/11831263913",
      "actor": {
        "login": "remyers",
        "id": 8568892,
        "node_id": "MDQ6VXNlcjg1Njg4OTI=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8568892?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/remyers",
        "html_url": "https://github.com/remyers",
        "followers_url": "https://api.github.com/users/remyers/followers",
        "following_url": "https://api.github.com/users/remyers/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/remyers/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/remyers/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/remyers/subscriptions",
        "organizations_url": "https://api.github.com/users/remyers/orgs",
        "repos_url": "https://api.github.com/users/remyers/repos",
        "events_url": "https://api.github.com/users/remyers/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/remyers/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": "a2145480918673ad23345d5f28992b67108d11f9",
      "commit_url": "https://api.github.com/repos/remyers/bitcoin/commits/a2145480918673ad23345d5f28992b67108d11f9",
      "created_at": "2024-02-16T16:53:06Z"
    },
    {
      "event": "labeled",
      "id": 11831265260,
      "node_id": "LE_lADOABII585_fkYfzwAAAALBMsfs",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/11831265260",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-02-16T16:53:12Z",
      "label": {
        "name": "CI failed",
        "color": "cccccc"
      }
    },
    {
      "event": "commented",
      "id": 1948874005,
      "node_id": "IC_kwDOABII5850KXUV",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1948874005",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-02-16T16:53:13Z",
      "updated_at": "2024-02-16T16:53:13Z",
      "author_association": "CONTRIBUTOR",
      "body": "<!--85328a0da195eb286784d51f73fa0af9-->\n\n🚧 At least one of the CI tasks failed. Make sure to run all tests locally, according to the\ndocumentation.\n\nPossibly this is due to a silent merge conflict (the changes in this pull request being\nincompatible with the current code in the target branch). If so, make sure to rebase on the latest\ncommit of the target branch.\n\nLeave a comment here, if you need help tracking down a confusing failure.\n\n<sub>Debug: https://github.com/bitcoin/bitcoin/runs/21662752091</sub>",
      "user": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29442#issuecomment-1948874005",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29442"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 11832889282,
      "node_id": "HRFPE_lADOABII585_fkYfzwAAAALBS4_C",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/11832889282",
      "actor": {
        "login": "remyers",
        "id": 8568892,
        "node_id": "MDQ6VXNlcjg1Njg4OTI=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8568892?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/remyers",
        "html_url": "https://github.com/remyers",
        "followers_url": "https://api.github.com/users/remyers/followers",
        "following_url": "https://api.github.com/users/remyers/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/remyers/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/remyers/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/remyers/subscriptions",
        "organizations_url": "https://api.github.com/users/remyers/orgs",
        "repos_url": "https://api.github.com/users/remyers/repos",
        "events_url": "https://api.github.com/users/remyers/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/remyers/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": "b246995aef46f6816095c23af270d4213dae4456",
      "commit_url": "https://api.github.com/repos/remyers/bitcoin/commits/b246995aef46f6816095c23af270d4213dae4456",
      "created_at": "2024-02-16T19:29:54Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 11834253537,
      "node_id": "HRFPE_lADOABII585_fkYfzwAAAALBYGDh",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/11834253537",
      "actor": {
        "login": "remyers",
        "id": 8568892,
        "node_id": "MDQ6VXNlcjg1Njg4OTI=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8568892?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/remyers",
        "html_url": "https://github.com/remyers",
        "followers_url": "https://api.github.com/users/remyers/followers",
        "following_url": "https://api.github.com/users/remyers/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/remyers/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/remyers/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/remyers/subscriptions",
        "organizations_url": "https://api.github.com/users/remyers/orgs",
        "repos_url": "https://api.github.com/users/remyers/repos",
        "events_url": "https://api.github.com/users/remyers/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/remyers/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": "85a049ddceb854106efea8316462e356d9b88b21",
      "commit_url": "https://api.github.com/repos/remyers/bitcoin/commits/85a049ddceb854106efea8316462e356d9b88b21",
      "created_at": "2024-02-16T22:20:27Z"
    },
    {
      "event": "unlabeled",
      "id": 11834570500,
      "node_id": "UNLE_lADOABII585_fkYfzwAAAALBZTcE",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/11834570500",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-02-16T23:19:45Z",
      "label": {
        "name": "CI failed",
        "color": "cccccc"
      }
    },
    {
      "event": "commented",
      "id": 1952151548,
      "node_id": "IC_kwDOABII5850W3f8",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1952151548",
      "actor": {
        "login": "t-bast",
        "id": 31281497,
        "node_id": "MDQ6VXNlcjMxMjgxNDk3",
        "avatar_url": "https://avatars.githubusercontent.com/u/31281497?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/t-bast",
        "html_url": "https://github.com/t-bast",
        "followers_url": "https://api.github.com/users/t-bast/followers",
        "following_url": "https://api.github.com/users/t-bast/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/t-bast/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/t-bast/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/t-bast/subscriptions",
        "organizations_url": "https://api.github.com/users/t-bast/orgs",
        "repos_url": "https://api.github.com/users/t-bast/repos",
        "events_url": "https://api.github.com/users/t-bast/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/t-bast/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-02-19T10:30:39Z",
      "updated_at": "2024-02-19T10:30:39Z",
      "author_association": "CONTRIBUTOR",
      "body": "@murchandamus we'd love to get your feedback on this! I'll try to summarize at a higher level what we'd like to achieve.\r\n\r\nThe `bitcoind` wallet currently tries to keep a somewhat \"minimal\" utxo set and actively consolidates user utxos, because it assumes that we receive transactions as much (or more) than we send transactions and wants outgoing transactions to be as cheap as possible. But that's not true of liquidity service providers, who usually only receive funds when refilling the wallet from cold storage, and want to make sure they always have enough confirmed utxos to satisfy user demand efficiently. In such cases, the wallet operator has a good idea of what they'd like their utxo pool to look like (because they're selling a limited sets of specific amounts), and would like `bitcoind` to try to maintain that utxo pool as much as possible, while optimizing mostly for transaction weight, especially when feerate is high (above a user-defined threshold, similar to `consolidatefeerate` but with the exact opposite semantics - when below that threshold, we want to actively _create_ more utxos, not _consolidate_ them).\r\n\r\nWe can think of this type of wallet as a slowly draining wallet: its total amount is linearly decreasing over time, and is occasionally topped-up from cold storage.\r\n\r\nWe're not sure how to best achieve that. Our goal is to do it inside `bitcoind` (which is the source of truth for the wallet state), but with minimal changes to the coin selection code itself. We'd like this to be as much as possible done by simply pre-processing inputs to the coin selection algorithms and post-processing their outputs, which would make this:\r\n\r\n- easy to rebase on top of bitcoind releases if this work doesn't make sense to be accepted into `bitcoind`\r\n- or as a user-configurable option if that PR can be merged to `bitcoind`",
      "user": {
        "login": "t-bast",
        "id": 31281497,
        "node_id": "MDQ6VXNlcjMxMjgxNDk3",
        "avatar_url": "https://avatars.githubusercontent.com/u/31281497?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/t-bast",
        "html_url": "https://github.com/t-bast",
        "followers_url": "https://api.github.com/users/t-bast/followers",
        "following_url": "https://api.github.com/users/t-bast/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/t-bast/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/t-bast/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/t-bast/subscriptions",
        "organizations_url": "https://api.github.com/users/t-bast/orgs",
        "repos_url": "https://api.github.com/users/t-bast/repos",
        "events_url": "https://api.github.com/users/t-bast/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/t-bast/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29442#issuecomment-1952151548",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29442"
    },
    {
      "event": "mentioned",
      "id": 11847586352,
      "node_id": "MEE_lADOABII585_fkYfzwAAAALCK9Iw",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/11847586352",
      "actor": {
        "login": "murchandamus",
        "id": 4060799,
        "node_id": "MDQ6VXNlcjQwNjA3OTk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/4060799?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/murchandamus",
        "html_url": "https://github.com/murchandamus",
        "followers_url": "https://api.github.com/users/murchandamus/followers",
        "following_url": "https://api.github.com/users/murchandamus/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/murchandamus/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/murchandamus/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/murchandamus/subscriptions",
        "organizations_url": "https://api.github.com/users/murchandamus/orgs",
        "repos_url": "https://api.github.com/users/murchandamus/repos",
        "events_url": "https://api.github.com/users/murchandamus/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/murchandamus/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-02-19T10:30:41Z"
    },
    {
      "event": "subscribed",
      "id": 11847586371,
      "node_id": "SE_lADOABII585_fkYfzwAAAALCK9JD",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/11847586371",
      "actor": {
        "login": "murchandamus",
        "id": 4060799,
        "node_id": "MDQ6VXNlcjQwNjA3OTk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/4060799?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/murchandamus",
        "html_url": "https://github.com/murchandamus",
        "followers_url": "https://api.github.com/users/murchandamus/followers",
        "following_url": "https://api.github.com/users/murchandamus/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/murchandamus/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/murchandamus/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/murchandamus/subscriptions",
        "organizations_url": "https://api.github.com/users/murchandamus/orgs",
        "repos_url": "https://api.github.com/users/murchandamus/repos",
        "events_url": "https://api.github.com/users/murchandamus/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/murchandamus/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-02-19T10:30:41Z"
    },
    {
      "event": "reviewed",
      "id": 1893495240,
      "node_id": "PRR_kwDOABII585w3HHI",
      "url": null,
      "actor": null,
      "commit_id": "85a049ddceb854106efea8316462e356d9b88b21",
      "commit_url": null,
      "created_at": null,
      "author_association": "CONTRIBUTOR",
      "body": "I really like the fact that it consists mostly of a pre-processing step before coin selection runs, followed by a post-processing step on the output of coin selection.\r\n\r\nShould we also tweak which coin selection algorithms are run depending on whether we're trying to refill buckets (and how aggressive we'd like to be) or not? Some of them may not be well suited for that?",
      "user": {
        "login": "t-bast",
        "id": 31281497,
        "node_id": "MDQ6VXNlcjMxMjgxNDk3",
        "avatar_url": "https://avatars.githubusercontent.com/u/31281497?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/t-bast",
        "html_url": "https://github.com/t-bast",
        "followers_url": "https://api.github.com/users/t-bast/followers",
        "following_url": "https://api.github.com/users/t-bast/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/t-bast/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/t-bast/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/t-bast/subscriptions",
        "organizations_url": "https://api.github.com/users/t-bast/orgs",
        "repos_url": "https://api.github.com/users/t-bast/repos",
        "events_url": "https://api.github.com/users/t-bast/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/t-bast/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29442#pullrequestreview-1893495240",
      "submitted_at": "2024-02-21T15:55:17Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29442"
    },
    {
      "event": "commented",
      "id": 1961125346,
      "node_id": "IC_kwDOABII58505GXi",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1961125346",
      "actor": {
        "login": "remyers",
        "id": 8568892,
        "node_id": "MDQ6VXNlcjg1Njg4OTI=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8568892?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/remyers",
        "html_url": "https://github.com/remyers",
        "followers_url": "https://api.github.com/users/remyers/followers",
        "following_url": "https://api.github.com/users/remyers/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/remyers/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/remyers/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/remyers/subscriptions",
        "organizations_url": "https://api.github.com/users/remyers/orgs",
        "repos_url": "https://api.github.com/users/remyers/repos",
        "events_url": "https://api.github.com/users/remyers/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/remyers/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-02-23T11:01:44Z",
      "updated_at": "2024-02-23T11:01:44Z",
      "author_association": "CONTRIBUTOR",
      "body": "> Should we also tweak which coin selection algorithms are run depending on whether we're trying to refill buckets (and how aggressive we'd like to be) or not? Some of them may not be well suited for that?\r\n\r\nYes, I think we should only run BnB and Coingrinder. Currently SRD and Knapsack are fallbacks that could win when BnB and CoinGrinder have higher waste metrics. When `consolidatefeerate=0` then `longTermFeeRate=0` and the waste metric used to compare the results of the different algorithms should be based on how much we overshoot the target value + how much it costs to add more inputs.\r\n```c\r\nwaste = selectionTotal - target + inputs × (currentFeeRate - longTermFeeRate)\r\n```\r\nIf one of the algorithms can find a solution with less overshoot than the cost of adding more (small value) inputs, then it seems like they would win. Coingrinder should always find a solution with the least input weight. \r\n\r\nWhen fees are high, I think we should not care if we overshoot our target. We should always prefer a changeless BnB solution over one with change. When we have to produce change, we would prefer the Coingrinder solution with minimal input weight. We will allocate change to outputs sized to favor BnB in the future.\r\n\r\nWhen fees are low, I think we will want to create more change to refill our target buckets, but still not favor more exact matches that use more inputs.",
      "user": {
        "login": "remyers",
        "id": 8568892,
        "node_id": "MDQ6VXNlcjg1Njg4OTI=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8568892?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/remyers",
        "html_url": "https://github.com/remyers",
        "followers_url": "https://api.github.com/users/remyers/followers",
        "following_url": "https://api.github.com/users/remyers/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/remyers/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/remyers/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/remyers/subscriptions",
        "organizations_url": "https://api.github.com/users/remyers/orgs",
        "repos_url": "https://api.github.com/users/remyers/repos",
        "events_url": "https://api.github.com/users/remyers/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/remyers/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29442#issuecomment-1961125346",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29442"
    },
    {
      "event": "commented",
      "id": 1963579537,
      "node_id": "IC_kwDOABII5851CdiR",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1963579537",
      "actor": {
        "login": "S3RK",
        "id": 1466284,
        "node_id": "MDQ6VXNlcjE0NjYyODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1466284?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/S3RK",
        "html_url": "https://github.com/S3RK",
        "followers_url": "https://api.github.com/users/S3RK/followers",
        "following_url": "https://api.github.com/users/S3RK/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/S3RK/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/S3RK/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/S3RK/subscriptions",
        "organizations_url": "https://api.github.com/users/S3RK/orgs",
        "repos_url": "https://api.github.com/users/S3RK/repos",
        "events_url": "https://api.github.com/users/S3RK/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/S3RK/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-02-26T08:37:58Z",
      "updated_at": "2024-02-26T08:37:58Z",
      "author_association": "CONTRIBUTOR",
      "body": "I think we should consider a pluggable architecture for coin selection algorithms.\r\n\r\nIt's clear that there are multiple personas using the bitcoin core wallet, e.g. merchant, customer, lightning wallets. They have different and conflicting needs. So we either will have to have a complicated code and configuration surface to reconcile them or make our code extendable. \r\n\r\nThe interface of coin selection is pretty well defined, so it seems like it is a good fit for extensibility. The coin selection plug-in could receive utxo_pool and target amount as inputs (plus maybe some additional info), and return selected utxo's as result. @remyers @t-bast would something like this work in your case?",
      "user": {
        "login": "S3RK",
        "id": 1466284,
        "node_id": "MDQ6VXNlcjE0NjYyODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1466284?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/S3RK",
        "html_url": "https://github.com/S3RK",
        "followers_url": "https://api.github.com/users/S3RK/followers",
        "following_url": "https://api.github.com/users/S3RK/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/S3RK/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/S3RK/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/S3RK/subscriptions",
        "organizations_url": "https://api.github.com/users/S3RK/orgs",
        "repos_url": "https://api.github.com/users/S3RK/repos",
        "events_url": "https://api.github.com/users/S3RK/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/S3RK/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29442#issuecomment-1963579537",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29442"
    },
    {
      "event": "mentioned",
      "id": 11917527211,
      "node_id": "MEE_lADOABII585_fkYfzwAAAALGVwir",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/11917527211",
      "actor": {
        "login": "remyers",
        "id": 8568892,
        "node_id": "MDQ6VXNlcjg1Njg4OTI=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8568892?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/remyers",
        "html_url": "https://github.com/remyers",
        "followers_url": "https://api.github.com/users/remyers/followers",
        "following_url": "https://api.github.com/users/remyers/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/remyers/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/remyers/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/remyers/subscriptions",
        "organizations_url": "https://api.github.com/users/remyers/orgs",
        "repos_url": "https://api.github.com/users/remyers/repos",
        "events_url": "https://api.github.com/users/remyers/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/remyers/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-02-26T08:37:59Z"
    },
    {
      "event": "subscribed",
      "id": 11917527229,
      "node_id": "SE_lADOABII585_fkYfzwAAAALGVwi9",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/11917527229",
      "actor": {
        "login": "remyers",
        "id": 8568892,
        "node_id": "MDQ6VXNlcjg1Njg4OTI=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8568892?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/remyers",
        "html_url": "https://github.com/remyers",
        "followers_url": "https://api.github.com/users/remyers/followers",
        "following_url": "https://api.github.com/users/remyers/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/remyers/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/remyers/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/remyers/subscriptions",
        "organizations_url": "https://api.github.com/users/remyers/orgs",
        "repos_url": "https://api.github.com/users/remyers/repos",
        "events_url": "https://api.github.com/users/remyers/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/remyers/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-02-26T08:37:59Z"
    },
    {
      "event": "mentioned",
      "id": 11917527248,
      "node_id": "MEE_lADOABII585_fkYfzwAAAALGVwjQ",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/11917527248",
      "actor": {
        "login": "t-bast",
        "id": 31281497,
        "node_id": "MDQ6VXNlcjMxMjgxNDk3",
        "avatar_url": "https://avatars.githubusercontent.com/u/31281497?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/t-bast",
        "html_url": "https://github.com/t-bast",
        "followers_url": "https://api.github.com/users/t-bast/followers",
        "following_url": "https://api.github.com/users/t-bast/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/t-bast/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/t-bast/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/t-bast/subscriptions",
        "organizations_url": "https://api.github.com/users/t-bast/orgs",
        "repos_url": "https://api.github.com/users/t-bast/repos",
        "events_url": "https://api.github.com/users/t-bast/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/t-bast/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-02-26T08:38:00Z"
    },
    {
      "event": "subscribed",
      "id": 11917527263,
      "node_id": "SE_lADOABII585_fkYfzwAAAALGVwjf",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/11917527263",
      "actor": {
        "login": "t-bast",
        "id": 31281497,
        "node_id": "MDQ6VXNlcjMxMjgxNDk3",
        "avatar_url": "https://avatars.githubusercontent.com/u/31281497?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/t-bast",
        "html_url": "https://github.com/t-bast",
        "followers_url": "https://api.github.com/users/t-bast/followers",
        "following_url": "https://api.github.com/users/t-bast/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/t-bast/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/t-bast/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/t-bast/subscriptions",
        "organizations_url": "https://api.github.com/users/t-bast/orgs",
        "repos_url": "https://api.github.com/users/t-bast/repos",
        "events_url": "https://api.github.com/users/t-bast/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/t-bast/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-02-26T08:38:00Z"
    },
    {
      "event": "commented",
      "id": 1963645226,
      "node_id": "IC_kwDOABII5851Ctkq",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1963645226",
      "actor": {
        "login": "remyers",
        "id": 8568892,
        "node_id": "MDQ6VXNlcjg1Njg4OTI=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8568892?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/remyers",
        "html_url": "https://github.com/remyers",
        "followers_url": "https://api.github.com/users/remyers/followers",
        "following_url": "https://api.github.com/users/remyers/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/remyers/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/remyers/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/remyers/subscriptions",
        "organizations_url": "https://api.github.com/users/remyers/orgs",
        "repos_url": "https://api.github.com/users/remyers/repos",
        "events_url": "https://api.github.com/users/remyers/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/remyers/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-02-26T09:16:02Z",
      "updated_at": "2024-02-26T09:16:02Z",
      "author_association": "CONTRIBUTOR",
      "body": "> I think we should consider a pluggable architecture for coin selection algorithms.\r\n\r\nThat's an interesting suggestion. So far in our case I don't see a need to use a different coin selection algorithm, though I do think there might be value in having the ability to selectively disable SRD and knapsack. The current scheme proposed in this PR is more of a wrapper around the existing coin selection system.\r\n\r\nI can not rule out the possibility that there might exist a superior custom coin selection algorithm for this use case. If someone were to propose a different algorithm then that would certainly help motivate a pluggable coin selection architecture.",
      "user": {
        "login": "remyers",
        "id": 8568892,
        "node_id": "MDQ6VXNlcjg1Njg4OTI=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8568892?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/remyers",
        "html_url": "https://github.com/remyers",
        "followers_url": "https://api.github.com/users/remyers/followers",
        "following_url": "https://api.github.com/users/remyers/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/remyers/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/remyers/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/remyers/subscriptions",
        "organizations_url": "https://api.github.com/users/remyers/orgs",
        "repos_url": "https://api.github.com/users/remyers/repos",
        "events_url": "https://api.github.com/users/remyers/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/remyers/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29442#issuecomment-1963645226",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29442"
    },
    {
      "event": "commented",
      "id": 1969608193,
      "node_id": "IC_kwDOABII5851ZdYB",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1969608193",
      "actor": {
        "login": "yancyribbens",
        "id": 817736,
        "node_id": "MDQ6VXNlcjgxNzczNg==",
        "avatar_url": "https://avatars.githubusercontent.com/u/817736?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/yancyribbens",
        "html_url": "https://github.com/yancyribbens",
        "followers_url": "https://api.github.com/users/yancyribbens/followers",
        "following_url": "https://api.github.com/users/yancyribbens/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/yancyribbens/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/yancyribbens/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/yancyribbens/subscriptions",
        "organizations_url": "https://api.github.com/users/yancyribbens/orgs",
        "repos_url": "https://api.github.com/users/yancyribbens/repos",
        "events_url": "https://api.github.com/users/yancyribbens/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/yancyribbens/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-02-28T18:40:35Z",
      "updated_at": "2024-02-28T18:40:35Z",
      "author_association": "CONTRIBUTOR",
      "body": "Is the bitcoin core reference implementation the right place to try these customization/personas?",
      "user": {
        "login": "yancyribbens",
        "id": 817736,
        "node_id": "MDQ6VXNlcjgxNzczNg==",
        "avatar_url": "https://avatars.githubusercontent.com/u/817736?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/yancyribbens",
        "html_url": "https://github.com/yancyribbens",
        "followers_url": "https://api.github.com/users/yancyribbens/followers",
        "following_url": "https://api.github.com/users/yancyribbens/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/yancyribbens/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/yancyribbens/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/yancyribbens/subscriptions",
        "organizations_url": "https://api.github.com/users/yancyribbens/orgs",
        "repos_url": "https://api.github.com/users/yancyribbens/repos",
        "events_url": "https://api.github.com/users/yancyribbens/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/yancyribbens/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29442#issuecomment-1969608193",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29442"
    },
    {
      "event": "commented",
      "id": 1973296966,
      "node_id": "IC_kwDOABII5851nh9G",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1973296966",
      "actor": {
        "login": "remyers",
        "id": 8568892,
        "node_id": "MDQ6VXNlcjg1Njg4OTI=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8568892?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/remyers",
        "html_url": "https://github.com/remyers",
        "followers_url": "https://api.github.com/users/remyers/followers",
        "following_url": "https://api.github.com/users/remyers/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/remyers/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/remyers/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/remyers/subscriptions",
        "organizations_url": "https://api.github.com/users/remyers/orgs",
        "repos_url": "https://api.github.com/users/remyers/repos",
        "events_url": "https://api.github.com/users/remyers/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/remyers/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-03-01T14:25:07Z",
      "updated_at": "2024-03-01T14:25:07Z",
      "author_association": "CONTRIBUTOR",
      "body": "> Is the bitcoin core reference implementation the right place to try these customization/personas?\r\n\r\nThat's a fair question - I think it depends on how widely useful this kind of customization/persona is for different wallet users. \r\n\r\nEven if it's not deemed general enough for more than a draft PR, comments will help improve the implementation in a fork and could feed back less invasive ideas to core.  For example, just having a way to specify the `minimum_change` used by cs could be useful.",
      "user": {
        "login": "remyers",
        "id": 8568892,
        "node_id": "MDQ6VXNlcjg1Njg4OTI=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8568892?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/remyers",
        "html_url": "https://github.com/remyers",
        "followers_url": "https://api.github.com/users/remyers/followers",
        "following_url": "https://api.github.com/users/remyers/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/remyers/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/remyers/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/remyers/subscriptions",
        "organizations_url": "https://api.github.com/users/remyers/orgs",
        "repos_url": "https://api.github.com/users/remyers/repos",
        "events_url": "https://api.github.com/users/remyers/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/remyers/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29442#issuecomment-1973296966",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29442"
    },
    {
      "event": "commented",
      "id": 2015224563,
      "node_id": "IC_kwDOABII5854HeLz",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2015224563",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-03-22T14:27:33Z",
      "updated_at": "2024-03-22T14:27:33Z",
      "author_association": "CONTRIBUTOR",
      "body": "<!--85328a0da195eb286784d51f73fa0af9-->\n\n🚧 At least one of the CI tasks failed. Make sure to run all tests locally, according to the\ndocumentation.\n\nPossibly this is due to a silent merge conflict (the changes in this pull request being\nincompatible with the current code in the target branch). If so, make sure to rebase on the latest\ncommit of the target branch.\n\nLeave a comment here, if you need help tracking down a confusing failure.\n\n<sub>Debug: https://github.com/bitcoin/bitcoin/runs/22979879322</sub>",
      "user": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29442#issuecomment-2015224563",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29442"
    },
    {
      "event": "labeled",
      "id": 12216560411,
      "node_id": "LE_lADOABII585_fkYfzwAAAALYKesb",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/12216560411",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-03-22T14:27:33Z",
      "label": {
        "name": "CI failed",
        "color": "cccccc"
      }
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKGVhMmZiODNjY2MxN2E4NjdiNDdmOTRhMTZiZDFmMjUxMGY5NzZjYjg",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/ea2fb83ccc17a867b47f94a16bd1f2510f976cb8",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/ea2fb83ccc17a867b47f94a16bd1f2510f976cb8",
      "tree": {
        "sha": "d46c809a4d308c4c8fdc67f9ac6e83c40c24035c",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/d46c809a4d308c4c8fdc67f9ac6e83c40c24035c"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree d46c809a4d308c4c8fdc67f9ac6e83c40c24035c\nparent 2e1c84b333dc744dec04b783dc77b24a55e528d8\nauthor Richard Myers <remyers@yakshaver.org> 1707840382 +0100\ncommitter Richard Myers <remyers@yakshaver.org> 1711384616 +0100\n\nwallet: Add change_target parameter to coin control\n\nAdd a coin control parameter to optionally force a particular change target for coin selection algorithms that result in a change output.\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQJKBAABCgA0FiEEf/pts4wRKAyFfYbezLEmUJDpO2IFAmYBqCgWHHJlbXllcnNA\neWFrc2hhdmVyLm9yZwAKCRDMsSZQkOk7YoY+EACfCS26DBRrITMaRIOXgfW/Wq0I\nAK3r054atnFnO6DB6oSZd0WQA5DZpPVn/230WRluj4nIAFSOqvdhTv6/iAHbE911\nFrcR4/qCAtIghzRHoes4rjLgRrco5BIYf0/AgUuJ+ZdCUt5R0a73qIZYZf/1DUKv\n6ud3HHN5ho2ImU/gq+eDs++XEjQu7O5sMqaRYnvTF1KBpqYNIkacw5QisWPFjoOS\nfNShCRsiKHfKWGkIekI5neIrBpHUb6uYdYRaQbnsAO26q8avTC/H8iuZV3q9wDD8\nS1FQ0H6ljpYQEOOO4+yQG4ArRCBvp327aFHO0fautH7StZIX4pNa++1Ng9Z4mVa1\nWhHB9ArBcXzI9KcVhFUSg+LYxKUeJDEDimXrPICvYHyhRSOKeYIKIMcS0J2x9prY\nTALC3812cyEsGK346wmqX9n5IRqdYrx6qqRcXT2BOmXAO11ByTXblpBZD79LxT+I\nBGF5Rw1GK2uhqftACocW7UvhZKL/6AuH4QSsl9Mt7uncQUQDKcl0//7Hs6O9HqKw\nmRw4HIx6hwMES/x8KQgl9fBSzutXOhddwkUhofzD/6zGw4dDUuJqLJyXyPUwW50A\nd949KgZqdzZ8AEMRbaC6MAVTlVpLK+ykYIdYCc4Yt0XRmoGUWIv/4rPOtQdutr3l\nZgDtO/rdcNoPQBn7Pg==\n=24ws\n-----END PGP SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/2e1c84b333dc744dec04b783dc77b24a55e528d8",
          "sha": "2e1c84b333dc744dec04b783dc77b24a55e528d8",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/2e1c84b333dc744dec04b783dc77b24a55e528d8"
        }
      ],
      "message": "wallet: Add change_target parameter to coin control\n\nAdd a coin control parameter to optionally force a particular change target for coin selection algorithms that result in a change output.",
      "committer": {
        "name": "Richard Myers",
        "email": "remyers@yakshaver.org",
        "date": "2024-03-25T16:36:56Z"
      },
      "author": {
        "name": "Richard Myers",
        "email": "remyers@yakshaver.org",
        "date": "2024-02-13T16:06:22Z"
      },
      "sha": "ea2fb83ccc17a867b47f94a16bd1f2510f976cb8"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDgzYjFmNWQyNWU3NzI3ZmZmOTQ3NGM0NmNhYjYyNGFjMjljYmU2YTY",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/83b1f5d25e7727fff9474c46cab624ac29cbe6a6",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/83b1f5d25e7727fff9474c46cab624ac29cbe6a6",
      "tree": {
        "sha": "1411a936c5c90b27ec4d7a42326e2e653705a6cb",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/1411a936c5c90b27ec4d7a42326e2e653705a6cb"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree 1411a936c5c90b27ec4d7a42326e2e653705a6cb\nparent ea2fb83ccc17a867b47f94a16bd1f2510f976cb8\nauthor Richard Myers <remyers@yakshaver.org> 1706102379 +0100\ncommitter Richard Myers <remyers@yakshaver.org> 1711384616 +0100\n\nwallet: Define utxo set targets to replenish when spends have change\n\nAdd a config option to load a json file that defines a set of utxo target buckets with a value range and count. When the current utxo set for the wallet does not match or exceed the counts for the value ranges of the buckets, opportunistically split the change output produced by coin selection (if any) into additional outputs.\n\nTarget buckets will be refilled from most to least depleted. The value of a new output to refill a target bucket will be randomly selected from its value range.\n\nOnce all buckets are full the change output will not be further split.\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQJKBAABCgA0FiEEf/pts4wRKAyFfYbezLEmUJDpO2IFAmYBqCgWHHJlbXllcnNA\neWFrc2hhdmVyLm9yZwAKCRDMsSZQkOk7YvseD/9wqbiKVnbelMSbpP6kLY2aQy8s\nBynSh8zJJiG/J0/mPGikQEjqw+xOkN2pE61wPoItNwMaWuAh9ImjVn0T94RX3BDV\nc/8Cy/qWBcayNYP1dWnESsgRG7qRTFSRBShywhflhCY27H/p7URYybe/Rv8yoF6a\nvJwUsRW2V6qD/80jH6YJ2CDA62e3BQfiZO9kS0TbxEyN8tknzytphKBJkBBrI0CD\n1+QMoceIBm66tBziM2Qjn2SwT2cJceEqTHdpiA5o5UnmcSWXSLv2CIZCQnjcRJmI\n5hGeZoZx5a2KlBlL1tVKePCHejW7jaXmN0ZloJQYZEq4KxsmwSQA4S0tQWwe0ASg\nnJOr2Z+KBEXwyRSIs3YrNtO+mH9zB7MTn4kAVXaOC7tpuf0gZrc3GXuKr67A0Dtc\nj3htr8tXM01y3ZnLPzpYND55fnprruY+tr6dlSu3aYsCNwcgZTJnDdCE/Q75iE4b\nrTPXueOlTwfrJSBvfjuqXHnAvvRVJRJCSQooc4LivV3q4CTQV7aKiP+A/Og+zh2q\nHfP0UnZLM3I4Uh4cJEvuYeHBlN7VaooLJ/lIZ1Itvl40CmUc9BQqBNDglUQdO5ko\nfiYXZuS5UPOVc7c9qmXfKbcSxSSLyl13VVtmgLfURqk17k7F/y5jpqbRng8ijRE6\n9GJXZXt3SdcsaRpEOA==\n=nVXp\n-----END PGP SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/ea2fb83ccc17a867b47f94a16bd1f2510f976cb8",
          "sha": "ea2fb83ccc17a867b47f94a16bd1f2510f976cb8",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/ea2fb83ccc17a867b47f94a16bd1f2510f976cb8"
        }
      ],
      "message": "wallet: Define utxo set targets to replenish when spends have change\n\nAdd a config option to load a json file that defines a set of utxo target buckets with a value range and count. When the current utxo set for the wallet does not match or exceed the counts for the value ranges of the buckets, opportunistically split the change output produced by coin selection (if any) into additional outputs.\n\nTarget buckets will be refilled from most to least depleted. The value of a new output to refill a target bucket will be randomly selected from its value range.\n\nOnce all buckets are full the change output will not be further split.",
      "committer": {
        "name": "Richard Myers",
        "email": "remyers@yakshaver.org",
        "date": "2024-03-25T16:36:56Z"
      },
      "author": {
        "name": "Richard Myers",
        "email": "remyers@yakshaver.org",
        "date": "2024-01-24T13:19:39Z"
      },
      "sha": "83b1f5d25e7727fff9474c46cab624ac29cbe6a6"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDE2NDE3MzYxNTY2ZWJhMWNkOWJiMmI5MjIyZTAwNDYxYmI1MzgzMTA",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/16417361566eba1cd9bb2b9222e00461bb538310",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/16417361566eba1cd9bb2b9222e00461bb538310",
      "tree": {
        "sha": "14f9654cd60e503a3ed4ead7d7637d1336889d30",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/14f9654cd60e503a3ed4ead7d7637d1336889d30"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree 14f9654cd60e503a3ed4ead7d7637d1336889d30\nparent 83b1f5d25e7727fff9474c46cab624ac29cbe6a6\nauthor Richard Myers <remyers@yakshaver.org> 1707838360 +0100\ncommitter Richard Myers <remyers@yakshaver.org> 1711384617 +0100\n\nwallet: Refill utxo target buckets proactively\n\nWhen utxo targets are specified and a utxo target bucket is depleted, or fees are low, produce excess change that can be split to replenish the utxo target set. This is accomplished by including a large valued utxo as an input to coin selection.\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQJKBAABCgA0FiEEf/pts4wRKAyFfYbezLEmUJDpO2IFAmYBqCkWHHJlbXllcnNA\neWFrc2hhdmVyLm9yZwAKCRDMsSZQkOk7YtaSEACU8JJ6gkQrDycWZGF7WuXoPo0I\n5X6hlsfhHoE9QIiUKcUZlsEtQJZOzImwdHzjc4GtzCdgfMoQRnFHyswDb0/pNPvg\nQhFfn7G5hW/AAr6gi2AJJTvupntn4p09vfVdsNKwyzjX+tBiDP5eFdP4chaXdv3o\nQ7rWhGJ7ykuQw+fEkkC8ISoMRCTRFEwmxRzB0xC5/83RoBDYsasj6V/5sXX3aWVi\nrldgn5kGI1ZdfY2xzOX+SoZSkDrpdbsw3s/xdz1KtxcsZ7u/QQWX6ief2DUft1Yb\nJes+k4mc0Cavuy2j+60IOm3f0Y43ASiRzUBk/viPkdC1Q5nCjoLOq+eb/Fd5qwcx\nKjU6/wkkWtv89LEgaw3cSxMnQ/wHw18R3k8YbYWau/ONUeAbic26lZXRYNhGjBq2\nEjDZqB2boHnXQjfrMbG9v61z1bWSamScCcCOnGaAxXAzl796fdOuGMZ2LSecWe+Z\nhOAi29dJzSfy6Ck2FEpSMK6sVpnUTOOXzlYi7e0jFVFOR+aaH/mhgOl1CJmP1Szh\noNngcUWXPKSl0EEZqyplSDpqDi/uWuu7H2YumuZdq05MTqfn+carSJAQLwJohFf6\nx6L+4hcw9N3+WiS8ZwrATVfHV+2Z1kxZWMh50+s8qOITurq+hPar0WvXdPOvKgNl\ngrHg6gyUfSpbVAmHVQ==\n=E0SW\n-----END PGP SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/83b1f5d25e7727fff9474c46cab624ac29cbe6a6",
          "sha": "83b1f5d25e7727fff9474c46cab624ac29cbe6a6",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/83b1f5d25e7727fff9474c46cab624ac29cbe6a6"
        }
      ],
      "message": "wallet: Refill utxo target buckets proactively\n\nWhen utxo targets are specified and a utxo target bucket is depleted, or fees are low, produce excess change that can be split to replenish the utxo target set. This is accomplished by including a large valued utxo as an input to coin selection.",
      "committer": {
        "name": "Richard Myers",
        "email": "remyers@yakshaver.org",
        "date": "2024-03-25T16:36:57Z"
      },
      "author": {
        "name": "Richard Myers",
        "email": "remyers@yakshaver.org",
        "date": "2024-02-13T15:32:40Z"
      },
      "sha": "16417361566eba1cd9bb2b9222e00461bb538310"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKGUzMTcwNmE5NTdkODM0Yjc5MmYyMDZjZmI3NDQ2MWIzNzJmYWY3YmI",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/e31706a957d834b792f206cfb74461b372faf7bb",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/e31706a957d834b792f206cfb74461b372faf7bb",
      "tree": {
        "sha": "5049ae109952b8a580c76db8f8fd11be969fee1a",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/5049ae109952b8a580c76db8f8fd11be969fee1a"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree 5049ae109952b8a580c76db8f8fd11be969fee1a\nparent 16417361566eba1cd9bb2b9222e00461bb538310\nauthor Richard Myers <remyers@yakshaver.org> 1709544761 +0100\ncommitter Richard Myers <remyers@yakshaver.org> 1711384617 +0100\n\nCompute utxo targets using unconfirmed outputs\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQJKBAABCgA0FiEEf/pts4wRKAyFfYbezLEmUJDpO2IFAmYBqCkWHHJlbXllcnNA\neWFrc2hhdmVyLm9yZwAKCRDMsSZQkOk7YiXnD/sFZ6lBs0selhsiBSVoG3HhyBUs\nGEoLqFVZGBZ8sGSkmLi6tz54nMCXMEOk7I8fn49wh3JgLRJkXGL9+P9wF6EAF0xi\nv7xEeKIIXzBcRDz5URYB+JRbZui+dK9CpYMOFTxKBH2y/0EjpVoPcLQNX4g9MXnZ\n+tmT3yfTBnAM7ctxlmx6JvgxU/SEVPilfkga7hh4BcEXw7YzL2OtnzH/3LvbZGL3\n6yxLDUn81SL5Ms2E8r6mOPJn+q/3qpl2H3f2IpmLAg+D+C/awjxaauKWd9O8mtFb\narBUxZWIHCQ/OdDbz7QpYvLHOK9WaKY/WSwdlcMkeyyfy/h5a0qkt9/Rtbfqemxi\nfOoiASvo3lLOYaK4F9D/88c51CZ7ZwNvrPLrkXpaxto2/R2PADjXv0i44ACcLO0Z\nX/XPJQCqu1V6fU0Iep6RZRQXiFBRpnOibslufJFlMHffuKfSNHCZV7NgBjaqvqAh\ncH3IrlD+NxhUzqiyX0/u7JBYc/SN5sU9K0MFbjYQ2YXYeEhnXYXgP3KNZbI3ViyJ\nNAtaeCUruqHgula8Wk0S/1CLKY1goYrT6tBmE3Bs/dNk1ryAd82MWj8v6woiucqT\nvjva9xgAKWkdK43nNM768BVJF1foZjw0Ryjun0QM2eiG2Wk1EaIgctg6AtyQm9+a\n4xwk3lzuCE14TSNdEg==\n=w9nI\n-----END PGP SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/16417361566eba1cd9bb2b9222e00461bb538310",
          "sha": "16417361566eba1cd9bb2b9222e00461bb538310",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/16417361566eba1cd9bb2b9222e00461bb538310"
        }
      ],
      "message": "Compute utxo targets using unconfirmed outputs",
      "committer": {
        "name": "Richard Myers",
        "email": "remyers@yakshaver.org",
        "date": "2024-03-25T16:36:57Z"
      },
      "author": {
        "name": "Richard Myers",
        "email": "remyers@yakshaver.org",
        "date": "2024-03-04T09:32:41Z"
      },
      "sha": "e31706a957d834b792f206cfb74461b372faf7bb"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKGU0MWQ4NTNiZGEzNzg3ZmY0MGVlZDM2NjFhYmRhNjVjYjVkNzQzN2I",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/e41d853bda3787ff40eed3661abda65cb5d7437b",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/e41d853bda3787ff40eed3661abda65cb5d7437b",
      "tree": {
        "sha": "966ae5cae0c67cbb6053a2c66649a6995b4f0a92",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/966ae5cae0c67cbb6053a2c66649a6995b4f0a92"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree 966ae5cae0c67cbb6053a2c66649a6995b4f0a92\nparent e31706a957d834b792f206cfb74461b372faf7bb\nauthor Richard Myers <remyers@yakshaver.org> 1710860130 +0100\ncommitter Richard Myers <remyers@yakshaver.org> 1711384618 +0100\n\nAdd max_excess coin selection parameter\n\nWhen considering a transaction without change, the max_excess amount is how much extra value can be added to the target value and not be counted as waste.\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQJKBAABCgA0FiEEf/pts4wRKAyFfYbezLEmUJDpO2IFAmYBqCoWHHJlbXllcnNA\neWFrc2hhdmVyLm9yZwAKCRDMsSZQkOk7Yg3oD/9e4KND33hko3V5iupmVrU7S15Z\nJO8oqneL9qm5i4cdeK0wn7sij8l71G3BIzmQNLcoBs0wuqR6CtfKbsfVkUfxp8+Y\nql6I/BvpWsMN2bUV1uU7lhJgNqlTc1LtzvkxWOflfEEVf/MhkYb1Px9WV7luEwzT\nTSuUoyppJRcLqVEbPJi3DdeTqhEDhlGUk+8iNuG7ARxAfxyKWTmznbrIWFmBu9DI\nCBYj++l1Yrj3AimrRGGkrUXdsbqMeS7tEjs4R32AlY1WxOHfa9LOh2HeO9AZpjWZ\nPS47yRI8/8gMW4YWoXlNJF7Ue1aFXLjeurPMhKzLzimKVBOuiGmK53crAcHUVJgG\nz5xLdGvbLvm/t8HrbySoCt5Ec+U1DS1qbo4KKhZGiAIyPO4A3KTwVZBG0GKDV8xs\n1VJ6xCG/8MD0e3qZHmh+tIjo28TeW0z4ZM+PqlRsWh6D6HDaRdun5ya9Y43JMn+i\nhVhyLJ7EBAp00UcMStxI9svUTpGss8Pt0Fa7eXEB8hwFvwsXm8eNs2wGaU7ONGmw\nyuAK47jAR6+RG/O1WITeUD2pmYUW2ihO3r69AOwKgl+CHAf2IHtXMaRW26VQjHkC\nm3+3HxsOstIF/hORH6O2DPVgstbnJxVwANtCi9EmrfdxPH1UrkgR37Pj08bRYntY\n0/OO4ciFLAQKpzTHKg==\n=kzHF\n-----END PGP SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/e31706a957d834b792f206cfb74461b372faf7bb",
          "sha": "e31706a957d834b792f206cfb74461b372faf7bb",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/e31706a957d834b792f206cfb74461b372faf7bb"
        }
      ],
      "message": "Add max_excess coin selection parameter\n\nWhen considering a transaction without change, the max_excess amount is how much extra value can be added to the target value and not be counted as waste.",
      "committer": {
        "name": "Richard Myers",
        "email": "remyers@yakshaver.org",
        "date": "2024-03-25T16:36:58Z"
      },
      "author": {
        "name": "Richard Myers",
        "email": "remyers@yakshaver.org",
        "date": "2024-03-19T14:55:30Z"
      },
      "sha": "e41d853bda3787ff40eed3661abda65cb5d7437b"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDY3NjRhZmI5NWVhNTU2Mzg5MzMxN2UzMzJlYjAwYmMyOTVmNjA4ZTk",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/6764afb95ea5563893317e332eb00bc295f608e9",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/6764afb95ea5563893317e332eb00bc295f608e9",
      "tree": {
        "sha": "9eb2f51b484ac2f201384bb678e9637b41f53b3e",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/9eb2f51b484ac2f201384bb678e9637b41f53b3e"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree 9eb2f51b484ac2f201384bb678e9637b41f53b3e\nparent e41d853bda3787ff40eed3661abda65cb5d7437b\nauthor Richard Myers <remyers@yakshaver.org> 1711399326 +0100\ncommitter Richard Myers <remyers@yakshaver.org> 1711399326 +0100\n\nAdd coin control rpc option \"disable_algos\"\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQJKBAABCgA0FiEEf/pts4wRKAyFfYbezLEmUJDpO2IFAmYB4Z4WHHJlbXllcnNA\neWFrc2hhdmVyLm9yZwAKCRDMsSZQkOk7YpwED/4mVxmyxiOHNB5P8zxV44TwdfrK\nDD38Ry//ceBbHdNUlgwW5ojLzUvU8M0wQgOE8XGvz/PI57UATn7r8r+8N276+CR8\neq9OVqKNNCtrsWaQo47uT61a4+3cjULGARjoXhRQSPnVUlHEIeuf+LCgXUQWixSd\nbp8vuCtZY02j34ummJLo5hCL2gCzQ+aoH+ObeF6qPL4bUbvj3/ITB489uKDKkhFw\n5vkR6gwJEY2/ubRxMf3i4u27BAvS7lApy3Q/l1W+CvEKZ3BalMRWeGMkO7z/TsBH\n64/hzzxkbajkDRO4HFKyipQfRfBJ//Jn5nOcaMXCQSAF1blOWtAhYshJk28OkiDX\nxzY1f2qtb6roGORVU9Ry2wwto1M4DZDJ5JB3TjUn6UdaLPFSVW/xsZqJvtLBS+8g\nVnRQXcZ7/kODrzicgPbkkvkamz0a8gdSP8c33f+10/Tjxcfj5LbCaPqB3WGYMx3d\ns7/+lKIzHU5RW2muN9emfk7z7kyha2WOlew9LaRuZVtSHk7MYJ3sJ2R69Fe7AbE3\nZ/In7LeXeUIW0PisiIYCgauDhfXg6caScZJ/ENyYRFcSMeSG89/vjpsS3fh1C8pt\nHnFTvifKF4jMEMvfv0WsJCNBJf27dnzXrXLK5QlBpFJWjnx0PqGUX5peupboYjQ+\nTSeeUUK7K9Nf8TH2ig==\n=TFH2\n-----END PGP SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/e41d853bda3787ff40eed3661abda65cb5d7437b",
          "sha": "e41d853bda3787ff40eed3661abda65cb5d7437b",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/e41d853bda3787ff40eed3661abda65cb5d7437b"
        }
      ],
      "message": "Add coin control rpc option \"disable_algos\"",
      "committer": {
        "name": "Richard Myers",
        "email": "remyers@yakshaver.org",
        "date": "2024-03-25T20:42:06Z"
      },
      "author": {
        "name": "Richard Myers",
        "email": "remyers@yakshaver.org",
        "date": "2024-03-25T20:42:06Z"
      },
      "sha": "6764afb95ea5563893317e332eb00bc295f608e9"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDBkNzUyYjU5MmRlMTlkMjcxYzBmMTQ4NTZmNjYxZmM1YmJhOGJkNjA",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/0d752b592de19d271c0f14856f661fc5bba8bd60",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/0d752b592de19d271c0f14856f661fc5bba8bd60",
      "tree": {
        "sha": "f18ee5ee403ba61f327f6131c06dda52c76a6dcf",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/f18ee5ee403ba61f327f6131c06dda52c76a6dcf"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree f18ee5ee403ba61f327f6131c06dda52c76a6dcf\nparent 6764afb95ea5563893317e332eb00bc295f608e9\nauthor Richard Myers <remyers@yakshaver.org> 1712603118 +0200\ncommitter Richard Myers <remyers@yakshaver.org> 1713171460 +0200\n\nAdd new pre-coinselection using utxotargets and feerate estimates\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQJKBAABCgA0FiEEf/pts4wRKAyFfYbezLEmUJDpO2IFAmYc7AcWHHJlbXllcnNA\neWFrc2hhdmVyLm9yZwAKCRDMsSZQkOk7YtHeD/9BZ1TmhTbGOj6twsI2iTDEUi5t\ng1eITtSm0LRGOuRbMc0TRULbHHKFTGjFOg47k2iuYsn1HpOhjmqhnGHydXF3YKw6\nEcXekOtv1/rQmO22VdS+gZLbHB4l6fHYSb7gGyOmP/xDYk4R8/EFt84XqEA1ueMN\nSY6cl9TqN6bvzNWiHp+Kfz/ngIuzVLOilZf+Ojn5Sky8Xmx9DoKZkTv4iIAJdsky\n2b8ZnWHqmxMlU3QthEn5/a9ejSAve9iUfxelBF/nsCGildOmNzXKueS0uLVZ6knj\noRuFb1B4euyPRbNJLGk7EMcwTFU+bO/HzR9x1TnTZDMTncs+38VL6mlRkBG1TiVM\n5uBxWziwcD/nboaPJBRVa17O1q8lzg5uFMjXA2GpLpKLrlrqZiO84iVFjZR2sK96\nzEPM+wO62erlF15vjg3gISTyePh4Oc8PvQUsbgXIBJgZbmgQAkpKZAgNLP4YlNqp\n9qjZRlo0DVr9ffoBG3/4mHhc9I+E+BvVSUhrhsmKmJiEjnprtn8/WHvFidHDidnD\nKBTidfNK0g0B3RCCRr/C0XcrCh2kCSmUBKTpbs0sZhW5qHct5HhrFFjBHnB/ecwK\nEH/VSibZHW9LaUL7lMVKSZyR1a4jMKmi0KLewNrXqxH9KLUoxO0TmC9RS3kKN3I8\nmYTmBo4Ih8L7c4FBzg==\n=JkHs\n-----END PGP SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/6764afb95ea5563893317e332eb00bc295f608e9",
          "sha": "6764afb95ea5563893317e332eb00bc295f608e9",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/6764afb95ea5563893317e332eb00bc295f608e9"
        }
      ],
      "message": "Add new pre-coinselection using utxotargets and feerate estimates",
      "committer": {
        "name": "Richard Myers",
        "email": "remyers@yakshaver.org",
        "date": "2024-04-15T08:57:40Z"
      },
      "author": {
        "name": "Richard Myers",
        "email": "remyers@yakshaver.org",
        "date": "2024-04-08T19:05:18Z"
      },
      "sha": "0d752b592de19d271c0f14856f661fc5bba8bd60"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 12465566393,
      "node_id": "HRFPE_lADOABII585_fkYfzwAAAALnAXK5",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/12465566393",
      "actor": {
        "login": "remyers",
        "id": 8568892,
        "node_id": "MDQ6VXNlcjg1Njg4OTI=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8568892?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/remyers",
        "html_url": "https://github.com/remyers",
        "followers_url": "https://api.github.com/users/remyers/followers",
        "following_url": "https://api.github.com/users/remyers/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/remyers/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/remyers/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/remyers/subscriptions",
        "organizations_url": "https://api.github.com/users/remyers/orgs",
        "repos_url": "https://api.github.com/users/remyers/repos",
        "events_url": "https://api.github.com/users/remyers/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/remyers/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": "0d752b592de19d271c0f14856f661fc5bba8bd60",
      "commit_url": "https://api.github.com/repos/remyers/bitcoin/commits/0d752b592de19d271c0f14856f661fc5bba8bd60",
      "created_at": "2024-04-15T08:59:43Z"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDJlZmFkYjFiNDc2MTFmNzE0NjA5YzJiMTQ3ZDE3YWFhYzgxOGRkYzQ",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/2efadb1b47611f714609c2b147d17aaac818ddc4",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/2efadb1b47611f714609c2b147d17aaac818ddc4",
      "tree": {
        "sha": "6544fb1576ceb37895897d48d3c45204aaa0cc64",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/6544fb1576ceb37895897d48d3c45204aaa0cc64"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree 6544fb1576ceb37895897d48d3c45204aaa0cc64\nparent 0d752b592de19d271c0f14856f661fc5bba8bd60\nauthor Richard Myers <remyers@yakshaver.org> 1714166625 +0200\ncommitter Richard Myers <remyers@yakshaver.org> 1714166625 +0200\n\nReplace max_excess with add_excess_to_recipient_position\n\n- When this is added to a funding RPC call then the waste for changeless BnB txs will be added to the selected recipient output position instead of added to fees.\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQJKBAABCgA0FiEEf/pts4wRKAyFfYbezLEmUJDpO2IFAmYsG2EWHHJlbXllcnNA\neWFrc2hhdmVyLm9yZwAKCRDMsSZQkOk7YtKOEACy5FQ8sezhOdBSkxAwHbrwp3du\nkdKPCMK2HqEAG5TKfdj+6FmPrlmDuscPzpmSVfJaR5Vkw4tNIbtdYm9tpv7EhbPd\nn3TCBWD8rwKK2Q/6ZGZAndagsNKSFEbS2EiJT6rH81lAzo7xjMbDcM+M6giVhrqr\ngJpAh0nvS/wi4sk1sCVR3tZ1zgY6fSo5JU5zeTqEy5pL5c1SibF+z7IszcndwnAQ\n40qLPjjs0/pQNKQ3lvZMB4yBVMgIycu6dRZMZTSuXdVYjk+Lw5yko1X/Acw1J324\nU70DqAXs/4i9nSZW3ZMk9z9fzoOO30DUf2LBR7NB10AwSLZroRPpIlssTvReb+KY\nhcFjOMEqYtVws/n0aSJqZsnGKi4Wd/n2g8Vtai5r31/BpihcSKqk/tbxhtka18qJ\n6kY3U4WUmL/0+H76oP9kYgWD/TAZdqpd51+bBW6N0kLsexzhWAsT6yTq2P3avlAA\nIYK7kUr8DkATvFqhOgTPiL4vPAgmaIYOeSV+ZY0KCA94IDr8aNU1qW4iugjr9A34\nYN8PBwE9LkKUwR0e8JyxvQWNgtTzj7fpL2wI5PNUZIZH7StvxSDRO46w2m2jITSx\nEkxeEbxMJ7sOSl7/lcGnfsYQwwRTez8DZEgBI2pQ1jrxGP4bqz87tht8eiyyjQZ8\nBSWqgOAe7mOeB4Vk+Q==\n=u5yS\n-----END PGP SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/0d752b592de19d271c0f14856f661fc5bba8bd60",
          "sha": "0d752b592de19d271c0f14856f661fc5bba8bd60",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/0d752b592de19d271c0f14856f661fc5bba8bd60"
        }
      ],
      "message": "Replace max_excess with add_excess_to_recipient_position\n\n- When this is added to a funding RPC call then the waste for changeless BnB txs will be added to the selected recipient output position instead of added to fees.",
      "committer": {
        "name": "Richard Myers",
        "email": "remyers@yakshaver.org",
        "date": "2024-04-26T21:23:45Z"
      },
      "author": {
        "name": "Richard Myers",
        "email": "remyers@yakshaver.org",
        "date": "2024-04-26T21:23:45Z"
      },
      "sha": "2efadb1b47611f714609c2b147d17aaac818ddc4"
    },
    {
      "event": "labeled",
      "id": 12662282042,
      "node_id": "LE_lADOABII585_fkYfzwAAAALyuxc6",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/12662282042",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-04-30T18:27:58Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "commented",
      "id": 2086449443,
      "node_id": "IC_kwDOABII5858XLEj",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2086449443",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-04-30T18:27:59Z",
      "updated_at": "2024-04-30T18:27:59Z",
      "author_association": "CONTRIBUTOR",
      "body": "<!--cf906140f33d8803c4a75a2196329ecb-->\n🐙 This pull request conflicts with the target branch and [needs rebase](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#rebasing-changes).\n",
      "user": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29442#issuecomment-2086449443",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29442"
    },
    {
      "event": "commented",
      "id": 2107079658,
      "node_id": "IC_kwDOABII5859l3vq",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2107079658",
      "actor": {
        "login": "remyers",
        "id": 8568892,
        "node_id": "MDQ6VXNlcjg1Njg4OTI=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8568892?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/remyers",
        "html_url": "https://github.com/remyers",
        "followers_url": "https://api.github.com/users/remyers/followers",
        "following_url": "https://api.github.com/users/remyers/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/remyers/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/remyers/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/remyers/subscriptions",
        "organizations_url": "https://api.github.com/users/remyers/orgs",
        "repos_url": "https://api.github.com/users/remyers/repos",
        "events_url": "https://api.github.com/users/remyers/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/remyers/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-05-13T09:25:15Z",
      "updated_at": "2024-05-13T09:25:15Z",
      "author_association": "CONTRIBUTOR",
      "body": "Replaced by simpler #30080",
      "user": {
        "login": "remyers",
        "id": 8568892,
        "node_id": "MDQ6VXNlcjg1Njg4OTI=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8568892?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/remyers",
        "html_url": "https://github.com/remyers",
        "followers_url": "https://api.github.com/users/remyers/followers",
        "following_url": "https://api.github.com/users/remyers/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/remyers/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/remyers/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/remyers/subscriptions",
        "organizations_url": "https://api.github.com/users/remyers/orgs",
        "repos_url": "https://api.github.com/users/remyers/repos",
        "events_url": "https://api.github.com/users/remyers/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/remyers/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29442#issuecomment-2107079658",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29442"
    },
    {
      "event": "closed",
      "id": 12784161774,
      "node_id": "CE_lADOABII585_fkYfzwAAAAL5_tPu",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/12784161774",
      "actor": {
        "login": "remyers",
        "id": 8568892,
        "node_id": "MDQ6VXNlcjg1Njg4OTI=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8568892?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/remyers",
        "html_url": "https://github.com/remyers",
        "followers_url": "https://api.github.com/users/remyers/followers",
        "following_url": "https://api.github.com/users/remyers/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/remyers/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/remyers/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/remyers/subscriptions",
        "organizations_url": "https://api.github.com/users/remyers/orgs",
        "repos_url": "https://api.github.com/users/remyers/repos",
        "events_url": "https://api.github.com/users/remyers/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/remyers/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-05-13T09:25:15Z"
    },
    {
      "event": "locked",
      "id": 17646865794,
      "node_id": "LOE_lADOABII585_fkYfzwAAAAQb1c2C",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/17646865794",
      "actor": {
        "login": "bitcoin",
        "id": 528860,
        "node_id": "MDEyOk9yZ2FuaXphdGlvbjUyODg2MA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/528860?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/bitcoin",
        "html_url": "https://github.com/bitcoin",
        "followers_url": "https://api.github.com/users/bitcoin/followers",
        "following_url": "https://api.github.com/users/bitcoin/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/bitcoin/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/bitcoin/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/bitcoin/subscriptions",
        "organizations_url": "https://api.github.com/users/bitcoin/orgs",
        "repos_url": "https://api.github.com/users/bitcoin/repos",
        "events_url": "https://api.github.com/users/bitcoin/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/bitcoin/received_events",
        "type": "Organization",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-05-14T06:07:13Z"
    }
  ],
  "comments": [
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1497769911",
      "pull_request_review_id": 1893495240,
      "id": 1497769911,
      "node_id": "PRRC_kwDOABII585ZRie3",
      "diff_hunk": "@@ -1128,6 +1225,36 @@ static util::Result<CreatedTransactionResult> CreateTransactionInternal(\n         available_coins = AvailableCoins(wallet, &coin_control, coin_selection_params.m_effective_feerate);\n     }\n \n+    // Load a json file that describes a target utxo set",
      "path": "src/wallet/spend.cpp",
      "position": null,
      "original_position": 138,
      "commit_id": "2efadb1b47611f714609c2b147d17aaac818ddc4",
      "original_commit_id": "85a049ddceb854106efea8316462e356d9b88b21",
      "in_reply_to_id": null,
      "user": {
        "login": "t-bast",
        "id": 31281497,
        "node_id": "MDQ6VXNlcjMxMjgxNDk3",
        "avatar_url": "https://avatars.githubusercontent.com/u/31281497?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/t-bast",
        "html_url": "https://github.com/t-bast",
        "followers_url": "https://api.github.com/users/t-bast/followers",
        "following_url": "https://api.github.com/users/t-bast/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/t-bast/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/t-bast/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/t-bast/subscriptions",
        "organizations_url": "https://api.github.com/users/t-bast/orgs",
        "repos_url": "https://api.github.com/users/t-bast/repos",
        "events_url": "https://api.github.com/users/t-bast/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/t-bast/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "Loading this file every time we fund a transaction doesn't seem reasonable. I think we should start with a static file that needs a restart whenever the node operator wants to change values, and we can later decide how to make this more dynamic (if it's even necessary).",
      "created_at": "2024-02-21T15:17:52Z",
      "updated_at": "2024-02-21T15:55:17Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29442#discussion_r1497769911",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1497769911"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29442"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1228,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1497820248",
      "pull_request_review_id": 1893495240,
      "id": 1497820248,
      "node_id": "PRRC_kwDOABII585ZRuxY",
      "diff_hunk": "@@ -799,6 +815,83 @@ util::Result<SelectionResult> SelectCoins(const CWallet& wallet, CoinsResult& av\n     return op_selection_result;\n }\n \n+/** Returns UTXO targets and compute their current count from available coins */\n+std::vector<UtxoTarget> UtxoTargetsFromJson(const UniValue& utxo_targets_json, const CoinsResult& available_coins)\n+{\n+    std::vector<UtxoTarget> utxo_targets;\n+    for (const auto& bucket : utxo_targets_json.getValues()) {\n+        UtxoTarget target = {\n+            bucket[\"start_satoshis\"].getInt<CAmount>(),\n+            bucket[\"end_satoshis\"].getInt<CAmount>(),\n+            bucket[\"target_utxo_count\"].getInt<uint32_t>()};\n+        utxo_targets.push_back(target);\n+    }\n+    for (const auto& [type, outputs] : available_coins.coins) {\n+        for (const wallet::COutput& output : outputs) {\n+            for (UtxoTarget& target : utxo_targets) {\n+                if (output.txout.nValue >= target.start_satoshis && output.txout.nValue <= target.end_satoshis) {\n+                    target.current_utxo_count++;\n+                    break;\n+                }\n+            }\n+        }\n+    }\n+\n+    return utxo_targets;\n+}\n+\n+/** Returns a random change amount in the range of the most depleted Utxo bucket and sets `capacity`\n+ * to the capacity of that change target, if any.\n+ */\n+std::optional<CAmount> GenerateChangeTargetFromUtxoTargets(const std::vector<UtxoTarget>& utxo_targets, const CAmount change_fee, double& capacity, FastRandomContext& rng)",
      "path": "src/wallet/spend.cpp",
      "position": null,
      "original_position": 69,
      "commit_id": "2efadb1b47611f714609c2b147d17aaac818ddc4",
      "original_commit_id": "85a049ddceb854106efea8316462e356d9b88b21",
      "in_reply_to_id": null,
      "user": {
        "login": "t-bast",
        "id": 31281497,
        "node_id": "MDQ6VXNlcjMxMjgxNDk3",
        "avatar_url": "https://avatars.githubusercontent.com/u/31281497?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/t-bast",
        "html_url": "https://github.com/t-bast",
        "followers_url": "https://api.github.com/users/t-bast/followers",
        "following_url": "https://api.github.com/users/t-bast/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/t-bast/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/t-bast/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/t-bast/subscriptions",
        "organizations_url": "https://api.github.com/users/t-bast/orgs",
        "repos_url": "https://api.github.com/users/t-bast/repos",
        "events_url": "https://api.github.com/users/t-bast/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/t-bast/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "I'm not sure this is really what we want. I think this function should try to refill multiple buckets at once (when amounts allow it), not just the most depleted one:\r\n\r\n- Check which utxo buckets should be refilled:\r\n  - Initialize a `to_refill` list of `(bucket, target_quantity)`\r\n  - For each utxo bucket:\r\n    - If the feerate is low (below a to-be-defined threshold) and the bucket is less than 70% full (or a to-be-defined threshold that could be configurable):\r\n      - Add this bucket to `to_refill` with a `target_quantity` of `target_utxo_count - current_utxo_count` (when feerate is low, we'd like to refill as much as possible)\r\n    - If the feerate is higher than our threshold and the bucket is less than 30% full (or a to-be-defined threshold that could be configurable), we refill less aggressively:\r\n      - Add this bucket to `to_refill` with a `target_quantity` that we scale (somehow) based on feerate and how many utxos we're missing\r\n  - Order `to_refill` by `target_quantity`, descending (we'll want to refill the buckets that are missing the most utxos first)\r\n- Check the utxos that we have outside of our buckets: we ideally want to spend those utxos to refill our buckets. We have no guarantee that those are the ones that will be used by the coin selection, but we can use their total amount as the maximum amount of funds we allocate to refill our buckets. This part is a bit fuzzy for me right now, I'm not sure this is the best approach, it definitely deserves more thoughts.\r\n  - Iterate over those utxos and add their amount to obtain `utxos_outside_buckets_total_amount`\r\n- Compute the change target based on `to_refill` and `utxos_outside_buckets_total_amount`:\r\n  - Initialize `change_target` to `0`\r\n  - Iterate over `to_refill`, and for each bucket that needs to be refilled:\r\n    - Decide how much of the `target_quantity` we want to refill based on `utxos_outside_buckets_total_amount` and the current `change_target`\r\n    - Add the corresponding amount to `change_target`\r\n    - That step probably has a lot of issues as well and deserves more thought. If we have a lot of utxos outside of our buckets, we may end up targeting a very large change amount and thus create a huge transaction, which is generally undesirable, but maybe desirable when our buckets are close to being empty. Maybe it makes sense to bound the `change_target` to a (small) multiplier of the funding amount? Or have a very different behavior when the feerate is very low, because when that happens we may want to fully refill our buckets?\r\n\r\nAs you can see, this is still very early discussion on what the algorithm should look like. It feels like we're still trying to understand the pitfalls we want to avoid we should try to write the algorithm in pseudo-code first in order to converge on an initial version (maybe to be detailed and discussed in a delving bitcoin post).\r\n\r\nAlso, when we don't want to actively refill buckets, we should target a changeless transaction, I'm not sure that is done right now?",
      "created_at": "2024-02-21T15:47:29Z",
      "updated_at": "2024-02-21T15:55:17Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29442#discussion_r1497820248",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1497820248"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29442"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 846,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1497828903",
      "pull_request_review_id": 1893495240,
      "id": 1497828903,
      "node_id": "PRRC_kwDOABII585ZRw4n",
      "diff_hunk": "@@ -799,6 +815,83 @@ util::Result<SelectionResult> SelectCoins(const CWallet& wallet, CoinsResult& av\n     return op_selection_result;\n }\n \n+/** Returns UTXO targets and compute their current count from available coins */\n+std::vector<UtxoTarget> UtxoTargetsFromJson(const UniValue& utxo_targets_json, const CoinsResult& available_coins)\n+{\n+    std::vector<UtxoTarget> utxo_targets;\n+    for (const auto& bucket : utxo_targets_json.getValues()) {\n+        UtxoTarget target = {\n+            bucket[\"start_satoshis\"].getInt<CAmount>(),\n+            bucket[\"end_satoshis\"].getInt<CAmount>(),\n+            bucket[\"target_utxo_count\"].getInt<uint32_t>()};\n+        utxo_targets.push_back(target);\n+    }\n+    for (const auto& [type, outputs] : available_coins.coins) {\n+        for (const wallet::COutput& output : outputs) {\n+            for (UtxoTarget& target : utxo_targets) {\n+                if (output.txout.nValue >= target.start_satoshis && output.txout.nValue <= target.end_satoshis) {\n+                    target.current_utxo_count++;\n+                    break;\n+                }\n+            }\n+        }\n+    }\n+\n+    return utxo_targets;\n+}\n+\n+/** Returns a random change amount in the range of the most depleted Utxo bucket and sets `capacity`\n+ * to the capacity of that change target, if any.\n+ */\n+std::optional<CAmount> GenerateChangeTargetFromUtxoTargets(const std::vector<UtxoTarget>& utxo_targets, const CAmount change_fee, double& capacity, FastRandomContext& rng)\n+{\n+    // Refill the most depleted utxo targets first.\n+    auto target_iter = std::min_element(utxo_targets.begin(), utxo_targets.end(), [](const UtxoTarget& a, const UtxoTarget& b) {\n+        return (double(a.current_utxo_count) / a.target_utxo_count) < (double(b.current_utxo_count) / b.target_utxo_count);\n+    });\n+    std::optional<CAmount> change_target;\n+    if (target_iter != utxo_targets.end()) {\n+        // Adjust the range of the target bucket based on the current fee rate.\n+        change_target = rng.randrange(target_iter->end_satoshis - target_iter->start_satoshis - change_fee) + target_iter->start_satoshis + change_fee;\n+        capacity = double(target_iter->current_utxo_count) / target_iter->target_utxo_count;\n+    }\n+    return change_target;\n+}\n+\n+std::list<CTxOut> SplitChangeFromUtxoTargets(CAmount change_amount, std::vector<UtxoTarget> utxo_targets, CAmount change_target, const CAmount change_fee, FastRandomContext& rng, CScript script_change)",
      "path": "src/wallet/spend.cpp",
      "position": null,
      "original_position": 84,
      "commit_id": "2efadb1b47611f714609c2b147d17aaac818ddc4",
      "original_commit_id": "85a049ddceb854106efea8316462e356d9b88b21",
      "in_reply_to_id": null,
      "user": {
        "login": "t-bast",
        "id": 31281497,
        "node_id": "MDQ6VXNlcjMxMjgxNDk3",
        "avatar_url": "https://avatars.githubusercontent.com/u/31281497?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/t-bast",
        "html_url": "https://github.com/t-bast",
        "followers_url": "https://api.github.com/users/t-bast/followers",
        "following_url": "https://api.github.com/users/t-bast/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/t-bast/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/t-bast/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/t-bast/subscriptions",
        "organizations_url": "https://api.github.com/users/t-bast/orgs",
        "repos_url": "https://api.github.com/users/t-bast/repos",
        "events_url": "https://api.github.com/users/t-bast/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/t-bast/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "I'm wondering whether we should use a fully deterministic algorithm to split the change into buckets, I'm afraid this is exactly the kind of algorithm that may end up in a loop where one funding attempt does something, and the next one undoes it. It feels like adding randomization may be the simple way to avoid this? But maybe it's too early in the algorithm design phase to decide.",
      "created_at": "2024-02-21T15:52:42Z",
      "updated_at": "2024-02-21T15:55:17Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29442#discussion_r1497828903",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1497828903"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29442"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 861,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1500540279",
      "pull_request_review_id": 1897914077,
      "id": 1500540279,
      "node_id": "PRRC_kwDOABII585ZcG13",
      "diff_hunk": "@@ -1128,6 +1225,36 @@ static util::Result<CreatedTransactionResult> CreateTransactionInternal(\n         available_coins = AvailableCoins(wallet, &coin_control, coin_selection_params.m_effective_feerate);\n     }\n \n+    // Load a json file that describes a target utxo set",
      "path": "src/wallet/spend.cpp",
      "position": null,
      "original_position": 138,
      "commit_id": "2efadb1b47611f714609c2b147d17aaac818ddc4",
      "original_commit_id": "85a049ddceb854106efea8316462e356d9b88b21",
      "in_reply_to_id": 1497769911,
      "user": {
        "login": "remyers",
        "id": 8568892,
        "node_id": "MDQ6VXNlcjg1Njg4OTI=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8568892?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/remyers",
        "html_url": "https://github.com/remyers",
        "followers_url": "https://api.github.com/users/remyers/followers",
        "following_url": "https://api.github.com/users/remyers/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/remyers/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/remyers/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/remyers/subscriptions",
        "organizations_url": "https://api.github.com/users/remyers/orgs",
        "repos_url": "https://api.github.com/users/remyers/repos",
        "events_url": "https://api.github.com/users/remyers/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/remyers/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "That makes sense. I also think a static file could describe the buckets in a way that better adapts to a changing fee environment.\r\n\r\nFor example, rather than `start_satoshis` and `end_satoshi` we could define a bucket as:\r\n\r\n```json\r\n        \"confirmation_target\": 6,\r\n        \"fee_rate_std\": 10000, \r\n        \"buckets\": [\r\n        {\r\n            \"target_satoshis\": 10000,\r\n            \"target_utxo_count\": 150\r\n        },\r\n```\r\n\r\nThe range of values you want to spend should be \"target_satoshis\" + the fee to spend that input at a fee rate that will confirm in \"confirmation_target\" blocks. Because free rates vary, we randomize the current fee rate within a range +/- \"fee_rate_std\".\r\n\r\nTo refill a bucket, compute the `target_output` as:\r\n```\r\ntarget_feerate = current_feerate(\"confirmation_target\") + random(-1 * \"fee_rate_std\", \"fee_rate_std\")\r\ntarget_output = \"target_satoshis\" + size_of_input * target_feerate \r\n``` \r\nIdeally we would only need to restart when we add/remove buckets, change their counts or when fee variance changes dramatically.\r\n",
      "created_at": "2024-02-23T11:33:13Z",
      "updated_at": "2024-02-23T11:33:13Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29442#discussion_r1500540279",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1500540279"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29442"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 1228,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1500904878",
      "pull_request_review_id": 1898503321,
      "id": 1500904878,
      "node_id": "PRRC_kwDOABII585Zdf2u",
      "diff_hunk": "@@ -799,6 +815,83 @@ util::Result<SelectionResult> SelectCoins(const CWallet& wallet, CoinsResult& av\n     return op_selection_result;\n }\n \n+/** Returns UTXO targets and compute their current count from available coins */\n+std::vector<UtxoTarget> UtxoTargetsFromJson(const UniValue& utxo_targets_json, const CoinsResult& available_coins)\n+{\n+    std::vector<UtxoTarget> utxo_targets;\n+    for (const auto& bucket : utxo_targets_json.getValues()) {\n+        UtxoTarget target = {\n+            bucket[\"start_satoshis\"].getInt<CAmount>(),\n+            bucket[\"end_satoshis\"].getInt<CAmount>(),\n+            bucket[\"target_utxo_count\"].getInt<uint32_t>()};\n+        utxo_targets.push_back(target);\n+    }\n+    for (const auto& [type, outputs] : available_coins.coins) {\n+        for (const wallet::COutput& output : outputs) {\n+            for (UtxoTarget& target : utxo_targets) {\n+                if (output.txout.nValue >= target.start_satoshis && output.txout.nValue <= target.end_satoshis) {\n+                    target.current_utxo_count++;\n+                    break;\n+                }\n+            }\n+        }\n+    }\n+\n+    return utxo_targets;\n+}\n+\n+/** Returns a random change amount in the range of the most depleted Utxo bucket and sets `capacity`\n+ * to the capacity of that change target, if any.\n+ */\n+std::optional<CAmount> GenerateChangeTargetFromUtxoTargets(const std::vector<UtxoTarget>& utxo_targets, const CAmount change_fee, double& capacity, FastRandomContext& rng)",
      "path": "src/wallet/spend.cpp",
      "position": null,
      "original_position": 69,
      "commit_id": "2efadb1b47611f714609c2b147d17aaac818ddc4",
      "original_commit_id": "85a049ddceb854106efea8316462e356d9b88b21",
      "in_reply_to_id": 1497820248,
      "user": {
        "login": "remyers",
        "id": 8568892,
        "node_id": "MDQ6VXNlcjg1Njg4OTI=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8568892?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/remyers",
        "html_url": "https://github.com/remyers",
        "followers_url": "https://api.github.com/users/remyers/followers",
        "following_url": "https://api.github.com/users/remyers/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/remyers/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/remyers/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/remyers/subscriptions",
        "organizations_url": "https://api.github.com/users/remyers/orgs",
        "repos_url": "https://api.github.com/users/remyers/repos",
        "events_url": "https://api.github.com/users/remyers/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/remyers/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "I think it is unavoidable that refilling buckets cannibalizes utxos from other buckets unless there is a pool of utxos larger than the largest target bucket to pick from. The goal though is that in the long run the system wastes as little value from fees and over payment as possible in aggregate.\r\n\r\nThis is how I think the process as implemented currently ([85a049d](https://github.com/bitcoin/bitcoin/pull/29442/commits/85a049ddceb854106efea8316462e356d9b88b21)) should work: \r\n\r\nBecause we always set our minimum change value to be *at least* as large as one of our target buckets that is depleted,  all of the wallet utxos are either in the range of one of our target buckets or larger than one of our target buckets.\r\n\r\nA changeless BnB solution is found when:\r\n1) there is a single utxo in the corresponding target bucket that does not overpay by too much in fees\r\n2) a combination of multiple utxos smaller than the target bucket exist that do not overpay by too much in fees\r\n\r\nA CoinGrinder solution is preferred when the cost of fees and over payment of the best BnB solution is more than the fees from using:\r\n1) a single larger utxo with change outputs \r\n2) a combination of multiple smaller utxos and change outputs\r\n\r\nThe largest wallet utxo will hold the residual value after initially refilling the buckets from cold storage. This residual funding utxo will be used as a single input when:\r\n1) this utxo is available and CoinGrinder selects it to refill buckets opportunistically \r\n2) fees are low, or buckets are severely depleted, we force this input to be selected to refill buckets. \r\n\r\nWhen a large residual value utxo is used to refill all buckets via change outputs, another large residual utxo may also be created. That residual value utxo can not be used again until the tx that uses it confirms. This seems like an area that can be optimized. Perhaps a separate automatic refill transaction that confirms quickly makes more sense than using it for opportunistic bucket refills.\r\n\r\nEventually the largest utxo in the wallet will be in the range of the target buckets. The utxo set will then no longer be able to refill buckets without also depleting other buckets. This should be a signal to refill the wallet from cold storage.",
      "created_at": "2024-02-23T16:30:06Z",
      "updated_at": "2024-02-23T16:30:06Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29442#discussion_r1500904878",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1500904878"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29442"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 846,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1502339382",
      "pull_request_review_id": 1900440292,
      "id": 1502339382,
      "node_id": "PRRC_kwDOABII585Zi-E2",
      "diff_hunk": "@@ -799,6 +815,83 @@ util::Result<SelectionResult> SelectCoins(const CWallet& wallet, CoinsResult& av\n     return op_selection_result;\n }\n \n+/** Returns UTXO targets and compute their current count from available coins */\n+std::vector<UtxoTarget> UtxoTargetsFromJson(const UniValue& utxo_targets_json, const CoinsResult& available_coins)\n+{\n+    std::vector<UtxoTarget> utxo_targets;\n+    for (const auto& bucket : utxo_targets_json.getValues()) {\n+        UtxoTarget target = {\n+            bucket[\"start_satoshis\"].getInt<CAmount>(),\n+            bucket[\"end_satoshis\"].getInt<CAmount>(),\n+            bucket[\"target_utxo_count\"].getInt<uint32_t>()};\n+        utxo_targets.push_back(target);\n+    }\n+    for (const auto& [type, outputs] : available_coins.coins) {\n+        for (const wallet::COutput& output : outputs) {\n+            for (UtxoTarget& target : utxo_targets) {\n+                if (output.txout.nValue >= target.start_satoshis && output.txout.nValue <= target.end_satoshis) {\n+                    target.current_utxo_count++;\n+                    break;\n+                }\n+            }\n+        }\n+    }\n+\n+    return utxo_targets;\n+}\n+\n+/** Returns a random change amount in the range of the most depleted Utxo bucket and sets `capacity`\n+ * to the capacity of that change target, if any.\n+ */\n+std::optional<CAmount> GenerateChangeTargetFromUtxoTargets(const std::vector<UtxoTarget>& utxo_targets, const CAmount change_fee, double& capacity, FastRandomContext& rng)\n+{\n+    // Refill the most depleted utxo targets first.\n+    auto target_iter = std::min_element(utxo_targets.begin(), utxo_targets.end(), [](const UtxoTarget& a, const UtxoTarget& b) {\n+        return (double(a.current_utxo_count) / a.target_utxo_count) < (double(b.current_utxo_count) / b.target_utxo_count);\n+    });\n+    std::optional<CAmount> change_target;\n+    if (target_iter != utxo_targets.end()) {\n+        // Adjust the range of the target bucket based on the current fee rate.\n+        change_target = rng.randrange(target_iter->end_satoshis - target_iter->start_satoshis - change_fee) + target_iter->start_satoshis + change_fee;\n+        capacity = double(target_iter->current_utxo_count) / target_iter->target_utxo_count;\n+    }\n+    return change_target;\n+}\n+\n+std::list<CTxOut> SplitChangeFromUtxoTargets(CAmount change_amount, std::vector<UtxoTarget> utxo_targets, CAmount change_target, const CAmount change_fee, FastRandomContext& rng, CScript script_change)",
      "path": "src/wallet/spend.cpp",
      "position": null,
      "original_position": 84,
      "commit_id": "2efadb1b47611f714609c2b147d17aaac818ddc4",
      "original_commit_id": "85a049ddceb854106efea8316462e356d9b88b21",
      "in_reply_to_id": 1497828903,
      "user": {
        "login": "remyers",
        "id": 8568892,
        "node_id": "MDQ6VXNlcjg1Njg4OTI=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8568892?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/remyers",
        "html_url": "https://github.com/remyers",
        "followers_url": "https://api.github.com/users/remyers/followers",
        "following_url": "https://api.github.com/users/remyers/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/remyers/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/remyers/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/remyers/subscriptions",
        "organizations_url": "https://api.github.com/users/remyers/orgs",
        "repos_url": "https://api.github.com/users/remyers/repos",
        "events_url": "https://api.github.com/users/remyers/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/remyers/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "I agree that there's a risk that one funding operation adds an extra input from an existing bucket and then creates a change output to refill that same bucket, for example. My intuition though is that we can't optimize too far into the future.\r\n\r\nEven if an input is cannibalized from a bucket, it will be \"reforged\" into a new utxo that hopefully has a value that is more likely to be selected by BnB as a single input to a future changeless funding transaction.  The current scheme randomizes new change outputs and skews them based on the current fee rate to try to optimize for future changeless single input transactions.\r\n\r\nCan we do better with some ideas from memory caching? Maybe use the frequency that a particular amount is requested for funding to influence whether it is used as an extra input or as the size of a new change output?",
      "created_at": "2024-02-26T10:04:46Z",
      "updated_at": "2024-02-26T10:04:47Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29442#discussion_r1502339382",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1502339382"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29442"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 861,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1505941145",
      "pull_request_review_id": 1906233583,
      "id": 1505941145,
      "node_id": "PRRC_kwDOABII585ZwtaZ",
      "diff_hunk": "@@ -799,6 +815,83 @@ util::Result<SelectionResult> SelectCoins(const CWallet& wallet, CoinsResult& av\n     return op_selection_result;\n }\n \n+/** Returns UTXO targets and compute their current count from available coins */\n+std::vector<UtxoTarget> UtxoTargetsFromJson(const UniValue& utxo_targets_json, const CoinsResult& available_coins)\n+{\n+    std::vector<UtxoTarget> utxo_targets;\n+    for (const auto& bucket : utxo_targets_json.getValues()) {\n+        UtxoTarget target = {\n+            bucket[\"start_satoshis\"].getInt<CAmount>(),\n+            bucket[\"end_satoshis\"].getInt<CAmount>(),\n+            bucket[\"target_utxo_count\"].getInt<uint32_t>()};\n+        utxo_targets.push_back(target);\n+    }\n+    for (const auto& [type, outputs] : available_coins.coins) {\n+        for (const wallet::COutput& output : outputs) {\n+            for (UtxoTarget& target : utxo_targets) {\n+                if (output.txout.nValue >= target.start_satoshis && output.txout.nValue <= target.end_satoshis) {\n+                    target.current_utxo_count++;\n+                    break;\n+                }\n+            }\n+        }\n+    }\n+\n+    return utxo_targets;\n+}\n+\n+/** Returns a random change amount in the range of the most depleted Utxo bucket and sets `capacity`\n+ * to the capacity of that change target, if any.\n+ */\n+std::optional<CAmount> GenerateChangeTargetFromUtxoTargets(const std::vector<UtxoTarget>& utxo_targets, const CAmount change_fee, double& capacity, FastRandomContext& rng)",
      "path": "src/wallet/spend.cpp",
      "position": null,
      "original_position": 69,
      "commit_id": "2efadb1b47611f714609c2b147d17aaac818ddc4",
      "original_commit_id": "85a049ddceb854106efea8316462e356d9b88b21",
      "in_reply_to_id": 1497820248,
      "user": {
        "login": "remyers",
        "id": 8568892,
        "node_id": "MDQ6VXNlcjg1Njg4OTI=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8568892?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/remyers",
        "html_url": "https://github.com/remyers",
        "followers_url": "https://api.github.com/users/remyers/followers",
        "following_url": "https://api.github.com/users/remyers/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/remyers/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/remyers/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/remyers/subscriptions",
        "organizations_url": "https://api.github.com/users/remyers/orgs",
        "repos_url": "https://api.github.com/users/remyers/repos",
        "events_url": "https://api.github.com/users/remyers/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/remyers/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "> Also, when we don't want to actively refill buckets, we should target a changeless transaction, I'm not sure that is done right now?\r\n\r\nThe current system should always prefer changeless transactions unless, for example, an exact match with more inputs and no change is more wasteful than selecting fewer inputs that generate a change output.",
      "created_at": "2024-02-28T13:10:18Z",
      "updated_at": "2024-02-28T13:10:18Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29442#discussion_r1505941145",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1505941145"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29442"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 846,
      "side": "RIGHT"
    }
  ]
}
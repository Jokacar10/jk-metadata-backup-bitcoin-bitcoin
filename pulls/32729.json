{
  "type": "pull",
  "pull": {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/32729",
    "id": 2584507258,
    "node_id": "PR_kwDOABII586aDHN6",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/32729",
    "diff_url": "https://github.com/bitcoin/bitcoin/pull/32729.diff",
    "patch_url": "https://github.com/bitcoin/bitcoin/pull/32729.patch",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/32729",
    "commits_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/32729/commits",
    "review_comments_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/32729/comments",
    "review_comment_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments%7B/number%7D",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/32729/comments",
    "statuses_url": "https://api.github.com/repos/bitcoin/bitcoin/statuses/db4bf84c87bc27f10c0ca393469ec13e61b64fd1",
    "number": 32729,
    "state": "open",
    "locked": false,
    "maintainer_can_modify": true,
    "title": "test,refactor: extract script template helpers & widen sigop count coverage",
    "user": {
      "login": "l0rinc",
      "id": 1841944,
      "node_id": "MDQ6VXNlcjE4NDE5NDQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1841944?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/l0rinc",
      "html_url": "https://github.com/l0rinc",
      "followers_url": "https://api.github.com/users/l0rinc/followers",
      "following_url": "https://api.github.com/users/l0rinc/following%7B/other_user%7D",
      "gists_url": "https://api.github.com/users/l0rinc/gists%7B/gist_id%7D",
      "starred_url": "https://api.github.com/users/l0rinc/starred%7B/owner%7D%7B/repo%7D",
      "subscriptions_url": "https://api.github.com/users/l0rinc/subscriptions",
      "organizations_url": "https://api.github.com/users/l0rinc/orgs",
      "repos_url": "https://api.github.com/users/l0rinc/repos",
      "events_url": "https://api.github.com/users/l0rinc/events%7B/privacy%7D",
      "received_events_url": "https://api.github.com/users/l0rinc/received_events",
      "type": "User",
      "site_admin": false,
      "patch_url": null
    },
    "body": "### Summary\r\n\r\nThis PR extracts a set of cheap, inline helpers for recognizing the most common script templates, clarifies the definition of valid op-codes for legacy (pre-Taproot) scripts, and splits the existing \"deserialize + check-block\" benchmark into three orthogonal micro-benchmarks.  \r\nThe change is behavior-neutral for consensus and policy - every modified call-site performs the same checks as before, just through clearer helper functions.\r\n\r\n### Context\r\n\r\nWhile working on [`GetSigOpCount` optimizations for known script templates](https://github.com/bitcoin/bitcoin/pull/32532) I noticed that feature-test coverage was [thin for this code path](https://maflcko.github.io/b-c-cov/total.coverage/src/script/script.cpp.gcov.html).  \r\nThis PR therefore adds tests for error cases (malformed push-data encodings) and for the expected sigop totals of the various script templates (including edge cases like a sigop after an `OP_RETURN`).\r\n\r\nGiven the difficulty of reviewing the [original optimizations themselves](https://github.com/bitcoin/bitcoin/pull/32532#issuecomment-2950665350), I split all test / benchmark work into this standalone PR.  \r\nThe recent burst of sigops related refactor activity ([#31624](https://github.com/bitcoin/bitcoin/pull/31624), [#32521](https://github.com/bitcoin/bitcoin/pull/32521), [#32533](https://github.com/bitcoin/bitcoin/pull/32533)) underlines the need for extra safety.\r\n\r\nThe refactors here eliminate magic numbers, deduplicate template checks, and lay groundwork for future performance work.\r\n\r\n### Structure\r\n\r\n* **Benchmarks** - first commits separate deserialization+hashing, validation, and sigop counting so each cost can be measured independently.  \r\n* **Template helpers** - tiny, mechanical commits move each script-template check into `script.h`, replace all ad-hoc byte-checks, and add tests where necessary.  \r\n* **Tests** - a full script-test suite covering malformed `PUSHDATA` sequences and the legacy / accurate sigop totals for every standard template.  \r\n* **Legacy opcode ceiling** - final commit documents, enforces, and tests that `OP_CHECKSIGADD` > `MAX_OPCODE`.",
    "labels": [
      {
        "id": 62963516,
        "node_id": "MDU6TGFiZWw2Mjk2MzUxNg==",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Tests",
        "name": "Tests",
        "color": "d4c5f9",
        "default": false
      },
      {
        "id": 5334691551,
        "node_id": "LA_kwDOABII588AAAABPfju3w",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/CI%20failed",
        "name": "CI failed",
        "description": "",
        "color": "cccccc",
        "default": false
      }
    ],
    "created_at": "2025-06-11T14:44:28Z",
    "updated_at": "2025-08-05T02:39:18Z",
    "mergeable": true,
    "mergeable_state": "blocked",
    "merged": false,
    "merge_commit_sha": "d8ac1dc7763f68062521f1402100d256da40917d",
    "assignees": [],
    "requested_reviewers": [],
    "requested_teams": [],
    "rebaseable": true,
    "head": {
      "label": "l0rinc:l0rinc/sigop-testing",
      "ref": "l0rinc/sigop-testing",
      "sha": "db4bf84c87bc27f10c0ca393469ec13e61b64fd1",
      "user": {
        "login": "l0rinc",
        "id": 1841944,
        "node_id": "MDQ6VXNlcjE4NDE5NDQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1841944?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/l0rinc",
        "html_url": "https://github.com/l0rinc",
        "followers_url": "https://api.github.com/users/l0rinc/followers",
        "following_url": "https://api.github.com/users/l0rinc/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/l0rinc/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/l0rinc/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/l0rinc/subscriptions",
        "organizations_url": "https://api.github.com/users/l0rinc/orgs",
        "repos_url": "https://api.github.com/users/l0rinc/repos",
        "events_url": "https://api.github.com/users/l0rinc/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/l0rinc/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "repo": {
        "id": 674169038,
        "node_id": "R_kgDOKC8Azg",
        "name": "bitcoin",
        "full_name": "l0rinc/bitcoin",
        "owner": {
          "login": "l0rinc",
          "id": 1841944,
          "node_id": "MDQ6VXNlcjE4NDE5NDQ=",
          "avatar_url": "https://avatars.githubusercontent.com/u/1841944?v=4",
          "gravatar_id": "",
          "url": "https://api.github.com/users/l0rinc",
          "html_url": "https://github.com/l0rinc",
          "followers_url": "https://api.github.com/users/l0rinc/followers",
          "following_url": "https://api.github.com/users/l0rinc/following%7B/other_user%7D",
          "gists_url": "https://api.github.com/users/l0rinc/gists%7B/gist_id%7D",
          "starred_url": "https://api.github.com/users/l0rinc/starred%7B/owner%7D%7B/repo%7D",
          "subscriptions_url": "https://api.github.com/users/l0rinc/subscriptions",
          "organizations_url": "https://api.github.com/users/l0rinc/orgs",
          "repos_url": "https://api.github.com/users/l0rinc/repos",
          "events_url": "https://api.github.com/users/l0rinc/events%7B/privacy%7D",
          "received_events_url": "https://api.github.com/users/l0rinc/received_events",
          "type": "User",
          "site_admin": false,
          "patch_url": null
        },
        "private": false,
        "html_url": "https://github.com/l0rinc/bitcoin",
        "description": "Bitcoin Core integration/staging tree",
        "fork": true,
        "url": "https://api.github.com/repos/l0rinc/bitcoin",
        "archive_url": "https://api.github.com/repos/l0rinc/bitcoin/%7Barchive_format%7D%7B/ref%7D",
        "assignees_url": "https://api.github.com/repos/l0rinc/bitcoin/assignees%7B/user%7D",
        "blobs_url": "https://api.github.com/repos/l0rinc/bitcoin/git/blobs%7B/sha%7D",
        "branches_url": "https://api.github.com/repos/l0rinc/bitcoin/branches%7B/branch%7D",
        "collaborators_url": "https://api.github.com/repos/l0rinc/bitcoin/collaborators%7B/collaborator%7D",
        "comments_url": "https://api.github.com/repos/l0rinc/bitcoin/comments%7B/number%7D",
        "commits_url": "https://api.github.com/repos/l0rinc/bitcoin/commits%7B/sha%7D",
        "compare_url": "https://api.github.com/repos/l0rinc/bitcoin/compare/%7Bbase%7D...%7Bhead%7D",
        "contents_url": "https://api.github.com/repos/l0rinc/bitcoin/contents/%7B+path%7D",
        "contributors_url": "https://api.github.com/repos/l0rinc/bitcoin/contributors",
        "deployments_url": "https://api.github.com/repos/l0rinc/bitcoin/deployments",
        "downloads_url": "https://api.github.com/repos/l0rinc/bitcoin/downloads",
        "events_url": "https://api.github.com/repos/l0rinc/bitcoin/events",
        "forks_url": "https://api.github.com/repos/l0rinc/bitcoin/forks",
        "git_commits_url": "https://api.github.com/repos/l0rinc/bitcoin/git/commits%7B/sha%7D",
        "git_refs_url": "https://api.github.com/repos/l0rinc/bitcoin/git/refs%7B/sha%7D",
        "git_tags_url": "https://api.github.com/repos/l0rinc/bitcoin/git/tags%7B/sha%7D",
        "git_url": "git://github.com/l0rinc/bitcoin.git",
        "issue_comment_url": "https://api.github.com/repos/l0rinc/bitcoin/issues/comments%7B/number%7D",
        "issue_events_url": "https://api.github.com/repos/l0rinc/bitcoin/issues/events%7B/number%7D",
        "issues_url": "https://api.github.com/repos/l0rinc/bitcoin/issues%7B/number%7D",
        "keys_url": "https://api.github.com/repos/l0rinc/bitcoin/keys%7B/key_id%7D",
        "labels_url": "https://api.github.com/repos/l0rinc/bitcoin/labels%7B/name%7D",
        "languages_url": "https://api.github.com/repos/l0rinc/bitcoin/languages",
        "merges_url": "https://api.github.com/repos/l0rinc/bitcoin/merges",
        "milestones_url": "https://api.github.com/repos/l0rinc/bitcoin/milestones%7B/number%7D",
        "notifications_url": "https://api.github.com/repos/l0rinc/bitcoin/notifications%7B?since,all,participating}",
        "pulls_url": "https://api.github.com/repos/l0rinc/bitcoin/pulls%7B/number%7D",
        "releases_url": "https://api.github.com/repos/l0rinc/bitcoin/releases%7B/id%7D",
        "ssh_url": "git@github.com:l0rinc/bitcoin.git",
        "stargazers_url": "https://api.github.com/repos/l0rinc/bitcoin/stargazers",
        "statuses_url": "https://api.github.com/repos/l0rinc/bitcoin/statuses/%7Bsha%7D",
        "subscribers_url": "https://api.github.com/repos/l0rinc/bitcoin/subscribers",
        "subscription_url": "https://api.github.com/repos/l0rinc/bitcoin/subscription",
        "tags_url": "https://api.github.com/repos/l0rinc/bitcoin/tags",
        "teams_url": "https://api.github.com/repos/l0rinc/bitcoin/teams",
        "trees_url": "https://api.github.com/repos/l0rinc/bitcoin/git/trees%7B/sha%7D",
        "clone_url": "https://github.com/l0rinc/bitcoin.git",
        "hooks_url": "https://api.github.com/repos/l0rinc/bitcoin/hooks",
        "svn_url": "https://github.com/l0rinc/bitcoin",
        "homepage": "https://bitcoincore.org/en/download",
        "language": "C++",
        "forks_count": 0,
        "stargazers_count": 1,
        "watchers_count": 1,
        "size": 269993,
        "default_branch": "master",
        "open_issues_count": 5,
        "is_template": false,
        "topics": [],
        "has_issues": false,
        "has_projects": true,
        "has_wiki": false,
        "has_pages": false,
        "has_downloads": false,
        "archived": false,
        "disabled": false,
        "visibility": "public",
        "pushed_at": "2025-08-05T02:25:19Z",
        "created_at": "2023-08-03T09:49:12Z",
        "updated_at": "2025-08-04T01:45:17Z",
        "allow_forking": true,
        "license": {
          "key": "mit",
          "name": "MIT License",
          "node_id": "MDc6TGljZW5zZTEz",
          "spdx_id": "MIT",
          "url": "https://api.github.com/licenses/mit",
          "html_url": null,
          "description": null,
          "implementation": null,
          "permissions": null,
          "conditions": null,
          "limitations": null,
          "body": null,
          "featured": null
        }
      }
    },
    "base": {
      "label": "bitcoin:master",
      "ref": "master",
      "sha": "d1b583181dcc31613cd586d63329cb4c4a586972",
      "user": {
        "login": "bitcoin",
        "id": 528860,
        "node_id": "MDEyOk9yZ2FuaXphdGlvbjUyODg2MA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/528860?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/bitcoin",
        "html_url": "https://github.com/bitcoin",
        "followers_url": "https://api.github.com/users/bitcoin/followers",
        "following_url": "https://api.github.com/users/bitcoin/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/bitcoin/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/bitcoin/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/bitcoin/subscriptions",
        "organizations_url": "https://api.github.com/users/bitcoin/orgs",
        "repos_url": "https://api.github.com/users/bitcoin/repos",
        "events_url": "https://api.github.com/users/bitcoin/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/bitcoin/received_events",
        "type": "Organization",
        "site_admin": false,
        "patch_url": null
      },
      "repo": {
        "id": 1181927,
        "node_id": "MDEwOlJlcG9zaXRvcnkxMTgxOTI3",
        "name": "bitcoin",
        "full_name": "bitcoin/bitcoin",
        "owner": {
          "login": "bitcoin",
          "id": 528860,
          "node_id": "MDEyOk9yZ2FuaXphdGlvbjUyODg2MA==",
          "avatar_url": "https://avatars.githubusercontent.com/u/528860?v=4",
          "gravatar_id": "",
          "url": "https://api.github.com/users/bitcoin",
          "html_url": "https://github.com/bitcoin",
          "followers_url": "https://api.github.com/users/bitcoin/followers",
          "following_url": "https://api.github.com/users/bitcoin/following%7B/other_user%7D",
          "gists_url": "https://api.github.com/users/bitcoin/gists%7B/gist_id%7D",
          "starred_url": "https://api.github.com/users/bitcoin/starred%7B/owner%7D%7B/repo%7D",
          "subscriptions_url": "https://api.github.com/users/bitcoin/subscriptions",
          "organizations_url": "https://api.github.com/users/bitcoin/orgs",
          "repos_url": "https://api.github.com/users/bitcoin/repos",
          "events_url": "https://api.github.com/users/bitcoin/events%7B/privacy%7D",
          "received_events_url": "https://api.github.com/users/bitcoin/received_events",
          "type": "Organization",
          "site_admin": false,
          "patch_url": null
        },
        "private": false,
        "html_url": "https://github.com/bitcoin/bitcoin",
        "description": "Bitcoin Core integration/staging tree",
        "fork": false,
        "url": "https://api.github.com/repos/bitcoin/bitcoin",
        "archive_url": "https://api.github.com/repos/bitcoin/bitcoin/%7Barchive_format%7D%7B/ref%7D",
        "assignees_url": "https://api.github.com/repos/bitcoin/bitcoin/assignees%7B/user%7D",
        "blobs_url": "https://api.github.com/repos/bitcoin/bitcoin/git/blobs%7B/sha%7D",
        "branches_url": "https://api.github.com/repos/bitcoin/bitcoin/branches%7B/branch%7D",
        "collaborators_url": "https://api.github.com/repos/bitcoin/bitcoin/collaborators%7B/collaborator%7D",
        "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/comments%7B/number%7D",
        "commits_url": "https://api.github.com/repos/bitcoin/bitcoin/commits%7B/sha%7D",
        "compare_url": "https://api.github.com/repos/bitcoin/bitcoin/compare/%7Bbase%7D...%7Bhead%7D",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/%7B+path%7D",
        "contributors_url": "https://api.github.com/repos/bitcoin/bitcoin/contributors",
        "deployments_url": "https://api.github.com/repos/bitcoin/bitcoin/deployments",
        "downloads_url": "https://api.github.com/repos/bitcoin/bitcoin/downloads",
        "events_url": "https://api.github.com/repos/bitcoin/bitcoin/events",
        "forks_url": "https://api.github.com/repos/bitcoin/bitcoin/forks",
        "git_commits_url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits%7B/sha%7D",
        "git_refs_url": "https://api.github.com/repos/bitcoin/bitcoin/git/refs%7B/sha%7D",
        "git_tags_url": "https://api.github.com/repos/bitcoin/bitcoin/git/tags%7B/sha%7D",
        "git_url": "git://github.com/bitcoin/bitcoin.git",
        "issue_comment_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments%7B/number%7D",
        "issue_events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events%7B/number%7D",
        "issues_url": "https://api.github.com/repos/bitcoin/bitcoin/issues%7B/number%7D",
        "keys_url": "https://api.github.com/repos/bitcoin/bitcoin/keys%7B/key_id%7D",
        "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/labels%7B/name%7D",
        "languages_url": "https://api.github.com/repos/bitcoin/bitcoin/languages",
        "merges_url": "https://api.github.com/repos/bitcoin/bitcoin/merges",
        "milestones_url": "https://api.github.com/repos/bitcoin/bitcoin/milestones%7B/number%7D",
        "notifications_url": "https://api.github.com/repos/bitcoin/bitcoin/notifications%7B?since,all,participating}",
        "pulls_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls%7B/number%7D",
        "releases_url": "https://api.github.com/repos/bitcoin/bitcoin/releases%7B/id%7D",
        "ssh_url": "git@github.com:bitcoin/bitcoin.git",
        "stargazers_url": "https://api.github.com/repos/bitcoin/bitcoin/stargazers",
        "statuses_url": "https://api.github.com/repos/bitcoin/bitcoin/statuses/%7Bsha%7D",
        "subscribers_url": "https://api.github.com/repos/bitcoin/bitcoin/subscribers",
        "subscription_url": "https://api.github.com/repos/bitcoin/bitcoin/subscription",
        "tags_url": "https://api.github.com/repos/bitcoin/bitcoin/tags",
        "teams_url": "https://api.github.com/repos/bitcoin/bitcoin/teams",
        "trees_url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees%7B/sha%7D",
        "clone_url": "https://github.com/bitcoin/bitcoin.git",
        "hooks_url": "https://api.github.com/repos/bitcoin/bitcoin/hooks",
        "svn_url": "https://github.com/bitcoin/bitcoin",
        "homepage": "https://bitcoincore.org/en/download",
        "language": "C++",
        "forks_count": 37607,
        "stargazers_count": 84882,
        "watchers_count": 84882,
        "size": 290109,
        "default_branch": "master",
        "open_issues_count": 751,
        "is_template": false,
        "topics": [
          "bitcoin",
          "c-plus-plus",
          "cryptocurrency",
          "cryptography",
          "p2p"
        ],
        "has_issues": true,
        "has_projects": true,
        "has_wiki": false,
        "has_pages": false,
        "has_downloads": false,
        "archived": false,
        "disabled": false,
        "visibility": "public",
        "pushed_at": "2025-08-04T18:04:35Z",
        "created_at": "2010-12-19T15:16:43Z",
        "updated_at": "2025-08-04T23:20:52Z",
        "allow_forking": true,
        "license": {
          "key": "mit",
          "name": "MIT License",
          "node_id": "MDc6TGljZW5zZTEz",
          "spdx_id": "MIT",
          "url": "https://api.github.com/licenses/mit",
          "html_url": null,
          "description": null,
          "implementation": null,
          "permissions": null,
          "conditions": null,
          "limitations": null,
          "body": null,
          "featured": null
        }
      }
    },
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/32729"
      }
    },
    "author_association": "CONTRIBUTOR",
    "draft": false,
    "additions": 447,
    "deletions": 196,
    "changed_files": 26,
    "commits": 15,
    "review_comments": 3,
    "comments": 5
  },
  "events": [
    {
      "event": "commented",
      "id": 2963122620,
      "node_id": "IC_kwDOABII586wnam8",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2963122620",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-06-11T14:44:32Z",
      "updated_at": "2025-07-30T06:28:08Z",
      "author_association": "CONTRIBUTOR",
      "body": "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--006a51241073e994b41acfe9ec718e94-->\n### Code Coverage & Benchmarks\nFor details see: https://corecheck.dev/bitcoin/bitcoin/pulls/32729.\n<!--021abf342d371248e50ceaed478a90ca-->\n### Reviews\nSee [the guideline](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#code-review) for information on the review process.\nA summary of reviews will appear here.\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* [#32554](https://github.com/bitcoin/bitcoin/pull/32554) (bench: replace embedded raw block with configurable block generator by l0rinc)\n* [#31989](https://github.com/bitcoin/bitcoin/pull/31989) (BIP-119 (OP_CHECKTEMPLATEVERIFY) (regtest only) by jamesob)\n* [#31868](https://github.com/bitcoin/bitcoin/pull/31868) ([IBD] specialize block serialization by l0rinc)\n* [#31682](https://github.com/bitcoin/bitcoin/pull/31682) ([IBD] specialize CheckBlock's input & coinbase checks by l0rinc)\n* [#29060](https://github.com/bitcoin/bitcoin/pull/29060) (Policy: Report reason inputs are non standard by ismaelsadeeq)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.\n<!--5faf32d7da4f0f540f40219e4f7537a3-->",
      "user": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32729#issuecomment-2963122620",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/32729"
    },
    {
      "event": "renamed",
      "id": 18096108144,
      "node_id": "RTE_lADOABII5866_H3nzwAAAAQ2nLJw",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/18096108144",
      "actor": {
        "login": "l0rinc",
        "id": 1841944,
        "node_id": "MDQ6VXNlcjE4NDE5NDQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1841944?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/l0rinc",
        "html_url": "https://github.com/l0rinc",
        "followers_url": "https://api.github.com/users/l0rinc/followers",
        "following_url": "https://api.github.com/users/l0rinc/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/l0rinc/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/l0rinc/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/l0rinc/subscriptions",
        "organizations_url": "https://api.github.com/users/l0rinc/orgs",
        "repos_url": "https://api.github.com/users/l0rinc/repos",
        "events_url": "https://api.github.com/users/l0rinc/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/l0rinc/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-06-11T14:46:14Z",
      "rename": {
        "from": "test,refactor: sigops",
        "to": "test: extract script template helpers & widen sigop count coverage"
      }
    },
    {
      "event": "labeled",
      "id": 18096109274,
      "node_id": "LE_lADOABII5866_H3nzwAAAAQ2nLba",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/18096109274",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-06-11T14:46:17Z",
      "label": {
        "name": "Tests",
        "color": "d4c5f9"
      }
    },
    {
      "event": "renamed",
      "id": 18096453480,
      "node_id": "RTE_lADOABII5866_H3nzwAAAAQ2ofdo",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/18096453480",
      "actor": {
        "login": "l0rinc",
        "id": 1841944,
        "node_id": "MDQ6VXNlcjE4NDE5NDQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1841944?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/l0rinc",
        "html_url": "https://github.com/l0rinc",
        "followers_url": "https://api.github.com/users/l0rinc/followers",
        "following_url": "https://api.github.com/users/l0rinc/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/l0rinc/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/l0rinc/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/l0rinc/subscriptions",
        "organizations_url": "https://api.github.com/users/l0rinc/orgs",
        "repos_url": "https://api.github.com/users/l0rinc/repos",
        "events_url": "https://api.github.com/users/l0rinc/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/l0rinc/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-06-11T15:02:25Z",
      "rename": {
        "from": "test: extract script template helpers & widen sigop count coverage",
        "to": "test,refactor: extract script template helpers & widen sigop count coverage"
      }
    },
    {
      "event": "ready_for_review",
      "id": 18099752595,
      "node_id": "RFRE_lADOABII5866_H3nzwAAAAQ21E6T",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/18099752595",
      "actor": {
        "login": "l0rinc",
        "id": 1841944,
        "node_id": "MDQ6VXNlcjE4NDE5NDQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1841944?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/l0rinc",
        "html_url": "https://github.com/l0rinc",
        "followers_url": "https://api.github.com/users/l0rinc/followers",
        "following_url": "https://api.github.com/users/l0rinc/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/l0rinc/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/l0rinc/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/l0rinc/subscriptions",
        "organizations_url": "https://api.github.com/users/l0rinc/orgs",
        "repos_url": "https://api.github.com/users/l0rinc/repos",
        "events_url": "https://api.github.com/users/l0rinc/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/l0rinc/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-06-11T18:21:25Z"
    },
    {
      "event": "labeled",
      "id": 18102627041,
      "node_id": "LE_lADOABII5866_H3nzwAAAAQ3ACrh",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/18102627041",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-06-11T22:14:06Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "head_ref_force_pushed",
      "id": 18113104532,
      "node_id": "HRFPE_lADOABII5866_H3nzwAAAAQ3oAqU",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/18113104532",
      "actor": {
        "login": "l0rinc",
        "id": 1841944,
        "node_id": "MDQ6VXNlcjE4NDE5NDQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1841944?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/l0rinc",
        "html_url": "https://github.com/l0rinc",
        "followers_url": "https://api.github.com/users/l0rinc/followers",
        "following_url": "https://api.github.com/users/l0rinc/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/l0rinc/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/l0rinc/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/l0rinc/subscriptions",
        "organizations_url": "https://api.github.com/users/l0rinc/orgs",
        "repos_url": "https://api.github.com/users/l0rinc/repos",
        "events_url": "https://api.github.com/users/l0rinc/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/l0rinc/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": "0582b630d7b61108bc37eaa91e9761e9923f5aed",
      "commit_url": "https://api.github.com/repos/l0rinc/bitcoin/commits/0582b630d7b61108bc37eaa91e9761e9923f5aed",
      "created_at": "2025-06-12T11:12:47Z"
    },
    {
      "event": "unlabeled",
      "id": 18115228099,
      "node_id": "UNLE_lADOABII5866_H3nzwAAAAQ3wHHD",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/18115228099",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-06-12T13:07:35Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "labeled",
      "id": 18725479148,
      "node_id": "LE_lADOABII5866_H3nzwAAAARcICLs",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/18725479148",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-07-21T10:23:38Z",
      "label": {
        "name": "CI failed",
        "color": "cccccc"
      }
    },
    {
      "event": "commented",
      "id": 3096072785,
      "node_id": "IC_kwDOABII5864ilJR",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/3096072785",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-07-21T10:23:40Z",
      "updated_at": "2025-07-21T10:23:40Z",
      "author_association": "CONTRIBUTOR",
      "body": "<!--85328a0da195eb286784d51f73fa0af9-->\n🚧 At least one of the CI tasks failed.\n<sub>Task `tidy`: https://github.com/bitcoin/bitcoin/runs/43965124848</sub>\n<sub>LLM reason (✨ experimental): The failure is caused by a compilation error in policy.cpp where a boolean value is incorrectly passed to a function expecting a CScript reference.</sub>\n\n<details><summary>Hints</summary>\n\nTry to run the tests locally, according to the documentation. However, a CI failure may still\nhappen due to a number of reasons, for example:\n\n* Possibly due to a silent merge conflict (the changes in this pull request being\nincompatible with the current code in the target branch). If so, make sure to rebase on the latest\ncommit of the target branch.\n\n* A sanitizer issue, which can only be found by compiling with the sanitizer and running the\n  affected test.\n\n* An intermittent issue.\n\nLeave a comment here, if you need help tracking down a confusing failure.\n\n</details>\n\n",
      "user": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32729#issuecomment-3096072785",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/32729"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 18736001025,
      "node_id": "HRFPE_lADOABII5866_H3nzwAAAARcwLAB",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/18736001025",
      "actor": {
        "login": "l0rinc",
        "id": 1841944,
        "node_id": "MDQ6VXNlcjE4NDE5NDQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1841944?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/l0rinc",
        "html_url": "https://github.com/l0rinc",
        "followers_url": "https://api.github.com/users/l0rinc/followers",
        "following_url": "https://api.github.com/users/l0rinc/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/l0rinc/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/l0rinc/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/l0rinc/subscriptions",
        "organizations_url": "https://api.github.com/users/l0rinc/orgs",
        "repos_url": "https://api.github.com/users/l0rinc/repos",
        "events_url": "https://api.github.com/users/l0rinc/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/l0rinc/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": "5d29ce5c441656a3116d7151e78cd800ace6288e",
      "commit_url": "https://api.github.com/repos/l0rinc/bitcoin/commits/5d29ce5c441656a3116d7151e78cd800ace6288e",
      "created_at": "2025-07-21T19:57:44Z"
    },
    {
      "event": "commented",
      "id": 3098376004,
      "node_id": "IC_kwDOABII5864rXdE",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/3098376004",
      "actor": {
        "login": "l0rinc",
        "id": 1841944,
        "node_id": "MDQ6VXNlcjE4NDE5NDQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1841944?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/l0rinc",
        "html_url": "https://github.com/l0rinc",
        "followers_url": "https://api.github.com/users/l0rinc/followers",
        "following_url": "https://api.github.com/users/l0rinc/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/l0rinc/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/l0rinc/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/l0rinc/subscriptions",
        "organizations_url": "https://api.github.com/users/l0rinc/orgs",
        "repos_url": "https://api.github.com/users/l0rinc/repos",
        "events_url": "https://api.github.com/users/l0rinc/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/l0rinc/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-07-21T19:58:48Z",
      "updated_at": "2025-07-21T19:58:48Z",
      "author_association": "CONTRIBUTOR",
      "body": "Rebased after https://github.com/bitcoin/bitcoin/pull/32521/files#diff-ea6d307faa4ec9dfa5abcf6858bc19603079f2b8e110e1d62da4df98f4bdb9c0R184",
      "user": {
        "login": "l0rinc",
        "id": 1841944,
        "node_id": "MDQ6VXNlcjE4NDE5NDQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1841944?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/l0rinc",
        "html_url": "https://github.com/l0rinc",
        "followers_url": "https://api.github.com/users/l0rinc/followers",
        "following_url": "https://api.github.com/users/l0rinc/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/l0rinc/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/l0rinc/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/l0rinc/subscriptions",
        "organizations_url": "https://api.github.com/users/l0rinc/orgs",
        "repos_url": "https://api.github.com/users/l0rinc/repos",
        "events_url": "https://api.github.com/users/l0rinc/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/l0rinc/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32729#issuecomment-3098376004",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/32729"
    },
    {
      "event": "unlabeled",
      "id": 18739438037,
      "node_id": "UNLE_lADOABII5866_H3nzwAAAARc9SHV",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/18739438037",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-07-22T00:17:02Z",
      "label": {
        "name": "CI failed",
        "color": "cccccc"
      }
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDBhYmJhZDJkZTQxM2IyODk0YTEwYTRkYWQ3NzNmM2NmMGE1NjI1MTg",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/0abbad2de413b2894a10a4dad773f3cf0a562518",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/0abbad2de413b2894a10a4dad773f3cf0a562518",
      "tree": {
        "sha": "94af1547fbcb7dc10702bd8d382132998f83190d",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/94af1547fbcb7dc10702bd8d382132998f83190d"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/321984705dbcc5982013c8cfb52389cf3f2e75f6",
          "sha": "321984705dbcc5982013c8cfb52389cf3f2e75f6",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/321984705dbcc5982013c8cfb52389cf3f2e75f6"
        }
      ],
      "message": "bench: measure `CheckBlock` speed separately from serialization\n\nTo measure CheckBlock performance in isolation from deserialization overhead, a ResetChecked() method was introduced to re-enable the block's validation state, allowing repeated validation of the same block instance.",
      "committer": {
        "name": "Lőrinc",
        "email": "pap.lorinc@gmail.com",
        "date": "2025-07-28T20:27:23Z"
      },
      "author": {
        "name": "Lőrinc",
        "email": "pap.lorinc@gmail.com",
        "date": "2025-01-18T10:43:26Z"
      },
      "sha": "0abbad2de413b2894a10a4dad773f3cf0a562518"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDM3ZjcyMzQwZjk1YzQ1ZTcxODU5NGI3NWMyMzFhNjk0ZjQyZWFkNDA",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/37f72340f95c45e718594b75c231a694f42ead40",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/37f72340f95c45e718594b75c231a694f42ead40",
      "tree": {
        "sha": "216bd5adc55965fc49db07a4b8c4a8f849a0ac54",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/216bd5adc55965fc49db07a4b8c4a8f849a0ac54"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/0abbad2de413b2894a10a4dad773f3cf0a562518",
          "sha": "0abbad2de413b2894a10a4dad773f3cf0a562518",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/0abbad2de413b2894a10a4dad773f3cf0a562518"
        }
      ],
      "message": "bench: measure `SigOpsBlock` speed separately\n\nAdd benchmark to measure the performance of counting legacy signature operations in a block, independent of other validation steps.",
      "committer": {
        "name": "Lőrinc",
        "email": "pap.lorinc@gmail.com",
        "date": "2025-07-28T20:27:23Z"
      },
      "author": {
        "name": "Lőrinc",
        "email": "pap.lorinc@gmail.com",
        "date": "2025-01-18T10:43:26Z"
      },
      "sha": "37f72340f95c45e718594b75c231a694f42ead40"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 18864273057,
      "node_id": "HRFPE_lADOABII5866_H3nzwAAAARkZfah",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/18864273057",
      "actor": {
        "login": "l0rinc",
        "id": 1841944,
        "node_id": "MDQ6VXNlcjE4NDE5NDQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1841944?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/l0rinc",
        "html_url": "https://github.com/l0rinc",
        "followers_url": "https://api.github.com/users/l0rinc/followers",
        "following_url": "https://api.github.com/users/l0rinc/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/l0rinc/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/l0rinc/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/l0rinc/subscriptions",
        "organizations_url": "https://api.github.com/users/l0rinc/orgs",
        "repos_url": "https://api.github.com/users/l0rinc/repos",
        "events_url": "https://api.github.com/users/l0rinc/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/l0rinc/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": "6bf4c8d48f61089254532b065d9ca8e1c2bf6868",
      "commit_url": "https://api.github.com/repos/l0rinc/bitcoin/commits/6bf4c8d48f61089254532b065d9ca8e1c2bf6868",
      "created_at": "2025-07-28T20:40:17Z"
    },
    {
      "event": "commented",
      "id": 3129749041,
      "node_id": "IC_kwDOABII5866jC4x",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/3129749041",
      "actor": {
        "login": "l0rinc",
        "id": 1841944,
        "node_id": "MDQ6VXNlcjE4NDE5NDQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1841944?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/l0rinc",
        "html_url": "https://github.com/l0rinc",
        "followers_url": "https://api.github.com/users/l0rinc/followers",
        "following_url": "https://api.github.com/users/l0rinc/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/l0rinc/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/l0rinc/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/l0rinc/subscriptions",
        "organizations_url": "https://api.github.com/users/l0rinc/orgs",
        "repos_url": "https://api.github.com/users/l0rinc/repos",
        "events_url": "https://api.github.com/users/l0rinc/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/l0rinc/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-07-28T20:42:00Z",
      "updated_at": "2025-07-28T20:42:00Z",
      "author_association": "CONTRIBUTOR",
      "body": "Rebased after https://github.com/bitcoin/bitcoin/pull/32279 - updating the tests with the new convenience template helpers instead of using `Solver` for them. Ready for review again.",
      "user": {
        "login": "l0rinc",
        "id": 1841944,
        "node_id": "MDQ6VXNlcjE4NDE5NDQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1841944?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/l0rinc",
        "html_url": "https://github.com/l0rinc",
        "followers_url": "https://api.github.com/users/l0rinc/followers",
        "following_url": "https://api.github.com/users/l0rinc/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/l0rinc/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/l0rinc/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/l0rinc/subscriptions",
        "organizations_url": "https://api.github.com/users/l0rinc/orgs",
        "repos_url": "https://api.github.com/users/l0rinc/repos",
        "events_url": "https://api.github.com/users/l0rinc/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/l0rinc/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32729#issuecomment-3129749041",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/32729"
    },
    {
      "event": "reviewed",
      "id": 3086147229,
      "node_id": "PRR_kwDOABII58638t6d",
      "url": null,
      "actor": null,
      "commit_id": "06cb252c8285746737e3385886da2efd1ab41f5a",
      "commit_url": null,
      "created_at": null,
      "author_association": "CONTRIBUTOR",
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32729#pullrequestreview-3086147229",
      "submitted_at": "2025-08-05T00:22:14Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/32729"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDRjYmQzMDNkZGQ3YWU1MDA2ODNhN2E1OTVmMzhjNWI4ZmYyZGUzMWU",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/4cbd303ddd7ae500683a7a595f38c5b8ff2de31e",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/4cbd303ddd7ae500683a7a595f38c5b8ff2de31e",
      "tree": {
        "sha": "cc50fd305413e6f22752256857660b9a6988699f",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/cc50fd305413e6f22752256857660b9a6988699f"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/37f72340f95c45e718594b75c231a694f42ead40",
          "sha": "37f72340f95c45e718594b75c231a694f42ead40",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/37f72340f95c45e718594b75c231a694f42ead40"
        }
      ],
      "message": "refactor: rename `GetSigOpCount` to `CountSigOps`\n\nAlso added primitive argument name reminder to the call sites to highlight the meaning of the call.",
      "committer": {
        "name": "Lőrinc",
        "email": "pap.lorinc@gmail.com",
        "date": "2025-08-05T01:51:47Z"
      },
      "author": {
        "name": "Lőrinc",
        "email": "pap.lorinc@gmail.com",
        "date": "2025-05-14T14:05:05Z"
      },
      "sha": "4cbd303ddd7ae500683a7a595f38c5b8ff2de31e"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 18981662008,
      "node_id": "HRFPE_lADOABII5866_H3nzwAAAARrZS04",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/18981662008",
      "actor": {
        "login": "l0rinc",
        "id": 1841944,
        "node_id": "MDQ6VXNlcjE4NDE5NDQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1841944?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/l0rinc",
        "html_url": "https://github.com/l0rinc",
        "followers_url": "https://api.github.com/users/l0rinc/followers",
        "following_url": "https://api.github.com/users/l0rinc/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/l0rinc/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/l0rinc/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/l0rinc/subscriptions",
        "organizations_url": "https://api.github.com/users/l0rinc/orgs",
        "repos_url": "https://api.github.com/users/l0rinc/repos",
        "events_url": "https://api.github.com/users/l0rinc/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/l0rinc/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": "1d49b3b3bd93b246dd70e26145735653a4baf45e",
      "commit_url": "https://api.github.com/repos/l0rinc/bitcoin/commits/1d49b3b3bd93b246dd70e26145735653a4baf45e",
      "created_at": "2025-08-05T02:21:58Z"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDVmZDUyZjlmYTZhODM1MTQyOTdhYjlhNWVhYjk5NjZjYjdlOGQwYTU",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/5fd52f9fa6a83514297ab9a5eab9966cb7e8d0a5",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/5fd52f9fa6a83514297ab9a5eab9966cb7e8d0a5",
      "tree": {
        "sha": "56494c6758c0c9a2ca3a62ae19014d2d57a1b826",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/56494c6758c0c9a2ca3a62ae19014d2d57a1b826"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/4cbd303ddd7ae500683a7a595f38c5b8ff2de31e",
          "sha": "4cbd303ddd7ae500683a7a595f38c5b8ff2de31e",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/4cbd303ddd7ae500683a7a595f38c5b8ff2de31e"
        }
      ],
      "message": "refactor: split off `P2SH` from `GetSigOpCount`\n\nCo-authored-by: Ryan Ofsky <ryan@ofsky.org>",
      "committer": {
        "name": "Lőrinc",
        "email": "pap.lorinc@gmail.com",
        "date": "2025-08-05T02:23:45Z"
      },
      "author": {
        "name": "Lőrinc",
        "email": "pap.lorinc@gmail.com",
        "date": "2025-08-05T01:34:22Z"
      },
      "sha": "5fd52f9fa6a83514297ab9a5eab9966cb7e8d0a5"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKGFkMTNmMTFmNWQxYTFiM2IyMzVjMGJjMGI2NWQyMjlkNzg1MTU5ZTQ",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/ad13f11f5d1a1b3b235c0bc0b65d229d785159e4",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/ad13f11f5d1a1b3b235c0bc0b65d229d785159e4",
      "tree": {
        "sha": "ee30fc3969ba4cb94a53e4d4bed7242cca136aff",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/ee30fc3969ba4cb94a53e4d4bed7242cca136aff"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/5fd52f9fa6a83514297ab9a5eab9966cb7e8d0a5",
          "sha": "5fd52f9fa6a83514297ab9a5eab9966cb7e8d0a5",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/5fd52f9fa6a83514297ab9a5eab9966cb7e8d0a5"
        }
      ],
      "message": "refactor: move the script-hash-size constants to `script.h`\n\nThis enables using these constants in script.h definitions in upcoming commits. No naming conflicts exist with these constant names.",
      "committer": {
        "name": "Lőrinc",
        "email": "pap.lorinc@gmail.com",
        "date": "2025-08-05T02:23:45Z"
      },
      "author": {
        "name": "Lőrinc",
        "email": "pap.lorinc@gmail.com",
        "date": "2025-06-04T19:15:17Z"
      },
      "sha": "ad13f11f5d1a1b3b235c0bc0b65d229d785159e4"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDAwYWNiMTExOGQyZjdjYjMzNDQzZDhlODY0YjUyN2U0NDI3NWY5NjA",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/00acb1118d2f7cb33443d8e864b527e44275f960",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/00acb1118d2f7cb33443d8e864b527e44275f960",
      "tree": {
        "sha": "b8c4d125aa6b6b4feada5d7866095332dd47fe5e",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/b8c4d125aa6b6b4feada5d7866095332dd47fe5e"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/ad13f11f5d1a1b3b235c0bc0b65d229d785159e4",
          "sha": "ad13f11f5d1a1b3b235c0bc0b65d229d785159e4",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/ad13f11f5d1a1b3b235c0bc0b65d229d785159e4"
        }
      ],
      "message": "refactor: pull `IsPayToScriptHash` to header\n\nMoved the implementation to the header (implicitly inline + noexcept), removed redundant `this` and parentheses, used descriptive `front()`/`back()` methods and changed the `0x14` magic constant to descriptive `WITNESS_V0_KEYHASH_SIZE`.\nSee: https://learnmeabitcoin.com/technical/script/p2sh/#scriptpubkey",
      "committer": {
        "name": "Lőrinc",
        "email": "pap.lorinc@gmail.com",
        "date": "2025-08-05T02:23:45Z"
      },
      "author": {
        "name": "Lőrinc",
        "email": "pap.lorinc@gmail.com",
        "date": "2025-06-04T19:25:30Z"
      },
      "sha": "00acb1118d2f7cb33443d8e864b527e44275f960"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDIxYzJjNmViMmMyZWJmZWQ2M2E4YjE2OTc4ZmJmODhmMDMwZjQwYzU",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/21c2c6eb2c2ebfed63a8b16978fbf88f030f40c5",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/21c2c6eb2c2ebfed63a8b16978fbf88f030f40c5",
      "tree": {
        "sha": "88fdace7f34a86f26c769e7f34093de3351e36e4",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/88fdace7f34a86f26c769e7f34093de3351e36e4"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/00acb1118d2f7cb33443d8e864b527e44275f960",
          "sha": "00acb1118d2f7cb33443d8e864b527e44275f960",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/00acb1118d2f7cb33443d8e864b527e44275f960"
        }
      ],
      "message": "refactor: pull `IsPayToWitnessScriptHash` to header\n\nMoved the implementation to the header (implicitly inline + noexcept), removed redundant `this` and parentheses, used descriptive `front()` method and changed the `0x20` magic constant to descriptive `WITNESS_V0_SCRIPTHASH_SIZE`.\nSee: https://learnmeabitcoin.com/technical/script/p2wsh/#scriptpubkey",
      "committer": {
        "name": "Lőrinc",
        "email": "pap.lorinc@gmail.com",
        "date": "2025-08-05T02:23:45Z"
      },
      "author": {
        "name": "Lőrinc",
        "email": "pap.lorinc@gmail.com",
        "date": "2025-06-04T19:26:16Z"
      },
      "sha": "21c2c6eb2c2ebfed63a8b16978fbf88f030f40c5"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDYwYjIwM2MxODVhOTljYTk4MGRlNGQ2N2E1NTgxYWM4ZjJlYTg2MDE",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/60b203c185a99ca980de4d67a5581ac8f2ea8601",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/60b203c185a99ca980de4d67a5581ac8f2ea8601",
      "tree": {
        "sha": "d9d50a0ba4b051ff8ca1e90213da2ac253df95f4",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/d9d50a0ba4b051ff8ca1e90213da2ac253df95f4"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/21c2c6eb2c2ebfed63a8b16978fbf88f030f40c5",
          "sha": "21c2c6eb2c2ebfed63a8b16978fbf88f030f40c5",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/21c2c6eb2c2ebfed63a8b16978fbf88f030f40c5"
        }
      ],
      "message": "refactor: pull `IsPayToAnchor` to header\n\nMoved the implementation to the header (implicitly inline + noexcept), removed redundant `this` and parentheses, used descriptive `front()`/`back()` methods.",
      "committer": {
        "name": "Lőrinc",
        "email": "pap.lorinc@gmail.com",
        "date": "2025-08-05T02:23:45Z"
      },
      "author": {
        "name": "Lőrinc",
        "email": "pap.lorinc@gmail.com",
        "date": "2025-06-04T19:30:35Z"
      },
      "sha": "60b203c185a99ca980de4d67a5581ac8f2ea8601"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDg2MGFhOTAwOGEyZGRkZTAzYWEyMDNlNWE5ZTVkZmUwZjYwYjRjNGM",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/860aa9008a2ddde03aa203e5a9e5dfe0f60b4c4c",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/860aa9008a2ddde03aa203e5a9e5dfe0f60b4c4c",
      "tree": {
        "sha": "08bd08a28563234162236618460aac01ecb8c914",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/08bd08a28563234162236618460aac01ecb8c914"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/60b203c185a99ca980de4d67a5581ac8f2ea8601",
          "sha": "60b203c185a99ca980de4d67a5581ac8f2ea8601",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/60b203c185a99ca980de4d67a5581ac8f2ea8601"
        }
      ],
      "message": "refactor: pull `IsPayToTaproot` to header\n\nMoved the implementation to the header (implicitly inline + noexcept), removed redundant `this` and parentheses, used descriptive `front()` method and changed the `0x20` magic constant to descriptive `WITNESS_V1_TAPROOT_SIZE`.\nSee: https://learnmeabitcoin.com/technical/script/p2tr/#scriptpubkey",
      "committer": {
        "name": "Lőrinc",
        "email": "pap.lorinc@gmail.com",
        "date": "2025-08-05T02:23:45Z"
      },
      "author": {
        "name": "Lőrinc",
        "email": "pap.lorinc@gmail.com",
        "date": "2025-06-04T19:31:25Z"
      },
      "sha": "860aa9008a2ddde03aa203e5a9e5dfe0f60b4c4c"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDQ4ZjZlODE0ODAxZWUyZDZmMGU5NWEzYTQ3MmE0YTA2NzJkMTlmNTc",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/48f6e814801ee2d6f0e95a3a472a4a0672d19f57",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/48f6e814801ee2d6f0e95a3a472a4a0672d19f57",
      "tree": {
        "sha": "59d7a992a60fc1591b1b213f4a0b066a3440fbfe",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/59d7a992a60fc1591b1b213f4a0b066a3440fbfe"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/860aa9008a2ddde03aa203e5a9e5dfe0f60b4c4c",
          "sha": "860aa9008a2ddde03aa203e5a9e5dfe0f60b4c4c",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/860aa9008a2ddde03aa203e5a9e5dfe0f60b4c4c"
        }
      ],
      "message": "refactor: add `IsPayToPubKeyHash` helper to script.h\n\nThe usages in `compressor.cpp` and `solver.cpp` were also updated to use the new method.\nSee: https://learnmeabitcoin.com/technical/script/p2pkh/#scriptpubkey",
      "committer": {
        "name": "Lőrinc",
        "email": "pap.lorinc@gmail.com",
        "date": "2025-08-05T02:23:45Z"
      },
      "author": {
        "name": "Lőrinc",
        "email": "pap.lorinc@gmail.com",
        "date": "2025-06-04T19:16:19Z"
      },
      "sha": "48f6e814801ee2d6f0e95a3a472a4a0672d19f57"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDQ2MjgzOTNkMjA3OTVmZDM4MWU2MjVmNTQ2NTg4NzZjZDQ2ZDIyMjM",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/4628393d20795fd381e625f54658876cd46d2223",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/4628393d20795fd381e625f54658876cd46d2223",
      "tree": {
        "sha": "8deb8309bf2d600e31e0c1744416afecb4ca7a2e",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/8deb8309bf2d600e31e0c1744416afecb4ca7a2e"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/48f6e814801ee2d6f0e95a3a472a4a0672d19f57",
          "sha": "48f6e814801ee2d6f0e95a3a472a4a0672d19f57",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/48f6e814801ee2d6f0e95a3a472a4a0672d19f57"
        }
      ],
      "message": "refactor: add `IsCompressedPayToPubKey` helper to script.h\n\nThe usages in `compressor.cpp` and `solver.cpp` were also updated to use the new method.\nNote that compressor has additional prefix checks as well, which are not properly exercised by the `compressed_p2pk` unit test.\nSee: https://learnmeabitcoin.com/technical/script/p2pk/#scriptpubkey and https://learnmeabitcoin.com/technical/keys/public-key/#compressed",
      "committer": {
        "name": "Lőrinc",
        "email": "pap.lorinc@gmail.com",
        "date": "2025-08-05T02:23:45Z"
      },
      "author": {
        "name": "Lőrinc",
        "email": "pap.lorinc@gmail.com",
        "date": "2025-06-04T19:19:53Z"
      },
      "sha": "4628393d20795fd381e625f54658876cd46d2223"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKGUzNDU2NzczMmMyMzVlZWIwN2RkN2U3NjJlMTkyNDhiZTk3OTE5OTI",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/e34567732c235eeb07dd7e762e19248be9791992",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/e34567732c235eeb07dd7e762e19248be9791992",
      "tree": {
        "sha": "b7b1ead0fea4d93e7b46f51add9af32f9d3ccbe6",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/b7b1ead0fea4d93e7b46f51add9af32f9d3ccbe6"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/4628393d20795fd381e625f54658876cd46d2223",
          "sha": "4628393d20795fd381e625f54658876cd46d2223",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/4628393d20795fd381e625f54658876cd46d2223"
        }
      ],
      "message": "refactor: add `IsUncompressedPayToPubKey` helper to script.h\n\nThe usages in `compressor.cpp` and `solver.cpp` were also updated to use the new method.\nNote that compressor has additional prefix checks as well, which are not properly exercised by the `uncompressed_p2pk` unit test.\nSee: https://learnmeabitcoin.com/technical/script/p2pk/#scriptpubkey and https://learnmeabitcoin.com/technical/keys/public-key/#uncompressed",
      "committer": {
        "name": "Lőrinc",
        "email": "pap.lorinc@gmail.com",
        "date": "2025-08-05T02:23:45Z"
      },
      "author": {
        "name": "Lőrinc",
        "email": "pap.lorinc@gmail.com",
        "date": "2025-06-04T19:20:02Z"
      },
      "sha": "e34567732c235eeb07dd7e762e19248be9791992"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKGNmZGUzY2U4YTZkOWVlZThmYzMyYTkxMzk0YjVlMTU5NGJjODAxNTA",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/cfde3ce8a6d9eee8fc32a91394b5e1594bc80150",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/cfde3ce8a6d9eee8fc32a91394b5e1594bc80150",
      "tree": {
        "sha": "6cba2b6d87cf194e8558014777eafad5a8f3a412",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/6cba2b6d87cf194e8558014777eafad5a8f3a412"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/e34567732c235eeb07dd7e762e19248be9791992",
          "sha": "e34567732c235eeb07dd7e762e19248be9791992",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/e34567732c235eeb07dd7e762e19248be9791992"
        }
      ],
      "message": "refactor: add `IsPayToWitnessPubKeyHash` helper to script.h\n\nSee: https://learnmeabitcoin.com/technical/script/p2wpkh/#scriptpubkey",
      "committer": {
        "name": "Lőrinc",
        "email": "pap.lorinc@gmail.com",
        "date": "2025-08-05T02:23:45Z"
      },
      "author": {
        "name": "Lőrinc",
        "email": "pap.lorinc@gmail.com",
        "date": "2025-06-04T19:21:43Z"
      },
      "sha": "cfde3ce8a6d9eee8fc32a91394b5e1594bc80150"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDE0Nzg1YzdiZTkyMDJhZmFjYzY3NjQxZmU5Njc0ZWUyODg1N2M4YTk",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/14785c7be9202afacc67641fe9674ee28857c8a9",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/14785c7be9202afacc67641fe9674ee28857c8a9",
      "tree": {
        "sha": "f56b1e82acdc5403437d3d120aeb9312a322848f",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/f56b1e82acdc5403437d3d120aeb9312a322848f"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/cfde3ce8a6d9eee8fc32a91394b5e1594bc80150",
          "sha": "cfde3ce8a6d9eee8fc32a91394b5e1594bc80150",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/cfde3ce8a6d9eee8fc32a91394b5e1594bc80150"
        }
      ],
      "message": "test: add `CountSigOps` edge-cases & known-template coverage\n\n* `CountSigOpsErrors` feeds malformed PUSHDATA sequences to confirm the parser never crashes and still counts sig-ops that appear before the error.\n* `CountSigOpsKnownTemplates` asserts the expected legacy/accurate sig-op totals for all common known script templates (P2PKH, P2SH, P2WPKH/WSH, P2TR, compressed & uncompressed P2PK, OP_RETURN, multisig).",
      "committer": {
        "name": "Lőrinc",
        "email": "pap.lorinc@gmail.com",
        "date": "2025-08-05T02:23:45Z"
      },
      "author": {
        "name": "Lőrinc",
        "email": "pap.lorinc@gmail.com",
        "date": "2025-05-14T14:41:02Z"
      },
      "sha": "14785c7be9202afacc67641fe9674ee28857c8a9"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKGRiNGJmODRjODdiYzI3ZjEwYzBjYTM5MzQ2OWVjMTNlNjFiNjRmZDE",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/db4bf84c87bc27f10c0ca393469ec13e61b64fd1",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/db4bf84c87bc27f10c0ca393469ec13e61b64fd1",
      "tree": {
        "sha": "c20977037f751325db8af924105a35683cdbaf84",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/c20977037f751325db8af924105a35683cdbaf84"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/14785c7be9202afacc67641fe9674ee28857c8a9",
          "sha": "14785c7be9202afacc67641fe9674ee28857c8a9",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/14785c7be9202afacc67641fe9674ee28857c8a9"
        }
      ],
      "message": "test: make sure OP_CHECKSIGADD isn't considered valid (legacy) sigop\n\nOP_CHECKSIGADD (opcode 0xba) is a Tapscript-only opcode introduced with Taproot and should not be counted as a signature operation in legacy (pre-Tapscript) contexts. It being larger than the \"max\" is confusing, hence the rename.",
      "committer": {
        "name": "Lőrinc",
        "email": "pap.lorinc@gmail.com",
        "date": "2025-08-05T02:23:45Z"
      },
      "author": {
        "name": "Lőrinc",
        "email": "pap.lorinc@gmail.com",
        "date": "2025-06-07T13:00:27Z"
      },
      "sha": "db4bf84c87bc27f10c0ca393469ec13e61b64fd1"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 18981691594,
      "node_id": "HRFPE_lADOABII5866_H3nzwAAAARrZaDK",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/18981691594",
      "actor": {
        "login": "l0rinc",
        "id": 1841944,
        "node_id": "MDQ6VXNlcjE4NDE5NDQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1841944?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/l0rinc",
        "html_url": "https://github.com/l0rinc",
        "followers_url": "https://api.github.com/users/l0rinc/followers",
        "following_url": "https://api.github.com/users/l0rinc/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/l0rinc/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/l0rinc/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/l0rinc/subscriptions",
        "organizations_url": "https://api.github.com/users/l0rinc/orgs",
        "repos_url": "https://api.github.com/users/l0rinc/repos",
        "events_url": "https://api.github.com/users/l0rinc/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/l0rinc/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": "db4bf84c87bc27f10c0ca393469ec13e61b64fd1",
      "commit_url": "https://api.github.com/repos/l0rinc/bitcoin/commits/db4bf84c87bc27f10c0ca393469ec13e61b64fd1",
      "created_at": "2025-08-05T02:25:20Z"
    },
    {
      "event": "labeled",
      "id": 18981814355,
      "node_id": "LE_lADOABII5866_H3nzwAAAARrZ4BT",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/18981814355",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-08-05T02:39:16Z",
      "label": {
        "name": "CI failed",
        "color": "cccccc"
      }
    },
    {
      "event": "commented",
      "id": 3153073760,
      "node_id": "IC_kwDOABII58678BZg",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/3153073760",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-08-05T02:39:18Z",
      "updated_at": "2025-08-05T02:39:18Z",
      "author_association": "CONTRIBUTOR",
      "body": "<!--85328a0da195eb286784d51f73fa0af9-->\n🚧 At least one of the CI tasks failed.\n<sub>Task `MSan, depends`: https://github.com/bitcoin/bitcoin/runs/47383324322</sub>\n<sub>LLM reason (✨ experimental): The CI failure is caused by a compilation error in script_ops.cpp: 'GetSigOpCount' is missing in 'CScript'.</sub>\n\n<details><summary>Hints</summary>\n\nTry to run the tests locally, according to the documentation. However, a CI failure may still\nhappen due to a number of reasons, for example:\n\n* Possibly due to a silent merge conflict (the changes in this pull request being\nincompatible with the current code in the target branch). If so, make sure to rebase on the latest\ncommit of the target branch.\n\n* A sanitizer issue, which can only be found by compiling with the sanitizer and running the\n  affected test.\n\n* An intermittent issue.\n\nLeave a comment here, if you need help tracking down a confusing failure.\n\n</details>\n\n",
      "user": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32729#issuecomment-3153073760",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/32729"
    }
  ],
  "comments": [
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2252835441",
      "pull_request_review_id": 3086147229,
      "id": 2252835441,
      "node_id": "PRRC_kwDOABII586GR4px",
      "diff_hunk": "@@ -534,7 +534,7 @@ class CScript : public CScriptBase\n      * counted more accurately, assuming they are of the form\n      *  ... OP_N CHECKMULTISIG ...\n      */\n-    unsigned int GetSigOpCount(bool fAccurate) const;\n+    unsigned int GetLegacySigOpCount(bool fAccurate) const;",
      "path": "src/script/script.h",
      "position": null,
      "original_position": 5,
      "commit_id": "db4bf84c87bc27f10c0ca393469ec13e61b64fd1",
      "original_commit_id": "06cb252c8285746737e3385886da2efd1ab41f5a",
      "in_reply_to_id": null,
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "In commit \"refactor: rename `GetSigOpCount` to `GetLegacySigOpCount`\" (06cb252c8285746737e3385886da2efd1ab41f5a)\r\n\r\nI like getting rid of this overload, but I found the code here very confusing before this change, and I think renaming this to `GetLegacySigOpCount` makes the confusion worse because this method is not acting like a legacy function when it's called with fAccurate = true. At first I though you might have been using legacy here to mean \"pre-segwit\" which is different than the way the `GetLegacySigOpCount(CTransaction)` uses legacy to mean \"pre-p2sh\". But after noticing this is also called by the segwit `WitnessSigOps` function, I don't see how the term \"legacy\" even applies here at all.\r\n\r\nI think I would suggest renaming this to `CountSigOps` to be consistent with the `CountWitnessSigOps` function, and giving it better documentation. I also think the other overload should be a standalone function not a CScript method because it is not really using the CScript.\r\n\r\nI think a change like the one below could be a lot clearer:\r\n\r\n<details><summary>diff</summary>\r\n<p>\r\n\r\n```diff\r\n--- a/src/consensus/tx_verify.cpp\r\n+++ b/src/consensus/tx_verify.cpp\r\n@@ -113,10 +113,10 @@ unsigned int GetLegacySigOpCount(const CTransaction& tx)\r\n {\r\n     unsigned int nSigOps = 0;\r\n     for (const auto& txin : tx.vin) {\r\n-        nSigOps += txin.scriptSig.GetLegacySigOpCount(/*fAccurate=*/false);\r\n+        nSigOps += txin.scriptSig.CountSigOps(/*fAccurate=*/false);\r\n     }\r\n     for (const auto& txout : tx.vout) {\r\n-        nSigOps += txout.scriptPubKey.GetLegacySigOpCount(/*fAccurate=*/false);\r\n+        nSigOps += txout.scriptPubKey.CountSigOps(/*fAccurate=*/false);\r\n     }\r\n     return nSigOps;\r\n }\r\n@@ -133,7 +133,7 @@ unsigned int GetP2SHSigOpCount(const CTransaction& tx, const CCoinsViewCache& in\r\n         assert(!coin.IsSpent());\r\n         const CTxOut &prevout = coin.out;\r\n         if (prevout.scriptPubKey.IsPayToScriptHash())\r\n-            nSigOps += prevout.scriptPubKey.GetSigOpCount(tx.vin[i].scriptSig);\r\n+            nSigOps += CountP2SHSigOps(tx.vin[i].scriptSig);\r\n     }\r\n     return nSigOps;\r\n }\r\n--- a/src/policy/policy.cpp\r\n+++ b/src/policy/policy.cpp\r\n@@ -181,8 +181,11 @@ static bool CheckSigopsBIP54(const CTransaction& tx, const CCoinsViewCache& inpu\r\n         // `fAccurate` means correctly accounting sigops for CHECKMULTISIGs(VERIFY) with 16 pubkeys\r\n         // or fewer. This method of accounting was introduced by BIP16, and BIP54 reuses it.\r\n         // The GetSigOpCount call on the previous scriptPubKey counts both bare and P2SH sigops.\r\n-        sigops += txin.scriptSig.GetLegacySigOpCount(/*fAccurate=*/true);\r\n-        sigops += prev_txo.scriptPubKey.GetSigOpCount(txin.scriptSig);\r\n+        sigops += txin.scriptSig.CountSigOps(/*fAccurate=*/true);\r\n+        sigops += prev_txo.scriptPubKey.CountSigOps(/*fAccurate=*/true);\r\n+        if (prev_txo.scriptPubKey.IsPayToScriptHash()) {\r\n+           sigops += CountP2SHSigOps(txin.scriptSig);\r\n+        }\r\n \r\n         if (sigops > MAX_TX_LEGACY_SIGOPS) {\r\n             return false;\r\n@@ -239,7 +242,7 @@ bool AreInputsStandard(const CTransaction& tx, const CCoinsViewCache& mapInputs)\r\n             if (stack.empty())\r\n                 return false;\r\n             CScript subscript(stack.back().begin(), stack.back().end());\r\n-            if (subscript.GetLegacySigOpCount(/*fAccurate=*/true) > MAX_P2SH_SIGOPS) {\r\n+            if (subscript.CountSigOps(/*fAccurate=*/true) > MAX_P2SH_SIGOPS) {\r\n                 return false;\r\n             }\r\n         }\r\n--- a/src/script/interpreter.cpp\r\n+++ b/src/script/interpreter.cpp\r\n@@ -2084,7 +2084,7 @@ size_t static WitnessSigOps(int witversion, const std::vector<unsigned char>& wi\r\n \r\n         if (witprogram.size() == WITNESS_V0_SCRIPTHASH_SIZE && witness.stack.size() > 0) {\r\n             CScript subscript(witness.stack.back().begin(), witness.stack.back().end());\r\n-            return subscript.GetLegacySigOpCount(/*fAccurate=*/true);\r\n+            return subscript.CountSigOps(/*fAccurate=*/true);\r\n         }\r\n     }\r\n \r\n--- a/src/script/script.cpp\r\n+++ b/src/script/script.cpp\r\n@@ -156,7 +156,7 @@ std::string GetOpName(opcodetype opcode)\r\n     }\r\n }\r\n \r\n-unsigned int CScript::GetLegacySigOpCount(bool fAccurate) const\r\n+unsigned int CScript::CountSigOps(bool fAccurate) const\r\n {\r\n     unsigned int n = 0;\r\n     const_iterator pc = begin();\r\n@@ -180,15 +180,12 @@ unsigned int CScript::GetLegacySigOpCount(bool fAccurate) const\r\n     return n;\r\n }\r\n \r\n-unsigned int CScript::GetSigOpCount(const CScript& scriptSig) const\r\n+unsigned int CountP2SHSigOps(const CScript& scriptSig)\r\n {\r\n-    if (!IsPayToScriptHash())\r\n-        return GetLegacySigOpCount(/*fAccurate=*/true);\r\n-\r\n     // This is a pay-to-script-hash scriptPubKey;\r\n     // get the last item that the scriptSig\r\n     // pushes onto the stack:\r\n-    const_iterator pc = scriptSig.begin();\r\n+    CScript::const_iterator pc = scriptSig.begin();\r\n     std::vector<unsigned char> vData;\r\n     while (pc < scriptSig.end())\r\n     {\r\n@@ -201,7 +198,7 @@ unsigned int CScript::GetSigOpCount(const CScript& scriptSig) const\r\n \r\n     /// ... and return its opcount:\r\n     CScript subscript(vData.begin(), vData.end());\r\n-    return subscript.GetLegacySigOpCount(/*fAccurate=*/true);\r\n+    return subscript.CountSigOps(/*fAccurate=*/true);\r\n }\r\n \r\n bool CScript::IsPayToAnchor() const\r\n--- a/src/script/script.h\r\n+++ b/src/script/script.h\r\n@@ -528,19 +528,20 @@ public:\r\n     }\r\n \r\n     /**\r\n-     * Pre-version-0.6, Bitcoin always counted CHECKMULTISIGs\r\n-     * as 20 sigops. With pay-to-script-hash, that changed:\r\n-     * CHECKMULTISIGs serialized in scriptSigs are\r\n-     * counted more accurately, assuming they are of the form\r\n-     *  ... OP_N CHECKMULTISIG ...\r\n-     */\r\n-    unsigned int GetLegacySigOpCount(bool fAccurate) const;\r\n-\r\n-    /**\r\n-     * Accurately count sigOps, including sigOps in\r\n-     * pay-to-script-hash transactions:\r\n-     */\r\n-    unsigned int GetSigOpCount(const CScript& scriptSig) const;\r\n+    * Count the number of signature operations (sigops) in this script.\r\n+    *\r\n+    * The fAccurate parameter controls how sigops are counted for CHECKMULTISIG\r\n+    * operations. Set fAccurate = true when analyzing P2SH redeem scripts or\r\n+    * SegWit witness scripts, and false when analyzing scriptPubKeys or\r\n+    * scriptSigs.\r\n+    *\r\n+    * Historically, Bitcoin always counted each CHECKMULTISIG as 20 sigops\r\n+    * (MAX_PUBKEYS_PER_MULTISIG), regardless of the number of pubkeys. Starting\r\n+    * with P2SH in version 0.6, CHECKMULTISIG operations inside wrapped scripts\r\n+    * began to be counted more precisely, using the preceding OP_N opcode to\r\n+    * determine the number of pubkeys and thus the number of sigops.\r\n+    */\r\n+    unsigned int CountSigOps(bool fAccurate) const;\r\n \r\n     /*\r\n      * OP_1 <0x4e73>\r\n@@ -606,6 +607,15 @@ public:\r\n     explicit CScriptID(const uint160& in) : BaseHash(in) {}\r\n };\r\n \r\n+/**\r\n+ * Count the number of signature operations (sigops) in a P2SH scriptSig.\r\n+ *\r\n+ * If the scriptSig contains a SegWit redeem script (i.e., a P2SH-P2WPKH or\r\n+ * P2SH-P2WSH script), this function counts only the non-SegWit sigops.\r\n+ * To count SegWit sigops in such cases, use CountWitnessSigOps.\r\n+ */\r\n+unsigned int CountP2SHSigOps(const CScript& scriptSig);unsigned int CountP2SHSigOps(const CScript& scriptSig);\r\n+\r\n /** Test for OP_SUCCESSx opcodes as defined by BIP342. */\r\n bool IsOpSuccess(const opcodetype& opcode);\r\n \r\n```\r\n</p>\r\n</details>",
      "created_at": "2025-08-05T00:22:13Z",
      "updated_at": "2025-08-05T00:22:14Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32729#discussion_r2252835441",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2252835441"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/32729"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 537,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2252952435",
      "pull_request_review_id": 3086297101,
      "id": 2252952435,
      "node_id": "PRRC_kwDOABII586GSVNz",
      "diff_hunk": "@@ -534,7 +534,7 @@ class CScript : public CScriptBase\n      * counted more accurately, assuming they are of the form\n      *  ... OP_N CHECKMULTISIG ...\n      */\n-    unsigned int GetSigOpCount(bool fAccurate) const;\n+    unsigned int GetLegacySigOpCount(bool fAccurate) const;",
      "path": "src/script/script.h",
      "position": null,
      "original_position": 5,
      "commit_id": "db4bf84c87bc27f10c0ca393469ec13e61b64fd1",
      "original_commit_id": "06cb252c8285746737e3385886da2efd1ab41f5a",
      "in_reply_to_id": 2252835441,
      "user": {
        "login": "l0rinc",
        "id": 1841944,
        "node_id": "MDQ6VXNlcjE4NDE5NDQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1841944?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/l0rinc",
        "html_url": "https://github.com/l0rinc",
        "followers_url": "https://api.github.com/users/l0rinc/followers",
        "following_url": "https://api.github.com/users/l0rinc/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/l0rinc/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/l0rinc/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/l0rinc/subscriptions",
        "organizations_url": "https://api.github.com/users/l0rinc/orgs",
        "repos_url": "https://api.github.com/users/l0rinc/repos",
        "events_url": "https://api.github.com/users/l0rinc/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/l0rinc/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "Thanks, love the inlining of `GetSigOpCount` (bothered me, too - it's a lot clearer this way), and the new `CountSigOps` name as well.\r\nAdded your comments (+ you as co-author, of course) and adjusted all the tests, now that `CountSigOps` is separated from `CountP2SHSigOps`: https://github.com/bitcoin/bitcoin/compare/6bf4c8d48f61089254532b065d9ca8e1c2bf6868..db4bf84c87bc27f10c0ca393469ec13e61b64fd1\r\n\r\nnote, instead of\r\n```patch\r\n-        sigops += prev_txo.scriptPubKey.GetSigOpCount(txin.scriptSig);\r\n+        sigops += prev_txo.scriptPubKey.CountSigOps(/*fAccurate=*/true);\r\n+        if (prev_txo.scriptPubKey.IsPayToScriptHash()) {\r\n+           sigops += CountP2SHSigOps(txin.scriptSig);\r\n+        }\r\n```\r\nI did:\r\n```patch\r\n-        sigops += prev_txo.scriptPubKey.GetSigOpCount(txin.scriptSig);\r\n+        sigops += prev_txo.scriptPubKey.IsPayToScriptHash() ?\r\n+                      CountP2SHSigOps(txin.scriptSig) :\r\n+                      prev_txo.scriptPubKey.CountSigOps(/*fAccurate=*/true);\r\n```\r\n\r\nsince I don't think `CountSigOps` should always be applied (even if always `0`)",
      "created_at": "2025-08-05T02:22:54Z",
      "updated_at": "2025-08-05T02:30:38Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/32729#discussion_r2252952435",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2252952435"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/32729"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 537,
      "side": "RIGHT"
    }
  ]
}
{
  "type": "pull",
  "pull": {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29770",
    "id": 1799118469,
    "node_id": "PR_kwDOABII585rPF6F",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/29770",
    "diff_url": "https://github.com/bitcoin/bitcoin/pull/29770.diff",
    "patch_url": "https://github.com/bitcoin/bitcoin/pull/29770.patch",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29770",
    "commits_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29770/commits",
    "review_comments_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29770/comments",
    "review_comment_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments%7B/number%7D",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29770/comments",
    "statuses_url": "https://api.github.com/repos/bitcoin/bitcoin/statuses/1f1d9f2904ee166bd82905611ded51ed9de7b28a",
    "number": 29770,
    "state": "open",
    "locked": false,
    "maintainer_can_modify": true,
    "title": "index: Check all necessary block data is available before starting to sync",
    "user": {
      "login": "fjahr",
      "id": 1322187,
      "node_id": "MDQ6VXNlcjEzMjIxODc=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/fjahr",
      "html_url": "https://github.com/fjahr",
      "followers_url": "https://api.github.com/users/fjahr/followers",
      "following_url": "https://api.github.com/users/fjahr/following%7B/other_user%7D",
      "gists_url": "https://api.github.com/users/fjahr/gists%7B/gist_id%7D",
      "starred_url": "https://api.github.com/users/fjahr/starred%7B/owner%7D%7B/repo%7D",
      "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
      "organizations_url": "https://api.github.com/users/fjahr/orgs",
      "repos_url": "https://api.github.com/users/fjahr/repos",
      "events_url": "https://api.github.com/users/fjahr/events%7B/privacy%7D",
      "received_events_url": "https://api.github.com/users/fjahr/received_events",
      "type": "User",
      "site_admin": false,
      "patch_url": null
    },
    "body": "Currently, we check that `BLOCK_HAVE_DATA` is available for all blocks an index needs to sync during startup. However, for `coinstatsindex` and `blockfilterindex` we also need the undo data for these blocks. If that data is missing in the blocks, we are currently still starting to sync each of these indices and then crash later when we encounter the missing data.\r\n\r\nThis PR adds explicit knowledge of which block data is needed for each index and then checks its availability during startup before initializing the sync process on them.\r\n\r\nThis also addresses a few open comments from #29668 in the last commit.",
    "labels": [
      {
        "id": 97470796,
        "node_id": "MDU6TGFiZWw5NzQ3MDc5Ng==",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/UTXO%20Db%20and%20Indexes",
        "name": "UTXO Db and Indexes",
        "color": "fbca04",
        "default": false
      }
    ],
    "created_at": "2024-03-30T22:55:19Z",
    "updated_at": "2025-06-17T20:47:41Z",
    "mergeable": true,
    "mergeable_state": "blocked",
    "merged": false,
    "merge_commit_sha": "941bc53bc3d87c418c9c5702b02cf8f3ea1fe153",
    "assignees": [],
    "requested_reviewers": [],
    "requested_teams": [],
    "rebaseable": true,
    "head": {
      "label": "fjahr:2024-03-check-undo-index",
      "ref": "2024-03-check-undo-index",
      "sha": "1f1d9f2904ee166bd82905611ded51ed9de7b28a",
      "user": {
        "login": "fjahr",
        "id": 1322187,
        "node_id": "MDQ6VXNlcjEzMjIxODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fjahr",
        "html_url": "https://github.com/fjahr",
        "followers_url": "https://api.github.com/users/fjahr/followers",
        "following_url": "https://api.github.com/users/fjahr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fjahr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fjahr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
        "organizations_url": "https://api.github.com/users/fjahr/orgs",
        "repos_url": "https://api.github.com/users/fjahr/repos",
        "events_url": "https://api.github.com/users/fjahr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fjahr/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "repo": {
        "id": 196253948,
        "node_id": "MDEwOlJlcG9zaXRvcnkxOTYyNTM5NDg=",
        "name": "bitcoin",
        "full_name": "fjahr/bitcoin",
        "owner": {
          "login": "fjahr",
          "id": 1322187,
          "node_id": "MDQ6VXNlcjEzMjIxODc=",
          "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
          "gravatar_id": "",
          "url": "https://api.github.com/users/fjahr",
          "html_url": "https://github.com/fjahr",
          "followers_url": "https://api.github.com/users/fjahr/followers",
          "following_url": "https://api.github.com/users/fjahr/following%7B/other_user%7D",
          "gists_url": "https://api.github.com/users/fjahr/gists%7B/gist_id%7D",
          "starred_url": "https://api.github.com/users/fjahr/starred%7B/owner%7D%7B/repo%7D",
          "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
          "organizations_url": "https://api.github.com/users/fjahr/orgs",
          "repos_url": "https://api.github.com/users/fjahr/repos",
          "events_url": "https://api.github.com/users/fjahr/events%7B/privacy%7D",
          "received_events_url": "https://api.github.com/users/fjahr/received_events",
          "type": "User",
          "site_admin": false,
          "patch_url": null
        },
        "private": false,
        "html_url": "https://github.com/fjahr/bitcoin",
        "description": "Bitcoin Core integration/staging tree",
        "fork": true,
        "url": "https://api.github.com/repos/fjahr/bitcoin",
        "archive_url": "https://api.github.com/repos/fjahr/bitcoin/%7Barchive_format%7D%7B/ref%7D",
        "assignees_url": "https://api.github.com/repos/fjahr/bitcoin/assignees%7B/user%7D",
        "blobs_url": "https://api.github.com/repos/fjahr/bitcoin/git/blobs%7B/sha%7D",
        "branches_url": "https://api.github.com/repos/fjahr/bitcoin/branches%7B/branch%7D",
        "collaborators_url": "https://api.github.com/repos/fjahr/bitcoin/collaborators%7B/collaborator%7D",
        "comments_url": "https://api.github.com/repos/fjahr/bitcoin/comments%7B/number%7D",
        "commits_url": "https://api.github.com/repos/fjahr/bitcoin/commits%7B/sha%7D",
        "compare_url": "https://api.github.com/repos/fjahr/bitcoin/compare/%7Bbase%7D...%7Bhead%7D",
        "contents_url": "https://api.github.com/repos/fjahr/bitcoin/contents/%7B+path%7D",
        "contributors_url": "https://api.github.com/repos/fjahr/bitcoin/contributors",
        "deployments_url": "https://api.github.com/repos/fjahr/bitcoin/deployments",
        "downloads_url": "https://api.github.com/repos/fjahr/bitcoin/downloads",
        "events_url": "https://api.github.com/repos/fjahr/bitcoin/events",
        "forks_url": "https://api.github.com/repos/fjahr/bitcoin/forks",
        "git_commits_url": "https://api.github.com/repos/fjahr/bitcoin/git/commits%7B/sha%7D",
        "git_refs_url": "https://api.github.com/repos/fjahr/bitcoin/git/refs%7B/sha%7D",
        "git_tags_url": "https://api.github.com/repos/fjahr/bitcoin/git/tags%7B/sha%7D",
        "git_url": "git://github.com/fjahr/bitcoin.git",
        "issue_comment_url": "https://api.github.com/repos/fjahr/bitcoin/issues/comments%7B/number%7D",
        "issue_events_url": "https://api.github.com/repos/fjahr/bitcoin/issues/events%7B/number%7D",
        "issues_url": "https://api.github.com/repos/fjahr/bitcoin/issues%7B/number%7D",
        "keys_url": "https://api.github.com/repos/fjahr/bitcoin/keys%7B/key_id%7D",
        "labels_url": "https://api.github.com/repos/fjahr/bitcoin/labels%7B/name%7D",
        "languages_url": "https://api.github.com/repos/fjahr/bitcoin/languages",
        "merges_url": "https://api.github.com/repos/fjahr/bitcoin/merges",
        "milestones_url": "https://api.github.com/repos/fjahr/bitcoin/milestones%7B/number%7D",
        "notifications_url": "https://api.github.com/repos/fjahr/bitcoin/notifications%7B?since,all,participating}",
        "pulls_url": "https://api.github.com/repos/fjahr/bitcoin/pulls%7B/number%7D",
        "releases_url": "https://api.github.com/repos/fjahr/bitcoin/releases%7B/id%7D",
        "ssh_url": "git@github.com:fjahr/bitcoin.git",
        "stargazers_url": "https://api.github.com/repos/fjahr/bitcoin/stargazers",
        "statuses_url": "https://api.github.com/repos/fjahr/bitcoin/statuses/%7Bsha%7D",
        "subscribers_url": "https://api.github.com/repos/fjahr/bitcoin/subscribers",
        "subscription_url": "https://api.github.com/repos/fjahr/bitcoin/subscription",
        "tags_url": "https://api.github.com/repos/fjahr/bitcoin/tags",
        "teams_url": "https://api.github.com/repos/fjahr/bitcoin/teams",
        "trees_url": "https://api.github.com/repos/fjahr/bitcoin/git/trees%7B/sha%7D",
        "clone_url": "https://github.com/fjahr/bitcoin.git",
        "hooks_url": "https://api.github.com/repos/fjahr/bitcoin/hooks",
        "svn_url": "https://github.com/fjahr/bitcoin",
        "homepage": "https://bitcoincore.org/en/download",
        "language": "C++",
        "forks_count": 1,
        "stargazers_count": 4,
        "watchers_count": 4,
        "size": 268659,
        "default_branch": "master",
        "open_issues_count": 0,
        "is_template": false,
        "topics": [],
        "has_issues": false,
        "has_projects": true,
        "has_wiki": false,
        "has_pages": false,
        "has_downloads": false,
        "archived": false,
        "disabled": false,
        "visibility": "public",
        "pushed_at": "2025-06-17T20:47:34Z",
        "created_at": "2019-07-10T18:11:06Z",
        "updated_at": "2024-07-23T22:14:45Z",
        "allow_forking": true,
        "license": {
          "key": "mit",
          "name": "MIT License",
          "node_id": "MDc6TGljZW5zZTEz",
          "spdx_id": "MIT",
          "url": "https://api.github.com/licenses/mit",
          "html_url": null,
          "description": null,
          "implementation": null,
          "permissions": null,
          "conditions": null,
          "limitations": null,
          "body": null,
          "featured": null
        }
      }
    },
    "base": {
      "label": "bitcoin:master",
      "ref": "master",
      "sha": "5e6dbfd14ea9eace1c7e5ee76b140be46a0ec855",
      "user": {
        "login": "bitcoin",
        "id": 528860,
        "node_id": "MDEyOk9yZ2FuaXphdGlvbjUyODg2MA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/528860?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/bitcoin",
        "html_url": "https://github.com/bitcoin",
        "followers_url": "https://api.github.com/users/bitcoin/followers",
        "following_url": "https://api.github.com/users/bitcoin/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/bitcoin/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/bitcoin/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/bitcoin/subscriptions",
        "organizations_url": "https://api.github.com/users/bitcoin/orgs",
        "repos_url": "https://api.github.com/users/bitcoin/repos",
        "events_url": "https://api.github.com/users/bitcoin/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/bitcoin/received_events",
        "type": "Organization",
        "site_admin": false,
        "patch_url": null
      },
      "repo": {
        "id": 1181927,
        "node_id": "MDEwOlJlcG9zaXRvcnkxMTgxOTI3",
        "name": "bitcoin",
        "full_name": "bitcoin/bitcoin",
        "owner": {
          "login": "bitcoin",
          "id": 528860,
          "node_id": "MDEyOk9yZ2FuaXphdGlvbjUyODg2MA==",
          "avatar_url": "https://avatars.githubusercontent.com/u/528860?v=4",
          "gravatar_id": "",
          "url": "https://api.github.com/users/bitcoin",
          "html_url": "https://github.com/bitcoin",
          "followers_url": "https://api.github.com/users/bitcoin/followers",
          "following_url": "https://api.github.com/users/bitcoin/following%7B/other_user%7D",
          "gists_url": "https://api.github.com/users/bitcoin/gists%7B/gist_id%7D",
          "starred_url": "https://api.github.com/users/bitcoin/starred%7B/owner%7D%7B/repo%7D",
          "subscriptions_url": "https://api.github.com/users/bitcoin/subscriptions",
          "organizations_url": "https://api.github.com/users/bitcoin/orgs",
          "repos_url": "https://api.github.com/users/bitcoin/repos",
          "events_url": "https://api.github.com/users/bitcoin/events%7B/privacy%7D",
          "received_events_url": "https://api.github.com/users/bitcoin/received_events",
          "type": "Organization",
          "site_admin": false,
          "patch_url": null
        },
        "private": false,
        "html_url": "https://github.com/bitcoin/bitcoin",
        "description": "Bitcoin Core integration/staging tree",
        "fork": false,
        "url": "https://api.github.com/repos/bitcoin/bitcoin",
        "archive_url": "https://api.github.com/repos/bitcoin/bitcoin/%7Barchive_format%7D%7B/ref%7D",
        "assignees_url": "https://api.github.com/repos/bitcoin/bitcoin/assignees%7B/user%7D",
        "blobs_url": "https://api.github.com/repos/bitcoin/bitcoin/git/blobs%7B/sha%7D",
        "branches_url": "https://api.github.com/repos/bitcoin/bitcoin/branches%7B/branch%7D",
        "collaborators_url": "https://api.github.com/repos/bitcoin/bitcoin/collaborators%7B/collaborator%7D",
        "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/comments%7B/number%7D",
        "commits_url": "https://api.github.com/repos/bitcoin/bitcoin/commits%7B/sha%7D",
        "compare_url": "https://api.github.com/repos/bitcoin/bitcoin/compare/%7Bbase%7D...%7Bhead%7D",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/%7B+path%7D",
        "contributors_url": "https://api.github.com/repos/bitcoin/bitcoin/contributors",
        "deployments_url": "https://api.github.com/repos/bitcoin/bitcoin/deployments",
        "downloads_url": "https://api.github.com/repos/bitcoin/bitcoin/downloads",
        "events_url": "https://api.github.com/repos/bitcoin/bitcoin/events",
        "forks_url": "https://api.github.com/repos/bitcoin/bitcoin/forks",
        "git_commits_url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits%7B/sha%7D",
        "git_refs_url": "https://api.github.com/repos/bitcoin/bitcoin/git/refs%7B/sha%7D",
        "git_tags_url": "https://api.github.com/repos/bitcoin/bitcoin/git/tags%7B/sha%7D",
        "git_url": "git://github.com/bitcoin/bitcoin.git",
        "issue_comment_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments%7B/number%7D",
        "issue_events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events%7B/number%7D",
        "issues_url": "https://api.github.com/repos/bitcoin/bitcoin/issues%7B/number%7D",
        "keys_url": "https://api.github.com/repos/bitcoin/bitcoin/keys%7B/key_id%7D",
        "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/labels%7B/name%7D",
        "languages_url": "https://api.github.com/repos/bitcoin/bitcoin/languages",
        "merges_url": "https://api.github.com/repos/bitcoin/bitcoin/merges",
        "milestones_url": "https://api.github.com/repos/bitcoin/bitcoin/milestones%7B/number%7D",
        "notifications_url": "https://api.github.com/repos/bitcoin/bitcoin/notifications%7B?since,all,participating}",
        "pulls_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls%7B/number%7D",
        "releases_url": "https://api.github.com/repos/bitcoin/bitcoin/releases%7B/id%7D",
        "ssh_url": "git@github.com:bitcoin/bitcoin.git",
        "stargazers_url": "https://api.github.com/repos/bitcoin/bitcoin/stargazers",
        "statuses_url": "https://api.github.com/repos/bitcoin/bitcoin/statuses/%7Bsha%7D",
        "subscribers_url": "https://api.github.com/repos/bitcoin/bitcoin/subscribers",
        "subscription_url": "https://api.github.com/repos/bitcoin/bitcoin/subscription",
        "tags_url": "https://api.github.com/repos/bitcoin/bitcoin/tags",
        "teams_url": "https://api.github.com/repos/bitcoin/bitcoin/teams",
        "trees_url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees%7B/sha%7D",
        "clone_url": "https://github.com/bitcoin/bitcoin.git",
        "hooks_url": "https://api.github.com/repos/bitcoin/bitcoin/hooks",
        "svn_url": "https://github.com/bitcoin/bitcoin",
        "homepage": "https://bitcoincore.org/en/download",
        "language": "C++",
        "forks_count": 37387,
        "stargazers_count": 84201,
        "watchers_count": 84201,
        "size": 284244,
        "default_branch": "master",
        "open_issues_count": 752,
        "is_template": false,
        "topics": [
          "bitcoin",
          "c-plus-plus",
          "cryptocurrency",
          "cryptography",
          "p2p"
        ],
        "has_issues": true,
        "has_projects": true,
        "has_wiki": false,
        "has_pages": false,
        "has_downloads": false,
        "archived": false,
        "disabled": false,
        "visibility": "public",
        "pushed_at": "2025-06-17T18:12:50Z",
        "created_at": "2010-12-19T15:16:43Z",
        "updated_at": "2025-06-17T20:50:47Z",
        "allow_forking": true,
        "license": {
          "key": "mit",
          "name": "MIT License",
          "node_id": "MDc6TGljZW5zZTEz",
          "spdx_id": "MIT",
          "url": "https://api.github.com/licenses/mit",
          "html_url": null,
          "description": null,
          "implementation": null,
          "permissions": null,
          "conditions": null,
          "limitations": null,
          "body": null,
          "featured": null
        }
      }
    },
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29770"
      }
    },
    "author_association": "CONTRIBUTOR",
    "draft": false,
    "additions": 152,
    "deletions": 53,
    "changed_files": 12,
    "commits": 4,
    "review_comments": 31,
    "comments": 14
  },
  "events": [
    {
      "event": "commented",
      "id": 2028488817,
      "node_id": "IC_kwDOABII58546Ehx",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2028488817",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-03-30T22:55:22Z",
      "updated_at": "2025-06-16T13:46:02Z",
      "author_association": "CONTRIBUTOR",
      "body": "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--006a51241073e994b41acfe9ec718e94-->\n### Code Coverage & Benchmarks\nFor details see: https://corecheck.dev/bitcoin/bitcoin/pulls/29770.\n<!--021abf342d371248e50ceaed478a90ca-->\n### Reviews\nSee [the guideline](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#code-review) for information on the review process.\n| Type | Reviewers |\n| ---- | --------- |\n| Concept ACK | [stickies-v](https://github.com/bitcoin/bitcoin/pull/29770#pullrequestreview-1971036349) |\n| Approach ACK | [TheCharlatan](https://github.com/bitcoin/bitcoin/pull/29770#pullrequestreview-2888284022) |\n\nIf your review is incorrectly listed, please react with 👎 to this comment and the bot will ignore it on the next update.\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* [#26966](https://github.com/bitcoin/bitcoin/pull/26966) (index: initial sync speedup, parallelize process by furszy)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.\n<!--5faf32d7da4f0f540f40219e4f7537a3-->",
      "user": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29770#issuecomment-2028488817",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29770"
    },
    {
      "event": "labeled",
      "id": 12301902910,
      "node_id": "LE_lADOABII586EIAoKzwAAAALdQCQ-",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/12301902910",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-03-30T22:55:24Z",
      "label": {
        "name": "UTXO Db and Indexes",
        "color": "fbca04"
      }
    },
    {
      "event": "commented",
      "id": 2028492440,
      "node_id": "IC_kwDOABII58546FaY",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2028492440",
      "actor": {
        "login": "TheCharlatan",
        "id": 8421793,
        "node_id": "MDQ6VXNlcjg0MjE3OTM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8421793?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/TheCharlatan",
        "html_url": "https://github.com/TheCharlatan",
        "followers_url": "https://api.github.com/users/TheCharlatan/followers",
        "following_url": "https://api.github.com/users/TheCharlatan/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/TheCharlatan/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/TheCharlatan/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/TheCharlatan/subscriptions",
        "organizations_url": "https://api.github.com/users/TheCharlatan/orgs",
        "repos_url": "https://api.github.com/users/TheCharlatan/repos",
        "events_url": "https://api.github.com/users/TheCharlatan/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/TheCharlatan/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-03-30T23:16:53Z",
      "updated_at": "2024-03-30T23:16:53Z",
      "author_association": "CONTRIBUTOR",
      "body": "Concept ACK",
      "user": {
        "login": "TheCharlatan",
        "id": 8421793,
        "node_id": "MDQ6VXNlcjg0MjE3OTM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8421793?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/TheCharlatan",
        "html_url": "https://github.com/TheCharlatan",
        "followers_url": "https://api.github.com/users/TheCharlatan/followers",
        "following_url": "https://api.github.com/users/TheCharlatan/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/TheCharlatan/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/TheCharlatan/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/TheCharlatan/subscriptions",
        "organizations_url": "https://api.github.com/users/TheCharlatan/orgs",
        "repos_url": "https://api.github.com/users/TheCharlatan/repos",
        "events_url": "https://api.github.com/users/TheCharlatan/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/TheCharlatan/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29770#issuecomment-2028492440",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29770"
    },
    {
      "event": "labeled",
      "id": 12302042682,
      "node_id": "LE_lADOABII586EIAoKzwAAAALdQkY6",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/12302042682",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-03-31T00:35:20Z",
      "label": {
        "name": "CI failed",
        "color": "cccccc"
      }
    },
    {
      "event": "reviewed",
      "id": 1971036349,
      "node_id": "PRR_kwDOABII5851e6C9",
      "url": null,
      "actor": null,
      "commit_id": "809fffdd6efe2525113597691e92751e2fd8678c",
      "commit_url": null,
      "created_at": null,
      "author_association": "CONTRIBUTOR",
      "body": "Concept ACK",
      "user": {
        "login": "stickies-v",
        "id": 69010457,
        "node_id": "MDQ6VXNlcjY5MDEwNDU3",
        "avatar_url": "https://avatars.githubusercontent.com/u/69010457?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stickies-v",
        "html_url": "https://github.com/stickies-v",
        "followers_url": "https://api.github.com/users/stickies-v/followers",
        "following_url": "https://api.github.com/users/stickies-v/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stickies-v/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stickies-v/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stickies-v/subscriptions",
        "organizations_url": "https://api.github.com/users/stickies-v/orgs",
        "repos_url": "https://api.github.com/users/stickies-v/repos",
        "events_url": "https://api.github.com/users/stickies-v/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stickies-v/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29770#pullrequestreview-1971036349",
      "submitted_at": "2024-04-01T11:23:21Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29770"
    },
    {
      "event": "commented",
      "id": 2081534985,
      "node_id": "IC_kwDOABII5858EbQJ",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2081534985",
      "actor": {
        "login": "fjahr",
        "id": 1322187,
        "node_id": "MDQ6VXNlcjEzMjIxODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fjahr",
        "html_url": "https://github.com/fjahr",
        "followers_url": "https://api.github.com/users/fjahr/followers",
        "following_url": "https://api.github.com/users/fjahr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fjahr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fjahr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
        "organizations_url": "https://api.github.com/users/fjahr/orgs",
        "repos_url": "https://api.github.com/users/fjahr/repos",
        "events_url": "https://api.github.com/users/fjahr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fjahr/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-04-28T16:05:39Z",
      "updated_at": "2024-04-28T16:05:39Z",
      "author_association": "CONTRIBUTOR",
      "body": "@stickies-v Thanks for the feedback, I will leave this unaddressed for now until #29668 has been merged. Then I will get back to it when I take this out of draft mode.",
      "user": {
        "login": "fjahr",
        "id": 1322187,
        "node_id": "MDQ6VXNlcjEzMjIxODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fjahr",
        "html_url": "https://github.com/fjahr",
        "followers_url": "https://api.github.com/users/fjahr/followers",
        "following_url": "https://api.github.com/users/fjahr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fjahr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fjahr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
        "organizations_url": "https://api.github.com/users/fjahr/orgs",
        "repos_url": "https://api.github.com/users/fjahr/repos",
        "events_url": "https://api.github.com/users/fjahr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fjahr/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29770#issuecomment-2081534985",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29770"
    },
    {
      "event": "mentioned",
      "id": 12635205714,
      "node_id": "MEE_lADOABII586EIAoKzwAAAALxHfBS",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/12635205714",
      "actor": {
        "login": "stickies-v",
        "id": 69010457,
        "node_id": "MDQ6VXNlcjY5MDEwNDU3",
        "avatar_url": "https://avatars.githubusercontent.com/u/69010457?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stickies-v",
        "html_url": "https://github.com/stickies-v",
        "followers_url": "https://api.github.com/users/stickies-v/followers",
        "following_url": "https://api.github.com/users/stickies-v/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stickies-v/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stickies-v/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stickies-v/subscriptions",
        "organizations_url": "https://api.github.com/users/stickies-v/orgs",
        "repos_url": "https://api.github.com/users/stickies-v/repos",
        "events_url": "https://api.github.com/users/stickies-v/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stickies-v/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-04-28T16:05:40Z"
    },
    {
      "event": "subscribed",
      "id": 12635205719,
      "node_id": "SE_lADOABII586EIAoKzwAAAALxHfBX",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/12635205719",
      "actor": {
        "login": "stickies-v",
        "id": 69010457,
        "node_id": "MDQ6VXNlcjY5MDEwNDU3",
        "avatar_url": "https://avatars.githubusercontent.com/u/69010457?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stickies-v",
        "html_url": "https://github.com/stickies-v",
        "followers_url": "https://api.github.com/users/stickies-v/followers",
        "following_url": "https://api.github.com/users/stickies-v/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stickies-v/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stickies-v/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stickies-v/subscriptions",
        "organizations_url": "https://api.github.com/users/stickies-v/orgs",
        "repos_url": "https://api.github.com/users/stickies-v/repos",
        "events_url": "https://api.github.com/users/stickies-v/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stickies-v/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-04-28T16:05:40Z"
    },
    {
      "event": "labeled",
      "id": 13462921402,
      "node_id": "LE_lADOABII586EIAoKzwAAAAMic-C6",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/13462921402",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-07-10T21:35:59Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "head_ref_force_pushed",
      "id": 13489352556,
      "node_id": "HRFPE_lADOABII586EIAoKzwAAAAMkBy9s",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/13489352556",
      "actor": {
        "login": "fjahr",
        "id": 1322187,
        "node_id": "MDQ6VXNlcjEzMjIxODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fjahr",
        "html_url": "https://github.com/fjahr",
        "followers_url": "https://api.github.com/users/fjahr/followers",
        "following_url": "https://api.github.com/users/fjahr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fjahr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fjahr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
        "organizations_url": "https://api.github.com/users/fjahr/orgs",
        "repos_url": "https://api.github.com/users/fjahr/repos",
        "events_url": "https://api.github.com/users/fjahr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fjahr/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": "34fdeface441dde673abdfc16fef9b384dc65930",
      "commit_url": "https://api.github.com/repos/fjahr/bitcoin/commits/34fdeface441dde673abdfc16fef9b384dc65930",
      "created_at": "2024-07-12T16:01:34Z"
    },
    {
      "event": "ready_for_review",
      "id": 13489358877,
      "node_id": "RFRE_lADOABII586EIAoKzwAAAAMkB0gd",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/13489358877",
      "actor": {
        "login": "fjahr",
        "id": 1322187,
        "node_id": "MDQ6VXNlcjEzMjIxODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fjahr",
        "html_url": "https://github.com/fjahr",
        "followers_url": "https://api.github.com/users/fjahr/followers",
        "following_url": "https://api.github.com/users/fjahr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fjahr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fjahr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
        "organizations_url": "https://api.github.com/users/fjahr/orgs",
        "repos_url": "https://api.github.com/users/fjahr/repos",
        "events_url": "https://api.github.com/users/fjahr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fjahr/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-07-12T16:02:13Z"
    },
    {
      "event": "unlabeled",
      "id": 13490591627,
      "node_id": "UNLE_lADOABII586EIAoKzwAAAAMkGheL",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/13490591627",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-07-12T17:48:28Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "head_ref_force_pushed",
      "id": 13492960279,
      "node_id": "HRFPE_lADOABII586EIAoKzwAAAAMkPjwX",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/13492960279",
      "actor": {
        "login": "fjahr",
        "id": 1322187,
        "node_id": "MDQ6VXNlcjEzMjIxODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fjahr",
        "html_url": "https://github.com/fjahr",
        "followers_url": "https://api.github.com/users/fjahr/followers",
        "following_url": "https://api.github.com/users/fjahr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fjahr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fjahr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
        "organizations_url": "https://api.github.com/users/fjahr/orgs",
        "repos_url": "https://api.github.com/users/fjahr/repos",
        "events_url": "https://api.github.com/users/fjahr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fjahr/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": "245c09bc8571d6079a8a8f1c4db993be04214157",
      "commit_url": "https://api.github.com/repos/fjahr/bitcoin/commits/245c09bc8571d6079a8a8f1c4db993be04214157",
      "created_at": "2024-07-12T22:53:52Z"
    },
    {
      "event": "unlabeled",
      "id": 13493342591,
      "node_id": "UNLE_lADOABII586EIAoKzwAAAAMkRBF_",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/13493342591",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-07-13T00:10:16Z",
      "label": {
        "name": "CI failed",
        "color": "cccccc"
      }
    },
    {
      "event": "commented",
      "id": 2226993556,
      "node_id": "IC_kwDOABII586EvTmU",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2226993556",
      "actor": {
        "login": "fjahr",
        "id": 1322187,
        "node_id": "MDQ6VXNlcjEzMjIxODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fjahr",
        "html_url": "https://github.com/fjahr",
        "followers_url": "https://api.github.com/users/fjahr/followers",
        "following_url": "https://api.github.com/users/fjahr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fjahr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fjahr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
        "organizations_url": "https://api.github.com/users/fjahr/orgs",
        "repos_url": "https://api.github.com/users/fjahr/repos",
        "events_url": "https://api.github.com/users/fjahr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fjahr/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-07-13T16:46:48Z",
      "updated_at": "2024-07-13T16:46:48Z",
      "author_association": "CONTRIBUTOR",
      "body": "Rebased with updates that resulted from the changes in https://github.com/bitcoin/bitcoin/pull/29668 before merge plus an additional commit that addresses left-over comments in https://github.com/bitcoin/bitcoin/pull/29668.",
      "user": {
        "login": "fjahr",
        "id": 1322187,
        "node_id": "MDQ6VXNlcjEzMjIxODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fjahr",
        "html_url": "https://github.com/fjahr",
        "followers_url": "https://api.github.com/users/fjahr/followers",
        "following_url": "https://api.github.com/users/fjahr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fjahr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fjahr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
        "organizations_url": "https://api.github.com/users/fjahr/orgs",
        "repos_url": "https://api.github.com/users/fjahr/repos",
        "events_url": "https://api.github.com/users/fjahr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fjahr/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29770#issuecomment-2226993556",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29770"
    },
    {
      "event": "reviewed",
      "id": 2177093632,
      "node_id": "PRR_kwDOABII586Bw9AA",
      "url": null,
      "actor": null,
      "commit_id": "245c09bc8571d6079a8a8f1c4db993be04214157",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "body": "",
      "user": {
        "login": "maflcko",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/maflcko",
        "html_url": "https://github.com/maflcko",
        "followers_url": "https://api.github.com/users/maflcko/followers",
        "following_url": "https://api.github.com/users/maflcko/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/maflcko/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/maflcko/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/maflcko/subscriptions",
        "organizations_url": "https://api.github.com/users/maflcko/orgs",
        "repos_url": "https://api.github.com/users/maflcko/repos",
        "events_url": "https://api.github.com/users/maflcko/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/maflcko/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29770#pullrequestreview-2177093632",
      "submitted_at": "2024-07-15T08:09:09Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29770"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 13504022273,
      "node_id": "HRFPE_lADOABII586EIAoKzwAAAAMk5wcB",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/13504022273",
      "actor": {
        "login": "fjahr",
        "id": 1322187,
        "node_id": "MDQ6VXNlcjEzMjIxODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fjahr",
        "html_url": "https://github.com/fjahr",
        "followers_url": "https://api.github.com/users/fjahr/followers",
        "following_url": "https://api.github.com/users/fjahr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fjahr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fjahr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
        "organizations_url": "https://api.github.com/users/fjahr/orgs",
        "repos_url": "https://api.github.com/users/fjahr/repos",
        "events_url": "https://api.github.com/users/fjahr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fjahr/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": "0354df3608027ba7552e06befa73a7f1f9da8a49",
      "commit_url": "https://api.github.com/repos/fjahr/bitcoin/commits/0354df3608027ba7552e06befa73a7f1f9da8a49",
      "created_at": "2024-07-15T11:23:09Z"
    },
    {
      "event": "reviewed",
      "id": 2179012886,
      "node_id": "PRR_kwDOABII586B4RkW",
      "url": null,
      "actor": null,
      "commit_id": "0354df3608027ba7552e06befa73a7f1f9da8a49",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "body": "It would be nice to implement 81638f5d42b841 differently, without adding the `<chain.h>` dependency to all index headers. This dependency provides access to node internal types that indexes running on other processes (in the future) will not know about.\r\n\r\nIt seems we all implemented the same \"index X requires block data\" and \"index Y requires block undo data\" in slightly different ways. I did it in #26966 some time ago, and ryanofsky also did it in #24230.\r\n\r\nMy preference would be to follow #24230 and use the custom options class. It is more flexible than introducing a new method to override on all/most classes every time a new index customization is added.",
      "user": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29770#pullrequestreview-2179012886",
      "submitted_at": "2024-07-16T01:43:51Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29770"
    },
    {
      "event": "commented",
      "id": 2230388708,
      "node_id": "IC_kwDOABII586E8Qfk",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2230388708",
      "actor": {
        "login": "fjahr",
        "id": 1322187,
        "node_id": "MDQ6VXNlcjEzMjIxODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fjahr",
        "html_url": "https://github.com/fjahr",
        "followers_url": "https://api.github.com/users/fjahr/followers",
        "following_url": "https://api.github.com/users/fjahr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fjahr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fjahr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
        "organizations_url": "https://api.github.com/users/fjahr/orgs",
        "repos_url": "https://api.github.com/users/fjahr/repos",
        "events_url": "https://api.github.com/users/fjahr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fjahr/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-07-16T09:03:15Z",
      "updated_at": "2024-07-16T09:14:35Z",
      "author_association": "CONTRIBUTOR",
      "body": "> It would be nice to implement [81638f5](https://github.com/bitcoin/bitcoin/commit/81638f5d42b841fb327393974320ca47db39eb09) differently, without adding the `<chain.h>` dependency to all index headers. This dependency provides access to node internal types that indexes running on other processes (in the future) will not know about.\r\n\r\nShould not be too complicated to get rid of the dependency. I will draft something, maybe I'll just give @maflcko s [suggestion](https://github.com/bitcoin/bitcoin/pull/29770#discussion_r1677451285) a try.\r\n\r\n> It seems we all implemented the same \"index X requires block data\" and \"index Y requires block undo data\" in slightly different ways. I did it in #26966 some time ago, and ryanofsky also did it in #24230.\r\n> \r\n> My preference would be to follow #24230 and use the custom options class. It is more flexible than introducing a new method to override on all/most classes every time a new index customization is added.\r\n\r\nI'm wouldn't call having helper functions returning bools for each case more flexible than what we have here. At least this is what I saw in #24230 and I think you mean:\r\n\r\n```virtual bool RequiresBlockUndoData() const { return false; }```\r\n\r\nIt may be more readable in the short term but if we build more complicated stuff beyond just checking undo data I think this will be complicated. And we already use the mask everywhere so why not build on this? I like being able to grep for the blockstatus enum values too in order to see where block data is checked in various ways, that would be also lost.",
      "user": {
        "login": "fjahr",
        "id": 1322187,
        "node_id": "MDQ6VXNlcjEzMjIxODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fjahr",
        "html_url": "https://github.com/fjahr",
        "followers_url": "https://api.github.com/users/fjahr/followers",
        "following_url": "https://api.github.com/users/fjahr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fjahr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fjahr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
        "organizations_url": "https://api.github.com/users/fjahr/orgs",
        "repos_url": "https://api.github.com/users/fjahr/repos",
        "events_url": "https://api.github.com/users/fjahr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fjahr/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29770#issuecomment-2230388708",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29770"
    },
    {
      "event": "mentioned",
      "id": 13517583960,
      "node_id": "MEE_lADOABII586EIAoKzwAAAAMltfZY",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/13517583960",
      "actor": {
        "login": "maflcko",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/maflcko",
        "html_url": "https://github.com/maflcko",
        "followers_url": "https://api.github.com/users/maflcko/followers",
        "following_url": "https://api.github.com/users/maflcko/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/maflcko/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/maflcko/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/maflcko/subscriptions",
        "organizations_url": "https://api.github.com/users/maflcko/orgs",
        "repos_url": "https://api.github.com/users/maflcko/repos",
        "events_url": "https://api.github.com/users/maflcko/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/maflcko/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-07-16T09:03:17Z"
    },
    {
      "event": "subscribed",
      "id": 13517583985,
      "node_id": "SE_lADOABII586EIAoKzwAAAAMltfZx",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/13517583985",
      "actor": {
        "login": "maflcko",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/maflcko",
        "html_url": "https://github.com/maflcko",
        "followers_url": "https://api.github.com/users/maflcko/followers",
        "following_url": "https://api.github.com/users/maflcko/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/maflcko/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/maflcko/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/maflcko/subscriptions",
        "organizations_url": "https://api.github.com/users/maflcko/orgs",
        "repos_url": "https://api.github.com/users/maflcko/repos",
        "events_url": "https://api.github.com/users/maflcko/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/maflcko/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-07-16T09:03:17Z"
    },
    {
      "event": "reviewed",
      "id": 2180361000,
      "node_id": "PRR_kwDOABII586B9aso",
      "url": null,
      "actor": null,
      "commit_id": "0354df3608027ba7552e06befa73a7f1f9da8a49",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "body": "> > It would be nice to implement [81638f5](https://github.com/bitcoin/bitcoin/commit/81638f5d42b841fb327393974320ca47db39eb09) differently, without adding the `<chain.h>` dependency to all index headers. This dependency provides access to node internal types that indexes running on other processes (in the future) will not know about.\r\n> \r\n> Should not be too complicated to get rid of the dependency. I will draft something, maybe I'll just give @maflcko s [suggestion](https://github.com/bitcoin/bitcoin/pull/29770#discussion_r1677451285) a try.\r\n\r\nmaflcko's suggestion wouldn't remove the dependency. Unless you place the new enum somewhere else?. Which I don't think it worth it.\r\n\r\n> > It seems we all implemented the same \"index X requires block data\" and \"index Y requires block undo data\" in slightly different ways. I did it in #26966 some time ago, and ryanofsky also did it in #24230.\r\n> > My preference would be to follow #24230 and use the custom options class. It is more flexible than introducing a new method to override on all/most classes every time a new index customization is added.\r\n> \r\n> I'm wouldn't call having helper functions returning bools for each case more flexible than what we have here. At least this is what I saw in #24230 and I think you mean:\r\n> \r\n> `virtual bool RequiresBlockUndoData() const { return false; }`\r\n> \r\n> It may be more readable in the short term but if we build more complicated stuff beyond just checking undo data I think this will be complicated. And we already use the mask everywhere so why not build on this? I like being able to grep for the blockstatus enum values too in order to see where block data is checked in various ways, that would be also lost.\r\n\r\nIf we agree that the final goal of the indexes is to run in isolation, in a standalone process, and be the first consumers of the kernel library, then linking them to chain internal fields like the `CBlockIndex` status mask isn't the way to go. These objects will live only within the kernel process.\r\n\r\nAlso, I don't think the grepping argument is valid in most circumstances. It can be used anywhere to break layer distinctions. For example, what if the GUI needs to know if a certain block is available on disk in the future. Would you add the status masks enum dependency to a widget class? Doing so would break the current structure: views -> model/interfaces -> kernel (this is also done this way to allow the GUI to run in a standalone process as well).\r\n\r\nThe `RequiresBlockUndoData()` implementation is from my PR, and I'm not fan of it anymore (I don't dislike it, just prefer a different approach).\r\nI think #24230 approach is better as it introduces a new base class method to override called `CustomOptions()` that returns a struct containing index's specific information. I think that building upon this would be cleaner and more flexible, as we would only need to add fields to a struct instead of changing the base class interface with each new option.  - would probably change the struct name, which is currently called `NotifyOptions` -.",
      "user": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29770#pullrequestreview-2180361000",
      "submitted_at": "2024-07-16T14:05:52Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29770"
    },
    {
      "event": "commented",
      "id": 2231294972,
      "node_id": "IC_kwDOABII586E_tv8",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2231294972",
      "actor": {
        "login": "fjahr",
        "id": 1322187,
        "node_id": "MDQ6VXNlcjEzMjIxODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fjahr",
        "html_url": "https://github.com/fjahr",
        "followers_url": "https://api.github.com/users/fjahr/followers",
        "following_url": "https://api.github.com/users/fjahr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fjahr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fjahr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
        "organizations_url": "https://api.github.com/users/fjahr/orgs",
        "repos_url": "https://api.github.com/users/fjahr/repos",
        "events_url": "https://api.github.com/users/fjahr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fjahr/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-07-16T15:57:18Z",
      "updated_at": "2024-07-16T15:57:18Z",
      "author_association": "CONTRIBUTOR",
      "body": "> maflcko's suggestion wouldn't remove the dependency. Unless you place the new enum somewhere else?. Which I don't think it worth it.\r\n\r\nYes, I was thinking of putting it in a file for types which we have been doing in the code base in several places. And @ryanofsky suggests introducing a `kernel/types.h` [here](https://github.com/bitcoin/bitcoin/pull/30214/commits/97cb62492903b188074de5c27b3dcba2c9b768ff) already. Moving code isn't hard to review and `chain.h` is big enough to be broken up a bit more IMO.\r\n\r\n> If we agree that the final goal of the indexes is to run in isolation, in a standalone process, and be the first consumers of the kernel library, then linking them to chain internal fields like the CBlockIndex status mask isn't the way to go. These objects will live only within the kernel process.\r\n\r\nYes, I hope they can run in isolation in the future. But the index still needs to have an understanding of what block data is and what it needs in order to decide if it can handle what the the kernel gives it. So I don't think it can be avoided that the index has knowledge of the block status so this would need to be shared. That doesn't mean that they can't run isolation, but the kernel needs to share this knowledge with them. We can only avoid this if we forget about the concept suggested here and let the index ask for data from the kernel until it hits something unexpected and fails or we basically reimplement the block status as a list of bools in the index which will be much harder to reason about and maintain. I don't see how an options object prevents that. ",
      "user": {
        "login": "fjahr",
        "id": 1322187,
        "node_id": "MDQ6VXNlcjEzMjIxODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fjahr",
        "html_url": "https://github.com/fjahr",
        "followers_url": "https://api.github.com/users/fjahr/followers",
        "following_url": "https://api.github.com/users/fjahr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fjahr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fjahr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
        "organizations_url": "https://api.github.com/users/fjahr/orgs",
        "repos_url": "https://api.github.com/users/fjahr/repos",
        "events_url": "https://api.github.com/users/fjahr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fjahr/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29770#issuecomment-2231294972",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29770"
    },
    {
      "event": "mentioned",
      "id": 13523683731,
      "node_id": "MEE_lADOABII586EIAoKzwAAAAMmEwmT",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/13523683731",
      "actor": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-07-16T15:57:19Z"
    },
    {
      "event": "subscribed",
      "id": 13523683742,
      "node_id": "SE_lADOABII586EIAoKzwAAAAMmEwme",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/13523683742",
      "actor": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-07-16T15:57:19Z"
    },
    {
      "event": "labeled",
      "id": 13526779521,
      "node_id": "LE_lADOABII586EIAoKzwAAAAMmQkaB",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/13526779521",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-07-16T20:33:04Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "head_ref_force_pushed",
      "id": 13534802637,
      "node_id": "HRFPE_lADOABII586EIAoKzwAAAAMmvLLN",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/13534802637",
      "actor": {
        "login": "fjahr",
        "id": 1322187,
        "node_id": "MDQ6VXNlcjEzMjIxODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fjahr",
        "html_url": "https://github.com/fjahr",
        "followers_url": "https://api.github.com/users/fjahr/followers",
        "following_url": "https://api.github.com/users/fjahr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fjahr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fjahr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
        "organizations_url": "https://api.github.com/users/fjahr/orgs",
        "repos_url": "https://api.github.com/users/fjahr/repos",
        "events_url": "https://api.github.com/users/fjahr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fjahr/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": "d855c594c3cb93914fba4aab33c050a67c96debf",
      "commit_url": "https://api.github.com/repos/fjahr/bitcoin/commits/d855c594c3cb93914fba4aab33c050a67c96debf",
      "created_at": "2024-07-17T10:55:48Z"
    },
    {
      "event": "commented",
      "id": 2233022252,
      "node_id": "IC_kwDOABII586FGTcs",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2233022252",
      "actor": {
        "login": "fjahr",
        "id": 1322187,
        "node_id": "MDQ6VXNlcjEzMjIxODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fjahr",
        "html_url": "https://github.com/fjahr",
        "followers_url": "https://api.github.com/users/fjahr/followers",
        "following_url": "https://api.github.com/users/fjahr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fjahr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fjahr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
        "organizations_url": "https://api.github.com/users/fjahr/orgs",
        "repos_url": "https://api.github.com/users/fjahr/repos",
        "events_url": "https://api.github.com/users/fjahr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fjahr/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-07-17T10:55:59Z",
      "updated_at": "2024-07-17T10:55:59Z",
      "author_association": "CONTRIBUTOR",
      "body": "just rebased",
      "user": {
        "login": "fjahr",
        "id": 1322187,
        "node_id": "MDQ6VXNlcjEzMjIxODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fjahr",
        "html_url": "https://github.com/fjahr",
        "followers_url": "https://api.github.com/users/fjahr/followers",
        "following_url": "https://api.github.com/users/fjahr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fjahr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fjahr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
        "organizations_url": "https://api.github.com/users/fjahr/orgs",
        "repos_url": "https://api.github.com/users/fjahr/repos",
        "events_url": "https://api.github.com/users/fjahr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fjahr/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29770#issuecomment-2233022252",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29770"
    },
    {
      "event": "unlabeled",
      "id": 13534929809,
      "node_id": "UNLE_lADOABII586EIAoKzwAAAAMmvqOR",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/13534929809",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-07-17T11:06:04Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "reviewed",
      "id": 2189455441,
      "node_id": "PRR_kwDOABII586CgHBR",
      "url": null,
      "actor": null,
      "commit_id": "d855c594c3cb93914fba4aab33c050a67c96debf",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "body": "> But the index still needs to have an understanding of what block data is and what it needs in order to decide if it can handle what the the kernel gives it. So I don't think it can be avoided that the index has knowledge of the block status so this would need to be shared. That doesn't mean that they can't run isolation, but the kernel needs to share this knowledge with them. We can only avoid this if we forget about the concept suggested here and let the index ask for data from the kernel until it hits something unexpected and fails or we basically reimplement the block status as a list of bools in the index which will be much harder to reason about and maintain. I don't see how an options object prevents that.\r\n\r\nWe both agree that indexes need to share their sync data requirements in some way. Perhaps we are not understanding each other because your rationale is based on the current sync mechanism, while I am considering a future version that is no longer at the index base class.\r\n\r\nAn index running in a standalone process would only sync through kernel signals. It will register with the kernel, providing its last known block hash and the data and events it wants to receive and listen to. Then, it will only react to them. It will no longer request data directly from the kernel as it does currently.\r\n\r\nThe kernel, running in a different process, will emit the signals required to sync the registered index, just as it does for other listeners like the wallet (no difference between them). It will provide the `BlockInfo` struct, which may or may not contain specific data, such as block undo data during connection/disconnection and other information if requested during registration.\r\n\r\nThis is why using an options struct instead of creating a method for each index sync requirement is more flexible to me. The index will provide this struct during registration to the kernel running in a different process and then forget about it. Then, if any event arrives without the requested data, the index will abort its execution.\r\n\r\nMoreover, even if you prefer the multi-overridden-methods approach instead of the options struct (which is how I implemented this in #26966), I don't think accessing the `uint32_t` block index status bit flags field helps much in terms of reasoning about the code or maintenance. People working on upper layers like the indexes, the wallet, or the GUI should focus on receiving the data they expect and should not have to worry/learn about how the block verification status is mapped in memory.",
      "user": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29770#pullrequestreview-2189455441",
      "submitted_at": "2024-07-19T22:31:28Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29770"
    },
    {
      "event": "reviewed",
      "id": 2194366605,
      "node_id": "PRR_kwDOABII586Cy2CN",
      "url": null,
      "actor": null,
      "commit_id": "d855c594c3cb93914fba4aab33c050a67c96debf",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "body": "As a quick sanity check, I rebuilt `-coinstatsindex` and checked `gettxoutsetinfo` still gives me the same stats at block 840,000.",
      "user": {
        "login": "Sjors",
        "id": 10217,
        "node_id": "MDQ6VXNlcjEwMjE3",
        "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Sjors",
        "html_url": "https://github.com/Sjors",
        "followers_url": "https://api.github.com/users/Sjors/followers",
        "following_url": "https://api.github.com/users/Sjors/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Sjors/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Sjors/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
        "organizations_url": "https://api.github.com/users/Sjors/orgs",
        "repos_url": "https://api.github.com/users/Sjors/repos",
        "events_url": "https://api.github.com/users/Sjors/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Sjors/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29770#pullrequestreview-2194366605",
      "submitted_at": "2024-07-23T20:55:04Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29770"
    },
    {
      "event": "labeled",
      "id": 15560158809,
      "node_id": "LE_lADOABII586EIAoKzwAAAAOfdS5Z",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/15560158809",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-12-06T13:06:25Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "head_ref_force_pushed",
      "id": 17046356933,
      "node_id": "HRFPE_lADOABII586EIAoKzwAAAAP4CsPF",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/17046356933",
      "actor": {
        "login": "fjahr",
        "id": 1322187,
        "node_id": "MDQ6VXNlcjEzMjIxODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fjahr",
        "html_url": "https://github.com/fjahr",
        "followers_url": "https://api.github.com/users/fjahr/followers",
        "following_url": "https://api.github.com/users/fjahr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fjahr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fjahr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
        "organizations_url": "https://api.github.com/users/fjahr/orgs",
        "repos_url": "https://api.github.com/users/fjahr/repos",
        "events_url": "https://api.github.com/users/fjahr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fjahr/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": "3d72c9fd059c6886b8b6c2db71f2f84729567c84",
      "commit_url": "https://api.github.com/repos/fjahr/bitcoin/commits/3d72c9fd059c6886b8b6c2db71f2f84729567c84",
      "created_at": "2025-03-29T23:06:08Z"
    },
    {
      "event": "unlabeled",
      "id": 17046409119,
      "node_id": "UNLE_lADOABII586EIAoKzwAAAAP4C4-f",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/17046409119",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-03-29T23:19:10Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "head_ref_force_pushed",
      "id": 17048037062,
      "node_id": "HRFPE_lADOABII586EIAoKzwAAAAP4JGbG",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/17048037062",
      "actor": {
        "login": "fjahr",
        "id": 1322187,
        "node_id": "MDQ6VXNlcjEzMjIxODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fjahr",
        "html_url": "https://github.com/fjahr",
        "followers_url": "https://api.github.com/users/fjahr/followers",
        "following_url": "https://api.github.com/users/fjahr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fjahr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fjahr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
        "organizations_url": "https://api.github.com/users/fjahr/orgs",
        "repos_url": "https://api.github.com/users/fjahr/repos",
        "events_url": "https://api.github.com/users/fjahr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fjahr/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": "401e59df45d113333979f29908450db988b11c4f",
      "commit_url": "https://api.github.com/repos/fjahr/bitcoin/commits/401e59df45d113333979f29908450db988b11c4f",
      "created_at": "2025-03-30T13:58:43Z"
    },
    {
      "event": "commented",
      "id": 2764580300,
      "node_id": "IC_kwDOABII586kyCXM",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2764580300",
      "actor": {
        "login": "fjahr",
        "id": 1322187,
        "node_id": "MDQ6VXNlcjEzMjIxODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fjahr",
        "html_url": "https://github.com/fjahr",
        "followers_url": "https://api.github.com/users/fjahr/followers",
        "following_url": "https://api.github.com/users/fjahr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fjahr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fjahr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
        "organizations_url": "https://api.github.com/users/fjahr/orgs",
        "repos_url": "https://api.github.com/users/fjahr/repos",
        "events_url": "https://api.github.com/users/fjahr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fjahr/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-03-30T14:08:43Z",
      "updated_at": "2025-03-30T14:08:43Z",
      "author_association": "CONTRIBUTOR",
      "body": "I am making one more effort to pick this up see if it can get the necessary support. Upon re-reading our conversation @furszy I have removed the `chain.h` dependency from the indices so that it's a bit closer to what #24230 is planning to do. I looked at it as well to see if there are commits available to pick to add a options object but that didn't seem to be the case and #24230 is also still in draft mode so unsure how valuable it would be if I pick some small piece of code out of it. The code added to the indices here is minimal, so I hope that we can agree now that is worth adding while #24230 is unclear when it will land. The tests added here will be valuable for it either way it seems.",
      "user": {
        "login": "fjahr",
        "id": 1322187,
        "node_id": "MDQ6VXNlcjEzMjIxODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fjahr",
        "html_url": "https://github.com/fjahr",
        "followers_url": "https://api.github.com/users/fjahr/followers",
        "following_url": "https://api.github.com/users/fjahr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fjahr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fjahr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
        "organizations_url": "https://api.github.com/users/fjahr/orgs",
        "repos_url": "https://api.github.com/users/fjahr/repos",
        "events_url": "https://api.github.com/users/fjahr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fjahr/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29770#issuecomment-2764580300",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29770"
    },
    {
      "event": "mentioned",
      "id": 17048060124,
      "node_id": "MEE_lADOABII586EIAoKzwAAAAP4JMDc",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/17048060124",
      "actor": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-03-30T14:08:44Z"
    },
    {
      "event": "subscribed",
      "id": 17048060126,
      "node_id": "SE_lADOABII586EIAoKzwAAAAP4JMDe",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/17048060126",
      "actor": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-03-30T14:08:44Z"
    },
    {
      "event": "reviewed",
      "id": 2733750397,
      "node_id": "PRR_kwDOABII586i8bh9",
      "url": null,
      "actor": null,
      "commit_id": "401e59df45d113333979f29908450db988b11c4f",
      "commit_url": null,
      "created_at": null,
      "author_association": "CONTRIBUTOR",
      "body": "Tbh the getblockfrompeer scenario seem a little bit far-fetched to me.\r\n\r\nAlso, why aren't we simply always requiring `BLOCK_HAVE_DATA` and `BLOCK_HAVE_UNDO` for all indexes instead of making a distinction per index? For hypothetical future indexes? While txindex doesn't strictly need undo data, it also doesn't work with pruning, so when we run with txindex I think we'll always have the undo data anyway for all blocks in the chain.",
      "user": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29770#pullrequestreview-2733750397",
      "submitted_at": "2025-04-01T19:54:23Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29770"
    },
    {
      "event": "commented",
      "id": 2770655782,
      "node_id": "IC_kwDOABII586lJNom",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2770655782",
      "actor": {
        "login": "fjahr",
        "id": 1322187,
        "node_id": "MDQ6VXNlcjEzMjIxODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fjahr",
        "html_url": "https://github.com/fjahr",
        "followers_url": "https://api.github.com/users/fjahr/followers",
        "following_url": "https://api.github.com/users/fjahr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fjahr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fjahr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
        "organizations_url": "https://api.github.com/users/fjahr/orgs",
        "repos_url": "https://api.github.com/users/fjahr/repos",
        "events_url": "https://api.github.com/users/fjahr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fjahr/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-04-01T20:51:32Z",
      "updated_at": "2025-04-01T20:51:32Z",
      "author_association": "CONTRIBUTOR",
      "body": "> Tbh the getblockfrompeer scenario seem a little bit far-fetched to me.\r\n\r\nI ran into this personally when I accidentally pruned a bit too much data and tried to backfill with `getblockfrompeer`, so to me its not far-fetched and I think `getblockfrompeer` is a feature that has a lot of potential to get (over)used in ways we don't anticipate. At the same time I don't think people really understand for what it works and for what it doesn't work. I myself didn't initially have a full grasp of it and improved docs, tests etc. because of it (#23813, #23927, #29668).\r\n\r\n> Also, why aren't we simply always requiring BLOCK_HAVE_DATA and BLOCK_HAVE_UNDO for all indexes instead of making a distinction per index?\r\n\r\nI could be convinced to do it that way if other reviewers prefer this. But I don't think that saves us much. I would save few lines of code and instead need to write a few lines of docs to make clear that we do this even though it's an oversimplification. Curious what @furszy thinks about this.\r\n\r\n> For hypothetical future indexes? While txindex doesn't strictly need undo data, it also doesn't work with pruning, so when we run with txindex I think we'll always have the undo data anyway for all blocks in the chain.\r\n\r\nYes, for future indices definitely. Then I think it's also good documentation, it makes explicit which data the index uses at very minimal cost in complexity. There have also been multiple discussions in the past about pruning undo data independent of block data (for example #19040) and also making txindex compatible with pruning has been discussed (for example #12651), for each of these this would be necessary, even if those may not be very hot topics at the moment.",
      "user": {
        "login": "fjahr",
        "id": 1322187,
        "node_id": "MDQ6VXNlcjEzMjIxODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fjahr",
        "html_url": "https://github.com/fjahr",
        "followers_url": "https://api.github.com/users/fjahr/followers",
        "following_url": "https://api.github.com/users/fjahr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fjahr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fjahr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
        "organizations_url": "https://api.github.com/users/fjahr/orgs",
        "repos_url": "https://api.github.com/users/fjahr/repos",
        "events_url": "https://api.github.com/users/fjahr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fjahr/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29770#issuecomment-2770655782",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29770"
    },
    {
      "event": "mentioned",
      "id": 17082434251,
      "node_id": "MEE_lADOABII586EIAoKzwAAAAP6MULL",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/17082434251",
      "actor": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-04-01T20:51:33Z"
    },
    {
      "event": "subscribed",
      "id": 17082434282,
      "node_id": "SE_lADOABII586EIAoKzwAAAAP6MULq",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/17082434282",
      "actor": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-04-01T20:51:34Z"
    },
    {
      "event": "reviewed",
      "id": 2737440508,
      "node_id": "PRR_kwDOABII586jKgb8",
      "url": null,
      "actor": null,
      "commit_id": "401e59df45d113333979f29908450db988b11c4f",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "body": ">> Also, why aren't we simply always requiring BLOCK_HAVE_DATA and BLOCK_HAVE_UNDO for all indexes instead of making a distinction per index?\r\n>\r\n> I could be convinced to do it that way if other reviewers prefer this. But I don't think that saves us much. I would save few lines of code and instead need to write a few lines of docs to make clear that we do this even though it's an oversimplification. Curious what @furszy thinks about this.\r\n\r\nThe synchronization process currently runs in isolation per index on separate threads (one per index). In the future, we might want to run it only once for all indexes to avoid reading the same blocks from disk multiple times. At that point, it would be useful to know which index requires which data so that, during dispatching — especially when multiple dispatching workers are involved — we don't queue data that won't be consumed by the index.",
      "user": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29770#pullrequestreview-2737440508",
      "submitted_at": "2025-04-02T20:39:41Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29770"
    },
    {
      "event": "commented",
      "id": 2775076145,
      "node_id": "IC_kwDOABII586laE0x",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2775076145",
      "actor": {
        "login": "fjahr",
        "id": 1322187,
        "node_id": "MDQ6VXNlcjEzMjIxODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fjahr",
        "html_url": "https://github.com/fjahr",
        "followers_url": "https://api.github.com/users/fjahr/followers",
        "following_url": "https://api.github.com/users/fjahr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fjahr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fjahr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
        "organizations_url": "https://api.github.com/users/fjahr/orgs",
        "repos_url": "https://api.github.com/users/fjahr/repos",
        "events_url": "https://api.github.com/users/fjahr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fjahr/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-04-03T09:31:33Z",
      "updated_at": "2025-04-03T09:31:33Z",
      "author_association": "CONTRIBUTOR",
      "body": "> Also, why aren't we simply always requiring BLOCK_HAVE_DATA and BLOCK_HAVE_UNDO for all indexes instead of making a distinction per index?\r\n\r\nThe IBD Booster idea that was just published is another concept where we would not have any undo data available but txindex should still be possible: https://delvingbitcoin.org/t/ibd-booster-speeding-up-ibd-with-pre-generated-hints-poc/1562/2\r\n\r\n",
      "user": {
        "login": "fjahr",
        "id": 1322187,
        "node_id": "MDQ6VXNlcjEzMjIxODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fjahr",
        "html_url": "https://github.com/fjahr",
        "followers_url": "https://api.github.com/users/fjahr/followers",
        "following_url": "https://api.github.com/users/fjahr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fjahr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fjahr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
        "organizations_url": "https://api.github.com/users/fjahr/orgs",
        "repos_url": "https://api.github.com/users/fjahr/repos",
        "events_url": "https://api.github.com/users/fjahr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fjahr/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29770#issuecomment-2775076145",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29770"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 17118676966,
      "node_id": "HRFPE_lADOABII586EIAoKzwAAAAP8Wkfm",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/17118676966",
      "actor": {
        "login": "fjahr",
        "id": 1322187,
        "node_id": "MDQ6VXNlcjEzMjIxODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fjahr",
        "html_url": "https://github.com/fjahr",
        "followers_url": "https://api.github.com/users/fjahr/followers",
        "following_url": "https://api.github.com/users/fjahr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fjahr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fjahr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
        "organizations_url": "https://api.github.com/users/fjahr/orgs",
        "repos_url": "https://api.github.com/users/fjahr/repos",
        "events_url": "https://api.github.com/users/fjahr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fjahr/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": "1584a79d4553d07f1fcbb7bc6a138c669fdbfa7c",
      "commit_url": "https://api.github.com/repos/fjahr/bitcoin/commits/1584a79d4553d07f1fcbb7bc6a138c669fdbfa7c",
      "created_at": "2025-04-03T18:27:43Z"
    },
    {
      "event": "labeled",
      "id": 17120960945,
      "node_id": "LE_lADOABII586EIAoKzwAAAAP8fSGx",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/17120960945",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-04-03T21:45:28Z",
      "label": {
        "name": "CI failed",
        "color": "cccccc"
      }
    },
    {
      "event": "unlabeled",
      "id": 17124571969,
      "node_id": "UNLE_lADOABII586EIAoKzwAAAAP8tDtB",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/17124571969",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-04-04T06:18:15Z",
      "label": {
        "name": "CI failed",
        "color": "cccccc"
      }
    },
    {
      "event": "closed",
      "id": 17151328064,
      "node_id": "CE_lADOABII586EIAoKzwAAAAP-TH9A",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/17151328064",
      "actor": {
        "login": "maflcko",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/maflcko",
        "html_url": "https://github.com/maflcko",
        "followers_url": "https://api.github.com/users/maflcko/followers",
        "following_url": "https://api.github.com/users/maflcko/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/maflcko/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/maflcko/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/maflcko/subscriptions",
        "organizations_url": "https://api.github.com/users/maflcko/orgs",
        "repos_url": "https://api.github.com/users/maflcko/repos",
        "events_url": "https://api.github.com/users/maflcko/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/maflcko/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-04-07T10:51:11Z"
    },
    {
      "event": "reopened",
      "id": 17151329345,
      "node_id": "REE_lADOABII586EIAoKzwAAAAP-TIRB",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/17151329345",
      "actor": {
        "login": "maflcko",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/maflcko",
        "html_url": "https://github.com/maflcko",
        "followers_url": "https://api.github.com/users/maflcko/followers",
        "following_url": "https://api.github.com/users/maflcko/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/maflcko/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/maflcko/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/maflcko/subscriptions",
        "organizations_url": "https://api.github.com/users/maflcko/orgs",
        "repos_url": "https://api.github.com/users/maflcko/repos",
        "events_url": "https://api.github.com/users/maflcko/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/maflcko/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-04-07T10:51:17Z"
    },
    {
      "event": "labeled",
      "id": 17406386200,
      "node_id": "LE_lADOABII586EIAoKzwAAAAQNgGAY",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/17406386200",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-04-25T13:14:09Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "commented",
      "id": 2901082433,
      "node_id": "IC_kwDOABII586s6wFB",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2901082433",
      "actor": {
        "login": "TheCharlatan",
        "id": 8421793,
        "node_id": "MDQ6VXNlcjg0MjE3OTM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8421793?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/TheCharlatan",
        "html_url": "https://github.com/TheCharlatan",
        "followers_url": "https://api.github.com/users/TheCharlatan/followers",
        "following_url": "https://api.github.com/users/TheCharlatan/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/TheCharlatan/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/TheCharlatan/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/TheCharlatan/subscriptions",
        "organizations_url": "https://api.github.com/users/TheCharlatan/orgs",
        "repos_url": "https://api.github.com/users/TheCharlatan/repos",
        "events_url": "https://api.github.com/users/TheCharlatan/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/TheCharlatan/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-05-22T12:39:51Z",
      "updated_at": "2025-05-22T12:39:51Z",
      "author_association": "CONTRIBUTOR",
      "body": "@fjahr can you rebase this, I'm still interested in this change.",
      "user": {
        "login": "TheCharlatan",
        "id": 8421793,
        "node_id": "MDQ6VXNlcjg0MjE3OTM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8421793?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/TheCharlatan",
        "html_url": "https://github.com/TheCharlatan",
        "followers_url": "https://api.github.com/users/TheCharlatan/followers",
        "following_url": "https://api.github.com/users/TheCharlatan/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/TheCharlatan/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/TheCharlatan/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/TheCharlatan/subscriptions",
        "organizations_url": "https://api.github.com/users/TheCharlatan/orgs",
        "repos_url": "https://api.github.com/users/TheCharlatan/repos",
        "events_url": "https://api.github.com/users/TheCharlatan/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/TheCharlatan/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29770#issuecomment-2901082433",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29770"
    },
    {
      "event": "mentioned",
      "id": 17771746804,
      "node_id": "MEE_lADOABII586EIAoKzwAAAAQjR1X0",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/17771746804",
      "actor": {
        "login": "fjahr",
        "id": 1322187,
        "node_id": "MDQ6VXNlcjEzMjIxODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fjahr",
        "html_url": "https://github.com/fjahr",
        "followers_url": "https://api.github.com/users/fjahr/followers",
        "following_url": "https://api.github.com/users/fjahr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fjahr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fjahr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
        "organizations_url": "https://api.github.com/users/fjahr/orgs",
        "repos_url": "https://api.github.com/users/fjahr/repos",
        "events_url": "https://api.github.com/users/fjahr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fjahr/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-05-22T12:39:52Z"
    },
    {
      "event": "subscribed",
      "id": 17771746836,
      "node_id": "SE_lADOABII586EIAoKzwAAAAQjR1YU",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/17771746836",
      "actor": {
        "login": "fjahr",
        "id": 1322187,
        "node_id": "MDQ6VXNlcjEzMjIxODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fjahr",
        "html_url": "https://github.com/fjahr",
        "followers_url": "https://api.github.com/users/fjahr/followers",
        "following_url": "https://api.github.com/users/fjahr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fjahr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fjahr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
        "organizations_url": "https://api.github.com/users/fjahr/orgs",
        "repos_url": "https://api.github.com/users/fjahr/repos",
        "events_url": "https://api.github.com/users/fjahr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fjahr/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-05-22T12:39:52Z"
    },
    {
      "event": "unsubscribed",
      "id": 17795020436,
      "node_id": "UE_lADOABII586EIAoKzwAAAAQkqnaU",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/17795020436",
      "actor": {
        "login": "deehochberg",
        "id": 185879065,
        "node_id": "U_kgDOCxRKGQ",
        "avatar_url": "https://avatars.githubusercontent.com/u/185879065?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/deehochberg",
        "html_url": "https://github.com/deehochberg",
        "followers_url": "https://api.github.com/users/deehochberg/followers",
        "following_url": "https://api.github.com/users/deehochberg/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/deehochberg/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/deehochberg/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/deehochberg/subscriptions",
        "organizations_url": "https://api.github.com/users/deehochberg/orgs",
        "repos_url": "https://api.github.com/users/deehochberg/repos",
        "events_url": "https://api.github.com/users/deehochberg/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/deehochberg/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-05-23T18:59:26Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 17905319701,
      "node_id": "HRFPE_lADOABII586EIAoKzwAAAAQrPX8V",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/17905319701",
      "actor": {
        "login": "fjahr",
        "id": 1322187,
        "node_id": "MDQ6VXNlcjEzMjIxODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fjahr",
        "html_url": "https://github.com/fjahr",
        "followers_url": "https://api.github.com/users/fjahr/followers",
        "following_url": "https://api.github.com/users/fjahr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fjahr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fjahr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
        "organizations_url": "https://api.github.com/users/fjahr/orgs",
        "repos_url": "https://api.github.com/users/fjahr/repos",
        "events_url": "https://api.github.com/users/fjahr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fjahr/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": "8fb2b77f69f38f256c185c068983d17eba183ed4",
      "commit_url": "https://api.github.com/repos/fjahr/bitcoin/commits/8fb2b77f69f38f256c185c068983d17eba183ed4",
      "created_at": "2025-05-31T21:50:10Z"
    },
    {
      "event": "commented",
      "id": 2925784992,
      "node_id": "IC_kwDOABII586uY--g",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2925784992",
      "actor": {
        "login": "fjahr",
        "id": 1322187,
        "node_id": "MDQ6VXNlcjEzMjIxODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fjahr",
        "html_url": "https://github.com/fjahr",
        "followers_url": "https://api.github.com/users/fjahr/followers",
        "following_url": "https://api.github.com/users/fjahr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fjahr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fjahr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
        "organizations_url": "https://api.github.com/users/fjahr/orgs",
        "repos_url": "https://api.github.com/users/fjahr/repos",
        "events_url": "https://api.github.com/users/fjahr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fjahr/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-05-31T21:52:01Z",
      "updated_at": "2025-05-31T22:01:54Z",
      "author_association": "CONTRIBUTOR",
      "body": "Rebased and addressed @furszy 's comment [here](https://github.com/bitcoin/bitcoin/pull/29770#discussion_r2025545858), sorry for the long delay!",
      "user": {
        "login": "fjahr",
        "id": 1322187,
        "node_id": "MDQ6VXNlcjEzMjIxODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fjahr",
        "html_url": "https://github.com/fjahr",
        "followers_url": "https://api.github.com/users/fjahr/followers",
        "following_url": "https://api.github.com/users/fjahr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fjahr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fjahr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
        "organizations_url": "https://api.github.com/users/fjahr/orgs",
        "repos_url": "https://api.github.com/users/fjahr/repos",
        "events_url": "https://api.github.com/users/fjahr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fjahr/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29770#issuecomment-2925784992",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29770"
    },
    {
      "event": "mentioned",
      "id": 17905366468,
      "node_id": "MEE_lADOABII586EIAoKzwAAAAQrPjXE",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/17905366468",
      "actor": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-05-31T22:02:15Z"
    },
    {
      "event": "subscribed",
      "id": 17905366471,
      "node_id": "SE_lADOABII586EIAoKzwAAAAQrPjXH",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/17905366471",
      "actor": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-05-31T22:02:16Z"
    },
    {
      "event": "unlabeled",
      "id": 17906396212,
      "node_id": "UNLE_lADOABII586EIAoKzwAAAAQrTew0",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/17906396212",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-05-31T23:36:49Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "reviewed",
      "id": 2888284022,
      "node_id": "PRR_kwDOABII586sJ7d2",
      "url": null,
      "actor": null,
      "commit_id": "8fb2b77f69f38f256c185c068983d17eba183ed4",
      "commit_url": null,
      "created_at": null,
      "author_association": "CONTRIBUTOR",
      "body": "Approach ACK\r\n\r\nCan you run `clang-format-diff` on the hunks where it makes sense? I think requiring the indexes to declare if they will use undo data is sensible, but I'd also not be opposed to just making all of them require undo data.",
      "user": {
        "login": "TheCharlatan",
        "id": 8421793,
        "node_id": "MDQ6VXNlcjg0MjE3OTM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8421793?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/TheCharlatan",
        "html_url": "https://github.com/TheCharlatan",
        "followers_url": "https://api.github.com/users/TheCharlatan/followers",
        "following_url": "https://api.github.com/users/TheCharlatan/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/TheCharlatan/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/TheCharlatan/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/TheCharlatan/subscriptions",
        "organizations_url": "https://api.github.com/users/TheCharlatan/orgs",
        "repos_url": "https://api.github.com/users/TheCharlatan/repos",
        "events_url": "https://api.github.com/users/TheCharlatan/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/TheCharlatan/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29770#pullrequestreview-2888284022",
      "submitted_at": "2025-06-02T13:39:48Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29770"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 17989882883,
      "node_id": "HRFPE_lADOABII586EIAoKzwAAAAQwR9QD",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/17989882883",
      "actor": {
        "login": "fjahr",
        "id": 1322187,
        "node_id": "MDQ6VXNlcjEzMjIxODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fjahr",
        "html_url": "https://github.com/fjahr",
        "followers_url": "https://api.github.com/users/fjahr/followers",
        "following_url": "https://api.github.com/users/fjahr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fjahr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fjahr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
        "organizations_url": "https://api.github.com/users/fjahr/orgs",
        "repos_url": "https://api.github.com/users/fjahr/repos",
        "events_url": "https://api.github.com/users/fjahr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fjahr/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": "449687fbc6e253a703c62312431c697cb000fbe3",
      "commit_url": "https://api.github.com/repos/fjahr/bitcoin/commits/449687fbc6e253a703c62312431c697cb000fbe3",
      "created_at": "2025-06-04T21:46:07Z"
    },
    {
      "event": "labeled",
      "id": 18102783005,
      "node_id": "LE_lADOABII586EIAoKzwAAAAQ3Aowd",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/18102783005",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-06-11T22:31:49Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "reviewed",
      "id": 2923006663,
      "node_id": "PRR_kwDOABII586uOYrH",
      "url": null,
      "actor": null,
      "commit_id": "449687fbc6e253a703c62312431c697cb000fbe3",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "user": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29770#pullrequestreview-2923006663",
      "submitted_at": "2025-06-13T13:42:23Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29770"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 18159309116,
      "node_id": "HRFPE_lADOABII586EIAoKzwAAAAQ6YRE8",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/18159309116",
      "actor": {
        "login": "fjahr",
        "id": 1322187,
        "node_id": "MDQ6VXNlcjEzMjIxODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fjahr",
        "html_url": "https://github.com/fjahr",
        "followers_url": "https://api.github.com/users/fjahr/followers",
        "following_url": "https://api.github.com/users/fjahr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fjahr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fjahr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
        "organizations_url": "https://api.github.com/users/fjahr/orgs",
        "repos_url": "https://api.github.com/users/fjahr/repos",
        "events_url": "https://api.github.com/users/fjahr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fjahr/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": "469a7c28b5363c2f71d973d0b586f2908ef86767",
      "commit_url": "https://api.github.com/repos/fjahr/bitcoin/commits/469a7c28b5363c2f71d973d0b586f2908ef86767",
      "created_at": "2025-06-15T21:13:32Z"
    },
    {
      "event": "commented",
      "id": 2974695336,
      "node_id": "IC_kwDOABII586xTj-o",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2974695336",
      "actor": {
        "login": "fjahr",
        "id": 1322187,
        "node_id": "MDQ6VXNlcjEzMjIxODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fjahr",
        "html_url": "https://github.com/fjahr",
        "followers_url": "https://api.github.com/users/fjahr/followers",
        "following_url": "https://api.github.com/users/fjahr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fjahr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fjahr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
        "organizations_url": "https://api.github.com/users/fjahr/orgs",
        "repos_url": "https://api.github.com/users/fjahr/repos",
        "events_url": "https://api.github.com/users/fjahr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fjahr/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-06-15T21:14:38Z",
      "updated_at": "2025-06-15T21:14:38Z",
      "author_association": "CONTRIBUTOR",
      "body": "Rebased and adapted the changes that https://github.com/bitcoin/bitcoin/pull/32694 introduced.",
      "user": {
        "login": "fjahr",
        "id": 1322187,
        "node_id": "MDQ6VXNlcjEzMjIxODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fjahr",
        "html_url": "https://github.com/fjahr",
        "followers_url": "https://api.github.com/users/fjahr/followers",
        "following_url": "https://api.github.com/users/fjahr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fjahr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fjahr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
        "organizations_url": "https://api.github.com/users/fjahr/orgs",
        "repos_url": "https://api.github.com/users/fjahr/repos",
        "events_url": "https://api.github.com/users/fjahr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fjahr/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29770#issuecomment-2974695336",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29770"
    },
    {
      "event": "unlabeled",
      "id": 18159443262,
      "node_id": "UNLE_lADOABII586EIAoKzwAAAAQ6Yx0-",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/18159443262",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-06-15T22:03:24Z",
      "label": {
        "name": "Needs rebase",
        "color": "cccccc"
      }
    },
    {
      "event": "reviewed",
      "id": 2932441557,
      "node_id": "PRR_kwDOABII586uyYHV",
      "url": null,
      "actor": null,
      "commit_id": "469a7c28b5363c2f71d973d0b586f2908ef86767",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "body": "The test doesn’t appear to exercise the issue. I cherry-picked [155803b](https://github.com/bitcoin/bitcoin/pull/29770/commits/155803b8b4a2e7a499f5e6497f82f099ca3e6bfb) onto master, and it passes without failure. Was expecting some crash (or a not-common failure) due to the lack of undo data and the missing check for it.",
      "user": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29770#pullrequestreview-2932441557",
      "submitted_at": "2025-06-16T14:44:39Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29770"
    },
    {
      "event": "reviewed",
      "id": 2932613955,
      "node_id": "PRR_kwDOABII586uzCND",
      "url": null,
      "actor": null,
      "commit_id": "469a7c28b5363c2f71d973d0b586f2908ef86767",
      "commit_url": null,
      "created_at": null,
      "author_association": "MEMBER",
      "body": "I think you could implement this with a single chain traversal and without too many changes if you make `CheckBlockDataAvailability` aware of the lack of undo data in the genesis block. See https://github.com/furszy/bitcoin-core/commit/927c13de0a7bb22d9ff280f3b122860cbdeda383 and https://github.com/furszy/bitcoin-core/commit/be23f17fbdcc896e25258f67bfa1840ca9825266",
      "user": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29770#pullrequestreview-2932613955",
      "submitted_at": "2025-06-16T15:31:52Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29770"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKGZmN2JmN2MzYjQ3OGIxZjJmZjY4MjRjMDU3ZjM3ZDgwNTQ0NjVkYTA",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/ff7bf7c3b478b1f2ff6824c057f37d8054465da0",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/ff7bf7c3b478b1f2ff6824c057f37d8054465da0",
      "tree": {
        "sha": "2e58ac7e00738cdd17969b239873063fa4f64eaa",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/2e58ac7e00738cdd17969b239873063fa4f64eaa"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree 2e58ac7e00738cdd17969b239873063fa4f64eaa\nparent 084eee029199a741c58e5537b332bd8360a1bdc3\nauthor Fabian Jahr <fjahr@protonmail.com> 1711742453 +0100\ncommitter Fabian Jahr <fjahr@protonmail.com> 1750192573 +0200\n\nindex: Check availability of undo data for indices\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\nComment: GPGTools - https://gpgtools.org\n\niQJJBAABCgAzFiEEtFq20ghhrCHSdrgm8T0enYkHmM0FAmhR0b0VHGZqYWhyQHBy\nb3Rvbm1haWwuY29tAAoJEPE9Hp2JB5jNCwIP/1JqbGW1D6H3dCauq3AxMEsXdGNy\n5+D31EMYVmlBqs40gQ08R5aXMGI9EisehzBbHyBAodA9A+zJh03nHGWBF3IZfRaS\n5O8drgbzo8NGZlOs5cJ72YlsO0+OJyyZbx9KtAC6Qm+tdWpaGphbr0bvAloOa6il\n4nEyrM3Tw2ButBNOVf3kyeuK7XeouyzT+oCcgxoI0pyLFxnolAwxghDWG3GtpU3z\nc6eAFrQEtXc+pe0xLduRI0XAMODyaxYbqBjzVHOqeh5vVcGM1dUW2NSKW5m2/r+/\nuTYeNLMaBqnzo8Y6B3fKji4lhTiTGf9sWBvCQKTmfkbYBqld7hofbs144duBS6x0\nUCRrTyeQt0uqYDSpMgELXK16Fx+oohxwZQuL1CFVCkaDbaWjSktKgZucX13znlem\nis5h27vtqsSNDkDY9kO26gbSNSdMvH/OZV8SkBoFIrFXktKUJVuoxQfPrP/Y6YnT\nQ4T+7D0Omr/R+xjQiPeHazPPiktJzfMyvlGGFYel/uafviyc6IS6Ah9tz0DR2+mo\nk9DiYuI3rQAKL2n70+nb64l6ZUhSH6Wga7a3/NjYwa9zq6MrpFLKqwmdL/XLU74c\nWjSgcmVS1xelH891ao9N4a/5nMEX4bDzOhpb6tDooYPuEJmLQDufdU7qIfs+yhAy\nk7P8hkyYkmUUqxqR\n=GALE\n-----END PGP SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/084eee029199a741c58e5537b332bd8360a1bdc3",
          "sha": "084eee029199a741c58e5537b332bd8360a1bdc3",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/084eee029199a741c58e5537b332bd8360a1bdc3"
        }
      ],
      "message": "index: Check availability of undo data for indices",
      "committer": {
        "name": "Fabian Jahr",
        "email": "fjahr@protonmail.com",
        "date": "2025-06-17T20:36:13Z"
      },
      "author": {
        "name": "Fabian Jahr",
        "email": "fjahr@protonmail.com",
        "date": "2024-03-29T20:00:53Z"
      },
      "sha": "ff7bf7c3b478b1f2ff6824c057f37d8054465da0"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKGVkZTBkZTZiYTI3ZDI5MDFmYjkxMjEyMWFlNTI1MjBkMGQwZTVmNjE",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/ede0de6ba27d2901fb912121ae52520d0d0e5f61",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/ede0de6ba27d2901fb912121ae52520d0d0e5f61",
      "tree": {
        "sha": "37316640bf90e2d6aa305b215c4abff58d088cec",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/37316640bf90e2d6aa305b215c4abff58d088cec"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree 37316640bf90e2d6aa305b215c4abff58d088cec\nparent ff7bf7c3b478b1f2ff6824c057f37d8054465da0\nauthor Fabian Jahr <fjahr@protonmail.com> 1711837928 +0100\ncommitter Fabian Jahr <fjahr@protonmail.com> 1750192585 +0200\n\ntest: Indices can not start based on block data without undo data\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\nComment: GPGTools - https://gpgtools.org\n\niQJJBAABCgAzFiEEtFq20ghhrCHSdrgm8T0enYkHmM0FAmhR0coVHGZqYWhyQHBy\nb3Rvbm1haWwuY29tAAoJEPE9Hp2JB5jNciEP+wX2nopW/5weJ07C9bi1iKlyYQsj\n1x+DV5sqQVQk37pEyndZvBw+m68y1CXduhMaw2VRIlwxUcu3a3lvi9/9SOBG+uXO\nAp+c3xEKu+QWP6IupWkvJuI8X2fhTO888Veht2BERIX4wmDwQT9Mx5O4kH7rqYIT\njQoz7ckOfhdLRVFCJxFi5igKKVrMCp1y3A7sEzGDc4ch3k1+NNSbuYHAKstqnfqz\nPw6nCZfYM4yZrJ6QZbwWH6fjsa8FMnGmdofKyX9ucPixT9Z5SDhbUkNS1KWSeAP0\npBdVfo66QgjQN7A8vKrkl+yjqY+U6ZA3QFo9wIRJnl8XtxdETO8VugbuRyTY311P\nIwUsqC8X052qCkrxsUAQn/RXEyWBqqWn7UmsUKqtVYfA309BGqzVWnMSoMLO5oFO\n3Ra7hCd2LJ3jex/Vu44ViDobWKgW/xXqeOWRixvFEhCrKaOSmuxDfurZIVzkXTX/\nUetZ5O1PocZYb9E9banqWQ47WdC07XNoACLi2fLxyLd035hQPlpQPrdSu7xe23CT\nhxXvTsRDx/RjIZv656OgHFewKovkqrGtL+nlTnumJzQBbupG2gLmgiEIpgFXWu5J\nMpEQosNxUW3vn+P5H33crnb4mN38ItH6rXnZ+C/lH1eP5pN4sj0qAw92OxEheQhl\nNSW3MPGKWM19OoRu\n=1Xnh\n-----END PGP SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/ff7bf7c3b478b1f2ff6824c057f37d8054465da0",
          "sha": "ff7bf7c3b478b1f2ff6824c057f37d8054465da0",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/ff7bf7c3b478b1f2ff6824c057f37d8054465da0"
        }
      ],
      "message": "test: Indices can not start based on block data without undo data",
      "committer": {
        "name": "Fabian Jahr",
        "email": "fjahr@protonmail.com",
        "date": "2025-06-17T20:36:25Z"
      },
      "author": {
        "name": "Fabian Jahr",
        "email": "fjahr@protonmail.com",
        "date": "2024-03-30T22:32:08Z"
      },
      "sha": "ede0de6ba27d2901fb912121ae52520d0d0e5f61"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDQ5MTQxMDUxOTcwNjhhNDA2YTI1ZTAwZWJjYWI2YzA0YzIwYzdjNTg",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/4914105197068a406a25e00ebcab6c04c20c7c58",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/4914105197068a406a25e00ebcab6c04c20c7c58",
      "tree": {
        "sha": "efb43d3304f90ec4c6be19f48a64a1bde8241b3a",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/efb43d3304f90ec4c6be19f48a64a1bde8241b3a"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree efb43d3304f90ec4c6be19f48a64a1bde8241b3a\nparent ede0de6ba27d2901fb912121ae52520d0d0e5f61\nauthor Fabian Jahr <fjahr@protonmail.com> 1720799871 +0100\ncommitter Fabian Jahr <fjahr@protonmail.com> 1750192586 +0200\n\nrpc, test: Address feedback from #29668\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\nComment: GPGTools - https://gpgtools.org\n\niQJJBAABCgAzFiEEtFq20ghhrCHSdrgm8T0enYkHmM0FAmhR0coVHGZqYWhyQHBy\nb3Rvbm1haWwuY29tAAoJEPE9Hp2JB5jNU48P/0vn4mux7OvhnYTKlDSE+gSr2O3V\n2hBouScM18OeKTJ5TbOrDFYx/95hVmRXs/jqdvx/HhWsuwToLwkw6Hs/CcIPOtp5\nJN44MhI9H94r74hRUBAjjy7bMbMU0XyPSfEKo7gYuLunpwl3yVEuvKxGYQccFBJw\niFdQRJ1jTbG4klv3MNrE/CI1DfQAdr+Bmjp8KprAznWWtV9Y4iLlmGHLvMmP6kR1\nKRJMLPN+Z6VbFatgEptvjO7EnhXwRuCfsjj56Af5KzldLGoRw7eT14JjfUCC5vBQ\n4LWtjtG7ri5rZyX99W+AGU73SI2G4DgcrfEHSy/dVthCaoUrfXb1caEUUPx5NArZ\nraaz+BVqw7oKJcoz4aEwZGpW/NFaXF3iJHaZdTSkd9jF8AZfLpsFRIYhm+zuBcqd\nX3qtfstGDCgkvZ8MS7TdJv9Wpn21I4j3Y0XVer2sxNh2JMuKyTODxsgU3MSCogEr\nwHdeZZn82B8GvgmjF5MX6jvaBmI4AMBk/caatzAGkhdaeZnZfsh7SQ1bWE2pFeoY\nSSN25AFbFegr1MMmMH9mzjLsFe+96HckRa1bxppFqltVrgCIboB63XWwHzIOKBEY\nRzGejlaCoU79SYFbOYbqcuKoHSOx76vgMuwFhcaKGE0UDktZj3j60JGb9PYsLDWi\n/xVkZJ+0RbqL8m/j\n=+q85\n-----END PGP SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/ede0de6ba27d2901fb912121ae52520d0d0e5f61",
          "sha": "ede0de6ba27d2901fb912121ae52520d0d0e5f61",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/ede0de6ba27d2901fb912121ae52520d0d0e5f61"
        }
      ],
      "message": "rpc, test: Address feedback from #29668",
      "committer": {
        "name": "Fabian Jahr",
        "email": "fjahr@protonmail.com",
        "date": "2025-06-17T20:36:26Z"
      },
      "author": {
        "name": "Fabian Jahr",
        "email": "fjahr@protonmail.com",
        "date": "2024-07-12T15:57:51Z"
      },
      "sha": "4914105197068a406a25e00ebcab6c04c20c7c58"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOABII59oAKDFmMWQ5ZjI5MDRlZTE2NmJkODI5MDU2MTFkZWQ1MWVkOWRlN2IyOGE",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/1f1d9f2904ee166bd82905611ded51ed9de7b28a",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin/bitcoin/commit/1f1d9f2904ee166bd82905611ded51ed9de7b28a",
      "tree": {
        "sha": "2f22ba40e0cba3fa8c9b2d4e046f5ed3f2e45b28",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/2f22ba40e0cba3fa8c9b2d4e046f5ed3f2e45b28"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree 2f22ba40e0cba3fa8c9b2d4e046f5ed3f2e45b28\nparent 4914105197068a406a25e00ebcab6c04c20c7c58\nauthor Fabian Jahr <fjahr@protonmail.com> 1743702706 +0200\ncommitter Fabian Jahr <fjahr@protonmail.com> 1750192586 +0200\n\ntest: Add coverage for restarted node without any block sync\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\nComment: GPGTools - https://gpgtools.org\n\niQJJBAABCgAzFiEEtFq20ghhrCHSdrgm8T0enYkHmM0FAmhR0coVHGZqYWhyQHBy\nb3Rvbm1haWwuY29tAAoJEPE9Hp2JB5jNidIP/jUwLVuTGy0/Loyjbk90Nf4wd96c\nXeyjgSeqhtZBK6+pdZU5+dZdzAU+HiSQBjbUVPGNWEqEsrYxe8lLJ9L+S7Ub5yN+\n6ETEiG4lUVRjvnRiBXRB9pC5rvZA1bE62WENPAK9C9TJzQyPDzdvIFy3rw+UUgPk\nUKK7U9sqRxzuD/H95vvwYeJh0WvrkIgf5IAoC7hOS8r3bo4ZF3ouiWU8dGHCG44q\nP+sz0j6yxDgCEoF5p1iTPdfi5Yz1cagqHrqJYtYbDz78NrhW7DFoio7bM6t+nuaQ\nYaoEXR6Xjx8WHoWVtq1ySwM3oK8sotQ1qOU9z3Lsx8jn152fdYi2X3TkiZ9L+vlo\ntgJQ2TNUXmil/taT/+xgv6w+jFzhAFjP04QxEXYwwylh1IdxZTTT7hqU5cVgW9AF\n7CyMNxXsvHu2PfGqfHyBL4LWJ0Sv+YagWPq2niSJ/o7973TFVUmKkcmAOcKLSex3\nMpudMQLGwDBrE++5Bc+bTFxnW0jX0dSpTQF2c93aXyrfEgYoFXRuC+fM/ikpfzdV\nZdi7XrMlWusF3BY/ZhThNxIruw0Gz1qJSht+QVs2Lxv4JtEI66NVInGjE28IY/Dj\nJCB435hv+FkAFlZ9i/TWbU3i/DDO6OBi+qBkvrVtEIJnTSXQBg+fwKUyg57mAFD7\nMZGWOVGqdS09cPTN\n=fyCi\n-----END PGP SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/4914105197068a406a25e00ebcab6c04c20c7c58",
          "sha": "4914105197068a406a25e00ebcab6c04c20c7c58",
          "html_url": "https://github.com/bitcoin/bitcoin/commit/4914105197068a406a25e00ebcab6c04c20c7c58"
        }
      ],
      "message": "test: Add coverage for restarted node without any block sync",
      "committer": {
        "name": "Fabian Jahr",
        "email": "fjahr@protonmail.com",
        "date": "2025-06-17T20:36:26Z"
      },
      "author": {
        "name": "Fabian Jahr",
        "email": "fjahr@protonmail.com",
        "date": "2025-04-03T17:51:46Z"
      },
      "sha": "1f1d9f2904ee166bd82905611ded51ed9de7b28a"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 18198177184,
      "node_id": "HRFPE_lADOABII586EIAoKzwAAAAQ8siWg",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/18198177184",
      "actor": {
        "login": "fjahr",
        "id": 1322187,
        "node_id": "MDQ6VXNlcjEzMjIxODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fjahr",
        "html_url": "https://github.com/fjahr",
        "followers_url": "https://api.github.com/users/fjahr/followers",
        "following_url": "https://api.github.com/users/fjahr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fjahr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fjahr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
        "organizations_url": "https://api.github.com/users/fjahr/orgs",
        "repos_url": "https://api.github.com/users/fjahr/repos",
        "events_url": "https://api.github.com/users/fjahr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fjahr/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": "1f1d9f2904ee166bd82905611ded51ed9de7b28a",
      "commit_url": "https://api.github.com/repos/fjahr/bitcoin/commits/1f1d9f2904ee166bd82905611ded51ed9de7b28a",
      "created_at": "2025-06-17T20:47:35Z"
    },
    {
      "event": "commented",
      "id": 2981789625,
      "node_id": "IC_kwDOABII586xun-5",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2981789625",
      "actor": {
        "login": "fjahr",
        "id": 1322187,
        "node_id": "MDQ6VXNlcjEzMjIxODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fjahr",
        "html_url": "https://github.com/fjahr",
        "followers_url": "https://api.github.com/users/fjahr/followers",
        "following_url": "https://api.github.com/users/fjahr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fjahr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fjahr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
        "organizations_url": "https://api.github.com/users/fjahr/orgs",
        "repos_url": "https://api.github.com/users/fjahr/repos",
        "events_url": "https://api.github.com/users/fjahr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fjahr/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-06-17T20:47:41Z",
      "updated_at": "2025-06-17T20:47:41Z",
      "author_association": "CONTRIBUTOR",
      "body": "> I think you could implement this with a single chain traversal and without too many changes if you make `CheckBlockDataAvailability` aware of the lack of undo data in the genesis block. See [furszy@927c13d](https://github.com/furszy/bitcoin-core/commit/927c13de0a7bb22d9ff280f3b122860cbdeda383) and [furszy@be23f17](https://github.com/furszy/bitcoin-core/commit/be23f17fbdcc896e25258f67bfa1840ca9825266)\r\n\r\nIt was a bit hard for me to relate the changes to the changes here but it seems to me that the major reason this is simpler is because there is no real distinction between indexes that need undo data and indexes that don't need it. This is similar to the suggestion by @mzumsande here previously: https://github.com/bitcoin/bitcoin/pull/29770#pullrequestreview-2733750397. I think the handling of it isn't ideal because it's not consistent. Image two indices are present, one (A) is caught up close to the tip and requires undo data, the other (B) was just started and hasn't synced at all but doesn't need undo data. If A is before B in the list of indexes, then the full chain will be checked for undo data because A latched the undo check to true and then B required the full chain to be checked. If B is before A in the list of indexes no blocks are checked for undo data, not even the few needed for A, because the undo check never latches to true.\r\n\r\nDoes that seem accurate to you? I didn't test this, just looked at your code. Please also note that I try to do a single traversal here in the code too, it is just broken into two different steps. To stay with the example above, my code here should check the few needed undo blocks for A in the first traversal, and then the second picks up where undo traversal ended and checks all the rest of the blocks for B without undo data. It's still a single traversal as in no block should be checked twice.\r\n\r\nIt seems fine to me to move the genesis handling from `StartIndexBackgroundSync` to `CheckBlockDataAvailability`, I just don't think that in itself simplifies the code. I can apply this but first let me know if we are alinged about the other changes first. Maybe after all this is too much premature optimization and we should just do something simpler like just check all blocks for undo data.\r\n\r\n> The test doesn’t appear to exercise the issue. I cherry-picked [155803b](https://github.com/bitcoin/bitcoin/pull/29770/commits/155803b8b4a2e7a499f5e6497f82f099ca3e6bfb) onto master, and it passes without failure. Was expecting some crash (or a not-common failure) due to the lack of undo data and the missing check for it.\r\n\r\nGood catch! There was a race condition in the test which I fixed in the latest push. With that the test fails consistently on current master for me.",
      "user": {
        "login": "fjahr",
        "id": 1322187,
        "node_id": "MDQ6VXNlcjEzMjIxODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fjahr",
        "html_url": "https://github.com/fjahr",
        "followers_url": "https://api.github.com/users/fjahr/followers",
        "following_url": "https://api.github.com/users/fjahr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fjahr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fjahr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
        "organizations_url": "https://api.github.com/users/fjahr/orgs",
        "repos_url": "https://api.github.com/users/fjahr/repos",
        "events_url": "https://api.github.com/users/fjahr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fjahr/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29770#issuecomment-2981789625",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29770"
    },
    {
      "event": "mentioned",
      "id": 18198178850,
      "node_id": "MEE_lADOABII586EIAoKzwAAAAQ8siwi",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/18198178850",
      "actor": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-06-17T20:47:42Z"
    },
    {
      "event": "subscribed",
      "id": 18198178864,
      "node_id": "SE_lADOABII586EIAoKzwAAAAQ8siww",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/18198178864",
      "actor": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-06-17T20:47:42Z"
    }
  ],
  "comments": [
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1546191291",
      "pull_request_review_id": 1971036349,
      "id": 1546191291,
      "node_id": "PRRC_kwDOABII585cKQG7",
      "diff_hunk": "@@ -160,6 +161,9 @@ class BaseIndex : public CValidationInterface\n \n     /// Get a summary of the index and its state.\n     IndexSummary GetSummary() const;\n+\n+    /// Data needed in blocks in order for the index to be able to sync\n+    virtual uint32_t NeededBlockData() const = 0;",
      "path": "src/index/base.h",
      "position": null,
      "original_position": 14,
      "commit_id": "1f1d9f2904ee166bd82905611ded51ed9de7b28a",
      "original_commit_id": "809fffdd6efe2525113597691e92751e2fd8678c",
      "in_reply_to_id": null,
      "user": {
        "login": "stickies-v",
        "id": 69010457,
        "node_id": "MDQ6VXNlcjY5MDEwNDU3",
        "avatar_url": "https://avatars.githubusercontent.com/u/69010457?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stickies-v",
        "html_url": "https://github.com/stickies-v",
        "followers_url": "https://api.github.com/users/stickies-v/followers",
        "following_url": "https://api.github.com/users/stickies-v/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stickies-v/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stickies-v/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stickies-v/subscriptions",
        "organizations_url": "https://api.github.com/users/stickies-v/orgs",
        "repos_url": "https://api.github.com/users/stickies-v/repos",
        "events_url": "https://api.github.com/users/stickies-v/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stickies-v/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "nit: `NeededBlockStatusMask` (I prefer `Required` instead of `Needed` but that's personal and doesn't really matter) better highlights that this returns a mask instead of data",
      "created_at": "2024-04-01T10:23:31Z",
      "updated_at": "2024-04-01T11:23:21Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29770#discussion_r1546191291",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1546191291"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29770"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 166,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1546191570",
      "pull_request_review_id": 1971036349,
      "id": 1546191570,
      "node_id": "PRRC_kwDOABII585cKQLS",
      "diff_hunk": "@@ -132,6 +140,39 @@ def run_test(self):\n         for i, msg in enumerate([filter_msg, stats_msg, filter_msg]):\n             self.nodes[i].assert_start_raises_init_error(extra_args=self.extra_args[i], expected_msg=msg+end_msg)\n \n+        def check_for_block(node, hash):\n+            try:\n+                self.nodes[node].getblock(hash)\n+                return True\n+            except JSONRPCException:\n+                return False",
      "path": "test/functional/feature_index_prune.py",
      "position": null,
      "original_position": 31,
      "commit_id": "1f1d9f2904ee166bd82905611ded51ed9de7b28a",
      "original_commit_id": "809fffdd6efe2525113597691e92751e2fd8678c",
      "in_reply_to_id": null,
      "user": {
        "login": "stickies-v",
        "id": 69010457,
        "node_id": "MDQ6VXNlcjY5MDEwNDU3",
        "avatar_url": "https://avatars.githubusercontent.com/u/69010457?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stickies-v",
        "html_url": "https://github.com/stickies-v",
        "followers_url": "https://api.github.com/users/stickies-v/followers",
        "following_url": "https://api.github.com/users/stickies-v/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stickies-v/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stickies-v/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stickies-v/subscriptions",
        "organizations_url": "https://api.github.com/users/stickies-v/orgs",
        "repos_url": "https://api.github.com/users/stickies-v/repos",
        "events_url": "https://api.github.com/users/stickies-v/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stickies-v/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "Already implement on L57, I think this one can be removed?",
      "created_at": "2024-04-01T10:23:58Z",
      "updated_at": "2024-04-01T11:23:21Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29770#discussion_r1546191570",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1546191570"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29770"
        }
      },
      "start_line": null,
      "original_start_line": 143,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 148,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1546229840",
      "pull_request_review_id": 1971036349,
      "id": 1546229840,
      "node_id": "PRRC_kwDOABII585cKZhQ",
      "diff_hunk": "@@ -132,6 +140,39 @@ def run_test(self):\n         for i, msg in enumerate([filter_msg, stats_msg, filter_msg]):\n             self.nodes[i].assert_start_raises_init_error(extra_args=self.extra_args[i], expected_msg=msg+end_msg)\n \n+        def check_for_block(node, hash):\n+            try:\n+                self.nodes[node].getblock(hash)\n+                return True\n+            except JSONRPCException:\n+                return False\n+\n+        self.log.info(\"fetching the missing blocks with getblockfrompeer doesn't work for block filter index and coinstatsindex\")\n+        # Only checking the first two nodes since this test takes a long time\n+        # and the third node is kind of redundant in this context\n+        for i, msg in enumerate([filter_msg, stats_msg]):\n+            self.restart_node(i, extra_args=[\"-prune=1\", \"-fastprune\"])\n+            node = self.nodes[i]\n+            prune_height = node.getblockchaininfo()[\"pruneheight\"]\n+            self.connect_nodes(i, 3)\n+            peers = node.getpeerinfo()\n+            assert_equal(len(peers), 1)\n+            peer_id = peers[0][\"id\"]\n+\n+            # 1500 is the height to where the indices were able to sync\n+            # previously\n+            for b in range(1500, prune_height):\n+                bh = node.getblockhash(b)\n+                node.getblockfrompeer(bh, peer_id)\n+                self.wait_until(lambda: check_for_block(node=i, hash=bh), timeout=10)",
      "path": "test/functional/feature_index_prune.py",
      "position": null,
      "original_position": 50,
      "commit_id": "1f1d9f2904ee166bd82905611ded51ed9de7b28a",
      "original_commit_id": "809fffdd6efe2525113597691e92751e2fd8678c",
      "in_reply_to_id": null,
      "user": {
        "login": "stickies-v",
        "id": 69010457,
        "node_id": "MDQ6VXNlcjY5MDEwNDU3",
        "avatar_url": "https://avatars.githubusercontent.com/u/69010457?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stickies-v",
        "html_url": "https://github.com/stickies-v",
        "followers_url": "https://api.github.com/users/stickies-v/followers",
        "following_url": "https://api.github.com/users/stickies-v/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stickies-v/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stickies-v/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stickies-v/subscriptions",
        "organizations_url": "https://api.github.com/users/stickies-v/orgs",
        "repos_url": "https://api.github.com/users/stickies-v/repos",
        "events_url": "https://api.github.com/users/stickies-v/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stickies-v/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "Could use batch queries to speed things up. On my machine, fetching individually takes ~12s (2 x ~6s), fetching in batch just ~3s (2 x ~1.5s). Is there a reason we need to `wait_until` `check_for_block`? Batch approach seems to work fine without it?\r\n\r\n<details>\r\n<summary>git diff on 809fffdd6e</summary>\r\n\r\n```diff\r\ndiff --git a/test/functional/feature_index_prune.py b/test/functional/feature_index_prune.py\r\nindex af6ef4c14c..e15ca7ac76 100755\r\n--- a/test/functional/feature_index_prune.py\r\n+++ b/test/functional/feature_index_prune.py\r\n@@ -5,13 +5,25 @@\r\n \"\"\"Test indices in conjunction with prune.\"\"\"\r\n import os\r\n from test_framework.authproxy import JSONRPCException\r\n-from test_framework.test_framework import BitcoinTestFramework\r\n+from test_framework.test_framework import BitcoinTestFramework, TestNode\r\n from test_framework.util import (\r\n     assert_equal,\r\n     assert_greater_than,\r\n     assert_raises_rpc_error,\r\n )\r\n \r\n+from typing import Dict, List, Any\r\n+\r\n+def send_batch_request(node: TestNode, method: str, params: List[Any]) -> List[Any]:\r\n+    \"\"\"Send batch request and parse all results\"\"\"\r\n+    data = [{\"method\": method, \"params\": p} for p in params]\r\n+    response = node.batch(data)\r\n+    result = []\r\n+    for item in response:\r\n+        assert item[\"error\"] is None, item[\"error\"]\r\n+        result.append(item[\"result\"])\r\n+\r\n+    return result\r\n \r\n class FeatureIndexPruneTest(BitcoinTestFramework):\r\n     def set_test_params(self):\r\n@@ -159,12 +171,9 @@ class FeatureIndexPruneTest(BitcoinTestFramework):\r\n             assert_equal(len(peers), 1)\r\n             peer_id = peers[0][\"id\"]\r\n \r\n-            # 1500 is the height to where the indices were able to sync\r\n-            # previously\r\n-            for b in range(1500, prune_height):\r\n-                bh = node.getblockhash(b)\r\n-                node.getblockfrompeer(bh, peer_id)\r\n-                self.wait_until(lambda: check_for_block(node=i, hash=bh), timeout=10)\r\n+            # 1500 is the height to where the indices were able to sync previously\r\n+            hashes = send_batch_request(node, \"getblockhash\", [[a] for a in range(1500, prune_height)])\r\n+            send_batch_request(node, \"getblockfrompeer\", [[bh, peer_id] for bh in hashes])\r\n \r\n             # Upon restart we expect the same errors as previously although all\r\n             # necessary blocks have been fetched. Both indices need the undo\r\n\r\n```\r\n</details>\r\n\r\n",
      "created_at": "2024-04-01T11:21:28Z",
      "updated_at": "2024-04-01T11:23:21Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29770#discussion_r1546229840",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1546229840"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29770"
        }
      },
      "start_line": null,
      "original_start_line": 164,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 167,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1676145515",
      "pull_request_review_id": 2175252505,
      "id": 1676145515,
      "node_id": "PRRC_kwDOABII585j5_Nr",
      "diff_hunk": "@@ -132,6 +140,39 @@ def run_test(self):\n         for i, msg in enumerate([filter_msg, stats_msg, filter_msg]):\n             self.nodes[i].assert_start_raises_init_error(extra_args=self.extra_args[i], expected_msg=msg+end_msg)\n \n+        def check_for_block(node, hash):\n+            try:\n+                self.nodes[node].getblock(hash)\n+                return True\n+            except JSONRPCException:\n+                return False\n+\n+        self.log.info(\"fetching the missing blocks with getblockfrompeer doesn't work for block filter index and coinstatsindex\")\n+        # Only checking the first two nodes since this test takes a long time\n+        # and the third node is kind of redundant in this context\n+        for i, msg in enumerate([filter_msg, stats_msg]):\n+            self.restart_node(i, extra_args=[\"-prune=1\", \"-fastprune\"])\n+            node = self.nodes[i]\n+            prune_height = node.getblockchaininfo()[\"pruneheight\"]\n+            self.connect_nodes(i, 3)\n+            peers = node.getpeerinfo()\n+            assert_equal(len(peers), 1)\n+            peer_id = peers[0][\"id\"]\n+\n+            # 1500 is the height to where the indices were able to sync\n+            # previously\n+            for b in range(1500, prune_height):\n+                bh = node.getblockhash(b)\n+                node.getblockfrompeer(bh, peer_id)\n+                self.wait_until(lambda: check_for_block(node=i, hash=bh), timeout=10)",
      "path": "test/functional/feature_index_prune.py",
      "position": null,
      "original_position": 50,
      "commit_id": "1f1d9f2904ee166bd82905611ded51ed9de7b28a",
      "original_commit_id": "809fffdd6efe2525113597691e92751e2fd8678c",
      "in_reply_to_id": 1546229840,
      "user": {
        "login": "fjahr",
        "id": 1322187,
        "node_id": "MDQ6VXNlcjEzMjIxODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fjahr",
        "html_url": "https://github.com/fjahr",
        "followers_url": "https://api.github.com/users/fjahr/followers",
        "following_url": "https://api.github.com/users/fjahr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fjahr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fjahr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
        "organizations_url": "https://api.github.com/users/fjahr/orgs",
        "repos_url": "https://api.github.com/users/fjahr/repos",
        "events_url": "https://api.github.com/users/fjahr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fjahr/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "Taken with minor edit, thanks!",
      "created_at": "2024-07-12T16:01:45Z",
      "updated_at": "2024-07-12T16:01:45Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29770#discussion_r1676145515",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1676145515"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29770"
        }
      },
      "start_line": null,
      "original_start_line": 164,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 167,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1676145787",
      "pull_request_review_id": 2175252897,
      "id": 1676145787,
      "node_id": "PRRC_kwDOABII585j5_R7",
      "diff_hunk": "@@ -132,6 +140,39 @@ def run_test(self):\n         for i, msg in enumerate([filter_msg, stats_msg, filter_msg]):\n             self.nodes[i].assert_start_raises_init_error(extra_args=self.extra_args[i], expected_msg=msg+end_msg)\n \n+        def check_for_block(node, hash):\n+            try:\n+                self.nodes[node].getblock(hash)\n+                return True\n+            except JSONRPCException:\n+                return False",
      "path": "test/functional/feature_index_prune.py",
      "position": null,
      "original_position": 31,
      "commit_id": "1f1d9f2904ee166bd82905611ded51ed9de7b28a",
      "original_commit_id": "809fffdd6efe2525113597691e92751e2fd8678c",
      "in_reply_to_id": 1546191570,
      "user": {
        "login": "fjahr",
        "id": 1322187,
        "node_id": "MDQ6VXNlcjEzMjIxODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fjahr",
        "html_url": "https://github.com/fjahr",
        "followers_url": "https://api.github.com/users/fjahr/followers",
        "following_url": "https://api.github.com/users/fjahr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fjahr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fjahr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
        "organizations_url": "https://api.github.com/users/fjahr/orgs",
        "repos_url": "https://api.github.com/users/fjahr/repos",
        "events_url": "https://api.github.com/users/fjahr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fjahr/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "done",
      "created_at": "2024-07-12T16:01:59Z",
      "updated_at": "2024-07-12T16:02:00Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29770#discussion_r1676145787",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1676145787"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29770"
        }
      },
      "start_line": null,
      "original_start_line": 143,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 148,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1676145867",
      "pull_request_review_id": 2175253000,
      "id": 1676145867,
      "node_id": "PRRC_kwDOABII585j5_TL",
      "diff_hunk": "@@ -160,6 +161,9 @@ class BaseIndex : public CValidationInterface\n \n     /// Get a summary of the index and its state.\n     IndexSummary GetSummary() const;\n+\n+    /// Data needed in blocks in order for the index to be able to sync\n+    virtual uint32_t NeededBlockData() const = 0;",
      "path": "src/index/base.h",
      "position": null,
      "original_position": 14,
      "commit_id": "1f1d9f2904ee166bd82905611ded51ed9de7b28a",
      "original_commit_id": "809fffdd6efe2525113597691e92751e2fd8678c",
      "in_reply_to_id": 1546191291,
      "user": {
        "login": "fjahr",
        "id": 1322187,
        "node_id": "MDQ6VXNlcjEzMjIxODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fjahr",
        "html_url": "https://github.com/fjahr",
        "followers_url": "https://api.github.com/users/fjahr/followers",
        "following_url": "https://api.github.com/users/fjahr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fjahr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fjahr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
        "organizations_url": "https://api.github.com/users/fjahr/orgs",
        "repos_url": "https://api.github.com/users/fjahr/repos",
        "events_url": "https://api.github.com/users/fjahr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fjahr/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "Renamed",
      "created_at": "2024-07-12T16:02:03Z",
      "updated_at": "2024-07-12T16:02:03Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29770#discussion_r1676145867",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1676145867"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29770"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 166,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1677451285",
      "pull_request_review_id": 2177093632,
      "id": 1677451285,
      "node_id": "PRRC_kwDOABII585j--AV",
      "diff_hunk": "@@ -160,6 +161,9 @@ class BaseIndex : public CValidationInterface\n \n     /// Get a summary of the index and its state.\n     IndexSummary GetSummary() const;\n+\n+    /// Data needed in blocks in order for the index to be able to sync\n+    virtual uint32_t RequiredBlockStatusMask() const = 0;",
      "path": "src/index/base.h",
      "position": null,
      "original_position": 14,
      "commit_id": "1f1d9f2904ee166bd82905611ded51ed9de7b28a",
      "original_commit_id": "245c09bc8571d6079a8a8f1c4db993be04214157",
      "in_reply_to_id": null,
      "user": {
        "login": "maflcko",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/maflcko",
        "html_url": "https://github.com/maflcko",
        "followers_url": "https://api.github.com/users/maflcko/followers",
        "following_url": "https://api.github.com/users/maflcko/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/maflcko/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/maflcko/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/maflcko/subscriptions",
        "organizations_url": "https://api.github.com/users/maflcko/orgs",
        "repos_url": "https://api.github.com/users/maflcko/repos",
        "events_url": "https://api.github.com/users/maflcko/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/maflcko/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "unrelated: I wonder if at some point it could make sense to use a named type for the block status mask.\r\n\r\nSomething like `using BlockStatusMask = std::underlying_type_t<BlockStatus>;`",
      "created_at": "2024-07-15T08:08:15Z",
      "updated_at": "2024-07-15T08:09:09Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29770#discussion_r1677451285",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1677451285"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29770"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 168,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1677452041",
      "pull_request_review_id": 2177093632,
      "id": 1677452041,
      "node_id": "PRRC_kwDOABII585j--MJ",
      "diff_hunk": "@@ -613,10 +613,12 @@ const CBlockIndex* BlockManager::GetFirstBlock(const CBlockIndex& upper_block, u\n     return last_block;\n }\n \n-bool BlockManager::CheckBlockDataAvailability(const CBlockIndex& upper_block, const CBlockIndex& lower_block)\n+bool BlockManager::CheckBlockDataAvailability(const CBlockIndex& upper_block, const CBlockIndex& lower_block, uint32_t status_mask)\n {\n-    if (!(upper_block.nStatus & BLOCK_HAVE_DATA)) return false;\n-    return GetFirstBlock(upper_block, BLOCK_HAVE_DATA, &lower_block) == &lower_block;\n+    if (!(upper_block.nStatus & status_mask)) return false;\n+    LogPrintf(\"This is result: %s\\n\", GetFirstBlock(upper_block, status_mask, &lower_block)->nHeight);\n+    LogPrintf(\"This is goal: %s\\n\", lower_block.nHeight);",
      "path": "src/node/blockstorage.cpp",
      "position": null,
      "original_position": 11,
      "commit_id": "1f1d9f2904ee166bd82905611ded51ed9de7b28a",
      "original_commit_id": "05fb9aef47e72090256e9f92c5916047ad93c4fe",
      "in_reply_to_id": null,
      "user": {
        "login": "maflcko",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/maflcko",
        "html_url": "https://github.com/maflcko",
        "followers_url": "https://api.github.com/users/maflcko/followers",
        "following_url": "https://api.github.com/users/maflcko/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/maflcko/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/maflcko/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/maflcko/subscriptions",
        "organizations_url": "https://api.github.com/users/maflcko/orgs",
        "repos_url": "https://api.github.com/users/maflcko/repos",
        "events_url": "https://api.github.com/users/maflcko/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/maflcko/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "Looks like a leftover debug print?",
      "created_at": "2024-07-15T08:08:59Z",
      "updated_at": "2024-07-15T08:09:09Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29770#discussion_r1677452041",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1677452041"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29770"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 620,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1677672363",
      "pull_request_review_id": 2177454252,
      "id": 1677672363,
      "node_id": "PRRC_kwDOABII585j_z-r",
      "diff_hunk": "@@ -613,10 +613,12 @@ const CBlockIndex* BlockManager::GetFirstBlock(const CBlockIndex& upper_block, u\n     return last_block;\n }\n \n-bool BlockManager::CheckBlockDataAvailability(const CBlockIndex& upper_block, const CBlockIndex& lower_block)\n+bool BlockManager::CheckBlockDataAvailability(const CBlockIndex& upper_block, const CBlockIndex& lower_block, uint32_t status_mask)\n {\n-    if (!(upper_block.nStatus & BLOCK_HAVE_DATA)) return false;\n-    return GetFirstBlock(upper_block, BLOCK_HAVE_DATA, &lower_block) == &lower_block;\n+    if (!(upper_block.nStatus & status_mask)) return false;\n+    LogPrintf(\"This is result: %s\\n\", GetFirstBlock(upper_block, status_mask, &lower_block)->nHeight);\n+    LogPrintf(\"This is goal: %s\\n\", lower_block.nHeight);",
      "path": "src/node/blockstorage.cpp",
      "position": null,
      "original_position": 11,
      "commit_id": "1f1d9f2904ee166bd82905611ded51ed9de7b28a",
      "original_commit_id": "05fb9aef47e72090256e9f92c5916047ad93c4fe",
      "in_reply_to_id": 1677452041,
      "user": {
        "login": "fjahr",
        "id": 1322187,
        "node_id": "MDQ6VXNlcjEzMjIxODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fjahr",
        "html_url": "https://github.com/fjahr",
        "followers_url": "https://api.github.com/users/fjahr/followers",
        "following_url": "https://api.github.com/users/fjahr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fjahr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fjahr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
        "organizations_url": "https://api.github.com/users/fjahr/orgs",
        "repos_url": "https://api.github.com/users/fjahr/repos",
        "events_url": "https://api.github.com/users/fjahr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fjahr/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "yepp, fixed, thanks!",
      "created_at": "2024-07-15T11:23:18Z",
      "updated_at": "2024-07-15T11:23:18Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29770#discussion_r1677672363",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1677672363"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29770"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 620,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1688294883",
      "pull_request_review_id": 2194366605,
      "id": 1688294883,
      "node_id": "PRRC_kwDOABII585koVXj",
      "diff_hunk": "@@ -132,6 +154,29 @@ def run_test(self):\n         for i, msg in enumerate([filter_msg, stats_msg, filter_msg]):\n             self.nodes[i].assert_start_raises_init_error(extra_args=self.extra_args[i], expected_msg=msg+end_msg)\n \n+        self.log.info(\"fetching the missing blocks with getblockfrompeer doesn't work for block filter index and coinstatsindex\")",
      "path": "test/functional/feature_index_prune.py",
      "position": 55,
      "original_position": 47,
      "commit_id": "1f1d9f2904ee166bd82905611ded51ed9de7b28a",
      "original_commit_id": "adabfbc23700056e5bd22b673c3078aa49ad83ea",
      "in_reply_to_id": null,
      "user": {
        "login": "Sjors",
        "id": 10217,
        "node_id": "MDQ6VXNlcjEwMjE3",
        "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Sjors",
        "html_url": "https://github.com/Sjors",
        "followers_url": "https://api.github.com/users/Sjors/followers",
        "following_url": "https://api.github.com/users/Sjors/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Sjors/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Sjors/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
        "organizations_url": "https://api.github.com/users/Sjors/orgs",
        "repos_url": "https://api.github.com/users/Sjors/repos",
        "events_url": "https://api.github.com/users/Sjors/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Sjors/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "adabfbc23700056e5bd22b673c3078aa49ad83ea: it would be useful to have an example where `getblockfrompeer` _does_ work, i.e. an index that doesn't need undo data.",
      "created_at": "2024-07-23T15:43:01Z",
      "updated_at": "2024-07-23T20:55:04Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29770#discussion_r1688294883",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1688294883"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29770"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 161,
      "original_line": 161,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2020166642",
      "pull_request_review_id": 2727913904,
      "id": 2020166642,
      "node_id": "PRRC_kwDOABII5854aUvy",
      "diff_hunk": "@@ -132,6 +154,29 @@ def run_test(self):\n         for i, msg in enumerate([filter_msg, stats_msg, filter_msg]):\n             self.nodes[i].assert_start_raises_init_error(extra_args=self.extra_args[i], expected_msg=msg+end_msg)\n \n+        self.log.info(\"fetching the missing blocks with getblockfrompeer doesn't work for block filter index and coinstatsindex\")",
      "path": "test/functional/feature_index_prune.py",
      "position": 55,
      "original_position": 47,
      "commit_id": "1f1d9f2904ee166bd82905611ded51ed9de7b28a",
      "original_commit_id": "adabfbc23700056e5bd22b673c3078aa49ad83ea",
      "in_reply_to_id": 1688294883,
      "user": {
        "login": "fjahr",
        "id": 1322187,
        "node_id": "MDQ6VXNlcjEzMjIxODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fjahr",
        "html_url": "https://github.com/fjahr",
        "followers_url": "https://api.github.com/users/fjahr/followers",
        "following_url": "https://api.github.com/users/fjahr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fjahr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fjahr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
        "organizations_url": "https://api.github.com/users/fjahr/orgs",
        "repos_url": "https://api.github.com/users/fjahr/repos",
        "events_url": "https://api.github.com/users/fjahr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fjahr/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "That would be nice but I'm not sure how to do it. The one candidate index we have for that is `txindex` but we wholly disable that in the context of pruning because what it is used for is incompatible with pruning.",
      "created_at": "2025-03-30T14:00:43Z",
      "updated_at": "2025-03-30T14:00:43Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29770#discussion_r2020166642",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2020166642"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29770"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 161,
      "original_line": 161,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2023501115",
      "pull_request_review_id": 2733750397,
      "id": 2023501115,
      "node_id": "PRRC_kwDOABII5854nC07",
      "diff_hunk": "@@ -2113,16 +2116,24 @@ bool StartIndexBackgroundSync(NodeContext& node)\n         if (!indexes_start_block || !pindex || pindex->nHeight < indexes_start_block.value()->nHeight) {\n             indexes_start_block = pindex;\n             older_index_name = summary.name;\n-            if (!pindex) break; // Starting from genesis so no need to look for earlier block.\n+            // Starting from genesis so no need to look for earlier block.\n+            if (!pindex) break;\n+            // Check if we need to have undo data available to sync as well.\n+            if (index->RequiresUndoData()) {\n+                older_needed_block_data |= BLOCK_HAVE_UNDO;\n+            }\n         }\n     };\n \n     // Verify all blocks needed to sync to current tip are present.\n-    if (indexes_start_block) {\n+    if (indexes_start_block.has_value()) {\n         LOCK(::cs_main);\n-        const CBlockIndex* start_block = *indexes_start_block;\n-        if (!start_block) start_block = chainman.ActiveChain().Genesis();\n-        if (!chainman.m_blockman.CheckBlockDataAvailability(*index_chain.Tip(), *Assert(start_block))) {\n+        const CBlockIndex* start_block = indexes_start_block.value();\n+        // We only check down to the first block instead of Genesis because\n+        // Genesis can not have undo data so it is ok that it doesn't have\n+        // all the data that the index might need.\n+        if (start_block->nHeight == 0) start_block = chainman.ActiveChain()[1];\n+        if (!chainman.m_blockman.CheckBlockDataAvailability(*index_chain.Tip(), *Assert(start_block), older_needed_block_data)) {",
      "path": "src/init.cpp",
      "position": null,
      "original_position": 36,
      "commit_id": "1f1d9f2904ee166bd82905611ded51ed9de7b28a",
      "original_commit_id": "9f99000655faa532717885e73b60db0bd8270230",
      "in_reply_to_id": null,
      "user": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "We may not have a block at height one:\r\nThe assert in this line can be triggered by starting a fresh regtest node (empty datadir, no index), stopping it and restarting it with an index.\r\n\r\nInteresting that no test catches this, maybe we should add one.",
      "created_at": "2025-04-01T18:47:58Z",
      "updated_at": "2025-04-01T19:54:24Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29770#discussion_r2023501115",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2023501115"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29770"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 2136,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2025508248",
      "pull_request_review_id": 2737440508,
      "id": 2025508248,
      "node_id": "PRRC_kwDOABII5854us2Y",
      "diff_hunk": "@@ -2113,16 +2116,24 @@ bool StartIndexBackgroundSync(NodeContext& node)\n         if (!indexes_start_block || !pindex || pindex->nHeight < indexes_start_block.value()->nHeight) {\n             indexes_start_block = pindex;\n             older_index_name = summary.name;\n-            if (!pindex) break; // Starting from genesis so no need to look for earlier block.\n+            // Starting from genesis so no need to look for earlier block.\n+            if (!pindex) break;\n+            // Check if we need to have undo data available to sync as well.\n+            if (index->RequiresUndoData()) {\n+                older_needed_block_data |= BLOCK_HAVE_UNDO;",
      "path": "src/init.cpp",
      "position": null,
      "original_position": 19,
      "commit_id": "1f1d9f2904ee166bd82905611ded51ed9de7b28a",
      "original_commit_id": "9f99000655faa532717885e73b60db0bd8270230",
      "in_reply_to_id": null,
      "user": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "The `RequiresUndoData()` check needs to be placed before the breaking point.\r\nThe first index could require sync from genesis but not require undo data, which would cause all other indexes to return early and never set the `BLOCK_HAVE_UNDO` flag.",
      "created_at": "2025-04-02T20:06:38Z",
      "updated_at": "2025-04-02T20:39:41Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29770#discussion_r2025508248",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2025508248"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29770"
        }
      },
      "start_line": null,
      "original_start_line": 2119,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 2123,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2025545858",
      "pull_request_review_id": 2737440508,
      "id": 2025545858,
      "node_id": "PRRC_kwDOABII5854u2CC",
      "diff_hunk": "@@ -2113,16 +2116,24 @@ bool StartIndexBackgroundSync(NodeContext& node)\n         if (!indexes_start_block || !pindex || pindex->nHeight < indexes_start_block.value()->nHeight) {\n             indexes_start_block = pindex;\n             older_index_name = summary.name;\n-            if (!pindex) break; // Starting from genesis so no need to look for earlier block.\n+            // Starting from genesis so no need to look for earlier block.\n+            if (!pindex) break;\n+            // Check if we need to have undo data available to sync as well.\n+            if (index->RequiresUndoData()) {\n+                older_needed_block_data |= BLOCK_HAVE_UNDO;\n+            }\n         }\n     };\n \n     // Verify all blocks needed to sync to current tip are present.\n-    if (indexes_start_block) {\n+    if (indexes_start_block.has_value()) {\n         LOCK(::cs_main);\n-        const CBlockIndex* start_block = *indexes_start_block;\n-        if (!start_block) start_block = chainman.ActiveChain().Genesis();\n-        if (!chainman.m_blockman.CheckBlockDataAvailability(*index_chain.Tip(), *Assert(start_block))) {\n+        const CBlockIndex* start_block = indexes_start_block.value();\n+        // We only check down to the first block instead of Genesis because\n+        // Genesis can not have undo data so it is ok that it doesn't have\n+        // all the data that the index might need.\n+        if (start_block->nHeight == 0) start_block = chainman.ActiveChain()[1];",
      "path": "src/init.cpp",
      "position": null,
      "original_position": 35,
      "commit_id": "1f1d9f2904ee166bd82905611ded51ed9de7b28a",
      "original_commit_id": "9f99000655faa532717885e73b60db0bd8270230",
      "in_reply_to_id": null,
      "user": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "There is an edge case here that can lead to a crash when the node does not have the genesis block data.\r\n\r\nImagine a pruned node that re-downloaded its chain via `getblockfrompeer()`. Since the genesis block cannot be re-downloaded from the wire (because it is discarded after being received at the p2p layer — material for another discussion), the node could be having the entire chain except for the genesis block data.\r\nThen, as this code skips the genesis block, the index will crash internally when it tries to read it during sync.\r\n\r\nNote: I'm not referring to the undo data here, just the regular block data.\r\nWriting a test case for this should be straightforward.",
      "created_at": "2025-04-02T20:27:53Z",
      "updated_at": "2025-04-03T00:52:29Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29770#discussion_r2025545858",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2025545858"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29770"
        }
      },
      "start_line": null,
      "original_start_line": 2132,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 2135,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2025547943",
      "pull_request_review_id": 2737440508,
      "id": 2025547943,
      "node_id": "PRRC_kwDOABII5854u2in",
      "diff_hunk": "@@ -82,6 +82,9 @@ class BlockFilterIndex final : public BaseIndex\n     /** Get a range of filter hashes between two heights on a chain. */\n     bool LookupFilterHashRange(int start_height, const CBlockIndex* stop_index,\n                                std::vector<uint256>& hashes_out) const;\n+\n+    /** Undo data is needed in order for the index to be able to sync */\n+    bool RequiresUndoData() const override {return true;};",
      "path": "src/index/blockfilterindex.h",
      "position": null,
      "original_position": 6,
      "commit_id": "1f1d9f2904ee166bd82905611ded51ed9de7b28a",
      "original_commit_id": "9f99000655faa532717885e73b60db0bd8270230",
      "in_reply_to_id": null,
      "user": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "extra semicolon at the end (on all the `RequiresUndoData()`)",
      "created_at": "2025-04-02T20:29:35Z",
      "updated_at": "2025-04-02T20:39:41Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29770#discussion_r2025547943",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2025547943"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29770"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 87,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2026808102",
      "pull_request_review_id": 2739526785,
      "id": 2026808102,
      "node_id": "PRRC_kwDOABII5854zqMm",
      "diff_hunk": "@@ -2113,16 +2116,24 @@ bool StartIndexBackgroundSync(NodeContext& node)\n         if (!indexes_start_block || !pindex || pindex->nHeight < indexes_start_block.value()->nHeight) {\n             indexes_start_block = pindex;\n             older_index_name = summary.name;\n-            if (!pindex) break; // Starting from genesis so no need to look for earlier block.\n+            // Starting from genesis so no need to look for earlier block.\n+            if (!pindex) break;\n+            // Check if we need to have undo data available to sync as well.\n+            if (index->RequiresUndoData()) {\n+                older_needed_block_data |= BLOCK_HAVE_UNDO;\n+            }\n         }\n     };\n \n     // Verify all blocks needed to sync to current tip are present.\n-    if (indexes_start_block) {\n+    if (indexes_start_block.has_value()) {\n         LOCK(::cs_main);\n-        const CBlockIndex* start_block = *indexes_start_block;\n-        if (!start_block) start_block = chainman.ActiveChain().Genesis();\n-        if (!chainman.m_blockman.CheckBlockDataAvailability(*index_chain.Tip(), *Assert(start_block))) {\n+        const CBlockIndex* start_block = indexes_start_block.value();\n+        // We only check down to the first block instead of Genesis because\n+        // Genesis can not have undo data so it is ok that it doesn't have\n+        // all the data that the index might need.\n+        if (start_block->nHeight == 0) start_block = chainman.ActiveChain()[1];",
      "path": "src/init.cpp",
      "position": null,
      "original_position": 35,
      "commit_id": "1f1d9f2904ee166bd82905611ded51ed9de7b28a",
      "original_commit_id": "9f99000655faa532717885e73b60db0bd8270230",
      "in_reply_to_id": 2025545858,
      "user": {
        "login": "fjahr",
        "id": 1322187,
        "node_id": "MDQ6VXNlcjEzMjIxODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fjahr",
        "html_url": "https://github.com/fjahr",
        "followers_url": "https://api.github.com/users/fjahr/followers",
        "following_url": "https://api.github.com/users/fjahr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fjahr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fjahr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
        "organizations_url": "https://api.github.com/users/fjahr/orgs",
        "repos_url": "https://api.github.com/users/fjahr/repos",
        "events_url": "https://api.github.com/users/fjahr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fjahr/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "Do we really receive the genesis block from the p2p layer? I thought we just load it via `LoadGenesisBlock()`. I just started a new node with no internet connectivity and used all the typical rpc on the genesis block (for example `getblock 000000000019d6689c085ae165831e934ff763ae46a2a6c172b3f1b60a8ce26f 2`) and they all worked, so it doesn't seem like the data availability of the genesis block relies on p2p.",
      "created_at": "2025-04-03T11:30:53Z",
      "updated_at": "2025-04-03T11:30:53Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29770#discussion_r2026808102",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2026808102"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29770"
        }
      },
      "start_line": null,
      "original_start_line": 2132,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 2135,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2027538151",
      "pull_request_review_id": 2740794071,
      "id": 2027538151,
      "node_id": "PRRC_kwDOABII58542cbn",
      "diff_hunk": "@@ -2113,16 +2116,24 @@ bool StartIndexBackgroundSync(NodeContext& node)\n         if (!indexes_start_block || !pindex || pindex->nHeight < indexes_start_block.value()->nHeight) {\n             indexes_start_block = pindex;\n             older_index_name = summary.name;\n-            if (!pindex) break; // Starting from genesis so no need to look for earlier block.\n+            // Starting from genesis so no need to look for earlier block.\n+            if (!pindex) break;\n+            // Check if we need to have undo data available to sync as well.\n+            if (index->RequiresUndoData()) {\n+                older_needed_block_data |= BLOCK_HAVE_UNDO;",
      "path": "src/init.cpp",
      "position": null,
      "original_position": 19,
      "commit_id": "1f1d9f2904ee166bd82905611ded51ed9de7b28a",
      "original_commit_id": "9f99000655faa532717885e73b60db0bd8270230",
      "in_reply_to_id": 2025508248,
      "user": {
        "login": "fjahr",
        "id": 1322187,
        "node_id": "MDQ6VXNlcjEzMjIxODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fjahr",
        "html_url": "https://github.com/fjahr",
        "followers_url": "https://api.github.com/users/fjahr/followers",
        "following_url": "https://api.github.com/users/fjahr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fjahr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fjahr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
        "organizations_url": "https://api.github.com/users/fjahr/orgs",
        "repos_url": "https://api.github.com/users/fjahr/repos",
        "events_url": "https://api.github.com/users/fjahr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fjahr/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "Good catch! Fixed.",
      "created_at": "2025-04-03T18:29:11Z",
      "updated_at": "2025-04-03T18:29:12Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29770#discussion_r2027538151",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2027538151"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29770"
        }
      },
      "start_line": null,
      "original_start_line": 2119,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 2123,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2027538476",
      "pull_request_review_id": 2740794638,
      "id": 2027538476,
      "node_id": "PRRC_kwDOABII58542cgs",
      "diff_hunk": "@@ -82,6 +82,9 @@ class BlockFilterIndex final : public BaseIndex\n     /** Get a range of filter hashes between two heights on a chain. */\n     bool LookupFilterHashRange(int start_height, const CBlockIndex* stop_index,\n                                std::vector<uint256>& hashes_out) const;\n+\n+    /** Undo data is needed in order for the index to be able to sync */\n+    bool RequiresUndoData() const override {return true;};",
      "path": "src/index/blockfilterindex.h",
      "position": null,
      "original_position": 6,
      "commit_id": "1f1d9f2904ee166bd82905611ded51ed9de7b28a",
      "original_commit_id": "9f99000655faa532717885e73b60db0bd8270230",
      "in_reply_to_id": 2025547943,
      "user": {
        "login": "fjahr",
        "id": 1322187,
        "node_id": "MDQ6VXNlcjEzMjIxODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fjahr",
        "html_url": "https://github.com/fjahr",
        "followers_url": "https://api.github.com/users/fjahr/followers",
        "following_url": "https://api.github.com/users/fjahr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fjahr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fjahr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
        "organizations_url": "https://api.github.com/users/fjahr/orgs",
        "repos_url": "https://api.github.com/users/fjahr/repos",
        "events_url": "https://api.github.com/users/fjahr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fjahr/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "Fixed",
      "created_at": "2025-04-03T18:29:28Z",
      "updated_at": "2025-04-03T18:29:28Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29770#discussion_r2027538476",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2027538476"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29770"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 87,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2027541367",
      "pull_request_review_id": 2740799458,
      "id": 2027541367,
      "node_id": "PRRC_kwDOABII58542dN3",
      "diff_hunk": "@@ -2113,16 +2116,24 @@ bool StartIndexBackgroundSync(NodeContext& node)\n         if (!indexes_start_block || !pindex || pindex->nHeight < indexes_start_block.value()->nHeight) {\n             indexes_start_block = pindex;\n             older_index_name = summary.name;\n-            if (!pindex) break; // Starting from genesis so no need to look for earlier block.\n+            // Starting from genesis so no need to look for earlier block.\n+            if (!pindex) break;\n+            // Check if we need to have undo data available to sync as well.\n+            if (index->RequiresUndoData()) {\n+                older_needed_block_data |= BLOCK_HAVE_UNDO;\n+            }\n         }\n     };\n \n     // Verify all blocks needed to sync to current tip are present.\n-    if (indexes_start_block) {\n+    if (indexes_start_block.has_value()) {\n         LOCK(::cs_main);\n-        const CBlockIndex* start_block = *indexes_start_block;\n-        if (!start_block) start_block = chainman.ActiveChain().Genesis();\n-        if (!chainman.m_blockman.CheckBlockDataAvailability(*index_chain.Tip(), *Assert(start_block))) {\n+        const CBlockIndex* start_block = indexes_start_block.value();\n+        // We only check down to the first block instead of Genesis because\n+        // Genesis can not have undo data so it is ok that it doesn't have\n+        // all the data that the index might need.\n+        if (start_block->nHeight == 0) start_block = chainman.ActiveChain()[1];\n+        if (!chainman.m_blockman.CheckBlockDataAvailability(*index_chain.Tip(), *Assert(start_block), older_needed_block_data)) {",
      "path": "src/init.cpp",
      "position": null,
      "original_position": 36,
      "commit_id": "1f1d9f2904ee166bd82905611ded51ed9de7b28a",
      "original_commit_id": "9f99000655faa532717885e73b60db0bd8270230",
      "in_reply_to_id": 2023501115,
      "user": {
        "login": "fjahr",
        "id": 1322187,
        "node_id": "MDQ6VXNlcjEzMjIxODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fjahr",
        "html_url": "https://github.com/fjahr",
        "followers_url": "https://api.github.com/users/fjahr/followers",
        "following_url": "https://api.github.com/users/fjahr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fjahr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fjahr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
        "organizations_url": "https://api.github.com/users/fjahr/orgs",
        "repos_url": "https://api.github.com/users/fjahr/repos",
        "events_url": "https://api.github.com/users/fjahr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fjahr/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "Good catch! I fixed this and refactored the function a little more while I was at it. I think the new structure is a bit easier to understand and reason about. I also added a test that would have caught this. Open to add more startup options there too.",
      "created_at": "2025-04-03T18:31:43Z",
      "updated_at": "2025-04-03T18:31:43Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29770#discussion_r2027541367",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2027541367"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29770"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 2136,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2029126932",
      "pull_request_review_id": 2743593603,
      "id": 2029126932,
      "node_id": "PRRC_kwDOABII58548gUU",
      "diff_hunk": "@@ -2113,16 +2116,24 @@ bool StartIndexBackgroundSync(NodeContext& node)\n         if (!indexes_start_block || !pindex || pindex->nHeight < indexes_start_block.value()->nHeight) {\n             indexes_start_block = pindex;\n             older_index_name = summary.name;\n-            if (!pindex) break; // Starting from genesis so no need to look for earlier block.\n+            // Starting from genesis so no need to look for earlier block.\n+            if (!pindex) break;\n+            // Check if we need to have undo data available to sync as well.\n+            if (index->RequiresUndoData()) {\n+                older_needed_block_data |= BLOCK_HAVE_UNDO;\n+            }\n         }\n     };\n \n     // Verify all blocks needed to sync to current tip are present.\n-    if (indexes_start_block) {\n+    if (indexes_start_block.has_value()) {\n         LOCK(::cs_main);\n-        const CBlockIndex* start_block = *indexes_start_block;\n-        if (!start_block) start_block = chainman.ActiveChain().Genesis();\n-        if (!chainman.m_blockman.CheckBlockDataAvailability(*index_chain.Tip(), *Assert(start_block))) {\n+        const CBlockIndex* start_block = indexes_start_block.value();\n+        // We only check down to the first block instead of Genesis because\n+        // Genesis can not have undo data so it is ok that it doesn't have\n+        // all the data that the index might need.\n+        if (start_block->nHeight == 0) start_block = chainman.ActiveChain()[1];",
      "path": "src/init.cpp",
      "position": null,
      "original_position": 35,
      "commit_id": "1f1d9f2904ee166bd82905611ded51ed9de7b28a",
      "original_commit_id": "9f99000655faa532717885e73b60db0bd8270230",
      "in_reply_to_id": 2025545858,
      "user": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "> Do we really receive the genesis block from the p2p layer? I thought we just load it via `LoadGenesisBlock()`. I just started a new node with no internet connectivity and used all the typical rpc on the genesis block (for example `getblock 000000000019d6689c085ae165831e934ff763ae46a2a6c172b3f1b60a8ce26f 2`) and they all worked, so it doesn't seem like the data availability of the genesis block relies on p2p.\r\n\r\nThe scenario I described above is during pruning + manual block re-download. `LoadGenesisBlock()` writes the genesis block only once to disk. It does not write it if the block index is in the chain state.\r\n\r\nDuring pruning, we erase all block up to a certain point by deleting entire block files but we don't delete the associated block index in the chain state. This means we also delete the genesis block data during the initial pruning but we keep the block index so `LoadGenesisBlock()` will not re-write the genesis block to disk during next startup (you can verify this by calling `getblock(genesis_hash)` in a prune node).\r\n\r\nNow, the scenario I described: The user might decide to re-download all the prune blocks manually, by calling `getblockfrompeer()` over all the chain state (including the genesis block, which as I described above, it will not be automatically re-written to disk after the initial pruning).\r\nThis will make the node recover the entire chain except for the genesis block. This is because our P2P layer ignores the genesis block when it receives it from the wire (due to the anti-DoS check, more precisely it retrieves `too-little-chainwork`).\r\n\r\nSo, during any future startup, the node will have all the blocks content except for the genesis block content. Which will make the index crash internally because you are skipping the genesis block data availability check during init.",
      "created_at": "2025-04-04T16:36:41Z",
      "updated_at": "2025-04-04T16:36:41Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29770#discussion_r2029126932",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2029126932"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29770"
        }
      },
      "start_line": null,
      "original_start_line": 2132,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 2135,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2118296430",
      "pull_request_review_id": 2884608125,
      "id": 2118296430,
      "node_id": "PRRC_kwDOABII585-QqNu",
      "diff_hunk": "@@ -2113,16 +2116,24 @@ bool StartIndexBackgroundSync(NodeContext& node)\n         if (!indexes_start_block || !pindex || pindex->nHeight < indexes_start_block.value()->nHeight) {\n             indexes_start_block = pindex;\n             older_index_name = summary.name;\n-            if (!pindex) break; // Starting from genesis so no need to look for earlier block.\n+            // Starting from genesis so no need to look for earlier block.\n+            if (!pindex) break;\n+            // Check if we need to have undo data available to sync as well.\n+            if (index->RequiresUndoData()) {\n+                older_needed_block_data |= BLOCK_HAVE_UNDO;\n+            }\n         }\n     };\n \n     // Verify all blocks needed to sync to current tip are present.\n-    if (indexes_start_block) {\n+    if (indexes_start_block.has_value()) {\n         LOCK(::cs_main);\n-        const CBlockIndex* start_block = *indexes_start_block;\n-        if (!start_block) start_block = chainman.ActiveChain().Genesis();\n-        if (!chainman.m_blockman.CheckBlockDataAvailability(*index_chain.Tip(), *Assert(start_block))) {\n+        const CBlockIndex* start_block = indexes_start_block.value();\n+        // We only check down to the first block instead of Genesis because\n+        // Genesis can not have undo data so it is ok that it doesn't have\n+        // all the data that the index might need.\n+        if (start_block->nHeight == 0) start_block = chainman.ActiveChain()[1];",
      "path": "src/init.cpp",
      "position": null,
      "original_position": 35,
      "commit_id": "1f1d9f2904ee166bd82905611ded51ed9de7b28a",
      "original_commit_id": "9f99000655faa532717885e73b60db0bd8270230",
      "in_reply_to_id": 2025545858,
      "user": {
        "login": "fjahr",
        "id": 1322187,
        "node_id": "MDQ6VXNlcjEzMjIxODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fjahr",
        "html_url": "https://github.com/fjahr",
        "followers_url": "https://api.github.com/users/fjahr/followers",
        "following_url": "https://api.github.com/users/fjahr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fjahr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fjahr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
        "organizations_url": "https://api.github.com/users/fjahr/orgs",
        "repos_url": "https://api.github.com/users/fjahr/repos",
        "events_url": "https://api.github.com/users/fjahr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fjahr/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "Ok, I have addressed this by pulling the handing of this special case up and doing a check for block data of genesis if that is what's needed by an index that requires undo data.",
      "created_at": "2025-05-31T21:51:46Z",
      "updated_at": "2025-05-31T21:51:46Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29770#discussion_r2118296430",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2118296430"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29770"
        }
      },
      "start_line": null,
      "original_start_line": 2132,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 2135,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2121073979",
      "pull_request_review_id": 2888284022,
      "id": 2121073979,
      "node_id": "PRRC_kwDOABII585-bQU7",
      "diff_hunk": "@@ -2058,42 +2058,67 @@ bool AppInitMain(NodeContext& node, interfaces::BlockAndHeaderTipInfo* tip_info)\n \n bool StartIndexBackgroundSync(NodeContext& node)\n {\n-    // Find the oldest block among all indexes.\n-    // This block is used to verify that we have the required blocks' data stored on disk,\n-    // starting from that point up to the current tip.\n-    // indexes_start_block='nullptr' means \"start from height 0\".\n-    std::optional<const CBlockIndex*> indexes_start_block;\n-    std::string older_index_name;\n     ChainstateManager& chainman = *Assert(node.chainman);\n     const Chainstate& chainstate = WITH_LOCK(::cs_main, return chainman.GetChainstateForIndexing());\n     const CChain& index_chain = chainstate.m_chain;\n+    const int current_height = WITH_LOCK(::cs_main, return index_chain.Height());\n+\n+    // Skip checking data availability if we have not synced any blocks yet\n+    if (current_height > 0) {\n+        // Check if we have the required data for the indexes available from\n+        // their respective sync starting point\n+        std::optional<const CBlockIndex*> block_start;\n+        std::string block_start_name;\n+        std::optional<const CBlockIndex*> undo_start;\n+        std::string undo_start_name;\n+\n+        for (auto& index : node.indexes) {\n+            const IndexSummary& summary = index->GetSummary();\n+            if (summary.synced) continue;\n+\n+            // Get the last common block between the index best block and the active chain\n+            const CBlockIndex* pindex = WITH_LOCK(::cs_main, return chainman.m_blockman.LookupBlockIndex(summary.best_block_hash));",
      "path": "src/init.cpp",
      "position": null,
      "original_position": 29,
      "commit_id": "1f1d9f2904ee166bd82905611ded51ed9de7b28a",
      "original_commit_id": "acfbed6982c3be82d3697944bff954c296e982e2",
      "in_reply_to_id": null,
      "user": {
        "login": "TheCharlatan",
        "id": 8421793,
        "node_id": "MDQ6VXNlcjg0MjE3OTM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8421793?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/TheCharlatan",
        "html_url": "https://github.com/TheCharlatan",
        "followers_url": "https://api.github.com/users/TheCharlatan/followers",
        "following_url": "https://api.github.com/users/TheCharlatan/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/TheCharlatan/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/TheCharlatan/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/TheCharlatan/subscriptions",
        "organizations_url": "https://api.github.com/users/TheCharlatan/orgs",
        "repos_url": "https://api.github.com/users/TheCharlatan/repos",
        "events_url": "https://api.github.com/users/TheCharlatan/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/TheCharlatan/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "I think it should be ok to scope the lock to just the necessary call to `LookupBlockIndex`, but I am also having a hard time saying for certain, that there might not be some edge case race condition here with the later call to `Contains` and `FindFork`.",
      "created_at": "2025-06-02T12:54:19Z",
      "updated_at": "2025-06-02T13:39:48Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29770#discussion_r2121073979",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2121073979"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29770"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 2080,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2121131527",
      "pull_request_review_id": 2888284022,
      "id": 2121131527,
      "node_id": "PRRC_kwDOABII585-beYH",
      "diff_hunk": "@@ -2058,42 +2058,67 @@ bool AppInitMain(NodeContext& node, interfaces::BlockAndHeaderTipInfo* tip_info)\n \n bool StartIndexBackgroundSync(NodeContext& node)\n {\n-    // Find the oldest block among all indexes.\n-    // This block is used to verify that we have the required blocks' data stored on disk,\n-    // starting from that point up to the current tip.\n-    // indexes_start_block='nullptr' means \"start from height 0\".\n-    std::optional<const CBlockIndex*> indexes_start_block;\n-    std::string older_index_name;\n     ChainstateManager& chainman = *Assert(node.chainman);\n     const Chainstate& chainstate = WITH_LOCK(::cs_main, return chainman.GetChainstateForIndexing());\n     const CChain& index_chain = chainstate.m_chain;\n+    const int current_height = WITH_LOCK(::cs_main, return index_chain.Height());\n+\n+    // Skip checking data availability if we have not synced any blocks yet\n+    if (current_height > 0) {\n+        // Check if we have the required data for the indexes available from\n+        // their respective sync starting point\n+        std::optional<const CBlockIndex*> block_start;\n+        std::string block_start_name;\n+        std::optional<const CBlockIndex*> undo_start;\n+        std::string undo_start_name;\n+\n+        for (auto& index : node.indexes) {\n+            const IndexSummary& summary = index->GetSummary();\n+            if (summary.synced) continue;\n+\n+            // Get the last common block between the index best block and the active chain\n+            const CBlockIndex* pindex = WITH_LOCK(::cs_main, return chainman.m_blockman.LookupBlockIndex(summary.best_block_hash));\n+            if (!index_chain.Contains(pindex)) {\n+                pindex = index_chain.FindFork(pindex);\n+            }\n+            if (!pindex) {\n+                pindex = index_chain.Genesis();\n+            }\n \n-    for (auto index : node.indexes) {\n-        const IndexSummary& summary = index->GetSummary();\n-        if (summary.synced) continue;\n+            if (index->RequiresUndoData()) {\n+                if (undo_start && pindex->nHeight >= undo_start.value()->nHeight) continue;\n+                undo_start = pindex;\n+                if (undo_start.value()->nHeight == 0) {\n+                    // We only check for undo down to the first block because Genesis can not have undo data.\n+                    undo_start = index_chain[1];\n+                    // Still check for block data availability of Genesis.\n+                    block_start = index_chain.Genesis();\n+                    block_start_name = summary.name;\n+                }\n+                undo_start_name = summary.name;\n+            } else {\n+                if (block_start && pindex->nHeight >= block_start.value()->nHeight) continue;\n+                block_start = pindex;\n+                block_start_name = summary.name;\n+            }\n+        };\n \n-        // Get the last common block between the index best block and the active chain\n-        LOCK(::cs_main);\n-        const CBlockIndex* pindex = chainman.m_blockman.LookupBlockIndex(summary.best_block_hash);\n-        if (!index_chain.Contains(pindex)) {\n-            pindex = index_chain.FindFork(pindex);\n+        // Verify all blocks needed to sync to current tip are present including undo data.\n+        if (undo_start) {\n+            LOCK(::cs_main);\n+            if (!chainman.m_blockman.CheckBlockDataAvailability(*index_chain.Tip(), *Assert(undo_start.value()), BLOCK_HAVE_DATA | BLOCK_HAVE_UNDO)) {\n+                return InitError(Untranslated(strprintf(\"%s best block of the index goes beyond pruned data (including undo data). Please disable the index or reindex (which will download the whole blockchain again)\", undo_start_name)));\n+            }\n         }\n \n-        if (!indexes_start_block || !pindex || pindex->nHeight < indexes_start_block.value()->nHeight) {\n-            indexes_start_block = pindex;\n-            older_index_name = summary.name;\n-            if (!pindex) break; // Starting from genesis so no need to look for earlier block.\n+        // Verify all blocks needed to sync to current tip are present unless we already checked all of them above.\n+        if (block_start && !(undo_start && undo_start.value() <= block_start.value())) {",
      "path": "src/init.cpp",
      "position": null,
      "original_position": 76,
      "commit_id": "1f1d9f2904ee166bd82905611ded51ed9de7b28a",
      "original_commit_id": "acfbed6982c3be82d3697944bff954c296e982e2",
      "in_reply_to_id": null,
      "user": {
        "login": "TheCharlatan",
        "id": 8421793,
        "node_id": "MDQ6VXNlcjg0MjE3OTM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8421793?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/TheCharlatan",
        "html_url": "https://github.com/TheCharlatan",
        "followers_url": "https://api.github.com/users/TheCharlatan/followers",
        "following_url": "https://api.github.com/users/TheCharlatan/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/TheCharlatan/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/TheCharlatan/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/TheCharlatan/subscriptions",
        "organizations_url": "https://api.github.com/users/TheCharlatan/orgs",
        "repos_url": "https://api.github.com/users/TheCharlatan/repos",
        "events_url": "https://api.github.com/users/TheCharlatan/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/TheCharlatan/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "I think you are just comparing pointers here, but actually want to compare their height. This block of code is also kind of hard to test against from a functional test. Maybe we can add a unit test for `StartIndexBackgroundSync` that manipulates some of the internal block index state?",
      "created_at": "2025-06-02T13:18:51Z",
      "updated_at": "2025-06-02T13:39:48Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29770#discussion_r2121131527",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2121131527"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29770"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 2115,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2121167855",
      "pull_request_review_id": 2888284022,
      "id": 2121167855,
      "node_id": "PRRC_kwDOABII585-bnPv",
      "diff_hunk": "@@ -9,15 +9,18 @@\n #include <core_io.h>\n #include <streams.h>\n #include <sync.h>\n+#include <threadsafety.h>",
      "path": "src/rpc/blockchain.h",
      "position": 4,
      "original_position": 4,
      "commit_id": "1f1d9f2904ee166bd82905611ded51ed9de7b28a",
      "original_commit_id": "60786db022c3fb53092b1a6c267ac2b02661cbd1",
      "in_reply_to_id": null,
      "user": {
        "login": "TheCharlatan",
        "id": 8421793,
        "node_id": "MDQ6VXNlcjg0MjE3OTM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8421793?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/TheCharlatan",
        "html_url": "https://github.com/TheCharlatan",
        "followers_url": "https://api.github.com/users/TheCharlatan/followers",
        "following_url": "https://api.github.com/users/TheCharlatan/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/TheCharlatan/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/TheCharlatan/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/TheCharlatan/subscriptions",
        "organizations_url": "https://api.github.com/users/TheCharlatan/orgs",
        "repos_url": "https://api.github.com/users/TheCharlatan/repos",
        "events_url": "https://api.github.com/users/TheCharlatan/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/TheCharlatan/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "Nit: These include fixes seem a bit random. Why not apply all suggested fixes from the CI?",
      "created_at": "2025-06-02T13:32:21Z",
      "updated_at": "2025-06-02T13:39:48Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29770#discussion_r2121167855",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2121167855"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29770"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 12,
      "original_line": 12,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2127492669",
      "pull_request_review_id": 2898190553,
      "id": 2127492669,
      "node_id": "PRRC_kwDOABII585-zvY9",
      "diff_hunk": "@@ -9,15 +9,18 @@\n #include <core_io.h>\n #include <streams.h>\n #include <sync.h>\n+#include <threadsafety.h>",
      "path": "src/rpc/blockchain.h",
      "position": 4,
      "original_position": 4,
      "commit_id": "1f1d9f2904ee166bd82905611ded51ed9de7b28a",
      "original_commit_id": "60786db022c3fb53092b1a6c267ac2b02661cbd1",
      "in_reply_to_id": 2121167855,
      "user": {
        "login": "fjahr",
        "id": 1322187,
        "node_id": "MDQ6VXNlcjEzMjIxODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fjahr",
        "html_url": "https://github.com/fjahr",
        "followers_url": "https://api.github.com/users/fjahr/followers",
        "following_url": "https://api.github.com/users/fjahr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fjahr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fjahr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
        "organizations_url": "https://api.github.com/users/fjahr/orgs",
        "repos_url": "https://api.github.com/users/fjahr/repos",
        "events_url": "https://api.github.com/users/fjahr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fjahr/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "This is just addressing a specific comment from #29668: https://github.com/bitcoin/bitcoin/pull/29668#discussion_r1651138486 I'm not sure which CI you mean? But anyway I think I don't want to extend the scope by adding more include fixes, I can drop these if you want.",
      "created_at": "2025-06-04T21:46:12Z",
      "updated_at": "2025-06-04T21:46:13Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29770#discussion_r2127492669",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2127492669"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29770"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 12,
      "original_line": 12,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2127497118",
      "pull_request_review_id": 2898198181,
      "id": 2127497118,
      "node_id": "PRRC_kwDOABII585-zwee",
      "diff_hunk": "@@ -2058,42 +2058,67 @@ bool AppInitMain(NodeContext& node, interfaces::BlockAndHeaderTipInfo* tip_info)\n \n bool StartIndexBackgroundSync(NodeContext& node)\n {\n-    // Find the oldest block among all indexes.\n-    // This block is used to verify that we have the required blocks' data stored on disk,\n-    // starting from that point up to the current tip.\n-    // indexes_start_block='nullptr' means \"start from height 0\".\n-    std::optional<const CBlockIndex*> indexes_start_block;\n-    std::string older_index_name;\n     ChainstateManager& chainman = *Assert(node.chainman);\n     const Chainstate& chainstate = WITH_LOCK(::cs_main, return chainman.GetChainstateForIndexing());\n     const CChain& index_chain = chainstate.m_chain;\n+    const int current_height = WITH_LOCK(::cs_main, return index_chain.Height());\n+\n+    // Skip checking data availability if we have not synced any blocks yet\n+    if (current_height > 0) {\n+        // Check if we have the required data for the indexes available from\n+        // their respective sync starting point\n+        std::optional<const CBlockIndex*> block_start;\n+        std::string block_start_name;\n+        std::optional<const CBlockIndex*> undo_start;\n+        std::string undo_start_name;\n+\n+        for (auto& index : node.indexes) {\n+            const IndexSummary& summary = index->GetSummary();\n+            if (summary.synced) continue;\n+\n+            // Get the last common block between the index best block and the active chain\n+            const CBlockIndex* pindex = WITH_LOCK(::cs_main, return chainman.m_blockman.LookupBlockIndex(summary.best_block_hash));\n+            if (!index_chain.Contains(pindex)) {\n+                pindex = index_chain.FindFork(pindex);\n+            }\n+            if (!pindex) {\n+                pindex = index_chain.Genesis();\n+            }\n \n-    for (auto index : node.indexes) {\n-        const IndexSummary& summary = index->GetSummary();\n-        if (summary.synced) continue;\n+            if (index->RequiresUndoData()) {\n+                if (undo_start && pindex->nHeight >= undo_start.value()->nHeight) continue;\n+                undo_start = pindex;\n+                if (undo_start.value()->nHeight == 0) {\n+                    // We only check for undo down to the first block because Genesis can not have undo data.\n+                    undo_start = index_chain[1];\n+                    // Still check for block data availability of Genesis.\n+                    block_start = index_chain.Genesis();\n+                    block_start_name = summary.name;\n+                }\n+                undo_start_name = summary.name;\n+            } else {\n+                if (block_start && pindex->nHeight >= block_start.value()->nHeight) continue;\n+                block_start = pindex;\n+                block_start_name = summary.name;\n+            }\n+        };\n \n-        // Get the last common block between the index best block and the active chain\n-        LOCK(::cs_main);\n-        const CBlockIndex* pindex = chainman.m_blockman.LookupBlockIndex(summary.best_block_hash);\n-        if (!index_chain.Contains(pindex)) {\n-            pindex = index_chain.FindFork(pindex);\n+        // Verify all blocks needed to sync to current tip are present including undo data.\n+        if (undo_start) {\n+            LOCK(::cs_main);\n+            if (!chainman.m_blockman.CheckBlockDataAvailability(*index_chain.Tip(), *Assert(undo_start.value()), BLOCK_HAVE_DATA | BLOCK_HAVE_UNDO)) {\n+                return InitError(Untranslated(strprintf(\"%s best block of the index goes beyond pruned data (including undo data). Please disable the index or reindex (which will download the whole blockchain again)\", undo_start_name)));\n+            }\n         }\n \n-        if (!indexes_start_block || !pindex || pindex->nHeight < indexes_start_block.value()->nHeight) {\n-            indexes_start_block = pindex;\n-            older_index_name = summary.name;\n-            if (!pindex) break; // Starting from genesis so no need to look for earlier block.\n+        // Verify all blocks needed to sync to current tip are present unless we already checked all of them above.\n+        if (block_start && !(undo_start && undo_start.value() <= block_start.value())) {",
      "path": "src/init.cpp",
      "position": null,
      "original_position": 76,
      "commit_id": "1f1d9f2904ee166bd82905611ded51ed9de7b28a",
      "original_commit_id": "acfbed6982c3be82d3697944bff954c296e982e2",
      "in_reply_to_id": 2121131527,
      "user": {
        "login": "fjahr",
        "id": 1322187,
        "node_id": "MDQ6VXNlcjEzMjIxODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fjahr",
        "html_url": "https://github.com/fjahr",
        "followers_url": "https://api.github.com/users/fjahr/followers",
        "following_url": "https://api.github.com/users/fjahr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fjahr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fjahr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
        "organizations_url": "https://api.github.com/users/fjahr/orgs",
        "repos_url": "https://api.github.com/users/fjahr/repos",
        "events_url": "https://api.github.com/users/fjahr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fjahr/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "Right, good catch on the pointers! Fixed.\r\n\r\nI can try to add such a unit test, do you have specific scenarios in mind that you would like to see covered? If we just want to make sure this block is covered I think I could also add a functional test that basically executes the edge case that @furszy described above: https://github.com/bitcoin/bitcoin/pull/29770#discussion_r2029126932 and I think that should be fairly easy to do.",
      "created_at": "2025-06-04T21:48:35Z",
      "updated_at": "2025-06-04T21:48:46Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29770#discussion_r2127497118",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2127497118"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29770"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 2115,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2127498222",
      "pull_request_review_id": 2898200068,
      "id": 2127498222,
      "node_id": "PRRC_kwDOABII585-zwvu",
      "diff_hunk": "@@ -2058,42 +2058,67 @@ bool AppInitMain(NodeContext& node, interfaces::BlockAndHeaderTipInfo* tip_info)\n \n bool StartIndexBackgroundSync(NodeContext& node)\n {\n-    // Find the oldest block among all indexes.\n-    // This block is used to verify that we have the required blocks' data stored on disk,\n-    // starting from that point up to the current tip.\n-    // indexes_start_block='nullptr' means \"start from height 0\".\n-    std::optional<const CBlockIndex*> indexes_start_block;\n-    std::string older_index_name;\n     ChainstateManager& chainman = *Assert(node.chainman);\n     const Chainstate& chainstate = WITH_LOCK(::cs_main, return chainman.GetChainstateForIndexing());\n     const CChain& index_chain = chainstate.m_chain;\n+    const int current_height = WITH_LOCK(::cs_main, return index_chain.Height());\n+\n+    // Skip checking data availability if we have not synced any blocks yet\n+    if (current_height > 0) {\n+        // Check if we have the required data for the indexes available from\n+        // their respective sync starting point\n+        std::optional<const CBlockIndex*> block_start;\n+        std::string block_start_name;\n+        std::optional<const CBlockIndex*> undo_start;\n+        std::string undo_start_name;\n+\n+        for (auto& index : node.indexes) {\n+            const IndexSummary& summary = index->GetSummary();\n+            if (summary.synced) continue;\n+\n+            // Get the last common block between the index best block and the active chain\n+            const CBlockIndex* pindex = WITH_LOCK(::cs_main, return chainman.m_blockman.LookupBlockIndex(summary.best_block_hash));",
      "path": "src/init.cpp",
      "position": null,
      "original_position": 29,
      "commit_id": "1f1d9f2904ee166bd82905611ded51ed9de7b28a",
      "original_commit_id": "acfbed6982c3be82d3697944bff954c296e982e2",
      "in_reply_to_id": 2121073979,
      "user": {
        "login": "fjahr",
        "id": 1322187,
        "node_id": "MDQ6VXNlcjEzMjIxODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fjahr",
        "html_url": "https://github.com/fjahr",
        "followers_url": "https://api.github.com/users/fjahr/followers",
        "following_url": "https://api.github.com/users/fjahr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fjahr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fjahr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
        "organizations_url": "https://api.github.com/users/fjahr/orgs",
        "repos_url": "https://api.github.com/users/fjahr/repos",
        "events_url": "https://api.github.com/users/fjahr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fjahr/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "Makes sense, I am keeping the lock for the later calls as well now.",
      "created_at": "2025-06-04T21:49:17Z",
      "updated_at": "2025-06-04T21:49:17Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29770#discussion_r2127498222",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2127498222"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29770"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 2080,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2127501557",
      "pull_request_review_id": 2898205223,
      "id": 2127501557,
      "node_id": "PRRC_kwDOABII585-zxj1",
      "diff_hunk": "@@ -9,15 +9,18 @@\n #include <core_io.h>\n #include <streams.h>\n #include <sync.h>\n+#include <threadsafety.h>",
      "path": "src/rpc/blockchain.h",
      "position": 4,
      "original_position": 4,
      "commit_id": "1f1d9f2904ee166bd82905611ded51ed9de7b28a",
      "original_commit_id": "60786db022c3fb53092b1a6c267ac2b02661cbd1",
      "in_reply_to_id": 2121167855,
      "user": {
        "login": "TheCharlatan",
        "id": 8421793,
        "node_id": "MDQ6VXNlcjg0MjE3OTM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8421793?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/TheCharlatan",
        "html_url": "https://github.com/TheCharlatan",
        "followers_url": "https://api.github.com/users/TheCharlatan/followers",
        "following_url": "https://api.github.com/users/TheCharlatan/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/TheCharlatan/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/TheCharlatan/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/TheCharlatan/subscriptions",
        "organizations_url": "https://api.github.com/users/TheCharlatan/orgs",
        "repos_url": "https://api.github.com/users/TheCharlatan/repos",
        "events_url": "https://api.github.com/users/TheCharlatan/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/TheCharlatan/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "The tidy job includes a complete run of include what you use suggestions for all source files.",
      "created_at": "2025-06-04T21:50:43Z",
      "updated_at": "2025-06-04T21:50:43Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29770#discussion_r2127501557",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2127501557"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29770"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 12,
      "original_line": 12,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2143917849",
      "pull_request_review_id": 2923006663,
      "id": 2143917849,
      "node_id": "PRRC_kwDOABII585_yZcZ",
      "diff_hunk": "@@ -2058,41 +2058,69 @@ bool AppInitMain(NodeContext& node, interfaces::BlockAndHeaderTipInfo* tip_info)\n \n bool StartIndexBackgroundSync(NodeContext& node)\n {\n-    // Find the oldest block among all indexes.\n-    // This block is used to verify that we have the required blocks' data stored on disk,\n-    // starting from that point up to the current tip.\n-    // indexes_start_block='nullptr' means \"start from height 0\".\n-    std::optional<const CBlockIndex*> indexes_start_block;\n-    std::string older_index_name;\n     ChainstateManager& chainman = *Assert(node.chainman);\n     const Chainstate& chainstate = WITH_LOCK(::cs_main, return chainman.GetChainstateForIndexing());\n     const CChain& index_chain = chainstate.m_chain;\n+    const int current_height = WITH_LOCK(::cs_main, return index_chain.Height());\n+\n+    // Skip checking data availability if we have not synced any blocks yet\n+    if (current_height > 0) {\n+        // Check if we have the required data for the indexes available from\n+        // their respective sync starting point\n+        std::optional<const CBlockIndex*> block_start;\n+        std::string block_start_name;\n+        std::optional<const CBlockIndex*> undo_start;\n+        std::string undo_start_name;\n+\n+        for (auto& index : node.indexes) {\n+            const IndexSummary& summary = index->GetSummary();\n+            if (summary.synced) continue;\n+\n+            // Get the last common block between the index best block and the active chain\n+            const CBlockIndex* pindex = nullptr;\n+            {\n+                LOCK(::cs_main);\n+                pindex = chainman.m_blockman.LookupBlockIndex(summary.best_block_hash);\n+                if (!index_chain.Contains(pindex)) {\n+                    pindex = index_chain.FindFork(pindex);\n+                }\n+            }\n+            if (!pindex) {\n+                pindex = index_chain.Genesis();\n+            }\n \n-    for (auto index : node.indexes) {\n-        const IndexSummary& summary = index->GetSummary();\n-        if (summary.synced) continue;\n-\n-        // Get the last common block between the index best block and the active chain\n-        LOCK(::cs_main);\n-        const CBlockIndex* pindex = chainman.m_blockman.LookupBlockIndex(summary.best_block_hash);\n-        if (!index_chain.Contains(pindex)) {\n-            pindex = index_chain.FindFork(pindex);\n-        }\n+            if (index->RequiresUndoData()) {",
      "path": "src/init.cpp",
      "position": null,
      "original_position": 51,
      "commit_id": "1f1d9f2904ee166bd82905611ded51ed9de7b28a",
      "original_commit_id": "ccf21cf1b273f27eebbaad5dcf070377d675592c",
      "in_reply_to_id": null,
      "user": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "In ccf21cf1b273f27eebbaad5dcf070377d675592c:\r\n\r\nNow can simplify this commit by replacing `index->RequiresUndoData()` for `index->CustomOptions().connect_undo_data`",
      "created_at": "2025-06-13T00:16:29Z",
      "updated_at": "2025-06-13T13:42:23Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29770#discussion_r2143917849",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2143917849"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29770"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 2092,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2148828616",
      "pull_request_review_id": 2930336752,
      "id": 2148828616,
      "node_id": "PRRC_kwDOABII586AFIXI",
      "diff_hunk": "@@ -2058,41 +2058,69 @@ bool AppInitMain(NodeContext& node, interfaces::BlockAndHeaderTipInfo* tip_info)\n \n bool StartIndexBackgroundSync(NodeContext& node)\n {\n-    // Find the oldest block among all indexes.\n-    // This block is used to verify that we have the required blocks' data stored on disk,\n-    // starting from that point up to the current tip.\n-    // indexes_start_block='nullptr' means \"start from height 0\".\n-    std::optional<const CBlockIndex*> indexes_start_block;\n-    std::string older_index_name;\n     ChainstateManager& chainman = *Assert(node.chainman);\n     const Chainstate& chainstate = WITH_LOCK(::cs_main, return chainman.GetChainstateForIndexing());\n     const CChain& index_chain = chainstate.m_chain;\n+    const int current_height = WITH_LOCK(::cs_main, return index_chain.Height());\n+\n+    // Skip checking data availability if we have not synced any blocks yet\n+    if (current_height > 0) {\n+        // Check if we have the required data for the indexes available from\n+        // their respective sync starting point\n+        std::optional<const CBlockIndex*> block_start;\n+        std::string block_start_name;\n+        std::optional<const CBlockIndex*> undo_start;\n+        std::string undo_start_name;\n+\n+        for (auto& index : node.indexes) {\n+            const IndexSummary& summary = index->GetSummary();\n+            if (summary.synced) continue;\n+\n+            // Get the last common block between the index best block and the active chain\n+            const CBlockIndex* pindex = nullptr;\n+            {\n+                LOCK(::cs_main);\n+                pindex = chainman.m_blockman.LookupBlockIndex(summary.best_block_hash);\n+                if (!index_chain.Contains(pindex)) {\n+                    pindex = index_chain.FindFork(pindex);\n+                }\n+            }\n+            if (!pindex) {\n+                pindex = index_chain.Genesis();\n+            }\n \n-    for (auto index : node.indexes) {\n-        const IndexSummary& summary = index->GetSummary();\n-        if (summary.synced) continue;\n-\n-        // Get the last common block between the index best block and the active chain\n-        LOCK(::cs_main);\n-        const CBlockIndex* pindex = chainman.m_blockman.LookupBlockIndex(summary.best_block_hash);\n-        if (!index_chain.Contains(pindex)) {\n-            pindex = index_chain.FindFork(pindex);\n-        }\n+            if (index->RequiresUndoData()) {",
      "path": "src/init.cpp",
      "position": null,
      "original_position": 51,
      "commit_id": "1f1d9f2904ee166bd82905611ded51ed9de7b28a",
      "original_commit_id": "ccf21cf1b273f27eebbaad5dcf070377d675592c",
      "in_reply_to_id": 2143917849,
      "user": {
        "login": "fjahr",
        "id": 1322187,
        "node_id": "MDQ6VXNlcjEzMjIxODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fjahr",
        "html_url": "https://github.com/fjahr",
        "followers_url": "https://api.github.com/users/fjahr/followers",
        "following_url": "https://api.github.com/users/fjahr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fjahr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fjahr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
        "organizations_url": "https://api.github.com/users/fjahr/orgs",
        "repos_url": "https://api.github.com/users/fjahr/repos",
        "events_url": "https://api.github.com/users/fjahr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fjahr/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "body": "done",
      "created_at": "2025-06-15T21:13:45Z",
      "updated_at": "2025-06-15T21:13:45Z",
      "html_url": "https://github.com/bitcoin/bitcoin/pull/29770#discussion_r2148828616",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2148828616"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/29770"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 2092,
      "side": "RIGHT"
    }
  ]
}
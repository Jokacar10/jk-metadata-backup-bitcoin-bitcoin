{
  "type": "issue",
  "issue": {
    "id": 2326025860,
    "node_id": "I_kwDOABII586KpFaE",
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/30206",
    "repository_url": "https://api.github.com/repos/bitcoin/bitcoin",
    "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/30206/labels%7B/name%7D",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/30206/comments",
    "events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/30206/events",
    "html_url": "https://github.com/bitcoin/bitcoin/issues/30206",
    "number": 30206,
    "state": "open",
    "state_reason": null,
    "title": "build: make macOS build Clang only",
    "body": "It should be possible to have a macOS (release) build environment that only uses Clang, and has no GCC toolchain installed.\r\n\r\nCurrently that's not possible, because Qt still reaches out to `g++`. This can be demo'd by Guix building this branch: https://github.com/fanquake/bitcoin/tree/guix_macos_no_gcc, which removes the `gcc-toolchain` package, and associated build infra from the macOS env. It will fail with:\r\n```bash\r\nConfiguring qt...\r\nCreating qmake...\r\nmake[1]: Entering directory '/bitcoin/depends/work/build/arm64-apple-darwin/qt/5.15.13-35fa99bb44b/qtbase/qmake'\r\nmake[1]: g++: No such file or directory\r\nmake[1]: *** [Makefile:250: main.o] Error 127\r\n```\r\n\r\nTODO:\r\n- [ ] Make Qt work properly with just Clang.",
    "user": {
      "login": "fanquake",
      "id": 863730,
      "node_id": "MDQ6VXNlcjg2MzczMA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/863730?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/fanquake",
      "html_url": "https://github.com/fanquake",
      "followers_url": "https://api.github.com/users/fanquake/followers",
      "following_url": "https://api.github.com/users/fanquake/following%7B/other_user%7D",
      "gists_url": "https://api.github.com/users/fanquake/gists%7B/gist_id%7D",
      "starred_url": "https://api.github.com/users/fanquake/starred%7B/owner%7D%7B/repo%7D",
      "subscriptions_url": "https://api.github.com/users/fanquake/subscriptions",
      "organizations_url": "https://api.github.com/users/fanquake/orgs",
      "repos_url": "https://api.github.com/users/fanquake/repos",
      "events_url": "https://api.github.com/users/fanquake/events%7B/privacy%7D",
      "received_events_url": "https://api.github.com/users/fanquake/received_events",
      "type": "User",
      "site_admin": false,
      "patch_url": null
    },
    "labels": [
      {
        "id": 61889416,
        "node_id": "MDU6TGFiZWw2MTg4OTQxNg==",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Build%20system",
        "name": "Build system",
        "color": "5319e7",
        "default": false
      }
    ],
    "assignees": [],
    "author_association": "MEMBER",
    "locked": false,
    "comments": 2,
    "created_at": "2024-05-30T15:58:00Z",
    "updated_at": "2025-03-22T02:54:47Z"
  },
  "events": [
    {
      "event": "labeled",
      "id": 12988438190,
      "node_id": "LE_lADOABII586KpFaEzwAAAAMGK9au",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/12988438190",
      "actor": {
        "login": "fanquake",
        "id": 863730,
        "node_id": "MDQ6VXNlcjg2MzczMA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/863730?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fanquake",
        "html_url": "https://github.com/fanquake",
        "followers_url": "https://api.github.com/users/fanquake/followers",
        "following_url": "https://api.github.com/users/fanquake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fanquake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fanquake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fanquake/subscriptions",
        "organizations_url": "https://api.github.com/users/fanquake/orgs",
        "repos_url": "https://api.github.com/users/fanquake/repos",
        "events_url": "https://api.github.com/users/fanquake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fanquake/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-05-30T15:58:00Z",
      "label": {
        "name": "Build system",
        "color": "5319e7"
      }
    },
    {
      "event": "referenced",
      "id": 13614405939,
      "node_id": "REFE_lADOABII586KpFaEzwAAAAMre1kz",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/13614405939",
      "actor": {
        "login": "fanquake",
        "id": 863730,
        "node_id": "MDQ6VXNlcjg2MzczMA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/863730?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fanquake",
        "html_url": "https://github.com/fanquake",
        "followers_url": "https://api.github.com/users/fanquake/followers",
        "following_url": "https://api.github.com/users/fanquake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fanquake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fanquake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fanquake/subscriptions",
        "organizations_url": "https://api.github.com/users/fanquake/orgs",
        "repos_url": "https://api.github.com/users/fanquake/repos",
        "events_url": "https://api.github.com/users/fanquake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fanquake/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": "0f0c89e3e42ca317cff3dba4f48496a1f80e11ac",
      "commit_url": "https://api.github.com/repos/fanquake/bitcoin/commits/0f0c89e3e42ca317cff3dba4f48496a1f80e11ac",
      "created_at": "2024-07-23T11:37:42Z"
    },
    {
      "event": "referenced",
      "id": 13615305591,
      "node_id": "REFE_lADOABII586KpFaEzwAAAAMriRN3",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/13615305591",
      "actor": {
        "login": "fanquake",
        "id": 863730,
        "node_id": "MDQ6VXNlcjg2MzczMA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/863730?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fanquake",
        "html_url": "https://github.com/fanquake",
        "followers_url": "https://api.github.com/users/fanquake/followers",
        "following_url": "https://api.github.com/users/fanquake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fanquake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fanquake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fanquake/subscriptions",
        "organizations_url": "https://api.github.com/users/fanquake/orgs",
        "repos_url": "https://api.github.com/users/fanquake/repos",
        "events_url": "https://api.github.com/users/fanquake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fanquake/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": "e24d2bbe4096fb76d1144dd3f7a8659c4f1f4d43",
      "commit_url": "https://api.github.com/repos/fanquake/bitcoin/commits/e24d2bbe4096fb76d1144dd3f7a8659c4f1f4d43",
      "created_at": "2024-07-23T12:46:02Z"
    },
    {
      "event": "referenced",
      "id": 13615421980,
      "node_id": "REFE_lADOABII586KpFaEzwAAAAMritoc",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/13615421980",
      "actor": {
        "login": "fanquake",
        "id": 863730,
        "node_id": "MDQ6VXNlcjg2MzczMA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/863730?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fanquake",
        "html_url": "https://github.com/fanquake",
        "followers_url": "https://api.github.com/users/fanquake/followers",
        "following_url": "https://api.github.com/users/fanquake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fanquake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fanquake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fanquake/subscriptions",
        "organizations_url": "https://api.github.com/users/fanquake/orgs",
        "repos_url": "https://api.github.com/users/fanquake/repos",
        "events_url": "https://api.github.com/users/fanquake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fanquake/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": "8b41ede55ebbc6978deb3f4fad5e18b76b372506",
      "commit_url": "https://api.github.com/repos/fanquake/bitcoin/commits/8b41ede55ebbc6978deb3f4fad5e18b76b372506",
      "created_at": "2024-07-23T12:54:40Z"
    },
    {
      "event": "referenced",
      "id": 13628487539,
      "node_id": "REFE_lADOABII586KpFaEzwAAAAMsUjdz",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/13628487539",
      "actor": {
        "login": "fanquake",
        "id": 863730,
        "node_id": "MDQ6VXNlcjg2MzczMA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/863730?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fanquake",
        "html_url": "https://github.com/fanquake",
        "followers_url": "https://api.github.com/users/fanquake/followers",
        "following_url": "https://api.github.com/users/fanquake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fanquake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fanquake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fanquake/subscriptions",
        "organizations_url": "https://api.github.com/users/fanquake/orgs",
        "repos_url": "https://api.github.com/users/fanquake/repos",
        "events_url": "https://api.github.com/users/fanquake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fanquake/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": "115e241ec67d5dbf224bceceb6bb55085e3be415",
      "commit_url": "https://api.github.com/repos/fanquake/bitcoin/commits/115e241ec67d5dbf224bceceb6bb55085e3be415",
      "created_at": "2024-07-24T10:37:04Z"
    },
    {
      "event": "referenced",
      "id": 13644489716,
      "node_id": "REFE_lADOABII586KpFaEzwAAAAMtRmP0",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/13644489716",
      "actor": {
        "login": "fanquake",
        "id": 863730,
        "node_id": "MDQ6VXNlcjg2MzczMA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/863730?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fanquake",
        "html_url": "https://github.com/fanquake",
        "followers_url": "https://api.github.com/users/fanquake/followers",
        "following_url": "https://api.github.com/users/fanquake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fanquake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fanquake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fanquake/subscriptions",
        "organizations_url": "https://api.github.com/users/fanquake/orgs",
        "repos_url": "https://api.github.com/users/fanquake/repos",
        "events_url": "https://api.github.com/users/fanquake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fanquake/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": "98f077bf6d4889fc813809b3dbf9529f73b865b0",
      "commit_url": "https://api.github.com/repos/fanquake/bitcoin/commits/98f077bf6d4889fc813809b3dbf9529f73b865b0",
      "created_at": "2024-07-25T11:47:20Z"
    },
    {
      "event": "referenced",
      "id": 13685713989,
      "node_id": "REFE_lADOABII586KpFaEzwAAAAMvu2xF",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/13685713989",
      "actor": {
        "login": "davidgumberg",
        "id": 2257631,
        "node_id": "MDQ6VXNlcjIyNTc2MzE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2257631?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/davidgumberg",
        "html_url": "https://github.com/davidgumberg",
        "followers_url": "https://api.github.com/users/davidgumberg/followers",
        "following_url": "https://api.github.com/users/davidgumberg/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/davidgumberg/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/davidgumberg/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/davidgumberg/subscriptions",
        "organizations_url": "https://api.github.com/users/davidgumberg/orgs",
        "repos_url": "https://api.github.com/users/davidgumberg/repos",
        "events_url": "https://api.github.com/users/davidgumberg/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/davidgumberg/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": "27db7e8725f4616f61c96c84c7410e861373c387",
      "commit_url": "https://api.github.com/repos/davidgumberg/bitcoin/commits/27db7e8725f4616f61c96c84c7410e861373c387",
      "created_at": "2024-07-29T20:02:52Z"
    },
    {
      "event": "commented",
      "id": 2744536272,
      "node_id": "IC_kwDOABII586jlkzQ",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2744536272",
      "actor": {
        "login": "hebasto",
        "id": 32963518,
        "node_id": "MDQ6VXNlcjMyOTYzNTE4",
        "avatar_url": "https://avatars.githubusercontent.com/u/32963518?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/hebasto",
        "html_url": "https://github.com/hebasto",
        "followers_url": "https://api.github.com/users/hebasto/followers",
        "following_url": "https://api.github.com/users/hebasto/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/hebasto/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/hebasto/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/hebasto/subscriptions",
        "organizations_url": "https://api.github.com/users/hebasto/orgs",
        "repos_url": "https://api.github.com/users/hebasto/repos",
        "events_url": "https://api.github.com/users/hebasto/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/hebasto/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-03-21T21:57:21Z",
      "updated_at": "2025-03-21T21:57:21Z",
      "author_association": "MEMBER",
      "body": "[Here](https://github.com/hebasto/bitcoin/tree/250321-qt6-clang) is a working proof of concept based on the branch from https://github.com/bitcoin/bitcoin/pull/30997. The last commit makes the macOS builds on Guix Clang only.",
      "user": {
        "login": "hebasto",
        "id": 32963518,
        "node_id": "MDQ6VXNlcjMyOTYzNTE4",
        "avatar_url": "https://avatars.githubusercontent.com/u/32963518?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/hebasto",
        "html_url": "https://github.com/hebasto",
        "followers_url": "https://api.github.com/users/hebasto/followers",
        "following_url": "https://api.github.com/users/hebasto/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/hebasto/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/hebasto/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/hebasto/subscriptions",
        "organizations_url": "https://api.github.com/users/hebasto/orgs",
        "repos_url": "https://api.github.com/users/hebasto/repos",
        "events_url": "https://api.github.com/users/hebasto/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/hebasto/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/issues/30206#issuecomment-2744536272",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/30206"
    },
    {
      "event": "commented",
      "id": 2744920866,
      "node_id": "IC_kwDOABII586jnCsi",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2744920866",
      "actor": {
        "login": "fanquake",
        "id": 863730,
        "node_id": "MDQ6VXNlcjg2MzczMA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/863730?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fanquake",
        "html_url": "https://github.com/fanquake",
        "followers_url": "https://api.github.com/users/fanquake/followers",
        "following_url": "https://api.github.com/users/fanquake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fanquake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fanquake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fanquake/subscriptions",
        "organizations_url": "https://api.github.com/users/fanquake/orgs",
        "repos_url": "https://api.github.com/users/fanquake/repos",
        "events_url": "https://api.github.com/users/fanquake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fanquake/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-03-22T02:54:46Z",
      "updated_at": "2025-03-22T02:54:46Z",
      "author_association": "MEMBER",
      "body": "> The last commit makes the macOS builds on Guix Clang only.\n\nSeems like that commit is missing the diff to actually remove the GCC toolchain from the macOS build? Applying that causes the build to fail:\n```diff\ndiff --git a/contrib/guix/manifest.scm b/contrib/guix/manifest.scm\nindex 4e7e955218..f1e3db81c8 100644\n--- a/contrib/guix/manifest.scm\n+++ b/contrib/guix/manifest.scm\n@@ -544,7 +544,6 @@ inspecting signatures in Mach-O binaries.\")\n         gzip\n         xz\n         ;; Build tools\n-        gcc-toolchain-13\n         cmake-minimal\n         gnu-make\n         ;; Scripting\n@@ -556,12 +555,14 @@ inspecting signatures in Mach-O binaries.\")\n   (let ((target (getenv \"HOST\")))\n     (cond ((string-suffix? \"-mingw32\" target)\n            (list zip\n+                 gcc-toolchain-13\n                  (make-mingw-pthreads-cross-toolchain \"x86_64-w64-mingw32\")\n                  nsis-x86_64\n                  nss-certs\n                  osslsigncode))\n           ((string-contains target \"-linux-\")\n            (list bison\n+                 gcc-toolchain-13\n                  pkg-config\n                  (list gcc-toolchain-13 \"static\")\n                  (make-bitcoin-cross-toolchain target)))\n```",
      "user": {
        "login": "fanquake",
        "id": 863730,
        "node_id": "MDQ6VXNlcjg2MzczMA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/863730?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fanquake",
        "html_url": "https://github.com/fanquake",
        "followers_url": "https://api.github.com/users/fanquake/followers",
        "following_url": "https://api.github.com/users/fanquake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fanquake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fanquake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fanquake/subscriptions",
        "organizations_url": "https://api.github.com/users/fanquake/orgs",
        "repos_url": "https://api.github.com/users/fanquake/repos",
        "events_url": "https://api.github.com/users/fanquake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fanquake/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/issues/30206#issuecomment-2744920866",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/30206"
    }
  ]
}
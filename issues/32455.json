{
  "type": "issue",
  "issue": {
    "id": 3051022148,
    "node_id": "I_kwDOABII58612udE",
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/32455",
    "repository_url": "https://api.github.com/repos/bitcoin/bitcoin",
    "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/32455/labels%7B/name%7D",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/32455/comments",
    "events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/32455/events",
    "html_url": "https://github.com/bitcoin/bitcoin/issues/32455",
    "number": 32455,
    "state": "open",
    "state_reason": null,
    "title": "Self-compiled bitcoind 29.0 much slower than self-compiled 28.0 on my system",
    "body": "I always compile the bitcoin software myself (`Ubuntu 24.04.2 LTS`). For `bitcoin-29.0` I compiled it (of course) for the first time with `cmake` (with and without `berkeley-db`). \n\nFor both (with and without `berkeley-db`), `bitcoind-29.0` is much slower than `bitcoin-28.0` which gives me problems on my server.\n\nTo investigate I wrote a shell script that determines the time difference in seconds between \"Saw new header\" and \"UpdateTip\":\n\n```\n2025-05-09T05:24:11Z Saw new header hash=0000000000000000000213e630619be8945d471d06b0395fb6adca797877527d height=895920\n2025-05-09T05:24:11Z Saw new cmpctblock header hash=0000000000000000000213e630619be8945d471d06b0395fb6adca797877527d peer=5197\n2025-05-09T05:24:12Z UpdateTip: new best=0000000000000000000213e630619be8945d471d06b0395fb6adca797877527d height=895920 version=0x2a4aa000 log2_work=95.598602 tx=1188522869 date='2025-05-09T05:23:59Z' progress=1.000000 cache=216.6MiB(1587712txo)\n```\nwhich in this `bitcoind-28.0` example is only 1 second. This is typical for `bitcoind-28.0` on my system where it is between 0 and 1 seconds with only very occasionally a bit longer. Now for `bitcoind-29.0` it's much longer:\n\nBlock nr: delta t in seconds\n895579: 3\n895580: 3\n895581: 4\n895582: 2\n895583: 16\n895584: 65\n895585: 8\n895586: 280\n895587: 81\n895588: 133\n895589: 124\n895590: 3\n895591: 73\n895592: 153\n895593: 284\n895594: 528\n895595: 17\n895596: 8\n895597: 4\n895598: 2\n895599: 3\n895600: 4\n895601: 6\n895602: 3\n895603: 2\n895604: 5\n895605: 5\n895606: 34\n895607: 2\n895608: 6\n\nThis is true whether it's compiled with or without `berkeley-db`. So mometimes it takes several minutes!\n\nSo I did some investigations. The first thing I found was that my `bitcoind-29.0` and others are much bigger than the pre-compiled ones:\n\nPrecompiled `29.0` (`du` in MB):\n3\tbitcoin-cli\n16\tbitcoind\n42\tbitcoin-qt\n5\tbitcoin-tx\n3\tbitcoin-util\n10\tbitcoin-wallet\n28\ttest_bitcoin\n\nFor my self-compiled `29.0`:\n21\tbitcoin-cli\n273\tbitcoind\n47\tbitcoin-tx\n21\tbitcoin-util\n134\tbitcoin-wallet\n511\ttest_bitcoin\n\nAlthough normally I use some compiler options, here for comparison compiled according to the docs: (`cmake -B build;  cmake --build build; cmake --install build`)\n\nBoth (my and pre-compiled) `test_bitcoin` work fine. Note that also my (not too slow) `bitcoind-28.0` (etc) is about the same too big a size (269 MB) as my `bitcoind-29.0`. So I had this before but never noticed.\n\nSo my first question before I investigate any further is: how come my `bitcoind` is so big compared to the pre-compiled one?\n\n",
    "user": {
      "login": "hMsats",
      "id": 74196711,
      "node_id": "MDQ6VXNlcjc0MTk2NzEx",
      "avatar_url": "https://avatars.githubusercontent.com/u/74196711?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/hMsats",
      "html_url": "https://github.com/hMsats",
      "followers_url": "https://api.github.com/users/hMsats/followers",
      "following_url": "https://api.github.com/users/hMsats/following%7B/other_user%7D",
      "gists_url": "https://api.github.com/users/hMsats/gists%7B/gist_id%7D",
      "starred_url": "https://api.github.com/users/hMsats/starred%7B/owner%7D%7B/repo%7D",
      "subscriptions_url": "https://api.github.com/users/hMsats/subscriptions",
      "organizations_url": "https://api.github.com/users/hMsats/orgs",
      "repos_url": "https://api.github.com/users/hMsats/repos",
      "events_url": "https://api.github.com/users/hMsats/events%7B/privacy%7D",
      "received_events_url": "https://api.github.com/users/hMsats/received_events",
      "type": "User",
      "site_admin": false,
      "patch_url": null
    },
    "labels": [],
    "assignees": [],
    "author_association": "NONE",
    "locked": false,
    "comments": 2,
    "created_at": "2025-05-09T06:08:19Z",
    "updated_at": "2025-05-09T07:38:36Z"
  },
  "events": [
    {
      "event": "commented",
      "id": 2865331250,
      "node_id": "IC_kwDOABII586qyXwy",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2865331250",
      "actor": {
        "login": "fanquake",
        "id": 863730,
        "node_id": "MDQ6VXNlcjg2MzczMA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/863730?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fanquake",
        "html_url": "https://github.com/fanquake",
        "followers_url": "https://api.github.com/users/fanquake/followers",
        "following_url": "https://api.github.com/users/fanquake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fanquake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fanquake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fanquake/subscriptions",
        "organizations_url": "https://api.github.com/users/fanquake/orgs",
        "repos_url": "https://api.github.com/users/fanquake/repos",
        "events_url": "https://api.github.com/users/fanquake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fanquake/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-05-09T06:41:18Z",
      "updated_at": "2025-05-09T06:41:18Z",
      "author_association": "MEMBER",
      "body": "> So my first question before I investigate any further is: how come my bitcoind is so big compared to the pre-compiled one?\n\nThis will be the debug symbols. If you run 'strip' on the binaries. i.e 'strip bitcoind' this debug information will be removed, and the size of your binaries should shrink 80-90%.",
      "user": {
        "login": "fanquake",
        "id": 863730,
        "node_id": "MDQ6VXNlcjg2MzczMA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/863730?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fanquake",
        "html_url": "https://github.com/fanquake",
        "followers_url": "https://api.github.com/users/fanquake/followers",
        "following_url": "https://api.github.com/users/fanquake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fanquake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fanquake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fanquake/subscriptions",
        "organizations_url": "https://api.github.com/users/fanquake/orgs",
        "repos_url": "https://api.github.com/users/fanquake/repos",
        "events_url": "https://api.github.com/users/fanquake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fanquake/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/issues/32455#issuecomment-2865331250",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/32455"
    },
    {
      "event": "commented",
      "id": 2865489117,
      "node_id": "IC_kwDOABII586qy-Td",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2865489117",
      "actor": {
        "login": "hMsats",
        "id": 74196711,
        "node_id": "MDQ6VXNlcjc0MTk2NzEx",
        "avatar_url": "https://avatars.githubusercontent.com/u/74196711?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/hMsats",
        "html_url": "https://github.com/hMsats",
        "followers_url": "https://api.github.com/users/hMsats/followers",
        "following_url": "https://api.github.com/users/hMsats/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/hMsats/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/hMsats/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/hMsats/subscriptions",
        "organizations_url": "https://api.github.com/users/hMsats/orgs",
        "repos_url": "https://api.github.com/users/hMsats/repos",
        "events_url": "https://api.github.com/users/hMsats/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/hMsats/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-05-09T07:38:35Z",
      "updated_at": "2025-05-09T07:38:35Z",
      "author_association": "NONE",
      "body": "@fanquake Thanks a lot! I expected something like this (debug info) but thought it was some compiler option. The `strip` worked and now my bitcoind is only 12 MB üëç. As I never used `strip` on `bitcoin-28.0` I don't expect this to make a difference but will try it first on my server anyway or could it?\n\nThis is very confusing. I'm a long time bitcoin node runner and linux user but would never have thought of this possibility. **Shouldn't this be mentioned in the `doc/build-unix.md`?**",
      "user": {
        "login": "hMsats",
        "id": 74196711,
        "node_id": "MDQ6VXNlcjc0MTk2NzEx",
        "avatar_url": "https://avatars.githubusercontent.com/u/74196711?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/hMsats",
        "html_url": "https://github.com/hMsats",
        "followers_url": "https://api.github.com/users/hMsats/followers",
        "following_url": "https://api.github.com/users/hMsats/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/hMsats/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/hMsats/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/hMsats/subscriptions",
        "organizations_url": "https://api.github.com/users/hMsats/orgs",
        "repos_url": "https://api.github.com/users/hMsats/repos",
        "events_url": "https://api.github.com/users/hMsats/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/hMsats/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/issues/32455#issuecomment-2865489117",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/32455"
    },
    {
      "event": "mentioned",
      "id": 17586166757,
      "node_id": "MEE_lADOABII58612udEzwAAAAQYN5vl",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/17586166757",
      "actor": {
        "login": "fanquake",
        "id": 863730,
        "node_id": "MDQ6VXNlcjg2MzczMA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/863730?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fanquake",
        "html_url": "https://github.com/fanquake",
        "followers_url": "https://api.github.com/users/fanquake/followers",
        "following_url": "https://api.github.com/users/fanquake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fanquake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fanquake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fanquake/subscriptions",
        "organizations_url": "https://api.github.com/users/fanquake/orgs",
        "repos_url": "https://api.github.com/users/fanquake/repos",
        "events_url": "https://api.github.com/users/fanquake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fanquake/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-05-09T07:38:37Z"
    },
    {
      "event": "subscribed",
      "id": 17586166772,
      "node_id": "SE_lADOABII58612udEzwAAAAQYN5v0",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/17586166772",
      "actor": {
        "login": "fanquake",
        "id": 863730,
        "node_id": "MDQ6VXNlcjg2MzczMA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/863730?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fanquake",
        "html_url": "https://github.com/fanquake",
        "followers_url": "https://api.github.com/users/fanquake/followers",
        "following_url": "https://api.github.com/users/fanquake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fanquake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fanquake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fanquake/subscriptions",
        "organizations_url": "https://api.github.com/users/fanquake/orgs",
        "repos_url": "https://api.github.com/users/fanquake/repos",
        "events_url": "https://api.github.com/users/fanquake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fanquake/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-05-09T07:38:37Z"
    }
  ]
}
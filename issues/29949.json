{
  "type": "issue",
  "issue": {
    "id": 2260609839,
    "node_id": "I_kwDOABII586Gvisv",
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29949",
    "repository_url": "https://api.github.com/repos/bitcoin/bitcoin",
    "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29949/labels%7B/name%7D",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29949/comments",
    "events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29949/events",
    "html_url": "https://github.com/bitcoin/bitcoin/issues/29949",
    "number": 29949,
    "state": "closed",
    "state_reason": "not_planned",
    "title": "Calling `walletprocesspsbt` to sign multisig containing `OP_GREATERTHANOREQUAL` op_code",
    "body": "### Is there an existing issue for this?\n\n- [X] I have searched the existing issues\n\n### Current behaviour\n\nI want to create signature by calling `walletprocesspsbt` endpoint to spend from multisig output. It is worth stating that this is taproot output with one leaf.\r\n\r\nWallet contains one of the key from multisig.  Key was created by first calling `getnewaddress` and then calling `getaddressinfo` and retrieving public key.\r\n\r\nNow the issue is that if multisig script is in format:\r\n`<key1> OP_CHECKSIG <key2> OP_CHECKSIGADD <key3> OP_CHECKSIGADD 2 OP_NUMEQUAL`\r\n\r\nwhere one of the keys is in wallet everything works as expected.\r\n\r\nPsbt to sign:\r\n```\r\n{\r\n  \"tx\": {\r\n    \"txid\": \"626f61fa0b711187cd29a82c7ec0ae56447a8c8b4955bf99c9c8a6459522cf40\",\r\n    \"hash\": \"626f61fa0b711187cd29a82c7ec0ae56447a8c8b4955bf99c9c8a6459522cf40\",\r\n    \"version\": 2,\r\n    \"size\": 82,\r\n    \"vsize\": 82,\r\n    \"weight\": 328,\r\n    \"locktime\": 0,\r\n    \"vin\": [\r\n      {\r\n        \"txid\": \"32f9c12fe803fa2c26c168850b424e260bca7191b39e775ddf946d51cb0c929b\",\r\n        \"vout\": 0,\r\n        \"scriptSig\": {\r\n          \"asm\": \"\",\r\n          \"hex\": \"\"\r\n        },\r\n        \"sequence\": 0\r\n      }\r\n    ],\r\n    \"vout\": [\r\n      {\r\n        \"value\": 0.00098000,\r\n        \"n\": 0,\r\n        \"scriptPubKey\": {\r\n          \"asm\": \"0 a2ec9907bfd06d26e41e8af835c8b2b39400bb56\",\r\n          \"desc\": \"addr(bcrt1q5tkfjpal6pkjdeq73turtj9jkw2qpw6kfnjp63)#3rygmz90\",\r\n          \"hex\": \"0014a2ec9907bfd06d26e41e8af835c8b2b39400bb56\",\r\n          \"address\": \"bcrt1q5tkfjpal6pkjdeq73turtj9jkw2qpw6kfnjp63\",\r\n          \"type\": \"witness_v0_keyhash\"\r\n        }\r\n      }\r\n    ]\r\n  },\r\n  \"global_xpubs\": [\r\n  ],\r\n  \"psbt_version\": 0,\r\n  \"proprietary\": [\r\n  ],\r\n  \"unknown\": {\r\n  },\r\n  \"inputs\": [\r\n    {\r\n      \"witness_utxo\": {\r\n        \"amount\": 0.00100000,\r\n        \"scriptPubKey\": {\r\n          \"asm\": \"1 c3e8e2c9fc6033f3ebcd9d5b39212f52873e8b6e356a64bd364d76e59011f33a\",\r\n          \"desc\": \"rawtr(c3e8e2c9fc6033f3ebcd9d5b39212f52873e8b6e356a64bd364d76e59011f33a)#kgt72cne\",\r\n          \"hex\": \"5120c3e8e2c9fc6033f3ebcd9d5b39212f52873e8b6e356a64bd364d76e59011f33a\",\r\n          \"address\": \"bcrt1pc05w9j0uvqel867dn4dnjgf022rnazmwx44xf0fkf4mwtyq37vaqrecrxw\",\r\n          \"type\": \"witness_v1_taproot\"\r\n        }\r\n      },\r\n      \"witness_script\": {\r\n        \"asm\": \"51af6bd7bdaa1e3d2dc777c27bdf76b7ad1161ee48197cd8cf0ea4523b3dfa53 OP_CHECKSIG 65a70371debcdafa542f1570282395054c082efada30e03d93c1b98cc1963403 OP_CHECKSIGADD 71a79e74ad98f51b2c299de2c10f298130e2c3be2c3a266767a2c55d420749a9 OP_CHECKSIGADD 2 OP_NUMEQUAL\",\r\n        \"hex\": \"2051af6bd7bdaa1e3d2dc777c27bdf76b7ad1161ee48197cd8cf0ea4523b3dfa53ac2065a70371debcdafa542f1570282395054c082efada30e03d93c1b98cc1963403ba2071a79e74ad98f51b2c299de2c10f298130e2c3be2c3a266767a2c55d420749a9ba529c\",\r\n        \"type\": \"nonstandard\"\r\n      },\r\n      \"taproot_scripts\": [\r\n        {\r\n          \"script\": \"2051af6bd7bdaa1e3d2dc777c27bdf76b7ad1161ee48197cd8cf0ea4523b3dfa53ac2065a70371debcdafa542f1570282395054c082efada30e03d93c1b98cc1963403ba2071a79e74ad98f51b2c299de2c10f298130e2c3be2c3a266767a2c55d420749a9ba529c\",\r\n          \"leaf_ver\": 192,\r\n          \"control_blocks\": [\r\n            \"c150929b74c1a04954b78b4b6035e97a5e078a5a0f28ec96d547bfee9ace803ac0\"\r\n          ]\r\n        }\r\n      ],\r\n      \"taproot_bip32_derivs\": [\r\n        {\r\n          \"pubkey\": \"65a70371debcdafa542f1570282395054c082efada30e03d93c1b98cc1963403\",\r\n          \"master_fingerprint\": \"00000000\",\r\n          \"path\": \"m\",\r\n          \"leaf_hashes\": [\r\n          ]\r\n        }\r\n      ],\r\n      \"taproot_internal_key\": \"50929b74c1a04954b78b4b6035e97a5e078a5a0f28ec96d547bfee9ace803ac0\",\r\n      \"taproot_merkle_root\": \"a0739e00a984d9cdfb5f08740d3c6b405af4d98baa7dfcc823cab15c8c465661\"\r\n    }\r\n  ],\r\n  \"outputs\": [\r\n    {\r\n    }\r\n  ],\r\n  \"fee\": 0.00002000\r\n}\r\n```\r\nPsbt signed:\r\n```\r\n{\r\n  \"tx\": {\r\n    \"txid\": \"626f61fa0b711187cd29a82c7ec0ae56447a8c8b4955bf99c9c8a6459522cf40\",\r\n    \"hash\": \"626f61fa0b711187cd29a82c7ec0ae56447a8c8b4955bf99c9c8a6459522cf40\",\r\n    \"version\": 2,\r\n    \"size\": 82,\r\n    \"vsize\": 82,\r\n    \"weight\": 328,\r\n    \"locktime\": 0,\r\n    \"vin\": [\r\n      {\r\n        \"txid\": \"32f9c12fe803fa2c26c168850b424e260bca7191b39e775ddf946d51cb0c929b\",\r\n        \"vout\": 0,\r\n        \"scriptSig\": {\r\n          \"asm\": \"\",\r\n          \"hex\": \"\"\r\n        },\r\n        \"sequence\": 0\r\n      }\r\n    ],\r\n    \"vout\": [\r\n      {\r\n        \"value\": 0.00098000,\r\n        \"n\": 0,\r\n        \"scriptPubKey\": {\r\n          \"asm\": \"0 a2ec9907bfd06d26e41e8af835c8b2b39400bb56\",\r\n          \"desc\": \"addr(bcrt1q5tkfjpal6pkjdeq73turtj9jkw2qpw6kfnjp63)#3rygmz90\",\r\n          \"hex\": \"0014a2ec9907bfd06d26e41e8af835c8b2b39400bb56\",\r\n          \"address\": \"bcrt1q5tkfjpal6pkjdeq73turtj9jkw2qpw6kfnjp63\",\r\n          \"type\": \"witness_v0_keyhash\"\r\n        }\r\n      }\r\n    ]\r\n  },\r\n  \"global_xpubs\": [\r\n  ],\r\n  \"psbt_version\": 0,\r\n  \"proprietary\": [\r\n  ],\r\n  \"unknown\": {\r\n  },\r\n  \"inputs\": [\r\n    {\r\n      \"witness_utxo\": {\r\n        \"amount\": 0.00100000,\r\n        \"scriptPubKey\": {\r\n          \"asm\": \"1 c3e8e2c9fc6033f3ebcd9d5b39212f52873e8b6e356a64bd364d76e59011f33a\",\r\n          \"desc\": \"rawtr(c3e8e2c9fc6033f3ebcd9d5b39212f52873e8b6e356a64bd364d76e59011f33a)#kgt72cne\",\r\n          \"hex\": \"5120c3e8e2c9fc6033f3ebcd9d5b39212f52873e8b6e356a64bd364d76e59011f33a\",\r\n          \"address\": \"bcrt1pc05w9j0uvqel867dn4dnjgf022rnazmwx44xf0fkf4mwtyq37vaqrecrxw\",\r\n          \"type\": \"witness_v1_taproot\"\r\n        }\r\n      },\r\n      \"witness_script\": {\r\n        \"asm\": \"51af6bd7bdaa1e3d2dc777c27bdf76b7ad1161ee48197cd8cf0ea4523b3dfa53 OP_CHECKSIG 65a70371debcdafa542f1570282395054c082efada30e03d93c1b98cc1963403 OP_CHECKSIGADD 71a79e74ad98f51b2c299de2c10f298130e2c3be2c3a266767a2c55d420749a9 OP_CHECKSIGADD 2 OP_NUMEQUAL\",\r\n        \"hex\": \"2051af6bd7bdaa1e3d2dc777c27bdf76b7ad1161ee48197cd8cf0ea4523b3dfa53ac2065a70371debcdafa542f1570282395054c082efada30e03d93c1b98cc1963403ba2071a79e74ad98f51b2c299de2c10f298130e2c3be2c3a266767a2c55d420749a9ba529c\",\r\n        \"type\": \"nonstandard\"\r\n      },\r\n      \"taproot_script_path_sigs\": [\r\n        {\r\n          \"pubkey\": \"65a70371debcdafa542f1570282395054c082efada30e03d93c1b98cc1963403\",\r\n          \"leaf_hash\": \"a0739e00a984d9cdfb5f08740d3c6b405af4d98baa7dfcc823cab15c8c465661\",\r\n          \"sig\": \"34ac8762e23d1521611f67ce608bf36a46ed5036b2cbc4fa3d6b8bde8d85449eea31e52422589199e63c0d0fd62fd6e03d840e00bf03d52c6e5e7987e1901a1a\"\r\n        }\r\n      ],\r\n      \"taproot_scripts\": [\r\n        {\r\n          \"script\": \"2051af6bd7bdaa1e3d2dc777c27bdf76b7ad1161ee48197cd8cf0ea4523b3dfa53ac2065a70371debcdafa542f1570282395054c082efada30e03d93c1b98cc1963403ba2071a79e74ad98f51b2c299de2c10f298130e2c3be2c3a266767a2c55d420749a9ba529c\",\r\n          \"leaf_ver\": 192,\r\n          \"control_blocks\": [\r\n            \"c150929b74c1a04954b78b4b6035e97a5e078a5a0f28ec96d547bfee9ace803ac0\"\r\n          ]\r\n        }\r\n      ],\r\n      \"taproot_bip32_derivs\": [\r\n        {\r\n          \"pubkey\": \"65a70371debcdafa542f1570282395054c082efada30e03d93c1b98cc1963403\",\r\n          \"master_fingerprint\": \"00000000\",\r\n          \"path\": \"m\",\r\n          \"leaf_hashes\": [\r\n          ]\r\n        }\r\n      ],\r\n      \"taproot_internal_key\": \"50929b74c1a04954b78b4b6035e97a5e078a5a0f28ec96d547bfee9ace803ac0\",\r\n      \"taproot_merkle_root\": \"a0739e00a984d9cdfb5f08740d3c6b405af4d98baa7dfcc823cab15c8c465661\"\r\n    }\r\n  ],\r\n  \"outputs\": [\r\n    {\r\n    }\r\n  ],\r\n  \"fee\": 0.00002000\r\n}\r\n```\r\n\r\nIssue arises when script is changed to similar, but different form:\r\n`<key1> OP_CHECKSIG <key2> OP_CHECKSIGADD <key3> OP_CHECKSIGADD 2 OP_GREATERTHANOREQUAL`\r\n\r\nWith such script psbt becomes:\r\n```\r\n{\r\n  \"tx\": {\r\n    \"txid\": \"c0ee6554b98748d4bddb2f1fefae3e3470f70ba4901fceb56caf1df502cca29c\",\r\n    \"hash\": \"c0ee6554b98748d4bddb2f1fefae3e3470f70ba4901fceb56caf1df502cca29c\",\r\n    \"version\": 2,\r\n    \"size\": 82,\r\n    \"vsize\": 82,\r\n    \"weight\": 328,\r\n    \"locktime\": 0,\r\n    \"vin\": [\r\n      {\r\n        \"txid\": \"c660a8f365c54bf78f5a7f7d59d7b02d81d76434117433e0719f50b19d793c3f\",\r\n        \"vout\": 0,\r\n        \"scriptSig\": {\r\n          \"asm\": \"\",\r\n          \"hex\": \"\"\r\n        },\r\n        \"sequence\": 0\r\n      }\r\n    ],\r\n    \"vout\": [\r\n      {\r\n        \"value\": 0.00098000,\r\n        \"n\": 0,\r\n        \"scriptPubKey\": {\r\n          \"asm\": \"0 885d64578216908d6e0a745295149a648deb89cb\",\r\n          \"desc\": \"addr(bcrt1q3pwkg4uzz6gg6ms2w3ff29y6vjx7hzwt6dg29t)#2kplfgfu\",\r\n          \"hex\": \"0014885d64578216908d6e0a745295149a648deb89cb\",\r\n          \"address\": \"bcrt1q3pwkg4uzz6gg6ms2w3ff29y6vjx7hzwt6dg29t\",\r\n          \"type\": \"witness_v0_keyhash\"\r\n        }\r\n      }\r\n    ]\r\n  },\r\n  \"global_xpubs\": [\r\n  ],\r\n  \"psbt_version\": 0,\r\n  \"proprietary\": [\r\n  ],\r\n  \"unknown\": {\r\n  },\r\n  \"inputs\": [\r\n    {\r\n      \"witness_utxo\": {\r\n        \"amount\": 0.00100000,\r\n        \"scriptPubKey\": {\r\n          \"asm\": \"1 acd1d2a6e6b8a5366046fc8c4b0beb0f1f731416ddfc2b6ce5e8a6ec05494d22\",\r\n          \"desc\": \"rawtr(acd1d2a6e6b8a5366046fc8c4b0beb0f1f731416ddfc2b6ce5e8a6ec05494d22)#l0v0wqh8\",\r\n          \"hex\": \"5120acd1d2a6e6b8a5366046fc8c4b0beb0f1f731416ddfc2b6ce5e8a6ec05494d22\",\r\n          \"address\": \"bcrt1p4nga9fhxhzjnvczxljxykzltpu0hx9qkmh7zkm89aznwcp2ff53qlumd30\",\r\n          \"type\": \"witness_v1_taproot\"\r\n        }\r\n      },\r\n      \"witness_script\": {\r\n        \"asm\": \"1ab6538f0041c05f205f04b8f98f671ab30059ebabba92abfc0b717b663ff6e8 OP_CHECKSIG 6b198710ea0801dd2bd0fa492745ade0287a56ad3de5db3b16cb2da00d67dd0d OP_CHECKSIGADD dcd39254d982fc1e65e71b765e278115a53d25351ccebf64c213d70f69804957 OP_CHECKSIGADD 2 OP_GREATERTHANOREQUAL\",\r\n        \"hex\": \"201ab6538f0041c05f205f04b8f98f671ab30059ebabba92abfc0b717b663ff6e8ac206b198710ea0801dd2bd0fa492745ade0287a56ad3de5db3b16cb2da00d67dd0dba20dcd39254d982fc1e65e71b765e278115a53d25351ccebf64c213d70f69804957ba52a2\",\r\n        \"type\": \"nonstandard\"\r\n      },\r\n      \"taproot_scripts\": [\r\n        {\r\n          \"script\": \"201ab6538f0041c05f205f04b8f98f671ab30059ebabba92abfc0b717b663ff6e8ac206b198710ea0801dd2bd0fa492745ade0287a56ad3de5db3b16cb2da00d67dd0dba20dcd39254d982fc1e65e71b765e278115a53d25351ccebf64c213d70f69804957ba52a2\",\r\n          \"leaf_ver\": 192,\r\n          \"control_blocks\": [\r\n            \"c150929b74c1a04954b78b4b6035e97a5e078a5a0f28ec96d547bfee9ace803ac0\"\r\n          ]\r\n        }\r\n      ],\r\n      \"taproot_bip32_derivs\": [\r\n        {\r\n          \"pubkey\": \"dcd39254d982fc1e65e71b765e278115a53d25351ccebf64c213d70f69804957\",\r\n          \"master_fingerprint\": \"00000000\",\r\n          \"path\": \"m\",\r\n          \"leaf_hashes\": [\r\n          ]\r\n        }\r\n      ],\r\n      \"taproot_internal_key\": \"50929b74c1a04954b78b4b6035e97a5e078a5a0f28ec96d547bfee9ace803ac0\",\r\n      \"taproot_merkle_root\": \"8dcf9fd2a9bff82480b8113d97bdd1f1b0324c58cb7f767421bf4764e6e40536\"\r\n    }\r\n  ],\r\n  \"outputs\": [\r\n    {\r\n    }\r\n  ],\r\n  \"fee\": 0.00002000\r\n}\r\n```\r\n\r\nIn this case bitcoind, returns the same psbt, without `taproot_script_path_sigs` field or any error.\r\n\r\nI actually created question on bitcoin stack exchange - https://bitcoin.stackexchange.com/questions/122759/how-can-i-sign-custom-tapscript-leaf-using-bitcoind-walletprocesspsbt-rpc-endp, but looked into this a bit deeper and isolated \r\n`OP_GREATERTHANOREQUAL` as op code which made all difference.\r\n\n\n### Expected behaviour\n\nIn this case I would expect:\r\n- either return signatures also for script containing `OP_GREATERTHANOREQUAL`\r\n- or return error saying that this op_code is not supported for `walletprocesspsbt` call\n\n### Steps to reproduce\n\n1. Create wallet with the `key` which should later become part of the multisig.\r\n2. Create taproot output with one script spending path. The script should be the taproot multi sig (`OP_CHECKSIGADD`) with `OP_GREATERTHANOREQUAL` opcode and contain `key` created in step 1\r\n3. Create `psbt` and call `walletprocesspsbt` endpoint on wallet created in step 1\r\n4. Response should be an error or psbt with signature made by `key`\n\n### Relevant log output\n\n_No response_\n\n### How did you obtain Bitcoin Core\n\nPre-built binaries\n\n### What version of Bitcoin Core are you using?\n\nv26.0\n\n### Operating system and version\n\n\"MacOs Sonoma 14.3\"\n\n### Machine specifications\n\n_No response_",
    "user": {
      "login": "KonradStaniec",
      "id": 10688236,
      "node_id": "MDQ6VXNlcjEwNjg4MjM2",
      "avatar_url": "https://avatars.githubusercontent.com/u/10688236?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/KonradStaniec",
      "html_url": "https://github.com/KonradStaniec",
      "followers_url": "https://api.github.com/users/KonradStaniec/followers",
      "following_url": "https://api.github.com/users/KonradStaniec/following%7B/other_user%7D",
      "gists_url": "https://api.github.com/users/KonradStaniec/gists%7B/gist_id%7D",
      "starred_url": "https://api.github.com/users/KonradStaniec/starred%7B/owner%7D%7B/repo%7D",
      "subscriptions_url": "https://api.github.com/users/KonradStaniec/subscriptions",
      "organizations_url": "https://api.github.com/users/KonradStaniec/orgs",
      "repos_url": "https://api.github.com/users/KonradStaniec/repos",
      "events_url": "https://api.github.com/users/KonradStaniec/events%7B/privacy%7D",
      "received_events_url": "https://api.github.com/users/KonradStaniec/received_events",
      "type": "User",
      "site_admin": false,
      "patch_url": null
    },
    "labels": [],
    "assignees": [],
    "author_association": "NONE",
    "locked": true,
    "comments": 4,
    "closed_at": "2024-04-25T14:02:05Z",
    "closed_by": {
      "login": "achow101",
      "id": 3782274,
      "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/achow101",
      "html_url": "https://github.com/achow101",
      "followers_url": "https://api.github.com/users/achow101/followers",
      "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
      "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
      "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
      "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
      "organizations_url": "https://api.github.com/users/achow101/orgs",
      "repos_url": "https://api.github.com/users/achow101/repos",
      "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
      "received_events_url": "https://api.github.com/users/achow101/received_events",
      "type": "User",
      "site_admin": false,
      "patch_url": null
    },
    "created_at": "2024-04-24T07:43:25Z",
    "updated_at": "2025-04-25T07:50:17Z"
  },
  "events": [
    {
      "event": "commented",
      "id": 2075118310,
      "node_id": "IC_kwDOABII5857r8rm",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2075118310",
      "actor": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-04-24T14:42:23Z",
      "updated_at": "2024-04-24T14:42:23Z",
      "author_association": "MEMBER",
      "body": "Bitcoin Core cannot sign non-standard scripts or scripts that are not Miniscript. This is expected behavior. `walletprocesspsbt` does not return an error because signing is not the only thing that it does, so returning an error for a failing to sign is not appropriate.",
      "user": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/issues/29949#issuecomment-2075118310",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29949"
    },
    {
      "event": "commented",
      "id": 2075135656,
      "node_id": "IC_kwDOABII5857sA6o",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2075135656",
      "actor": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-04-24T14:50:28Z",
      "updated_at": "2024-04-24T14:50:28Z",
      "author_association": "MEMBER",
      "body": "For some more background, Bitcoin Core has logic to try various things when signing, which includes Miniscript. The script variant you tried with `OP_NUMEQUAL` at the end is valid Miniscript (`multi_a(2,<key1>,<key2>,<key3>)` specifically), but the variant with `OP_GREATERTHANOREQUAL` is not.\r\n\r\nWhen signing fails, Bitcoin Core doesn't know why it failed; it simply didn't find any patterns it knew how to sign for, and as @achow101 points out, it doesn't even know your intent was to sign.",
      "user": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/issues/29949#issuecomment-2075135656",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29949"
    },
    {
      "event": "mentioned",
      "id": 12593370304,
      "node_id": "MEE_lADOABII586GvisvzwAAAALun5TA",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/12593370304",
      "actor": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-04-24T14:50:29Z"
    },
    {
      "event": "subscribed",
      "id": 12593370316,
      "node_id": "SE_lADOABII586GvisvzwAAAALun5TM",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/12593370316",
      "actor": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-04-24T14:50:30Z"
    },
    {
      "event": "commented",
      "id": 2076276040,
      "node_id": "IC_kwDOABII5857wXVI",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2076276040",
      "actor": {
        "login": "KonradStaniec",
        "id": 10688236,
        "node_id": "MDQ6VXNlcjEwNjg4MjM2",
        "avatar_url": "https://avatars.githubusercontent.com/u/10688236?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/KonradStaniec",
        "html_url": "https://github.com/KonradStaniec",
        "followers_url": "https://api.github.com/users/KonradStaniec/followers",
        "following_url": "https://api.github.com/users/KonradStaniec/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/KonradStaniec/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/KonradStaniec/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/KonradStaniec/subscriptions",
        "organizations_url": "https://api.github.com/users/KonradStaniec/orgs",
        "repos_url": "https://api.github.com/users/KonradStaniec/repos",
        "events_url": "https://api.github.com/users/KonradStaniec/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/KonradStaniec/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-04-25T03:16:08Z",
      "updated_at": "2024-04-25T11:05:42Z",
      "author_association": "NONE",
      "body": "Thanks for the quick responses! I think this issue can be closed then.\r\n\r\nTwo follow up questions, I would have:\r\n1. Is there some other way to sign transaction, through bitcoind, which tries to spend from script which is not compatible with miniscript ?\r\n2. Is there some problem with `OP_GREATERTHANOREQUAL`  which makes it non compatible with Miniscript ?",
      "user": {
        "login": "KonradStaniec",
        "id": 10688236,
        "node_id": "MDQ6VXNlcjEwNjg4MjM2",
        "avatar_url": "https://avatars.githubusercontent.com/u/10688236?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/KonradStaniec",
        "html_url": "https://github.com/KonradStaniec",
        "followers_url": "https://api.github.com/users/KonradStaniec/followers",
        "following_url": "https://api.github.com/users/KonradStaniec/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/KonradStaniec/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/KonradStaniec/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/KonradStaniec/subscriptions",
        "organizations_url": "https://api.github.com/users/KonradStaniec/orgs",
        "repos_url": "https://api.github.com/users/KonradStaniec/repos",
        "events_url": "https://api.github.com/users/KonradStaniec/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/KonradStaniec/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/issues/29949#issuecomment-2076276040",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29949"
    },
    {
      "event": "commented",
      "id": 2077274021,
      "node_id": "IC_kwDOABII58570K-l",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2077274021",
      "actor": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-04-25T14:02:05Z",
      "updated_at": "2024-04-25T14:02:05Z",
      "author_association": "MEMBER",
      "body": "> Is there some other way to sign transaction, through bitcoind, which tries to spend from script which is not compatible with miniscript ?\r\n\r\nNo\r\n\r\n> Is there some problem with `OP_GREATERTHANOREQUAL` which makes it non compatible with Miniscript ?\r\n\r\nYes, it is third party malleable, which makes it much harder to do analysis. For any additional signatures provided after the threshold has been reached, a third party can trivially remove those signatures and the transaction is still valid. Miniscript tries to not be third party malleable, and this script construction is trivially malleable, so it is not compatible.",
      "user": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/issues/29949#issuecomment-2077274021",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29949"
    },
    {
      "event": "closed",
      "id": 12609201081,
      "node_id": "CE_lADOABII586GvisvzwAAAALvkSO5",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/12609201081",
      "actor": {
        "login": "achow101",
        "id": 3782274,
        "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/achow101",
        "html_url": "https://github.com/achow101",
        "followers_url": "https://api.github.com/users/achow101/followers",
        "following_url": "https://api.github.com/users/achow101/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/achow101/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/achow101/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
        "organizations_url": "https://api.github.com/users/achow101/orgs",
        "repos_url": "https://api.github.com/users/achow101/repos",
        "events_url": "https://api.github.com/users/achow101/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/achow101/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-04-25T14:02:05Z"
    },
    {
      "event": "locked",
      "id": 17402018744,
      "node_id": "LOE_lADOABII586GvisvzwAAAAQNPbu4",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/17402018744",
      "actor": {
        "login": "bitcoin",
        "id": 528860,
        "node_id": "MDEyOk9yZ2FuaXphdGlvbjUyODg2MA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/528860?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/bitcoin",
        "html_url": "https://github.com/bitcoin",
        "followers_url": "https://api.github.com/users/bitcoin/followers",
        "following_url": "https://api.github.com/users/bitcoin/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/bitcoin/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/bitcoin/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/bitcoin/subscriptions",
        "organizations_url": "https://api.github.com/users/bitcoin/orgs",
        "repos_url": "https://api.github.com/users/bitcoin/repos",
        "events_url": "https://api.github.com/users/bitcoin/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/bitcoin/received_events",
        "type": "Organization",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-04-25T07:50:17Z"
    }
  ]
}
{
  "type": "issue",
  "issue": {
    "id": 2125507739,
    "node_id": "I_kwDOABII585-sKyb",
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29410",
    "repository_url": "https://api.github.com/repos/bitcoin/bitcoin",
    "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29410/labels%7B/name%7D",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29410/comments",
    "events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29410/events",
    "html_url": "https://github.com/bitcoin/bitcoin/issues/29410",
    "number": 29410,
    "state": "open",
    "state_reason": null,
    "title": "p2p: lingering entries in `mapBlockSource`",
    "body": "Opening an issue per https://github.com/bitcoin/bitcoin/pull/28235#issuecomment-1927184068\r\n\r\nIf we receive a valid block that passes the anti-DoS threshold but doesn't advance the tip, the `BlockChecked` callback won't be called. This is because `ActivateBestChain` will return early since `pindexMostWork` is equal to `m_chain.Tip()`. Since the `BlockChecked` callback isn't called, `mapBlockSource` won't be removed from.",
    "user": {
      "login": "Crypt-iQ",
      "id": 15145615,
      "node_id": "MDQ6VXNlcjE1MTQ1NjE1",
      "avatar_url": "https://avatars.githubusercontent.com/u/15145615?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Crypt-iQ",
      "html_url": "https://github.com/Crypt-iQ",
      "followers_url": "https://api.github.com/users/Crypt-iQ/followers",
      "following_url": "https://api.github.com/users/Crypt-iQ/following%7B/other_user%7D",
      "gists_url": "https://api.github.com/users/Crypt-iQ/gists%7B/gist_id%7D",
      "starred_url": "https://api.github.com/users/Crypt-iQ/starred%7B/owner%7D%7B/repo%7D",
      "subscriptions_url": "https://api.github.com/users/Crypt-iQ/subscriptions",
      "organizations_url": "https://api.github.com/users/Crypt-iQ/orgs",
      "repos_url": "https://api.github.com/users/Crypt-iQ/repos",
      "events_url": "https://api.github.com/users/Crypt-iQ/events%7B/privacy%7D",
      "received_events_url": "https://api.github.com/users/Crypt-iQ/received_events",
      "type": "User",
      "site_admin": false,
      "patch_url": null
    },
    "labels": [],
    "assignees": [],
    "author_association": "CONTRIBUTOR",
    "locked": false,
    "comments": 5,
    "created_at": "2024-02-08T15:51:21Z",
    "updated_at": "2025-05-01T19:59:14Z"
  },
  "events": [
    {
      "event": "commented",
      "id": 1934529375,
      "node_id": "IC_kwDOABII585zTpNf",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1934529375",
      "actor": {
        "login": "dergoegge",
        "id": 8077169,
        "node_id": "MDQ6VXNlcjgwNzcxNjk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8077169?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dergoegge",
        "html_url": "https://github.com/dergoegge",
        "followers_url": "https://api.github.com/users/dergoegge/followers",
        "following_url": "https://api.github.com/users/dergoegge/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dergoegge/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dergoegge/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dergoegge/subscriptions",
        "organizations_url": "https://api.github.com/users/dergoegge/orgs",
        "repos_url": "https://api.github.com/users/dergoegge/repos",
        "events_url": "https://api.github.com/users/dergoegge/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dergoegge/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-02-08T16:47:55Z",
      "updated_at": "2024-02-08T16:50:08Z",
      "author_association": "MEMBER",
      "body": "I think removing entries from `mapBlockSource` once the corresponding peers disconnect would make the most sense because we want to be able to punish the source in case the block turns out to be invalid. If we expire or otherwise prematurely remove from the map we lose that ability.\r\n\r\nSomething like the following in `FinalizeNode`:\r\n```c++\r\n    for (auto it = mapBlockSource.begin(); it != mapBlockSource.end();) {\r\n        auto& [hash, entry] = *it;\r\n        if (entry.first == node.GetId()) {\r\n            it = mapBlockSource.erase(it);\r\n        } else {\r\n            ++it;\r\n        }\r\n    }\r\n```",
      "user": {
        "login": "dergoegge",
        "id": 8077169,
        "node_id": "MDQ6VXNlcjgwNzcxNjk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8077169?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dergoegge",
        "html_url": "https://github.com/dergoegge",
        "followers_url": "https://api.github.com/users/dergoegge/followers",
        "following_url": "https://api.github.com/users/dergoegge/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/dergoegge/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/dergoegge/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/dergoegge/subscriptions",
        "organizations_url": "https://api.github.com/users/dergoegge/orgs",
        "repos_url": "https://api.github.com/users/dergoegge/repos",
        "events_url": "https://api.github.com/users/dergoegge/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/dergoegge/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/issues/29410#issuecomment-1934529375",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29410"
    },
    {
      "event": "commented",
      "id": 2693020111,
      "node_id": "IC_kwDOABII586ghDnP",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2693020111",
      "actor": {
        "login": "Crypt-iQ",
        "id": 15145615,
        "node_id": "MDQ6VXNlcjE1MTQ1NjE1",
        "avatar_url": "https://avatars.githubusercontent.com/u/15145615?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Crypt-iQ",
        "html_url": "https://github.com/Crypt-iQ",
        "followers_url": "https://api.github.com/users/Crypt-iQ/followers",
        "following_url": "https://api.github.com/users/Crypt-iQ/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Crypt-iQ/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Crypt-iQ/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Crypt-iQ/subscriptions",
        "organizations_url": "https://api.github.com/users/Crypt-iQ/orgs",
        "repos_url": "https://api.github.com/users/Crypt-iQ/repos",
        "events_url": "https://api.github.com/users/Crypt-iQ/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Crypt-iQ/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-03-03T00:53:16Z",
      "updated_at": "2025-03-03T00:53:16Z",
      "author_association": "CONTRIBUTOR",
      "body": "I left some details out of both the original PR and this issue and I think the missing information is needed to come to a solution:\n- Node A is currently at height `h` and receives a `BLOCK` message from an _honest_ peer B for a stale block at height `h`. There are a couple ways that a `BLOCK` message could be sent instead of a `CMPCTBLOCK` message. For example, the compact-block slots could all be taken by an attacker or maybe there was a [collision for short ids](https://github.com/bitcoin/bitcoin/blob/3c1f72a36700271c7c1293383549c3be29f28edb/src/net_processing.cpp#L4414-L4418). This will leave an entry in `mapBlockSource` where the punishment boolean is [set to `true`](https://github.com/bitcoin/bitcoin/blob/3c1f72a36700271c7c1293383549c3be29f28edb/src/net_processing.cpp#L4617-L4620).\n- A malicious peer C can then send a mutated `BLOCK` message to node A for the stale block. When execution hits [this line](https://github.com/bitcoin/bitcoin/blob/3c1f72a36700271c7c1293383549c3be29f28edb/src/net_processing.cpp#L4620), the `emplace` call won't actually add a new entry to `mapBlockSource` since one already exists.  See https://en.cppreference.com/w/cpp/container/map/emplace.\n- Since the block is mutated, it will fail validation and cause the [`BlockChecked` callback to be called.](https://github.com/bitcoin/bitcoin/blob/3c1f72a36700271c7c1293383549c3be29f28edb/src/validation.cpp#L4617) This will cause node A to punish peer B and disconnect them.\n\nSince there is a disconnect issue, I don't think the map can be cleaned up once the peer disconnects and instead has to be done earlier. I don't think the potential for harm here is very high, since somebody would need to get lucky or be able to generate stale blocks. It might be possible to abuse this during IBD if one knew historical stale blocks and had saved them, but I think that would also require some luck.",
      "user": {
        "login": "Crypt-iQ",
        "id": 15145615,
        "node_id": "MDQ6VXNlcjE1MTQ1NjE1",
        "avatar_url": "https://avatars.githubusercontent.com/u/15145615?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Crypt-iQ",
        "html_url": "https://github.com/Crypt-iQ",
        "followers_url": "https://api.github.com/users/Crypt-iQ/followers",
        "following_url": "https://api.github.com/users/Crypt-iQ/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Crypt-iQ/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Crypt-iQ/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Crypt-iQ/subscriptions",
        "organizations_url": "https://api.github.com/users/Crypt-iQ/orgs",
        "repos_url": "https://api.github.com/users/Crypt-iQ/repos",
        "events_url": "https://api.github.com/users/Crypt-iQ/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Crypt-iQ/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/issues/29410#issuecomment-2693020111",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29410"
    },
    {
      "event": "subscribed",
      "id": 16527852575,
      "node_id": "SE_lADOABII585-sKybzwAAAAPZIwQf",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/16527852575",
      "actor": {
        "login": "stratospher",
        "id": 44024636,
        "node_id": "MDQ6VXNlcjQ0MDI0NjM2",
        "avatar_url": "https://avatars.githubusercontent.com/u/44024636?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stratospher",
        "html_url": "https://github.com/stratospher",
        "followers_url": "https://api.github.com/users/stratospher/followers",
        "following_url": "https://api.github.com/users/stratospher/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stratospher/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stratospher/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stratospher/subscriptions",
        "organizations_url": "https://api.github.com/users/stratospher/orgs",
        "repos_url": "https://api.github.com/users/stratospher/repos",
        "events_url": "https://api.github.com/users/stratospher/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stratospher/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-03-03T04:09:44Z"
    },
    {
      "event": "commented",
      "id": 2703525661,
      "node_id": "IC_kwDOABII586hJIcd",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2703525661",
      "actor": {
        "login": "Crypt-iQ",
        "id": 15145615,
        "node_id": "MDQ6VXNlcjE1MTQ1NjE1",
        "avatar_url": "https://avatars.githubusercontent.com/u/15145615?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Crypt-iQ",
        "html_url": "https://github.com/Crypt-iQ",
        "followers_url": "https://api.github.com/users/Crypt-iQ/followers",
        "following_url": "https://api.github.com/users/Crypt-iQ/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Crypt-iQ/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Crypt-iQ/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Crypt-iQ/subscriptions",
        "organizations_url": "https://api.github.com/users/Crypt-iQ/orgs",
        "repos_url": "https://api.github.com/users/Crypt-iQ/repos",
        "events_url": "https://api.github.com/users/Crypt-iQ/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Crypt-iQ/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-03-06T11:05:09Z",
      "updated_at": "2025-03-06T15:33:40Z",
      "author_association": "CONTRIBUTOR",
      "body": "The disconnect issue appears to have been fixed in https://github.com/bitcoin/bitcoin/commit/49257c0304828a185c273fcb99742c54bbef0c8e by no longer processing mutated blocks. The disconnect issue was present in a functional test I wrote when I originally opened the PR.",
      "user": {
        "login": "Crypt-iQ",
        "id": 15145615,
        "node_id": "MDQ6VXNlcjE1MTQ1NjE1",
        "avatar_url": "https://avatars.githubusercontent.com/u/15145615?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Crypt-iQ",
        "html_url": "https://github.com/Crypt-iQ",
        "followers_url": "https://api.github.com/users/Crypt-iQ/followers",
        "following_url": "https://api.github.com/users/Crypt-iQ/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Crypt-iQ/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Crypt-iQ/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Crypt-iQ/subscriptions",
        "organizations_url": "https://api.github.com/users/Crypt-iQ/orgs",
        "repos_url": "https://api.github.com/users/Crypt-iQ/repos",
        "events_url": "https://api.github.com/users/Crypt-iQ/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Crypt-iQ/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/issues/29410#issuecomment-2703525661",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29410"
    },
    {
      "event": "commented",
      "id": 2845013677,
      "node_id": "IC_kwDOABII586pk3at",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2845013677",
      "actor": {
        "login": "Crypt-iQ",
        "id": 15145615,
        "node_id": "MDQ6VXNlcjE1MTQ1NjE1",
        "avatar_url": "https://avatars.githubusercontent.com/u/15145615?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Crypt-iQ",
        "html_url": "https://github.com/Crypt-iQ",
        "followers_url": "https://api.github.com/users/Crypt-iQ/followers",
        "following_url": "https://api.github.com/users/Crypt-iQ/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Crypt-iQ/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Crypt-iQ/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Crypt-iQ/subscriptions",
        "organizations_url": "https://api.github.com/users/Crypt-iQ/orgs",
        "repos_url": "https://api.github.com/users/Crypt-iQ/repos",
        "events_url": "https://api.github.com/users/Crypt-iQ/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Crypt-iQ/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-05-01T15:00:53Z",
      "updated_at": "2025-05-01T15:05:20Z",
      "author_association": "CONTRIBUTOR",
      "body": "I think we should either: 1) document all of `mapBlockSource` quirks with comments and merge tests that improve the code coverage in this area, or 2) stop usage of `mapBlockSource` in the `BlockChecked` callback and instead only have punishment / reward happen when blocks are received in-order. I have done a bit of option 1) and will summarize current behavior below:\n\n**Punishment:**\n- i) This happens in or out of IBD. Notice the lack of an IBD check [here](https://github.com/bitcoin/bitcoin/blob/51d76634fb57fc7a3382fa26389e6c7f863bea76/src/net_processing.cpp#L2116).\n- ii) The `BlockChecked` callback is usually called immediately if failure occurs in [`CheckBlock` / `AcceptBlock`](https://github.com/bitcoin/bitcoin/blob/fc6346dbc8dc3db40aad4079210332b5f8b332ed/src/validation.cpp#L4565).\n- iii) The callback may also be called during out-of-order validation and will punish if it finds an invalid block in [`ConnectTip`](https://github.com/bitcoin/bitcoin/blob/fc6346dbc8dc3db40aad4079210332b5f8b332ed/src/validation.cpp#L3172). Note that out-of-order validation is likely to occur in IBD and not likely to occur outside of IBD.\n- iv) Stale and invalid tips may not be punished. This is because `ActivateBestChain` won't call [`ConnectTip`](https://github.com/bitcoin/bitcoin/blob/fc6346dbc8dc3db40aad4079210332b5f8b332ed/src/validation.cpp#L3172).\n\n**Reward:**\n- v) This happens only [outside of IBD](https://github.com/bitcoin/bitcoin/blob/51d76634fb57fc7a3382fa26389e6c7f863bea76/src/net_processing.cpp#L2125).\n- vi) The `BlockChecked` callback is usually called immediately in the case of success. It may also be called out-of-order.\n- vii) Stale and valid tips may not be rewarded. Like above, this is because `ActivateBestChain` won't call [`ConnectTip`](https://github.com/bitcoin/bitcoin/blob/fc6346dbc8dc3db40aad4079210332b5f8b332ed/src/validation.cpp#L3172).\n\n**Problems with out-of-order blocks**\nThe in-order blocks case is easy to understand and punishment/reward happens normally. The out-of-order blocks case leads to two minor issues with `mapBlockSource`:\n\n1. If we receive an out-of-order invalid block, it is possible to bypass the punishment mechanism.\n   - Peer 1 sends HEADERS for height `h+1`, which the target node then requests.\n   - Peer 2 sends HEADERS for invalid block at height `h+2`, which the target node then requests.\n   - Peer 2 sends the invalid block `h+2`. Since `h+1` hasn't been received yet, the target node's tip stays the same.\n   - Peer 3 sends the invalid block `h+2`. This calls [`mapBlockSource.emplace`](https://github.com/bitcoin/bitcoin/blob/51d76634fb57fc7a3382fa26389e6c7f863bea76/src/net_processing.cpp#L4650), but there is already an entry for the hash and so this is a no-op. Peer 2 & 3 would only send this invalid block if they were in some way malicious as fast-announcing a possibly-invalid block via CMPCTBLOCK doesn't seem to be implemented.\n     - `ProcessBlock` is then called and since Peer 3 hasn't sent over a new block, the [`mapBlockSource.erase`](https://github.com/bitcoin/bitcoin/blob/51d76634fb57fc7a3382fa26389e6c7f863bea76/src/net_processing.cpp#L3318) is hit, removing Peer 2's entry from the map for `h+2`.\n   - Peer 1 sends the valid block `h+1`. This will cause the `BlockChecked` callback to be invoked for `h+2`.\n     - [`mapBlockSource.find`](https://github.com/bitcoin/bitcoin/blob/51d76634fb57fc7a3382fa26389e6c7f863bea76/src/net_processing.cpp#L2109) will not find the previous entry since it was deleted.\n2. If we receive an out-of-order valid block, it is possible to bypass the reward mechanism.\n   - This is the exact same as the above, except that `h+2` is valid and we must not be in IBD.\n\nOne of the root issues here is that `mapBlockSource` is not a `std::multimap`, so further calls to `mapBlockSource.emplace` are a no-op and calls to `mapBlockSource.erase` are premature. It was at one point suggested that it become a multimap (see: [IRC](https://gnusha.org/bitcoin-core-dev/2016-11-10.log)) because the original intent behind the map seems to be parallel block validation in combination with allowing nodes to announce blocks via compact-block relay before fully validating them. These out-of-order issues are alluded to [here](https://github.com/bitcoin/bitcoin/pull/9075#discussion_r87104196) and tie-in with the above linked IRC discussion.\n\n**Problems with stale blocks**\n- If we receive a stale valid or invalid block, the `BlockChecked` callback is never called, leading to lingering entries in `mapBlockSource`. This is the issue outlined in the OP.\n\n**Zooming out**\n\nTaking all the above, it doesn't seem that out-of-order reward or punishment is useful. Out-of-order reward only occurs if we are out of IBD, but most out-of-order validation is going to occur during IBD. Out-of-order punishment only occurs if the peer is sending us invalid blocks that pass `AcceptBlock` -- this does not seem particularly useful as pointed out in [this comment](https://github.com/bitcoin/bitcoin/pull/28235#issuecomment-1673249593). I think @mzumsande suggestion to punish / reward immediately makes the most sense.\n\nI have written a functional test that demonstrates the three issues outlined above and can be merged if option 1) is the best bet: https://github.com/Crypt-iQ/bitcoin/commit/c3a5bbb779e5156f623072d25dae733cda8a7d79\n\ncc @mzumsande @instagibbs @luke-jr since y'all commented on the original PR I made.",
      "user": {
        "login": "Crypt-iQ",
        "id": 15145615,
        "node_id": "MDQ6VXNlcjE1MTQ1NjE1",
        "avatar_url": "https://avatars.githubusercontent.com/u/15145615?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Crypt-iQ",
        "html_url": "https://github.com/Crypt-iQ",
        "followers_url": "https://api.github.com/users/Crypt-iQ/followers",
        "following_url": "https://api.github.com/users/Crypt-iQ/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Crypt-iQ/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Crypt-iQ/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Crypt-iQ/subscriptions",
        "organizations_url": "https://api.github.com/users/Crypt-iQ/orgs",
        "repos_url": "https://api.github.com/users/Crypt-iQ/repos",
        "events_url": "https://api.github.com/users/Crypt-iQ/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Crypt-iQ/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/issues/29410#issuecomment-2845013677",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29410"
    },
    {
      "event": "mentioned",
      "id": 17488633424,
      "node_id": "MEE_lADOABII585-sKybzwAAAAQSZ15Q",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/17488633424",
      "actor": {
        "login": "luke-jr",
        "id": 1095675,
        "node_id": "MDQ6VXNlcjEwOTU2NzU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1095675?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/luke-jr",
        "html_url": "https://github.com/luke-jr",
        "followers_url": "https://api.github.com/users/luke-jr/followers",
        "following_url": "https://api.github.com/users/luke-jr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/luke-jr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/luke-jr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/luke-jr/subscriptions",
        "organizations_url": "https://api.github.com/users/luke-jr/orgs",
        "repos_url": "https://api.github.com/users/luke-jr/repos",
        "events_url": "https://api.github.com/users/luke-jr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/luke-jr/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-05-01T15:00:55Z"
    },
    {
      "event": "subscribed",
      "id": 17488633441,
      "node_id": "SE_lADOABII585-sKybzwAAAAQSZ15h",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/17488633441",
      "actor": {
        "login": "luke-jr",
        "id": 1095675,
        "node_id": "MDQ6VXNlcjEwOTU2NzU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1095675?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/luke-jr",
        "html_url": "https://github.com/luke-jr",
        "followers_url": "https://api.github.com/users/luke-jr/followers",
        "following_url": "https://api.github.com/users/luke-jr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/luke-jr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/luke-jr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/luke-jr/subscriptions",
        "organizations_url": "https://api.github.com/users/luke-jr/orgs",
        "repos_url": "https://api.github.com/users/luke-jr/repos",
        "events_url": "https://api.github.com/users/luke-jr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/luke-jr/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-05-01T15:00:55Z"
    },
    {
      "event": "mentioned",
      "id": 17488633460,
      "node_id": "MEE_lADOABII585-sKybzwAAAAQSZ150",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/17488633460",
      "actor": {
        "login": "instagibbs",
        "id": 5767891,
        "node_id": "MDQ6VXNlcjU3Njc4OTE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5767891?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/instagibbs",
        "html_url": "https://github.com/instagibbs",
        "followers_url": "https://api.github.com/users/instagibbs/followers",
        "following_url": "https://api.github.com/users/instagibbs/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/instagibbs/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/instagibbs/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/instagibbs/subscriptions",
        "organizations_url": "https://api.github.com/users/instagibbs/orgs",
        "repos_url": "https://api.github.com/users/instagibbs/repos",
        "events_url": "https://api.github.com/users/instagibbs/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/instagibbs/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-05-01T15:00:55Z"
    },
    {
      "event": "subscribed",
      "id": 17488633471,
      "node_id": "SE_lADOABII585-sKybzwAAAAQSZ15_",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/17488633471",
      "actor": {
        "login": "instagibbs",
        "id": 5767891,
        "node_id": "MDQ6VXNlcjU3Njc4OTE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5767891?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/instagibbs",
        "html_url": "https://github.com/instagibbs",
        "followers_url": "https://api.github.com/users/instagibbs/followers",
        "following_url": "https://api.github.com/users/instagibbs/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/instagibbs/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/instagibbs/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/instagibbs/subscriptions",
        "organizations_url": "https://api.github.com/users/instagibbs/orgs",
        "repos_url": "https://api.github.com/users/instagibbs/repos",
        "events_url": "https://api.github.com/users/instagibbs/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/instagibbs/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-05-01T15:00:55Z"
    },
    {
      "event": "mentioned",
      "id": 17488633482,
      "node_id": "MEE_lADOABII585-sKybzwAAAAQSZ16K",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/17488633482",
      "actor": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-05-01T15:00:55Z"
    },
    {
      "event": "subscribed",
      "id": 17488633491,
      "node_id": "SE_lADOABII585-sKybzwAAAAQSZ16T",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/17488633491",
      "actor": {
        "login": "mzumsande",
        "id": 48763452,
        "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mzumsande",
        "html_url": "https://github.com/mzumsande",
        "followers_url": "https://api.github.com/users/mzumsande/followers",
        "following_url": "https://api.github.com/users/mzumsande/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/mzumsande/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/mzumsande/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
        "organizations_url": "https://api.github.com/users/mzumsande/orgs",
        "repos_url": "https://api.github.com/users/mzumsande/repos",
        "events_url": "https://api.github.com/users/mzumsande/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/mzumsande/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-05-01T15:00:55Z"
    },
    {
      "event": "commented",
      "id": 2845639973,
      "node_id": "IC_kwDOABII586pnQUl",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2845639973",
      "actor": {
        "login": "instagibbs",
        "id": 5767891,
        "node_id": "MDQ6VXNlcjU3Njc4OTE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5767891?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/instagibbs",
        "html_url": "https://github.com/instagibbs",
        "followers_url": "https://api.github.com/users/instagibbs/followers",
        "following_url": "https://api.github.com/users/instagibbs/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/instagibbs/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/instagibbs/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/instagibbs/subscriptions",
        "organizations_url": "https://api.github.com/users/instagibbs/orgs",
        "repos_url": "https://api.github.com/users/instagibbs/repos",
        "events_url": "https://api.github.com/users/instagibbs/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/instagibbs/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-05-01T19:59:14Z",
      "updated_at": "2025-05-01T19:59:14Z",
      "author_association": "MEMBER",
      "body": "If we don't think a whole fix is in the cards soon, I'm partial to adding a test mechanically checking the weird behavior. ",
      "user": {
        "login": "instagibbs",
        "id": 5767891,
        "node_id": "MDQ6VXNlcjU3Njc4OTE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5767891?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/instagibbs",
        "html_url": "https://github.com/instagibbs",
        "followers_url": "https://api.github.com/users/instagibbs/followers",
        "following_url": "https://api.github.com/users/instagibbs/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/instagibbs/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/instagibbs/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/instagibbs/subscriptions",
        "organizations_url": "https://api.github.com/users/instagibbs/orgs",
        "repos_url": "https://api.github.com/users/instagibbs/repos",
        "events_url": "https://api.github.com/users/instagibbs/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/instagibbs/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/issues/29410#issuecomment-2845639973",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/29410"
    }
  ]
}
{
  "type": "issue",
  "issue": {
    "id": 3363174902,
    "node_id": "I_kwDOABII587Idfn2",
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/33266",
    "repository_url": "https://api.github.com/repos/bitcoin/bitcoin",
    "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/33266/labels%7B/name%7D",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/33266/comments",
    "events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/33266/events",
    "html_url": "https://github.com/bitcoin/bitcoin/issues/33266",
    "number": 33266,
    "state": "open",
    "state_reason": null,
    "title": "signet: disk-space-DoS due to low mining difficulty",
    "body": "Due to low mining difficulty on Signet, an attacker can grind all possible nonces of a block header and create valid[^valid], alternative headers for Signet blocks. Since these have the [same chain work](https://github.com/bitcoin/bitcoin/blob/6ca6f3b37b992591726bd13b494369bee3bd6468/src/validation.cpp#L4416) as the tip, the newly mined headers [can](https://github.com/bitcoin/bitcoin/blob/6ca6f3b37b992591726bd13b494369bee3bd6468/src/validation.cpp#L4435) be submitted along with the original block content via an unsolicited `block` P2P message. Nodes that don't prune will store these blocks indefinitely.\n\nWhen initially reported in April 2025, on average 13208298 work (hash attempts) were required to find a valid nonce on the default Signet. Now, after the difficulty on Signet was increased[^signet-difficulty-increased], [recent signet blocks](https://mempool.space/signet/block/00000012e826e2a7bfc888e43b37969c5b8aafa1bcc2b3a389c238d0ef733500) require 209338421 work on average. This results in 2^32 / 13208298 = ~325 valid headers for each block on average in April and 2^32 / 209338421 = ~20 valid headers for each block at the current Signet difficulty. An attacker can use this to fill up the disk of a Signet node.\n\nAssuming 144 Signet blocks per day and assuming a size of 500kB[^signet-blocks-size] per block, the signet disk usage increases by about 72 MB per day. An attack could have resulted in a disk-usage increase of 325 * 72 MB = 23.4 GB per day in April. With the current difficulty, it could result in a disk-usage increase of 20 * 72 MB = 1.44 GB per day.\n\nA modern laptop can grind the full 2^32 nonce space in less than 30 seconds and an attacker only needs to store the nonces to build and publish the alternative blocks. This makes the attack fairly trivial to exploit. \n\nCredit goes to @stwenhao for initially reporting this in a fork-observer [issue]( https://github.com/0xB10C/fork-observer/issues/61). The attack can be detected via `getchaintips` and e.g. tools like fork-observer. The alternative blocks show up as `valid-headers`. No reorg happens as the original block remains the active tip (since it was seen first).\n\n<img width=\"3169\" height=\"954\" alt=\"Image\" src=\"https://github.com/user-attachments/assets/386d2490-f037-4885-a083-dc2bc3803bba\" />\n\nThe attack is possible on all networks that require less than 2^32 work to find blocks. Pruned nodes are not affected as the alternative blocks are removed at some point. I'm opening this issue is to document this somewhere visible. I don't think there's action required for the default Signet at this point since the difficulty has already been increased and the attack is less effective there now. If this becomes a problem again, the best mitigation is probably to further increase the difficulty. Other public signets (e.g. Mutinynet) might want to consider increasing the mining difficulty too.\n\n[^valid]: Signet blocks commit to the header version, prevhash, merkleroot, and timestamp. These can't be changed. Only the nonce can be changed to produce valid, alternative headers. \n[^signet-blocks-size]:  filling Signet blocks with transactions is possible for *free*, but blocks seem to be limited to 1 MWU. Consistently making 500 kB blocks seems to be possible for an attacker \n[^signet-difficulty-increased]: The Signet difficulty was increased at the end of April 2025 in response to a private report.<img width=\"400\" height=\"150\" alt=\"Image\" src=\"https://github.com/user-attachments/assets/15f1888c-3cd7-4409-a4f0-ff5f53fbc0bd\" />\n\n",
    "user": {
      "login": "0xB10C",
      "id": 19157360,
      "node_id": "MDQ6VXNlcjE5MTU3MzYw",
      "avatar_url": "https://avatars.githubusercontent.com/u/19157360?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/0xB10C",
      "html_url": "https://github.com/0xB10C",
      "followers_url": "https://api.github.com/users/0xB10C/followers",
      "following_url": "https://api.github.com/users/0xB10C/following%7B/other_user%7D",
      "gists_url": "https://api.github.com/users/0xB10C/gists%7B/gist_id%7D",
      "starred_url": "https://api.github.com/users/0xB10C/starred%7B/owner%7D%7B/repo%7D",
      "subscriptions_url": "https://api.github.com/users/0xB10C/subscriptions",
      "organizations_url": "https://api.github.com/users/0xB10C/orgs",
      "repos_url": "https://api.github.com/users/0xB10C/repos",
      "events_url": "https://api.github.com/users/0xB10C/events%7B/privacy%7D",
      "received_events_url": "https://api.github.com/users/0xB10C/received_events",
      "type": "User",
      "site_admin": false,
      "patch_url": null
    },
    "labels": [],
    "assignees": [],
    "author_association": "CONTRIBUTOR",
    "locked": false,
    "comments": 0,
    "created_at": "2025-08-28T12:38:43Z",
    "updated_at": "2025-08-28T12:38:43Z"
  },
  "events": [
    {
      "event": "mentioned",
      "id": 19390910188,
      "node_id": "MEE_lADOABII587Idfn2zwAAAASDyc7s",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/19390910188",
      "actor": {
        "login": "stwenhao",
        "id": 195633704,
        "node_id": "U_kgDOC6kiKA",
        "avatar_url": "https://avatars.githubusercontent.com/u/195633704?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stwenhao",
        "html_url": "https://github.com/stwenhao",
        "followers_url": "https://api.github.com/users/stwenhao/followers",
        "following_url": "https://api.github.com/users/stwenhao/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stwenhao/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stwenhao/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stwenhao/subscriptions",
        "organizations_url": "https://api.github.com/users/stwenhao/orgs",
        "repos_url": "https://api.github.com/users/stwenhao/repos",
        "events_url": "https://api.github.com/users/stwenhao/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stwenhao/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-08-28T12:38:45Z"
    },
    {
      "event": "subscribed",
      "id": 19390910228,
      "node_id": "SE_lADOABII587Idfn2zwAAAASDyc8U",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/19390910228",
      "actor": {
        "login": "stwenhao",
        "id": 195633704,
        "node_id": "U_kgDOC6kiKA",
        "avatar_url": "https://avatars.githubusercontent.com/u/195633704?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stwenhao",
        "html_url": "https://github.com/stwenhao",
        "followers_url": "https://api.github.com/users/stwenhao/followers",
        "following_url": "https://api.github.com/users/stwenhao/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stwenhao/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stwenhao/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stwenhao/subscriptions",
        "organizations_url": "https://api.github.com/users/stwenhao/orgs",
        "repos_url": "https://api.github.com/users/stwenhao/repos",
        "events_url": "https://api.github.com/users/stwenhao/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stwenhao/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-08-28T12:38:45Z"
    }
  ]
}
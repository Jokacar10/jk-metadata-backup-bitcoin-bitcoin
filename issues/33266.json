{
  "type": "issue",
  "issue": {
    "id": 3363174902,
    "node_id": "I_kwDOABII587Idfn2",
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/33266",
    "repository_url": "https://api.github.com/repos/bitcoin/bitcoin",
    "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/33266/labels%7B/name%7D",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/33266/comments",
    "events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/33266/events",
    "html_url": "https://github.com/bitcoin/bitcoin/issues/33266",
    "number": 33266,
    "state": "open",
    "state_reason": null,
    "title": "signet: disk-space-DoS due to low mining difficulty",
    "body": "Due to low mining difficulty on Signet, an attacker can grind all possible nonces of a block header and create valid[^valid], alternative headers for Signet blocks. Since these have the [same chain work](https://github.com/bitcoin/bitcoin/blob/6ca6f3b37b992591726bd13b494369bee3bd6468/src/validation.cpp#L4416) as the tip, the newly mined headers [can](https://github.com/bitcoin/bitcoin/blob/6ca6f3b37b992591726bd13b494369bee3bd6468/src/validation.cpp#L4435) be submitted along with the original block content via an unsolicited `block` P2P message. Nodes that don't prune will store these blocks indefinitely.\n\nWhen initially reported in April 2025, on average 13208298 work (hash attempts) were required to find a valid nonce on the default Signet. Now, after the difficulty on Signet was increased[^signet-difficulty-increased], [recent signet blocks](https://mempool.space/signet/block/00000012e826e2a7bfc888e43b37969c5b8aafa1bcc2b3a389c238d0ef733500) require 209338421 work on average. This results in 2^32 / 13208298 = ~325 valid headers for each block on average in April and 2^32 / 209338421 = ~20 valid headers for each block at the current Signet difficulty. An attacker can use this to fill up the disk of a Signet node.\n\nAssuming 144 Signet blocks per day and assuming a size of 500kB[^signet-blocks-size] per block, the signet disk usage increases by about 72 MB per day. An attack could have resulted in a disk-usage increase of 325 * 72 MB = 23.4 GB per day in April. With the current difficulty, it could result in a disk-usage increase of 20 * 72 MB = 1.44 GB per day.\n\nA modern laptop can grind the full 2^32 nonce space in less than 30 seconds and an attacker only needs to store the nonces to build and publish the alternative blocks. This makes the attack fairly trivial to exploit. \n\nCredit goes to @stwenhao for initially reporting this in a fork-observer [issue]( https://github.com/0xB10C/fork-observer/issues/61). The attack can be detected via `getchaintips` and e.g. tools like fork-observer. The alternative blocks show up as `valid-headers`. No reorg happens as the original block remains the active tip (since it was seen first).\n\n<img width=\"3169\" height=\"954\" alt=\"Image\" src=\"https://github.com/user-attachments/assets/386d2490-f037-4885-a083-dc2bc3803bba\" />\n\nThe attack is possible on all networks that require less than 2^32 work to find blocks. Pruned nodes are not affected as the alternative blocks are removed at some point. I'm opening this issue is to document this somewhere visible. I don't think there's action required for the default Signet at this point since the difficulty has already been increased and the attack is less effective there now. If this becomes a problem again, the best mitigation is probably to further increase the difficulty. Other public signets (e.g. Mutinynet) might want to consider increasing the mining difficulty too.\n\n[^valid]: Signet blocks commit to the header version, prevhash, merkleroot, and timestamp. These can't be changed. Only the nonce can be changed to produce valid, alternative headers. \n[^signet-blocks-size]:  filling Signet blocks with transactions is possible for *free*, but blocks seem to be limited to 1 MWU. Consistently making 500 kB blocks seems to be possible for an attacker \n[^signet-difficulty-increased]: The Signet difficulty was increased at the end of April 2025 in response to a private report.<img width=\"400\" height=\"150\" alt=\"Image\" src=\"https://github.com/user-attachments/assets/15f1888c-3cd7-4409-a4f0-ff5f53fbc0bd\" />\n\n",
    "user": {
      "login": "0xB10C",
      "id": 19157360,
      "node_id": "MDQ6VXNlcjE5MTU3MzYw",
      "avatar_url": "https://avatars.githubusercontent.com/u/19157360?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/0xB10C",
      "html_url": "https://github.com/0xB10C",
      "followers_url": "https://api.github.com/users/0xB10C/followers",
      "following_url": "https://api.github.com/users/0xB10C/following%7B/other_user%7D",
      "gists_url": "https://api.github.com/users/0xB10C/gists%7B/gist_id%7D",
      "starred_url": "https://api.github.com/users/0xB10C/starred%7B/owner%7D%7B/repo%7D",
      "subscriptions_url": "https://api.github.com/users/0xB10C/subscriptions",
      "organizations_url": "https://api.github.com/users/0xB10C/orgs",
      "repos_url": "https://api.github.com/users/0xB10C/repos",
      "events_url": "https://api.github.com/users/0xB10C/events%7B/privacy%7D",
      "received_events_url": "https://api.github.com/users/0xB10C/received_events",
      "type": "User",
      "site_admin": false,
      "patch_url": null
    },
    "labels": [],
    "assignees": [],
    "author_association": "CONTRIBUTOR",
    "locked": false,
    "comments": 7,
    "created_at": "2025-08-28T12:38:43Z",
    "updated_at": "2025-09-05T13:33:45Z"
  },
  "events": [
    {
      "event": "mentioned",
      "id": 19390910188,
      "node_id": "MEE_lADOABII587Idfn2zwAAAASDyc7s",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/19390910188",
      "actor": {
        "login": "stwenhao",
        "id": 195633704,
        "node_id": "U_kgDOC6kiKA",
        "avatar_url": "https://avatars.githubusercontent.com/u/195633704?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stwenhao",
        "html_url": "https://github.com/stwenhao",
        "followers_url": "https://api.github.com/users/stwenhao/followers",
        "following_url": "https://api.github.com/users/stwenhao/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stwenhao/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stwenhao/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stwenhao/subscriptions",
        "organizations_url": "https://api.github.com/users/stwenhao/orgs",
        "repos_url": "https://api.github.com/users/stwenhao/repos",
        "events_url": "https://api.github.com/users/stwenhao/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stwenhao/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-08-28T12:38:45Z"
    },
    {
      "event": "subscribed",
      "id": 19390910228,
      "node_id": "SE_lADOABII587Idfn2zwAAAASDyc8U",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/19390910228",
      "actor": {
        "login": "stwenhao",
        "id": 195633704,
        "node_id": "U_kgDOC6kiKA",
        "avatar_url": "https://avatars.githubusercontent.com/u/195633704?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stwenhao",
        "html_url": "https://github.com/stwenhao",
        "followers_url": "https://api.github.com/users/stwenhao/followers",
        "following_url": "https://api.github.com/users/stwenhao/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stwenhao/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stwenhao/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stwenhao/subscriptions",
        "organizations_url": "https://api.github.com/users/stwenhao/orgs",
        "repos_url": "https://api.github.com/users/stwenhao/repos",
        "events_url": "https://api.github.com/users/stwenhao/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stwenhao/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-08-28T12:38:45Z"
    },
    {
      "event": "subscribed",
      "id": 19393945982,
      "node_id": "SE_lADOABII587Idfn2zwAAAASD-CF-",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/19393945982",
      "actor": {
        "login": "benthecarman",
        "id": 15256660,
        "node_id": "MDQ6VXNlcjE1MjU2NjYw",
        "avatar_url": "https://avatars.githubusercontent.com/u/15256660?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/benthecarman",
        "html_url": "https://github.com/benthecarman",
        "followers_url": "https://api.github.com/users/benthecarman/followers",
        "following_url": "https://api.github.com/users/benthecarman/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/benthecarman/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/benthecarman/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/benthecarman/subscriptions",
        "organizations_url": "https://api.github.com/users/benthecarman/orgs",
        "repos_url": "https://api.github.com/users/benthecarman/repos",
        "events_url": "https://api.github.com/users/benthecarman/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/benthecarman/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-08-28T15:05:17Z"
    },
    {
      "event": "comment_deleted",
      "id": 19406392249,
      "node_id": "CDE_lADOABII587Idfn2zwAAAASEtgu5",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/19406392249",
      "actor": {
        "login": "bitcoin",
        "id": 528860,
        "node_id": "MDEyOk9yZ2FuaXphdGlvbjUyODg2MA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/528860?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/bitcoin",
        "html_url": "https://github.com/bitcoin",
        "followers_url": "https://api.github.com/users/bitcoin/followers",
        "following_url": "https://api.github.com/users/bitcoin/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/bitcoin/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/bitcoin/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/bitcoin/subscriptions",
        "organizations_url": "https://api.github.com/users/bitcoin/orgs",
        "repos_url": "https://api.github.com/users/bitcoin/repos",
        "events_url": "https://api.github.com/users/bitcoin/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/bitcoin/received_events",
        "type": "Organization",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-08-29T07:51:37Z"
    },
    {
      "event": "commented",
      "id": 3236886747,
      "node_id": "IC_kwDOABII587A7vjb",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/3236886747",
      "actor": {
        "login": "jsarenik",
        "id": 244565,
        "node_id": "MDQ6VXNlcjI0NDU2NQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/244565?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jsarenik",
        "html_url": "https://github.com/jsarenik",
        "followers_url": "https://api.github.com/users/jsarenik/followers",
        "following_url": "https://api.github.com/users/jsarenik/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jsarenik/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jsarenik/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jsarenik/subscriptions",
        "organizations_url": "https://api.github.com/users/jsarenik/orgs",
        "repos_url": "https://api.github.com/users/jsarenik/repos",
        "events_url": "https://api.github.com/users/jsarenik/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jsarenik/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-08-29T12:31:05Z",
      "updated_at": "2025-08-29T12:43:17Z",
      "author_association": "NONE",
      "body": "Would such blocks mined by anyone even be considered valid on signet since they would not contain any expected valid signature?\n\nOn signet there's an \"Additional consensus requirement that the coinbase witness commitment contains an extended signet commitment, which is a script satisfying the block script (usually a k-of-n multisig)\" (see [bitcoin.it documentation on Signet Differences](https://en.bitcoin.it/wiki/Signet#Differences)). Maybe the in-repo documentation is not clear?",
      "user": {
        "login": "jsarenik",
        "id": 244565,
        "node_id": "MDQ6VXNlcjI0NDU2NQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/244565?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jsarenik",
        "html_url": "https://github.com/jsarenik",
        "followers_url": "https://api.github.com/users/jsarenik/followers",
        "following_url": "https://api.github.com/users/jsarenik/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jsarenik/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jsarenik/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jsarenik/subscriptions",
        "organizations_url": "https://api.github.com/users/jsarenik/orgs",
        "repos_url": "https://api.github.com/users/jsarenik/repos",
        "events_url": "https://api.github.com/users/jsarenik/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jsarenik/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/issues/33266#issuecomment-3236886747",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/33266"
    },
    {
      "event": "commented",
      "id": 3237765557,
      "node_id": "IC_kwDOABII587A_GG1",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/3237765557",
      "actor": {
        "login": "0xB10C",
        "id": 19157360,
        "node_id": "MDQ6VXNlcjE5MTU3MzYw",
        "avatar_url": "https://avatars.githubusercontent.com/u/19157360?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/0xB10C",
        "html_url": "https://github.com/0xB10C",
        "followers_url": "https://api.github.com/users/0xB10C/followers",
        "following_url": "https://api.github.com/users/0xB10C/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/0xB10C/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/0xB10C/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/0xB10C/subscriptions",
        "organizations_url": "https://api.github.com/users/0xB10C/orgs",
        "repos_url": "https://api.github.com/users/0xB10C/repos",
        "events_url": "https://api.github.com/users/0xB10C/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/0xB10C/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-08-29T17:42:56Z",
      "updated_at": "2025-08-29T17:42:56Z",
      "author_association": "CONTRIBUTOR",
      "body": "> Would such blocks mined by anyone even be considered valid on signet since they would not contain any expected valid signature?\n\nYes. Just the nonce in the block header changes. The signet commitment commits to the header version, prevhash, merkleroot, and timestamp. It does not commit (and can not commit) to the nonce. The underlying block does not change. The commitment remains valid.",
      "user": {
        "login": "0xB10C",
        "id": 19157360,
        "node_id": "MDQ6VXNlcjE5MTU3MzYw",
        "avatar_url": "https://avatars.githubusercontent.com/u/19157360?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/0xB10C",
        "html_url": "https://github.com/0xB10C",
        "followers_url": "https://api.github.com/users/0xB10C/followers",
        "following_url": "https://api.github.com/users/0xB10C/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/0xB10C/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/0xB10C/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/0xB10C/subscriptions",
        "organizations_url": "https://api.github.com/users/0xB10C/orgs",
        "repos_url": "https://api.github.com/users/0xB10C/repos",
        "events_url": "https://api.github.com/users/0xB10C/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/0xB10C/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/issues/33266#issuecomment-3237765557",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/33266"
    },
    {
      "event": "commented",
      "id": 3239535357,
      "node_id": "IC_kwDOABII587BF2L9",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/3239535357",
      "actor": {
        "login": "stwenhao",
        "id": 195633704,
        "node_id": "U_kgDOC6kiKA",
        "avatar_url": "https://avatars.githubusercontent.com/u/195633704?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stwenhao",
        "html_url": "https://github.com/stwenhao",
        "followers_url": "https://api.github.com/users/stwenhao/followers",
        "following_url": "https://api.github.com/users/stwenhao/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stwenhao/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stwenhao/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stwenhao/subscriptions",
        "organizations_url": "https://api.github.com/users/stwenhao/orgs",
        "repos_url": "https://api.github.com/users/stwenhao/repos",
        "events_url": "https://api.github.com/users/stwenhao/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stwenhao/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-08-30T20:51:55Z",
      "updated_at": "2025-08-30T21:32:04Z",
      "author_association": "NONE",
      "body": "> It does not commit (and can not commit) to the nonce.\n\nI agree, that it does not commit to the nonce. But if that would be needed, then it could. An example of a situation, where things are signed, but where nonce is included in signed commitment, is what I deployed as a Proof of Work puzzle: https://bitcointalk.org/index.php?topic=5551080.0\n\nOr, a similar case is recently deployed Optional Hourglass: https://bitcointalk.org/index.php?topic=5557305.0\n\nIn that cases, the signature can sign everything (for example, nSequence and nLockTime is signed, and both can be used as nonces during mining). And also, signatures can sign less things, by using different sighashes, for example here: https://mempool.space/tx/8349df0753e80cce322322f1b76789e1d0fd6693aed2f4de4e49576423081ae7\n\nSo, I can imagine a perfectly valid Signet challenge, where the size of the signature will be restricted somehow, where it would use different sighashes, than SIGHASH_ALL, or where miners would grind DER signatures, instead of grinding regular 80-byte block headers.\n\nTo sum up: the current design of Signet allows attacking, by changing nonces into different values. But that attack can be trivially stopped, just by making sure, that for a given signed header, there is only one nonce, meeting a given difficulty (which means always checking all 2^32 nonces for each submitted header).\n\nBut, future signets can use a different model, where they could entirely avoid such problems, and work with much smaller difficulty. Imagine taking this signet challenge:\n```\n1 <pubkeyAlice> <pubkeyBob> 2 OP_CHECKMULTISIG\n```\nAnd turning it into this instead:\n```\nOP_SIZE 61 70 OP_WITHIN OP_VERIFY\nOP_CODESEPARATOR\n1 <pubkeyAlice> <pubkeyBob> 2 OP_CHECKMULTISIG\n```\nOf course, because the Script from signet challenge can change the signed transaction ID, this is incompatible with currently deployed network. However, I can imagine a soft-fork on top of signet, where signatures would be required to be smaller, than they are, and where Proof of Work will be counted, by checking the signature, rather than by checking the hash in the block header. And then, block headers could have even regtest difficulty, if consensus rules would still require grinding something else (that could commit to the block header nonce, and difficulty as well).\n\nEdit: Also, there are many possible trivial fixes. For example, if each nonce will be restricted by consensus rules to be less than 0x00010000, then it could work, and it would be trivial, to check all 2^16 values, instead of 2^32.",
      "user": {
        "login": "stwenhao",
        "id": 195633704,
        "node_id": "U_kgDOC6kiKA",
        "avatar_url": "https://avatars.githubusercontent.com/u/195633704?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stwenhao",
        "html_url": "https://github.com/stwenhao",
        "followers_url": "https://api.github.com/users/stwenhao/followers",
        "following_url": "https://api.github.com/users/stwenhao/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stwenhao/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stwenhao/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stwenhao/subscriptions",
        "organizations_url": "https://api.github.com/users/stwenhao/orgs",
        "repos_url": "https://api.github.com/users/stwenhao/repos",
        "events_url": "https://api.github.com/users/stwenhao/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stwenhao/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/issues/33266#issuecomment-3239535357",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/33266"
    },
    {
      "event": "commented",
      "id": 3239755243,
      "node_id": "IC_kwDOABII587BGr3r",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/3239755243",
      "actor": {
        "login": "jsarenik",
        "id": 244565,
        "node_id": "MDQ6VXNlcjI0NDU2NQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/244565?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jsarenik",
        "html_url": "https://github.com/jsarenik",
        "followers_url": "https://api.github.com/users/jsarenik/followers",
        "following_url": "https://api.github.com/users/jsarenik/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jsarenik/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jsarenik/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jsarenik/subscriptions",
        "organizations_url": "https://api.github.com/users/jsarenik/orgs",
        "repos_url": "https://api.github.com/users/jsarenik/repos",
        "events_url": "https://api.github.com/users/jsarenik/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jsarenik/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-08-31T04:44:16Z",
      "updated_at": "2025-08-31T04:44:16Z",
      "author_association": "NONE",
      "body": "What about a safety one-liner fix which would not allow new block to have the same blockheader (except nonce) than an already mined block? Such a local-node \"soft-fork\" would be possible even without telling anyone network-wise.\n\nAn attack block could come only _after_ a new unique mined&signed block header was announced.",
      "user": {
        "login": "jsarenik",
        "id": 244565,
        "node_id": "MDQ6VXNlcjI0NDU2NQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/244565?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jsarenik",
        "html_url": "https://github.com/jsarenik",
        "followers_url": "https://api.github.com/users/jsarenik/followers",
        "following_url": "https://api.github.com/users/jsarenik/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jsarenik/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jsarenik/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jsarenik/subscriptions",
        "organizations_url": "https://api.github.com/users/jsarenik/orgs",
        "repos_url": "https://api.github.com/users/jsarenik/repos",
        "events_url": "https://api.github.com/users/jsarenik/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jsarenik/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/issues/33266#issuecomment-3239755243",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/33266"
    },
    {
      "event": "commented",
      "id": 3239765781,
      "node_id": "IC_kwDOABII587BGucV",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/3239765781",
      "actor": {
        "login": "stwenhao",
        "id": 195633704,
        "node_id": "U_kgDOC6kiKA",
        "avatar_url": "https://avatars.githubusercontent.com/u/195633704?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stwenhao",
        "html_url": "https://github.com/stwenhao",
        "followers_url": "https://api.github.com/users/stwenhao/followers",
        "following_url": "https://api.github.com/users/stwenhao/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stwenhao/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stwenhao/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stwenhao/subscriptions",
        "organizations_url": "https://api.github.com/users/stwenhao/orgs",
        "repos_url": "https://api.github.com/users/stwenhao/repos",
        "events_url": "https://api.github.com/users/stwenhao/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stwenhao/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-08-31T05:01:35Z",
      "updated_at": "2025-08-31T05:11:55Z",
      "author_association": "NONE",
      "body": "> What about a safety one-liner fix which would not allow new block to have the same blockheader (except nonce) than an already mined block?\n\nAs long as you know, which block was propagated first, then you can do that. But note that signet block producers can decide to build things on top of any block, including something, which was grinded by some attacker. If you see two or more blocks with different nonces, at the same height N, then you don't know, what block number N+1 will sign (and also, it can sign all versions, and leave it up to the miners).\n\n> Such a local-node \"soft-fork\" would be possible even without telling anyone network-wise.\n\nYes, but if your node joined the network recently, then you don't know, if the block you heard from someone is the earliest one, that was broadcasted. You only know that, if something was created on top of it. Which means, that there is always a risk to see a single block being reorged, if you pick it wrong.\n\nEdit: Also note, that the default signet challenge is 1-of-2 multisig. Which means, that you can have for example two different nodes, making signatures for two different public keys. Both nodes can be connected to the same network, but they don't have to maintain a direct P2P connection. Which means, that if you have one signet miner, and another signet miner, and there are some attackers in the middle, then they can capture the real block, grind it (also with ASICs, because why not), and share different headers with different nodes.",
      "user": {
        "login": "stwenhao",
        "id": 195633704,
        "node_id": "U_kgDOC6kiKA",
        "avatar_url": "https://avatars.githubusercontent.com/u/195633704?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stwenhao",
        "html_url": "https://github.com/stwenhao",
        "followers_url": "https://api.github.com/users/stwenhao/followers",
        "following_url": "https://api.github.com/users/stwenhao/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stwenhao/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stwenhao/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stwenhao/subscriptions",
        "organizations_url": "https://api.github.com/users/stwenhao/orgs",
        "repos_url": "https://api.github.com/users/stwenhao/repos",
        "events_url": "https://api.github.com/users/stwenhao/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stwenhao/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/issues/33266#issuecomment-3239765781",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/33266"
    },
    {
      "event": "commented",
      "id": 3258202695,
      "node_id": "IC_kwDOABII587CNDpH",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/3258202695",
      "actor": {
        "login": "0xB10C",
        "id": 19157360,
        "node_id": "MDQ6VXNlcjE5MTU3MzYw",
        "avatar_url": "https://avatars.githubusercontent.com/u/19157360?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/0xB10C",
        "html_url": "https://github.com/0xB10C",
        "followers_url": "https://api.github.com/users/0xB10C/followers",
        "following_url": "https://api.github.com/users/0xB10C/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/0xB10C/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/0xB10C/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/0xB10C/subscriptions",
        "organizations_url": "https://api.github.com/users/0xB10C/orgs",
        "repos_url": "https://api.github.com/users/0xB10C/repos",
        "events_url": "https://api.github.com/users/0xB10C/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/0xB10C/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-09-05T12:36:38Z",
      "updated_at": "2025-09-05T12:36:38Z",
      "author_association": "CONTRIBUTOR",
      "body": "My impression is that just increasing the difficulty on a public Signet should be enough and would avoid this issue without needing a (signet only) (consensus) code change. It doesn't even need to be difficulty 1 (i.e. 2^32 work) - similar to the default signet only requiring 5% of work at the risk of 19 alternative blocks per tip. The attack is easily detectable and if exploited over a long period of time, the signet admin can further increase the difficulty at any time. Alternatively, publishing new blocks in batches ensures an attacker doesn't have enough time to mine alternatives for each tip.\n\nIt probably needs some documentation though: Either run your public signet with a high enough difficulty or risk being disk-space DoSed by some script kiddy. After all, it's only a test network. \n\nAFAIK, so far nobody else bothered to mine alternative blocks on the default signet and neither on Mutinynet where it is/was trivial to grow the chain by 100GB per day (https://github.com/MutinyWallet/mutiny-net/pull/4).\n\n ",
      "user": {
        "login": "0xB10C",
        "id": 19157360,
        "node_id": "MDQ6VXNlcjE5MTU3MzYw",
        "avatar_url": "https://avatars.githubusercontent.com/u/19157360?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/0xB10C",
        "html_url": "https://github.com/0xB10C",
        "followers_url": "https://api.github.com/users/0xB10C/followers",
        "following_url": "https://api.github.com/users/0xB10C/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/0xB10C/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/0xB10C/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/0xB10C/subscriptions",
        "organizations_url": "https://api.github.com/users/0xB10C/orgs",
        "repos_url": "https://api.github.com/users/0xB10C/repos",
        "events_url": "https://api.github.com/users/0xB10C/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/0xB10C/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/issues/33266#issuecomment-3258202695",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/33266"
    },
    {
      "event": "commented",
      "id": 3258376429,
      "node_id": "IC_kwDOABII587CNuDt",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/3258376429",
      "actor": {
        "login": "stwenhao",
        "id": 195633704,
        "node_id": "U_kgDOC6kiKA",
        "avatar_url": "https://avatars.githubusercontent.com/u/195633704?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stwenhao",
        "html_url": "https://github.com/stwenhao",
        "followers_url": "https://api.github.com/users/stwenhao/followers",
        "following_url": "https://api.github.com/users/stwenhao/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stwenhao/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stwenhao/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stwenhao/subscriptions",
        "organizations_url": "https://api.github.com/users/stwenhao/orgs",
        "repos_url": "https://api.github.com/users/stwenhao/repos",
        "events_url": "https://api.github.com/users/stwenhao/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stwenhao/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-09-05T13:33:45Z",
      "updated_at": "2025-09-05T13:33:45Z",
      "author_association": "NONE",
      "body": "> and would avoid this issue without needing a (signet only) (consensus) code change.\n\nYes, but signet-only consensus code change can be beneficial. If your difficulty requires grinding 2^20 hashes, then I think nonce values should be masked, to make sure, that upper bits are set to zero. Then, if the difficulty will increase, the code can automatically raise that barrier, so that the nonce restrictions will be active only for difficulties requiring less than 2^32 hashes.\n\nBecause if you need to grind for example 2^16 hashes, then it is more realistic, if your nonce is also masked with 0x0000ffff. After all, miners constantly check a lot of different block headers, and they tweak version bits, timestamps, or change merkle roots. Restricting the nonce would mimic that behaviour for signets.",
      "user": {
        "login": "stwenhao",
        "id": 195633704,
        "node_id": "U_kgDOC6kiKA",
        "avatar_url": "https://avatars.githubusercontent.com/u/195633704?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stwenhao",
        "html_url": "https://github.com/stwenhao",
        "followers_url": "https://api.github.com/users/stwenhao/followers",
        "following_url": "https://api.github.com/users/stwenhao/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stwenhao/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stwenhao/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stwenhao/subscriptions",
        "organizations_url": "https://api.github.com/users/stwenhao/orgs",
        "repos_url": "https://api.github.com/users/stwenhao/repos",
        "events_url": "https://api.github.com/users/stwenhao/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stwenhao/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/issues/33266#issuecomment-3258376429",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/33266"
    }
  ]
}
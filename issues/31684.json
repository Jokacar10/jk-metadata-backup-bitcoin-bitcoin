{
  "type": "issue",
  "issue": {
    "id": 2797235963,
    "node_id": "I_kwDOABII586mum77",
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/31684",
    "repository_url": "https://api.github.com/repos/bitcoin/bitcoin",
    "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/31684/labels%7B/name%7D",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/31684/comments",
    "events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/31684/events",
    "html_url": "https://github.com/bitcoin/bitcoin/issues/31684",
    "number": 31684,
    "state": "open",
    "state_reason": null,
    "title": "`generateblock` RPC Not Collecting Transaction Fees",
    "body": "### Is there an existing issue for this?\n\n- [x] I have searched the existing issues\n\n### Current behaviour\n\nThe `generateblock` RPC does not properly collect transaction fees when creating a block. Instead of including the fees in the block reward, the block is created with only the block subsidy, leaving out the fees from transactions included in the block.\n\n### Expected behaviour\n\nThe block reward should include both the block subsidy and the transaction fees from all transactions included in the block.\n\n### Steps to reproduce\n\n1. Start a Bitcoin Core node in regtest mode.\n2. Generate 101 blocks to fund a wallet.\n3. Create a transaction with a fee.\n4. Call the `generateblock` RPC with the transaction above.\n5. Inspect the resulting block to confirm that the block reward does not include the fee.\n\n### Relevant log output\n\n```\n$ bitcoin-cli -regtest getblock 05fe640f818d46b9ba931d8f4179562a0d042008abe4b9ed98072d0bca449f30 2`\n```\n```json\n{\n  \"hash\": \"05fe640f818d46b9ba931d8f4179562a0d042008abe4b9ed98072d0bca449f30\",\n  \"confirmations\": 1,\n  \"height\": 102,\n  \"version\": 536870912,\n  \"versionHex\": \"20000000\",\n  \"merkleroot\": \"ac0b08a969181b07d5d08a1dedce2aeeea2d30f050b837cd4a90b73846875ecc\",\n  \"time\": 1737237217,\n  \"mediantime\": 1737237198,\n  \"nonce\": 5,\n  \"bits\": \"207fffff\",\n  \"difficulty\": 4.656542373906925e-10,\n  \"chainwork\": \"00000000000000000000000000000000000000000000000000000000000000ce\",\n  \"nTx\": 2,\n  \"previousblockhash\": \"38a851e21e26dc54159198e8eda06c0fb94debb1316dd504b74bb5114f9273fe\",\n  \"strippedsize\": 295,\n  \"size\": 440,\n  \"weight\": 1325,\n  \"tx\": [\n    {\n      \"txid\": \"065d28a4a15b90fc052b613e5db7540f1e5164159ca17fe88f27cfdb857c811d\",\n      \"hash\": \"ad545fbff90d4ddf126dc835bec6f50fc51a7e72c6b6c9f16bf240e464d68810\",\n      \"version\": 2,\n      \"size\": 168,\n      \"vsize\": 141,\n      \"weight\": 564,\n      \"locktime\": 0,\n      \"vin\": [\n        {\n          \"coinbase\": \"016600\",\n          \"txinwitness\": [\n            \"0000000000000000000000000000000000000000000000000000000000000000\"\n          ],\n          \"sequence\": 4294967295\n        }\n      ],\n      \"vout\": [\n        {\n          \"value\": 50.00000000,\n          \"n\": 0,\n          \"scriptPubKey\": {\n            \"asm\": \"0 a41424b6995beeaef7cbc9a4ebcf91b71793983d\",\n            \"desc\": \"addr(bcrt1q5s2zfd5et0h2aa7texjwhnu3kute8xpaqgz39r)#qxc0s854\",\n            \"hex\": \"0014a41424b6995beeaef7cbc9a4ebcf91b71793983d\",\n            \"address\": \"bcrt1q5s2zfd5et0h2aa7texjwhnu3kute8xpaqgz39r\",\n            \"type\": \"witness_v0_keyhash\"\n          }\n        },\n        {\n          \"value\": 0.00000000,\n          \"n\": 1,\n          \"scriptPubKey\": {\n            \"asm\": \"OP_RETURN aa21a9ed3dde4089261cfff17418209ef46ed64df4d49543df0daeafc6fc41ce09766229\",\n            \"desc\": \"raw(6a24aa21a9ed3dde4089261cfff17418209ef46ed64df4d49543df0daeafc6fc41ce09766229)#hu88gsq4\",\n            \"hex\": \"6a24aa21a9ed3dde4089261cfff17418209ef46ed64df4d49543df0daeafc6fc41ce09766229\",\n            \"type\": \"nulldata\"\n          }\n        }\n      ],\n      \"hex\": \"020000000001010000000000000000000000000000000000000000000000000000000000000000ffffffff03016600ffffffff0200f2052a01000000160014a41424b6995beeaef7cbc9a4ebcf91b71793983d0000000000000000266a24aa21a9ed3dde4089261cfff17418209ef46ed64df4d49543df0daeafc6fc41ce097662290120000000000000000000000000000000000000000000000000000000000000000000000000\"\n    },\n    {\n      \"txid\": \"f66ffdec54562ec07aac05c2c25d91937a0059ffebf802705be31f59be76f3e9\",\n      \"hash\": \"567df936509935ee19841e9b717668cb6d419eeaba41f9c05ab0351a56c3293f\",\n      \"version\": 2,\n      \"size\": 191,\n      \"vsize\": 110,\n      \"weight\": 437,\n      \"locktime\": 0,\n      \"vin\": [\n        {\n          \"txid\": \"f5dc14e8b10b94b038ce9d6a789a12e3428e5acfd07de7ea461762f6c23f267e\",\n          \"vout\": 0,\n          \"scriptSig\": {\n            \"asm\": \"\",\n            \"hex\": \"\"\n          },\n          \"txinwitness\": [\n            \"304402206b532fdf2ca4111872a8c8c322ab68e21e079253862c3c95cf86d18efcdb143d022039514e377cbac97c3ec1459aec7c9584a56c1c527588600c0435483c7b96535c01\",\n            \"03fc3c5d0caa493055f57d5f3098b42555543a5219519ab90a22b20ddea49f1515\"\n          ],\n          \"sequence\": 4294967293\n        }\n      ],\n      \"vout\": [\n        {\n          \"value\": 39.99998900,\n          \"n\": 0,\n          \"scriptPubKey\": {\n            \"asm\": \"0 a41424b6995beeaef7cbc9a4ebcf91b71793983d\",\n            \"desc\": \"addr(bcrt1q5s2zfd5et0h2aa7texjwhnu3kute8xpaqgz39r)#qxc0s854\",\n            \"hex\": \"0014a41424b6995beeaef7cbc9a4ebcf91b71793983d\",\n            \"address\": \"bcrt1q5s2zfd5et0h2aa7texjwhnu3kute8xpaqgz39r\",\n            \"type\": \"witness_v0_keyhash\"\n          }\n        }\n      ],\n      \"fee\": 10.00001100,\n      \"hex\": \"020000000001017e263fc2f6621746eae77dd0cf5a8e42e3129a786a9dce38b0940bb1e814dcf50000000000fdffffff01b4236bee00000000160014a41424b6995beeaef7cbc9a4ebcf91b71793983d0247304402206b532fdf2ca4111872a8c8c322ab68e21e079253862c3c95cf86d18efcdb143d022039514e377cbac97c3ec1459aec7c9584a56c1c527588600c0435483c7b96535c012103fc3c5d0caa493055f57d5f3098b42555543a5219519ab90a22b20ddea49f151500000000\"\n    }\n  ]\n}\n```\n\n### How did you obtain Bitcoin Core\n\nCompiled from source\n\n### What version of Bitcoin Core are you using?\n\nBitcoin Core daemon version v28.99.0-ae69fc37e4ff\n\n### Operating system and version\n\nUbuntu 24.04.1 LTS\n\n### Machine specifications\n\n_No response_",
    "user": {
      "login": "vforvilela",
      "id": 80433106,
      "node_id": "MDQ6VXNlcjgwNDMzMTA2",
      "avatar_url": "https://avatars.githubusercontent.com/u/80433106?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vforvilela",
      "html_url": "https://github.com/vforvilela",
      "followers_url": "https://api.github.com/users/vforvilela/followers",
      "following_url": "https://api.github.com/users/vforvilela/following%7B/other_user%7D",
      "gists_url": "https://api.github.com/users/vforvilela/gists%7B/gist_id%7D",
      "starred_url": "https://api.github.com/users/vforvilela/starred%7B/owner%7D%7B/repo%7D",
      "subscriptions_url": "https://api.github.com/users/vforvilela/subscriptions",
      "organizations_url": "https://api.github.com/users/vforvilela/orgs",
      "repos_url": "https://api.github.com/users/vforvilela/repos",
      "events_url": "https://api.github.com/users/vforvilela/events%7B/privacy%7D",
      "received_events_url": "https://api.github.com/users/vforvilela/received_events",
      "type": "User",
      "site_admin": false,
      "patch_url": null
    },
    "labels": [
      {
        "id": 62963516,
        "node_id": "MDU6TGFiZWw2Mjk2MzUxNg==",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Tests",
        "name": "Tests",
        "color": "d4c5f9",
        "default": false
      }
    ],
    "assignees": [],
    "author_association": "NONE",
    "locked": false,
    "comments": 2,
    "created_at": "2025-01-18T22:08:18Z",
    "updated_at": "2025-01-23T08:21:57Z"
  },
  "events": [
    {
      "event": "mentioned",
      "id": 15986936279,
      "node_id": "MEE_lADOABII586mum77zwAAAAO45UnX",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/15986936279",
      "actor": {
        "login": "vforvilela",
        "id": 80433106,
        "node_id": "MDQ6VXNlcjgwNDMzMTA2",
        "avatar_url": "https://avatars.githubusercontent.com/u/80433106?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vforvilela",
        "html_url": "https://github.com/vforvilela",
        "followers_url": "https://api.github.com/users/vforvilela/followers",
        "following_url": "https://api.github.com/users/vforvilela/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vforvilela/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vforvilela/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vforvilela/subscriptions",
        "organizations_url": "https://api.github.com/users/vforvilela/orgs",
        "repos_url": "https://api.github.com/users/vforvilela/repos",
        "events_url": "https://api.github.com/users/vforvilela/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vforvilela/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-01-18T22:13:17Z"
    },
    {
      "event": "subscribed",
      "id": 15986936281,
      "node_id": "SE_lADOABII586mum77zwAAAAO45UnZ",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/15986936281",
      "actor": {
        "login": "vforvilela",
        "id": 80433106,
        "node_id": "MDQ6VXNlcjgwNDMzMTA2",
        "avatar_url": "https://avatars.githubusercontent.com/u/80433106?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vforvilela",
        "html_url": "https://github.com/vforvilela",
        "followers_url": "https://api.github.com/users/vforvilela/followers",
        "following_url": "https://api.github.com/users/vforvilela/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vforvilela/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vforvilela/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vforvilela/subscriptions",
        "organizations_url": "https://api.github.com/users/vforvilela/orgs",
        "repos_url": "https://api.github.com/users/vforvilela/repos",
        "events_url": "https://api.github.com/users/vforvilela/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vforvilela/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-01-18T22:13:17Z"
    },
    {
      "event": "labeled",
      "id": 15994057177,
      "node_id": "LE_lADOABII586mum77zwAAAAO5UfHZ",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/15994057177",
      "actor": {
        "login": "maflcko",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/maflcko",
        "html_url": "https://github.com/maflcko",
        "followers_url": "https://api.github.com/users/maflcko/followers",
        "following_url": "https://api.github.com/users/maflcko/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/maflcko/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/maflcko/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/maflcko/subscriptions",
        "organizations_url": "https://api.github.com/users/maflcko/orgs",
        "repos_url": "https://api.github.com/users/maflcko/repos",
        "events_url": "https://api.github.com/users/maflcko/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/maflcko/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-01-20T07:27:55Z",
      "label": {
        "name": "Tests",
        "color": "d4c5f9"
      }
    },
    {
      "event": "commented",
      "id": 2601620537,
      "node_id": "IC_kwDOABII586bEZQ5",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2601620537",
      "actor": {
        "login": "maflcko",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/maflcko",
        "html_url": "https://github.com/maflcko",
        "followers_url": "https://api.github.com/users/maflcko/followers",
        "following_url": "https://api.github.com/users/maflcko/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/maflcko/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/maflcko/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/maflcko/subscriptions",
        "organizations_url": "https://api.github.com/users/maflcko/orgs",
        "repos_url": "https://api.github.com/users/maflcko/repos",
        "events_url": "https://api.github.com/users/maflcko/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/maflcko/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-01-20T07:31:01Z",
      "updated_at": "2025-01-20T07:31:01Z",
      "author_association": "MEMBER",
      "body": "> The block reward should include both the block subsidy and the transaction fees from all transactions included in the block.\n\nIs there a use case for this? `generateblock` is a test-only RPC, so there is no need to write extra code to collect the fees. Note that the other `generate*` calls will collect the fees.",
      "user": {
        "login": "maflcko",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/maflcko",
        "html_url": "https://github.com/maflcko",
        "followers_url": "https://api.github.com/users/maflcko/followers",
        "following_url": "https://api.github.com/users/maflcko/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/maflcko/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/maflcko/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/maflcko/subscriptions",
        "organizations_url": "https://api.github.com/users/maflcko/orgs",
        "repos_url": "https://api.github.com/users/maflcko/repos",
        "events_url": "https://api.github.com/users/maflcko/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/maflcko/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/issues/31684#issuecomment-2601620537",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/31684"
    },
    {
      "event": "commented",
      "id": 2609136760,
      "node_id": "IC_kwDOABII586bhER4",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2609136760",
      "actor": {
        "login": "maflcko",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/maflcko",
        "html_url": "https://github.com/maflcko",
        "followers_url": "https://api.github.com/users/maflcko/followers",
        "following_url": "https://api.github.com/users/maflcko/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/maflcko/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/maflcko/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/maflcko/subscriptions",
        "organizations_url": "https://api.github.com/users/maflcko/orgs",
        "repos_url": "https://api.github.com/users/maflcko/repos",
        "events_url": "https://api.github.com/users/maflcko/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/maflcko/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-01-23T08:21:56Z",
      "updated_at": "2025-01-23T08:21:56Z",
      "author_association": "MEMBER",
      "body": "Maybe the doc could be updated to say \"Transaction fees are not collected in the block reward\" to clarify that this is the intentional behavior for now?",
      "user": {
        "login": "maflcko",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/maflcko",
        "html_url": "https://github.com/maflcko",
        "followers_url": "https://api.github.com/users/maflcko/followers",
        "following_url": "https://api.github.com/users/maflcko/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/maflcko/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/maflcko/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/maflcko/subscriptions",
        "organizations_url": "https://api.github.com/users/maflcko/orgs",
        "repos_url": "https://api.github.com/users/maflcko/repos",
        "events_url": "https://api.github.com/users/maflcko/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/maflcko/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/issues/31684#issuecomment-2609136760",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/31684"
    }
  ]
}
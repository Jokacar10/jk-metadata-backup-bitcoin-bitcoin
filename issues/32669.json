{
  "type": "issue",
  "issue": {
    "id": 3113076642,
    "node_id": "I_kwDOABII5865jcei",
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/32669",
    "repository_url": "https://api.github.com/repos/bitcoin/bitcoin",
    "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/32669/labels%7B/name%7D",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/32669/comments",
    "events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/32669/events",
    "html_url": "https://github.com/bitcoin/bitcoin/issues/32669",
    "number": 32669,
    "state": "open",
    "state_reason": null,
    "title": "upstream: capnp V2 doesn't support compilation with GCC (yet?)",
    "body": "See https://github.com/capnproto/capnproto/pull/2304, and the discussion from the maintainer. Seems like the interest in supporting GCC is pretty secondary:\n> Is there any way we can get a CI build that tests GCC support? Otherwise I'm sure it'll just bitrot again.\n\n> OK, seems fine to merge now but we can't really claim that GCC is \"supported\" until we have CI tests since it'll probably bitrot.\n\nWhen that PR lands, it looks like they will be supporting GCC 14.2 and later (relevant fix from `15.1` was backported).\n\nAssuming we are going to support / use capnp V2 at some point, it would be good if it did support GCC, if it doesn't, we'll have to bootstrap & use both Clang and GCC, for Linux builds in Guix, or patch capnp until it works with (our version of) GCC, or something else.\n\nhttps://capnproto.org/roadmap.html seems pretty outdated, as it still lists pre-1.x items, so it's not really clear when V2 is planned to happen.",
    "user": {
      "login": "fanquake",
      "id": 863730,
      "node_id": "MDQ6VXNlcjg2MzczMA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/863730?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/fanquake",
      "html_url": "https://github.com/fanquake",
      "followers_url": "https://api.github.com/users/fanquake/followers",
      "following_url": "https://api.github.com/users/fanquake/following%7B/other_user%7D",
      "gists_url": "https://api.github.com/users/fanquake/gists%7B/gist_id%7D",
      "starred_url": "https://api.github.com/users/fanquake/starred%7B/owner%7D%7B/repo%7D",
      "subscriptions_url": "https://api.github.com/users/fanquake/subscriptions",
      "organizations_url": "https://api.github.com/users/fanquake/orgs",
      "repos_url": "https://api.github.com/users/fanquake/repos",
      "events_url": "https://api.github.com/users/fanquake/events%7B/privacy%7D",
      "received_events_url": "https://api.github.com/users/fanquake/received_events",
      "type": "User",
      "site_admin": false,
      "patch_url": null
    },
    "labels": [
      {
        "id": 159815356,
        "node_id": "MDU6TGFiZWwxNTk4MTUzNTY=",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Upstream",
        "name": "Upstream",
        "color": "bfd4f2",
        "default": false
      }
    ],
    "assignees": [],
    "author_association": "MEMBER",
    "locked": false,
    "comments": 1,
    "created_at": "2025-06-03T08:58:17Z",
    "updated_at": "2025-06-03T14:19:03Z"
  },
  "events": [
    {
      "event": "labeled",
      "id": 17952705274,
      "node_id": "LE_lADOABII5865jceizwAAAAQuEIr6",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/17952705274",
      "actor": {
        "login": "fanquake",
        "id": 863730,
        "node_id": "MDQ6VXNlcjg2MzczMA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/863730?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fanquake",
        "html_url": "https://github.com/fanquake",
        "followers_url": "https://api.github.com/users/fanquake/followers",
        "following_url": "https://api.github.com/users/fanquake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fanquake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fanquake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fanquake/subscriptions",
        "organizations_url": "https://api.github.com/users/fanquake/orgs",
        "repos_url": "https://api.github.com/users/fanquake/repos",
        "events_url": "https://api.github.com/users/fanquake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fanquake/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-06-03T08:58:18Z",
      "label": {
        "name": "Upstream",
        "color": "bfd4f2"
      }
    },
    {
      "event": "commented",
      "id": 2935513870,
      "node_id": "IC_kwDOABII586u-GMO",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2935513870",
      "actor": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-06-03T14:19:01Z",
      "updated_at": "2025-06-03T14:19:01Z",
      "author_association": "CONTRIBUTOR",
      "body": "Thanks for finding this! I think best source of information about the v2 branch is probably https://capnproto.org/news/#whats-planned-for-20\n\nMy impression about the branch is that it's not intending to implement many significant changes, but more to be an API break and allow cleaning up some things like promise cancellations and EOF handling that they haven't been able to fix due to wanting to preserve backwards compatibility. They are also requiring C++20 and dropping support for -fno-exceptions and -fno-rtti.\n\nIt does sound like they aren't actively testing GCC (v2 announcement says \"as of this writing, GCC seems to ICE on KJâ€™s coroutine implementation\"), but I doubt they would make an actual release without GCC support. It looks like the objections to https://github.com/capnproto/capnproto/pull/2304 are that it adds `final` annotations too many places, and that it doesn't add GCC CI tests, and latter issue should be resolved when there is an ubuntu release with a new enough GCC.\n\nThe last capnproto [releases](https://github.com/capnproto/capnproto/tags) were 1.1.0 in December 2024 and 1.0.2 in January 2024. The v2 branch was announced in July 2023 and I expect issues with GCC will be resolved before there is a 2.0 release, but if this is not the case, I think should be ok sticking with 1.x until they are resolved, and I don't think we would be the only downstream project doing this in that situation.\n\nIn the meantime it probably would be a good idea to test the v2 branch to see if other changes in v2 break anything. I opened an issue to track that: https://github.com/bitcoin-core/libmultiprocess/issues/180",
      "user": {
        "login": "ryanofsky",
        "id": 7133040,
        "node_id": "MDQ6VXNlcjcxMzMwNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ryanofsky",
        "html_url": "https://github.com/ryanofsky",
        "followers_url": "https://api.github.com/users/ryanofsky/followers",
        "following_url": "https://api.github.com/users/ryanofsky/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ryanofsky/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ryanofsky/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
        "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
        "repos_url": "https://api.github.com/users/ryanofsky/repos",
        "events_url": "https://api.github.com/users/ryanofsky/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/issues/32669#issuecomment-2935513870",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/32669"
    }
  ]
}
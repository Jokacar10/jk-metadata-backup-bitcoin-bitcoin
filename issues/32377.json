{
  "type": "issue",
  "issue": {
    "id": 3028380194,
    "node_id": "I_kwDOABII5860gWoi",
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/32377",
    "repository_url": "https://api.github.com/repos/bitcoin/bitcoin",
    "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/32377/labels%7B/name%7D",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/32377/comments",
    "events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/32377/events",
    "html_url": "https://github.com/bitcoin/bitcoin/issues/32377",
    "number": 32377,
    "state": "open",
    "state_reason": null,
    "title": "Verify AssumeUTXO snapshot hashes during full validation as well",
    "body": "### Summary\n\nWe already hard‑code the AssumeUTXO height/UTXO-snapshot-hash/tx-count pairs (e.g. for mainnet we have heights **840,000** and **880,000**) in https://github.com/bitcoin/bitcoin/blob/master/src/kernel/chainparams.cpp#L170-L183.\nCurrently, this commitment is enforced only when a node explicitly activates a snapshot via `loadtxoutset`.\n\nDuring a regular initial block download, `-reindex`, or `-reindex-chainstate`, the node never cross‑checks the live chainstate against these values.\n\n### Proposal\n\nSince the expected UTXO set hash is known at the snapshot heights, we could verify it during full validation to cover both IBD and stored AssumeUTXO data.\nThis self‑consistency check would synchronize the outcomes of both seeding approaches.\nWhile iterating transactions we'd compute the current hash, and when reaching a snapshot height, we'd assert that the UTXO set hash and transaction count match the hardcoded values.\n\nThis cross‑reference would increase confidence in both mechanisms.\n\nOptionally, we could gate this behavior behind the `assumevalid` flag.",
    "user": {
      "login": "l0rinc",
      "id": 1841944,
      "node_id": "MDQ6VXNlcjE4NDE5NDQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1841944?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/l0rinc",
      "html_url": "https://github.com/l0rinc",
      "followers_url": "https://api.github.com/users/l0rinc/followers",
      "following_url": "https://api.github.com/users/l0rinc/following%7B/other_user%7D",
      "gists_url": "https://api.github.com/users/l0rinc/gists%7B/gist_id%7D",
      "starred_url": "https://api.github.com/users/l0rinc/starred%7B/owner%7D%7B/repo%7D",
      "subscriptions_url": "https://api.github.com/users/l0rinc/subscriptions",
      "organizations_url": "https://api.github.com/users/l0rinc/orgs",
      "repos_url": "https://api.github.com/users/l0rinc/repos",
      "events_url": "https://api.github.com/users/l0rinc/events%7B/privacy%7D",
      "received_events_url": "https://api.github.com/users/l0rinc/received_events",
      "type": "User",
      "site_admin": false,
      "patch_url": null
    },
    "labels": [],
    "assignees": [],
    "author_association": "CONTRIBUTOR",
    "locked": false,
    "comments": 0,
    "created_at": "2025-04-29T13:34:28Z",
    "updated_at": "2025-04-29T13:34:28Z"
  },
  "events": []
}
{
  "type": "issue",
  "issue": {
    "id": 3236497789,
    "node_id": "I_kwDOABII587A6Ql9",
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/32995",
    "repository_url": "https://api.github.com/repos/bitcoin/bitcoin",
    "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/32995/labels%7B/name%7D",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/32995/comments",
    "events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/32995/events",
    "html_url": "https://github.com/bitcoin/bitcoin/issues/32995",
    "number": 32995,
    "state": "open",
    "state_reason": null,
    "title": "fuzz: AddressSanitizer: odr-violation typeinfo name for CCoinsViewBacked",
    "body": "```\n# clang++ --version\nclang version 20.1.8 (Fedora 20.1.8-1.fc43)\nTarget: aarch64-redhat-linux-gnu\n\nmake -C depends/ NO_QT=1 NO_ZMQ=1 NO_USDT=1 NO_WALLET=1 AR=llvm-ar NM=llvm-nm RANLIB=llvm-ranlib STRIP=llvm-strip\ncmake -B build --toolchain /root/bitcoin/depends/aarch64-unknown-linux-gnu/toolchain.cmake -DBUILD_FOR_FUZZING=ON -DSANITIZERS=address -DAPPEND_CFLAGS=\"-flto=full\" -DAPPEND_CXXFLAGS=\"-flto=full\" -DAPPEND_LDFLAGS=\"-flto=full\"\ncmake --build build\n```\n```\n./build/bin/fuzz\n=================================================================\n==987273==ERROR: AddressSanitizer: odr-violation (0xab71fdf737c0):\n  [1] size=19 'typeinfo name for CCoinsViewBacked' /root/bitcoin/src/coins.cpp in /root/bitcoin/build/bin/fuzz\n  [2] size=19 'typeinfo name for CCoinsViewBacked' /root/bitcoin/src/coins.cpp in /root/bitcoin/build/bin/fuzz\nThese globals were registered at these points:\n  [1]:\n    #0 0xab71fcd09e3c in __asan_register_globals (/root/bitcoin/build/bin/fuzz+0x2d9e3c) (BuildId: f2dc106e95ba2dafe63dc7170e17e7f0baf3ce0a)\n    #1 0xab71fcd0aef4 in __asan_register_elf_globals (/root/bitcoin/build/bin/fuzz+0x2daef4) (BuildId: f2dc106e95ba2dafe63dc7170e17e7f0baf3ce0a)\n    #2 0xab71fccf64ac in _start (/root/bitcoin/build/bin/fuzz+0x2c64ac) (BuildId: f2dc106e95ba2dafe63dc7170e17e7f0baf3ce0a)\n\n  [2]:\n    #0 0xab71fcd09e3c in __asan_register_globals (/root/bitcoin/build/bin/fuzz+0x2d9e3c) (BuildId: f2dc106e95ba2dafe63dc7170e17e7f0baf3ce0a)\n    #1 0xab71fcd0aef4 in __asan_register_elf_globals (/root/bitcoin/build/bin/fuzz+0x2daef4) (BuildId: f2dc106e95ba2dafe63dc7170e17e7f0baf3ce0a)\n    #2 0xab71fccf64ac in _start (/root/bitcoin/build/bin/fuzz+0x2c64ac) (BuildId: f2dc106e95ba2dafe63dc7170e17e7f0baf3ce0a)\n\n==987273==HINT: if you don't care about these errors you may set ASAN_OPTIONS=detect_odr_violation=0\nSUMMARY: AddressSanitizer: odr-violation: global 'typeinfo name for CCoinsViewBacked' at /root/bitcoin/src/coins.cpp in /root/bitcoin/build/bin/fuzz\n==987273==ABORTING\n```\n\nNoticed while retrying `-flto` with oss-fuzz. Saw something similar there, under `-O1`:\n```bash\n[100%] Built target fuzz\n+ WRITE_ALL_FUZZ_TARGETS_AND_ABORT=/tmp/a\n+ ./build_fuzz/bin/fuzz\n=================================================================\n==8668==ERROR: AddressSanitizer: odr-violation (0x55c825a8e0a0):\n  [1] size=20 'typeinfo name for leveldb::Snapshot' /src/bitcoin-core/src/leveldb/db/db_impl.cc in /src/bitcoin-core/build_fuzz/bin/fuzz\n  [2] size=20 'typeinfo name for leveldb::Snapshot' /src/bitcoin-core/src/leveldb/db/db_impl.cc in /src/bitcoin-core/build_fuzz/bin/fuzz\nThese globals were registered at these points:\n  [1]:\n    #0 0x55c82338e5a6 in __asan_register_globals /src/llvm-project/compiler-rt/lib/asan/asan_globals.cpp:369:3\n    #1 0x55c82338f6c9 in __asan_register_elf_globals /src/llvm-project/compiler-rt/lib/asan/asan_globals.cpp:352:3\n    #2 0x55c8255c24ec in __libc_csu_init (/src/bitcoin-core/build_fuzz/bin/fuzz+0x32724ec)\n\n  [2]:\n    #0 0x55c82338e5a6 in __asan_register_globals /src/llvm-project/compiler-rt/lib/asan/asan_globals.cpp:369:3\n    #1 0x55c82338f6c9 in __asan_register_elf_globals /src/llvm-project/compiler-rt/lib/asan/asan_globals.cpp:352:3\n    #2 0x55c8255c24ec in __libc_csu_init (/src/bitcoin-core/build_fuzz/bin/fuzz+0x32724ec)\n\n==8668==HINT: if you don't care about these errors you may set ASAN_OPTIONS=detect_odr_violation=0\nSUMMARY: AddressSanitizer: odr-violation: global 'typeinfo name for leveldb::Snapshot' at /src/bitcoin-core/src/leveldb/db/db_impl.cc in /src/bitcoin-core/build_fuzz/bin/fuzz\n==8668==ABORTING\n```",
    "user": {
      "login": "fanquake",
      "id": 863730,
      "node_id": "MDQ6VXNlcjg2MzczMA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/863730?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/fanquake",
      "html_url": "https://github.com/fanquake",
      "followers_url": "https://api.github.com/users/fanquake/followers",
      "following_url": "https://api.github.com/users/fanquake/following%7B/other_user%7D",
      "gists_url": "https://api.github.com/users/fanquake/gists%7B/gist_id%7D",
      "starred_url": "https://api.github.com/users/fanquake/starred%7B/owner%7D%7B/repo%7D",
      "subscriptions_url": "https://api.github.com/users/fanquake/subscriptions",
      "organizations_url": "https://api.github.com/users/fanquake/orgs",
      "repos_url": "https://api.github.com/users/fanquake/repos",
      "events_url": "https://api.github.com/users/fanquake/events%7B/privacy%7D",
      "received_events_url": "https://api.github.com/users/fanquake/received_events",
      "type": "User",
      "site_admin": false,
      "patch_url": null
    },
    "labels": [],
    "assignees": [],
    "author_association": "MEMBER",
    "locked": false,
    "comments": 0,
    "created_at": "2025-07-16T15:54:15Z",
    "updated_at": "2025-07-16T15:54:15Z"
  },
  "events": []
}
{
  "type": "issue",
  "issue": {
    "id": 3192609044,
    "node_id": "I_kwDOABII586-S1kU",
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/32849",
    "repository_url": "https://api.github.com/repos/bitcoin/bitcoin",
    "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/32849/labels%7B/name%7D",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/32849/comments",
    "events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/32849/events",
    "html_url": "https://github.com/bitcoin/bitcoin/issues/32849",
    "number": 32849,
    "state": "open",
    "state_reason": null,
    "title": "Internal bug detected: FinalizeAndExtractPSBT(psbtx_copy, mtx)",
    "body": "### Is there an existing issue for this?\n\n- [x] I have searched the existing issues\n\n### Current behaviour\n\n```\nbitcoin-cli -testnet4 descriptorprocesspsbt cHNidP8BAF4CAAAAAfrAU8xRZDY7er/kAUGzVtup++LN4otxeOtANj9Tw8xYAAAAAAD9////AeAPlwAAAAAAIlEgmQIRpk7kW78uK6z/DBX37H4Pi4OLy3Fau0pXquQSXLUAAAAAAAEBK4CWmAAAAAAAIlEg5cugS+vKVwm3OSTEr0sIVU/ahEJzIS6iXjsvWNwJ0VUBAwSDAAAAAQhDAUFATOMkSjzzD+7k1AnzZgJ+G+sDZXX5ob0tlQ9mZIseDe73u4fU6SPKdtxve2Wm/mVNrRIP5cPEnkcMv0BJ2iIWgyEWtJa/uuFJh4F8U9WSvgqmbEXHuURDwfdFUTc/nONNI0YZAP/2NCNWAACAAAAAgAAAAIAAAAAAAAAAAAEXILSWv7rhSYeBfFPVkr4KpmxFx7lEQ8H3RVE3P5zjTSNGAAA= \"[\\\"tr([fff63423/86'/0'/0']tpubDDfvptb1GNdu4TRUUNf9bwsFFpHADAmwaB3uoC8ukv5JMsYPzEc3E6yg4w8t49Wq7jtL8LC3VPmuhXoSJxpamWDPfphAz3Fioki3WerwH3Y/0/0)#twc4a4lc\\\"]\"\nerror code: -1\nerror message:\nInternal bug detected: FinalizeAndExtractPSBT(psbtx_copy, mtx)\nrpc/rawtransaction.cpp:1986 (operator())\nBitcoin Core v29.0.0\nPlease report this issue here: https://github.com/bitcoin/bitcoin/issues\n```\n\n### Expected behaviour\n\nThis should give an error maybe stating that the signature inside the final_scriptwitness is an invalid schnorr signature.\nPlease note that the signature inside the psbt uses SIGHASH_SINGLE | ANYONECANPAY flag\n\n\n### Steps to reproduce\n\nThe same command should work on any local regtest or testnet4.\n\n### Relevant log output\n\n_No response_\n\n### How did you obtain Bitcoin Core\n\nPre-built binaries\n\n### What version of Bitcoin Core are you using?\n\nv29.0.0\n\n### Operating system and version\n\nmacOS Sequoia 15.1.1\n\n### Machine specifications\n\n_No response_",
    "user": {
      "login": "ekrembal",
      "id": 29926881,
      "node_id": "MDQ6VXNlcjI5OTI2ODgx",
      "avatar_url": "https://avatars.githubusercontent.com/u/29926881?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ekrembal",
      "html_url": "https://github.com/ekrembal",
      "followers_url": "https://api.github.com/users/ekrembal/followers",
      "following_url": "https://api.github.com/users/ekrembal/following%7B/other_user%7D",
      "gists_url": "https://api.github.com/users/ekrembal/gists%7B/gist_id%7D",
      "starred_url": "https://api.github.com/users/ekrembal/starred%7B/owner%7D%7B/repo%7D",
      "subscriptions_url": "https://api.github.com/users/ekrembal/subscriptions",
      "organizations_url": "https://api.github.com/users/ekrembal/orgs",
      "repos_url": "https://api.github.com/users/ekrembal/repos",
      "events_url": "https://api.github.com/users/ekrembal/events%7B/privacy%7D",
      "received_events_url": "https://api.github.com/users/ekrembal/received_events",
      "type": "User",
      "site_admin": false,
      "patch_url": null
    },
    "labels": [],
    "assignees": [],
    "author_association": "NONE",
    "locked": false,
    "comments": 0,
    "created_at": "2025-07-01T13:57:25Z",
    "updated_at": "2025-07-01T13:57:25Z"
  },
  "events": []
}
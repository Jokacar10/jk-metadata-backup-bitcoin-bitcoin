{
  "type": "issue",
  "issue": {
    "id": 3149228636,
    "node_id": "I_kwDOABII5867tWpc",
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/32759",
    "repository_url": "https://api.github.com/repos/bitcoin/bitcoin",
    "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/32759/labels%7B/name%7D",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/32759/comments",
    "events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/32759/events",
    "html_url": "https://github.com/bitcoin/bitcoin/issues/32759",
    "number": 32759,
    "state": "open",
    "state_reason": null,
    "title": "Guix build fails on M4 macOS host with Ubuntu in UTM",
    "body": "### Is there an existing issue for this?\n\n- [x] I have searched the existing issues\n\n### Current behaviour\n\nSince #32431 my macOS (M4 using UTM) Guix builds no longer work: \n\n```\nHOSTS=\"x86_64-linux-gnu\" contrib/guix/guix-build\n...\nguix shell: error: while setting up the build environment: cannot set armhf-linux personality: Invalid argument\n```\n\nThis seems to be something else than what I encountered on my native AMD Ubuntu machine: https://github.com/bitcoin/bitcoin/pull/32431#issuecomment-2966089437\n\nBut perhaps a common factor is that this PR pulled in a lot of new guix packages.\n\n### Expected behaviour\n\nGuix build should work, it does on c8abd972818f83d90bf50b250131f338034460ef.\n\n### Steps to reproduce\n\nSee below\n\n### Relevant log output\n\n```\n$ HOSTS=\"x86_64-linux-gnu\" contrib/guix/guix-build\nChecking that we can connect to the guix-daemon...\n\nHint: If this hangs, you may want to try turning your guix-daemon off and on\n      again.\n\nmake: Entering directory '/home/sjors/bitcoin/depends'\nmake[1]: Entering directory '/home/sjors/bitcoin/depends'\nmake[1]: Leaving directory '/home/sjors/bitcoin/depends'\nmake: Leaving directory '/home/sjors/bitcoin/depends'\nINFO: Building fed41b75fbfa for platform triple x86_64-linux-gnu:\n      ...using reference timestamp: 1749642062\n      ...running at most 10 jobs\n      ...from worktree directory: '/home/sjors/bitcoin'\n          ...bind-mounted in container to: '/bitcoin'\n      ...in build directory: '/home/sjors/bitcoin/guix-build-fed41b75fbfa/distsrc-fed41b75fbfa-x86_64-linux-gnu'\n          ...bind-mounted in container to: '/distsrc-base/distsrc-fed41b75fbfa-x86_64-linux-gnu'\n      ...outputting in: '/home/sjors/bitcoin/guix-build-fed41b75fbfa/output/x86_64-linux-gnu'\n          ...bind-mounted in container to: '/outdir-base/x86_64-linux-gnu'\n      ADDITIONAL FLAGS (if set)\n          ADDITIONAL_GUIX_COMMON_FLAGS: --max-jobs=4 --no-substitutes\n          ADDITIONAL_GUIX_ENVIRONMENT_FLAGS:\n          ADDITIONAL_GUIX_TIMEMACHINE_FLAGS:\nThe following derivations will be built:\n  /gnu/store/5kpjfn7qg25c4w1q3cczl565x0yi8mpb-python-lief-0.16.6.drv\n  /gnu/store/04dcmhmlhgj2pgnyspb88lm5j9rwbd60-python-typing-extensions-4.9.0.drv\n  /gnu/store/nd7dcikf5dnq113cxmb1r4w0q8ijs1qq-typing_extensions-4.9.0.tar.gz.drv\n  /gnu/store/25adw1ck5fvbgvrx405c0l6kjag49j9z-python-importlib-metadata-5.2.0.drv\n...\n  /gnu/store/c985sj9mqmk3qvsd55b0g11hlv26krbk-msgpack-1.0.4.tar.gz.drv\n  /gnu/store/x8vm49yz0k8wm3w2hgishy5q1svkcfaw-python-pymongo-4.1.1.drv\n  /gnu/store/6dv3fazv5hnhwvgfnnykm0f2lwnajgsq-pymongo-4.1.1.tar.gz.drv\n\nbuilding /gnu/store/ck789yrq1xslycd986zdh5fq8dknl3r3-rust-actix-derive-0.5.0.tar.gz.drv...\nbuilding /gnu/store/2xasv0pcv8gw6lafag6bkjfqkmlbj02f-rust-actix-http-1.0.1.tar.gz.drv...\nbuilding /gnu/store/qifi4hb8hjm6bk6nv4664fyw7cb25fgp-rust-actix-http-2.2.0.tar.gz.drv...\nbuilding /gnu/store/gm8l3rn479p9hf3zs1vj9pzchvcj42f8-rust-actix-macros-0.1.3.tar.gz.drv...\nThe following builds are still in progress:\n  /gnu/store/qifi4hb8hjm6bk6nv4664fyw7cb25fgp-rust-actix-http-2.2.0.tar.gz.drv\n  /gnu/store/ck789yrq1xslycd986zdh5fq8dknl3r3-rust-actix-derive-0.5.0.tar.gz.drv\n\nbuilding /gnu/store/grpq0sq301rwsz6h4vbdx9sgvi64wai4-Python-2.7.18.tar.xz.drv...\nThe following builds are still in progress:\n  /gnu/store/grpq0sq301rwsz6h4vbdx9sgvi64wai4-Python-2.7.18.tar.xz.drv\n  /gnu/store/qifi4hb8hjm6bk6nv4664fyw7cb25fgp-rust-actix-http-2.2.0.tar.gz.drv\n\nThe following builds are still in progress:\n  /gnu/store/grpq0sq301rwsz6h4vbdx9sgvi64wai4-Python-2.7.18.tar.xz.drv\n  /gnu/store/qifi4hb8hjm6bk6nv4664fyw7cb25fgp-rust-actix-http-2.2.0.tar.gz.drv\n\nbuilding /gnu/store/sf5wwnpy8mr9l8iic2xz5bmg3bppjrj9-asynctest-0.13.0.tar.gz.drv...\nbuilding /gnu/store/hiqwnz4mhiad1zcqyf250b1ws0s36djc-attrs-21.2.0.tar.gz.drv...\nThe following builds are still in progress:\n  /gnu/store/hiqwnz4mhiad1zcqyf250b1ws0s36djc-attrs-21.2.0.tar.gz.drv\n  /gnu/store/sf5wwnpy8mr9l8iic2xz5bmg3bppjrj9-asynctest-0.13.0.tar.gz.drv\n  /gnu/store/grpq0sq301rwsz6h4vbdx9sgvi64wai4-Python-2.7.18.tar.xz.drv\n\nnote: keeping build directory `/tmp/guix-build-Python-2.7.18.tar.xz.drv-2'\nnote: keeping build directory `/tmp/guix-build-bash.drv-2'\nnote: keeping build directory `/tmp/guix-build-asynctest-0.13.0.tar.gz.drv-2'\nnote: keeping build directory `/tmp/guix-build-attrs-21.2.0.tar.gz.drv-2'\nguix shell: error: while setting up the build environment: cannot set armhf-linux personality: Invalid argument\n```\n\n### How did you obtain Bitcoin Core\n\nCompiled from source\n\n### What version of Bitcoin Core are you using?\n\nmaster@fed41b75fbfa6d14cce852863271b1fb0206eef0\n\n### Operating system and version\n\nMacOS 15.5 with UTM, guest (virtualized) Ubuntu 24.10 (aarch64\n\n### Machine specifications\n\nM4",
    "user": {
      "login": "Sjors",
      "id": 10217,
      "node_id": "MDQ6VXNlcjEwMjE3",
      "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Sjors",
      "html_url": "https://github.com/Sjors",
      "followers_url": "https://api.github.com/users/Sjors/followers",
      "following_url": "https://api.github.com/users/Sjors/following%7B/other_user%7D",
      "gists_url": "https://api.github.com/users/Sjors/gists%7B/gist_id%7D",
      "starred_url": "https://api.github.com/users/Sjors/starred%7B/owner%7D%7B/repo%7D",
      "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
      "organizations_url": "https://api.github.com/users/Sjors/orgs",
      "repos_url": "https://api.github.com/users/Sjors/repos",
      "events_url": "https://api.github.com/users/Sjors/events%7B/privacy%7D",
      "received_events_url": "https://api.github.com/users/Sjors/received_events",
      "type": "User",
      "site_admin": false,
      "patch_url": null
    },
    "labels": [
      {
        "id": 61889416,
        "node_id": "MDU6TGFiZWw2MTg4OTQxNg==",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Build%20system",
        "name": "Build system",
        "color": "5319e7",
        "default": false
      }
    ],
    "assignees": [],
    "author_association": "MEMBER",
    "locked": false,
    "comments": 0,
    "created_at": "2025-06-16T09:25:48Z",
    "updated_at": "2025-06-16T09:31:57Z"
  },
  "events": [
    {
      "event": "labeled",
      "id": 18166177100,
      "node_id": "LE_lADOABII5867tWpczwAAAAQ6yd1M",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/18166177100",
      "actor": {
        "login": "maflcko",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/maflcko",
        "html_url": "https://github.com/maflcko",
        "followers_url": "https://api.github.com/users/maflcko/followers",
        "following_url": "https://api.github.com/users/maflcko/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/maflcko/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/maflcko/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/maflcko/subscriptions",
        "organizations_url": "https://api.github.com/users/maflcko/orgs",
        "repos_url": "https://api.github.com/users/maflcko/repos",
        "events_url": "https://api.github.com/users/maflcko/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/maflcko/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-06-16T09:31:57Z",
      "label": {
        "name": "Build system",
        "color": "5319e7"
      }
    }
  ]
}
{
  "type": "issue",
  "issue": {
    "id": 3398490632,
    "node_id": "I_kwDOABII587KkNoI",
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/33350",
    "repository_url": "https://api.github.com/repos/bitcoin/bitcoin",
    "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/33350/labels%7B/name%7D",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/33350/comments",
    "events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/33350/events",
    "html_url": "https://github.com/bitcoin/bitcoin/issues/33350",
    "number": 33350,
    "state": "open",
    "state_reason": null,
    "title": "Difficulty in reliably mapping errors from Bitcoin Core due to unstable error codes and messages",
    "body": "### Please describe the feature you'd like to see added.\n\nIt's becoming increasingly difficult to reliably map and handle errors originating from Bitcoin Core. The primary challenge stems from the frequent changes in both the error codes and the descriptive error text.\n\nProblem Description\nOur current error-handling logic relies on parsing the responses from Bitcoin Core. However, this approach is fragile for two main reasons:\n\nUnstable Error Codes: The numerical error codes returned by Bitcoin Core are not stable across versions. An error code that signifies a specific issue in one version might be changed or removed in a future update, which breaks any logic that depends on matching these codes.\n\nChanging Error Messages: Relying on string matching of the error messages is also unreliable. The text of these messages is frequently rephrased, updated, or otherwise modified between releases. This makes text-based error detection brittle and requires constant maintenance to keep up with the changes in Core.\n\nThis instability creates a significant maintenance burden, as our error-handling code needs to be constantly revisited and updated to align with the latest changes in Bitcoin Core.\n\nA clear example of this ongoing struggle can be seen in this related issue/PR, which highlights the effort required to adapt to these changes: https://github.com/btcsuite/btcwallet/pull/1053\n\nSeeking a More Robust Solution\nGiven these challenges, we are looking for better strategies to interpret errors from Bitcoin Core that are less susceptible to these frequent upstream changes.\n\nWe are open to any tips or suggestions how to handle this. Are there more resilient patterns for error handling in this context that we should consider? Any advice would be greatly appreciated.\n\n### Is your feature related to a problem, if so please describe it.\n\n_No response_\n\n### Describe the solution you'd like\n\n_No response_\n\n### Describe any alternatives you've considered\n\n_No response_\n\n### Please leave any additional context\n\n_No response_",
    "user": {
      "login": "ziggie1984",
      "id": 90319354,
      "node_id": "MDQ6VXNlcjkwMzE5MzU0",
      "avatar_url": "https://avatars.githubusercontent.com/u/90319354?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ziggie1984",
      "html_url": "https://github.com/ziggie1984",
      "followers_url": "https://api.github.com/users/ziggie1984/followers",
      "following_url": "https://api.github.com/users/ziggie1984/following%7B/other_user%7D",
      "gists_url": "https://api.github.com/users/ziggie1984/gists%7B/gist_id%7D",
      "starred_url": "https://api.github.com/users/ziggie1984/starred%7B/owner%7D%7B/repo%7D",
      "subscriptions_url": "https://api.github.com/users/ziggie1984/subscriptions",
      "organizations_url": "https://api.github.com/users/ziggie1984/orgs",
      "repos_url": "https://api.github.com/users/ziggie1984/repos",
      "events_url": "https://api.github.com/users/ziggie1984/events%7B/privacy%7D",
      "received_events_url": "https://api.github.com/users/ziggie1984/received_events",
      "type": "User",
      "site_admin": false,
      "patch_url": null
    },
    "labels": [
      {
        "id": 64583,
        "node_id": "MDU6TGFiZWw2NDU4Mw==",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Feature",
        "name": "Feature",
        "color": "7cf575",
        "default": false
      }
    ],
    "assignees": [],
    "author_association": "NONE",
    "locked": false,
    "comments": 3,
    "created_at": "2025-09-09T13:25:54Z",
    "updated_at": "2025-09-09T14:42:56Z"
  },
  "events": [
    {
      "event": "labeled",
      "id": 19590093817,
      "node_id": "LE_lADOABII587KkNoIzwAAAASPqRv5",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events/19590093817",
      "actor": {
        "login": "ziggie1984",
        "id": 90319354,
        "node_id": "MDQ6VXNlcjkwMzE5MzU0",
        "avatar_url": "https://avatars.githubusercontent.com/u/90319354?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ziggie1984",
        "html_url": "https://github.com/ziggie1984",
        "followers_url": "https://api.github.com/users/ziggie1984/followers",
        "following_url": "https://api.github.com/users/ziggie1984/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ziggie1984/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ziggie1984/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ziggie1984/subscriptions",
        "organizations_url": "https://api.github.com/users/ziggie1984/orgs",
        "repos_url": "https://api.github.com/users/ziggie1984/repos",
        "events_url": "https://api.github.com/users/ziggie1984/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ziggie1984/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-09-09T13:25:56Z",
      "label": {
        "name": "Feature",
        "color": "7cf575"
      }
    },
    {
      "event": "commented",
      "id": 3270872088,
      "node_id": "IC_kwDOABII587C9YwY",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/3270872088",
      "actor": {
        "login": "instagibbs",
        "id": 5767891,
        "node_id": "MDQ6VXNlcjU3Njc4OTE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5767891?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/instagibbs",
        "html_url": "https://github.com/instagibbs",
        "followers_url": "https://api.github.com/users/instagibbs/followers",
        "following_url": "https://api.github.com/users/instagibbs/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/instagibbs/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/instagibbs/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/instagibbs/subscriptions",
        "organizations_url": "https://api.github.com/users/instagibbs/orgs",
        "repos_url": "https://api.github.com/users/instagibbs/repos",
        "events_url": "https://api.github.com/users/instagibbs/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/instagibbs/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-09-09T13:58:07Z",
      "updated_at": "2025-09-09T13:58:07Z",
      "author_association": "MEMBER",
      "body": "Is there a easy to read table somewhere on how you are interpreting and using specific error codes / msgs and how your software is intended to respond to them? This seems like an twice a year issue, and as far as I know no one else is using the errors for non-debugging reasons, or they're too shy to complain about the breaks.\n\n\n\n",
      "user": {
        "login": "instagibbs",
        "id": 5767891,
        "node_id": "MDQ6VXNlcjU3Njc4OTE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5767891?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/instagibbs",
        "html_url": "https://github.com/instagibbs",
        "followers_url": "https://api.github.com/users/instagibbs/followers",
        "following_url": "https://api.github.com/users/instagibbs/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/instagibbs/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/instagibbs/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/instagibbs/subscriptions",
        "organizations_url": "https://api.github.com/users/instagibbs/orgs",
        "repos_url": "https://api.github.com/users/instagibbs/repos",
        "events_url": "https://api.github.com/users/instagibbs/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/instagibbs/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/issues/33350#issuecomment-3270872088",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/33350"
    },
    {
      "event": "commented",
      "id": 3270947536,
      "node_id": "IC_kwDOABII587C9rLQ",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/3270947536",
      "actor": {
        "login": "ziggie1984",
        "id": 90319354,
        "node_id": "MDQ6VXNlcjkwMzE5MzU0",
        "avatar_url": "https://avatars.githubusercontent.com/u/90319354?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ziggie1984",
        "html_url": "https://github.com/ziggie1984",
        "followers_url": "https://api.github.com/users/ziggie1984/followers",
        "following_url": "https://api.github.com/users/ziggie1984/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ziggie1984/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ziggie1984/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ziggie1984/subscriptions",
        "organizations_url": "https://api.github.com/users/ziggie1984/orgs",
        "repos_url": "https://api.github.com/users/ziggie1984/repos",
        "events_url": "https://api.github.com/users/ziggie1984/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ziggie1984/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-09-09T14:15:51Z",
      "updated_at": "2025-09-09T14:15:51Z",
      "author_association": "NONE",
      "body": "We don't have an easy table but I think for example this gives a good example:\n\nhttps://github.com/lightningnetwork/lnd/blob/master/sweep/fee_bumper.go#L568-L578\n\nIn our fee bumper engine we only bump the fee of a transaction if the error is somehow related to an `insufficient fee` error, otherwise we drop this input from the sweeping system because problems like not having the correct signature or being already spent would cause us to never properly sweep this input.\n\nWhat I am more interested is, does core change these error strings or codes with the awareness that dependant code will have to update or is it not really a goal to stay backwards compatible in regards of the error codes/strings ? \n\nYes I am really surprised that people are not using those error codes to decided based on that what is wrong with their transaction what they for example trying to broadcast. Especially `testMempoolAccept` is by the name actually built to test for a specific error to basically change the transaction accordingly.\n\nMaybe it would be good to always have a highlighting notification in the release notes when error codes/ errror strings change. With that we could react accordingly and update our software.",
      "user": {
        "login": "ziggie1984",
        "id": 90319354,
        "node_id": "MDQ6VXNlcjkwMzE5MzU0",
        "avatar_url": "https://avatars.githubusercontent.com/u/90319354?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ziggie1984",
        "html_url": "https://github.com/ziggie1984",
        "followers_url": "https://api.github.com/users/ziggie1984/followers",
        "following_url": "https://api.github.com/users/ziggie1984/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/ziggie1984/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/ziggie1984/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/ziggie1984/subscriptions",
        "organizations_url": "https://api.github.com/users/ziggie1984/orgs",
        "repos_url": "https://api.github.com/users/ziggie1984/repos",
        "events_url": "https://api.github.com/users/ziggie1984/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/ziggie1984/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/issues/33350#issuecomment-3270947536",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/33350"
    },
    {
      "event": "commented",
      "id": 3270998612,
      "node_id": "IC_kwDOABII587C93pU",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/3270998612",
      "actor": {
        "login": "instagibbs",
        "id": 5767891,
        "node_id": "MDQ6VXNlcjU3Njc4OTE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5767891?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/instagibbs",
        "html_url": "https://github.com/instagibbs",
        "followers_url": "https://api.github.com/users/instagibbs/followers",
        "following_url": "https://api.github.com/users/instagibbs/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/instagibbs/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/instagibbs/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/instagibbs/subscriptions",
        "organizations_url": "https://api.github.com/users/instagibbs/orgs",
        "repos_url": "https://api.github.com/users/instagibbs/repos",
        "events_url": "https://api.github.com/users/instagibbs/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/instagibbs/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-09-09T14:28:30Z",
      "updated_at": "2025-09-09T14:42:56Z",
      "author_association": "MEMBER",
      "body": "Speaking only for myself since I'm more familiar with both LN (by means of CLN) and Bitcoin Core sides...\n\n> Yes I am really surprised that people are not using those error codes to decided based on that what is wrong with their transaction what they for example trying to broadcast.\n\nI think it's honestly quite rare. People will craft transactions using information gleaned Core (like mempool minfee or fee estimator) and proactively avoid violating it. The software can't do anything about other errors, other than report loudly in logs.\n\nShower thought: Would a \"this type of transaction will not work for some unfixable reason\" vs \"this may work later\" vs \"this may work with fees bumped\" kind of status help? This is why I'm asking for more scenarios.\n\n> Maybe it would be good to always have a highlighting notification in the release notes when error codes/ errror strings change. With that we could react accordingly and update our software.\n\nThis definitely should have been done for `TX_RECONSIDERABLE`. New codes are pretty rare, this one being related to package relay internals. \n\nHowever strings will be changing, and transaction check ordering will change, especially going forward with the cluster mempool rewrite. e.g., ancestor limits are no more, no more rbf carveout, different RBF checks, dropped rules, etc. I don't think it's going to be possible to make promises otherwise.\n\n\n\n",
      "user": {
        "login": "instagibbs",
        "id": 5767891,
        "node_id": "MDQ6VXNlcjU3Njc4OTE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5767891?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/instagibbs",
        "html_url": "https://github.com/instagibbs",
        "followers_url": "https://api.github.com/users/instagibbs/followers",
        "following_url": "https://api.github.com/users/instagibbs/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/instagibbs/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/instagibbs/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/instagibbs/subscriptions",
        "organizations_url": "https://api.github.com/users/instagibbs/orgs",
        "repos_url": "https://api.github.com/users/instagibbs/repos",
        "events_url": "https://api.github.com/users/instagibbs/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/instagibbs/received_events",
        "type": "User",
        "site_admin": false,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin/bitcoin/issues/33350#issuecomment-3270998612",
      "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/33350"
    }
  ]
}
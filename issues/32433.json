{
  "type": "issue",
  "issue": {
    "id": 3044955193,
    "node_id": "I_kwDOABII5861flQ5",
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/32433",
    "repository_url": "https://api.github.com/repos/bitcoin/bitcoin",
    "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/32433/labels%7B/name%7D",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/32433/comments",
    "events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/32433/events",
    "html_url": "https://github.com/bitcoin/bitcoin/issues/32433",
    "number": 32433,
    "state": "open",
    "state_reason": null,
    "title": "\"rpcallowip=\" configuration directive doesn't accept RFC4193 addresses",
    "body": "### Is there an existing issue for this?\n\n- [x] I have searched the existing issues\n\n### Current behaviour\n\nI have a local dual-stack network using RFC1918 addresses on IPv4 stack and RFC4193 addresses on IPv6 stack. I would like to restrict the access to RPC ports of Bitcoin Core nodes running in the network based on the source address of the connections. However, Bitcoin Core 29.0 doesn't accept `rpcallowip=` directives that specify addresses under the `[fc00::/7]` IP block.\n\n### Expected behaviour\n\nBitcoin Core should accept addresses under the `[fc00::/7]` IP block defined via `rpcallowip=` directives, and perform access control according to the list of network blocks specified via configuration or command line.\n\n### Steps to reproduce\n\nRun the command line specified below on a CentOS Stream 9 machine connected to the internet.\n\n```\n$ curl --no-progress-meter -L 'https://bitcoincore.org/bin/bitcoin-core-29.0/bitcoin-29.0-x86_64-linux-gnu.tar.gz' | tar zx && mkdir -p data && ./bitcoin-29.0/bin/bitcoind '-rpcbind=[::]:8332' '-rpcallowip=fc00:db8:c0:ff:ee::/80'\n```\n\n### Relevant log output\n\n```\n[admin@centos9-stream-a ~]$ curl --no-progress-meter -L 'https://bitcoincore.org/bin/bitcoin-core-29.0/bitcoin-29.0-x86_64-linux-gnu.tar.gz' | tar zx && mkdir -p data && ./bitcoin-29.0/bin/bitcoind '-rpcbind=[::]:8332' '-rpcallowip=fc00:db8:c0:ff:ee::/80'\n2025-05-07T07:10:45Z Bitcoin Core version v29.0.0 (release build)\n2025-05-07T07:10:45Z Using the 'sse4(1way),sse41(4way),avx2(8way)' SHA256 implementation\n2025-05-07T07:10:45Z Using RdSeed as an additional entropy source\n2025-05-07T07:10:45Z Using RdRand as an additional entropy source\n2025-05-07T07:10:45Z Default data directory /home/admin/.bitcoin\n2025-05-07T07:10:45Z Using data directory /home/admin/.bitcoin\n2025-05-07T07:10:45Z Config file: /home/admin/.bitcoin/bitcoin.conf (not found, skipping)\n2025-05-07T07:10:45Z Command-line arg: rpcallowip=\"fc00:db8:c0:ff:ee::/80\"\n2025-05-07T07:10:45Z Command-line arg: rpcbind=\"[::]:8332\"\n2025-05-07T07:10:45Z Using at most 125 automatic connections (1024 file descriptors available)\n2025-05-07T07:10:45Z scheduler thread start\n2025-05-07T07:10:45Z [error] Invalid -rpcallowip subnet specification: fc00:db8:c0:ff:ee::/80. Valid are a single IP (e.g. 1.2.3.4), a network/netmask (e.g. 1.2.3.4/255.255.255.0) or a network/CIDR (e.g. 1.2.3.4/24).\nError: Invalid -rpcallowip subnet specification: fc00:db8:c0:ff:ee::/80. Valid are a single IP (e.g. 1.2.3.4), a network/netmask (e.g. 1.2.3.4/255.255.255.0) or a network/CIDR (e.g. 1.2.3.4/24).\n2025-05-07T07:10:45Z [error] Unable to start HTTP server. See debug log for details.\nError: Unable to start HTTP server. See debug log for details.\n2025-05-07T07:10:45Z Shutdown: In progress...\n2025-05-07T07:10:45Z scheduler thread exit\n2025-05-07T07:10:45Z Shutdown: done\n```\n\n--\n\nRFC3849 addresses are accepted:\n\n```\n[admin@centos9-stream-a ~]$ curl --no-progress-meter -L 'https://bitcoincore.org/bin/bitcoin-core-29.0/bitcoin-29.0-x86_64-linux-gnu.tar.gz' | tar zx && mkdir -p data && ./bitcoin-29.0/bin/bitcoind '-rpcbind=[::]:8332' '-rpcallowip=2001:db8:c0:ff:ee::/80'\n2025-05-07T07:11:56Z Bitcoin Core version v29.0.0 (release build)\n2025-05-07T07:11:56Z Using the 'sse4(1way),sse41(4way),avx2(8way)' SHA256 implementation\n2025-05-07T07:11:56Z Using RdSeed as an additional entropy source\n2025-05-07T07:11:56Z Using RdRand as an additional entropy source\n2025-05-07T07:11:56Z Default data directory /home/admin/.bitcoin\n2025-05-07T07:11:56Z Using data directory /home/admin/.bitcoin\n2025-05-07T07:11:56Z Config file: /home/admin/.bitcoin/bitcoin.conf (not found, skipping)\n2025-05-07T07:11:56Z Command-line arg: rpcallowip=\"2001:db8:c0:ff:ee::/80\"\n2025-05-07T07:11:56Z Command-line arg: rpcbind=\"[::]:8332\"\n2025-05-07T07:11:56Z Using at most 125 automatic connections (1024 file descriptors available)\n2025-05-07T07:11:56Z scheduler thread start\n2025-05-07T07:11:56Z Binding RPC on address :: port 8332\n2025-05-07T07:11:56Z WARNING: the RPC server is not safe to expose to untrusted networks such as the public internet\n2025-05-07T07:11:56Z Generated RPC authentication cookie /home/admin/.bitcoin/.cookie\n2025-05-07T07:11:56Z Permissions used for cookie: rw-------\n2025-05-07T07:11:56Z Using random cookie authentication.\n2025-05-07T07:11:56Z Starting HTTP server with 16 worker threads\n2025-05-07T07:11:56Z Using wallet directory /home/admin/.bitcoin/wallets\n2025-05-07T07:11:56Z init message: Verifying wallet(s)…\n2025-05-07T07:11:56Z Using /16 prefix for IP bucketing\n2025-05-07T07:11:56Z init message: Loading P2P addresses…\n2025-05-07T07:11:56Z Creating peers.dat because the file was not found (\"/home/admin/.bitcoin/peers.dat\")\n2025-05-07T07:11:56Z init message: Loading banlist…\n2025-05-07T07:11:56Z Recreating the banlist database\n2025-05-07T07:11:56Z SetNetworkActive: true\n2025-05-07T07:11:56Z /home/admin/.bitcoin/fee_estimates.dat is not found. Continue anyway.\n\n^C\n```\n\n### How did you obtain Bitcoin Core\n\nPre-built binaries\n\n### What version of Bitcoin Core are you using?\n\nBitcoin Core daemon version v29.0.0\n\n### Operating system and version\n\nCentOS Stream release 9\n\n### Machine specifications\n\nQEMU/KVM virtual machine",
    "user": {
      "login": "amg1127",
      "id": 23582775,
      "node_id": "MDQ6VXNlcjIzNTgyNzc1",
      "avatar_url": "https://avatars.githubusercontent.com/u/23582775?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/amg1127",
      "html_url": "https://github.com/amg1127",
      "followers_url": "https://api.github.com/users/amg1127/followers",
      "following_url": "https://api.github.com/users/amg1127/following%7B/other_user%7D",
      "gists_url": "https://api.github.com/users/amg1127/gists%7B/gist_id%7D",
      "starred_url": "https://api.github.com/users/amg1127/starred%7B/owner%7D%7B/repo%7D",
      "subscriptions_url": "https://api.github.com/users/amg1127/subscriptions",
      "organizations_url": "https://api.github.com/users/amg1127/orgs",
      "repos_url": "https://api.github.com/users/amg1127/repos",
      "events_url": "https://api.github.com/users/amg1127/events%7B/privacy%7D",
      "received_events_url": "https://api.github.com/users/amg1127/received_events",
      "type": "User",
      "site_admin": false,
      "patch_url": null
    },
    "labels": [],
    "assignees": [],
    "author_association": "NONE",
    "locked": false,
    "comments": 0,
    "created_at": "2025-05-07T07:16:41Z",
    "updated_at": "2025-05-07T07:16:41Z"
  },
  "events": []
}
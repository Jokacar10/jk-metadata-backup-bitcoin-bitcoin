{
  "type": "issue",
  "issue": {
    "id": 2838231077,
    "node_id": "I_kwDOABII586pK_gl",
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/31817",
    "repository_url": "https://api.github.com/repos/bitcoin/bitcoin",
    "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/31817/labels%7B/name%7D",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/31817/comments",
    "events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/31817/events",
    "html_url": "https://github.com/bitcoin/bitcoin/issues/31817",
    "number": 31817,
    "state": "open",
    "state_reason": null,
    "title": "GetRandBytes() Hangs on Samsung Galaxy S25 and OnePlus 13",
    "body": "### Is there an existing issue for this?\n\n- [x] I have searched the existing issues\n\n### Current behaviour\n\nWe have been using Bitcoin Core natively in the Nunchuk Bitcoin wallet, available on both desktop and mobile. On Samsung Galaxy S25 and OnePlus 13 (both running Android 15 with the SM8750-AB Snapdragon 8 Elite 3nm processor), the app fails to initialize due to an issue in `GetRandBytes()`.\n\nThe problem occurs when `GetRandBytes()` calls `GetRNDRRS()`, resulting in an infinite loop without retrieving entropy from the hardware.\n\n```\nuint64_t GetRNDRRS() noexcept\n{\n    uint8_t ok;\n    uint64_t r1;\n    do {\n        // https://developer.arm.com/documentation/ddi0601/2022-12/AArch64-Registers/RNDRRS--Reseeded-Random-Number\n        __asm__ volatile(\"mrs %0, s3_3_c2_c4_1; cset %w1, ne;\"\n                         : \"=r\"(r1), \"=r\"(ok)::\"cc\");\n        if (ok) break;\n        __asm__ volatile(\"yield\");\n    } while (true);\n    return r1;\n}\n```\n\nBuild with: Android NDK 25.1.8937393 & 27.2.12479018\n\nRelated PR: https://github.com/bitcoin/bitcoin/pull/26839\n\nTested on commit: `57b47c47ef0bd36e1c32d709c62998c51dc76f34`\n\n### Expected behaviour\n\n`GetRandBytes()` should return entropy without hanging.\n\n### Steps to reproduce\n\n- Build Bitcoin Core for Android on master or 57b47c47ef0bd36e1c32d709c62998c51dc76f34\n- Call `GetRandBytes`\n- Function gets stuck\n\n### Relevant log output\n\n_No response_\n\n### How did you obtain Bitcoin Core\n\nCompiled from source\n\n### What version of Bitcoin Core are you using?\n\nmaster@57b47c47ef0bd36e1c32d709c62998c51dc76f34\n\n### Operating system and version\n\nAndroid 15\n\n### Machine specifications\n\n_No response_",
    "user": {
      "login": "giahuy98",
      "id": 100193713,
      "node_id": "U_kgDOBfjVsQ",
      "avatar_url": "https://avatars.githubusercontent.com/u/100193713?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/giahuy98",
      "html_url": "https://github.com/giahuy98",
      "followers_url": "https://api.github.com/users/giahuy98/followers",
      "following_url": "https://api.github.com/users/giahuy98/following%7B/other_user%7D",
      "gists_url": "https://api.github.com/users/giahuy98/gists%7B/gist_id%7D",
      "starred_url": "https://api.github.com/users/giahuy98/starred%7B/owner%7D%7B/repo%7D",
      "subscriptions_url": "https://api.github.com/users/giahuy98/subscriptions",
      "organizations_url": "https://api.github.com/users/giahuy98/orgs",
      "repos_url": "https://api.github.com/users/giahuy98/repos",
      "events_url": "https://api.github.com/users/giahuy98/events%7B/privacy%7D",
      "received_events_url": "https://api.github.com/users/giahuy98/received_events",
      "type": "User",
      "site_admin": false,
      "patch_url": null
    },
    "labels": [],
    "assignees": [],
    "author_association": "NONE",
    "locked": false,
    "comments": 0,
    "created_at": "2025-02-07T13:56:42Z",
    "updated_at": "2025-02-07T13:56:42Z"
  },
  "events": []
}